Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7079222
	speed: 0.2777s/iter; left time: 10219.5707s
	iters: 200, epoch: 1 | loss: 0.7076596
	speed: 0.2439s/iter; left time: 8949.8410s
	iters: 300, epoch: 1 | loss: 1.1180240
	speed: 0.2398s/iter; left time: 8776.1953s
Epoch: 1 cost time: 94.50574469566345
Epoch: 1, Steps: 369 | Train Loss: 0.830 Vali Loss: 1.209 Vali Acc: 0.628 Test Loss: 1.209 Test Acc: 0.628
Validation loss decreased (inf --> -0.627684).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5359242
	speed: 0.7527s/iter; left time: 27423.0521s
	iters: 200, epoch: 2 | loss: 1.4875635
	speed: 0.2478s/iter; left time: 9002.4350s
	iters: 300, epoch: 2 | loss: 1.0602846
	speed: 0.2552s/iter; left time: 9245.4398s
Epoch: 2 cost time: 94.1063985824585
Epoch: 2, Steps: 369 | Train Loss: 0.994 Vali Loss: 1.068 Vali Acc: 0.594 Test Loss: 1.068 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8408755
	speed: 0.7833s/iter; left time: 28246.3704s
	iters: 200, epoch: 3 | loss: 0.8900890
	speed: 0.2577s/iter; left time: 9267.6618s
	iters: 300, epoch: 3 | loss: 0.3017022
	speed: 0.2670s/iter; left time: 9577.1243s
Epoch: 3 cost time: 94.92281556129456
Epoch: 3, Steps: 369 | Train Loss: 0.830 Vali Loss: 0.910 Vali Acc: 0.667 Test Loss: 0.910 Test Acc: 0.667
Validation loss decreased (-0.627684 --> -0.667414).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4373916
	speed: 0.7536s/iter; left time: 26900.4846s
	iters: 200, epoch: 4 | loss: 0.4855484
	speed: 0.2682s/iter; left time: 9546.9713s
	iters: 300, epoch: 4 | loss: 1.3235506
	speed: 0.2611s/iter; left time: 9269.1987s
Epoch: 4 cost time: 97.62806820869446
Epoch: 4, Steps: 369 | Train Loss: 0.728 Vali Loss: 0.733 Vali Acc: 0.619 Test Loss: 0.733 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3994708
	speed: 0.7642s/iter; left time: 26994.4877s
	iters: 200, epoch: 5 | loss: 0.8353895
	speed: 0.2656s/iter; left time: 9356.4046s
	iters: 300, epoch: 5 | loss: 0.6240806
	speed: 0.2400s/iter; left time: 8430.1143s
Epoch: 5 cost time: 93.93574833869934
Epoch: 5, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.772 Vali Acc: 0.568 Test Loss: 0.772 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8961323
	speed: 0.7585s/iter; left time: 26515.3193s
	iters: 200, epoch: 6 | loss: 0.9350384
	speed: 0.2511s/iter; left time: 8753.5004s
	iters: 300, epoch: 6 | loss: 0.8677098
	speed: 0.2550s/iter; left time: 8862.9045s
Epoch: 6 cost time: 93.71236991882324
Epoch: 6, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.834 Vali Acc: 0.579 Test Loss: 0.834 Test Acc: 0.579
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7856401
	speed: 0.7809s/iter; left time: 27010.0108s
	iters: 200, epoch: 7 | loss: 0.9764158
	speed: 0.2527s/iter; left time: 8715.7009s
	iters: 300, epoch: 7 | loss: 0.8862930
	speed: 0.2509s/iter; left time: 8627.7825s
Epoch: 7 cost time: 95.44541430473328
Epoch: 7, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.753 Vali Acc: 0.562 Test Loss: 0.753 Test Acc: 0.562
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6840466
	speed: 0.7748s/iter; left time: 26511.2770s
	iters: 200, epoch: 8 | loss: 0.6862365
	speed: 0.2772s/iter; left time: 9456.0020s
	iters: 300, epoch: 8 | loss: 0.9200362
	speed: 0.2459s/iter; left time: 8363.4783s
Epoch: 8 cost time: 97.33053302764893
Epoch: 8, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.880 Vali Acc: 0.554 Test Loss: 0.880 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6079380
	speed: 0.7754s/iter; left time: 26247.1954s
	iters: 200, epoch: 9 | loss: 0.6232635
	speed: 0.2664s/iter; left time: 8989.2855s
	iters: 300, epoch: 9 | loss: 0.6090924
	speed: 0.2595s/iter; left time: 8732.0837s
Epoch: 9 cost time: 99.26195359230042
Epoch: 9, Steps: 369 | Train Loss: 0.690 Vali Loss: 0.764 Vali Acc: 0.579 Test Loss: 0.764 Test Acc: 0.579
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7043413
	speed: 0.8021s/iter; left time: 26852.7005s
	iters: 200, epoch: 10 | loss: 0.8123108
	speed: 0.2522s/iter; left time: 8419.8590s
	iters: 300, epoch: 10 | loss: 0.8060103
	speed: 0.2386s/iter; left time: 7940.2116s
Epoch: 10 cost time: 93.53721904754639
Epoch: 10, Steps: 369 | Train Loss: 0.679 Vali Loss: 0.826 Vali Acc: 0.562 Test Loss: 0.826 Test Acc: 0.562
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6856127
	speed: 0.7341s/iter; left time: 24305.8719s
	iters: 200, epoch: 11 | loss: 0.8148128
	speed: 0.2368s/iter; left time: 7815.8921s
	iters: 300, epoch: 11 | loss: 0.6641079
	speed: 0.2432s/iter; left time: 8004.0871s
Epoch: 11 cost time: 88.99812531471252
Epoch: 11, Steps: 369 | Train Loss: 0.669 Vali Loss: 0.735 Vali Acc: 0.570 Test Loss: 0.735 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6340349
	speed: 0.7183s/iter; left time: 23517.7816s
	iters: 200, epoch: 12 | loss: 0.6195149
	speed: 0.2359s/iter; left time: 7701.1165s
	iters: 300, epoch: 12 | loss: 0.8022513
	speed: 0.2381s/iter; left time: 7749.5981s
Epoch: 12 cost time: 88.47231388092041
Epoch: 12, Steps: 369 | Train Loss: 0.644 Vali Loss: 0.733 Vali Acc: 0.589 Test Loss: 0.733 Test Acc: 0.589
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7318454
	speed: 0.7183s/iter; left time: 23253.8118s
	iters: 200, epoch: 13 | loss: 0.7100422
	speed: 0.2329s/iter; left time: 7517.5530s
	iters: 300, epoch: 13 | loss: 0.4838464
	speed: 0.2217s/iter; left time: 7133.5529s
Epoch: 13 cost time: 84.93427276611328
Epoch: 13, Steps: 369 | Train Loss: 0.627 Vali Loss: 0.751 Vali Acc: 0.598 Test Loss: 0.751 Test Acc: 0.598
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6674233825198638
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7413060
	speed: 0.2395s/iter; left time: 8814.4445s
	iters: 200, epoch: 1 | loss: 0.8533351
	speed: 0.2322s/iter; left time: 8521.3501s
	iters: 300, epoch: 1 | loss: 0.8914341
	speed: 0.2379s/iter; left time: 8707.6756s
Epoch: 1 cost time: 87.27352857589722
Epoch: 1, Steps: 369 | Train Loss: 0.826 Vali Loss: 1.246 Vali Acc: 0.643 Test Loss: 1.246 Test Acc: 0.643
Validation loss decreased (inf --> -0.642723).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4460891
	speed: 0.7066s/iter; left time: 25741.5640s
	iters: 200, epoch: 2 | loss: 2.3201046
	speed: 0.2302s/iter; left time: 8362.5529s
	iters: 300, epoch: 2 | loss: 0.4717350
	speed: 0.2336s/iter; left time: 8463.2930s
Epoch: 2 cost time: 85.58243227005005
Epoch: 2, Steps: 369 | Train Loss: 1.036 Vali Loss: 1.793 Vali Acc: 0.576 Test Loss: 1.793 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6896144
	speed: 0.6996s/iter; left time: 25229.9081s
	iters: 200, epoch: 3 | loss: 1.3161488
	speed: 0.2260s/iter; left time: 8129.0561s
	iters: 300, epoch: 3 | loss: 0.3905199
	speed: 0.2270s/iter; left time: 8141.0595s
Epoch: 3 cost time: 84.01186752319336
Epoch: 3, Steps: 369 | Train Loss: 0.952 Vali Loss: 1.088 Vali Acc: 0.662 Test Loss: 1.088 Test Acc: 0.662
Validation loss decreased (-0.642723 --> -0.662305).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3629144
	speed: 0.6925s/iter; left time: 24717.0495s
	iters: 200, epoch: 4 | loss: 0.6114464
	speed: 0.2307s/iter; left time: 8212.6291s
	iters: 300, epoch: 4 | loss: 0.9144689
	speed: 0.2288s/iter; left time: 8119.7608s
Epoch: 4 cost time: 84.8694999217987
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.701 Vali Acc: 0.623 Test Loss: 0.701 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5857186
	speed: 0.6954s/iter; left time: 24565.3381s
	iters: 200, epoch: 5 | loss: 0.5444683
	speed: 0.2343s/iter; left time: 8252.9369s
	iters: 300, epoch: 5 | loss: 0.7424036
	speed: 0.2301s/iter; left time: 8081.7652s
Epoch: 5 cost time: 85.87848353385925
Epoch: 5, Steps: 369 | Train Loss: 0.638 Vali Loss: 1.189 Vali Acc: 0.530 Test Loss: 1.189 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7329506
	speed: 0.7201s/iter; left time: 25172.4417s
	iters: 200, epoch: 6 | loss: 0.7451019
	speed: 0.2350s/iter; left time: 8189.4334s
	iters: 300, epoch: 6 | loss: 0.4715509
	speed: 0.2317s/iter; left time: 8053.8407s
Epoch: 6 cost time: 87.659907579422
Epoch: 6, Steps: 369 | Train Loss: 0.572 Vali Loss: 1.085 Vali Acc: 0.632 Test Loss: 1.085 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8224455
	speed: 0.7105s/iter; left time: 24575.6986s
	iters: 200, epoch: 7 | loss: 0.6745650
	speed: 0.2265s/iter; left time: 7811.0697s
	iters: 300, epoch: 7 | loss: 0.5425358
	speed: 0.2275s/iter; left time: 7823.6058s
Epoch: 7 cost time: 84.7766125202179
Epoch: 7, Steps: 369 | Train Loss: 0.652 Vali Loss: 0.787 Vali Acc: 0.614 Test Loss: 0.787 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4301399
	speed: 0.7135s/iter; left time: 24415.2589s
	iters: 200, epoch: 8 | loss: 1.1140296
	speed: 0.2306s/iter; left time: 7867.1453s
	iters: 300, epoch: 8 | loss: 0.6622779
	speed: 0.2197s/iter; left time: 7472.2629s
Epoch: 8 cost time: 84.40814805030823
Epoch: 8, Steps: 369 | Train Loss: 0.607 Vali Loss: 0.730 Vali Acc: 0.658 Test Loss: 0.730 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.3044272
	speed: 0.7104s/iter; left time: 24044.9718s
	iters: 200, epoch: 9 | loss: 0.5027702
	speed: 0.2287s/iter; left time: 7719.2764s
	iters: 300, epoch: 9 | loss: 0.3051271
	speed: 0.2303s/iter; left time: 7747.9538s
Epoch: 9 cost time: 85.37027978897095
Epoch: 9, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.744 Vali Acc: 0.640 Test Loss: 0.744 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6356679
	speed: 0.6919s/iter; left time: 23164.2518s
	iters: 200, epoch: 10 | loss: 0.7993364
	speed: 0.2406s/iter; left time: 8031.8444s
	iters: 300, epoch: 10 | loss: 0.9282013
	speed: 0.2274s/iter; left time: 7569.1867s
Epoch: 10 cost time: 87.00066232681274
Epoch: 10, Steps: 369 | Train Loss: 0.541 Vali Loss: 0.732 Vali Acc: 0.654 Test Loss: 0.732 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.5042939
	speed: 0.7042s/iter; left time: 23318.1187s
	iters: 200, epoch: 11 | loss: 0.4541644
	speed: 0.2334s/iter; left time: 7705.9135s
	iters: 300, epoch: 11 | loss: 0.6902355
	speed: 0.2240s/iter; left time: 7371.6761s
Epoch: 11 cost time: 84.30799412727356
Epoch: 11, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.735 Vali Acc: 0.663 Test Loss: 0.735 Test Acc: 0.663
Validation loss decreased (-0.662305 --> -0.663160).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2697288
	speed: 0.7071s/iter; left time: 23150.9160s
	iters: 200, epoch: 12 | loss: 0.3733222
	speed: 0.2345s/iter; left time: 7653.8863s
	iters: 300, epoch: 12 | loss: 0.6707360
	speed: 0.2303s/iter; left time: 7494.8445s
Epoch: 12 cost time: 87.05151391029358
Epoch: 12, Steps: 369 | Train Loss: 0.486 Vali Loss: 0.754 Vali Acc: 0.672 Test Loss: 0.754 Test Acc: 0.672
Validation loss decreased (-0.663160 --> -0.672240).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6329114
	speed: 0.6963s/iter; left time: 22542.2606s
	iters: 200, epoch: 13 | loss: 0.8346378
	speed: 0.2258s/iter; left time: 7287.9949s
	iters: 300, epoch: 13 | loss: 0.4270996
	speed: 0.2263s/iter; left time: 7281.9423s
Epoch: 13 cost time: 84.45236277580261
Epoch: 13, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.725 Vali Acc: 0.670 Test Loss: 0.725 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4411703
	speed: 0.6965s/iter; left time: 22290.9476s
	iters: 200, epoch: 14 | loss: 0.4000842
	speed: 0.2395s/iter; left time: 7639.9513s
	iters: 300, epoch: 14 | loss: 0.3040055
	speed: 0.2338s/iter; left time: 7437.1087s
Epoch: 14 cost time: 87.4823706150055
Epoch: 14, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.715 Vali Acc: 0.673 Test Loss: 0.715 Test Acc: 0.673
Validation loss decreased (-0.672240 --> -0.673375).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5939201
	speed: 0.7139s/iter; left time: 22583.8380s
	iters: 200, epoch: 15 | loss: 0.5946009
	speed: 0.2317s/iter; left time: 7305.7639s
	iters: 300, epoch: 15 | loss: 0.6197003
	speed: 0.2327s/iter; left time: 7315.7315s
Epoch: 15 cost time: 86.28686094284058
Epoch: 15, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.712 Vali Acc: 0.682 Test Loss: 0.712 Test Acc: 0.682
Validation loss decreased (-0.673375 --> -0.681605).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5644440
	speed: 0.7063s/iter; left time: 22081.7071s
	iters: 200, epoch: 16 | loss: 0.4564106
	speed: 0.2328s/iter; left time: 7254.0825s
	iters: 300, epoch: 16 | loss: 0.4081582
	speed: 0.2307s/iter; left time: 7166.1906s
Epoch: 16 cost time: 85.29058504104614
Epoch: 16, Steps: 369 | Train Loss: 0.449 Vali Loss: 0.687 Vali Acc: 0.674 Test Loss: 0.687 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6951962
	speed: 0.6807s/iter; left time: 21031.9846s
	iters: 200, epoch: 17 | loss: 0.6281714
	speed: 0.2310s/iter; left time: 7113.7668s
	iters: 300, epoch: 17 | loss: 0.2988433
	speed: 0.2280s/iter; left time: 6998.7931s
Epoch: 17 cost time: 85.73242425918579
Epoch: 17, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.763 Vali Acc: 0.671 Test Loss: 0.763 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4623376
	speed: 0.7094s/iter; left time: 21657.8383s
	iters: 200, epoch: 18 | loss: 0.3517921
	speed: 0.2277s/iter; left time: 6928.8174s
	iters: 300, epoch: 18 | loss: 0.7053883
	speed: 0.2176s/iter; left time: 6600.6931s
Epoch: 18 cost time: 84.7478837966919
Epoch: 18, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.710 Vali Acc: 0.681 Test Loss: 0.710 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4620569
	speed: 0.7104s/iter; left time: 21425.2877s
	iters: 200, epoch: 19 | loss: 0.3184175
	speed: 0.2337s/iter; left time: 7024.8916s
	iters: 300, epoch: 19 | loss: 0.2554494
	speed: 0.2377s/iter; left time: 7120.9724s
Epoch: 19 cost time: 87.93045902252197
Epoch: 19, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.667 Vali Acc: 0.689 Test Loss: 0.667 Test Acc: 0.689
Validation loss decreased (-0.681605 --> -0.688983).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2335371
	speed: 0.7358s/iter; left time: 21920.0708s
	iters: 200, epoch: 20 | loss: 0.4175126
	speed: 0.2307s/iter; left time: 6850.0013s
	iters: 300, epoch: 20 | loss: 0.2655564
	speed: 0.2166s/iter; left time: 6408.2783s
Epoch: 20 cost time: 86.16645288467407
Epoch: 20, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.756 Vali Acc: 0.685 Test Loss: 0.756 Test Acc: 0.685
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1987851
	speed: 0.7216s/iter; left time: 21230.0936s
	iters: 200, epoch: 21 | loss: 0.1228819
	speed: 0.2344s/iter; left time: 6874.2674s
	iters: 300, epoch: 21 | loss: 0.2865914
	speed: 0.2395s/iter; left time: 6998.0020s
Epoch: 21 cost time: 88.23124957084656
Epoch: 21, Steps: 369 | Train Loss: 0.370 Vali Loss: 0.760 Vali Acc: 0.675 Test Loss: 0.760 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.3825490
	speed: 0.6856s/iter; left time: 19917.6392s
	iters: 200, epoch: 22 | loss: 0.3830706
	speed: 0.2300s/iter; left time: 6658.9412s
	iters: 300, epoch: 22 | loss: 0.2424591
	speed: 0.2382s/iter; left time: 6872.4216s
Epoch: 22 cost time: 84.08677077293396
Epoch: 22, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.810 Vali Acc: 0.669 Test Loss: 0.810 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1807878
	speed: 0.7111s/iter; left time: 20397.6853s
	iters: 200, epoch: 23 | loss: 0.4354092
	speed: 0.2252s/iter; left time: 6435.6656s
	iters: 300, epoch: 23 | loss: 0.2551413
	speed: 0.2367s/iter; left time: 6741.2440s
Epoch: 23 cost time: 85.99174618721008
Epoch: 23, Steps: 369 | Train Loss: 0.334 Vali Loss: 0.895 Vali Acc: 0.684 Test Loss: 0.895 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.1653711
	speed: 0.7072s/iter; left time: 20023.4568s
	iters: 200, epoch: 24 | loss: 0.3563688
	speed: 0.2328s/iter; left time: 6569.4190s
	iters: 300, epoch: 24 | loss: 0.4683457
	speed: 0.2318s/iter; left time: 6515.9040s
Epoch: 24 cost time: 86.25512194633484
Epoch: 24, Steps: 369 | Train Loss: 0.311 Vali Loss: 0.944 Vali Acc: 0.678 Test Loss: 0.944 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3914273
	speed: 0.6904s/iter; left time: 19292.8618s
	iters: 200, epoch: 25 | loss: 0.1086244
	speed: 0.2260s/iter; left time: 6291.8444s
	iters: 300, epoch: 25 | loss: 0.2397611
	speed: 0.2211s/iter; left time: 6134.3503s
Epoch: 25 cost time: 82.98258662223816
Epoch: 25, Steps: 369 | Train Loss: 0.295 Vali Loss: 0.951 Vali Acc: 0.669 Test Loss: 0.951 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.6018389
	speed: 0.6762s/iter; left time: 18646.4730s
	iters: 200, epoch: 26 | loss: 0.2491759
	speed: 0.2269s/iter; left time: 6235.5734s
	iters: 300, epoch: 26 | loss: 0.3634532
	speed: 0.2251s/iter; left time: 6161.3447s
Epoch: 26 cost time: 83.8480658531189
Epoch: 26, Steps: 369 | Train Loss: 0.251 Vali Loss: 0.994 Vali Acc: 0.666 Test Loss: 0.994 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.4749959
	speed: 0.7069s/iter; left time: 19231.9505s
	iters: 200, epoch: 27 | loss: 0.1975441
	speed: 0.2288s/iter; left time: 6200.8114s
	iters: 300, epoch: 27 | loss: 0.2725424
	speed: 0.2236s/iter; left time: 6039.1574s
Epoch: 27 cost time: 85.1006531715393
Epoch: 27, Steps: 369 | Train Loss: 0.232 Vali Loss: 0.987 Vali Acc: 0.659 Test Loss: 0.987 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0218378
	speed: 0.7010s/iter; left time: 18814.3427s
	iters: 200, epoch: 28 | loss: 0.3292166
	speed: 0.2315s/iter; left time: 6188.6664s
	iters: 300, epoch: 28 | loss: 0.2504823
	speed: 0.2316s/iter; left time: 6169.3716s
Epoch: 28 cost time: 86.400226354599
Epoch: 28, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.197 Vali Acc: 0.672 Test Loss: 1.197 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1225809
	speed: 0.6993s/iter; left time: 18509.2457s
	iters: 200, epoch: 29 | loss: 0.1090375
	speed: 0.2280s/iter; left time: 6012.6618s
	iters: 300, epoch: 29 | loss: 0.0901613
	speed: 0.2302s/iter; left time: 6047.9954s
Epoch: 29 cost time: 84.58411908149719
Epoch: 29, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.490 Vali Acc: 0.657 Test Loss: 1.490 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6889897843359818
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7718186
	speed: 0.2571s/iter; left time: 9460.1286s
	iters: 200, epoch: 1 | loss: 0.5756469
	speed: 0.2675s/iter; left time: 9818.1862s
	iters: 300, epoch: 1 | loss: 0.8118573
	speed: 0.2467s/iter; left time: 9030.2965s
Epoch: 1 cost time: 95.35443425178528
Epoch: 1, Steps: 369 | Train Loss: 0.855 Vali Loss: 1.208 Vali Acc: 0.615 Test Loss: 1.208 Test Acc: 0.615
Validation loss decreased (inf --> -0.615198).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0923307
	speed: 0.7780s/iter; left time: 28344.6150s
	iters: 200, epoch: 2 | loss: 1.9600679
	speed: 0.2588s/iter; left time: 9403.0236s
	iters: 300, epoch: 2 | loss: 0.5280375
	speed: 0.2534s/iter; left time: 9179.6966s
Epoch: 2 cost time: 95.95256567001343
Epoch: 2, Steps: 369 | Train Loss: 1.035 Vali Loss: 1.020 Vali Acc: 0.607 Test Loss: 1.020 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8665574
	speed: 0.7829s/iter; left time: 28233.6692s
	iters: 200, epoch: 3 | loss: 0.6979133
	speed: 0.2539s/iter; left time: 9131.6149s
	iters: 300, epoch: 3 | loss: 0.4975089
	speed: 0.2468s/iter; left time: 8850.4863s
Epoch: 3 cost time: 96.36657381057739
Epoch: 3, Steps: 369 | Train Loss: 0.871 Vali Loss: 0.727 Vali Acc: 0.664 Test Loss: 0.727 Test Acc: 0.664
Validation loss decreased (-0.615198 --> -0.664295).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7407595
	speed: 0.7799s/iter; left time: 27837.5052s
	iters: 200, epoch: 4 | loss: 0.7169049
	speed: 0.2496s/iter; left time: 8883.7021s
	iters: 300, epoch: 4 | loss: 0.5362669
	speed: 0.2601s/iter; left time: 9232.1449s
Epoch: 4 cost time: 94.85887455940247
Epoch: 4, Steps: 369 | Train Loss: 0.645 Vali Loss: 0.759 Vali Acc: 0.577 Test Loss: 0.759 Test Acc: 0.577
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8257770
	speed: 0.7626s/iter; left time: 26937.1818s
	iters: 200, epoch: 5 | loss: 0.5563754
	speed: 0.2515s/iter; left time: 8858.5687s
	iters: 300, epoch: 5 | loss: 0.6190423
	speed: 0.2416s/iter; left time: 8487.5499s
Epoch: 5 cost time: 93.42661356925964
Epoch: 5, Steps: 369 | Train Loss: 0.634 Vali Loss: 0.733 Vali Acc: 0.601 Test Loss: 0.733 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9379914
	speed: 0.7593s/iter; left time: 26543.6912s
	iters: 200, epoch: 6 | loss: 0.8305826
	speed: 0.2597s/iter; left time: 9053.1534s
	iters: 300, epoch: 6 | loss: 0.4296066
	speed: 0.2588s/iter; left time: 8994.3759s
Epoch: 6 cost time: 95.86196756362915
Epoch: 6, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.887 Vali Acc: 0.602 Test Loss: 0.887 Test Acc: 0.602
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6289653
	speed: 0.7779s/iter; left time: 26904.2991s
	iters: 200, epoch: 7 | loss: 0.4699543
	speed: 0.2566s/iter; left time: 8850.1686s
	iters: 300, epoch: 7 | loss: 0.5151511
	speed: 0.2628s/iter; left time: 9037.6308s
Epoch: 7 cost time: 97.58629512786865
Epoch: 7, Steps: 369 | Train Loss: 0.656 Vali Loss: 0.910 Vali Acc: 0.595 Test Loss: 0.910 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8438947
	speed: 0.7929s/iter; left time: 27132.8902s
	iters: 200, epoch: 8 | loss: 0.7333304
	speed: 0.2765s/iter; left time: 9433.7412s
	iters: 300, epoch: 8 | loss: 0.8050001
	speed: 0.2714s/iter; left time: 9231.8795s
Epoch: 8 cost time: 99.66658568382263
Epoch: 8, Steps: 369 | Train Loss: 0.635 Vali Loss: 0.728 Vali Acc: 0.619 Test Loss: 0.728 Test Acc: 0.619
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5085012
	speed: 0.7734s/iter; left time: 26178.2241s
	iters: 200, epoch: 9 | loss: 0.4720013
	speed: 0.2685s/iter; left time: 9061.0533s
	iters: 300, epoch: 9 | loss: 0.4638168
	speed: 0.2624s/iter; left time: 8828.7767s
Epoch: 9 cost time: 97.06757545471191
Epoch: 9, Steps: 369 | Train Loss: 0.587 Vali Loss: 0.710 Vali Acc: 0.648 Test Loss: 0.710 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.4349587
	speed: 0.7694s/iter; left time: 25760.5777s
	iters: 200, epoch: 10 | loss: 0.4796643
	speed: 0.2587s/iter; left time: 8635.9861s
	iters: 300, epoch: 10 | loss: 0.8013113
	speed: 0.2534s/iter; left time: 8431.5593s
Epoch: 10 cost time: 95.78666734695435
Epoch: 10, Steps: 369 | Train Loss: 0.562 Vali Loss: 0.718 Vali Acc: 0.665 Test Loss: 0.718 Test Acc: 0.665
Validation loss decreased (-0.664295 --> -0.665146).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5141705
	speed: 0.7709s/iter; left time: 25526.2620s
	iters: 200, epoch: 11 | loss: 0.4457352
	speed: 0.2516s/iter; left time: 8307.0043s
	iters: 300, epoch: 11 | loss: 0.5544459
	speed: 0.2471s/iter; left time: 8131.8477s
Epoch: 11 cost time: 92.6121940612793
Epoch: 11, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.737 Vali Acc: 0.645 Test Loss: 0.737 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5293092
	speed: 0.7754s/iter; left time: 25388.7970s
	iters: 200, epoch: 12 | loss: 0.8872615
	speed: 0.2575s/iter; left time: 8403.9230s
	iters: 300, epoch: 12 | loss: 0.6975989
	speed: 0.2529s/iter; left time: 8229.1947s
Epoch: 12 cost time: 95.88686442375183
Epoch: 12, Steps: 369 | Train Loss: 0.540 Vali Loss: 0.656 Vali Acc: 0.680 Test Loss: 0.656 Test Acc: 0.680
Validation loss decreased (-0.665146 --> -0.679619).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8572785
	speed: 0.7661s/iter; left time: 24800.2273s
	iters: 200, epoch: 13 | loss: 0.6331059
	speed: 0.2516s/iter; left time: 8119.4072s
	iters: 300, epoch: 13 | loss: 0.3780165
	speed: 0.2563s/iter; left time: 8245.5071s
Epoch: 13 cost time: 94.84174156188965
Epoch: 13, Steps: 369 | Train Loss: 0.521 Vali Loss: 0.684 Vali Acc: 0.676 Test Loss: 0.684 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3467281
	speed: 0.7868s/iter; left time: 25181.9297s
	iters: 200, epoch: 14 | loss: 0.4807181
	speed: 0.2628s/iter; left time: 8383.3876s
	iters: 300, epoch: 14 | loss: 0.5599332
	speed: 0.2464s/iter; left time: 7836.8707s
Epoch: 14 cost time: 96.61013507843018
Epoch: 14, Steps: 369 | Train Loss: 0.515 Vali Loss: 0.682 Vali Acc: 0.676 Test Loss: 0.682 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5295750
	speed: 0.7687s/iter; left time: 24319.0371s
	iters: 200, epoch: 15 | loss: 0.5640697
	speed: 0.2617s/iter; left time: 8253.8224s
	iters: 300, epoch: 15 | loss: 0.5321955
	speed: 0.2729s/iter; left time: 8577.7442s
Epoch: 15 cost time: 97.42416405677795
Epoch: 15, Steps: 369 | Train Loss: 0.512 Vali Loss: 0.715 Vali Acc: 0.685 Test Loss: 0.715 Test Acc: 0.685
Validation loss decreased (-0.679619 --> -0.685294).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4208320
	speed: 0.7793s/iter; left time: 24366.4308s
	iters: 200, epoch: 16 | loss: 0.4225387
	speed: 0.2519s/iter; left time: 7851.5791s
	iters: 300, epoch: 16 | loss: 0.5648353
	speed: 0.2421s/iter; left time: 7522.1098s
Epoch: 16 cost time: 94.95481872558594
Epoch: 16, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.721 Vali Acc: 0.677 Test Loss: 0.721 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.9440498
	speed: 0.7676s/iter; left time: 23717.1143s
	iters: 200, epoch: 17 | loss: 0.5024190
	speed: 0.2722s/iter; left time: 8382.6661s
	iters: 300, epoch: 17 | loss: 0.2727478
	speed: 0.2537s/iter; left time: 7787.8185s
Epoch: 17 cost time: 96.31428813934326
Epoch: 17, Steps: 369 | Train Loss: 0.471 Vali Loss: 0.718 Vali Acc: 0.675 Test Loss: 0.718 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4624045
	speed: 0.7514s/iter; left time: 22938.8941s
	iters: 200, epoch: 18 | loss: 0.4908886
	speed: 0.2483s/iter; left time: 7555.8158s
	iters: 300, epoch: 18 | loss: 0.4208818
	speed: 0.2495s/iter; left time: 7567.5201s
Epoch: 18 cost time: 94.51531100273132
Epoch: 18, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.730 Vali Acc: 0.679 Test Loss: 0.730 Test Acc: 0.679
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6300919
	speed: 0.7805s/iter; left time: 23539.5081s
	iters: 200, epoch: 19 | loss: 0.4755307
	speed: 0.2587s/iter; left time: 7777.0350s
	iters: 300, epoch: 19 | loss: 0.4170489
	speed: 0.2510s/iter; left time: 7520.0079s
Epoch: 19 cost time: 95.60408282279968
Epoch: 19, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.682 Vali Acc: 0.683 Test Loss: 0.682 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2110897
	speed: 0.7984s/iter; left time: 23784.4110s
	iters: 200, epoch: 20 | loss: 0.3810852
	speed: 0.2671s/iter; left time: 7928.7654s
	iters: 300, epoch: 20 | loss: 0.2439202
	speed: 0.2704s/iter; left time: 8000.1622s
Epoch: 20 cost time: 99.41156673431396
Epoch: 20, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.754 Vali Acc: 0.675 Test Loss: 0.754 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2995042
	speed: 0.7840s/iter; left time: 23066.5666s
	iters: 200, epoch: 21 | loss: 0.1854610
	speed: 0.2607s/iter; left time: 7643.6653s
	iters: 300, epoch: 21 | loss: 0.4197032
	speed: 0.2592s/iter; left time: 7573.6515s
Epoch: 21 cost time: 95.96591353416443
Epoch: 21, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.757 Vali Acc: 0.686 Test Loss: 0.757 Test Acc: 0.686
Validation loss decreased (-0.685294 --> -0.686428).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4814485
	speed: 0.7697s/iter; left time: 22361.4388s
	iters: 200, epoch: 22 | loss: 0.3731495
	speed: 0.2524s/iter; left time: 7307.2070s
	iters: 300, epoch: 22 | loss: 0.4603807
	speed: 0.2673s/iter; left time: 7712.2149s
Epoch: 22 cost time: 95.80817413330078
Epoch: 22, Steps: 369 | Train Loss: 0.412 Vali Loss: 0.725 Vali Acc: 0.683 Test Loss: 0.725 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3071808
	speed: 0.7626s/iter; left time: 21872.7142s
	iters: 200, epoch: 23 | loss: 0.4719232
	speed: 0.2505s/iter; left time: 7160.6622s
	iters: 300, epoch: 23 | loss: 0.4178362
	speed: 0.2465s/iter; left time: 7020.9000s
Epoch: 23 cost time: 92.98186802864075
Epoch: 23, Steps: 369 | Train Loss: 0.394 Vali Loss: 0.781 Vali Acc: 0.696 Test Loss: 0.781 Test Acc: 0.696
Validation loss decreased (-0.686428 --> -0.696076).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1643216
	speed: 0.7775s/iter; left time: 22014.7393s
	iters: 200, epoch: 24 | loss: 0.7671593
	speed: 0.2586s/iter; left time: 7296.4191s
	iters: 300, epoch: 24 | loss: 0.4968926
	speed: 0.2613s/iter; left time: 7345.7471s
Epoch: 24 cost time: 97.4646680355072
Epoch: 24, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.781 Vali Acc: 0.698 Test Loss: 0.781 Test Acc: 0.698
Validation loss decreased (-0.696076 --> -0.697495).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.4990670
	speed: 0.7877s/iter; left time: 22011.8772s
	iters: 200, epoch: 25 | loss: 0.2185827
	speed: 0.2728s/iter; left time: 7596.7243s
	iters: 300, epoch: 25 | loss: 0.3650745
	speed: 0.2561s/iter; left time: 7104.9354s
Epoch: 25 cost time: 97.30979180335999
Epoch: 25, Steps: 369 | Train Loss: 0.357 Vali Loss: 0.880 Vali Acc: 0.686 Test Loss: 0.880 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.3169266
	speed: 0.7824s/iter; left time: 21574.5226s
	iters: 200, epoch: 26 | loss: 0.3473227
	speed: 0.2583s/iter; left time: 7096.2259s
	iters: 300, epoch: 26 | loss: 0.3609136
	speed: 0.2566s/iter; left time: 7025.4723s
Epoch: 26 cost time: 96.47585892677307
Epoch: 26, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.768 Vali Acc: 0.679 Test Loss: 0.768 Test Acc: 0.679
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.2592978
	speed: 0.7429s/iter; left time: 20210.7802s
	iters: 200, epoch: 27 | loss: 0.2811168
	speed: 0.2577s/iter; left time: 6984.8461s
	iters: 300, epoch: 27 | loss: 0.3257038
	speed: 0.2525s/iter; left time: 6819.9086s
Epoch: 27 cost time: 92.30603098869324
Epoch: 27, Steps: 369 | Train Loss: 0.295 Vali Loss: 0.841 Vali Acc: 0.674 Test Loss: 0.841 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1329587
	speed: 0.7441s/iter; left time: 19971.2916s
	iters: 200, epoch: 28 | loss: 0.2029750
	speed: 0.2589s/iter; left time: 6921.5875s
	iters: 300, epoch: 28 | loss: 0.3660456
	speed: 0.2450s/iter; left time: 6527.5373s
Epoch: 28 cost time: 93.1342384815216
Epoch: 28, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.040 Vali Acc: 0.669 Test Loss: 1.040 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.3320985
	speed: 0.7702s/iter; left time: 20385.4711s
	iters: 200, epoch: 29 | loss: 0.2170952
	speed: 0.2587s/iter; left time: 6822.6816s
	iters: 300, epoch: 29 | loss: 0.3358599
	speed: 0.2699s/iter; left time: 7089.0635s
Epoch: 29 cost time: 99.03086590766907
Epoch: 29, Steps: 369 | Train Loss: 0.245 Vali Loss: 0.994 Vali Acc: 0.662 Test Loss: 0.994 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.2369123
	speed: 0.7959s/iter; left time: 20773.6129s
	iters: 200, epoch: 30 | loss: 0.3431545
	speed: 0.2648s/iter; left time: 6883.6543s
	iters: 300, epoch: 30 | loss: 0.1300231
	speed: 0.2631s/iter; left time: 6814.2459s
Epoch: 30 cost time: 97.33204054832458
Epoch: 30, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.067 Vali Acc: 0.670 Test Loss: 1.067 Test Acc: 0.670
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0378222
	speed: 0.7668s/iter; left time: 19730.6774s
	iters: 200, epoch: 31 | loss: 0.5431928
	speed: 0.2395s/iter; left time: 6139.1131s
	iters: 300, epoch: 31 | loss: 0.1093638
	speed: 0.2716s/iter; left time: 6934.5666s
Epoch: 31 cost time: 94.66633033752441
Epoch: 31, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.482 Vali Acc: 0.667 Test Loss: 1.482 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.1488792
	speed: 0.7570s/iter; left time: 19198.3694s
	iters: 200, epoch: 32 | loss: 0.3779989
	speed: 0.2649s/iter; left time: 6692.9534s
	iters: 300, epoch: 32 | loss: 0.1923184
	speed: 0.2595s/iter; left time: 6529.5657s
Epoch: 32 cost time: 95.21242260932922
Epoch: 32, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.290 Vali Acc: 0.663 Test Loss: 1.290 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0116764
	speed: 0.7472s/iter; left time: 18675.0931s
	iters: 200, epoch: 33 | loss: 0.0260158
	speed: 0.2643s/iter; left time: 6579.9065s
	iters: 300, epoch: 33 | loss: 0.0276323
	speed: 0.2439s/iter; left time: 6046.4502s
Epoch: 33 cost time: 94.94137859344482
Epoch: 33, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.527 Vali Acc: 0.669 Test Loss: 1.527 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.1081694
	speed: 0.7629s/iter; left time: 18785.1010s
	iters: 200, epoch: 34 | loss: 0.0661591
	speed: 0.2595s/iter; left time: 6364.7023s
	iters: 300, epoch: 34 | loss: 0.2349064
	speed: 0.2759s/iter; left time: 6738.4377s
Epoch: 34 cost time: 97.57934403419495
Epoch: 34, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.708 Vali Acc: 0.655 Test Loss: 1.708 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6975028376844495
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6250913
	speed: 0.2539s/iter; left time: 9342.9973s
	iters: 200, epoch: 1 | loss: 0.8669664
	speed: 0.2442s/iter; left time: 8961.4091s
	iters: 300, epoch: 1 | loss: 0.5159647
	speed: 0.2377s/iter; left time: 8701.5232s
Epoch: 1 cost time: 89.62905263900757
Epoch: 1, Steps: 369 | Train Loss: 0.851 Vali Loss: 1.161 Vali Acc: 0.626 Test Loss: 1.161 Test Acc: 0.626
Validation loss decreased (inf --> -0.625698).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0411234
	speed: 0.7088s/iter; left time: 25822.7953s
	iters: 200, epoch: 2 | loss: 2.0848405
	speed: 0.2383s/iter; left time: 8656.8758s
	iters: 300, epoch: 2 | loss: 0.5398681
	speed: 0.2363s/iter; left time: 8562.9041s
Epoch: 2 cost time: 87.69044709205627
Epoch: 2, Steps: 369 | Train Loss: 1.031 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1911287
	speed: 0.7272s/iter; left time: 26226.1883s
	iters: 200, epoch: 3 | loss: 0.8944514
	speed: 0.2286s/iter; left time: 8221.5123s
	iters: 300, epoch: 3 | loss: 0.7852591
	speed: 0.2527s/iter; left time: 9062.3356s
Epoch: 3 cost time: 89.02881097793579
Epoch: 3, Steps: 369 | Train Loss: 0.813 Vali Loss: 1.135 Vali Acc: 0.671 Test Loss: 1.135 Test Acc: 0.671
Validation loss decreased (-0.625698 --> -0.670817).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7076209
	speed: 0.7297s/iter; left time: 26044.7140s
	iters: 200, epoch: 4 | loss: 0.6149919
	speed: 0.2432s/iter; left time: 8655.2644s
	iters: 300, epoch: 4 | loss: 0.5666710
	speed: 0.2345s/iter; left time: 8325.0435s
Epoch: 4 cost time: 89.80255007743835
Epoch: 4, Steps: 369 | Train Loss: 0.743 Vali Loss: 0.768 Vali Acc: 0.653 Test Loss: 0.768 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6366990
	speed: 0.7101s/iter; left time: 25083.2518s
	iters: 200, epoch: 5 | loss: 0.9284923
	speed: 0.2396s/iter; left time: 8441.2020s
	iters: 300, epoch: 5 | loss: 0.9517415
	speed: 0.2404s/iter; left time: 8443.0308s
Epoch: 5 cost time: 86.97485375404358
Epoch: 5, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.834 Vali Acc: 0.602 Test Loss: 0.834 Test Acc: 0.602
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0271528
	speed: 0.7444s/iter; left time: 26019.8700s
	iters: 200, epoch: 6 | loss: 0.5630350
	speed: 0.2365s/iter; left time: 8242.5332s
	iters: 300, epoch: 6 | loss: 0.5452755
	speed: 0.2349s/iter; left time: 8164.1261s
Epoch: 6 cost time: 90.81478500366211
Epoch: 6, Steps: 369 | Train Loss: 0.662 Vali Loss: 0.888 Vali Acc: 0.522 Test Loss: 0.888 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8696729
	speed: 0.7253s/iter; left time: 25086.8386s
	iters: 200, epoch: 7 | loss: 0.6764655
	speed: 0.2393s/iter; left time: 8253.9953s
	iters: 300, epoch: 7 | loss: 0.4299448
	speed: 0.2321s/iter; left time: 7982.8442s
Epoch: 7 cost time: 87.92385673522949
Epoch: 7, Steps: 369 | Train Loss: 0.648 Vali Loss: 0.833 Vali Acc: 0.605 Test Loss: 0.833 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7093435
	speed: 0.7281s/iter; left time: 24912.7974s
	iters: 200, epoch: 8 | loss: 0.6273021
	speed: 0.2366s/iter; left time: 8072.1842s
	iters: 300, epoch: 8 | loss: 1.1812806
	speed: 0.2349s/iter; left time: 7991.2595s
Epoch: 8 cost time: 87.30390119552612
Epoch: 8, Steps: 369 | Train Loss: 0.585 Vali Loss: 0.755 Vali Acc: 0.659 Test Loss: 0.755 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4514675
	speed: 0.7186s/iter; left time: 24322.6805s
	iters: 200, epoch: 9 | loss: 0.6120019
	speed: 0.2300s/iter; left time: 7761.0977s
	iters: 300, epoch: 9 | loss: 0.3896641
	speed: 0.2285s/iter; left time: 7689.4831s
Epoch: 9 cost time: 85.10815930366516
Epoch: 9, Steps: 369 | Train Loss: 0.562 Vali Loss: 0.750 Vali Acc: 0.657 Test Loss: 0.750 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5185149
	speed: 0.7009s/iter; left time: 23466.8699s
	iters: 200, epoch: 10 | loss: 0.6151826
	speed: 0.2289s/iter; left time: 7640.4590s
	iters: 300, epoch: 10 | loss: 0.8370532
	speed: 0.2262s/iter; left time: 7528.1634s
Epoch: 10 cost time: 83.7703845500946
Epoch: 10, Steps: 369 | Train Loss: 0.547 Vali Loss: 0.741 Vali Acc: 0.649 Test Loss: 0.741 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.5183855
	speed: 0.6803s/iter; left time: 22526.6255s
	iters: 200, epoch: 11 | loss: 0.4464538
	speed: 0.2270s/iter; left time: 7492.0210s
	iters: 300, epoch: 11 | loss: 0.5037255
	speed: 0.2285s/iter; left time: 7519.8667s
Epoch: 11 cost time: 84.93216061592102
Epoch: 11, Steps: 369 | Train Loss: 0.544 Vali Loss: 0.784 Vali Acc: 0.621 Test Loss: 0.784 Test Acc: 0.621
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3578217
	speed: 0.7054s/iter; left time: 23096.4549s
	iters: 200, epoch: 12 | loss: 0.5301960
	speed: 0.2297s/iter; left time: 7497.3738s
	iters: 300, epoch: 12 | loss: 0.6488381
	speed: 0.2277s/iter; left time: 7410.8059s
Epoch: 12 cost time: 85.49161148071289
Epoch: 12, Steps: 369 | Train Loss: 0.512 Vali Loss: 0.717 Vali Acc: 0.681 Test Loss: 0.717 Test Acc: 0.681
Validation loss decreased (-0.670817 --> -0.681321).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7113490
	speed: 0.7219s/iter; left time: 23370.8524s
	iters: 200, epoch: 13 | loss: 0.6410239
	speed: 0.2298s/iter; left time: 7415.5303s
	iters: 300, epoch: 13 | loss: 0.4985054
	speed: 0.2297s/iter; left time: 7390.4600s
Epoch: 13 cost time: 87.20612597465515
Epoch: 13, Steps: 369 | Train Loss: 0.503 Vali Loss: 0.797 Vali Acc: 0.660 Test Loss: 0.797 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5354239
	speed: 0.7206s/iter; left time: 23060.5098s
	iters: 200, epoch: 14 | loss: 0.4528449
	speed: 0.2482s/iter; left time: 7917.2426s
	iters: 300, epoch: 14 | loss: 0.4664235
	speed: 0.2475s/iter; left time: 7871.5578s
Epoch: 14 cost time: 90.8261022567749
Epoch: 14, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.691 Vali Acc: 0.689 Test Loss: 0.691 Test Acc: 0.689
Validation loss decreased (-0.681321 --> -0.688699).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6893501
	speed: 0.7543s/iter; left time: 23861.2429s
	iters: 200, epoch: 15 | loss: 0.5372276
	speed: 0.2618s/iter; left time: 8254.4660s
	iters: 300, epoch: 15 | loss: 0.5635790
	speed: 0.2607s/iter; left time: 8194.2600s
Epoch: 15 cost time: 95.32354998588562
Epoch: 15, Steps: 369 | Train Loss: 0.464 Vali Loss: 0.775 Vali Acc: 0.666 Test Loss: 0.775 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3376899
	speed: 0.7573s/iter; left time: 23677.3215s
	iters: 200, epoch: 16 | loss: 0.3025381
	speed: 0.2506s/iter; left time: 7810.1995s
	iters: 300, epoch: 16 | loss: 0.6876085
	speed: 0.2498s/iter; left time: 7760.7263s
Epoch: 16 cost time: 92.54942798614502
Epoch: 16, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.661 Vali Acc: 0.689 Test Loss: 0.661 Test Acc: 0.689
Validation loss decreased (-0.688699 --> -0.688983).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8583298
	speed: 0.7706s/iter; left time: 23810.5882s
	iters: 200, epoch: 17 | loss: 0.2766697
	speed: 0.2409s/iter; left time: 7418.3038s
	iters: 300, epoch: 17 | loss: 0.4072055
	speed: 0.2471s/iter; left time: 7584.8852s
Epoch: 17 cost time: 92.47734665870667
Epoch: 17, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.771 Vali Acc: 0.666 Test Loss: 0.771 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.4989591
	speed: 0.7561s/iter; left time: 23082.5146s
	iters: 200, epoch: 18 | loss: 0.5915647
	speed: 0.2521s/iter; left time: 7671.4584s
	iters: 300, epoch: 18 | loss: 0.6715957
	speed: 0.2479s/iter; left time: 7519.3097s
Epoch: 18 cost time: 93.18067264556885
Epoch: 18, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.768 Vali Acc: 0.673 Test Loss: 0.768 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4844818
	speed: 0.7291s/iter; left time: 21989.7211s
	iters: 200, epoch: 19 | loss: 0.3849913
	speed: 0.2476s/iter; left time: 7441.4107s
	iters: 300, epoch: 19 | loss: 0.1765367
	speed: 0.2348s/iter; left time: 7033.3081s
Epoch: 19 cost time: 88.84910726547241
Epoch: 19, Steps: 369 | Train Loss: 0.400 Vali Loss: 0.641 Vali Acc: 0.684 Test Loss: 0.641 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2389474
	speed: 0.7079s/iter; left time: 21089.6352s
	iters: 200, epoch: 20 | loss: 0.4548108
	speed: 0.2369s/iter; left time: 7032.9452s
	iters: 300, epoch: 20 | loss: 0.2149358
	speed: 0.2246s/iter; left time: 6647.0954s
Epoch: 20 cost time: 86.88849687576294
Epoch: 20, Steps: 369 | Train Loss: 0.376 Vali Loss: 0.791 Vali Acc: 0.685 Test Loss: 0.791 Test Acc: 0.685
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2004604
	speed: 0.7103s/iter; left time: 20897.1585s
	iters: 200, epoch: 21 | loss: 0.0853711
	speed: 0.2361s/iter; left time: 6923.0095s
	iters: 300, epoch: 21 | loss: 0.2706483
	speed: 0.2361s/iter; left time: 6898.5698s
Epoch: 21 cost time: 87.79430961608887
Epoch: 21, Steps: 369 | Train Loss: 0.350 Vali Loss: 0.799 Vali Acc: 0.682 Test Loss: 0.799 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3843903
	speed: 0.7595s/iter; left time: 22065.4251s
	iters: 200, epoch: 22 | loss: 0.2466730
	speed: 0.2494s/iter; left time: 7221.5748s
	iters: 300, epoch: 22 | loss: 0.1802342
	speed: 0.2637s/iter; left time: 7607.2086s
Epoch: 22 cost time: 93.37502121925354
Epoch: 22, Steps: 369 | Train Loss: 0.327 Vali Loss: 0.904 Vali Acc: 0.682 Test Loss: 0.904 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2500316
	speed: 0.7467s/iter; left time: 21417.7726s
	iters: 200, epoch: 23 | loss: 0.4957116
	speed: 0.2397s/iter; left time: 6850.7316s
	iters: 300, epoch: 23 | loss: 0.3450545
	speed: 0.2416s/iter; left time: 6881.8029s
Epoch: 23 cost time: 91.44726753234863
Epoch: 23, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.900 Vali Acc: 0.679 Test Loss: 0.900 Test Acc: 0.679
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1670206
	speed: 0.7328s/iter; left time: 20748.4451s
	iters: 200, epoch: 24 | loss: 0.8878669
	speed: 0.2446s/iter; left time: 6902.0150s
	iters: 300, epoch: 24 | loss: 0.2376223
	speed: 0.2526s/iter; left time: 7102.4235s
Epoch: 24 cost time: 90.93271470069885
Epoch: 24, Steps: 369 | Train Loss: 0.260 Vali Loss: 1.082 Vali Acc: 0.675 Test Loss: 1.082 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.3719048
	speed: 0.7210s/iter; left time: 20149.4060s
	iters: 200, epoch: 25 | loss: 0.0885439
	speed: 0.2348s/iter; left time: 6538.4851s
	iters: 300, epoch: 25 | loss: 0.1727670
	speed: 0.2357s/iter; left time: 6539.2144s
Epoch: 25 cost time: 87.98324155807495
Epoch: 25, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.229 Vali Acc: 0.677 Test Loss: 1.229 Test Acc: 0.677
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2345552
	speed: 0.7144s/iter; left time: 19699.4434s
	iters: 200, epoch: 26 | loss: 0.2894305
	speed: 0.2342s/iter; left time: 6434.5312s
	iters: 300, epoch: 26 | loss: 0.4306261
	speed: 0.2314s/iter; left time: 6333.4879s
Epoch: 26 cost time: 86.2732629776001
Epoch: 26, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.214 Vali Acc: 0.671 Test Loss: 1.214 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6889897843359818
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7843829
	speed: 0.2617s/iter; left time: 9631.1220s
	iters: 200, epoch: 1 | loss: 0.6631963
	speed: 0.2514s/iter; left time: 9227.4362s
	iters: 300, epoch: 1 | loss: 2.0197849
	speed: 0.2364s/iter; left time: 8653.3073s
Epoch: 1 cost time: 91.17612814903259
Epoch: 1, Steps: 369 | Train Loss: 0.864 Vali Loss: 1.118 Vali Acc: 0.639 Test Loss: 1.118 Test Acc: 0.639
Validation loss decreased (inf --> -0.639319).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5433546
	speed: 0.7127s/iter; left time: 25963.2780s
	iters: 200, epoch: 2 | loss: 2.0953691
	speed: 0.2391s/iter; left time: 8685.8081s
	iters: 300, epoch: 2 | loss: 0.4402613
	speed: 0.2346s/iter; left time: 8501.6896s
Epoch: 2 cost time: 87.27826428413391
Epoch: 2, Steps: 369 | Train Loss: 1.085 Vali Loss: 1.397 Vali Acc: 0.599 Test Loss: 1.397 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3645197
	speed: 0.7130s/iter; left time: 25711.5049s
	iters: 200, epoch: 3 | loss: 1.2095587
	speed: 0.2434s/iter; left time: 8754.9998s
	iters: 300, epoch: 3 | loss: 1.3331894
	speed: 0.2398s/iter; left time: 8598.1795s
Epoch: 3 cost time: 88.95589256286621
Epoch: 3, Steps: 369 | Train Loss: 0.990 Vali Loss: 1.006 Vali Acc: 0.665 Test Loss: 1.006 Test Acc: 0.665
Validation loss decreased (-0.639319 --> -0.665143).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5579631
	speed: 0.7146s/iter; left time: 25508.0488s
	iters: 200, epoch: 4 | loss: 0.6561697
	speed: 0.2425s/iter; left time: 8630.0416s
	iters: 300, epoch: 4 | loss: 0.5156619
	speed: 0.2420s/iter; left time: 8590.1791s
Epoch: 4 cost time: 88.95128679275513
Epoch: 4, Steps: 369 | Train Loss: 0.736 Vali Loss: 1.319 Vali Acc: 0.554 Test Loss: 1.319 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0391364
	speed: 0.7217s/iter; left time: 25494.4083s
	iters: 200, epoch: 5 | loss: 0.3869912
	speed: 0.2438s/iter; left time: 8589.0596s
	iters: 300, epoch: 5 | loss: 0.6861691
	speed: 0.2400s/iter; left time: 8428.9072s
Epoch: 5 cost time: 88.75540709495544
Epoch: 5, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.760 Vali Acc: 0.645 Test Loss: 0.760 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8568086
	speed: 0.7109s/iter; left time: 24849.9623s
	iters: 200, epoch: 6 | loss: 0.5775740
	speed: 0.2420s/iter; left time: 8434.1651s
	iters: 300, epoch: 6 | loss: 1.0339189
	speed: 0.2362s/iter; left time: 8210.7426s
Epoch: 6 cost time: 88.25121116638184
Epoch: 6, Steps: 369 | Train Loss: 0.663 Vali Loss: 0.690 Vali Acc: 0.659 Test Loss: 0.690 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8165227
	speed: 0.7143s/iter; left time: 24706.0924s
	iters: 200, epoch: 7 | loss: 0.3640772
	speed: 0.2413s/iter; left time: 8320.6775s
	iters: 300, epoch: 7 | loss: 0.3945472
	speed: 0.2394s/iter; left time: 8230.8784s
Epoch: 7 cost time: 89.28374409675598
Epoch: 7, Steps: 369 | Train Loss: 0.578 Vali Loss: 0.789 Vali Acc: 0.661 Test Loss: 0.789 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5176362
	speed: 0.7208s/iter; left time: 24664.7372s
	iters: 200, epoch: 8 | loss: 0.6118008
	speed: 0.2447s/iter; left time: 8348.9864s
	iters: 300, epoch: 8 | loss: 0.7538483
	speed: 0.2399s/iter; left time: 8161.6690s
Epoch: 8 cost time: 88.94569253921509
Epoch: 8, Steps: 369 | Train Loss: 0.523 Vali Loss: 0.679 Vali Acc: 0.679 Test Loss: 0.679 Test Acc: 0.679
Validation loss decreased (-0.665143 --> -0.679051).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4935925
	speed: 0.7201s/iter; left time: 24375.2656s
	iters: 200, epoch: 9 | loss: 0.8457370
	speed: 0.2423s/iter; left time: 8176.3697s
	iters: 300, epoch: 9 | loss: 0.5700039
	speed: 0.2413s/iter; left time: 8120.0482s
Epoch: 9 cost time: 88.93143820762634
Epoch: 9, Steps: 369 | Train Loss: 0.612 Vali Loss: 0.811 Vali Acc: 0.609 Test Loss: 0.811 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6115071
	speed: 0.7080s/iter; left time: 23704.3718s
	iters: 200, epoch: 10 | loss: 0.6170658
	speed: 0.2333s/iter; left time: 7788.5203s
	iters: 300, epoch: 10 | loss: 0.8086962
	speed: 0.2355s/iter; left time: 7837.4585s
Epoch: 10 cost time: 86.93361043930054
Epoch: 10, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.856 Vali Acc: 0.622 Test Loss: 0.856 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.7675555
	speed: 0.7095s/iter; left time: 23491.4985s
	iters: 200, epoch: 11 | loss: 0.4702584
	speed: 0.2354s/iter; left time: 7770.2743s
	iters: 300, epoch: 11 | loss: 0.4987046
	speed: 0.2358s/iter; left time: 7760.6673s
Epoch: 11 cost time: 87.66371273994446
Epoch: 11, Steps: 369 | Train Loss: 0.562 Vali Loss: 0.740 Vali Acc: 0.625 Test Loss: 0.740 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3360133
	speed: 0.7112s/iter; left time: 23286.3552s
	iters: 200, epoch: 12 | loss: 0.4664805
	speed: 0.2322s/iter; left time: 7579.5191s
	iters: 300, epoch: 12 | loss: 0.7576722
	speed: 0.2399s/iter; left time: 7806.2467s
Epoch: 12 cost time: 87.60816049575806
Epoch: 12, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.729 Vali Acc: 0.659 Test Loss: 0.729 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.5127912
	speed: 0.7041s/iter; left time: 22795.2715s
	iters: 200, epoch: 13 | loss: 1.1175312
	speed: 0.2219s/iter; left time: 7161.0494s
	iters: 300, epoch: 13 | loss: 0.2780646
	speed: 0.2261s/iter; left time: 7273.6179s
Epoch: 13 cost time: 85.14336943626404
Epoch: 13, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.885 Vali Acc: 0.650 Test Loss: 0.885 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3820520
	speed: 0.7094s/iter; left time: 22704.2966s
	iters: 200, epoch: 14 | loss: 0.5967439
	speed: 0.2394s/iter; left time: 7636.7777s
	iters: 300, epoch: 14 | loss: 0.4948569
	speed: 0.2371s/iter; left time: 7539.8132s
Epoch: 14 cost time: 89.38479137420654
Epoch: 14, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.787 Vali Acc: 0.669 Test Loss: 0.787 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6009050
	speed: 0.7150s/iter; left time: 22620.0218s
	iters: 200, epoch: 15 | loss: 0.7163262
	speed: 0.2395s/iter; left time: 7552.3943s
	iters: 300, epoch: 15 | loss: 0.4051013
	speed: 0.2413s/iter; left time: 7583.8786s
Epoch: 15 cost time: 88.66331052780151
Epoch: 15, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.714 Vali Acc: 0.676 Test Loss: 0.714 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3783274
	speed: 0.7037s/iter; left time: 22000.6234s
	iters: 200, epoch: 16 | loss: 0.3861048
	speed: 0.2380s/iter; left time: 7418.9749s
	iters: 300, epoch: 16 | loss: 0.6062847
	speed: 0.2376s/iter; left time: 7379.7832s
Epoch: 16 cost time: 88.01758527755737
Epoch: 16, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.701 Vali Acc: 0.678 Test Loss: 0.701 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0173800
	speed: 0.7092s/iter; left time: 21912.5342s
	iters: 200, epoch: 17 | loss: 0.3156568
	speed: 0.2362s/iter; left time: 7273.1174s
	iters: 300, epoch: 17 | loss: 0.3802661
	speed: 0.2363s/iter; left time: 7252.6843s
Epoch: 17 cost time: 87.55201148986816
Epoch: 17, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.746 Vali Acc: 0.677 Test Loss: 0.746 Test Acc: 0.677
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3789307
	speed: 0.7042s/iter; left time: 21497.1163s
	iters: 200, epoch: 18 | loss: 0.3282636
	speed: 0.2304s/iter; left time: 7011.8449s
	iters: 300, epoch: 18 | loss: 0.7622277
	speed: 0.2408s/iter; left time: 7303.2115s
Epoch: 18 cost time: 86.26224994659424
Epoch: 18, Steps: 369 | Train Loss: 0.440 Vali Loss: 0.723 Vali Acc: 0.669 Test Loss: 0.723 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6790578887627696
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6842712
	speed: 0.2627s/iter; left time: 9668.2378s
	iters: 200, epoch: 1 | loss: 0.6278799
	speed: 0.2329s/iter; left time: 8547.2704s
	iters: 300, epoch: 1 | loss: 1.2066488
	speed: 0.2508s/iter; left time: 9180.7340s
Epoch: 1 cost time: 91.66822075843811
Epoch: 1, Steps: 369 | Train Loss: 0.853 Vali Loss: 1.062 Vali Acc: 0.636 Test Loss: 1.062 Test Acc: 0.636
Validation loss decreased (inf --> -0.636198).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3981836
	speed: 0.7426s/iter; left time: 27055.4349s
	iters: 200, epoch: 2 | loss: 1.9070194
	speed: 0.2473s/iter; left time: 8983.6548s
	iters: 300, epoch: 2 | loss: 1.0909598
	speed: 0.2503s/iter; left time: 9068.2130s
Epoch: 2 cost time: 92.03266549110413
Epoch: 2, Steps: 369 | Train Loss: 0.898 Vali Loss: 0.762 Vali Acc: 0.596 Test Loss: 0.762 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5186104
	speed: 0.7134s/iter; left time: 25728.1454s
	iters: 200, epoch: 3 | loss: 0.5669580
	speed: 0.2452s/iter; left time: 8818.2225s
	iters: 300, epoch: 3 | loss: 0.4838709
	speed: 0.2328s/iter; left time: 8349.1945s
Epoch: 3 cost time: 88.10393643379211
Epoch: 3, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.711 Vali Acc: 0.665 Test Loss: 0.711 Test Acc: 0.665
Validation loss decreased (-0.636198 --> -0.664579).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2808680
	speed: 0.7314s/iter; left time: 26106.9388s
	iters: 200, epoch: 4 | loss: 0.3381625
	speed: 0.2426s/iter; left time: 8633.8130s
	iters: 300, epoch: 4 | loss: 0.8469317
	speed: 0.2354s/iter; left time: 8357.0156s
Epoch: 4 cost time: 89.42895078659058
Epoch: 4, Steps: 369 | Train Loss: 0.618 Vali Loss: 0.896 Vali Acc: 0.592 Test Loss: 0.896 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7740386
	speed: 0.7345s/iter; left time: 25944.8858s
	iters: 200, epoch: 5 | loss: 0.7637809
	speed: 0.2412s/iter; left time: 8495.3441s
	iters: 300, epoch: 5 | loss: 0.7303102
	speed: 0.2446s/iter; left time: 8593.2900s
Epoch: 5 cost time: 90.67502355575562
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.826 Vali Acc: 0.576 Test Loss: 0.826 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6232123
	speed: 0.7935s/iter; left time: 27739.0027s
	iters: 200, epoch: 6 | loss: 0.5864254
	speed: 0.2524s/iter; left time: 8799.3867s
	iters: 300, epoch: 6 | loss: 0.4741554
	speed: 0.2708s/iter; left time: 9412.3708s
Epoch: 6 cost time: 97.87986540794373
Epoch: 6, Steps: 369 | Train Loss: 0.598 Vali Loss: 0.939 Vali Acc: 0.620 Test Loss: 0.939 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7435802
	speed: 0.7665s/iter; left time: 26511.8279s
	iters: 200, epoch: 7 | loss: 0.9832297
	speed: 0.2655s/iter; left time: 9157.9307s
	iters: 300, epoch: 7 | loss: 0.8132216
	speed: 0.2524s/iter; left time: 8678.3380s
Epoch: 7 cost time: 94.22667479515076
Epoch: 7, Steps: 369 | Train Loss: 0.777 Vali Loss: 0.836 Vali Acc: 0.508 Test Loss: 0.836 Test Acc: 0.508
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6395598
	speed: 0.7677s/iter; left time: 26268.0766s
	iters: 200, epoch: 8 | loss: 0.9081709
	speed: 0.2544s/iter; left time: 8678.0873s
	iters: 300, epoch: 8 | loss: 0.7261538
	speed: 0.2470s/iter; left time: 8403.7985s
Epoch: 8 cost time: 94.91038680076599
Epoch: 8, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.782 Vali Acc: 0.546 Test Loss: 0.782 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6055609
	speed: 0.7877s/iter; left time: 26663.8159s
	iters: 200, epoch: 9 | loss: 0.8555608
	speed: 0.2488s/iter; left time: 8395.3694s
	iters: 300, epoch: 9 | loss: 0.8237408
	speed: 0.2528s/iter; left time: 8505.2417s
Epoch: 9 cost time: 94.03356409072876
Epoch: 9, Steps: 369 | Train Loss: 0.740 Vali Loss: 0.734 Vali Acc: 0.572 Test Loss: 0.734 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6127852
	speed: 0.7676s/iter; left time: 25699.5510s
	iters: 200, epoch: 10 | loss: 0.7307268
	speed: 0.2711s/iter; left time: 9048.7498s
	iters: 300, epoch: 10 | loss: 0.9964279
	speed: 0.2544s/iter; left time: 8467.4364s
Epoch: 10 cost time: 95.10582852363586
Epoch: 10, Steps: 369 | Train Loss: 0.718 Vali Loss: 0.710 Vali Acc: 0.594 Test Loss: 0.710 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6429302
	speed: 0.7463s/iter; left time: 24709.3949s
	iters: 200, epoch: 11 | loss: 0.6606412
	speed: 0.2434s/iter; left time: 8034.2064s
	iters: 300, epoch: 11 | loss: 0.5661011
	speed: 0.2602s/iter; left time: 8564.1297s
Epoch: 11 cost time: 93.78544211387634
Epoch: 11, Steps: 369 | Train Loss: 0.678 Vali Loss: 0.728 Vali Acc: 0.578 Test Loss: 0.728 Test Acc: 0.578
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5801443
	speed: 0.7839s/iter; left time: 25664.9862s
	iters: 200, epoch: 12 | loss: 0.5378776
	speed: 0.2557s/iter; left time: 8345.9472s
	iters: 300, epoch: 12 | loss: 0.6421326
	speed: 0.2480s/iter; left time: 8071.2732s
Epoch: 12 cost time: 94.92701125144958
Epoch: 12, Steps: 369 | Train Loss: 0.625 Vali Loss: 0.718 Vali Acc: 0.635 Test Loss: 0.718 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7699975
	speed: 0.7921s/iter; left time: 25643.2710s
	iters: 200, epoch: 13 | loss: 0.7263290
	speed: 0.2490s/iter; left time: 8034.6627s
	iters: 300, epoch: 13 | loss: 0.5938842
	speed: 0.2466s/iter; left time: 7934.7110s
Epoch: 13 cost time: 96.64537644386292
Epoch: 13, Steps: 369 | Train Loss: 0.618 Vali Loss: 0.734 Vali Acc: 0.634 Test Loss: 0.734 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6645856980703746
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6051354
	speed: 0.2731s/iter; left time: 10050.5541s
	iters: 200, epoch: 1 | loss: 0.3949151
	speed: 0.2522s/iter; left time: 9257.3263s
	iters: 300, epoch: 1 | loss: 1.1122726
	speed: 0.2507s/iter; left time: 9174.6115s
Epoch: 1 cost time: 94.89674925804138
Epoch: 1, Steps: 369 | Train Loss: 0.832 Vali Loss: 0.940 Vali Acc: 0.636 Test Loss: 0.940 Test Acc: 0.636
Validation loss decreased (inf --> -0.636199).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5990210
	speed: 0.7647s/iter; left time: 27860.6317s
	iters: 200, epoch: 2 | loss: 0.7631631
	speed: 0.2635s/iter; left time: 9572.5497s
	iters: 300, epoch: 2 | loss: 0.5618024
	speed: 0.2636s/iter; left time: 9550.5766s
Epoch: 2 cost time: 96.34704351425171
Epoch: 2, Steps: 369 | Train Loss: 0.816 Vali Loss: 0.924 Vali Acc: 0.581 Test Loss: 0.924 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6970436
	speed: 0.7411s/iter; left time: 26727.0127s
	iters: 200, epoch: 3 | loss: 0.6615812
	speed: 0.2458s/iter; left time: 8838.9121s
	iters: 300, epoch: 3 | loss: 1.1883360
	speed: 0.2525s/iter; left time: 9053.6513s
Epoch: 3 cost time: 92.81654381752014
Epoch: 3, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.778 Vali Acc: 0.690 Test Loss: 0.778 Test Acc: 0.690
Validation loss decreased (-0.636199 --> -0.690117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3465374
	speed: 0.7928s/iter; left time: 28299.0993s
	iters: 200, epoch: 4 | loss: 0.5685155
	speed: 0.2644s/iter; left time: 9409.8514s
	iters: 300, epoch: 4 | loss: 0.4509016
	speed: 0.2611s/iter; left time: 9269.1125s
Epoch: 4 cost time: 98.6924135684967
Epoch: 4, Steps: 369 | Train Loss: 0.659 Vali Loss: 0.859 Vali Acc: 0.526 Test Loss: 0.859 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8243005
	speed: 0.7716s/iter; left time: 27257.9895s
	iters: 200, epoch: 5 | loss: 0.9552880
	speed: 0.2592s/iter; left time: 9131.6707s
	iters: 300, epoch: 5 | loss: 0.6660175
	speed: 0.2560s/iter; left time: 8990.6771s
Epoch: 5 cost time: 95.28876638412476
Epoch: 5, Steps: 369 | Train Loss: 0.789 Vali Loss: 0.727 Vali Acc: 0.532 Test Loss: 0.727 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7387043
	speed: 0.7407s/iter; left time: 25890.8492s
	iters: 200, epoch: 6 | loss: 0.6825284
	speed: 0.2310s/iter; left time: 8051.9628s
	iters: 300, epoch: 6 | loss: 0.6708325
	speed: 0.2373s/iter; left time: 8246.7128s
Epoch: 6 cost time: 86.85297703742981
Epoch: 6, Steps: 369 | Train Loss: 0.800 Vali Loss: 0.958 Vali Acc: 0.551 Test Loss: 0.958 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2634490
	speed: 0.7060s/iter; left time: 24416.7726s
	iters: 200, epoch: 7 | loss: 0.4857428
	speed: 0.2299s/iter; left time: 7928.5032s
	iters: 300, epoch: 7 | loss: 0.5858293
	speed: 0.2352s/iter; left time: 8087.0694s
Epoch: 7 cost time: 86.30413699150085
Epoch: 7, Steps: 369 | Train Loss: 0.800 Vali Loss: 0.764 Vali Acc: 0.547 Test Loss: 0.764 Test Acc: 0.547
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5991857
	speed: 0.7137s/iter; left time: 24422.9732s
	iters: 200, epoch: 8 | loss: 0.7206078
	speed: 0.2390s/iter; left time: 8153.9202s
	iters: 300, epoch: 8 | loss: 0.7696753
	speed: 0.2374s/iter; left time: 8077.3848s
Epoch: 8 cost time: 87.99011087417603
Epoch: 8, Steps: 369 | Train Loss: 0.754 Vali Loss: 0.769 Vali Acc: 0.543 Test Loss: 0.769 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6602928
	speed: 0.7186s/iter; left time: 24325.3256s
	iters: 200, epoch: 9 | loss: 0.6982545
	speed: 0.2370s/iter; left time: 7997.1860s
	iters: 300, epoch: 9 | loss: 0.9577637
	speed: 0.2380s/iter; left time: 8009.8385s
Epoch: 9 cost time: 88.62819981575012
Epoch: 9, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.777 Vali Acc: 0.585 Test Loss: 0.777 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7422904
	speed: 0.7401s/iter; left time: 24778.5914s
	iters: 200, epoch: 10 | loss: 0.5841106
	speed: 0.2433s/iter; left time: 8122.5984s
	iters: 300, epoch: 10 | loss: 0.9072007
	speed: 0.2496s/iter; left time: 8307.9066s
Epoch: 10 cost time: 90.59236550331116
Epoch: 10, Steps: 369 | Train Loss: 0.681 Vali Loss: 0.775 Vali Acc: 0.593 Test Loss: 0.775 Test Acc: 0.593
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6618490
	speed: 0.7405s/iter; left time: 24517.4884s
	iters: 200, epoch: 11 | loss: 0.6561638
	speed: 0.2496s/iter; left time: 8238.2259s
	iters: 300, epoch: 11 | loss: 0.5816658
	speed: 0.2458s/iter; left time: 8088.0604s
Epoch: 11 cost time: 92.14072942733765
Epoch: 11, Steps: 369 | Train Loss: 0.640 Vali Loss: 0.732 Vali Acc: 0.637 Test Loss: 0.732 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5230693
	speed: 0.7135s/iter; left time: 23362.1340s
	iters: 200, epoch: 12 | loss: 0.7829245
	speed: 0.2360s/iter; left time: 7702.7956s
	iters: 300, epoch: 12 | loss: 0.6943205
	speed: 0.2256s/iter; left time: 7342.4202s
Epoch: 12 cost time: 86.52399682998657
Epoch: 12, Steps: 369 | Train Loss: 0.629 Vali Loss: 0.740 Vali Acc: 0.620 Test Loss: 0.740 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6309523
	speed: 0.7149s/iter; left time: 23141.9492s
	iters: 200, epoch: 13 | loss: 0.8964108
	speed: 0.2335s/iter; left time: 7534.9599s
	iters: 300, epoch: 13 | loss: 0.6420951
	speed: 0.2267s/iter; left time: 7294.6264s
Epoch: 13 cost time: 85.46705508232117
Epoch: 13, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.728 Vali Acc: 0.638 Test Loss: 0.728 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6901248581157775
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6938000
	speed: 0.2402s/iter; left time: 8840.7543s
	iters: 200, epoch: 1 | loss: 0.6931474
	speed: 0.2298s/iter; left time: 8434.8081s
	iters: 300, epoch: 1 | loss: 0.6926152
	speed: 0.2288s/iter; left time: 8374.3615s
Epoch: 1 cost time: 85.7504255771637
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6929516
	speed: 0.6817s/iter; left time: 24836.0861s
	iters: 200, epoch: 2 | loss: 0.6931657
	speed: 0.2253s/iter; left time: 8187.0324s
	iters: 300, epoch: 2 | loss: 0.6922579
	speed: 0.2255s/iter; left time: 8169.0234s
Epoch: 2 cost time: 83.13777446746826
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6893951
	speed: 0.7130s/iter; left time: 25713.7944s
	iters: 200, epoch: 3 | loss: 0.6923607
	speed: 0.2210s/iter; left time: 7947.7741s
	iters: 300, epoch: 3 | loss: 0.6932610
	speed: 0.2222s/iter; left time: 7967.2937s
Epoch: 3 cost time: 84.06938052177429
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6922861
	speed: 0.6964s/iter; left time: 24856.3953s
	iters: 200, epoch: 4 | loss: 0.6912521
	speed: 0.2195s/iter; left time: 7814.3100s
	iters: 300, epoch: 4 | loss: 0.6931497
	speed: 0.2309s/iter; left time: 8194.9428s
Epoch: 4 cost time: 84.99359726905823
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6927922
	speed: 0.7076s/iter; left time: 24995.1943s
	iters: 200, epoch: 5 | loss: 0.6930901
	speed: 0.2297s/iter; left time: 8092.0726s
	iters: 300, epoch: 5 | loss: 0.6933627
	speed: 0.2291s/iter; left time: 8046.1257s
Epoch: 5 cost time: 85.59712934494019
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6931754
	speed: 0.7064s/iter; left time: 24691.8664s
	iters: 200, epoch: 6 | loss: 0.6933265
	speed: 0.2344s/iter; left time: 8170.4371s
	iters: 300, epoch: 6 | loss: 0.6913341
	speed: 0.2463s/iter; left time: 8561.1482s
Epoch: 6 cost time: 89.84402251243591
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6937020
	speed: 0.8078s/iter; left time: 27938.2865s
	iters: 200, epoch: 7 | loss: 0.6930134
	speed: 0.2706s/iter; left time: 9333.4834s
	iters: 300, epoch: 7 | loss: 0.6939509
	speed: 0.2712s/iter; left time: 9325.2726s
Epoch: 7 cost time: 99.91547679901123
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6927546
	speed: 0.8404s/iter; left time: 28755.9489s
	iters: 200, epoch: 8 | loss: 0.6877229
	speed: 0.2746s/iter; left time: 9367.3711s
	iters: 300, epoch: 8 | loss: 0.6926816
	speed: 0.2714s/iter; left time: 9230.9314s
Epoch: 8 cost time: 101.19270491600037
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6928975
	speed: 0.8407s/iter; left time: 28455.4526s
	iters: 200, epoch: 9 | loss: 0.6929948
	speed: 0.2729s/iter; left time: 9208.6389s
	iters: 300, epoch: 9 | loss: 0.6931559
	speed: 0.2743s/iter; left time: 9231.5452s
Epoch: 9 cost time: 102.01495480537415
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6931627
	speed: 0.8825s/iter; left time: 29544.4345s
	iters: 200, epoch: 10 | loss: 0.6931566
	speed: 0.2813s/iter; left time: 9391.1310s
	iters: 300, epoch: 10 | loss: 0.6931483
	speed: 0.2783s/iter; left time: 9262.8057s
Epoch: 10 cost time: 103.74500560760498
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6961550
	speed: 0.8742s/iter; left time: 28945.8194s
	iters: 200, epoch: 11 | loss: 0.6943629
	speed: 0.2672s/iter; left time: 8819.0152s
	iters: 300, epoch: 11 | loss: 0.6937301
	speed: 0.2800s/iter; left time: 9213.9061s
Epoch: 11 cost time: 103.26572060585022
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 14793218
model size : 75.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7370754
	speed: 0.3074s/iter; left time: 11310.9030s
	iters: 200, epoch: 1 | loss: 0.8602519
	speed: 0.2820s/iter; left time: 10350.6487s
	iters: 300, epoch: 1 | loss: 0.3090936
	speed: 0.2837s/iter; left time: 10384.2089s
Epoch: 1 cost time: 106.84889388084412
Epoch: 1, Steps: 369 | Train Loss: 0.789 Vali Loss: 1.151 Vali Acc: 0.626 Test Loss: 1.151 Test Acc: 0.626
Validation loss decreased (inf --> -0.625698).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9244547
	speed: 0.9011s/iter; left time: 32828.9572s
	iters: 200, epoch: 2 | loss: 0.8035905
	speed: 0.2910s/iter; left time: 10574.0934s
	iters: 300, epoch: 2 | loss: 2.1365664
	speed: 0.2867s/iter; left time: 10386.6495s
Epoch: 2 cost time: 106.85327816009521
Epoch: 2, Steps: 369 | Train Loss: 1.042 Vali Loss: 1.808 Vali Acc: 0.620 Test Loss: 1.808 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6888487
	speed: 0.8867s/iter; left time: 31977.5823s
	iters: 200, epoch: 3 | loss: 2.0529511
	speed: 0.2811s/iter; left time: 10108.9931s
	iters: 300, epoch: 3 | loss: 0.6717261
	speed: 0.2918s/iter; left time: 10466.5057s
Epoch: 3 cost time: 107.18483996391296
Epoch: 3, Steps: 369 | Train Loss: 1.127 Vali Loss: 0.668 Vali Acc: 0.641 Test Loss: 0.668 Test Acc: 0.641
Validation loss decreased (-0.625698 --> -0.641026).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5015488
	speed: 0.9242s/iter; left time: 32988.7954s
	iters: 200, epoch: 4 | loss: 0.6897700
	speed: 0.2911s/iter; left time: 10360.7199s
	iters: 300, epoch: 4 | loss: 0.4408102
	speed: 0.2950s/iter; left time: 10469.8226s
Epoch: 4 cost time: 108.17129230499268
Epoch: 4, Steps: 369 | Train Loss: 0.811 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
Validation loss decreased (-0.641026 --> -0.649819).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3783221
	speed: 0.8956s/iter; left time: 31635.7085s
	iters: 200, epoch: 5 | loss: 0.7577868
	speed: 0.2854s/iter; left time: 10052.2912s
	iters: 300, epoch: 5 | loss: 0.6408213
	speed: 0.2861s/iter; left time: 10050.0366s
Epoch: 5 cost time: 107.39698886871338
Epoch: 5, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.738 Vali Acc: 0.663 Test Loss: 0.738 Test Acc: 0.663
Validation loss decreased (-0.649819 --> -0.662592).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7093337
	speed: 0.9055s/iter; left time: 31652.1681s
	iters: 200, epoch: 6 | loss: 0.3294385
	speed: 0.2925s/iter; left time: 10194.5995s
	iters: 300, epoch: 6 | loss: 0.5691597
	speed: 0.2747s/iter; left time: 9546.0539s
Epoch: 6 cost time: 104.8479962348938
Epoch: 6, Steps: 369 | Train Loss: 0.683 Vali Loss: 0.813 Vali Acc: 0.633 Test Loss: 0.813 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5706043
	speed: 0.8964s/iter; left time: 31002.7105s
	iters: 200, epoch: 7 | loss: 1.0121856
	speed: 0.2776s/iter; left time: 9572.0927s
	iters: 300, epoch: 7 | loss: 0.5149295
	speed: 0.2814s/iter; left time: 9677.0125s
Epoch: 7 cost time: 104.66006898880005
Epoch: 7, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.794 Vali Acc: 0.618 Test Loss: 0.794 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5463403
	speed: 0.8977s/iter; left time: 30718.7372s
	iters: 200, epoch: 8 | loss: 0.6016104
	speed: 0.2768s/iter; left time: 9444.1382s
	iters: 300, epoch: 8 | loss: 0.6041940
	speed: 0.2786s/iter; left time: 9477.2770s
Epoch: 8 cost time: 102.9986138343811
Epoch: 8, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.766 Vali Acc: 0.589 Test Loss: 0.766 Test Acc: 0.589
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6287248
	speed: 0.9000s/iter; left time: 30464.9562s
	iters: 200, epoch: 9 | loss: 0.5938854
	speed: 0.2816s/iter; left time: 9505.0525s
	iters: 300, epoch: 9 | loss: 0.3421595
	speed: 0.2875s/iter; left time: 9673.8285s
Epoch: 9 cost time: 105.94195914268494
Epoch: 9, Steps: 369 | Train Loss: 0.603 Vali Loss: 0.731 Vali Acc: 0.651 Test Loss: 0.731 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6473042
	speed: 0.9110s/iter; left time: 30499.4227s
	iters: 200, epoch: 10 | loss: 0.5293733
	speed: 0.2927s/iter; left time: 9770.1445s
	iters: 300, epoch: 10 | loss: 0.7983192
	speed: 0.2829s/iter; left time: 9416.0416s
Epoch: 10 cost time: 105.09960103034973
Epoch: 10, Steps: 369 | Train Loss: 0.579 Vali Loss: 0.822 Vali Acc: 0.667 Test Loss: 0.822 Test Acc: 0.667
Validation loss decreased (-0.662592 --> -0.667131).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3339560
	speed: 0.9118s/iter; left time: 30190.5838s
	iters: 200, epoch: 11 | loss: 0.6837494
	speed: 0.2841s/iter; left time: 9378.9433s
	iters: 300, epoch: 11 | loss: 0.3164296
	speed: 0.2789s/iter; left time: 9179.4450s
Epoch: 11 cost time: 105.72294616699219
Epoch: 11, Steps: 369 | Train Loss: 0.551 Vali Loss: 0.688 Vali Acc: 0.662 Test Loss: 0.688 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5390177
	speed: 0.9209s/iter; left time: 30152.9874s
	iters: 200, epoch: 12 | loss: 0.4475616
	speed: 0.2875s/iter; left time: 9385.7946s
	iters: 300, epoch: 12 | loss: 0.5201120
	speed: 0.2780s/iter; left time: 9045.0870s
Epoch: 12 cost time: 106.27795124053955
Epoch: 12, Steps: 369 | Train Loss: 0.537 Vali Loss: 0.798 Vali Acc: 0.647 Test Loss: 0.798 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4952524
	speed: 0.9087s/iter; left time: 29416.7345s
	iters: 200, epoch: 13 | loss: 0.5156869
	speed: 0.2829s/iter; left time: 9130.8892s
	iters: 300, epoch: 13 | loss: 0.3805410
	speed: 0.2864s/iter; left time: 9213.1749s
Epoch: 13 cost time: 106.70315313339233
Epoch: 13, Steps: 369 | Train Loss: 0.515 Vali Loss: 0.687 Vali Acc: 0.654 Test Loss: 0.687 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4316706
	speed: 0.8967s/iter; left time: 28698.8438s
	iters: 200, epoch: 14 | loss: 0.4101216
	speed: 0.2946s/iter; left time: 9397.5960s
	iters: 300, epoch: 14 | loss: 0.7568231
	speed: 0.2868s/iter; left time: 9120.8247s
Epoch: 14 cost time: 107.26266169548035
Epoch: 14, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.693 Vali Acc: 0.654 Test Loss: 0.693 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6077527
	speed: 0.8875s/iter; left time: 28076.8938s
	iters: 200, epoch: 15 | loss: 0.4900139
	speed: 0.2845s/iter; left time: 8973.2379s
	iters: 300, epoch: 15 | loss: 0.3281702
	speed: 0.2835s/iter; left time: 8911.6492s
Epoch: 15 cost time: 105.27405858039856
Epoch: 15, Steps: 369 | Train Loss: 0.508 Vali Loss: 0.645 Vali Acc: 0.663 Test Loss: 0.645 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.6221057
	speed: 0.8920s/iter; left time: 27889.4817s
	iters: 200, epoch: 16 | loss: 0.4368432
	speed: 0.2775s/iter; left time: 8648.6843s
	iters: 300, epoch: 16 | loss: 0.7084662
	speed: 0.2802s/iter; left time: 8706.0253s
Epoch: 16 cost time: 104.1133189201355
Epoch: 16, Steps: 369 | Train Loss: 0.494 Vali Loss: 0.832 Vali Acc: 0.655 Test Loss: 0.832 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.3238118
	speed: 0.9130s/iter; left time: 28210.2682s
	iters: 200, epoch: 17 | loss: 0.6269621
	speed: 0.2944s/iter; left time: 9067.4235s
	iters: 300, epoch: 17 | loss: 0.4073764
	speed: 0.2851s/iter; left time: 8752.0323s
Epoch: 17 cost time: 106.64180135726929
Epoch: 17, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.790 Vali Acc: 0.686 Test Loss: 0.790 Test Acc: 0.686
Validation loss decreased (-0.667131 --> -0.686144).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2619433
	speed: 0.8950s/iter; left time: 27323.2445s
	iters: 200, epoch: 18 | loss: 0.1079300
	speed: 0.2846s/iter; left time: 8658.6545s
	iters: 300, epoch: 18 | loss: 0.3709493
	speed: 0.2854s/iter; left time: 8654.9970s
Epoch: 18 cost time: 105.42341995239258
Epoch: 18, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.725 Vali Acc: 0.680 Test Loss: 0.725 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4512829
	speed: 0.9125s/iter; left time: 27521.0117s
	iters: 200, epoch: 19 | loss: 0.3657134
	speed: 0.2868s/iter; left time: 8621.2874s
	iters: 300, epoch: 19 | loss: 0.2754242
	speed: 0.2740s/iter; left time: 8207.3030s
Epoch: 19 cost time: 104.42644429206848
Epoch: 19, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.779 Vali Acc: 0.682 Test Loss: 0.779 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.7423987
	speed: 0.8859s/iter; left time: 26391.3983s
	iters: 200, epoch: 20 | loss: 0.3092678
	speed: 0.2799s/iter; left time: 8309.4642s
	iters: 300, epoch: 20 | loss: 0.5119842
	speed: 0.2924s/iter; left time: 8651.6375s
Epoch: 20 cost time: 106.53312110900879
Epoch: 20, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.699 Vali Acc: 0.690 Test Loss: 0.699 Test Acc: 0.690
Validation loss decreased (-0.686144 --> -0.690402).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1986908
	speed: 0.8998s/iter; left time: 26472.1663s
	iters: 200, epoch: 21 | loss: 0.3428152
	speed: 0.2864s/iter; left time: 8396.1294s
	iters: 300, epoch: 21 | loss: 0.3526336
	speed: 0.2978s/iter; left time: 8701.9791s
Epoch: 21 cost time: 107.40869688987732
Epoch: 21, Steps: 369 | Train Loss: 0.408 Vali Loss: 0.794 Vali Acc: 0.681 Test Loss: 0.794 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6640747
	speed: 0.9158s/iter; left time: 26605.9650s
	iters: 200, epoch: 22 | loss: 0.6600906
	speed: 0.2958s/iter; left time: 8565.3729s
	iters: 300, epoch: 22 | loss: 0.3109776
	speed: 0.2996s/iter; left time: 8643.3631s
Epoch: 22 cost time: 108.56565833091736
Epoch: 22, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.779 Vali Acc: 0.682 Test Loss: 0.779 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4141143
	speed: 0.9081s/iter; left time: 26046.8939s
	iters: 200, epoch: 23 | loss: 0.5539357
	speed: 0.2948s/iter; left time: 8425.0764s
	iters: 300, epoch: 23 | loss: 0.2300911
	speed: 0.2779s/iter; left time: 7915.0493s
Epoch: 23 cost time: 108.23973965644836
Epoch: 23, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.815 Vali Acc: 0.688 Test Loss: 0.815 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3255726
	speed: 0.9316s/iter; left time: 26377.3617s
	iters: 200, epoch: 24 | loss: 0.2842087
	speed: 0.2893s/iter; left time: 8163.1687s
	iters: 300, epoch: 24 | loss: 0.4524353
	speed: 0.2870s/iter; left time: 8069.4369s
Epoch: 24 cost time: 106.95788764953613
Epoch: 24, Steps: 369 | Train Loss: 0.362 Vali Loss: 0.710 Vali Acc: 0.692 Test Loss: 0.710 Test Acc: 0.692
Validation loss decreased (-0.690402 --> -0.692104).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.2278626
	speed: 0.9083s/iter; left time: 25383.0017s
	iters: 200, epoch: 25 | loss: 0.4462706
	speed: 0.2983s/iter; left time: 8305.6338s
	iters: 300, epoch: 25 | loss: 0.1949326
	speed: 0.2829s/iter; left time: 7849.4041s
Epoch: 25 cost time: 107.99272322654724
Epoch: 25, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.786 Vali Acc: 0.678 Test Loss: 0.786 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.3263388
	speed: 0.9079s/iter; left time: 25036.1873s
	iters: 200, epoch: 26 | loss: 0.5447966
	speed: 0.2802s/iter; left time: 7699.0583s
	iters: 300, epoch: 26 | loss: 0.6551837
	speed: 0.2908s/iter; left time: 7960.1619s
Epoch: 26 cost time: 106.1736011505127
Epoch: 26, Steps: 369 | Train Loss: 0.323 Vali Loss: 0.924 Vali Acc: 0.676 Test Loss: 0.924 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3572809
	speed: 0.8815s/iter; left time: 23981.8336s
	iters: 200, epoch: 27 | loss: 0.3807314
	speed: 0.2814s/iter; left time: 7628.3415s
	iters: 300, epoch: 27 | loss: 0.5202591
	speed: 0.2920s/iter; left time: 7885.8888s
Epoch: 27 cost time: 106.1117844581604
Epoch: 27, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0546542
	speed: 0.9186s/iter; left time: 24653.0363s
	iters: 200, epoch: 28 | loss: 0.2583532
	speed: 0.2923s/iter; left time: 7814.2394s
	iters: 300, epoch: 28 | loss: 0.1568308
	speed: 0.2800s/iter; left time: 7458.4441s
Epoch: 28 cost time: 105.3150794506073
Epoch: 28, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.001 Vali Acc: 0.666 Test Loss: 1.001 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.1827689
	speed: 0.8777s/iter; left time: 23231.6448s
	iters: 200, epoch: 29 | loss: 0.0325586
	speed: 0.2880s/iter; left time: 7595.3438s
	iters: 300, epoch: 29 | loss: 0.7137033
	speed: 0.2789s/iter; left time: 7326.7576s
Epoch: 29 cost time: 104.4397611618042
Epoch: 29, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.036 Vali Acc: 0.678 Test Loss: 1.036 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0828123
	speed: 0.8882s/iter; left time: 23182.1607s
	iters: 200, epoch: 30 | loss: 0.2616041
	speed: 0.2769s/iter; left time: 7199.8018s
	iters: 300, epoch: 30 | loss: 0.1105134
	speed: 0.2812s/iter; left time: 7283.2276s
Epoch: 30 cost time: 104.07715201377869
Epoch: 30, Steps: 369 | Train Loss: 0.181 Vali Loss: 1.124 Vali Acc: 0.662 Test Loss: 1.124 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.1157110
	speed: 0.9042s/iter; left time: 23267.0671s
	iters: 200, epoch: 31 | loss: 0.1142744
	speed: 0.2917s/iter; left time: 7476.9875s
	iters: 300, epoch: 31 | loss: 0.1376629
	speed: 0.2810s/iter; left time: 7175.4152s
Epoch: 31 cost time: 106.77455163002014
Epoch: 31, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.207 Vali Acc: 0.667 Test Loss: 1.207 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0983989
	speed: 0.9044s/iter; left time: 22937.2465s
	iters: 200, epoch: 32 | loss: 0.0468238
	speed: 0.2825s/iter; left time: 7137.3294s
	iters: 300, epoch: 32 | loss: 0.0703693
	speed: 0.2898s/iter; left time: 7292.2448s
Epoch: 32 cost time: 106.33472752571106
Epoch: 32, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.616 Vali Acc: 0.662 Test Loss: 1.616 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0487989
	speed: 0.8987s/iter; left time: 22460.6750s
	iters: 200, epoch: 33 | loss: 0.0631434
	speed: 0.2844s/iter; left time: 7079.1256s
	iters: 300, epoch: 33 | loss: 0.0037986
	speed: 0.2878s/iter; left time: 7134.7243s
Epoch: 33 cost time: 104.97859740257263
Epoch: 33, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.395 Vali Acc: 0.668 Test Loss: 1.395 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0434506
	speed: 0.8894s/iter; left time: 21900.1674s
	iters: 200, epoch: 34 | loss: 0.2234779
	speed: 0.2798s/iter; left time: 6862.6166s
	iters: 300, epoch: 34 | loss: 0.0079607
	speed: 0.2753s/iter; left time: 6724.6622s
Epoch: 34 cost time: 103.10539746284485
Epoch: 34, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.769 Vali Acc: 0.675 Test Loss: 1.769 Test Acc: 0.675
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.69211123723042
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7416966
	speed: 0.3124s/iter; left time: 11496.5049s
	iters: 200, epoch: 1 | loss: 0.5795234
	speed: 0.3017s/iter; left time: 11072.3106s
	iters: 300, epoch: 1 | loss: 0.4114951
	speed: 0.2907s/iter; left time: 10640.5242s
Epoch: 1 cost time: 110.89423537254333
Epoch: 1, Steps: 369 | Train Loss: 0.815 Vali Loss: 1.010 Vali Acc: 0.641 Test Loss: 1.010 Test Acc: 0.641
Validation loss decreased (inf --> -0.641023).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7339656
	speed: 0.9020s/iter; left time: 32863.2279s
	iters: 200, epoch: 2 | loss: 0.9278306
	speed: 0.2638s/iter; left time: 9585.0580s
	iters: 300, epoch: 2 | loss: 1.2830997
	speed: 0.3007s/iter; left time: 10894.6823s
Epoch: 2 cost time: 106.47583389282227
Epoch: 2, Steps: 369 | Train Loss: 1.005 Vali Loss: 1.787 Vali Acc: 0.639 Test Loss: 1.787 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2101469
	speed: 0.9078s/iter; left time: 32738.2131s
	iters: 200, epoch: 3 | loss: 0.6699085
	speed: 0.2882s/iter; left time: 10363.1571s
	iters: 300, epoch: 3 | loss: 1.4646621
	speed: 0.2807s/iter; left time: 10065.2833s
Epoch: 3 cost time: 105.55222392082214
Epoch: 3, Steps: 369 | Train Loss: 1.158 Vali Loss: 1.763 Vali Acc: 0.568 Test Loss: 1.763 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7501493
	speed: 0.8532s/iter; left time: 30453.8392s
	iters: 200, epoch: 4 | loss: 0.3290782
	speed: 0.2871s/iter; left time: 10217.3957s
	iters: 300, epoch: 4 | loss: 0.4053670
	speed: 0.2723s/iter; left time: 9664.1232s
Epoch: 4 cost time: 102.72246360778809
Epoch: 4, Steps: 369 | Train Loss: 0.963 Vali Loss: 1.027 Vali Acc: 0.672 Test Loss: 1.027 Test Acc: 0.672
Validation loss decreased (-0.641023 --> -0.671953).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3368956
	speed: 0.9129s/iter; left time: 32247.5024s
	iters: 200, epoch: 5 | loss: 0.6493989
	speed: 0.2793s/iter; left time: 9838.1562s
	iters: 300, epoch: 5 | loss: 0.7292927
	speed: 0.2758s/iter; left time: 9687.9925s
Epoch: 5 cost time: 105.53076696395874
Epoch: 5, Steps: 369 | Train Loss: 0.762 Vali Loss: 0.786 Vali Acc: 0.657 Test Loss: 0.786 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5054504
	speed: 0.8934s/iter; left time: 31228.6074s
	iters: 200, epoch: 6 | loss: 0.4003344
	speed: 0.2749s/iter; left time: 9581.3493s
	iters: 300, epoch: 6 | loss: 0.4343547
	speed: 0.2823s/iter; left time: 9812.2148s
Epoch: 6 cost time: 104.14865159988403
Epoch: 6, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.803 Vali Acc: 0.616 Test Loss: 0.803 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7305123
	speed: 0.8782s/iter; left time: 30372.6475s
	iters: 200, epoch: 7 | loss: 1.0859375
	speed: 0.2793s/iter; left time: 9633.0921s
	iters: 300, epoch: 7 | loss: 0.6631008
	speed: 0.2766s/iter; left time: 9510.5844s
Epoch: 7 cost time: 103.70764899253845
Epoch: 7, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.837 Vali Acc: 0.621 Test Loss: 0.837 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4706829
	speed: 0.8768s/iter; left time: 30004.0394s
	iters: 200, epoch: 8 | loss: 0.4904637
	speed: 0.2892s/iter; left time: 9866.9198s
	iters: 300, epoch: 8 | loss: 0.6395578
	speed: 0.2793s/iter; left time: 9501.2420s
Epoch: 8 cost time: 106.08209872245789
Epoch: 8, Steps: 369 | Train Loss: 0.622 Vali Loss: 0.738 Vali Acc: 0.631 Test Loss: 0.738 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5004605
	speed: 0.8790s/iter; left time: 29752.9921s
	iters: 200, epoch: 9 | loss: 0.3753018
	speed: 0.2772s/iter; left time: 9353.8729s
	iters: 300, epoch: 9 | loss: 0.4209675
	speed: 0.2684s/iter; left time: 9032.1130s
Epoch: 9 cost time: 102.92660856246948
Epoch: 9, Steps: 369 | Train Loss: 0.582 Vali Loss: 0.757 Vali Acc: 0.639 Test Loss: 0.757 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.4997367
	speed: 0.8758s/iter; left time: 29322.3233s
	iters: 200, epoch: 10 | loss: 0.4581652
	speed: 0.2877s/iter; left time: 9603.2976s
	iters: 300, epoch: 10 | loss: 0.5970664
	speed: 0.2748s/iter; left time: 9145.7043s
Epoch: 10 cost time: 105.62589502334595
Epoch: 10, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.905 Vali Acc: 0.641 Test Loss: 0.905 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4389318
	speed: 0.8901s/iter; left time: 29473.4160s
	iters: 200, epoch: 11 | loss: 0.4050418
	speed: 0.2773s/iter; left time: 9154.1971s
	iters: 300, epoch: 11 | loss: 0.3465920
	speed: 0.2896s/iter; left time: 9531.0196s
Epoch: 11 cost time: 106.31520462036133
Epoch: 11, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.713 Vali Acc: 0.652 Test Loss: 0.713 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4907539
	speed: 0.8976s/iter; left time: 29388.7936s
	iters: 200, epoch: 12 | loss: 0.7925587
	speed: 0.2915s/iter; left time: 9514.6803s
	iters: 300, epoch: 12 | loss: 0.4910722
	speed: 0.2919s/iter; left time: 9497.4984s
Epoch: 12 cost time: 105.91425061225891
Epoch: 12, Steps: 369 | Train Loss: 0.523 Vali Loss: 0.773 Vali Acc: 0.662 Test Loss: 0.773 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5082999
	speed: 0.8867s/iter; left time: 28706.1779s
	iters: 200, epoch: 13 | loss: 0.3944328
	speed: 0.2870s/iter; left time: 9262.4669s
	iters: 300, epoch: 13 | loss: 0.3150844
	speed: 0.2900s/iter; left time: 9331.6803s
Epoch: 13 cost time: 106.83323812484741
Epoch: 13, Steps: 369 | Train Loss: 0.505 Vali Loss: 0.643 Vali Acc: 0.680 Test Loss: 0.643 Test Acc: 0.680
Validation loss decreased (-0.671953 --> -0.680470).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4583346
	speed: 0.8820s/iter; left time: 28227.7504s
	iters: 200, epoch: 14 | loss: 0.4627817
	speed: 0.2906s/iter; left time: 9269.8817s
	iters: 300, epoch: 14 | loss: 0.9088171
	speed: 0.2845s/iter; left time: 9047.0742s
Epoch: 14 cost time: 105.68662810325623
Epoch: 14, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.700 Vali Acc: 0.670 Test Loss: 0.700 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4524270
	speed: 0.8994s/iter; left time: 28452.2726s
	iters: 200, epoch: 15 | loss: 0.3567264
	speed: 0.2808s/iter; left time: 8854.7172s
	iters: 300, epoch: 15 | loss: 0.1822513
	speed: 0.2798s/iter; left time: 8796.2446s
Epoch: 15 cost time: 104.00067687034607
Epoch: 15, Steps: 369 | Train Loss: 0.468 Vali Loss: 0.683 Vali Acc: 0.680 Test Loss: 0.683 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5632448
	speed: 0.8272s/iter; left time: 25862.1732s
	iters: 200, epoch: 16 | loss: 0.5480442
	speed: 0.2758s/iter; left time: 8595.3628s
	iters: 300, epoch: 16 | loss: 0.5673711
	speed: 0.2767s/iter; left time: 8595.1275s
Epoch: 16 cost time: 102.09103441238403
Epoch: 16, Steps: 369 | Train Loss: 0.470 Vali Loss: 0.708 Vali Acc: 0.674 Test Loss: 0.708 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4531806
	speed: 0.8897s/iter; left time: 27487.7881s
	iters: 200, epoch: 17 | loss: 0.7888936
	speed: 0.2769s/iter; left time: 8527.2929s
	iters: 300, epoch: 17 | loss: 0.5059699
	speed: 0.2722s/iter; left time: 8355.6046s
Epoch: 17 cost time: 103.63408017158508
Epoch: 17, Steps: 369 | Train Loss: 0.464 Vali Loss: 0.731 Vali Acc: 0.656 Test Loss: 0.731 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2857250
	speed: 0.8938s/iter; left time: 27286.9839s
	iters: 200, epoch: 18 | loss: 0.2051717
	speed: 0.2882s/iter; left time: 8767.8897s
	iters: 300, epoch: 18 | loss: 0.2738256
	speed: 0.2766s/iter; left time: 8388.1027s
Epoch: 18 cost time: 105.09199118614197
Epoch: 18, Steps: 369 | Train Loss: 0.458 Vali Loss: 0.715 Vali Acc: 0.679 Test Loss: 0.715 Test Acc: 0.679
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3895226
	speed: 0.8616s/iter; left time: 25985.2151s
	iters: 200, epoch: 19 | loss: 0.2187319
	speed: 0.2793s/iter; left time: 8394.3546s
	iters: 300, epoch: 19 | loss: 0.5062004
	speed: 0.2791s/iter; left time: 8360.7861s
Epoch: 19 cost time: 103.62037229537964
Epoch: 19, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.701 Vali Acc: 0.688 Test Loss: 0.701 Test Acc: 0.688
Validation loss decreased (-0.680470 --> -0.687848).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5674142
	speed: 0.8836s/iter; left time: 26322.1763s
	iters: 200, epoch: 20 | loss: 0.3071823
	speed: 0.2732s/iter; left time: 8110.0636s
	iters: 300, epoch: 20 | loss: 0.5332160
	speed: 0.2745s/iter; left time: 8122.7018s
Epoch: 20 cost time: 102.66808032989502
Epoch: 20, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.710 Vali Acc: 0.692 Test Loss: 0.710 Test Acc: 0.692
Validation loss decreased (-0.687848 --> -0.692104).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3233422
	speed: 0.8890s/iter; left time: 26154.2452s
	iters: 200, epoch: 21 | loss: 0.3171526
	speed: 0.2848s/iter; left time: 8349.7869s
	iters: 300, epoch: 21 | loss: 0.3541277
	speed: 0.2794s/iter; left time: 8165.3481s
Epoch: 21 cost time: 104.00013518333435
Epoch: 21, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.738 Vali Acc: 0.679 Test Loss: 0.738 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2147345
	speed: 0.8686s/iter; left time: 25233.8201s
	iters: 200, epoch: 22 | loss: 0.7260464
	speed: 0.2725s/iter; left time: 7890.7842s
	iters: 300, epoch: 22 | loss: 0.3406098
	speed: 0.2657s/iter; left time: 7666.4114s
Epoch: 22 cost time: 100.67951250076294
Epoch: 22, Steps: 369 | Train Loss: 0.391 Vali Loss: 0.780 Vali Acc: 0.688 Test Loss: 0.780 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4632934
	speed: 0.8658s/iter; left time: 24833.1013s
	iters: 200, epoch: 23 | loss: 0.4018342
	speed: 0.2695s/iter; left time: 7702.9450s
	iters: 300, epoch: 23 | loss: 0.4046667
	speed: 0.2704s/iter; left time: 7701.6374s
Epoch: 23 cost time: 100.78597593307495
Epoch: 23, Steps: 369 | Train Loss: 0.372 Vali Loss: 0.841 Vali Acc: 0.669 Test Loss: 0.841 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3772706
	speed: 0.8842s/iter; left time: 25034.5264s
	iters: 200, epoch: 24 | loss: 0.2662718
	speed: 0.2653s/iter; left time: 7484.6205s
	iters: 300, epoch: 24 | loss: 0.3733515
	speed: 0.2707s/iter; left time: 7610.9548s
Epoch: 24 cost time: 101.95627403259277
Epoch: 24, Steps: 369 | Train Loss: 0.370 Vali Loss: 0.699 Vali Acc: 0.688 Test Loss: 0.699 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1929685
	speed: 0.8816s/iter; left time: 24636.8249s
	iters: 200, epoch: 25 | loss: 0.2722495
	speed: 0.2814s/iter; left time: 7835.0156s
	iters: 300, epoch: 25 | loss: 0.0979207
	speed: 0.2824s/iter; left time: 7836.1713s
Epoch: 25 cost time: 104.60023236274719
Epoch: 25, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.940 Vali Acc: 0.669 Test Loss: 0.940 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1885293
	speed: 0.8737s/iter; left time: 24094.0867s
	iters: 200, epoch: 26 | loss: 0.3651886
	speed: 0.2816s/iter; left time: 7737.9107s
	iters: 300, epoch: 26 | loss: 0.6991907
	speed: 0.2783s/iter; left time: 7617.6498s
Epoch: 26 cost time: 104.54722237586975
Epoch: 26, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.938 Vali Acc: 0.667 Test Loss: 0.938 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.3376704
	speed: 0.9001s/iter; left time: 24488.4055s
	iters: 200, epoch: 27 | loss: 0.1787710
	speed: 0.2857s/iter; left time: 7743.8425s
	iters: 300, epoch: 27 | loss: 0.7432014
	speed: 0.2740s/iter; left time: 7400.1320s
Epoch: 27 cost time: 105.34978222846985
Epoch: 27, Steps: 369 | Train Loss: 0.267 Vali Loss: 0.939 Vali Acc: 0.684 Test Loss: 0.939 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0363787
	speed: 0.8942s/iter; left time: 23997.9303s
	iters: 200, epoch: 28 | loss: 0.0808934
	speed: 0.2753s/iter; left time: 7360.8606s
	iters: 300, epoch: 28 | loss: 0.1015715
	speed: 0.2871s/iter; left time: 7646.4617s
Epoch: 28 cost time: 103.7767984867096
Epoch: 28, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.073 Vali Acc: 0.665 Test Loss: 1.073 Test Acc: 0.665
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0745398
	speed: 0.8698s/iter; left time: 23023.4184s
	iters: 200, epoch: 29 | loss: 0.0392226
	speed: 0.2785s/iter; left time: 7342.5883s
	iters: 300, epoch: 29 | loss: 0.5326134
	speed: 0.2777s/iter; left time: 7293.9889s
Epoch: 29 cost time: 103.10074520111084
Epoch: 29, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.164 Vali Acc: 0.664 Test Loss: 1.164 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1503739
	speed: 0.8892s/iter; left time: 23207.0410s
	iters: 200, epoch: 30 | loss: 0.2094695
	speed: 0.2691s/iter; left time: 6996.0646s
	iters: 300, epoch: 30 | loss: 0.0583454
	speed: 0.2736s/iter; left time: 7086.7815s
Epoch: 30 cost time: 100.97220659255981
Epoch: 30, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.617 Vali Acc: 0.660 Test Loss: 1.617 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.69211123723042
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8706696
	speed: 0.3002s/iter; left time: 11048.4441s
	iters: 200, epoch: 1 | loss: 0.7102929
	speed: 0.2719s/iter; left time: 9980.3579s
	iters: 300, epoch: 1 | loss: 0.4944426
	speed: 0.2707s/iter; left time: 9907.4303s
Epoch: 1 cost time: 103.19596195220947
Epoch: 1, Steps: 369 | Train Loss: 0.837 Vali Loss: 1.081 Vali Acc: 0.626 Test Loss: 1.081 Test Acc: 0.626
Validation loss decreased (inf --> -0.626266).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8609514
	speed: 0.8710s/iter; left time: 31730.7462s
	iters: 200, epoch: 2 | loss: 0.6137317
	speed: 0.2660s/iter; left time: 9663.5133s
	iters: 300, epoch: 2 | loss: 1.9555300
	speed: 0.2822s/iter; left time: 10222.9988s
Epoch: 2 cost time: 102.15060019493103
Epoch: 2, Steps: 369 | Train Loss: 1.026 Vali Loss: 2.439 Vali Acc: 0.584 Test Loss: 2.439 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5476856
	speed: 0.8813s/iter; left time: 31781.9649s
	iters: 200, epoch: 3 | loss: 1.4088144
	speed: 0.2696s/iter; left time: 9695.8369s
	iters: 300, epoch: 3 | loss: 1.0442091
	speed: 0.2758s/iter; left time: 9892.6644s
Epoch: 3 cost time: 102.18371653556824
Epoch: 3, Steps: 369 | Train Loss: 1.240 Vali Loss: 2.208 Vali Acc: 0.575 Test Loss: 2.208 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9986117
	speed: 0.8723s/iter; left time: 31135.2234s
	iters: 200, epoch: 4 | loss: 0.7509887
	speed: 0.2892s/iter; left time: 10294.7696s
	iters: 300, epoch: 4 | loss: 0.3017948
	speed: 0.2763s/iter; left time: 9807.2529s
Epoch: 4 cost time: 105.75506091117859
Epoch: 4, Steps: 369 | Train Loss: 0.799 Vali Loss: 1.026 Vali Acc: 0.678 Test Loss: 1.026 Test Acc: 0.678
Validation loss decreased (-0.626266 --> -0.677629).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2673753
	speed: 0.8843s/iter; left time: 31238.8845s
	iters: 200, epoch: 5 | loss: 0.4685084
	speed: 0.2828s/iter; left time: 9962.3966s
	iters: 300, epoch: 5 | loss: 0.9705194
	speed: 0.2619s/iter; left time: 9200.7916s
Epoch: 5 cost time: 102.42069125175476
Epoch: 5, Steps: 369 | Train Loss: 0.698 Vali Loss: 0.786 Vali Acc: 0.562 Test Loss: 0.786 Test Acc: 0.562
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4404485
	speed: 0.8764s/iter; left time: 30635.8257s
	iters: 200, epoch: 6 | loss: 0.1398444
	speed: 0.2793s/iter; left time: 9735.9819s
	iters: 300, epoch: 6 | loss: 0.9522187
	speed: 0.2750s/iter; left time: 9559.2376s
Epoch: 6 cost time: 102.60708141326904
Epoch: 6, Steps: 369 | Train Loss: 0.637 Vali Loss: 0.986 Vali Acc: 0.623 Test Loss: 0.986 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7017487
	speed: 0.8569s/iter; left time: 29638.8972s
	iters: 200, epoch: 7 | loss: 0.7101552
	speed: 0.2946s/iter; left time: 10160.7678s
	iters: 300, epoch: 7 | loss: 0.7137274
	speed: 0.2858s/iter; left time: 9829.3309s
Epoch: 7 cost time: 106.13565707206726
Epoch: 7, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.803 Vali Acc: 0.606 Test Loss: 0.803 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5112689
	speed: 0.9037s/iter; left time: 30922.3791s
	iters: 200, epoch: 8 | loss: 0.7056897
	speed: 0.2633s/iter; left time: 8982.7687s
	iters: 300, epoch: 8 | loss: 0.8284525
	speed: 0.2785s/iter; left time: 9473.4087s
Epoch: 8 cost time: 101.28962922096252
Epoch: 8, Steps: 369 | Train Loss: 0.665 Vali Loss: 0.792 Vali Acc: 0.602 Test Loss: 0.792 Test Acc: 0.602
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5413032
	speed: 0.8695s/iter; left time: 29432.3042s
	iters: 200, epoch: 9 | loss: 0.6029843
	speed: 0.2819s/iter; left time: 9515.3260s
	iters: 300, epoch: 9 | loss: 0.7134325
	speed: 0.2876s/iter; left time: 9676.7373s
Epoch: 9 cost time: 104.64464116096497
Epoch: 9, Steps: 369 | Train Loss: 0.620 Vali Loss: 0.730 Vali Acc: 0.636 Test Loss: 0.730 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5861153
	speed: 0.8931s/iter; left time: 29900.3627s
	iters: 200, epoch: 10 | loss: 0.5836919
	speed: 0.2606s/iter; left time: 8697.2778s
	iters: 300, epoch: 10 | loss: 0.7244927
	speed: 0.2841s/iter; left time: 9454.7064s
Epoch: 10 cost time: 102.40842151641846
Epoch: 10, Steps: 369 | Train Loss: 0.598 Vali Loss: 0.814 Vali Acc: 0.652 Test Loss: 0.814 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3380842
	speed: 0.8590s/iter; left time: 28443.4311s
	iters: 200, epoch: 11 | loss: 0.5013171
	speed: 0.2805s/iter; left time: 9258.3889s
	iters: 300, epoch: 11 | loss: 0.3827162
	speed: 0.2739s/iter; left time: 9013.6258s
Epoch: 11 cost time: 103.43722581863403
Epoch: 11, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.772 Vali Acc: 0.651 Test Loss: 0.772 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.5722418
	speed: 0.8862s/iter; left time: 29016.3661s
	iters: 200, epoch: 12 | loss: 0.4956931
	speed: 0.2798s/iter; left time: 9132.5204s
	iters: 300, epoch: 12 | loss: 0.3270776
	speed: 0.2736s/iter; left time: 8902.1340s
Epoch: 12 cost time: 102.34315538406372
Epoch: 12, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.707 Vali Acc: 0.675 Test Loss: 0.707 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5140358
	speed: 0.8582s/iter; left time: 27782.2138s
	iters: 200, epoch: 13 | loss: 0.5513223
	speed: 0.2747s/iter; left time: 8865.6900s
	iters: 300, epoch: 13 | loss: 0.4131751
	speed: 0.2694s/iter; left time: 8666.0356s
Epoch: 13 cost time: 100.90072441101074
Epoch: 13, Steps: 369 | Train Loss: 0.555 Vali Loss: 0.698 Vali Acc: 0.649 Test Loss: 0.698 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6010416
	speed: 0.8516s/iter; left time: 27253.6992s
	iters: 200, epoch: 14 | loss: 0.4587817
	speed: 0.2753s/iter; left time: 8782.3667s
	iters: 300, epoch: 14 | loss: 0.5412691
	speed: 0.2811s/iter; left time: 8939.7201s
Epoch: 14 cost time: 101.31016612052917
Epoch: 14, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.725 Vali Acc: 0.683 Test Loss: 0.725 Test Acc: 0.683
Validation loss decreased (-0.677629 --> -0.683307).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7276301
	speed: 0.8576s/iter; left time: 27129.8612s
	iters: 200, epoch: 15 | loss: 0.5048059
	speed: 0.2744s/iter; left time: 8653.0987s
	iters: 300, epoch: 15 | loss: 0.3454745
	speed: 0.2790s/iter; left time: 8770.6286s
Epoch: 15 cost time: 101.56630754470825
Epoch: 15, Steps: 369 | Train Loss: 0.534 Vali Loss: 0.707 Vali Acc: 0.668 Test Loss: 0.707 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5916356
	speed: 0.8637s/iter; left time: 27004.9860s
	iters: 200, epoch: 16 | loss: 0.6048715
	speed: 0.2660s/iter; left time: 8291.5713s
	iters: 300, epoch: 16 | loss: 0.7218399
	speed: 0.2640s/iter; left time: 8200.0883s
Epoch: 16 cost time: 100.78550434112549
Epoch: 16, Steps: 369 | Train Loss: 0.515 Vali Loss: 0.742 Vali Acc: 0.680 Test Loss: 0.742 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3631443
	speed: 0.8651s/iter; left time: 26727.5557s
	iters: 200, epoch: 17 | loss: 0.7960133
	speed: 0.2611s/iter; left time: 8039.8965s
	iters: 300, epoch: 17 | loss: 0.4736435
	speed: 0.2701s/iter; left time: 8289.7702s
Epoch: 17 cost time: 98.44053292274475
Epoch: 17, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.709 Vali Acc: 0.680 Test Loss: 0.709 Test Acc: 0.680
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4453445
	speed: 0.8818s/iter; left time: 26919.2443s
	iters: 200, epoch: 18 | loss: 0.2002571
	speed: 0.2778s/iter; left time: 8453.2212s
	iters: 300, epoch: 18 | loss: 0.4613111
	speed: 0.2796s/iter; left time: 8479.7132s
Epoch: 18 cost time: 103.75438785552979
Epoch: 18, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.670 Vali Acc: 0.684 Test Loss: 0.670 Test Acc: 0.684
Validation loss decreased (-0.683307 --> -0.683591).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4240090
	speed: 0.8882s/iter; left time: 26787.1663s
	iters: 200, epoch: 19 | loss: 0.2005139
	speed: 0.2764s/iter; left time: 8307.1641s
	iters: 300, epoch: 19 | loss: 0.3927175
	speed: 0.2758s/iter; left time: 8262.5643s
Epoch: 19 cost time: 101.96381688117981
Epoch: 19, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.733 Vali Acc: 0.697 Test Loss: 0.733 Test Acc: 0.697
Validation loss decreased (-0.683591 --> -0.696644).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6162458
	speed: 0.8766s/iter; left time: 26115.1475s
	iters: 200, epoch: 20 | loss: 0.2893104
	speed: 0.2717s/iter; left time: 8065.3639s
	iters: 300, epoch: 20 | loss: 0.4841285
	speed: 0.2806s/iter; left time: 8303.8484s
Epoch: 20 cost time: 103.08223748207092
Epoch: 20, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.751 Vali Acc: 0.679 Test Loss: 0.751 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4272484
	speed: 0.8883s/iter; left time: 26134.3649s
	iters: 200, epoch: 21 | loss: 0.2805442
	speed: 0.2791s/iter; left time: 8182.3196s
	iters: 300, epoch: 21 | loss: 0.4265242
	speed: 0.2818s/iter; left time: 8235.2848s
Epoch: 21 cost time: 104.05650424957275
Epoch: 21, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.783 Vali Acc: 0.689 Test Loss: 0.783 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.4798685
	speed: 0.8900s/iter; left time: 25857.0743s
	iters: 200, epoch: 22 | loss: 0.7731454
	speed: 0.2715s/iter; left time: 7861.0940s
	iters: 300, epoch: 22 | loss: 0.5393583
	speed: 0.2791s/iter; left time: 8051.6620s
Epoch: 22 cost time: 102.82879066467285
Epoch: 22, Steps: 369 | Train Loss: 0.425 Vali Loss: 0.717 Vali Acc: 0.692 Test Loss: 0.717 Test Acc: 0.692
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4666977
	speed: 0.8692s/iter; left time: 24932.6404s
	iters: 200, epoch: 23 | loss: 0.6682632
	speed: 0.2804s/iter; left time: 8015.6832s
	iters: 300, epoch: 23 | loss: 0.5464477
	speed: 0.2687s/iter; left time: 7654.5640s
Epoch: 23 cost time: 102.81175065040588
Epoch: 23, Steps: 369 | Train Loss: 0.412 Vali Loss: 0.815 Vali Acc: 0.680 Test Loss: 0.815 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.5552790
	speed: 0.8736s/iter; left time: 24733.9072s
	iters: 200, epoch: 24 | loss: 0.4151632
	speed: 0.2739s/iter; left time: 7727.4073s
	iters: 300, epoch: 24 | loss: 0.4601206
	speed: 0.2894s/iter; left time: 8134.8101s
Epoch: 24 cost time: 104.81423163414001
Epoch: 24, Steps: 369 | Train Loss: 0.404 Vali Loss: 0.732 Vali Acc: 0.673 Test Loss: 0.732 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1801891
	speed: 0.8720s/iter; left time: 24368.5510s
	iters: 200, epoch: 25 | loss: 0.4821281
	speed: 0.2734s/iter; left time: 7613.8010s
	iters: 300, epoch: 25 | loss: 0.3590139
	speed: 0.2767s/iter; left time: 7675.7763s
Epoch: 25 cost time: 101.74253797531128
Epoch: 25, Steps: 369 | Train Loss: 0.387 Vali Loss: 0.747 Vali Acc: 0.688 Test Loss: 0.747 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.3920111
	speed: 0.8529s/iter; left time: 23519.8031s
	iters: 200, epoch: 26 | loss: 0.3407534
	speed: 0.2868s/iter; left time: 7879.6712s
	iters: 300, epoch: 26 | loss: 0.5360578
	speed: 0.2636s/iter; left time: 7217.1963s
Epoch: 26 cost time: 100.61024260520935
Epoch: 26, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.876 Vali Acc: 0.665 Test Loss: 0.876 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.4246082
	speed: 0.8691s/iter; left time: 23644.4112s
	iters: 200, epoch: 27 | loss: 0.3799263
	speed: 0.2628s/iter; left time: 7123.8923s
	iters: 300, epoch: 27 | loss: 0.7147096
	speed: 0.2738s/iter; left time: 7393.6678s
Epoch: 27 cost time: 100.25218653678894
Epoch: 27, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.858 Vali Acc: 0.673 Test Loss: 0.858 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0711473
	speed: 0.8767s/iter; left time: 23528.8524s
	iters: 200, epoch: 28 | loss: 0.1098118
	speed: 0.2829s/iter; left time: 7563.0288s
	iters: 300, epoch: 28 | loss: 0.2986827
	speed: 0.2711s/iter; left time: 7221.0517s
Epoch: 28 cost time: 101.98299813270569
Epoch: 28, Steps: 369 | Train Loss: 0.332 Vali Loss: 0.920 Vali Acc: 0.670 Test Loss: 0.920 Test Acc: 0.670
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.1952180
	speed: 0.8610s/iter; left time: 22790.2232s
	iters: 200, epoch: 29 | loss: 0.0578737
	speed: 0.2730s/iter; left time: 7198.3880s
	iters: 300, epoch: 29 | loss: 0.4718139
	speed: 0.2660s/iter; left time: 6986.6960s
Epoch: 29 cost time: 100.24406290054321
Epoch: 29, Steps: 369 | Train Loss: 0.305 Vali Loss: 0.867 Vali Acc: 0.677 Test Loss: 0.867 Test Acc: 0.677
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6966515323496028
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7420594
	speed: 0.2867s/iter; left time: 10551.0622s
	iters: 200, epoch: 1 | loss: 0.8878987
	speed: 0.2580s/iter; left time: 9468.8354s
	iters: 300, epoch: 1 | loss: 0.3005082
	speed: 0.2712s/iter; left time: 9925.7522s
Epoch: 1 cost time: 100.10039019584656
Epoch: 1, Steps: 369 | Train Loss: 0.841 Vali Loss: 1.050 Vali Acc: 0.638 Test Loss: 1.050 Test Acc: 0.638
Validation loss decreased (inf --> -0.638185).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9497019
	speed: 0.8562s/iter; left time: 31194.1331s
	iters: 200, epoch: 2 | loss: 0.8456852
	speed: 0.2696s/iter; left time: 9795.7655s
	iters: 300, epoch: 2 | loss: 2.0549655
	speed: 0.2733s/iter; left time: 9901.2291s
Epoch: 2 cost time: 99.61323523521423
Epoch: 2, Steps: 369 | Train Loss: 1.038 Vali Loss: 1.819 Vali Acc: 0.594 Test Loss: 1.819 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5379858
	speed: 0.8260s/iter; left time: 29787.3383s
	iters: 200, epoch: 3 | loss: 1.2381442
	speed: 0.2572s/iter; left time: 9250.7626s
	iters: 300, epoch: 3 | loss: 0.8498375
	speed: 0.2749s/iter; left time: 9860.4454s
Epoch: 3 cost time: 97.99370431900024
Epoch: 3, Steps: 369 | Train Loss: 1.171 Vali Loss: 0.942 Vali Acc: 0.632 Test Loss: 0.942 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9667710
	speed: 0.8312s/iter; left time: 29667.1306s
	iters: 200, epoch: 4 | loss: 0.7102969
	speed: 0.2689s/iter; left time: 9572.4076s
	iters: 300, epoch: 4 | loss: 0.4591307
	speed: 0.2746s/iter; left time: 9745.6233s
Epoch: 4 cost time: 100.09032964706421
Epoch: 4, Steps: 369 | Train Loss: 0.791 Vali Loss: 2.128 Vali Acc: 0.561 Test Loss: 2.128 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5296602
	speed: 0.8589s/iter; left time: 30341.3914s
	iters: 200, epoch: 5 | loss: 1.0256696
	speed: 0.2728s/iter; left time: 9610.5028s
	iters: 300, epoch: 5 | loss: 0.5202217
	speed: 0.2680s/iter; left time: 9411.7961s
Epoch: 5 cost time: 101.28898620605469
Epoch: 5, Steps: 369 | Train Loss: 0.736 Vali Loss: 0.708 Vali Acc: 0.671 Test Loss: 0.708 Test Acc: 0.671
Validation loss decreased (-0.638185 --> -0.671105).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3807797
	speed: 0.8582s/iter; left time: 29998.4838s
	iters: 200, epoch: 6 | loss: 0.2987593
	speed: 0.2672s/iter; left time: 9312.4556s
	iters: 300, epoch: 6 | loss: 0.5752307
	speed: 0.2743s/iter; left time: 9533.5992s
Epoch: 6 cost time: 99.62498617172241
Epoch: 6, Steps: 369 | Train Loss: 0.592 Vali Loss: 0.714 Vali Acc: 0.670 Test Loss: 0.714 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5066845
	speed: 0.8744s/iter; left time: 30243.3561s
	iters: 200, epoch: 7 | loss: 1.3487659
	speed: 0.2685s/iter; left time: 9259.6421s
	iters: 300, epoch: 7 | loss: 0.3394731
	speed: 0.2680s/iter; left time: 9215.0469s
Epoch: 7 cost time: 100.8707549571991
Epoch: 7, Steps: 369 | Train Loss: 0.612 Vali Loss: 0.806 Vali Acc: 0.646 Test Loss: 0.806 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6484711
	speed: 0.8668s/iter; left time: 29661.6849s
	iters: 200, epoch: 8 | loss: 0.5412659
	speed: 0.2718s/iter; left time: 9271.8099s
	iters: 300, epoch: 8 | loss: 0.5229358
	speed: 0.2645s/iter; left time: 8997.8622s
Epoch: 8 cost time: 100.64034867286682
Epoch: 8, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.843 Vali Acc: 0.602 Test Loss: 0.843 Test Acc: 0.602
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6085105
	speed: 0.8561s/iter; left time: 28976.7163s
	iters: 200, epoch: 9 | loss: 0.4167845
	speed: 0.2611s/iter; left time: 8811.7076s
	iters: 300, epoch: 9 | loss: 0.2835333
	speed: 0.2537s/iter; left time: 8536.6399s
Epoch: 9 cost time: 96.69650101661682
Epoch: 9, Steps: 369 | Train Loss: 0.590 Vali Loss: 0.782 Vali Acc: 0.669 Test Loss: 0.782 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.4307697
	speed: 0.8469s/iter; left time: 28354.0463s
	iters: 200, epoch: 10 | loss: 0.7545934
	speed: 0.2658s/iter; left time: 8873.7159s
	iters: 300, epoch: 10 | loss: 0.8313519
	speed: 0.2631s/iter; left time: 8755.7298s
Epoch: 10 cost time: 99.82907938957214
Epoch: 10, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.819 Vali Acc: 0.641 Test Loss: 0.819 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2107903
	speed: 0.8708s/iter; left time: 28833.3241s
	iters: 200, epoch: 11 | loss: 0.2570867
	speed: 0.2609s/iter; left time: 8611.0606s
	iters: 300, epoch: 11 | loss: 0.5876321
	speed: 0.2661s/iter; left time: 8756.8152s
Epoch: 11 cost time: 98.04110598564148
Epoch: 11, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.761 Vali Acc: 0.650 Test Loss: 0.761 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.4326135
	speed: 0.8400s/iter; left time: 27504.2189s
	iters: 200, epoch: 12 | loss: 0.4100995
	speed: 0.2727s/iter; left time: 8901.6778s
	iters: 300, epoch: 12 | loss: 0.4456983
	speed: 0.2799s/iter; left time: 9107.7297s
Epoch: 12 cost time: 102.09355187416077
Epoch: 12, Steps: 369 | Train Loss: 0.519 Vali Loss: 0.747 Vali Acc: 0.670 Test Loss: 0.747 Test Acc: 0.670
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.4644687
	speed: 0.8748s/iter; left time: 28320.8515s
	iters: 200, epoch: 13 | loss: 0.4772160
	speed: 0.2637s/iter; left time: 8511.7054s
	iters: 300, epoch: 13 | loss: 0.5786356
	speed: 0.2792s/iter; left time: 8982.6245s
Epoch: 13 cost time: 101.87279963493347
Epoch: 13, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.718 Vali Acc: 0.663 Test Loss: 0.718 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.4061267
	speed: 0.8876s/iter; left time: 28406.4746s
	iters: 200, epoch: 14 | loss: 0.7119145
	speed: 0.2700s/iter; left time: 8613.5947s
	iters: 300, epoch: 14 | loss: 0.6283718
	speed: 0.2814s/iter; left time: 8950.1411s
Epoch: 14 cost time: 103.02546739578247
Epoch: 14, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.785 Vali Acc: 0.667 Test Loss: 0.785 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4375730
	speed: 0.8708s/iter; left time: 27547.8896s
	iters: 200, epoch: 15 | loss: 0.4422841
	speed: 0.2681s/iter; left time: 8453.8203s
	iters: 300, epoch: 15 | loss: 0.3426699
	speed: 0.2672s/iter; left time: 8400.0947s
Epoch: 15 cost time: 101.3947184085846
Epoch: 15, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.711 Vali Acc: 0.664 Test Loss: 0.711 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9363717
	speed: 0.2709s/iter; left time: 9968.6577s
	iters: 200, epoch: 1 | loss: 1.0976433
	speed: 0.2626s/iter; left time: 9638.1527s
	iters: 300, epoch: 1 | loss: 0.8402855
	speed: 0.2652s/iter; left time: 9708.3237s
Epoch: 1 cost time: 98.16449284553528
Epoch: 1, Steps: 369 | Train Loss: 0.837 Vali Loss: 1.065 Vali Acc: 0.632 Test Loss: 1.065 Test Acc: 0.632
Validation loss decreased (inf --> -0.631942).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6233379
	speed: 0.8207s/iter; left time: 29899.0023s
	iters: 200, epoch: 2 | loss: 1.8417172
	speed: 0.2645s/iter; left time: 9608.9513s
	iters: 300, epoch: 2 | loss: 1.6237757
	speed: 0.2773s/iter; left time: 10045.9958s
Epoch: 2 cost time: 98.8585958480835
Epoch: 2, Steps: 369 | Train Loss: 1.019 Vali Loss: 1.666 Vali Acc: 0.635 Test Loss: 1.666 Test Acc: 0.635
Validation loss decreased (-0.631942 --> -0.635057).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7312835
	speed: 0.8468s/iter; left time: 30538.5786s
	iters: 200, epoch: 3 | loss: 2.3467650
	speed: 0.2604s/iter; left time: 9366.2478s
	iters: 300, epoch: 3 | loss: 2.5688145
	speed: 0.2698s/iter; left time: 9676.2017s
Epoch: 3 cost time: 98.68510174751282
Epoch: 3, Steps: 369 | Train Loss: 1.248 Vali Loss: 1.360 Vali Acc: 0.603 Test Loss: 1.360 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8822587
	speed: 0.8201s/iter; left time: 29272.5906s
	iters: 200, epoch: 4 | loss: 1.5988756
	speed: 0.2646s/iter; left time: 9419.5252s
	iters: 300, epoch: 4 | loss: 0.6177800
	speed: 0.2669s/iter; left time: 9472.3917s
Epoch: 4 cost time: 97.38697910308838
Epoch: 4, Steps: 369 | Train Loss: 0.980 Vali Loss: 1.156 Vali Acc: 0.670 Test Loss: 1.156 Test Acc: 0.670
Validation loss decreased (-0.635057 --> -0.669682).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7628994
	speed: 0.8345s/iter; left time: 29478.6476s
	iters: 200, epoch: 5 | loss: 0.8703116
	speed: 0.2651s/iter; left time: 9338.7166s
	iters: 300, epoch: 5 | loss: 1.7492232
	speed: 0.2642s/iter; left time: 9281.1294s
Epoch: 5 cost time: 97.92900705337524
Epoch: 5, Steps: 369 | Train Loss: 0.990 Vali Loss: 0.957 Vali Acc: 0.586 Test Loss: 0.957 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7860642
	speed: 0.8355s/iter; left time: 29205.7911s
	iters: 200, epoch: 6 | loss: 1.2653015
	speed: 0.2761s/iter; left time: 9623.6033s
	iters: 300, epoch: 6 | loss: 0.5426801
	speed: 0.2708s/iter; left time: 9413.5149s
Epoch: 6 cost time: 100.14668989181519
Epoch: 6, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.922 Vali Acc: 0.618 Test Loss: 0.922 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6181929
	speed: 0.8346s/iter; left time: 28864.6610s
	iters: 200, epoch: 7 | loss: 0.9139763
	speed: 0.2646s/iter; left time: 9124.7695s
	iters: 300, epoch: 7 | loss: 0.6867756
	speed: 0.2574s/iter; left time: 8850.9944s
Epoch: 7 cost time: 96.79571032524109
Epoch: 7, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.818 Vali Acc: 0.608 Test Loss: 0.818 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5758340
	speed: 0.8443s/iter; left time: 28889.7223s
	iters: 200, epoch: 8 | loss: 0.5347793
	speed: 0.2730s/iter; left time: 9313.8760s
	iters: 300, epoch: 8 | loss: 0.7183106
	speed: 0.2700s/iter; left time: 9186.1829s
Epoch: 8 cost time: 99.74681425094604
Epoch: 8, Steps: 369 | Train Loss: 0.622 Vali Loss: 0.846 Vali Acc: 0.628 Test Loss: 0.846 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5429441
	speed: 0.8270s/iter; left time: 27994.6586s
	iters: 200, epoch: 9 | loss: 0.6808122
	speed: 0.2596s/iter; left time: 8762.3713s
	iters: 300, epoch: 9 | loss: 0.5313618
	speed: 0.2610s/iter; left time: 8781.5529s
Epoch: 9 cost time: 96.0118350982666
Epoch: 9, Steps: 369 | Train Loss: 0.569 Vali Loss: 0.728 Vali Acc: 0.657 Test Loss: 0.728 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5580989
	speed: 0.8480s/iter; left time: 28390.0472s
	iters: 200, epoch: 10 | loss: 0.5563984
	speed: 0.2769s/iter; left time: 9243.7018s
	iters: 300, epoch: 10 | loss: 0.6316698
	speed: 0.2611s/iter; left time: 8688.5589s
Epoch: 10 cost time: 98.60712552070618
Epoch: 10, Steps: 369 | Train Loss: 0.543 Vali Loss: 0.876 Vali Acc: 0.676 Test Loss: 0.876 Test Acc: 0.676
Validation loss decreased (-0.669682 --> -0.675644).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1774068
	speed: 0.8335s/iter; left time: 27599.4552s
	iters: 200, epoch: 11 | loss: 0.3190092
	speed: 0.2614s/iter; left time: 8628.6278s
	iters: 300, epoch: 11 | loss: 0.5787771
	speed: 0.2628s/iter; left time: 8648.8842s
Epoch: 11 cost time: 97.16786527633667
Epoch: 11, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.712 Vali Acc: 0.677 Test Loss: 0.712 Test Acc: 0.677
Validation loss decreased (-0.675644 --> -0.677348).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4979669
	speed: 0.8467s/iter; left time: 27723.1718s
	iters: 200, epoch: 12 | loss: 0.4536652
	speed: 0.2731s/iter; left time: 8915.9421s
	iters: 300, epoch: 12 | loss: 0.4672602
	speed: 0.2656s/iter; left time: 8644.5188s
Epoch: 12 cost time: 99.0175633430481
Epoch: 12, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.834 Vali Acc: 0.655 Test Loss: 0.834 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6494122
	speed: 0.8349s/iter; left time: 27028.9780s
	iters: 200, epoch: 13 | loss: 0.4999715
	speed: 0.2629s/iter; left time: 8483.2629s
	iters: 300, epoch: 13 | loss: 0.4219087
	speed: 0.2662s/iter; left time: 8565.3994s
Epoch: 13 cost time: 97.17304158210754
Epoch: 13, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.721 Vali Acc: 0.679 Test Loss: 0.721 Test Acc: 0.679
Validation loss decreased (-0.677348 --> -0.678767).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5076193
	speed: 0.8324s/iter; left time: 26638.8487s
	iters: 200, epoch: 14 | loss: 0.3048678
	speed: 0.2610s/iter; left time: 8325.5268s
	iters: 300, epoch: 14 | loss: 0.8772293
	speed: 0.2560s/iter; left time: 8143.1873s
Epoch: 14 cost time: 96.06109881401062
Epoch: 14, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.820 Vali Acc: 0.672 Test Loss: 0.820 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5359929
	speed: 0.8255s/iter; left time: 26114.9118s
	iters: 200, epoch: 15 | loss: 0.5932617
	speed: 0.2601s/iter; left time: 8202.8454s
	iters: 300, epoch: 15 | loss: 0.2819931
	speed: 0.2637s/iter; left time: 8288.7568s
Epoch: 15 cost time: 96.30183434486389
Epoch: 15, Steps: 369 | Train Loss: 0.458 Vali Loss: 0.747 Vali Acc: 0.680 Test Loss: 0.747 Test Acc: 0.680
Validation loss decreased (-0.678767 --> -0.680185).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4900201
	speed: 0.8522s/iter; left time: 26644.3311s
	iters: 200, epoch: 16 | loss: 0.4515555
	speed: 0.2679s/iter; left time: 8350.0644s
	iters: 300, epoch: 16 | loss: 0.5774709
	speed: 0.2638s/iter; left time: 8194.6093s
Epoch: 16 cost time: 99.4378969669342
Epoch: 16, Steps: 369 | Train Loss: 0.434 Vali Loss: 0.751 Vali Acc: 0.684 Test Loss: 0.751 Test Acc: 0.684
Validation loss decreased (-0.680185 --> -0.684158).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3312560
	speed: 0.8581s/iter; left time: 26513.1821s
	iters: 200, epoch: 17 | loss: 0.5868213
	speed: 0.2630s/iter; left time: 8099.4637s
	iters: 300, epoch: 17 | loss: 0.2728192
	speed: 0.2507s/iter; left time: 7695.1948s
Epoch: 17 cost time: 97.18414783477783
Epoch: 17, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.749 Vali Acc: 0.692 Test Loss: 0.749 Test Acc: 0.692
Validation loss decreased (-0.684158 --> -0.691536).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3506741
	speed: 0.8710s/iter; left time: 26588.3997s
	iters: 200, epoch: 18 | loss: 0.1697647
	speed: 0.2707s/iter; left time: 8235.5715s
	iters: 300, epoch: 18 | loss: 0.4132566
	speed: 0.2673s/iter; left time: 8105.5285s
Epoch: 18 cost time: 100.85302972793579
Epoch: 18, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.748 Vali Acc: 0.685 Test Loss: 0.748 Test Acc: 0.685
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2478404
	speed: 0.8597s/iter; left time: 25928.4874s
	iters: 200, epoch: 19 | loss: 0.1796156
	speed: 0.2669s/iter; left time: 8021.8306s
	iters: 300, epoch: 19 | loss: 0.4775794
	speed: 0.2711s/iter; left time: 8122.3394s
Epoch: 19 cost time: 100.12745714187622
Epoch: 19, Steps: 369 | Train Loss: 0.376 Vali Loss: 0.802 Vali Acc: 0.688 Test Loss: 0.802 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.5944843
	speed: 0.8394s/iter; left time: 25005.3526s
	iters: 200, epoch: 20 | loss: 0.2064784
	speed: 0.2558s/iter; left time: 7595.2458s
	iters: 300, epoch: 20 | loss: 0.3774797
	speed: 0.2610s/iter; left time: 7722.4036s
Epoch: 20 cost time: 96.45395231246948
Epoch: 20, Steps: 369 | Train Loss: 0.357 Vali Loss: 0.747 Vali Acc: 0.694 Test Loss: 0.747 Test Acc: 0.694
Validation loss decreased (-0.691536 --> -0.693806).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2508073
	speed: 0.8372s/iter; left time: 24629.8687s
	iters: 200, epoch: 21 | loss: 0.2554333
	speed: 0.2549s/iter; left time: 7474.7940s
	iters: 300, epoch: 21 | loss: 0.2625304
	speed: 0.2638s/iter; left time: 7709.9200s
Epoch: 21 cost time: 96.45225405693054
Epoch: 21, Steps: 369 | Train Loss: 0.332 Vali Loss: 0.852 Vali Acc: 0.680 Test Loss: 0.852 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1644807
	speed: 0.8264s/iter; left time: 24008.2061s
	iters: 200, epoch: 22 | loss: 0.1435775
	speed: 0.2672s/iter; left time: 7736.5204s
	iters: 300, epoch: 22 | loss: 0.2011129
	speed: 0.2718s/iter; left time: 7842.0873s
Epoch: 22 cost time: 99.55853366851807
Epoch: 22, Steps: 369 | Train Loss: 0.308 Vali Loss: 0.963 Vali Acc: 0.678 Test Loss: 0.963 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2980016
	speed: 0.8481s/iter; left time: 24325.8107s
	iters: 200, epoch: 23 | loss: 0.5600530
	speed: 0.2543s/iter; left time: 7268.4055s
	iters: 300, epoch: 23 | loss: 0.2016344
	speed: 0.2630s/iter; left time: 7489.6397s
Epoch: 23 cost time: 97.37729454040527
Epoch: 23, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.005 Vali Acc: 0.671 Test Loss: 1.005 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0465315
	speed: 0.8338s/iter; left time: 23609.3886s
	iters: 200, epoch: 24 | loss: 0.0556234
	speed: 0.2589s/iter; left time: 7303.7082s
	iters: 300, epoch: 24 | loss: 0.3457421
	speed: 0.2601s/iter; left time: 7313.2258s
Epoch: 24 cost time: 96.39280438423157
Epoch: 24, Steps: 369 | Train Loss: 0.243 Vali Loss: 0.908 Vali Acc: 0.656 Test Loss: 0.908 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1758181
	speed: 0.8450s/iter; left time: 23614.8992s
	iters: 200, epoch: 25 | loss: 0.2927644
	speed: 0.2556s/iter; left time: 7116.1144s
	iters: 300, epoch: 25 | loss: 0.7663140
	speed: 0.2640s/iter; left time: 7326.0070s
Epoch: 25 cost time: 97.32608151435852
Epoch: 25, Steps: 369 | Train Loss: 0.212 Vali Loss: 0.990 Vali Acc: 0.661 Test Loss: 0.990 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1838316
	speed: 0.8238s/iter; left time: 22716.7889s
	iters: 200, epoch: 26 | loss: 0.0721162
	speed: 0.2604s/iter; left time: 7154.2943s
	iters: 300, epoch: 26 | loss: 0.0240873
	speed: 0.2725s/iter; left time: 7459.4093s
Epoch: 26 cost time: 97.20677828788757
Epoch: 26, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.287 Vali Acc: 0.664 Test Loss: 1.287 Test Acc: 0.664
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.2077361
	speed: 0.8260s/iter; left time: 22472.0039s
	iters: 200, epoch: 27 | loss: 0.2531053
	speed: 0.2543s/iter; left time: 6893.7273s
	iters: 300, epoch: 27 | loss: 0.0754394
	speed: 0.2530s/iter; left time: 6833.9081s
Epoch: 27 cost time: 94.45321369171143
Epoch: 27, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.406 Vali Acc: 0.661 Test Loss: 1.406 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0109456
	speed: 0.8224s/iter; left time: 22072.9026s
	iters: 200, epoch: 28 | loss: 0.0350896
	speed: 0.2537s/iter; left time: 6782.1437s
	iters: 300, epoch: 28 | loss: 0.0191533
	speed: 0.2560s/iter; left time: 6818.2040s
Epoch: 28 cost time: 94.72289991378784
Epoch: 28, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.540 Vali Acc: 0.658 Test Loss: 1.540 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1654747
	speed: 0.8311s/iter; left time: 21997.2633s
	iters: 200, epoch: 29 | loss: 0.0249033
	speed: 0.2528s/iter; left time: 6665.3943s
	iters: 300, epoch: 29 | loss: 0.1472812
	speed: 0.2543s/iter; left time: 6681.0123s
Epoch: 29 cost time: 94.94040298461914
Epoch: 29, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.554 Vali Acc: 0.655 Test Loss: 1.554 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0004574
	speed: 0.8230s/iter; left time: 21479.9737s
	iters: 200, epoch: 30 | loss: 0.0115593
	speed: 0.2668s/iter; left time: 6936.8713s
	iters: 300, epoch: 30 | loss: 0.0220706
	speed: 0.2556s/iter; left time: 6619.4764s
Epoch: 30 cost time: 96.13608455657959
Epoch: 30, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.753 Vali Acc: 0.645 Test Loss: 1.753 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6938138479001135
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7042958
	speed: 0.2901s/iter; left time: 10674.9337s
	iters: 200, epoch: 1 | loss: 0.7659571
	speed: 0.2655s/iter; left time: 9744.5779s
	iters: 300, epoch: 1 | loss: 0.8997340
	speed: 0.2603s/iter; left time: 9525.4336s
Epoch: 1 cost time: 100.20023655891418
Epoch: 1, Steps: 369 | Train Loss: 0.805 Vali Loss: 1.357 Vali Acc: 0.622 Test Loss: 1.357 Test Acc: 0.622
Validation loss decreased (inf --> -0.622291).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8603114
	speed: 0.8416s/iter; left time: 30662.6971s
	iters: 200, epoch: 2 | loss: 0.9867383
	speed: 0.2706s/iter; left time: 9830.1067s
	iters: 300, epoch: 2 | loss: 1.6006848
	speed: 0.2687s/iter; left time: 9735.8248s
Epoch: 2 cost time: 100.01796793937683
Epoch: 2, Steps: 369 | Train Loss: 1.005 Vali Loss: 1.438 Vali Acc: 0.603 Test Loss: 1.438 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3902316
	speed: 0.8531s/iter; left time: 30763.6631s
	iters: 200, epoch: 3 | loss: 1.3198158
	speed: 0.2653s/iter; left time: 9540.0498s
	iters: 300, epoch: 3 | loss: 0.7274777
	speed: 0.2723s/iter; left time: 9763.9979s
Epoch: 3 cost time: 99.32555556297302
Epoch: 3, Steps: 369 | Train Loss: 0.793 Vali Loss: 0.714 Vali Acc: 0.675 Test Loss: 0.714 Test Acc: 0.675
Validation loss decreased (-0.622291 --> -0.675362).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9660662
	speed: 0.8719s/iter; left time: 31120.1199s
	iters: 200, epoch: 4 | loss: 0.3834078
	speed: 0.2844s/iter; left time: 10121.6807s
	iters: 300, epoch: 4 | loss: 0.9137220
	speed: 0.2753s/iter; left time: 9771.4733s
Epoch: 4 cost time: 101.70812010765076
Epoch: 4, Steps: 369 | Train Loss: 0.762 Vali Loss: 1.027 Vali Acc: 0.583 Test Loss: 1.027 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6281646
	speed: 0.8634s/iter; left time: 30500.1291s
	iters: 200, epoch: 5 | loss: 0.2461025
	speed: 0.2756s/iter; left time: 9708.5354s
	iters: 300, epoch: 5 | loss: 0.8039451
	speed: 0.2932s/iter; left time: 10299.1157s
Epoch: 5 cost time: 103.5429790019989
Epoch: 5, Steps: 369 | Train Loss: 0.750 Vali Loss: 0.910 Vali Acc: 0.598 Test Loss: 0.910 Test Acc: 0.598
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8845925
	speed: 0.8367s/iter; left time: 29248.1697s
	iters: 200, epoch: 6 | loss: 0.6698185
	speed: 0.2647s/iter; left time: 9227.3306s
	iters: 300, epoch: 6 | loss: 0.6209430
	speed: 0.2638s/iter; left time: 9168.3917s
Epoch: 6 cost time: 96.95947217941284
Epoch: 6, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.760 Vali Acc: 0.650 Test Loss: 0.760 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7692049
	speed: 0.8672s/iter; left time: 29995.0623s
	iters: 200, epoch: 7 | loss: 0.8116941
	speed: 0.2660s/iter; left time: 9173.0827s
	iters: 300, epoch: 7 | loss: 0.6780918
	speed: 0.2660s/iter; left time: 9147.7215s
Epoch: 7 cost time: 99.27166604995728
Epoch: 7, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.730 Vali Acc: 0.594 Test Loss: 0.730 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3798686
	speed: 0.8665s/iter; left time: 29649.3987s
	iters: 200, epoch: 8 | loss: 0.7609782
	speed: 0.2717s/iter; left time: 9270.7066s
	iters: 300, epoch: 8 | loss: 0.5080310
	speed: 0.2688s/iter; left time: 9145.0888s
Epoch: 8 cost time: 101.13385820388794
Epoch: 8, Steps: 369 | Train Loss: 0.628 Vali Loss: 0.685 Vali Acc: 0.630 Test Loss: 0.685 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6786990
	speed: 0.8618s/iter; left time: 29171.7608s
	iters: 200, epoch: 9 | loss: 0.4844747
	speed: 0.2642s/iter; left time: 8917.5412s
	iters: 300, epoch: 9 | loss: 0.5646471
	speed: 0.2717s/iter; left time: 9142.5938s
Epoch: 9 cost time: 100.19586038589478
Epoch: 9, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.724 Vali Acc: 0.616 Test Loss: 0.724 Test Acc: 0.616
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7391281
	speed: 0.8487s/iter; left time: 28415.5824s
	iters: 200, epoch: 10 | loss: 0.6915609
	speed: 0.2839s/iter; left time: 9476.7754s
	iters: 300, epoch: 10 | loss: 0.8059195
	speed: 0.2650s/iter; left time: 8817.9701s
Epoch: 10 cost time: 101.76126980781555
Epoch: 10, Steps: 369 | Train Loss: 0.580 Vali Loss: 0.812 Vali Acc: 0.667 Test Loss: 0.812 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4300820
	speed: 0.8683s/iter; left time: 28749.0793s
	iters: 200, epoch: 11 | loss: 0.6000411
	speed: 0.2608s/iter; left time: 8607.7377s
	iters: 300, epoch: 11 | loss: 0.5248090
	speed: 0.2478s/iter; left time: 8154.4835s
Epoch: 11 cost time: 97.42783284187317
Epoch: 11, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.705 Vali Acc: 0.688 Test Loss: 0.705 Test Acc: 0.688
Validation loss decreased (-0.675362 --> -0.688131).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3738033
	speed: 0.8627s/iter; left time: 28246.5690s
	iters: 200, epoch: 12 | loss: 0.4264361
	speed: 0.2714s/iter; left time: 8858.2698s
	iters: 300, epoch: 12 | loss: 0.6429898
	speed: 0.2630s/iter; left time: 8557.4120s
Epoch: 12 cost time: 99.05576825141907
Epoch: 12, Steps: 369 | Train Loss: 0.536 Vali Loss: 0.680 Vali Acc: 0.674 Test Loss: 0.680 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5701796
	speed: 0.8526s/iter; left time: 27601.7534s
	iters: 200, epoch: 13 | loss: 0.3541290
	speed: 0.2807s/iter; left time: 9059.8685s
	iters: 300, epoch: 13 | loss: 0.3942042
	speed: 0.2688s/iter; left time: 8647.9470s
Epoch: 13 cost time: 101.78461909294128
Epoch: 13, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.674 Vali Acc: 0.661 Test Loss: 0.674 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4836240
	speed: 0.8654s/iter; left time: 27697.0576s
	iters: 200, epoch: 14 | loss: 0.3434238
	speed: 0.2832s/iter; left time: 9036.5544s
	iters: 300, epoch: 14 | loss: 0.8236575
	speed: 0.2646s/iter; left time: 8413.8101s
Epoch: 14 cost time: 102.34742665290833
Epoch: 14, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.662 Vali Acc: 0.673 Test Loss: 0.662 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6011360
	speed: 0.8627s/iter; left time: 27292.3432s
	iters: 200, epoch: 15 | loss: 0.4680631
	speed: 0.2810s/iter; left time: 8861.0684s
	iters: 300, epoch: 15 | loss: 0.2505342
	speed: 0.2707s/iter; left time: 8510.3734s
Epoch: 15 cost time: 103.16202998161316
Epoch: 15, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.672 Vali Acc: 0.675 Test Loss: 0.672 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5168107
	speed: 0.8721s/iter; left time: 27267.6320s
	iters: 200, epoch: 16 | loss: 0.6321803
	speed: 0.2699s/iter; left time: 8413.0279s
	iters: 300, epoch: 16 | loss: 0.8235378
	speed: 0.2705s/iter; left time: 8404.5394s
Epoch: 16 cost time: 100.31624054908752
Epoch: 16, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.658 Vali Acc: 0.679 Test Loss: 0.658 Test Acc: 0.679
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3661924
	speed: 0.8523s/iter; left time: 26332.3059s
	iters: 200, epoch: 17 | loss: 0.6546295
	speed: 0.2547s/iter; left time: 7843.5114s
	iters: 300, epoch: 17 | loss: 0.4207180
	speed: 0.2542s/iter; left time: 7803.2957s
Epoch: 17 cost time: 95.59761118888855
Epoch: 17, Steps: 369 | Train Loss: 0.466 Vali Loss: 0.658 Vali Acc: 0.675 Test Loss: 0.658 Test Acc: 0.675
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2603009
	speed: 0.8430s/iter; left time: 25735.4328s
	iters: 200, epoch: 18 | loss: 0.2452312
	speed: 0.2623s/iter; left time: 7980.6404s
	iters: 300, epoch: 18 | loss: 0.3744901
	speed: 0.2726s/iter; left time: 8268.3698s
Epoch: 18 cost time: 99.34116649627686
Epoch: 18, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.696 Vali Acc: 0.682 Test Loss: 0.696 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.3662418
	speed: 0.8577s/iter; left time: 25867.9186s
	iters: 200, epoch: 19 | loss: 0.2297495
	speed: 0.2850s/iter; left time: 8568.1686s
	iters: 300, epoch: 19 | loss: 0.3706432
	speed: 0.2605s/iter; left time: 7804.3772s
Epoch: 19 cost time: 100.87680149078369
Epoch: 19, Steps: 369 | Train Loss: 0.434 Vali Loss: 0.725 Vali Acc: 0.686 Test Loss: 0.725 Test Acc: 0.686
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6041520
	speed: 0.8362s/iter; left time: 24908.9628s
	iters: 200, epoch: 20 | loss: 0.2668637
	speed: 0.2746s/iter; left time: 8152.2576s
	iters: 300, epoch: 20 | loss: 0.5548390
	speed: 0.2701s/iter; left time: 7992.5929s
Epoch: 20 cost time: 100.70312142372131
Epoch: 20, Steps: 369 | Train Loss: 0.413 Vali Loss: 0.680 Vali Acc: 0.691 Test Loss: 0.680 Test Acc: 0.691
Validation loss decreased (-0.688131 --> -0.690686).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2845500
	speed: 0.8724s/iter; left time: 25667.3346s
	iters: 200, epoch: 21 | loss: 0.5002110
	speed: 0.2717s/iter; left time: 7965.5844s
	iters: 300, epoch: 21 | loss: 0.4223859
	speed: 0.2692s/iter; left time: 7866.7827s
Epoch: 21 cost time: 99.86375379562378
Epoch: 21, Steps: 369 | Train Loss: 0.410 Vali Loss: 0.719 Vali Acc: 0.690 Test Loss: 0.719 Test Acc: 0.690
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3544672
	speed: 0.8621s/iter; left time: 25045.0862s
	iters: 200, epoch: 22 | loss: 0.8152784
	speed: 0.2645s/iter; left time: 7657.2537s
	iters: 300, epoch: 22 | loss: 0.3006084
	speed: 0.2749s/iter; left time: 7931.9018s
Epoch: 22 cost time: 100.0292489528656
Epoch: 22, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.736 Vali Acc: 0.692 Test Loss: 0.736 Test Acc: 0.692
Validation loss decreased (-0.690686 --> -0.692388).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3636787
	speed: 0.8439s/iter; left time: 24205.2212s
	iters: 200, epoch: 23 | loss: 0.5668877
	speed: 0.2697s/iter; left time: 7707.6871s
	iters: 300, epoch: 23 | loss: 0.3984178
	speed: 0.2751s/iter; left time: 7834.5393s
Epoch: 23 cost time: 100.58818769454956
Epoch: 23, Steps: 369 | Train Loss: 0.368 Vali Loss: 0.720 Vali Acc: 0.678 Test Loss: 0.720 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.3980451
	speed: 0.8391s/iter; left time: 23757.9886s
	iters: 200, epoch: 24 | loss: 0.2867714
	speed: 0.2545s/iter; left time: 7180.5216s
	iters: 300, epoch: 24 | loss: 0.3506858
	speed: 0.2512s/iter; left time: 7061.2049s
Epoch: 24 cost time: 94.59827208518982
Epoch: 24, Steps: 369 | Train Loss: 0.344 Vali Loss: 0.723 Vali Acc: 0.682 Test Loss: 0.723 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2016841
	speed: 0.8215s/iter; left time: 22956.2010s
	iters: 200, epoch: 25 | loss: 0.6031851
	speed: 0.2605s/iter; left time: 7252.6472s
	iters: 300, epoch: 25 | loss: 0.3110028
	speed: 0.2729s/iter; left time: 7570.2538s
Epoch: 25 cost time: 98.07526564598083
Epoch: 25, Steps: 369 | Train Loss: 0.322 Vali Loss: 0.752 Vali Acc: 0.678 Test Loss: 0.752 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.2284842
	speed: 0.8782s/iter; left time: 24216.3637s
	iters: 200, epoch: 26 | loss: 0.2285441
	speed: 0.2538s/iter; left time: 6972.3159s
	iters: 300, epoch: 26 | loss: 0.4336833
	speed: 0.2535s/iter; left time: 6940.8646s
Epoch: 26 cost time: 95.45026874542236
Epoch: 26, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.894 Vali Acc: 0.656 Test Loss: 0.894 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.4126183
	speed: 0.8062s/iter; left time: 21933.6161s
	iters: 200, epoch: 27 | loss: 0.2097282
	speed: 0.2547s/iter; left time: 6904.2748s
	iters: 300, epoch: 27 | loss: 0.4904700
	speed: 0.2522s/iter; left time: 6812.5088s
Epoch: 27 cost time: 93.94669437408447
Epoch: 27, Steps: 369 | Train Loss: 0.258 Vali Loss: 1.008 Vali Acc: 0.664 Test Loss: 1.008 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1760425
	speed: 0.7971s/iter; left time: 21391.9134s
	iters: 200, epoch: 28 | loss: 0.1765734
	speed: 0.2521s/iter; left time: 6741.7077s
	iters: 300, epoch: 28 | loss: 0.2758060
	speed: 0.2529s/iter; left time: 6736.0878s
Epoch: 28 cost time: 93.63201212882996
Epoch: 28, Steps: 369 | Train Loss: 0.237 Vali Loss: 0.976 Vali Acc: 0.660 Test Loss: 0.976 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0707589
	speed: 0.8532s/iter; left time: 22584.0645s
	iters: 200, epoch: 29 | loss: 0.0442635
	speed: 0.2697s/iter; left time: 7111.2176s
	iters: 300, epoch: 29 | loss: 0.1416163
	speed: 0.2668s/iter; left time: 7007.9517s
Epoch: 29 cost time: 100.15725135803223
Epoch: 29, Steps: 369 | Train Loss: 0.208 Vali Loss: 1.038 Vali Acc: 0.664 Test Loss: 1.038 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.2541192
	speed: 0.8641s/iter; left time: 22554.1014s
	iters: 200, epoch: 30 | loss: 0.1013743
	speed: 0.2626s/iter; left time: 6826.7110s
	iters: 300, epoch: 30 | loss: 0.0680925
	speed: 0.2642s/iter; left time: 6841.9251s
Epoch: 30 cost time: 100.7886233329773
Epoch: 30, Steps: 369 | Train Loss: 0.182 Vali Loss: 1.202 Vali Acc: 0.660 Test Loss: 1.202 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.2934440
	speed: 0.8527s/iter; left time: 21939.8258s
	iters: 200, epoch: 31 | loss: 0.1461084
	speed: 0.2659s/iter; left time: 6814.0969s
	iters: 300, epoch: 31 | loss: 0.1796076
	speed: 0.2668s/iter; left time: 6810.8030s
Epoch: 31 cost time: 101.40869283676147
Epoch: 31, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.130 Vali Acc: 0.646 Test Loss: 1.130 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0249081
	speed: 0.8526s/iter; left time: 21622.6448s
	iters: 200, epoch: 32 | loss: 0.1944848
	speed: 0.2843s/iter; left time: 7182.9405s
	iters: 300, epoch: 32 | loss: 0.0431988
	speed: 0.2640s/iter; left time: 6643.7372s
Epoch: 32 cost time: 100.48900032043457
Epoch: 32, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.399 Vali Acc: 0.650 Test Loss: 1.399 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6923950056753689
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6929259
	speed: 0.2690s/iter; left time: 9899.9160s
	iters: 200, epoch: 1 | loss: 0.7446455
	speed: 0.2543s/iter; left time: 9334.8041s
	iters: 300, epoch: 1 | loss: 1.1313920
	speed: 0.2567s/iter; left time: 9396.7771s
Epoch: 1 cost time: 96.68350386619568
Epoch: 1, Steps: 369 | Train Loss: 0.819 Vali Loss: 1.327 Vali Acc: 0.604 Test Loss: 1.327 Test Acc: 0.604
Validation loss decreased (inf --> -0.603846).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0543656
	speed: 0.8352s/iter; left time: 30428.4659s
	iters: 200, epoch: 2 | loss: 0.8790965
	speed: 0.2516s/iter; left time: 9139.8640s
	iters: 300, epoch: 2 | loss: 1.6375283
	speed: 0.2534s/iter; left time: 9180.3314s
Epoch: 2 cost time: 94.98046779632568
Epoch: 2, Steps: 369 | Train Loss: 0.920 Vali Loss: 0.955 Vali Acc: 0.643 Test Loss: 0.955 Test Acc: 0.643
Validation loss decreased (-0.603846 --> -0.642726).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0376278
	speed: 0.8226s/iter; left time: 29663.7704s
	iters: 200, epoch: 3 | loss: 0.5865685
	speed: 0.2500s/iter; left time: 8989.4807s
	iters: 300, epoch: 3 | loss: 1.7356431
	speed: 0.2465s/iter; left time: 8841.1751s
Epoch: 3 cost time: 93.12432074546814
Epoch: 3, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.810 Vali Acc: 0.657 Test Loss: 0.810 Test Acc: 0.657
Validation loss decreased (-0.642726 --> -0.656916).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7648367
	speed: 0.7952s/iter; left time: 28382.1686s
	iters: 200, epoch: 4 | loss: 0.5988244
	speed: 0.2559s/iter; left time: 9108.6091s
	iters: 300, epoch: 4 | loss: 0.7580511
	speed: 0.2530s/iter; left time: 8979.8384s
Epoch: 4 cost time: 93.11243653297424
Epoch: 4, Steps: 369 | Train Loss: 0.783 Vali Loss: 0.987 Vali Acc: 0.585 Test Loss: 0.987 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9950629
	speed: 0.7905s/iter; left time: 27924.8483s
	iters: 200, epoch: 5 | loss: 0.6853199
	speed: 0.2478s/iter; left time: 8729.9470s
	iters: 300, epoch: 5 | loss: 1.0656178
	speed: 0.2600s/iter; left time: 9133.2560s
Epoch: 5 cost time: 95.6877076625824
Epoch: 5, Steps: 369 | Train Loss: 0.781 Vali Loss: 0.787 Vali Acc: 0.543 Test Loss: 0.787 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5235101
	speed: 0.8183s/iter; left time: 28602.8564s
	iters: 200, epoch: 6 | loss: 0.6688104
	speed: 0.2595s/iter; left time: 9045.5273s
	iters: 300, epoch: 6 | loss: 0.5885981
	speed: 0.2565s/iter; left time: 8914.2737s
Epoch: 6 cost time: 95.1753261089325
Epoch: 6, Steps: 369 | Train Loss: 0.767 Vali Loss: 0.844 Vali Acc: 0.581 Test Loss: 0.844 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4602624
	speed: 0.8179s/iter; left time: 28287.4122s
	iters: 200, epoch: 7 | loss: 0.6452377
	speed: 0.2593s/iter; left time: 8942.9594s
	iters: 300, epoch: 7 | loss: 0.6758887
	speed: 0.2656s/iter; left time: 9131.9966s
Epoch: 7 cost time: 96.4635500907898
Epoch: 7, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.763 Vali Acc: 0.577 Test Loss: 0.763 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4644980
	speed: 0.8092s/iter; left time: 27690.0628s
	iters: 200, epoch: 8 | loss: 0.7790288
	speed: 0.2634s/iter; left time: 8986.7052s
	iters: 300, epoch: 8 | loss: 0.8229006
	speed: 0.2650s/iter; left time: 9013.7087s
Epoch: 8 cost time: 97.25542569160461
Epoch: 8, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.763 Vali Acc: 0.612 Test Loss: 0.763 Test Acc: 0.612
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.7009754
	speed: 0.8147s/iter; left time: 27575.5135s
	iters: 200, epoch: 9 | loss: 0.6885427
	speed: 0.2547s/iter; left time: 8597.3294s
	iters: 300, epoch: 9 | loss: 0.4651076
	speed: 0.2562s/iter; left time: 8620.2617s
Epoch: 9 cost time: 95.32091617584229
Epoch: 9, Steps: 369 | Train Loss: 0.656 Vali Loss: 0.717 Vali Acc: 0.633 Test Loss: 0.717 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7118471
	speed: 0.8141s/iter; left time: 27255.0866s
	iters: 200, epoch: 10 | loss: 0.6708923
	speed: 0.2554s/iter; left time: 8526.9057s
	iters: 300, epoch: 10 | loss: 0.5451360
	speed: 0.2496s/iter; left time: 8306.2584s
Epoch: 10 cost time: 94.58842658996582
Epoch: 10, Steps: 369 | Train Loss: 0.632 Vali Loss: 0.805 Vali Acc: 0.594 Test Loss: 0.805 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.5881447
	speed: 0.8146s/iter; left time: 26972.8513s
	iters: 200, epoch: 11 | loss: 0.3180621
	speed: 0.2585s/iter; left time: 8532.9814s
	iters: 300, epoch: 11 | loss: 0.5950078
	speed: 0.2558s/iter; left time: 8417.3410s
Epoch: 11 cost time: 95.60505747795105
Epoch: 11, Steps: 369 | Train Loss: 0.642 Vali Loss: 0.908 Vali Acc: 0.541 Test Loss: 0.908 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.7844023
	speed: 0.8236s/iter; left time: 26965.7471s
	iters: 200, epoch: 12 | loss: 0.2679957
	speed: 0.2495s/iter; left time: 8145.6332s
	iters: 300, epoch: 12 | loss: 0.6651778
	speed: 0.2555s/iter; left time: 8313.0927s
Epoch: 12 cost time: 93.91944861412048
Epoch: 12, Steps: 369 | Train Loss: 0.626 Vali Loss: 0.753 Vali Acc: 0.644 Test Loss: 0.753 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7905186
	speed: 0.8029s/iter; left time: 25991.1211s
	iters: 200, epoch: 13 | loss: 0.2684860
	speed: 0.2655s/iter; left time: 8567.4497s
	iters: 300, epoch: 13 | loss: 0.6694862
	speed: 0.2606s/iter; left time: 8383.1187s
Epoch: 13 cost time: 96.67205142974854
Epoch: 13, Steps: 369 | Train Loss: 0.609 Vali Loss: 0.661 Vali Acc: 0.653 Test Loss: 0.661 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6569239500567536
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6931171
	speed: 0.2781s/iter; left time: 10235.8846s
	iters: 200, epoch: 1 | loss: 0.6929460
	speed: 0.2518s/iter; left time: 9239.7883s
	iters: 300, epoch: 1 | loss: 0.6931506
	speed: 0.2447s/iter; left time: 8956.1244s
Epoch: 1 cost time: 95.07243967056274
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6931604
	speed: 0.8463s/iter; left time: 30830.8231s
	iters: 200, epoch: 2 | loss: 0.6920671
	speed: 0.2668s/iter; left time: 9694.7726s
	iters: 300, epoch: 2 | loss: 0.6926860
	speed: 0.2586s/iter; left time: 9370.8962s
Epoch: 2 cost time: 98.57401847839355
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6928211
	speed: 0.8196s/iter; left time: 29557.6038s
	iters: 200, epoch: 3 | loss: 0.6931584
	speed: 0.2530s/iter; left time: 9097.5655s
	iters: 300, epoch: 3 | loss: 0.6934412
	speed: 0.2632s/iter; left time: 9440.2037s
Epoch: 3 cost time: 95.58260679244995
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6934909
	speed: 0.8202s/iter; left time: 29277.9633s
	iters: 200, epoch: 4 | loss: 0.6934080
	speed: 0.2697s/iter; left time: 9601.2170s
	iters: 300, epoch: 4 | loss: 0.6931482
	speed: 0.2680s/iter; left time: 9510.7262s
Epoch: 4 cost time: 99.16202807426453
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6913510
	speed: 0.8218s/iter; left time: 29028.8271s
	iters: 200, epoch: 5 | loss: 0.6911163
	speed: 0.2617s/iter; left time: 9219.6885s
	iters: 300, epoch: 5 | loss: 0.6929992
	speed: 0.2657s/iter; left time: 9334.4553s
Epoch: 5 cost time: 97.51975011825562
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6932411
	speed: 0.8136s/iter; left time: 28439.5093s
	iters: 200, epoch: 6 | loss: 0.6919932
	speed: 0.2553s/iter; left time: 8898.4387s
	iters: 300, epoch: 6 | loss: 0.6946121
	speed: 0.2514s/iter; left time: 8736.7225s
Epoch: 6 cost time: 95.54544615745544
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6932004
	speed: 0.8068s/iter; left time: 27904.9545s
	iters: 200, epoch: 7 | loss: 0.6980563
	speed: 0.2620s/iter; left time: 9034.2168s
	iters: 300, epoch: 7 | loss: 0.6931378
	speed: 0.2661s/iter; left time: 9149.7643s
Epoch: 7 cost time: 96.25462698936462
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6923603
	speed: 0.8405s/iter; left time: 28759.7561s
	iters: 200, epoch: 8 | loss: 0.6902300
	speed: 0.2651s/iter; left time: 9045.6308s
	iters: 300, epoch: 8 | loss: 0.6951829
	speed: 0.2539s/iter; left time: 8636.6418s
Epoch: 8 cost time: 97.60622143745422
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6953040
	speed: 0.8387s/iter; left time: 28387.5758s
	iters: 200, epoch: 9 | loss: 0.6929400
	speed: 0.2692s/iter; left time: 9085.5067s
	iters: 300, epoch: 9 | loss: 0.6892446
	speed: 0.2728s/iter; left time: 9179.0673s
Epoch: 9 cost time: 101.18572545051575
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6931677
	speed: 0.8475s/iter; left time: 28373.9193s
	iters: 200, epoch: 10 | loss: 0.6918942
	speed: 0.2621s/iter; left time: 8750.3008s
	iters: 300, epoch: 10 | loss: 0.6929951
	speed: 0.2742s/iter; left time: 9125.5421s
Epoch: 10 cost time: 98.5181794166565
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6929231
	speed: 0.8413s/iter; left time: 27854.8592s
	iters: 200, epoch: 11 | loss: 0.6974651
	speed: 0.2582s/iter; left time: 8524.0057s
	iters: 300, epoch: 11 | loss: 0.6923582
	speed: 0.2676s/iter; left time: 8808.3311s
Epoch: 11 cost time: 99.73680520057678
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6931477
	speed: 0.8575s/iter; left time: 28076.5190s
	iters: 200, epoch: 12 | loss: 0.6932092
	speed: 0.2743s/iter; left time: 8953.1037s
	iters: 300, epoch: 12 | loss: 0.6919410
	speed: 0.2759s/iter; left time: 8978.5410s
Epoch: 12 cost time: 102.73392796516418
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6938425
	speed: 0.8733s/iter; left time: 28270.5248s
	iters: 200, epoch: 13 | loss: 0.6915293
	speed: 0.2662s/iter; left time: 8592.2840s
	iters: 300, epoch: 13 | loss: 0.6933436
	speed: 0.2674s/iter; left time: 8604.6192s
Epoch: 13 cost time: 101.20493626594543
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6869870
	speed: 0.8564s/iter; left time: 27409.1743s
	iters: 200, epoch: 14 | loss: 0.6928911
	speed: 0.2639s/iter; left time: 8418.4693s
	iters: 300, epoch: 14 | loss: 0.6931491
	speed: 0.2787s/iter; left time: 8864.1790s
Epoch: 14 cost time: 101.18786811828613
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6931607
	speed: 0.8758s/iter; left time: 27705.5432s
	iters: 200, epoch: 15 | loss: 0.6905304
	speed: 0.2777s/iter; left time: 8757.3530s
	iters: 300, epoch: 15 | loss: 0.6943461
	speed: 0.2723s/iter; left time: 8560.5336s
Epoch: 15 cost time: 103.02193427085876
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6918407
	speed: 0.8339s/iter; left time: 26073.4184s
	iters: 200, epoch: 16 | loss: 0.6976291
	speed: 0.2760s/iter; left time: 8601.5049s
	iters: 300, epoch: 16 | loss: 0.6938632
	speed: 0.2713s/iter; left time: 8428.7799s
Epoch: 16 cost time: 99.72531962394714
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6925767
	speed: 0.8504s/iter; left time: 26275.4173s
	iters: 200, epoch: 17 | loss: 0.6932403
	speed: 0.2699s/iter; left time: 8311.9532s
	iters: 300, epoch: 17 | loss: 0.6931649
	speed: 0.2768s/iter; left time: 8496.5309s
Epoch: 17 cost time: 100.57060098648071
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6932386
	speed: 0.8576s/iter; left time: 26179.5747s
	iters: 200, epoch: 18 | loss: 0.6938483
	speed: 0.2692s/iter; left time: 8192.1071s
	iters: 300, epoch: 18 | loss: 0.6914791
	speed: 0.2745s/iter; left time: 8324.4100s
Epoch: 18 cost time: 100.81162691116333
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6962714
	speed: 0.8675s/iter; left time: 26164.4055s
	iters: 200, epoch: 19 | loss: 0.6994199
	speed: 0.2668s/iter; left time: 8020.0863s
	iters: 300, epoch: 19 | loss: 0.6928733
	speed: 0.2641s/iter; left time: 7913.4818s
Epoch: 19 cost time: 99.97516894340515
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.6937999
	speed: 0.8435s/iter; left time: 25127.7172s
	iters: 200, epoch: 20 | loss: 0.6931482
	speed: 0.2643s/iter; left time: 7847.3641s
	iters: 300, epoch: 20 | loss: 0.6931481
	speed: 0.2608s/iter; left time: 7716.9614s
Epoch: 20 cost time: 97.45475101470947
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.6909591
	speed: 0.8352s/iter; left time: 24572.4817s
	iters: 200, epoch: 21 | loss: 0.6945789
	speed: 0.2649s/iter; left time: 7768.0996s
	iters: 300, epoch: 21 | loss: 0.6947253
	speed: 0.2528s/iter; left time: 7387.5462s
Epoch: 21 cost time: 98.24356842041016
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.6941863
	speed: 0.8368s/iter; left time: 24309.3100s
	iters: 200, epoch: 22 | loss: 0.6944573
	speed: 0.2597s/iter; left time: 7517.6728s
	iters: 300, epoch: 22 | loss: 0.6931564
	speed: 0.2596s/iter; left time: 7490.0773s
Epoch: 22 cost time: 97.26843237876892
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.6949047
	speed: 0.8416s/iter; left time: 24138.9959s
	iters: 200, epoch: 23 | loss: 0.6935186
	speed: 0.2717s/iter; left time: 7766.4037s
	iters: 300, epoch: 23 | loss: 0.6931517
	speed: 0.2645s/iter; left time: 7533.0154s
Epoch: 23 cost time: 98.86535239219666
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.6934415
	speed: 0.8611s/iter; left time: 24380.9832s
	iters: 200, epoch: 24 | loss: 0.6924453
	speed: 0.2659s/iter; left time: 7503.2757s
	iters: 300, epoch: 24 | loss: 0.6953595
	speed: 0.2670s/iter; left time: 7506.0920s
Epoch: 24 cost time: 101.38299608230591
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6930939
	speed: 0.8630s/iter; left time: 24115.1408s
	iters: 200, epoch: 25 | loss: 0.6901148
	speed: 0.2508s/iter; left time: 6982.4264s
	iters: 300, epoch: 25 | loss: 0.6932508
	speed: 0.2651s/iter; left time: 7355.6809s
Epoch: 25 cost time: 96.39627194404602
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.6906132
	speed: 0.8247s/iter; left time: 22741.7539s
	iters: 200, epoch: 26 | loss: 0.6940159
	speed: 0.2483s/iter; left time: 6822.6184s
	iters: 300, epoch: 26 | loss: 0.6911379
	speed: 0.2612s/iter; left time: 7150.3141s
Epoch: 26 cost time: 96.35498642921448
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.6932320
	speed: 0.8287s/iter; left time: 22546.2963s
	iters: 200, epoch: 27 | loss: 0.6901600
	speed: 0.2621s/iter; left time: 7103.8747s
	iters: 300, epoch: 27 | loss: 0.6931606
	speed: 0.2735s/iter; left time: 7385.1170s
Epoch: 27 cost time: 97.56020903587341
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.6931774
	speed: 0.8251s/iter; left time: 22144.4083s
	iters: 200, epoch: 28 | loss: 0.6954937
	speed: 0.2863s/iter; left time: 7654.6357s
	iters: 300, epoch: 28 | loss: 0.6960205
	speed: 0.2759s/iter; left time: 7350.4615s
Epoch: 28 cost time: 100.62243247032166
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.6931596
	speed: 0.8704s/iter; left time: 23037.8831s
	iters: 200, epoch: 29 | loss: 0.6887639
	speed: 0.2725s/iter; left time: 7184.7561s
	iters: 300, epoch: 29 | loss: 0.6952363
	speed: 0.2670s/iter; left time: 7012.7694s
Epoch: 29 cost time: 101.56366300582886
Epoch: 29, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.6933540
	speed: 0.8577s/iter; left time: 22385.8897s
	iters: 200, epoch: 30 | loss: 0.6926622
	speed: 0.2626s/iter; left time: 6826.5824s
	iters: 300, epoch: 30 | loss: 0.6931497
	speed: 0.2724s/iter; left time: 7055.8194s
Epoch: 30 cost time: 100.52998161315918
Epoch: 30, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.6932088
	speed: 0.8569s/iter; left time: 22049.4503s
	iters: 200, epoch: 31 | loss: 0.6929296
	speed: 0.2593s/iter; left time: 6645.4978s
	iters: 300, epoch: 31 | loss: 0.6940023
	speed: 0.2745s/iter; left time: 7007.4467s
Epoch: 31 cost time: 99.23402905464172
Epoch: 31, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.6931619
	speed: 0.8392s/iter; left time: 21283.4720s
	iters: 200, epoch: 32 | loss: 0.6927201
	speed: 0.2646s/iter; left time: 6685.1097s
	iters: 300, epoch: 32 | loss: 0.6923300
	speed: 0.2649s/iter; left time: 6666.3186s
Epoch: 32 cost time: 99.52871084213257
Epoch: 32, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.6932074
	speed: 0.8504s/iter; left time: 21254.8707s
	iters: 200, epoch: 33 | loss: 0.6931580
	speed: 0.2697s/iter; left time: 6713.9602s
	iters: 300, epoch: 33 | loss: 0.6936126
	speed: 0.2660s/iter; left time: 6594.4031s
Epoch: 33 cost time: 100.50475645065308
Epoch: 33, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.6966168
	speed: 0.8799s/iter; left time: 21667.0078s
	iters: 200, epoch: 34 | loss: 0.6932139
	speed: 0.2836s/iter; left time: 6954.6104s
	iters: 300, epoch: 34 | loss: 0.6930277
	speed: 0.2772s/iter; left time: 6770.0973s
Epoch: 34 cost time: 104.13946866989136
Epoch: 34, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 11647490
model size : 63.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7955968
	speed: 0.2893s/iter; left time: 10646.5853s
	iters: 200, epoch: 1 | loss: 0.5272431
	speed: 0.2814s/iter; left time: 10329.1651s
	iters: 300, epoch: 1 | loss: 0.3166284
	speed: 0.2668s/iter; left time: 9765.1825s
Epoch: 1 cost time: 102.82654643058777
Epoch: 1, Steps: 369 | Train Loss: 0.792 Vali Loss: 1.492 Vali Acc: 0.611 Test Loss: 1.492 Test Acc: 0.611
Validation loss decreased (inf --> -0.610939).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2164923
	speed: 0.8576s/iter; left time: 31245.4039s
	iters: 200, epoch: 2 | loss: 0.3122186
	speed: 0.2657s/iter; left time: 9653.7126s
	iters: 300, epoch: 2 | loss: 0.8091760
	speed: 0.2706s/iter; left time: 9805.6956s
Epoch: 2 cost time: 100.12238335609436
Epoch: 2, Steps: 369 | Train Loss: 0.956 Vali Loss: 1.637 Vali Acc: 0.629 Test Loss: 1.637 Test Acc: 0.629
Validation loss decreased (-0.610939 --> -0.629382).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9884377
	speed: 0.8813s/iter; left time: 31782.0661s
	iters: 200, epoch: 3 | loss: 0.4214806
	speed: 0.2668s/iter; left time: 9595.9029s
	iters: 300, epoch: 3 | loss: 1.5846102
	speed: 0.2637s/iter; left time: 9456.2906s
Epoch: 3 cost time: 103.4645643234253
Epoch: 3, Steps: 369 | Train Loss: 1.138 Vali Loss: 1.948 Vali Acc: 0.607 Test Loss: 1.948 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1136476
	speed: 0.9028s/iter; left time: 32224.2881s
	iters: 200, epoch: 4 | loss: 1.7241763
	speed: 0.2619s/iter; left time: 9321.4198s
	iters: 300, epoch: 4 | loss: 1.3010010
	speed: 0.2689s/iter; left time: 9545.7376s
Epoch: 4 cost time: 100.69358444213867
Epoch: 4, Steps: 369 | Train Loss: 1.155 Vali Loss: 1.531 Vali Acc: 0.522 Test Loss: 1.531 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3326938
	speed: 0.8195s/iter; left time: 28948.2626s
	iters: 200, epoch: 5 | loss: 0.7965860
	speed: 0.2768s/iter; left time: 9750.2296s
	iters: 300, epoch: 5 | loss: 0.7626510
	speed: 0.2596s/iter; left time: 9118.2680s
Epoch: 5 cost time: 97.94874548912048
Epoch: 5, Steps: 369 | Train Loss: 0.820 Vali Loss: 0.714 Vali Acc: 0.651 Test Loss: 0.714 Test Acc: 0.651
Validation loss decreased (-0.629382 --> -0.650674).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5871776
	speed: 0.8416s/iter; left time: 29419.4252s
	iters: 200, epoch: 6 | loss: 0.8908773
	speed: 0.2867s/iter; left time: 9993.4705s
	iters: 300, epoch: 6 | loss: 0.9240335
	speed: 0.2848s/iter; left time: 9897.6806s
Epoch: 6 cost time: 104.65947604179382
Epoch: 6, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.823 Vali Acc: 0.684 Test Loss: 0.823 Test Acc: 0.684
Validation loss decreased (-0.650674 --> -0.684157).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8917667
	speed: 0.8857s/iter; left time: 30631.9919s
	iters: 200, epoch: 7 | loss: 0.4408814
	speed: 0.2775s/iter; left time: 9570.5798s
	iters: 300, epoch: 7 | loss: 0.2959460
	speed: 0.2703s/iter; left time: 9294.9390s
Epoch: 7 cost time: 102.03641200065613
Epoch: 7, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.785 Vali Acc: 0.662 Test Loss: 0.785 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5593733
	speed: 0.8507s/iter; left time: 29110.0208s
	iters: 200, epoch: 8 | loss: 0.5145884
	speed: 0.2620s/iter; left time: 8940.4960s
	iters: 300, epoch: 8 | loss: 0.6292987
	speed: 0.2569s/iter; left time: 8738.6764s
Epoch: 8 cost time: 97.03176879882812
Epoch: 8, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.816 Vali Acc: 0.650 Test Loss: 0.816 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6724323
	speed: 0.8376s/iter; left time: 28352.7975s
	iters: 200, epoch: 9 | loss: 0.8157346
	speed: 0.2559s/iter; left time: 8635.7106s
	iters: 300, epoch: 9 | loss: 0.6781417
	speed: 0.2626s/iter; left time: 8836.7247s
Epoch: 9 cost time: 97.09248447418213
Epoch: 9, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.799 Vali Acc: 0.637 Test Loss: 0.799 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2706993
	speed: 0.8684s/iter; left time: 29073.5689s
	iters: 200, epoch: 10 | loss: 0.5262217
	speed: 0.2796s/iter; left time: 9334.6254s
	iters: 300, epoch: 10 | loss: 0.7966049
	speed: 0.2938s/iter; left time: 9778.0571s
Epoch: 10 cost time: 104.56970047950745
Epoch: 10, Steps: 369 | Train Loss: 0.601 Vali Loss: 0.711 Vali Acc: 0.641 Test Loss: 0.711 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5672881
	speed: 0.8503s/iter; left time: 28153.0785s
	iters: 200, epoch: 11 | loss: 0.5800278
	speed: 0.2557s/iter; left time: 8440.0831s
	iters: 300, epoch: 11 | loss: 0.5508104
	speed: 0.2625s/iter; left time: 8638.0334s
Epoch: 11 cost time: 98.80086016654968
Epoch: 11, Steps: 369 | Train Loss: 0.540 Vali Loss: 0.753 Vali Acc: 0.664 Test Loss: 0.753 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.3767242
	speed: 0.8158s/iter; left time: 26709.6230s
	iters: 200, epoch: 12 | loss: 0.6366473
	speed: 0.2686s/iter; left time: 8766.0368s
	iters: 300, epoch: 12 | loss: 0.4910635
	speed: 0.2552s/iter; left time: 8305.0541s
Epoch: 12 cost time: 97.46512079238892
Epoch: 12, Steps: 369 | Train Loss: 0.521 Vali Loss: 0.764 Vali Acc: 0.643 Test Loss: 0.764 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.7976985
	speed: 0.8243s/iter; left time: 26685.3427s
	iters: 200, epoch: 13 | loss: 0.5971836
	speed: 0.2777s/iter; left time: 8961.9876s
	iters: 300, epoch: 13 | loss: 0.7377819
	speed: 0.2808s/iter; left time: 9034.0035s
Epoch: 13 cost time: 99.54546093940735
Epoch: 13, Steps: 369 | Train Loss: 0.479 Vali Loss: 0.780 Vali Acc: 0.690 Test Loss: 0.780 Test Acc: 0.690
Validation loss decreased (-0.684157 --> -0.689550).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4245522
	speed: 0.8429s/iter; left time: 26976.4301s
	iters: 200, epoch: 14 | loss: 0.2523899
	speed: 0.2644s/iter; left time: 8434.5083s
	iters: 300, epoch: 14 | loss: 0.4916629
	speed: 0.2619s/iter; left time: 8329.5786s
Epoch: 14 cost time: 99.17638516426086
Epoch: 14, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.771 Vali Acc: 0.661 Test Loss: 0.771 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7816326
	speed: 0.8417s/iter; left time: 26626.9735s
	iters: 200, epoch: 15 | loss: 0.5644957
	speed: 0.2705s/iter; left time: 8529.8384s
	iters: 300, epoch: 15 | loss: 0.5555293
	speed: 0.2576s/iter; left time: 8097.3114s
Epoch: 15 cost time: 95.53229475021362
Epoch: 15, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.731 Vali Acc: 0.676 Test Loss: 0.731 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3131469
	speed: 0.8182s/iter; left time: 25581.0030s
	iters: 200, epoch: 16 | loss: 0.5459253
	speed: 0.2567s/iter; left time: 8001.0980s
	iters: 300, epoch: 16 | loss: 0.4158273
	speed: 0.2591s/iter; left time: 8050.6225s
Epoch: 16 cost time: 95.3646137714386
Epoch: 16, Steps: 369 | Train Loss: 0.401 Vali Loss: 0.847 Vali Acc: 0.662 Test Loss: 0.847 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3550356
	speed: 0.8323s/iter; left time: 25715.1210s
	iters: 200, epoch: 17 | loss: 0.5544683
	speed: 0.2611s/iter; left time: 8040.8312s
	iters: 300, epoch: 17 | loss: 0.4542626
	speed: 0.2770s/iter; left time: 8502.4991s
Epoch: 17 cost time: 101.4826090335846
Epoch: 17, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.732 Vali Acc: 0.695 Test Loss: 0.732 Test Acc: 0.695
Validation loss decreased (-0.689550 --> -0.695225).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.6097628
	speed: 0.8810s/iter; left time: 26895.7344s
	iters: 200, epoch: 18 | loss: 0.4087965
	speed: 0.2769s/iter; left time: 8426.2950s
	iters: 300, epoch: 18 | loss: 0.2667517
	speed: 0.2779s/iter; left time: 8427.3778s
Epoch: 18 cost time: 103.2982759475708
Epoch: 18, Steps: 369 | Train Loss: 0.369 Vali Loss: 0.803 Vali Acc: 0.659 Test Loss: 0.803 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1822500
	speed: 0.8875s/iter; left time: 26767.4440s
	iters: 200, epoch: 19 | loss: 0.1963713
	speed: 0.2781s/iter; left time: 8357.9498s
	iters: 300, epoch: 19 | loss: 0.3676582
	speed: 0.2692s/iter; left time: 8065.5337s
Epoch: 19 cost time: 101.57215023040771
Epoch: 19, Steps: 369 | Train Loss: 0.322 Vali Loss: 1.093 Vali Acc: 0.670 Test Loss: 1.093 Test Acc: 0.670
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2276723
	speed: 0.8684s/iter; left time: 25870.8457s
	iters: 200, epoch: 20 | loss: 0.1559000
	speed: 0.2798s/iter; left time: 8308.0920s
	iters: 300, epoch: 20 | loss: 0.2718968
	speed: 0.2674s/iter; left time: 7912.6481s
Epoch: 20 cost time: 99.98183059692383
Epoch: 20, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.994 Vali Acc: 0.678 Test Loss: 0.994 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2503245
	speed: 0.8500s/iter; left time: 25007.7992s
	iters: 200, epoch: 21 | loss: 0.4168701
	speed: 0.2794s/iter; left time: 8191.9607s
	iters: 300, epoch: 21 | loss: 0.2788914
	speed: 0.2667s/iter; left time: 7794.2107s
Epoch: 21 cost time: 101.5573878288269
Epoch: 21, Steps: 369 | Train Loss: 0.261 Vali Loss: 0.971 Vali Acc: 0.662 Test Loss: 0.971 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1131322
	speed: 0.8517s/iter; left time: 24743.8003s
	iters: 200, epoch: 22 | loss: 0.4015163
	speed: 0.2595s/iter; left time: 7511.6519s
	iters: 300, epoch: 22 | loss: 0.2476044
	speed: 0.2828s/iter; left time: 8158.6464s
Epoch: 22 cost time: 100.1186740398407
Epoch: 22, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.133 Vali Acc: 0.666 Test Loss: 1.133 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1491195
	speed: 0.8415s/iter; left time: 24136.1929s
	iters: 200, epoch: 23 | loss: 0.0138231
	speed: 0.2534s/iter; left time: 7243.3753s
	iters: 300, epoch: 23 | loss: 0.2987856
	speed: 0.2649s/iter; left time: 7544.8571s
Epoch: 23 cost time: 97.81531810760498
Epoch: 23, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.109 Vali Acc: 0.652 Test Loss: 1.109 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0277998
	speed: 0.8684s/iter; left time: 24586.8682s
	iters: 200, epoch: 24 | loss: 0.3833292
	speed: 0.2620s/iter; left time: 7392.2873s
	iters: 300, epoch: 24 | loss: 0.2955849
	speed: 0.2718s/iter; left time: 7640.4159s
Epoch: 24 cost time: 99.86050987243652
Epoch: 24, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.164 Vali Acc: 0.648 Test Loss: 1.164 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0259394
	speed: 0.8686s/iter; left time: 24274.1185s
	iters: 200, epoch: 25 | loss: 0.2211473
	speed: 0.2597s/iter; left time: 7230.3564s
	iters: 300, epoch: 25 | loss: 0.1908372
	speed: 0.2584s/iter; left time: 7169.9064s
Epoch: 25 cost time: 99.87797117233276
Epoch: 25, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.294 Vali Acc: 0.645 Test Loss: 1.294 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0247258
	speed: 0.8459s/iter; left time: 23327.4904s
	iters: 200, epoch: 26 | loss: 0.0067762
	speed: 0.2691s/iter; left time: 7393.0761s
	iters: 300, epoch: 26 | loss: 0.1388093
	speed: 0.2565s/iter; left time: 7021.3328s
Epoch: 26 cost time: 98.07509708404541
Epoch: 26, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.370 Vali Acc: 0.636 Test Loss: 1.370 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0050564
	speed: 0.8231s/iter; left time: 22394.6770s
	iters: 200, epoch: 27 | loss: 0.4186790
	speed: 0.2729s/iter; left time: 7397.0203s
	iters: 300, epoch: 27 | loss: 0.0553852
	speed: 0.2561s/iter; left time: 6916.1931s
Epoch: 27 cost time: 98.87464904785156
Epoch: 27, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.859 Vali Acc: 0.659 Test Loss: 1.859 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6952326901248581
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8010750
	speed: 0.2878s/iter; left time: 10592.7852s
	iters: 200, epoch: 1 | loss: 0.6779477
	speed: 0.2768s/iter; left time: 10160.3048s
	iters: 300, epoch: 1 | loss: 0.2138103
	speed: 0.2851s/iter; left time: 10434.2112s
Epoch: 1 cost time: 104.60864782333374
Epoch: 1, Steps: 369 | Train Loss: 0.794 Vali Loss: 1.178 Vali Acc: 0.617 Test Loss: 1.178 Test Acc: 0.617
Validation loss decreased (inf --> -0.617468).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6822056
	speed: 0.8605s/iter; left time: 31348.5033s
	iters: 200, epoch: 2 | loss: 0.9988071
	speed: 0.2582s/iter; left time: 9379.3773s
	iters: 300, epoch: 2 | loss: 0.9256232
	speed: 0.2612s/iter; left time: 9465.0556s
Epoch: 2 cost time: 97.77285957336426
Epoch: 2, Steps: 369 | Train Loss: 0.929 Vali Loss: 1.808 Vali Acc: 0.612 Test Loss: 1.808 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0284330
	speed: 0.8612s/iter; left time: 31056.9073s
	iters: 200, epoch: 3 | loss: 0.1229750
	speed: 0.2815s/iter; left time: 10123.1820s
	iters: 300, epoch: 3 | loss: 1.9967605
	speed: 0.2721s/iter; left time: 9757.0968s
Epoch: 3 cost time: 102.85022830963135
Epoch: 3, Steps: 369 | Train Loss: 1.183 Vali Loss: 2.658 Vali Acc: 0.585 Test Loss: 2.658 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9074552
	speed: 0.8652s/iter; left time: 30881.4465s
	iters: 200, epoch: 4 | loss: 1.6386765
	speed: 0.2758s/iter; left time: 9817.9950s
	iters: 300, epoch: 4 | loss: 0.9808997
	speed: 0.2936s/iter; left time: 10421.5636s
Epoch: 4 cost time: 103.07954955101013
Epoch: 4, Steps: 369 | Train Loss: 1.317 Vali Loss: 1.856 Vali Acc: 0.611 Test Loss: 1.856 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1661465
	speed: 0.8351s/iter; left time: 29498.9762s
	iters: 200, epoch: 5 | loss: 1.2209388
	speed: 0.2684s/iter; left time: 9455.0309s
	iters: 300, epoch: 5 | loss: 0.5461341
	speed: 0.2847s/iter; left time: 9999.1368s
Epoch: 5 cost time: 100.4672737121582
Epoch: 5, Steps: 369 | Train Loss: 0.813 Vali Loss: 0.757 Vali Acc: 0.627 Test Loss: 0.757 Test Acc: 0.627
Validation loss decreased (-0.617468 --> -0.626837).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3190590
	speed: 0.8223s/iter; left time: 28745.5809s
	iters: 200, epoch: 6 | loss: 0.8066234
	speed: 0.2781s/iter; left time: 9691.9123s
	iters: 300, epoch: 6 | loss: 0.3930792
	speed: 0.2606s/iter; left time: 9057.4054s
Epoch: 6 cost time: 97.64628672599792
Epoch: 6, Steps: 369 | Train Loss: 0.599 Vali Loss: 1.055 Vali Acc: 0.658 Test Loss: 1.055 Test Acc: 0.658
Validation loss decreased (-0.626837 --> -0.657765).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2205354
	speed: 0.7987s/iter; left time: 27625.8619s
	iters: 200, epoch: 7 | loss: 0.3929171
	speed: 0.2538s/iter; left time: 8752.0841s
	iters: 300, epoch: 7 | loss: 0.3921804
	speed: 0.2578s/iter; left time: 8865.8557s
Epoch: 7 cost time: 93.3150200843811
Epoch: 7, Steps: 369 | Train Loss: 0.533 Vali Loss: 0.846 Vali Acc: 0.592 Test Loss: 0.846 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4989741
	speed: 0.7878s/iter; left time: 26958.5359s
	iters: 200, epoch: 8 | loss: 0.6675277
	speed: 0.2609s/iter; left time: 8900.4408s
	iters: 300, epoch: 8 | loss: 0.5572631
	speed: 0.2486s/iter; left time: 8457.8054s
Epoch: 8 cost time: 93.26030111312866
Epoch: 8, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.792 Vali Acc: 0.582 Test Loss: 0.792 Test Acc: 0.582
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7442242
	speed: 0.7869s/iter; left time: 26636.2414s
	iters: 200, epoch: 9 | loss: 0.7829173
	speed: 0.2622s/iter; left time: 8848.3970s
	iters: 300, epoch: 9 | loss: 0.8937413
	speed: 0.2425s/iter; left time: 8159.3032s
Epoch: 9 cost time: 93.18722200393677
Epoch: 9, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.813 Vali Acc: 0.625 Test Loss: 0.813 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6080066
	speed: 0.7814s/iter; left time: 26161.5630s
	iters: 200, epoch: 10 | loss: 0.2421612
	speed: 0.2434s/iter; left time: 8123.7789s
	iters: 300, epoch: 10 | loss: 0.4737922
	speed: 0.2451s/iter; left time: 8155.5438s
Epoch: 10 cost time: 90.84097385406494
Epoch: 10, Steps: 369 | Train Loss: 0.563 Vali Loss: 0.695 Vali Acc: 0.665 Test Loss: 0.695 Test Acc: 0.665
Validation loss decreased (-0.657765 --> -0.664579).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4042689
	speed: 0.7959s/iter; left time: 26352.1650s
	iters: 200, epoch: 11 | loss: 0.3247635
	speed: 0.2471s/iter; left time: 8157.2135s
	iters: 300, epoch: 11 | loss: 0.6226156
	speed: 0.2616s/iter; left time: 8611.0082s
Epoch: 11 cost time: 95.76001858711243
Epoch: 11, Steps: 369 | Train Loss: 0.492 Vali Loss: 0.927 Vali Acc: 0.663 Test Loss: 0.927 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2321820
	speed: 0.8135s/iter; left time: 26636.1058s
	iters: 200, epoch: 12 | loss: 0.5639489
	speed: 0.2647s/iter; left time: 8640.1902s
	iters: 300, epoch: 12 | loss: 0.7272561
	speed: 0.2620s/iter; left time: 8527.3498s
Epoch: 12 cost time: 96.29184985160828
Epoch: 12, Steps: 369 | Train Loss: 0.458 Vali Loss: 0.742 Vali Acc: 0.631 Test Loss: 0.742 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5166453
	speed: 0.8106s/iter; left time: 26242.7891s
	iters: 200, epoch: 13 | loss: 0.2925992
	speed: 0.2546s/iter; left time: 8217.1653s
	iters: 300, epoch: 13 | loss: 0.6991003
	speed: 0.2528s/iter; left time: 8133.5679s
Epoch: 13 cost time: 95.64678049087524
Epoch: 13, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.872 Vali Acc: 0.667 Test Loss: 0.872 Test Acc: 0.667
Validation loss decreased (-0.664579 --> -0.666847).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2780592
	speed: 0.7981s/iter; left time: 25541.6693s
	iters: 200, epoch: 14 | loss: 0.1634700
	speed: 0.2555s/iter; left time: 8152.4797s
	iters: 300, epoch: 14 | loss: 0.4667221
	speed: 0.2457s/iter; left time: 7814.0252s
Epoch: 14 cost time: 92.86391067504883
Epoch: 14, Steps: 369 | Train Loss: 0.387 Vali Loss: 0.873 Vali Acc: 0.659 Test Loss: 0.873 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5907173
	speed: 0.8026s/iter; left time: 25390.6762s
	iters: 200, epoch: 15 | loss: 0.3839766
	speed: 0.2622s/iter; left time: 8269.8017s
	iters: 300, epoch: 15 | loss: 0.6151084
	speed: 0.2565s/iter; left time: 8063.6944s
Epoch: 15 cost time: 96.74839901924133
Epoch: 15, Steps: 369 | Train Loss: 0.359 Vali Loss: 1.050 Vali Acc: 0.673 Test Loss: 1.050 Test Acc: 0.673
Validation loss decreased (-0.666847 --> -0.673372).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2340259
	speed: 0.8338s/iter; left time: 26070.1033s
	iters: 200, epoch: 16 | loss: 0.3167170
	speed: 0.2561s/iter; left time: 7980.9038s
	iters: 300, epoch: 16 | loss: 0.1164952
	speed: 0.2553s/iter; left time: 7932.2469s
Epoch: 16 cost time: 96.31973695755005
Epoch: 16, Steps: 369 | Train Loss: 0.329 Vali Loss: 1.128 Vali Acc: 0.672 Test Loss: 1.128 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5951673
	speed: 0.8045s/iter; left time: 24857.4880s
	iters: 200, epoch: 17 | loss: 0.5625633
	speed: 0.2512s/iter; left time: 7737.3962s
	iters: 300, epoch: 17 | loss: 0.3461660
	speed: 0.2517s/iter; left time: 7727.4376s
Epoch: 17 cost time: 94.14489603042603
Epoch: 17, Steps: 369 | Train Loss: 0.298 Vali Loss: 1.009 Vali Acc: 0.661 Test Loss: 1.009 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2557458
	speed: 0.8131s/iter; left time: 24822.0465s
	iters: 200, epoch: 18 | loss: 0.1201302
	speed: 0.2484s/iter; left time: 7558.5764s
	iters: 300, epoch: 18 | loss: 0.4168693
	speed: 0.2560s/iter; left time: 7763.4946s
Epoch: 18 cost time: 94.14570665359497
Epoch: 18, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.010 Vali Acc: 0.651 Test Loss: 1.010 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0662173
	speed: 0.7796s/iter; left time: 23512.5145s
	iters: 200, epoch: 19 | loss: 0.0132479
	speed: 0.2468s/iter; left time: 7417.8716s
	iters: 300, epoch: 19 | loss: 0.5859772
	speed: 0.2559s/iter; left time: 7665.9864s
Epoch: 19 cost time: 92.71728849411011
Epoch: 19, Steps: 369 | Train Loss: 0.239 Vali Loss: 1.181 Vali Acc: 0.667 Test Loss: 1.181 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2293919
	speed: 0.7855s/iter; left time: 23398.7126s
	iters: 200, epoch: 20 | loss: 0.0499997
	speed: 0.2461s/iter; left time: 7305.2673s
	iters: 300, epoch: 20 | loss: 0.4527457
	speed: 0.2433s/iter; left time: 7198.9151s
Epoch: 20 cost time: 91.71757388114929
Epoch: 20, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.306 Vali Acc: 0.650 Test Loss: 1.306 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0436232
	speed: 0.8144s/iter; left time: 23959.6734s
	iters: 200, epoch: 21 | loss: 0.0722491
	speed: 0.2753s/iter; left time: 8072.7733s
	iters: 300, epoch: 21 | loss: 0.2839582
	speed: 0.2656s/iter; left time: 7760.3498s
Epoch: 21 cost time: 99.03160309791565
Epoch: 21, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.038 Vali Acc: 0.660 Test Loss: 1.038 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0921844
	speed: 0.8018s/iter; left time: 23294.5129s
	iters: 200, epoch: 22 | loss: 0.4595856
	speed: 0.2766s/iter; left time: 8007.9382s
	iters: 300, epoch: 22 | loss: 0.0513923
	speed: 0.2549s/iter; left time: 7355.4473s
Epoch: 22 cost time: 95.89872288703918
Epoch: 22, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.523 Vali Acc: 0.651 Test Loss: 1.523 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0935549
	speed: 0.8065s/iter; left time: 23132.0000s
	iters: 200, epoch: 23 | loss: 0.0240231
	speed: 0.2633s/iter; left time: 7527.0910s
	iters: 300, epoch: 23 | loss: 0.1221932
	speed: 0.2694s/iter; left time: 7674.0388s
Epoch: 23 cost time: 97.96455240249634
Epoch: 23, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.501 Vali Acc: 0.656 Test Loss: 1.501 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1445055
	speed: 0.8132s/iter; left time: 23024.5357s
	iters: 200, epoch: 24 | loss: 0.0936762
	speed: 0.2592s/iter; left time: 7311.6695s
	iters: 300, epoch: 24 | loss: 0.0136732
	speed: 0.2512s/iter; left time: 7061.3272s
Epoch: 24 cost time: 94.15835070610046
Epoch: 24, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.664 Vali Acc: 0.643 Test Loss: 1.664 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0054246
	speed: 0.8461s/iter; left time: 23644.7049s
	iters: 200, epoch: 25 | loss: 0.0064914
	speed: 0.2615s/iter; left time: 7281.1081s
	iters: 300, epoch: 25 | loss: 0.0050719
	speed: 0.2740s/iter; left time: 7600.7453s
Epoch: 25 cost time: 100.00621008872986
Epoch: 25, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.825 Vali Acc: 0.665 Test Loss: 1.825 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6733825198637912
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7406940
	speed: 0.2763s/iter; left time: 10167.8746s
	iters: 200, epoch: 1 | loss: 0.5753044
	speed: 0.2848s/iter; left time: 10453.6543s
	iters: 300, epoch: 1 | loss: 0.6170337
	speed: 0.2772s/iter; left time: 10146.8677s
Epoch: 1 cost time: 102.21332812309265
Epoch: 1, Steps: 369 | Train Loss: 0.784 Vali Loss: 1.388 Vali Acc: 0.612 Test Loss: 1.388 Test Acc: 0.612
Validation loss decreased (inf --> -0.611791).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1640368
	speed: 0.8145s/iter; left time: 29672.4699s
	iters: 200, epoch: 2 | loss: 1.3183174
	speed: 0.2499s/iter; left time: 9078.6957s
	iters: 300, epoch: 2 | loss: 0.8673731
	speed: 0.2680s/iter; left time: 9711.6793s
Epoch: 2 cost time: 98.44538021087646
Epoch: 2, Steps: 369 | Train Loss: 0.962 Vali Loss: 2.176 Vali Acc: 0.605 Test Loss: 2.176 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4837823
	speed: 0.8381s/iter; left time: 30224.9463s
	iters: 200, epoch: 3 | loss: 1.0867406
	speed: 0.2716s/iter; left time: 9767.7922s
	iters: 300, epoch: 3 | loss: 1.3287463
	speed: 0.2492s/iter; left time: 8937.0591s
Epoch: 3 cost time: 95.76409101486206
Epoch: 3, Steps: 369 | Train Loss: 1.137 Vali Loss: 2.325 Vali Acc: 0.571 Test Loss: 2.325 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1668286
	speed: 0.7965s/iter; left time: 28430.9051s
	iters: 200, epoch: 4 | loss: 2.5741444
	speed: 0.2625s/iter; left time: 9343.7088s
	iters: 300, epoch: 4 | loss: 0.5765001
	speed: 0.2555s/iter; left time: 9070.0623s
Epoch: 4 cost time: 96.11766386032104
Epoch: 4, Steps: 369 | Train Loss: 1.261 Vali Loss: 1.912 Vali Acc: 0.579 Test Loss: 1.912 Test Acc: 0.579
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5565984
	speed: 0.8063s/iter; left time: 28481.1296s
	iters: 200, epoch: 5 | loss: 0.7752175
	speed: 0.2608s/iter; left time: 9186.6434s
	iters: 300, epoch: 5 | loss: 0.4295338
	speed: 0.2630s/iter; left time: 9236.4441s
Epoch: 5 cost time: 95.629221200943
Epoch: 5, Steps: 369 | Train Loss: 0.873 Vali Loss: 0.956 Vali Acc: 0.577 Test Loss: 0.956 Test Acc: 0.577
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9754282
	speed: 0.7981s/iter; left time: 27897.7843s
	iters: 200, epoch: 6 | loss: 1.0863670
	speed: 0.2589s/iter; left time: 9022.7240s
	iters: 300, epoch: 6 | loss: 0.7861216
	speed: 0.2511s/iter; left time: 8725.8666s
Epoch: 6 cost time: 93.58646726608276
Epoch: 6, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
Validation loss decreased (-0.611791 --> -0.625416).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6007960
	speed: 0.7991s/iter; left time: 27637.2346s
	iters: 200, epoch: 7 | loss: 0.5734208
	speed: 0.2484s/iter; left time: 8567.4401s
	iters: 300, epoch: 7 | loss: 0.6905735
	speed: 0.2524s/iter; left time: 8680.7074s
Epoch: 7 cost time: 93.81355667114258
Epoch: 7, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.761 Vali Acc: 0.630 Test Loss: 0.761 Test Acc: 0.630
Validation loss decreased (-0.625416 --> -0.630242).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5918028
	speed: 0.7749s/iter; left time: 26516.0848s
	iters: 200, epoch: 8 | loss: 0.5819149
	speed: 0.2451s/iter; left time: 8360.9699s
	iters: 300, epoch: 8 | loss: 0.4352130
	speed: 0.2462s/iter; left time: 8375.7521s
Epoch: 8 cost time: 90.63410806655884
Epoch: 8, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.731 Vali Acc: 0.646 Test Loss: 0.731 Test Acc: 0.646
Validation loss decreased (-0.630242 --> -0.645566).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8066941
	speed: 0.7836s/iter; left time: 26524.3419s
	iters: 200, epoch: 9 | loss: 0.6081732
	speed: 0.2542s/iter; left time: 8577.7834s
	iters: 300, epoch: 9 | loss: 0.4116882
	speed: 0.2310s/iter; left time: 7772.0843s
Epoch: 9 cost time: 91.11395502090454
Epoch: 9, Steps: 369 | Train Loss: 0.574 Vali Loss: 0.826 Vali Acc: 0.637 Test Loss: 0.826 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6924271
	speed: 0.8075s/iter; left time: 27034.1685s
	iters: 200, epoch: 10 | loss: 0.5998436
	speed: 0.2521s/iter; left time: 8415.2164s
	iters: 300, epoch: 10 | loss: 0.7932659
	speed: 0.2497s/iter; left time: 8310.4559s
Epoch: 10 cost time: 94.33947110176086
Epoch: 10, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.828 Vali Acc: 0.645 Test Loss: 0.828 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3735350
	speed: 0.8092s/iter; left time: 26792.3307s
	iters: 200, epoch: 11 | loss: 0.3643521
	speed: 0.2588s/iter; left time: 8542.4075s
	iters: 300, epoch: 11 | loss: 0.6506233
	speed: 0.2492s/iter; left time: 8200.8399s
Epoch: 11 cost time: 94.72661185264587
Epoch: 11, Steps: 369 | Train Loss: 0.538 Vali Loss: 0.783 Vali Acc: 0.650 Test Loss: 0.783 Test Acc: 0.650
Validation loss decreased (-0.645566 --> -0.649822).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7143404
	speed: 0.8017s/iter; left time: 26248.5981s
	iters: 200, epoch: 12 | loss: 0.7064580
	speed: 0.2543s/iter; left time: 8300.3256s
	iters: 300, epoch: 12 | loss: 0.4964159
	speed: 0.2530s/iter; left time: 8233.4065s
Epoch: 12 cost time: 94.70305800437927
Epoch: 12, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.709 Vali Acc: 0.660 Test Loss: 0.709 Test Acc: 0.660
Validation loss decreased (-0.649822 --> -0.659755).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8155918
	speed: 0.8201s/iter; left time: 26548.2095s
	iters: 200, epoch: 13 | loss: 0.5179599
	speed: 0.2418s/iter; left time: 7803.0168s
	iters: 300, epoch: 13 | loss: 0.6385550
	speed: 0.2561s/iter; left time: 8239.4468s
Epoch: 13 cost time: 93.2459568977356
Epoch: 13, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.736 Vali Acc: 0.645 Test Loss: 0.736 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4235589
	speed: 0.8002s/iter; left time: 25610.8775s
	iters: 200, epoch: 14 | loss: 0.5149077
	speed: 0.2603s/iter; left time: 8305.6465s
	iters: 300, epoch: 14 | loss: 0.4822625
	speed: 0.2521s/iter; left time: 8019.0472s
Epoch: 14 cost time: 95.64065265655518
Epoch: 14, Steps: 369 | Train Loss: 0.507 Vali Loss: 0.745 Vali Acc: 0.671 Test Loss: 0.745 Test Acc: 0.671
Validation loss decreased (-0.659755 --> -0.671389).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4404151
	speed: 0.8076s/iter; left time: 25548.5095s
	iters: 200, epoch: 15 | loss: 0.8785481
	speed: 0.2581s/iter; left time: 8140.2058s
	iters: 300, epoch: 15 | loss: 0.5220152
	speed: 0.2539s/iter; left time: 7981.6786s
Epoch: 15 cost time: 93.51846265792847
Epoch: 15, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.788 Vali Acc: 0.673 Test Loss: 0.788 Test Acc: 0.673
Validation loss decreased (-0.671389 --> -0.673091).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3828689
	speed: 0.8051s/iter; left time: 25173.8131s
	iters: 200, epoch: 16 | loss: 0.8153571
	speed: 0.2468s/iter; left time: 7691.3936s
	iters: 300, epoch: 16 | loss: 0.3754326
	speed: 0.2523s/iter; left time: 7839.2871s
Epoch: 16 cost time: 91.55513095855713
Epoch: 16, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.858 Vali Acc: 0.673 Test Loss: 0.858 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3306255
	speed: 0.7858s/iter; left time: 24280.2648s
	iters: 200, epoch: 17 | loss: 0.4962717
	speed: 0.2382s/iter; left time: 7336.2068s
	iters: 300, epoch: 17 | loss: 0.5879950
	speed: 0.2578s/iter; left time: 7914.4447s
Epoch: 17 cost time: 92.09989023208618
Epoch: 17, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.820 Vali Acc: 0.673 Test Loss: 0.820 Test Acc: 0.673
Validation loss decreased (-0.673091 --> -0.673374).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4376120
	speed: 0.7837s/iter; left time: 23925.4437s
	iters: 200, epoch: 18 | loss: 0.3714694
	speed: 0.2508s/iter; left time: 7631.3648s
	iters: 300, epoch: 18 | loss: 0.2520999
	speed: 0.2567s/iter; left time: 7784.1378s
Epoch: 18 cost time: 92.87600111961365
Epoch: 18, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.743 Vali Acc: 0.668 Test Loss: 0.743 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2501967
	speed: 0.7932s/iter; left time: 23920.7350s
	iters: 200, epoch: 19 | loss: 0.3176215
	speed: 0.2555s/iter; left time: 7678.8058s
	iters: 300, epoch: 19 | loss: 0.5811248
	speed: 0.2595s/iter; left time: 7774.8631s
Epoch: 19 cost time: 94.2860963344574
Epoch: 19, Steps: 369 | Train Loss: 0.421 Vali Loss: 0.809 Vali Acc: 0.690 Test Loss: 0.809 Test Acc: 0.690
Validation loss decreased (-0.673374 --> -0.690401).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5101722
	speed: 0.7992s/iter; left time: 23807.2068s
	iters: 200, epoch: 20 | loss: 0.2799983
	speed: 0.2485s/iter; left time: 7376.6365s
	iters: 300, epoch: 20 | loss: 0.3829054
	speed: 0.2525s/iter; left time: 7471.8235s
Epoch: 20 cost time: 94.30989623069763
Epoch: 20, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.795 Vali Acc: 0.659 Test Loss: 0.795 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2350508
	speed: 0.7952s/iter; left time: 23396.3677s
	iters: 200, epoch: 21 | loss: 0.4561230
	speed: 0.2453s/iter; left time: 7192.7177s
	iters: 300, epoch: 21 | loss: 0.6010023
	speed: 0.2598s/iter; left time: 7592.5126s
Epoch: 21 cost time: 93.30993366241455
Epoch: 21, Steps: 369 | Train Loss: 0.396 Vali Loss: 0.789 Vali Acc: 0.677 Test Loss: 0.789 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1492408
	speed: 0.8100s/iter; left time: 23531.9400s
	iters: 200, epoch: 22 | loss: 0.3881381
	speed: 0.2607s/iter; left time: 7549.1608s
	iters: 300, epoch: 22 | loss: 0.4665181
	speed: 0.2496s/iter; left time: 7201.2960s
Epoch: 22 cost time: 94.04568982124329
Epoch: 22, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.832 Vali Acc: 0.688 Test Loss: 0.832 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.4120241
	speed: 0.8085s/iter; left time: 23190.8352s
	iters: 200, epoch: 23 | loss: 0.4929150
	speed: 0.2761s/iter; left time: 7891.6042s
	iters: 300, epoch: 23 | loss: 0.3118369
	speed: 0.2787s/iter; left time: 7938.1611s
Epoch: 23 cost time: 100.582679271698
Epoch: 23, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.853 Vali Acc: 0.679 Test Loss: 0.853 Test Acc: 0.679
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4383372
	speed: 0.8312s/iter; left time: 23534.6090s
	iters: 200, epoch: 24 | loss: 0.1927721
	speed: 0.2802s/iter; left time: 7906.5242s
	iters: 300, epoch: 24 | loss: 0.2768711
	speed: 0.2701s/iter; left time: 7592.7904s
Epoch: 24 cost time: 100.46156859397888
Epoch: 24, Steps: 369 | Train Loss: 0.328 Vali Loss: 0.936 Vali Acc: 0.664 Test Loss: 0.936 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0443804
	speed: 0.8356s/iter; left time: 23351.5324s
	iters: 200, epoch: 25 | loss: 0.4949325
	speed: 0.2729s/iter; left time: 7597.6851s
	iters: 300, epoch: 25 | loss: 0.5108415
	speed: 0.2677s/iter; left time: 7427.5644s
Epoch: 25 cost time: 99.82197952270508
Epoch: 25, Steps: 369 | Train Loss: 0.305 Vali Loss: 1.001 Vali Acc: 0.670 Test Loss: 1.001 Test Acc: 0.670
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1195167
	speed: 0.8239s/iter; left time: 22718.6585s
	iters: 200, epoch: 26 | loss: 0.0482024
	speed: 0.2590s/iter; left time: 7116.0934s
	iters: 300, epoch: 26 | loss: 0.2483567
	speed: 0.2495s/iter; left time: 6829.5592s
Epoch: 26 cost time: 94.38204145431519
Epoch: 26, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.962 Vali Acc: 0.677 Test Loss: 0.962 Test Acc: 0.677
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1820195
	speed: 0.8136s/iter; left time: 22135.5556s
	iters: 200, epoch: 27 | loss: 0.3615043
	speed: 0.2707s/iter; left time: 7338.4237s
	iters: 300, epoch: 27 | loss: 0.2408958
	speed: 0.2601s/iter; left time: 7025.4491s
Epoch: 27 cost time: 97.05730557441711
Epoch: 27, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.095 Vali Acc: 0.669 Test Loss: 1.095 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1052166
	speed: 0.8115s/iter; left time: 21779.3427s
	iters: 200, epoch: 28 | loss: 0.0412959
	speed: 0.2561s/iter; left time: 6846.5781s
	iters: 300, epoch: 28 | loss: 0.1330631
	speed: 0.2572s/iter; left time: 6851.0263s
Epoch: 28 cost time: 95.20884132385254
Epoch: 28, Steps: 369 | Train Loss: 0.214 Vali Loss: 1.371 Vali Acc: 0.660 Test Loss: 1.371 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0504639
	speed: 0.8126s/iter; left time: 21508.3540s
	iters: 200, epoch: 29 | loss: 0.3789693
	speed: 0.2710s/iter; left time: 7147.2821s
	iters: 300, epoch: 29 | loss: 0.2968935
	speed: 0.2690s/iter; left time: 7067.1506s
Epoch: 29 cost time: 98.82644629478455
Epoch: 29, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.397 Vali Acc: 0.661 Test Loss: 1.397 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6904086265607264
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6634938
	speed: 0.2737s/iter; left time: 10072.9428s
	iters: 200, epoch: 1 | loss: 0.9821395
	speed: 0.2449s/iter; left time: 8987.3521s
	iters: 300, epoch: 1 | loss: 0.5514601
	speed: 0.2468s/iter; left time: 9033.5261s
Epoch: 1 cost time: 94.17801356315613
Epoch: 1, Steps: 369 | Train Loss: 0.818 Vali Loss: 1.151 Vali Acc: 0.623 Test Loss: 1.151 Test Acc: 0.623
Validation loss decreased (inf --> -0.623144).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1852510
	speed: 0.7845s/iter; left time: 28581.5602s
	iters: 200, epoch: 2 | loss: 0.6906023
	speed: 0.2561s/iter; left time: 9305.9947s
	iters: 300, epoch: 2 | loss: 0.6800256
	speed: 0.2483s/iter; left time: 8995.2283s
Epoch: 2 cost time: 91.96394157409668
Epoch: 2, Steps: 369 | Train Loss: 0.963 Vali Loss: 1.842 Vali Acc: 0.628 Test Loss: 1.842 Test Acc: 0.628
Validation loss decreased (-0.623144 --> -0.628245).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0178087
	speed: 0.7846s/iter; left time: 28294.8142s
	iters: 200, epoch: 3 | loss: 0.8591776
	speed: 0.2527s/iter; left time: 9086.4709s
	iters: 300, epoch: 3 | loss: 1.8640012
	speed: 0.2571s/iter; left time: 9219.8916s
Epoch: 3 cost time: 93.92341256141663
Epoch: 3, Steps: 369 | Train Loss: 1.167 Vali Loss: 2.108 Vali Acc: 0.588 Test Loss: 2.108 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1183333
	speed: 0.7946s/iter; left time: 28364.0901s
	iters: 200, epoch: 4 | loss: 0.4961425
	speed: 0.2514s/iter; left time: 8950.0519s
	iters: 300, epoch: 4 | loss: 0.5789992
	speed: 0.2444s/iter; left time: 8674.7264s
Epoch: 4 cost time: 91.89329838752747
Epoch: 4, Steps: 369 | Train Loss: 0.999 Vali Loss: 0.700 Vali Acc: 0.652 Test Loss: 0.700 Test Acc: 0.652
Validation loss decreased (-0.628245 --> -0.652093).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7793957
	speed: 0.8276s/iter; left time: 29234.1596s
	iters: 200, epoch: 5 | loss: 0.7659522
	speed: 0.2627s/iter; left time: 9252.7240s
	iters: 300, epoch: 5 | loss: 0.4664473
	speed: 0.2541s/iter; left time: 8923.7611s
Epoch: 5 cost time: 95.85240435600281
Epoch: 5, Steps: 369 | Train Loss: 0.751 Vali Loss: 0.641 Vali Acc: 0.661 Test Loss: 0.641 Test Acc: 0.661
Validation loss decreased (-0.652093 --> -0.660890).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4803816
	speed: 0.8104s/iter; left time: 28329.2485s
	iters: 200, epoch: 6 | loss: 0.7210838
	speed: 0.2642s/iter; left time: 9208.5128s
	iters: 300, epoch: 6 | loss: 0.8330508
	speed: 0.2527s/iter; left time: 8781.5070s
Epoch: 6 cost time: 94.53503894805908
Epoch: 6, Steps: 369 | Train Loss: 0.746 Vali Loss: 0.801 Vali Acc: 0.579 Test Loss: 0.801 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5530400
	speed: 0.8028s/iter; left time: 27767.0196s
	iters: 200, epoch: 7 | loss: 0.4152920
	speed: 0.2541s/iter; left time: 8763.6376s
	iters: 300, epoch: 7 | loss: 0.4979801
	speed: 0.2486s/iter; left time: 8550.1225s
Epoch: 7 cost time: 94.17494249343872
Epoch: 7, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.745 Vali Acc: 0.644 Test Loss: 0.745 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7606609
	speed: 0.7981s/iter; left time: 27310.3942s
	iters: 200, epoch: 8 | loss: 0.6089007
	speed: 0.2495s/iter; left time: 8510.8116s
	iters: 300, epoch: 8 | loss: 0.9590279
	speed: 0.2548s/iter; left time: 8668.9770s
Epoch: 8 cost time: 94.2142596244812
Epoch: 8, Steps: 369 | Train Loss: 0.635 Vali Loss: 0.759 Vali Acc: 0.665 Test Loss: 0.759 Test Acc: 0.665
Validation loss decreased (-0.660890 --> -0.665429).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5721772
	speed: 0.8019s/iter; left time: 27145.0884s
	iters: 200, epoch: 9 | loss: 0.5811635
	speed: 0.2544s/iter; left time: 8587.1208s
	iters: 300, epoch: 9 | loss: 0.4580342
	speed: 0.2612s/iter; left time: 8788.9734s
Epoch: 9 cost time: 94.61621618270874
Epoch: 9, Steps: 369 | Train Loss: 0.579 Vali Loss: 0.729 Vali Acc: 0.659 Test Loss: 0.729 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5344351
	speed: 0.8036s/iter; left time: 26905.2233s
	iters: 200, epoch: 10 | loss: 0.4823120
	speed: 0.2517s/iter; left time: 8400.6588s
	iters: 300, epoch: 10 | loss: 0.7779819
	speed: 0.2460s/iter; left time: 8186.4044s
Epoch: 10 cost time: 93.0417845249176
Epoch: 10, Steps: 369 | Train Loss: 0.540 Vali Loss: 0.684 Vali Acc: 0.650 Test Loss: 0.684 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3651989
	speed: 0.7929s/iter; left time: 26254.7029s
	iters: 200, epoch: 11 | loss: 0.4903811
	speed: 0.2465s/iter; left time: 8137.9055s
	iters: 300, epoch: 11 | loss: 0.4449786
	speed: 0.2423s/iter; left time: 7974.3077s
Epoch: 11 cost time: 91.37621331214905
Epoch: 11, Steps: 369 | Train Loss: 0.522 Vali Loss: 0.801 Vali Acc: 0.672 Test Loss: 0.801 Test Acc: 0.672
Validation loss decreased (-0.665429 --> -0.671672).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5360836
	speed: 0.7879s/iter; left time: 25796.8435s
	iters: 200, epoch: 12 | loss: 0.7056527
	speed: 0.2483s/iter; left time: 8104.5471s
	iters: 300, epoch: 12 | loss: 0.5332265
	speed: 0.2437s/iter; left time: 7930.2954s
Epoch: 12 cost time: 91.72416806221008
Epoch: 12, Steps: 369 | Train Loss: 0.518 Vali Loss: 0.728 Vali Acc: 0.674 Test Loss: 0.728 Test Acc: 0.674
Validation loss decreased (-0.671672 --> -0.673943).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6191025
	speed: 0.8184s/iter; left time: 26495.5909s
	iters: 200, epoch: 13 | loss: 0.5348498
	speed: 0.2592s/iter; left time: 8364.2875s
	iters: 300, epoch: 13 | loss: 0.6633052
	speed: 0.2438s/iter; left time: 7844.1290s
Epoch: 13 cost time: 95.10287356376648
Epoch: 13, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.752 Vali Acc: 0.684 Test Loss: 0.752 Test Acc: 0.684
Validation loss decreased (-0.673943 --> -0.684158).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6177745
	speed: 0.8534s/iter; left time: 27312.3420s
	iters: 200, epoch: 14 | loss: 0.3160683
	speed: 0.2742s/iter; left time: 8746.5846s
	iters: 300, epoch: 14 | loss: 0.6660422
	speed: 0.2651s/iter; left time: 8431.2900s
Epoch: 14 cost time: 101.01593351364136
Epoch: 14, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.707 Vali Acc: 0.680 Test Loss: 0.707 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7329978
	speed: 0.8642s/iter; left time: 27339.8084s
	iters: 200, epoch: 15 | loss: 0.8148797
	speed: 0.2783s/iter; left time: 8777.0144s
	iters: 300, epoch: 15 | loss: 0.6072028
	speed: 0.2595s/iter; left time: 8157.3137s
Epoch: 15 cost time: 99.2977180480957
Epoch: 15, Steps: 369 | Train Loss: 0.471 Vali Loss: 0.746 Vali Acc: 0.691 Test Loss: 0.746 Test Acc: 0.691
Validation loss decreased (-0.684158 --> -0.690969).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3162040
	speed: 0.8577s/iter; left time: 26816.0266s
	iters: 200, epoch: 16 | loss: 0.5878757
	speed: 0.2761s/iter; left time: 8605.1612s
	iters: 300, epoch: 16 | loss: 0.3466729
	speed: 0.2823s/iter; left time: 8770.5757s
Epoch: 16 cost time: 100.05621767044067
Epoch: 16, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.783 Vali Acc: 0.686 Test Loss: 0.783 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3938801
	speed: 0.8274s/iter; left time: 25564.5571s
	iters: 200, epoch: 17 | loss: 0.5703369
	speed: 0.2674s/iter; left time: 8235.5839s
	iters: 300, epoch: 17 | loss: 0.5651698
	speed: 0.2714s/iter; left time: 8329.6461s
Epoch: 17 cost time: 99.93615198135376
Epoch: 17, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.743 Vali Acc: 0.683 Test Loss: 0.743 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.6709123
	speed: 0.8666s/iter; left time: 26455.2471s
	iters: 200, epoch: 18 | loss: 0.4115163
	speed: 0.2768s/iter; left time: 8423.7038s
	iters: 300, epoch: 18 | loss: 0.2716904
	speed: 0.2857s/iter; left time: 8666.2243s
Epoch: 18 cost time: 103.98820781707764
Epoch: 18, Steps: 369 | Train Loss: 0.428 Vali Loss: 0.772 Vali Acc: 0.678 Test Loss: 0.772 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1421324
	speed: 0.8822s/iter; left time: 26606.2482s
	iters: 200, epoch: 19 | loss: 0.2384667
	speed: 0.2641s/iter; left time: 7937.9979s
	iters: 300, epoch: 19 | loss: 0.5342147
	speed: 0.2649s/iter; left time: 7937.4582s
Epoch: 19 cost time: 100.02406287193298
Epoch: 19, Steps: 369 | Train Loss: 0.410 Vali Loss: 0.873 Vali Acc: 0.680 Test Loss: 0.873 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5127043
	speed: 0.8293s/iter; left time: 24703.6482s
	iters: 200, epoch: 20 | loss: 0.2401325
	speed: 0.2628s/iter; left time: 7802.6058s
	iters: 300, epoch: 20 | loss: 0.4831850
	speed: 0.2803s/iter; left time: 8293.2545s
Epoch: 20 cost time: 100.84159708023071
Epoch: 20, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.794 Vali Acc: 0.687 Test Loss: 0.794 Test Acc: 0.687
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1385051
	speed: 0.8600s/iter; left time: 25302.5507s
	iters: 200, epoch: 21 | loss: 0.5171403
	speed: 0.2679s/iter; left time: 7855.6695s
	iters: 300, epoch: 21 | loss: 0.4999705
	speed: 0.2753s/iter; left time: 8044.9881s
Epoch: 21 cost time: 102.12584829330444
Epoch: 21, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.791 Vali Acc: 0.680 Test Loss: 0.791 Test Acc: 0.680
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1508176
	speed: 0.8518s/iter; left time: 24746.7091s
	iters: 200, epoch: 22 | loss: 0.2992840
	speed: 0.2729s/iter; left time: 7900.5821s
	iters: 300, epoch: 22 | loss: 0.3224124
	speed: 0.2718s/iter; left time: 7842.2406s
Epoch: 22 cost time: 102.77642130851746
Epoch: 22, Steps: 369 | Train Loss: 0.362 Vali Loss: 0.938 Vali Acc: 0.689 Test Loss: 0.938 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.4622093
	speed: 0.8439s/iter; left time: 24205.9525s
	iters: 200, epoch: 23 | loss: 0.1177791
	speed: 0.2667s/iter; left time: 7622.6437s
	iters: 300, epoch: 23 | loss: 0.3617545
	speed: 0.2661s/iter; left time: 7578.4024s
Epoch: 23 cost time: 97.65312266349792
Epoch: 23, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.803 Vali Acc: 0.680 Test Loss: 0.803 Test Acc: 0.680
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.7439543
	speed: 0.8134s/iter; left time: 23030.7803s
	iters: 200, epoch: 24 | loss: 0.2369466
	speed: 0.2614s/iter; left time: 7376.2869s
	iters: 300, epoch: 24 | loss: 0.2022841
	speed: 0.2396s/iter; left time: 6736.4127s
Epoch: 24 cost time: 93.46180081367493
Epoch: 24, Steps: 369 | Train Loss: 0.313 Vali Loss: 0.879 Vali Acc: 0.679 Test Loss: 0.879 Test Acc: 0.679
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0825374
	speed: 0.8051s/iter; left time: 22499.6441s
	iters: 200, epoch: 25 | loss: 0.2890946
	speed: 0.2574s/iter; left time: 7167.6453s
	iters: 300, epoch: 25 | loss: 0.4832358
	speed: 0.2451s/iter; left time: 6799.0997s
Epoch: 25 cost time: 94.87267065048218
Epoch: 25, Steps: 369 | Train Loss: 0.282 Vali Loss: 0.971 Vali Acc: 0.686 Test Loss: 0.971 Test Acc: 0.686
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6909761634506243
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8643438
	speed: 0.2867s/iter; left time: 10549.4485s
	iters: 200, epoch: 1 | loss: 0.6320652
	speed: 0.2628s/iter; left time: 9646.2732s
	iters: 300, epoch: 1 | loss: 0.4102080
	speed: 0.2873s/iter; left time: 10516.7408s
Epoch: 1 cost time: 103.15526747703552
Epoch: 1, Steps: 369 | Train Loss: 0.797 Vali Loss: 1.195 Vali Acc: 0.620 Test Loss: 1.195 Test Acc: 0.620
Validation loss decreased (inf --> -0.620306).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1082337
	speed: 0.8409s/iter; left time: 30636.9559s
	iters: 200, epoch: 2 | loss: 0.4793007
	speed: 0.2630s/iter; left time: 9555.1986s
	iters: 300, epoch: 2 | loss: 1.3358412
	speed: 0.2705s/iter; left time: 9800.0387s
Epoch: 2 cost time: 98.49971866607666
Epoch: 2, Steps: 369 | Train Loss: 0.966 Vali Loss: 1.913 Vali Acc: 0.620 Test Loss: 1.913 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0813447
	speed: 0.8246s/iter; left time: 29739.1997s
	iters: 200, epoch: 3 | loss: 0.3539701
	speed: 0.2659s/iter; left time: 9561.4970s
	iters: 300, epoch: 3 | loss: 1.3935739
	speed: 0.2704s/iter; left time: 9697.5737s
Epoch: 3 cost time: 98.7588882446289
Epoch: 3, Steps: 369 | Train Loss: 1.127 Vali Loss: 2.552 Vali Acc: 0.557 Test Loss: 2.552 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.5247511
	speed: 0.8348s/iter; left time: 29796.6129s
	iters: 200, epoch: 4 | loss: 0.0808547
	speed: 0.2815s/iter; left time: 10018.7696s
	iters: 300, epoch: 4 | loss: 0.6101223
	speed: 0.2719s/iter; left time: 9651.4004s
Epoch: 4 cost time: 101.73180913925171
Epoch: 4, Steps: 369 | Train Loss: 1.388 Vali Loss: 3.283 Vali Acc: 0.568 Test Loss: 3.283 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6589407
	speed: 0.8359s/iter; left time: 29529.0825s
	iters: 200, epoch: 5 | loss: 1.6852436
	speed: 0.2511s/iter; left time: 8843.6722s
	iters: 300, epoch: 5 | loss: 0.8893877
	speed: 0.2821s/iter; left time: 9909.1810s
Epoch: 5 cost time: 97.2630181312561
Epoch: 5, Steps: 369 | Train Loss: 1.108 Vali Loss: 0.848 Vali Acc: 0.607 Test Loss: 0.848 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7068051
	speed: 0.8246s/iter; left time: 28825.1552s
	iters: 200, epoch: 6 | loss: 0.5804437
	speed: 0.2521s/iter; left time: 8787.0437s
	iters: 300, epoch: 6 | loss: 0.8114528
	speed: 0.2557s/iter; left time: 8885.9249s
Epoch: 6 cost time: 96.49357008934021
Epoch: 6, Steps: 369 | Train Loss: 0.794 Vali Loss: 0.811 Vali Acc: 0.629 Test Loss: 0.811 Test Acc: 0.629
Validation loss decreased (-0.620306 --> -0.628539).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6982952
	speed: 0.8461s/iter; left time: 29263.8211s
	iters: 200, epoch: 7 | loss: 0.8494045
	speed: 0.2527s/iter; left time: 8714.8529s
	iters: 300, epoch: 7 | loss: 0.6335687
	speed: 0.2723s/iter; left time: 9362.6420s
Epoch: 7 cost time: 99.15989589691162
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.816 Vali Acc: 0.615 Test Loss: 0.816 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6526647
	speed: 0.8311s/iter; left time: 28437.7201s
	iters: 200, epoch: 8 | loss: 0.3221148
	speed: 0.2666s/iter; left time: 9095.7050s
	iters: 300, epoch: 8 | loss: 0.7783887
	speed: 0.2658s/iter; left time: 9042.4441s
Epoch: 8 cost time: 97.17562532424927
Epoch: 8, Steps: 369 | Train Loss: 0.625 Vali Loss: 0.701 Vali Acc: 0.646 Test Loss: 0.701 Test Acc: 0.646
Validation loss decreased (-0.628539 --> -0.645850).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6872057
	speed: 0.8161s/iter; left time: 27622.5334s
	iters: 200, epoch: 9 | loss: 0.6687574
	speed: 0.2734s/iter; left time: 9226.8192s
	iters: 300, epoch: 9 | loss: 0.7109864
	speed: 0.2676s/iter; left time: 9003.7545s
Epoch: 9 cost time: 98.4126946926117
Epoch: 9, Steps: 369 | Train Loss: 0.597 Vali Loss: 0.752 Vali Acc: 0.648 Test Loss: 0.752 Test Acc: 0.648
Validation loss decreased (-0.645850 --> -0.647836).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6264247
	speed: 0.8398s/iter; left time: 28117.8413s
	iters: 200, epoch: 10 | loss: 0.5174617
	speed: 0.2647s/iter; left time: 8835.9357s
	iters: 300, epoch: 10 | loss: 0.8477979
	speed: 0.2683s/iter; left time: 8927.8199s
Epoch: 10 cost time: 99.72042226791382
Epoch: 10, Steps: 369 | Train Loss: 0.573 Vali Loss: 0.674 Vali Acc: 0.657 Test Loss: 0.674 Test Acc: 0.657
Validation loss decreased (-0.647836 --> -0.657485).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4980686
	speed: 0.8405s/iter; left time: 27828.5528s
	iters: 200, epoch: 11 | loss: 0.8033093
	speed: 0.2646s/iter; left time: 8735.6163s
	iters: 300, epoch: 11 | loss: 0.5146881
	speed: 0.2620s/iter; left time: 8622.8751s
Epoch: 11 cost time: 98.81064867973328
Epoch: 11, Steps: 369 | Train Loss: 0.563 Vali Loss: 0.733 Vali Acc: 0.666 Test Loss: 0.733 Test Acc: 0.666
Validation loss decreased (-0.657485 --> -0.665713).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6661577
	speed: 0.8065s/iter; left time: 26406.4181s
	iters: 200, epoch: 12 | loss: 0.6331491
	speed: 0.2627s/iter; left time: 8574.2604s
	iters: 300, epoch: 12 | loss: 0.8998516
	speed: 0.2565s/iter; left time: 8348.4155s
Epoch: 12 cost time: 97.07335758209229
Epoch: 12, Steps: 369 | Train Loss: 0.590 Vali Loss: 0.667 Vali Acc: 0.633 Test Loss: 0.667 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9627733
	speed: 0.8183s/iter; left time: 26490.4461s
	iters: 200, epoch: 13 | loss: 0.8643908
	speed: 0.2645s/iter; left time: 8535.4075s
	iters: 300, epoch: 13 | loss: 0.5389823
	speed: 0.2604s/iter; left time: 8378.8076s
Epoch: 13 cost time: 97.39258122444153
Epoch: 13, Steps: 369 | Train Loss: 0.564 Vali Loss: 0.814 Vali Acc: 0.665 Test Loss: 0.814 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6299788
	speed: 0.8233s/iter; left time: 26347.9250s
	iters: 200, epoch: 14 | loss: 0.4013695
	speed: 0.2660s/iter; left time: 8485.3501s
	iters: 300, epoch: 14 | loss: 0.7937536
	speed: 0.2636s/iter; left time: 8382.8046s
Epoch: 14 cost time: 98.88576745986938
Epoch: 14, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.795 Vali Acc: 0.660 Test Loss: 0.795 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4908006
	speed: 0.8289s/iter; left time: 26221.8943s
	iters: 200, epoch: 15 | loss: 0.6243160
	speed: 0.2612s/iter; left time: 8236.6597s
	iters: 300, epoch: 15 | loss: 1.0399282
	speed: 0.2771s/iter; left time: 8711.9669s
Epoch: 15 cost time: 99.22654175758362
Epoch: 15, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.768 Vali Acc: 0.688 Test Loss: 0.768 Test Acc: 0.688
Validation loss decreased (-0.665713 --> -0.687563).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3908628
	speed: 0.8523s/iter; left time: 26647.7112s
	iters: 200, epoch: 16 | loss: 0.7560942
	speed: 0.2561s/iter; left time: 7981.4347s
	iters: 300, epoch: 16 | loss: 0.5451296
	speed: 0.2745s/iter; left time: 8528.5931s
Epoch: 16 cost time: 99.27801275253296
Epoch: 16, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.757 Vali Acc: 0.689 Test Loss: 0.757 Test Acc: 0.689
Validation loss decreased (-0.687563 --> -0.689266).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5325481
	speed: 0.8446s/iter; left time: 26094.2786s
	iters: 200, epoch: 17 | loss: 0.3885762
	speed: 0.2702s/iter; left time: 8321.1164s
	iters: 300, epoch: 17 | loss: 0.3604294
	speed: 0.2825s/iter; left time: 8672.9342s
Epoch: 17 cost time: 101.10057830810547
Epoch: 17, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.678 Vali Acc: 0.685 Test Loss: 0.678 Test Acc: 0.685
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5155408
	speed: 0.8254s/iter; left time: 25197.0012s
	iters: 200, epoch: 18 | loss: 0.3466887
	speed: 0.2752s/iter; left time: 8372.6500s
	iters: 300, epoch: 18 | loss: 0.2973760
	speed: 0.2568s/iter; left time: 7789.2810s
Epoch: 18 cost time: 98.14814567565918
Epoch: 18, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.690 Vali Acc: 0.680 Test Loss: 0.690 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2453528
	speed: 0.8221s/iter; left time: 24793.4140s
	iters: 200, epoch: 19 | loss: 0.3600219
	speed: 0.2640s/iter; left time: 7936.9536s
	iters: 300, epoch: 19 | loss: 0.5375642
	speed: 0.2633s/iter; left time: 7887.6490s
Epoch: 19 cost time: 99.72122311592102
Epoch: 19, Steps: 369 | Train Loss: 0.444 Vali Loss: 0.809 Vali Acc: 0.697 Test Loss: 0.809 Test Acc: 0.697
Validation loss decreased (-0.689266 --> -0.696927).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6209661
	speed: 0.8210s/iter; left time: 24457.8195s
	iters: 200, epoch: 20 | loss: 0.3486964
	speed: 0.2632s/iter; left time: 7815.6545s
	iters: 300, epoch: 20 | loss: 0.3551491
	speed: 0.2666s/iter; left time: 7889.3671s
Epoch: 20 cost time: 96.88719439506531
Epoch: 20, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.725 Vali Acc: 0.676 Test Loss: 0.725 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2363106
	speed: 0.8114s/iter; left time: 23872.6063s
	iters: 200, epoch: 21 | loss: 0.4813220
	speed: 0.2794s/iter; left time: 8192.9069s
	iters: 300, epoch: 21 | loss: 0.5088840
	speed: 0.2566s/iter; left time: 7496.9096s
Epoch: 21 cost time: 97.17784452438354
Epoch: 21, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.670 Vali Acc: 0.692 Test Loss: 0.670 Test Acc: 0.692
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1733297
	speed: 0.8179s/iter; left time: 23760.4182s
	iters: 200, epoch: 22 | loss: 0.4113262
	speed: 0.2560s/iter; left time: 7412.0931s
	iters: 300, epoch: 22 | loss: 0.3206387
	speed: 0.2796s/iter; left time: 8067.0121s
Epoch: 22 cost time: 100.05105590820312
Epoch: 22, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.764 Vali Acc: 0.678 Test Loss: 0.764 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3080366
	speed: 0.8200s/iter; left time: 23518.8232s
	iters: 200, epoch: 23 | loss: 0.1140783
	speed: 0.2461s/iter; left time: 7032.9817s
	iters: 300, epoch: 23 | loss: 0.6040679
	speed: 0.2549s/iter; left time: 7261.1465s
Epoch: 23 cost time: 92.73435759544373
Epoch: 23, Steps: 369 | Train Loss: 0.397 Vali Loss: 0.733 Vali Acc: 0.680 Test Loss: 0.733 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.6243057
	speed: 0.8064s/iter; left time: 22831.6778s
	iters: 200, epoch: 24 | loss: 0.3679725
	speed: 0.2445s/iter; left time: 6897.6344s
	iters: 300, epoch: 24 | loss: 0.3732102
	speed: 0.2659s/iter; left time: 7475.1491s
Epoch: 24 cost time: 96.52658176422119
Epoch: 24, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.797 Vali Acc: 0.680 Test Loss: 0.797 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0783117
	speed: 0.8309s/iter; left time: 23219.2417s
	iters: 200, epoch: 25 | loss: 0.6280656
	speed: 0.2571s/iter; left time: 7158.0146s
	iters: 300, epoch: 25 | loss: 0.5575817
	speed: 0.2666s/iter; left time: 7396.6376s
Epoch: 25 cost time: 96.20950388908386
Epoch: 25, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.830 Vali Acc: 0.694 Test Loss: 0.830 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1163778
	speed: 0.8165s/iter; left time: 22515.2896s
	iters: 200, epoch: 26 | loss: 0.1325040
	speed: 0.2621s/iter; left time: 7202.6657s
	iters: 300, epoch: 26 | loss: 0.2318786
	speed: 0.2632s/iter; left time: 7204.8018s
Epoch: 26 cost time: 97.93262767791748
Epoch: 26, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.786 Vali Acc: 0.695 Test Loss: 0.786 Test Acc: 0.695
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.2342423
	speed: 0.8497s/iter; left time: 23118.3221s
	iters: 200, epoch: 27 | loss: 0.5067388
	speed: 0.2641s/iter; left time: 7159.7913s
	iters: 300, epoch: 27 | loss: 0.0839049
	speed: 0.2637s/iter; left time: 7122.1541s
Epoch: 27 cost time: 99.80677223205566
Epoch: 27, Steps: 369 | Train Loss: 0.322 Vali Loss: 0.822 Vali Acc: 0.681 Test Loss: 0.822 Test Acc: 0.681
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.4005687
	speed: 0.8402s/iter; left time: 22548.3868s
	iters: 200, epoch: 28 | loss: 0.1131632
	speed: 0.2699s/iter; left time: 7215.4599s
	iters: 300, epoch: 28 | loss: 0.4764203
	speed: 0.2756s/iter; left time: 7341.4899s
Epoch: 28 cost time: 99.2816891670227
Epoch: 28, Steps: 369 | Train Loss: 0.301 Vali Loss: 0.975 Vali Acc: 0.660 Test Loss: 0.975 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.4346924
	speed: 0.8126s/iter; left time: 21508.2664s
	iters: 200, epoch: 29 | loss: 0.2814803
	speed: 0.2642s/iter; left time: 6967.0254s
	iters: 300, epoch: 29 | loss: 0.2749352
	speed: 0.2678s/iter; left time: 7034.1843s
Epoch: 29 cost time: 99.54714488983154
Epoch: 29, Steps: 369 | Train Loss: 0.276 Vali Loss: 0.828 Vali Acc: 0.678 Test Loss: 0.828 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6969353007945517
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8442064
	speed: 0.2920s/iter; left time: 10745.2910s
	iters: 200, epoch: 1 | loss: 0.5605652
	speed: 0.2675s/iter; left time: 9816.3948s
	iters: 300, epoch: 1 | loss: 0.5559283
	speed: 0.2686s/iter; left time: 9832.7362s
Epoch: 1 cost time: 101.44342637062073
Epoch: 1, Steps: 369 | Train Loss: 0.807 Vali Loss: 1.137 Vali Acc: 0.625 Test Loss: 1.137 Test Acc: 0.625
Validation loss decreased (inf --> -0.625414).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6026773
	speed: 0.8462s/iter; left time: 30827.5857s
	iters: 200, epoch: 2 | loss: 0.7075671
	speed: 0.2563s/iter; left time: 9311.2981s
	iters: 300, epoch: 2 | loss: 1.0080677
	speed: 0.2661s/iter; left time: 9643.0481s
Epoch: 2 cost time: 96.55261731147766
Epoch: 2, Steps: 369 | Train Loss: 0.945 Vali Loss: 1.513 Vali Acc: 0.636 Test Loss: 1.513 Test Acc: 0.636
Validation loss decreased (-0.625414 --> -0.636194).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3946922
	speed: 0.8005s/iter; left time: 28868.1359s
	iters: 200, epoch: 3 | loss: 0.6228718
	speed: 0.2697s/iter; left time: 9697.6562s
	iters: 300, epoch: 3 | loss: 1.1035439
	speed: 0.2648s/iter; left time: 9497.6315s
Epoch: 3 cost time: 97.03980684280396
Epoch: 3, Steps: 369 | Train Loss: 0.842 Vali Loss: 1.192 Vali Acc: 0.596 Test Loss: 1.192 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4376308
	speed: 0.8104s/iter; left time: 28926.0026s
	iters: 200, epoch: 4 | loss: 0.4246292
	speed: 0.2447s/iter; left time: 8708.1972s
	iters: 300, epoch: 4 | loss: 0.7912133
	speed: 0.2453s/iter; left time: 8706.1657s
Epoch: 4 cost time: 91.9361503124237
Epoch: 4, Steps: 369 | Train Loss: 0.781 Vali Loss: 0.864 Vali Acc: 0.608 Test Loss: 0.864 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5996330
	speed: 0.7926s/iter; left time: 27999.9977s
	iters: 200, epoch: 5 | loss: 1.1868850
	speed: 0.2540s/iter; left time: 8946.2371s
	iters: 300, epoch: 5 | loss: 1.1873720
	speed: 0.2611s/iter; left time: 9170.6017s
Epoch: 5 cost time: 94.22428774833679
Epoch: 5, Steps: 369 | Train Loss: 0.756 Vali Loss: 0.684 Vali Acc: 0.662 Test Loss: 0.684 Test Acc: 0.662
Validation loss decreased (-0.636194 --> -0.662309).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5081747
	speed: 0.8053s/iter; left time: 28149.4135s
	iters: 200, epoch: 6 | loss: 0.5472814
	speed: 0.2454s/iter; left time: 8555.1299s
	iters: 300, epoch: 6 | loss: 0.7175407
	speed: 0.2470s/iter; left time: 8583.3981s
Epoch: 6 cost time: 91.26989221572876
Epoch: 6, Steps: 369 | Train Loss: 0.673 Vali Loss: 0.667 Vali Acc: 0.652 Test Loss: 0.667 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2849915
	speed: 0.7833s/iter; left time: 27090.3886s
	iters: 200, epoch: 7 | loss: 0.6928028
	speed: 0.2447s/iter; left time: 8437.6848s
	iters: 300, epoch: 7 | loss: 0.5427498
	speed: 0.2423s/iter; left time: 8331.1876s
Epoch: 7 cost time: 90.57015657424927
Epoch: 7, Steps: 369 | Train Loss: 0.607 Vali Loss: 0.678 Vali Acc: 0.643 Test Loss: 0.678 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4775565
	speed: 0.7945s/iter; left time: 27186.5030s
	iters: 200, epoch: 8 | loss: 0.5862035
	speed: 0.2495s/iter; left time: 8513.5898s
	iters: 300, epoch: 8 | loss: 0.6003858
	speed: 0.2564s/iter; left time: 8723.2733s
Epoch: 8 cost time: 94.1940016746521
Epoch: 8, Steps: 369 | Train Loss: 0.578 Vali Loss: 0.671 Vali Acc: 0.670 Test Loss: 0.671 Test Acc: 0.670
Validation loss decreased (-0.662309 --> -0.669687).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7256488
	speed: 0.8275s/iter; left time: 28008.6531s
	iters: 200, epoch: 9 | loss: 0.8463401
	speed: 0.2534s/iter; left time: 8552.1742s
	iters: 300, epoch: 9 | loss: 0.6574845
	speed: 0.2546s/iter; left time: 8565.7632s
Epoch: 9 cost time: 93.62714719772339
Epoch: 9, Steps: 369 | Train Loss: 0.576 Vali Loss: 0.795 Vali Acc: 0.617 Test Loss: 0.795 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4962497
	speed: 0.7884s/iter; left time: 26396.0688s
	iters: 200, epoch: 10 | loss: 0.4059711
	speed: 0.2474s/iter; left time: 8257.5858s
	iters: 300, epoch: 10 | loss: 0.6798130
	speed: 0.2459s/iter; left time: 8184.1844s
Epoch: 10 cost time: 91.34795475006104
Epoch: 10, Steps: 369 | Train Loss: 0.546 Vali Loss: 0.663 Vali Acc: 0.652 Test Loss: 0.663 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4657135
	speed: 0.7803s/iter; left time: 25834.9670s
	iters: 200, epoch: 11 | loss: 0.2497387
	speed: 0.2399s/iter; left time: 7920.3032s
	iters: 300, epoch: 11 | loss: 0.2351841
	speed: 0.2580s/iter; left time: 8489.8765s
Epoch: 11 cost time: 93.25477838516235
Epoch: 11, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.712 Vali Acc: 0.670 Test Loss: 0.712 Test Acc: 0.670
Validation loss decreased (-0.669687 --> -0.669970).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9380154
	speed: 0.8611s/iter; left time: 28193.3637s
	iters: 200, epoch: 12 | loss: 0.6205614
	speed: 0.2640s/iter; left time: 8616.3944s
	iters: 300, epoch: 12 | loss: 0.4420398
	speed: 0.2609s/iter; left time: 8489.8626s
Epoch: 12 cost time: 98.07224893569946
Epoch: 12, Steps: 369 | Train Loss: 0.509 Vali Loss: 0.672 Vali Acc: 0.654 Test Loss: 0.672 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6361858
	speed: 0.8422s/iter; left time: 27265.9223s
	iters: 200, epoch: 13 | loss: 0.5558068
	speed: 0.2614s/iter; left time: 8436.2509s
	iters: 300, epoch: 13 | loss: 0.4904778
	speed: 0.2712s/iter; left time: 8725.7825s
Epoch: 13 cost time: 99.23079061508179
Epoch: 13, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.708 Vali Acc: 0.677 Test Loss: 0.708 Test Acc: 0.677
Validation loss decreased (-0.669970 --> -0.677348).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4155549
	speed: 0.8199s/iter; left time: 26240.6101s
	iters: 200, epoch: 14 | loss: 0.3031582
	speed: 0.2660s/iter; left time: 8485.2983s
	iters: 300, epoch: 14 | loss: 0.6784267
	speed: 0.2446s/iter; left time: 7779.6055s
Epoch: 14 cost time: 94.90211486816406
Epoch: 14, Steps: 369 | Train Loss: 0.468 Vali Loss: 0.665 Vali Acc: 0.689 Test Loss: 0.665 Test Acc: 0.689
Validation loss decreased (-0.677348 --> -0.688983).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6303890
	speed: 0.7917s/iter; left time: 25043.9963s
	iters: 200, epoch: 15 | loss: 0.7940454
	speed: 0.2620s/iter; left time: 8262.4224s
	iters: 300, epoch: 15 | loss: 0.5599301
	speed: 0.2709s/iter; left time: 8515.6470s
Epoch: 15 cost time: 97.32589221000671
Epoch: 15, Steps: 369 | Train Loss: 0.459 Vali Loss: 0.719 Vali Acc: 0.687 Test Loss: 0.719 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4904194
	speed: 0.8211s/iter; left time: 25673.0258s
	iters: 200, epoch: 16 | loss: 0.9459700
	speed: 0.2685s/iter; left time: 8368.5025s
	iters: 300, epoch: 16 | loss: 0.3461488
	speed: 0.2526s/iter; left time: 7847.2245s
Epoch: 16 cost time: 97.25226855278015
Epoch: 16, Steps: 369 | Train Loss: 0.457 Vali Loss: 0.670 Vali Acc: 0.691 Test Loss: 0.670 Test Acc: 0.691
Validation loss decreased (-0.688983 --> -0.691253).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3764333
	speed: 0.8208s/iter; left time: 25361.6606s
	iters: 200, epoch: 17 | loss: 0.5629801
	speed: 0.2592s/iter; left time: 7984.1014s
	iters: 300, epoch: 17 | loss: 0.3427877
	speed: 0.2519s/iter; left time: 7731.9858s
Epoch: 17 cost time: 94.82214379310608
Epoch: 17, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.688 Vali Acc: 0.678 Test Loss: 0.688 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5984876
	speed: 0.8154s/iter; left time: 24891.0492s
	iters: 200, epoch: 18 | loss: 0.4199207
	speed: 0.2617s/iter; left time: 7961.5774s
	iters: 300, epoch: 18 | loss: 0.1947124
	speed: 0.2568s/iter; left time: 7787.6387s
Epoch: 18 cost time: 96.39071297645569
Epoch: 18, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.665 Vali Acc: 0.683 Test Loss: 0.665 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3466866
	speed: 0.8693s/iter; left time: 26218.0056s
	iters: 200, epoch: 19 | loss: 0.3492575
	speed: 0.2564s/iter; left time: 7708.0803s
	iters: 300, epoch: 19 | loss: 0.4368056
	speed: 0.2556s/iter; left time: 7657.4465s
Epoch: 19 cost time: 98.16884350776672
Epoch: 19, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.833 Vali Acc: 0.677 Test Loss: 0.833 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.6005833
	speed: 0.8143s/iter; left time: 24257.8559s
	iters: 200, epoch: 20 | loss: 0.3067854
	speed: 0.2615s/iter; left time: 7765.2578s
	iters: 300, epoch: 20 | loss: 0.5802242
	speed: 0.2524s/iter; left time: 7468.9619s
Epoch: 20 cost time: 95.18096423149109
Epoch: 20, Steps: 369 | Train Loss: 0.404 Vali Loss: 0.686 Vali Acc: 0.694 Test Loss: 0.686 Test Acc: 0.694
Validation loss decreased (-0.691253 --> -0.694091).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2200948
	speed: 0.7953s/iter; left time: 23397.5983s
	iters: 200, epoch: 21 | loss: 0.2944274
	speed: 0.2476s/iter; left time: 7260.8115s
	iters: 300, epoch: 21 | loss: 0.3986077
	speed: 0.2628s/iter; left time: 7680.0394s
Epoch: 21 cost time: 95.24443888664246
Epoch: 21, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.751 Vali Acc: 0.680 Test Loss: 0.751 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1766286
	speed: 0.8238s/iter; left time: 23934.2743s
	iters: 200, epoch: 22 | loss: 0.2714905
	speed: 0.2599s/iter; left time: 7525.6753s
	iters: 300, epoch: 22 | loss: 0.2209716
	speed: 0.2575s/iter; left time: 7428.6377s
Epoch: 22 cost time: 96.44132924079895
Epoch: 22, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.760 Vali Acc: 0.668 Test Loss: 0.760 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.3977148
	speed: 0.8287s/iter; left time: 23768.6484s
	iters: 200, epoch: 23 | loss: 0.3513396
	speed: 0.2699s/iter; left time: 7713.8153s
	iters: 300, epoch: 23 | loss: 0.5302144
	speed: 0.2505s/iter; left time: 7135.8106s
Epoch: 23 cost time: 96.15747404098511
Epoch: 23, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.825 Vali Acc: 0.655 Test Loss: 0.825 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2542584
	speed: 0.8158s/iter; left time: 23099.8827s
	iters: 200, epoch: 24 | loss: 0.2201003
	speed: 0.2525s/iter; left time: 7122.8224s
	iters: 300, epoch: 24 | loss: 0.1860969
	speed: 0.2570s/iter; left time: 7226.1341s
Epoch: 24 cost time: 95.41485691070557
Epoch: 24, Steps: 369 | Train Loss: 0.308 Vali Loss: 0.758 Vali Acc: 0.677 Test Loss: 0.758 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0261056
	speed: 0.8281s/iter; left time: 23140.8649s
	iters: 200, epoch: 25 | loss: 0.4409799
	speed: 0.2654s/iter; left time: 7389.1480s
	iters: 300, epoch: 25 | loss: 0.4410044
	speed: 0.2731s/iter; left time: 7577.9607s
Epoch: 25 cost time: 99.77557349205017
Epoch: 25, Steps: 369 | Train Loss: 0.267 Vali Loss: 0.991 Vali Acc: 0.681 Test Loss: 0.991 Test Acc: 0.681
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0881582
	speed: 0.8366s/iter; left time: 23069.5455s
	iters: 200, epoch: 26 | loss: 0.0803770
	speed: 0.2633s/iter; left time: 7234.4166s
	iters: 300, epoch: 26 | loss: 0.3722813
	speed: 0.2682s/iter; left time: 7343.4798s
Epoch: 26 cost time: 97.87298488616943
Epoch: 26, Steps: 369 | Train Loss: 0.249 Vali Loss: 0.844 Vali Acc: 0.677 Test Loss: 0.844 Test Acc: 0.677
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.2498378
	speed: 0.8320s/iter; left time: 22636.4471s
	iters: 200, epoch: 27 | loss: 0.3010471
	speed: 0.2555s/iter; left time: 6924.5426s
	iters: 300, epoch: 27 | loss: 0.1031658
	speed: 0.2641s/iter; left time: 7131.7914s
Epoch: 27 cost time: 96.16293835639954
Epoch: 27, Steps: 369 | Train Loss: 0.202 Vali Loss: 0.930 Vali Acc: 0.666 Test Loss: 0.930 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0156191
	speed: 0.8536s/iter; left time: 22909.1691s
	iters: 200, epoch: 28 | loss: 0.1518599
	speed: 0.2654s/iter; left time: 7095.8629s
	iters: 300, epoch: 28 | loss: 0.3953749
	speed: 0.2593s/iter; left time: 6906.5179s
Epoch: 28 cost time: 97.47738647460938
Epoch: 28, Steps: 369 | Train Loss: 0.182 Vali Loss: 1.118 Vali Acc: 0.659 Test Loss: 1.118 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.1683934
	speed: 0.8368s/iter; left time: 22149.4321s
	iters: 200, epoch: 29 | loss: 0.3138065
	speed: 0.2645s/iter; left time: 6973.9085s
	iters: 300, epoch: 29 | loss: 0.0577449
	speed: 0.2613s/iter; left time: 6862.9184s
Epoch: 29 cost time: 98.3354082107544
Epoch: 29, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.066 Vali Acc: 0.655 Test Loss: 1.066 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0394778
	speed: 0.8203s/iter; left time: 21410.5263s
	iters: 200, epoch: 30 | loss: 0.1250122
	speed: 0.2694s/iter; left time: 7004.1664s
	iters: 300, epoch: 30 | loss: 0.0537238
	speed: 0.2579s/iter; left time: 6679.8123s
Epoch: 30 cost time: 96.39311861991882
Epoch: 30, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.347 Vali Acc: 0.661 Test Loss: 1.347 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6940976163450624
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7149525
	speed: 0.2890s/iter; left time: 10637.1260s
	iters: 200, epoch: 1 | loss: 0.6126187
	speed: 0.2524s/iter; left time: 9263.9466s
	iters: 300, epoch: 1 | loss: 0.4294501
	speed: 0.2585s/iter; left time: 9459.6804s
Epoch: 1 cost time: 97.63842439651489
Epoch: 1, Steps: 369 | Train Loss: 0.818 Vali Loss: 1.153 Vali Acc: 0.623 Test Loss: 1.153 Test Acc: 0.623
Validation loss decreased (inf --> -0.622576).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0910232
	speed: 0.8195s/iter; left time: 29856.6570s
	iters: 200, epoch: 2 | loss: 0.5390394
	speed: 0.2685s/iter; left time: 9754.2189s
	iters: 300, epoch: 2 | loss: 1.1759279
	speed: 0.2703s/iter; left time: 9793.8411s
Epoch: 2 cost time: 98.58734250068665
Epoch: 2, Steps: 369 | Train Loss: 0.962 Vali Loss: 1.588 Vali Acc: 0.632 Test Loss: 1.588 Test Acc: 0.632
Validation loss decreased (-0.622576 --> -0.631936).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2669931
	speed: 0.8260s/iter; left time: 29787.0160s
	iters: 200, epoch: 3 | loss: 0.4240765
	speed: 0.2497s/iter; left time: 8981.6156s
	iters: 300, epoch: 3 | loss: 0.7134843
	speed: 0.2529s/iter; left time: 9070.6505s
Epoch: 3 cost time: 94.38762712478638
Epoch: 3, Steps: 369 | Train Loss: 0.762 Vali Loss: 2.352 Vali Acc: 0.505 Test Loss: 2.352 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8622225
	speed: 0.8097s/iter; left time: 28900.0811s
	iters: 200, epoch: 4 | loss: 0.6402237
	speed: 0.2508s/iter; left time: 8926.4658s
	iters: 300, epoch: 4 | loss: 0.3714364
	speed: 0.2511s/iter; left time: 8913.6682s
Epoch: 4 cost time: 93.93826842308044
Epoch: 4, Steps: 369 | Train Loss: 0.737 Vali Loss: 1.010 Vali Acc: 0.654 Test Loss: 1.010 Test Acc: 0.654
Validation loss decreased (-0.631936 --> -0.654360).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2371259
	speed: 0.8416s/iter; left time: 29728.6454s
	iters: 200, epoch: 5 | loss: 1.0374002
	speed: 0.2672s/iter; left time: 9412.3170s
	iters: 300, epoch: 5 | loss: 0.6594020
	speed: 0.2677s/iter; left time: 9401.2989s
Epoch: 5 cost time: 99.85658931732178
Epoch: 5, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.720 Vali Acc: 0.627 Test Loss: 0.720 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5727541
	speed: 0.8123s/iter; left time: 28396.0538s
	iters: 200, epoch: 6 | loss: 0.6209492
	speed: 0.2661s/iter; left time: 9275.4811s
	iters: 300, epoch: 6 | loss: 0.4997109
	speed: 0.2573s/iter; left time: 8943.3952s
Epoch: 6 cost time: 94.73931455612183
Epoch: 6, Steps: 369 | Train Loss: 0.603 Vali Loss: 0.906 Vali Acc: 0.607 Test Loss: 0.906 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9035260
	speed: 0.7816s/iter; left time: 27032.5793s
	iters: 200, epoch: 7 | loss: 0.6790225
	speed: 0.2536s/iter; left time: 8744.3911s
	iters: 300, epoch: 7 | loss: 0.5246211
	speed: 0.2636s/iter; left time: 9065.7275s
Epoch: 7 cost time: 95.76679134368896
Epoch: 7, Steps: 369 | Train Loss: 0.785 Vali Loss: 0.761 Vali Acc: 0.526 Test Loss: 0.761 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8039883
	speed: 0.8392s/iter; left time: 28716.7577s
	iters: 200, epoch: 8 | loss: 0.8014336
	speed: 0.2482s/iter; left time: 8468.8019s
	iters: 300, epoch: 8 | loss: 0.6413954
	speed: 0.2529s/iter; left time: 8603.8446s
Epoch: 8 cost time: 93.69210433959961
Epoch: 8, Steps: 369 | Train Loss: 0.758 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7677898
	speed: 0.8056s/iter; left time: 27268.9093s
	iters: 200, epoch: 9 | loss: 0.8732014
	speed: 0.2456s/iter; left time: 8288.3730s
	iters: 300, epoch: 9 | loss: 0.6404992
	speed: 0.2472s/iter; left time: 8319.2000s
Epoch: 9 cost time: 92.97667002677917
Epoch: 9, Steps: 369 | Train Loss: 0.735 Vali Loss: 0.794 Vali Acc: 0.561 Test Loss: 0.794 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7201663
	speed: 0.8039s/iter; left time: 26913.8366s
	iters: 200, epoch: 10 | loss: 0.4940882
	speed: 0.2718s/iter; left time: 9071.8741s
	iters: 300, epoch: 10 | loss: 0.4671630
	speed: 0.2496s/iter; left time: 8307.3040s
Epoch: 10 cost time: 97.247394323349
Epoch: 10, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.694 Vali Acc: 0.645 Test Loss: 0.694 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.5853254
	speed: 0.8285s/iter; left time: 27433.0402s
	iters: 200, epoch: 11 | loss: 0.4882078
	speed: 0.2774s/iter; left time: 9158.2912s
	iters: 300, epoch: 11 | loss: 0.4180281
	speed: 0.2601s/iter; left time: 8560.8784s
Epoch: 11 cost time: 97.78792834281921
Epoch: 11, Steps: 369 | Train Loss: 0.631 Vali Loss: 0.731 Vali Acc: 0.629 Test Loss: 0.731 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7023412
	speed: 0.7845s/iter; left time: 25686.9290s
	iters: 200, epoch: 12 | loss: 0.8689792
	speed: 0.2526s/iter; left time: 8244.3101s
	iters: 300, epoch: 12 | loss: 0.6201008
	speed: 0.2486s/iter; left time: 8089.1230s
Epoch: 12 cost time: 94.90066695213318
Epoch: 12, Steps: 369 | Train Loss: 0.607 Vali Loss: 0.816 Vali Acc: 0.632 Test Loss: 0.816 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.7123059
	speed: 0.8365s/iter; left time: 27079.5732s
	iters: 200, epoch: 13 | loss: 0.5370489
	speed: 0.2681s/iter; left time: 8653.8131s
	iters: 300, epoch: 13 | loss: 0.6651903
	speed: 0.2806s/iter; left time: 9028.5283s
Epoch: 13 cost time: 102.12353253364563
Epoch: 13, Steps: 369 | Train Loss: 0.577 Vali Loss: 0.718 Vali Acc: 0.656 Test Loss: 0.718 Test Acc: 0.656
Validation loss decreased (-0.654360 --> -0.655498).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5337770
	speed: 0.8822s/iter; left time: 28234.2519s
	iters: 200, epoch: 14 | loss: 0.4981229
	speed: 0.2620s/iter; left time: 8357.8608s
	iters: 300, epoch: 14 | loss: 0.5759898
	speed: 0.2598s/iter; left time: 8264.0105s
Epoch: 14 cost time: 98.8165693283081
Epoch: 14, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.672 Vali Acc: 0.661 Test Loss: 0.672 Test Acc: 0.661
Validation loss decreased (-0.655498 --> -0.661174).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9738628
	speed: 0.8348s/iter; left time: 26408.8528s
	iters: 200, epoch: 15 | loss: 1.0560601
	speed: 0.2589s/iter; left time: 8164.3373s
	iters: 300, epoch: 15 | loss: 0.7955081
	speed: 0.2706s/iter; left time: 8505.9258s
Epoch: 15 cost time: 97.75133085250854
Epoch: 15, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.707 Vali Acc: 0.699 Test Loss: 0.707 Test Acc: 0.699
Validation loss decreased (-0.661174 --> -0.698915).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3286476
	speed: 0.8454s/iter; left time: 26433.1766s
	iters: 200, epoch: 16 | loss: 0.7685605
	speed: 0.2739s/iter; left time: 8536.9938s
	iters: 300, epoch: 16 | loss: 0.4310430
	speed: 0.2653s/iter; left time: 8243.0406s
Epoch: 16 cost time: 100.06490707397461
Epoch: 16, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.667 Vali Acc: 0.660 Test Loss: 0.667 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3210138
	speed: 0.8325s/iter; left time: 25720.2697s
	iters: 200, epoch: 17 | loss: 0.7567101
	speed: 0.2559s/iter; left time: 7879.6885s
	iters: 300, epoch: 17 | loss: 0.4249081
	speed: 0.2510s/iter; left time: 7704.8860s
Epoch: 17 cost time: 95.03459000587463
Epoch: 17, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.711 Vali Acc: 0.683 Test Loss: 0.711 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5591931
	speed: 0.8188s/iter; left time: 24995.6512s
	iters: 200, epoch: 18 | loss: 0.5002949
	speed: 0.2763s/iter; left time: 8407.1100s
	iters: 300, epoch: 18 | loss: 0.3970300
	speed: 0.2721s/iter; left time: 8250.8994s
Epoch: 18 cost time: 101.04203462600708
Epoch: 18, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.683 Vali Acc: 0.665 Test Loss: 0.683 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3848045
	speed: 0.8501s/iter; left time: 25638.1893s
	iters: 200, epoch: 19 | loss: 0.2810264
	speed: 0.2669s/iter; left time: 8022.9785s
	iters: 300, epoch: 19 | loss: 0.5532904
	speed: 0.2603s/iter; left time: 7798.6213s
Epoch: 19 cost time: 98.26275825500488
Epoch: 19, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.763 Vali Acc: 0.680 Test Loss: 0.763 Test Acc: 0.680
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6737733
	speed: 0.7993s/iter; left time: 23811.8176s
	iters: 200, epoch: 20 | loss: 0.3844481
	speed: 0.2521s/iter; left time: 7485.3017s
	iters: 300, epoch: 20 | loss: 0.5219430
	speed: 0.2504s/iter; left time: 7410.7553s
Epoch: 20 cost time: 92.92163825035095
Epoch: 20, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.700 Vali Acc: 0.673 Test Loss: 0.700 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3783169
	speed: 0.7896s/iter; left time: 23232.0489s
	iters: 200, epoch: 21 | loss: 0.7198243
	speed: 0.2422s/iter; left time: 7102.0907s
	iters: 300, epoch: 21 | loss: 0.4923538
	speed: 0.2558s/iter; left time: 7476.1678s
Epoch: 21 cost time: 92.43508505821228
Epoch: 21, Steps: 369 | Train Loss: 0.410 Vali Loss: 0.691 Vali Acc: 0.671 Test Loss: 0.691 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2874982
	speed: 0.7848s/iter; left time: 22800.1339s
	iters: 200, epoch: 22 | loss: 0.2936417
	speed: 0.2547s/iter; left time: 7372.9101s
	iters: 300, epoch: 22 | loss: 0.3080507
	speed: 0.2539s/iter; left time: 7325.8327s
Epoch: 22 cost time: 93.67907905578613
Epoch: 22, Steps: 369 | Train Loss: 0.400 Vali Loss: 0.692 Vali Acc: 0.690 Test Loss: 0.692 Test Acc: 0.690
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3614329
	speed: 0.8105s/iter; left time: 23248.0800s
	iters: 200, epoch: 23 | loss: 0.2726887
	speed: 0.2568s/iter; left time: 7341.4623s
	iters: 300, epoch: 23 | loss: 0.4919734
	speed: 0.2426s/iter; left time: 6909.9181s
Epoch: 23 cost time: 92.68904042243958
Epoch: 23, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.706 Vali Acc: 0.677 Test Loss: 0.706 Test Acc: 0.677
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.4429297
	speed: 0.7833s/iter; left time: 22179.4727s
	iters: 200, epoch: 24 | loss: 0.3995688
	speed: 0.2502s/iter; left time: 7060.4718s
	iters: 300, epoch: 24 | loss: 0.2006683
	speed: 0.2463s/iter; left time: 6923.8196s
Epoch: 24 cost time: 93.53700399398804
Epoch: 24, Steps: 369 | Train Loss: 0.366 Vali Loss: 0.805 Vali Acc: 0.673 Test Loss: 0.805 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1115059
	speed: 0.8187s/iter; left time: 22879.7723s
	iters: 200, epoch: 25 | loss: 0.6779647
	speed: 0.2555s/iter; left time: 7114.3780s
	iters: 300, epoch: 25 | loss: 0.4732229
	speed: 0.2484s/iter; left time: 6891.8742s
Epoch: 25 cost time: 94.1896653175354
Epoch: 25, Steps: 369 | Train Loss: 0.341 Vali Loss: 0.759 Vali Acc: 0.688 Test Loss: 0.759 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6989216799091941
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6931480
	speed: 0.2626s/iter; left time: 9664.9714s
	iters: 200, epoch: 1 | loss: 0.6931234
	speed: 0.2409s/iter; left time: 8839.7932s
	iters: 300, epoch: 1 | loss: 0.6931163
	speed: 0.2443s/iter; left time: 8941.4273s
Epoch: 1 cost time: 91.23125123977661
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6931524
	speed: 0.8260s/iter; left time: 30093.9410s
	iters: 200, epoch: 2 | loss: 0.6935141
	speed: 0.2595s/iter; left time: 9428.4898s
	iters: 300, epoch: 2 | loss: 0.6932352
	speed: 0.2619s/iter; left time: 9490.4409s
Epoch: 2 cost time: 97.56987738609314
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6947981
	speed: 0.8215s/iter; left time: 29624.5311s
	iters: 200, epoch: 3 | loss: 0.6928714
	speed: 0.2459s/iter; left time: 8842.1202s
	iters: 300, epoch: 3 | loss: 0.6935783
	speed: 0.2487s/iter; left time: 8918.4035s
Epoch: 3 cost time: 92.422123670578
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6936954
	speed: 0.7967s/iter; left time: 28437.0151s
	iters: 200, epoch: 4 | loss: 0.6942569
	speed: 0.2402s/iter; left time: 8549.8018s
	iters: 300, epoch: 4 | loss: 0.6940165
	speed: 0.2547s/iter; left time: 9040.4575s
Epoch: 4 cost time: 92.76510071754456
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6942365
	speed: 0.8013s/iter; left time: 28307.5827s
	iters: 200, epoch: 5 | loss: 0.6931162
	speed: 0.2495s/iter; left time: 8789.4300s
	iters: 300, epoch: 5 | loss: 0.6929017
	speed: 0.2479s/iter; left time: 8706.6389s
Epoch: 5 cost time: 92.20602416992188
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6935686
	speed: 0.7957s/iter; left time: 27814.3798s
	iters: 200, epoch: 6 | loss: 0.6958070
	speed: 0.2470s/iter; left time: 8608.6881s
	iters: 300, epoch: 6 | loss: 0.6928779
	speed: 0.2487s/iter; left time: 8645.3045s
Epoch: 6 cost time: 92.93139481544495
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6920223
	speed: 0.7844s/iter; left time: 27130.6422s
	iters: 200, epoch: 7 | loss: 0.6934283
	speed: 0.2596s/iter; left time: 8953.5585s
	iters: 300, epoch: 7 | loss: 0.6933713
	speed: 0.2505s/iter; left time: 8614.2741s
Epoch: 7 cost time: 93.02234148979187
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6925219
	speed: 0.8123s/iter; left time: 27794.4348s
	iters: 200, epoch: 8 | loss: 0.6945094
	speed: 0.2576s/iter; left time: 8789.2003s
	iters: 300, epoch: 8 | loss: 0.6931539
	speed: 0.2505s/iter; left time: 8522.7034s
Epoch: 8 cost time: 93.99339389801025
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6931666
	speed: 0.8022s/iter; left time: 27154.7813s
	iters: 200, epoch: 9 | loss: 0.6931639
	speed: 0.2629s/iter; left time: 8873.0671s
	iters: 300, epoch: 9 | loss: 0.6938727
	speed: 0.2574s/iter; left time: 8661.1297s
Epoch: 9 cost time: 96.01570248603821
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6931550
	speed: 0.8205s/iter; left time: 27471.9042s
	iters: 200, epoch: 10 | loss: 0.6924872
	speed: 0.2585s/iter; left time: 8628.1769s
	iters: 300, epoch: 10 | loss: 0.6935753
	speed: 0.2544s/iter; left time: 8465.8223s
Epoch: 10 cost time: 94.65541386604309
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6932383
	speed: 0.8252s/iter; left time: 27324.2947s
	iters: 200, epoch: 11 | loss: 0.6924406
	speed: 0.2541s/iter; left time: 8387.0627s
	iters: 300, epoch: 11 | loss: 0.6922588
	speed: 0.2578s/iter; left time: 8483.9737s
Epoch: 11 cost time: 96.3085265159607
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6935214
	speed: 0.8170s/iter; left time: 26748.8160s
	iters: 200, epoch: 12 | loss: 0.6955255
	speed: 0.2465s/iter; left time: 8046.8955s
	iters: 300, epoch: 12 | loss: 0.6932682
	speed: 0.2646s/iter; left time: 8609.1305s
Epoch: 12 cost time: 94.22576785087585
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6914779
	speed: 0.7846s/iter; left time: 25401.0347s
	iters: 200, epoch: 13 | loss: 0.6940821
	speed: 0.2406s/iter; left time: 7764.7030s
	iters: 300, epoch: 13 | loss: 0.6917024
	speed: 0.2496s/iter; left time: 8031.7799s
Epoch: 13 cost time: 91.23981881141663
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6930583
	speed: 0.7830s/iter; left time: 25057.7938s
	iters: 200, epoch: 14 | loss: 0.6911843
	speed: 0.2419s/iter; left time: 7719.0823s
	iters: 300, epoch: 14 | loss: 0.6905773
	speed: 0.2557s/iter; left time: 8133.4310s
Epoch: 14 cost time: 92.03429532051086
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6931363
	speed: 0.7925s/iter; left time: 25069.2705s
	iters: 200, epoch: 15 | loss: 0.6912844
	speed: 0.2506s/iter; left time: 7901.1849s
	iters: 300, epoch: 15 | loss: 0.6929371
	speed: 0.2551s/iter; left time: 8019.6176s
Epoch: 15 cost time: 92.7008466720581
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6919571
	speed: 0.8154s/iter; left time: 25493.5069s
	iters: 200, epoch: 16 | loss: 0.6951409
	speed: 0.2542s/iter; left time: 7922.2837s
	iters: 300, epoch: 16 | loss: 0.6932818
	speed: 0.2537s/iter; left time: 7881.4668s
Epoch: 16 cost time: 95.00720381736755
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6924363
	speed: 0.8010s/iter; left time: 24749.1018s
	iters: 200, epoch: 17 | loss: 0.6953338
	speed: 0.2406s/iter; left time: 7409.0965s
	iters: 300, epoch: 17 | loss: 0.6936936
	speed: 0.2447s/iter; left time: 7512.5597s
Epoch: 17 cost time: 91.61901259422302
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.6934409
	speed: 0.8014s/iter; left time: 24464.3497s
	iters: 200, epoch: 18 | loss: 0.6933681
	speed: 0.2505s/iter; left time: 7621.2475s
	iters: 300, epoch: 18 | loss: 0.6931576
	speed: 0.2423s/iter; left time: 7349.3821s
Epoch: 18 cost time: 92.08752775192261
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6924856
	speed: 0.7796s/iter; left time: 23510.6244s
	iters: 200, epoch: 19 | loss: 0.6964378
	speed: 0.2489s/iter; left time: 7482.2135s
	iters: 300, epoch: 19 | loss: 0.6936197
	speed: 0.2424s/iter; left time: 7263.0309s
Epoch: 19 cost time: 91.49632716178894
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6931648
	speed: 0.7880s/iter; left time: 23474.3340s
	iters: 200, epoch: 20 | loss: 0.6925123
	speed: 0.2517s/iter; left time: 7471.7168s
	iters: 300, epoch: 20 | loss: 0.6975909
	speed: 0.2533s/iter; left time: 7493.7629s
Epoch: 20 cost time: 93.69932579994202
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6935949
	speed: 0.8152s/iter; left time: 23984.7225s
	iters: 200, epoch: 21 | loss: 0.6914747
	speed: 0.2484s/iter; left time: 7283.6244s
	iters: 300, epoch: 21 | loss: 0.6966132
	speed: 0.2546s/iter; left time: 7440.3652s
Epoch: 21 cost time: 95.0673201084137
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 10074626
model size : 57.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5995781
	speed: 0.2824s/iter; left time: 10394.2250s
	iters: 200, epoch: 1 | loss: 0.5362481
	speed: 0.2490s/iter; left time: 9139.6416s
	iters: 300, epoch: 1 | loss: 1.7018843
	speed: 0.2499s/iter; left time: 9148.0688s
Epoch: 1 cost time: 96.26529669761658
Epoch: 1, Steps: 369 | Train Loss: 0.753 Vali Loss: 1.172 Vali Acc: 0.589 Test Loss: 1.172 Test Acc: 0.589
Validation loss decreased (inf --> -0.588808).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7249658
	speed: 0.8018s/iter; left time: 29211.1643s
	iters: 200, epoch: 2 | loss: 0.5293411
	speed: 0.2522s/iter; left time: 9162.7084s
	iters: 300, epoch: 2 | loss: 1.0175178
	speed: 0.2538s/iter; left time: 9197.2814s
Epoch: 2 cost time: 94.43978834152222
Epoch: 2, Steps: 369 | Train Loss: 0.892 Vali Loss: 1.711 Vali Acc: 0.621 Test Loss: 1.711 Test Acc: 0.621
Validation loss decreased (-0.588808 --> -0.620584).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9871552
	speed: 0.8012s/iter; left time: 28894.1247s
	iters: 200, epoch: 3 | loss: 0.9569606
	speed: 0.2541s/iter; left time: 9138.6258s
	iters: 300, epoch: 3 | loss: 1.8012080
	speed: 0.2561s/iter; left time: 9185.1437s
Epoch: 3 cost time: 96.47223949432373
Epoch: 3, Steps: 369 | Train Loss: 1.038 Vali Loss: 2.772 Vali Acc: 0.641 Test Loss: 2.772 Test Acc: 0.641
Validation loss decreased (-0.620584 --> -0.640721).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5516611
	speed: 0.8203s/iter; left time: 29280.8018s
	iters: 200, epoch: 4 | loss: 2.9829979
	speed: 0.2643s/iter; left time: 9409.0088s
	iters: 300, epoch: 4 | loss: 1.9331760
	speed: 0.2600s/iter; left time: 9227.6966s
Epoch: 4 cost time: 97.34443092346191
Epoch: 4, Steps: 369 | Train Loss: 1.305 Vali Loss: 2.198 Vali Acc: 0.637 Test Loss: 2.198 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4670764
	speed: 0.8510s/iter; left time: 30060.8935s
	iters: 200, epoch: 5 | loss: 1.5209491
	speed: 0.2744s/iter; left time: 9665.4109s
	iters: 300, epoch: 5 | loss: 2.4454851
	speed: 0.2746s/iter; left time: 9645.2797s
Epoch: 5 cost time: 102.67913556098938
Epoch: 5, Steps: 369 | Train Loss: 1.387 Vali Loss: 1.842 Vali Acc: 0.639 Test Loss: 1.842 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7597807
	speed: 0.8435s/iter; left time: 29485.9222s
	iters: 200, epoch: 6 | loss: 1.2164418
	speed: 0.2587s/iter; left time: 9015.8120s
	iters: 300, epoch: 6 | loss: 0.2915519
	speed: 0.2546s/iter; left time: 8847.1801s
Epoch: 6 cost time: 95.61944389343262
Epoch: 6, Steps: 369 | Train Loss: 0.986 Vali Loss: 1.050 Vali Acc: 0.607 Test Loss: 1.050 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2275017
	speed: 0.7899s/iter; left time: 27320.4092s
	iters: 200, epoch: 7 | loss: 0.9351715
	speed: 0.2612s/iter; left time: 9008.9954s
	iters: 300, epoch: 7 | loss: 0.9571137
	speed: 0.2577s/iter; left time: 8860.9211s
Epoch: 7 cost time: 94.99280786514282
Epoch: 7, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.843 Vali Acc: 0.594 Test Loss: 0.843 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7287757
	speed: 0.8038s/iter; left time: 27503.8608s
	iters: 200, epoch: 8 | loss: 0.4833971
	speed: 0.2497s/iter; left time: 8518.2827s
	iters: 300, epoch: 8 | loss: 0.7216211
	speed: 0.2541s/iter; left time: 8644.2344s
Epoch: 8 cost time: 94.28423142433167
Epoch: 8, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.777 Vali Acc: 0.606 Test Loss: 0.777 Test Acc: 0.606
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.4133129
	speed: 0.8033s/iter; left time: 27191.7574s
	iters: 200, epoch: 9 | loss: 0.9624550
	speed: 0.2579s/iter; left time: 8704.8141s
	iters: 300, epoch: 9 | loss: 0.4854366
	speed: 0.2562s/iter; left time: 8619.3557s
Epoch: 9 cost time: 95.01112270355225
Epoch: 9, Steps: 369 | Train Loss: 0.636 Vali Loss: 0.766 Vali Acc: 0.602 Test Loss: 0.766 Test Acc: 0.602
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5815651
	speed: 0.7933s/iter; left time: 26558.1709s
	iters: 200, epoch: 10 | loss: 0.7166771
	speed: 0.2608s/iter; left time: 8707.1411s
	iters: 300, epoch: 10 | loss: 0.5587983
	speed: 0.2602s/iter; left time: 8658.1744s
Epoch: 10 cost time: 96.10109829902649
Epoch: 10, Steps: 369 | Train Loss: 0.602 Vali Loss: 0.742 Vali Acc: 0.651 Test Loss: 0.742 Test Acc: 0.651
Validation loss decreased (-0.640721 --> -0.650957).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4848350
	speed: 0.8214s/iter; left time: 27197.4883s
	iters: 200, epoch: 11 | loss: 0.4425562
	speed: 0.2585s/iter; left time: 8532.8610s
	iters: 300, epoch: 11 | loss: 0.4900024
	speed: 0.2569s/iter; left time: 8456.2153s
Epoch: 11 cost time: 96.15479159355164
Epoch: 11, Steps: 369 | Train Loss: 0.589 Vali Loss: 0.862 Vali Acc: 0.637 Test Loss: 0.862 Test Acc: 0.637
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6736981
	speed: 0.8034s/iter; left time: 26305.3922s
	iters: 200, epoch: 12 | loss: 0.3284744
	speed: 0.2637s/iter; left time: 8608.3857s
	iters: 300, epoch: 12 | loss: 0.5424873
	speed: 0.2532s/iter; left time: 8240.9457s
Epoch: 12 cost time: 95.77149796485901
Epoch: 12, Steps: 369 | Train Loss: 0.567 Vali Loss: 0.711 Vali Acc: 0.657 Test Loss: 0.711 Test Acc: 0.657
Validation loss decreased (-0.650957 --> -0.657201).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5703534
	speed: 0.8287s/iter; left time: 26826.3188s
	iters: 200, epoch: 13 | loss: 0.6335250
	speed: 0.2616s/iter; left time: 8443.6413s
	iters: 300, epoch: 13 | loss: 0.4309062
	speed: 0.2489s/iter; left time: 8006.8680s
Epoch: 13 cost time: 95.5105881690979
Epoch: 13, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.693 Vali Acc: 0.669 Test Loss: 0.693 Test Acc: 0.669
Validation loss decreased (-0.657201 --> -0.669119).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6188495
	speed: 0.8334s/iter; left time: 26672.2697s
	iters: 200, epoch: 14 | loss: 0.5976425
	speed: 0.2636s/iter; left time: 8409.4559s
	iters: 300, epoch: 14 | loss: 0.3907802
	speed: 0.2585s/iter; left time: 8222.2700s
Epoch: 14 cost time: 98.66955900192261
Epoch: 14, Steps: 369 | Train Loss: 0.534 Vali Loss: 0.691 Vali Acc: 0.689 Test Loss: 0.691 Test Acc: 0.689
Validation loss decreased (-0.669119 --> -0.689267).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3198707
	speed: 0.8492s/iter; left time: 26864.8787s
	iters: 200, epoch: 15 | loss: 0.5865644
	speed: 0.2659s/iter; left time: 8383.8023s
	iters: 300, epoch: 15 | loss: 0.6381537
	speed: 0.2582s/iter; left time: 8116.0208s
Epoch: 15 cost time: 97.72487163543701
Epoch: 15, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.739 Vali Acc: 0.673 Test Loss: 0.739 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3741898
	speed: 0.8239s/iter; left time: 25759.1287s
	iters: 200, epoch: 16 | loss: 0.4654689
	speed: 0.2686s/iter; left time: 8369.6770s
	iters: 300, epoch: 16 | loss: 0.2669107
	speed: 0.2636s/iter; left time: 8188.7600s
Epoch: 16 cost time: 97.44037461280823
Epoch: 16, Steps: 369 | Train Loss: 0.490 Vali Loss: 0.774 Vali Acc: 0.668 Test Loss: 0.774 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6714758
	speed: 0.8045s/iter; left time: 24855.0988s
	iters: 200, epoch: 17 | loss: 0.4083063
	speed: 0.2665s/iter; left time: 8206.4525s
	iters: 300, epoch: 17 | loss: 0.2702119
	speed: 0.2649s/iter; left time: 8131.4572s
Epoch: 17 cost time: 97.19323945045471
Epoch: 17, Steps: 369 | Train Loss: 0.460 Vali Loss: 0.764 Vali Acc: 0.684 Test Loss: 0.764 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3982618
	speed: 0.8543s/iter; left time: 26079.0402s
	iters: 200, epoch: 18 | loss: 0.5691212
	speed: 0.2626s/iter; left time: 7990.6989s
	iters: 300, epoch: 18 | loss: 0.2596650
	speed: 0.2560s/iter; left time: 7762.5682s
Epoch: 18 cost time: 97.9980890750885
Epoch: 18, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.802 Vali Acc: 0.690 Test Loss: 0.802 Test Acc: 0.690
Validation loss decreased (-0.689267 --> -0.690401).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6743412
	speed: 0.8134s/iter; left time: 24529.9335s
	iters: 200, epoch: 19 | loss: 0.5098741
	speed: 0.2680s/iter; left time: 8056.1778s
	iters: 300, epoch: 19 | loss: 0.3902841
	speed: 0.2649s/iter; left time: 7935.7485s
Epoch: 19 cost time: 98.94969081878662
Epoch: 19, Steps: 369 | Train Loss: 0.437 Vali Loss: 0.694 Vali Acc: 0.694 Test Loss: 0.694 Test Acc: 0.694
Validation loss decreased (-0.690401 --> -0.694374).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1793828
	speed: 0.8558s/iter; left time: 25492.8868s
	iters: 200, epoch: 20 | loss: 0.4727981
	speed: 0.2577s/iter; left time: 7650.7041s
	iters: 300, epoch: 20 | loss: 0.4006300
	speed: 0.2604s/iter; left time: 7705.2339s
Epoch: 20 cost time: 97.11474442481995
Epoch: 20, Steps: 369 | Train Loss: 0.413 Vali Loss: 0.806 Vali Acc: 0.695 Test Loss: 0.806 Test Acc: 0.695
Validation loss decreased (-0.694374 --> -0.694941).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3105912
	speed: 0.8627s/iter; left time: 25381.7854s
	iters: 200, epoch: 21 | loss: 0.2994212
	speed: 0.2817s/iter; left time: 8260.0992s
	iters: 300, epoch: 21 | loss: 0.4339965
	speed: 0.2818s/iter; left time: 8235.8419s
Epoch: 21 cost time: 103.61438322067261
Epoch: 21, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.732 Vali Acc: 0.678 Test Loss: 0.732 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5344725
	speed: 0.8642s/iter; left time: 25106.0337s
	iters: 200, epoch: 22 | loss: 0.2514291
	speed: 0.2612s/iter; left time: 7562.1389s
	iters: 300, epoch: 22 | loss: 0.2721514
	speed: 0.2873s/iter; left time: 8288.0156s
Epoch: 22 cost time: 103.73785710334778
Epoch: 22, Steps: 369 | Train Loss: 0.379 Vali Loss: 0.817 Vali Acc: 0.671 Test Loss: 0.817 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2723931
	speed: 0.8749s/iter; left time: 25095.8496s
	iters: 200, epoch: 23 | loss: 0.1581128
	speed: 0.2767s/iter; left time: 7910.1586s
	iters: 300, epoch: 23 | loss: 0.2823521
	speed: 0.2690s/iter; left time: 7661.1476s
Epoch: 23 cost time: 102.56047105789185
Epoch: 23, Steps: 369 | Train Loss: 0.357 Vali Loss: 0.889 Vali Acc: 0.668 Test Loss: 0.889 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1327069
	speed: 0.8893s/iter; left time: 25178.6650s
	iters: 200, epoch: 24 | loss: 0.0894844
	speed: 0.2736s/iter; left time: 7719.0071s
	iters: 300, epoch: 24 | loss: 0.4885536
	speed: 0.2528s/iter; left time: 7106.4632s
Epoch: 24 cost time: 99.65699744224548
Epoch: 24, Steps: 369 | Train Loss: 0.321 Vali Loss: 0.895 Vali Acc: 0.666 Test Loss: 0.895 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2246320
	speed: 0.8199s/iter; left time: 22911.3953s
	iters: 200, epoch: 25 | loss: 0.1362452
	speed: 0.2685s/iter; left time: 7475.9775s
	iters: 300, epoch: 25 | loss: 0.4757849
	speed: 0.2522s/iter; left time: 6996.8256s
Epoch: 25 cost time: 96.45348191261292
Epoch: 25, Steps: 369 | Train Loss: 0.281 Vali Loss: 0.875 Vali Acc: 0.670 Test Loss: 0.875 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1866829
	speed: 0.8002s/iter; left time: 22066.6201s
	iters: 200, epoch: 26 | loss: 0.3063070
	speed: 0.2499s/iter; left time: 6865.6216s
	iters: 300, epoch: 26 | loss: 0.4052344
	speed: 0.2518s/iter; left time: 6893.4857s
Epoch: 26 cost time: 93.99473071098328
Epoch: 26, Steps: 369 | Train Loss: 0.251 Vali Loss: 1.025 Vali Acc: 0.674 Test Loss: 1.025 Test Acc: 0.674
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.2031780
	speed: 0.8237s/iter; left time: 22409.0762s
	iters: 200, epoch: 27 | loss: 0.0785409
	speed: 0.2542s/iter; left time: 6890.0039s
	iters: 300, epoch: 27 | loss: 0.3124796
	speed: 0.2538s/iter; left time: 6853.3166s
Epoch: 27 cost time: 95.08556842803955
Epoch: 27, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.341 Vali Acc: 0.667 Test Loss: 1.341 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1900249
	speed: 0.8271s/iter; left time: 22198.5951s
	iters: 200, epoch: 28 | loss: 0.0592755
	speed: 0.2531s/iter; left time: 6768.6971s
	iters: 300, epoch: 28 | loss: 0.0728801
	speed: 0.2628s/iter; left time: 7001.5339s
Epoch: 28 cost time: 96.44578647613525
Epoch: 28, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.044 Vali Acc: 0.656 Test Loss: 1.044 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0686843
	speed: 0.8383s/iter; left time: 22189.5758s
	iters: 200, epoch: 29 | loss: 0.0549083
	speed: 0.2537s/iter; left time: 6689.4723s
	iters: 300, epoch: 29 | loss: 0.1999004
	speed: 0.2588s/iter; left time: 6797.3065s
Epoch: 29 cost time: 96.04126644134521
Epoch: 29, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.375 Vali Acc: 0.653 Test Loss: 1.375 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0181234
	speed: 0.8334s/iter; left time: 21751.5740s
	iters: 200, epoch: 30 | loss: 0.0045804
	speed: 0.2563s/iter; left time: 6663.6441s
	iters: 300, epoch: 30 | loss: 0.0278332
	speed: 0.2518s/iter; left time: 6521.9470s
Epoch: 30 cost time: 95.58580112457275
Epoch: 30, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.433 Vali Acc: 0.664 Test Loss: 1.433 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6949489216799092
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6771731
	speed: 0.2736s/iter; left time: 10069.3082s
	iters: 200, epoch: 1 | loss: 0.5263968
	speed: 0.2543s/iter; left time: 9331.5446s
	iters: 300, epoch: 1 | loss: 2.0986378
	speed: 0.2520s/iter; left time: 9223.7711s
Epoch: 1 cost time: 96.54903411865234
Epoch: 1, Steps: 369 | Train Loss: 0.771 Vali Loss: 1.324 Vali Acc: 0.579 Test Loss: 1.324 Test Acc: 0.579
Validation loss decreased (inf --> -0.579442).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0853899
	speed: 0.8659s/iter; left time: 31546.9377s
	iters: 200, epoch: 2 | loss: 0.4557170
	speed: 0.2774s/iter; left time: 10079.7927s
	iters: 300, epoch: 2 | loss: 1.8975824
	speed: 0.2692s/iter; left time: 9753.6917s
Epoch: 2 cost time: 100.76551270484924
Epoch: 2, Steps: 369 | Train Loss: 0.904 Vali Loss: 1.979 Vali Acc: 0.629 Test Loss: 1.979 Test Acc: 0.629
Validation loss decreased (-0.579442 --> -0.628527).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8456192
	speed: 0.8471s/iter; left time: 30547.4747s
	iters: 200, epoch: 3 | loss: 0.4744344
	speed: 0.2703s/iter; left time: 9721.5543s
	iters: 300, epoch: 3 | loss: 3.1031175
	speed: 0.2781s/iter; left time: 9972.7378s
Epoch: 3 cost time: 100.83906245231628
Epoch: 3, Steps: 369 | Train Loss: 1.168 Vali Loss: 2.259 Vali Acc: 0.621 Test Loss: 2.259 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5569854
	speed: 0.8309s/iter; left time: 29658.4432s
	iters: 200, epoch: 4 | loss: 1.3727349
	speed: 0.2554s/iter; left time: 9089.4980s
	iters: 300, epoch: 4 | loss: 3.5477934
	speed: 0.2439s/iter; left time: 8656.3470s
Epoch: 4 cost time: 95.0580940246582
Epoch: 4, Steps: 369 | Train Loss: 1.272 Vali Loss: 2.561 Vali Acc: 0.619 Test Loss: 2.561 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3058055
	speed: 0.8009s/iter; left time: 28291.5027s
	iters: 200, epoch: 5 | loss: 0.6936449
	speed: 0.2652s/iter; left time: 9342.4331s
	iters: 300, epoch: 5 | loss: 0.1840902
	speed: 0.2759s/iter; left time: 9692.5796s
Epoch: 5 cost time: 99.4251925945282
Epoch: 5, Steps: 369 | Train Loss: 1.273 Vali Loss: 1.528 Vali Acc: 0.615 Test Loss: 1.528 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9001092
	speed: 0.8623s/iter; left time: 30143.3041s
	iters: 200, epoch: 6 | loss: 2.1910980
	speed: 0.2801s/iter; left time: 9764.7910s
	iters: 300, epoch: 6 | loss: 0.5282693
	speed: 0.2721s/iter; left time: 9457.6940s
Epoch: 6 cost time: 101.57326984405518
Epoch: 6, Steps: 369 | Train Loss: 1.052 Vali Loss: 0.935 Vali Acc: 0.661 Test Loss: 0.935 Test Acc: 0.661
Validation loss decreased (-0.628527 --> -0.661455).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9309030
	speed: 0.8606s/iter; left time: 29764.2490s
	iters: 200, epoch: 7 | loss: 0.6107477
	speed: 0.2758s/iter; left time: 9511.3856s
	iters: 300, epoch: 7 | loss: 0.6955202
	speed: 0.2773s/iter; left time: 9536.0358s
Epoch: 7 cost time: 101.62023830413818
Epoch: 7, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.743 Vali Acc: 0.638 Test Loss: 0.743 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4495084
	speed: 0.8549s/iter; left time: 29253.2308s
	iters: 200, epoch: 8 | loss: 0.5546266
	speed: 0.2563s/iter; left time: 8745.2593s
	iters: 300, epoch: 8 | loss: 0.2750193
	speed: 0.2718s/iter; left time: 9246.4633s
Epoch: 8 cost time: 98.26653146743774
Epoch: 8, Steps: 369 | Train Loss: 0.555 Vali Loss: 0.760 Vali Acc: 0.652 Test Loss: 0.760 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4653610
	speed: 0.8552s/iter; left time: 28946.0403s
	iters: 200, epoch: 9 | loss: 0.5966316
	speed: 0.2775s/iter; left time: 9364.8861s
	iters: 300, epoch: 9 | loss: 0.3346779
	speed: 0.2728s/iter; left time: 9179.8727s
Epoch: 9 cost time: 100.88549733161926
Epoch: 9, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.666 Vali Acc: 0.678 Test Loss: 0.666 Test Acc: 0.678
Validation loss decreased (-0.661455 --> -0.678484).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5704930
	speed: 0.8853s/iter; left time: 29639.6860s
	iters: 200, epoch: 10 | loss: 0.9716906
	speed: 0.2745s/iter; left time: 9163.7132s
	iters: 300, epoch: 10 | loss: 0.4509379
	speed: 0.2781s/iter; left time: 9253.9928s
Epoch: 10 cost time: 104.29782342910767
Epoch: 10, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.736 Vali Acc: 0.675 Test Loss: 0.736 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4579091
	speed: 0.8749s/iter; left time: 28969.5876s
	iters: 200, epoch: 11 | loss: 0.1837192
	speed: 0.2723s/iter; left time: 8988.0592s
	iters: 300, epoch: 11 | loss: 0.3224779
	speed: 0.2618s/iter; left time: 8615.3971s
Epoch: 11 cost time: 99.46349334716797
Epoch: 11, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.766 Vali Acc: 0.654 Test Loss: 0.766 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3888876
	speed: 0.8377s/iter; left time: 27427.4973s
	iters: 200, epoch: 12 | loss: 0.3954608
	speed: 0.2712s/iter; left time: 8851.2809s
	iters: 300, epoch: 12 | loss: 0.3392386
	speed: 0.2867s/iter; left time: 9328.4561s
Epoch: 12 cost time: 102.66314816474915
Epoch: 12, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.784 Vali Acc: 0.671 Test Loss: 0.784 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2310619
	speed: 0.8725s/iter; left time: 28246.1804s
	iters: 200, epoch: 13 | loss: 0.2881781
	speed: 0.2653s/iter; left time: 8563.4476s
	iters: 300, epoch: 13 | loss: 0.5218028
	speed: 0.2718s/iter; left time: 8745.5760s
Epoch: 13 cost time: 102.47049617767334
Epoch: 13, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.778 Vali Acc: 0.666 Test Loss: 0.778 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2065563
	speed: 0.8675s/iter; left time: 27764.8071s
	iters: 200, epoch: 14 | loss: 0.6761859
	speed: 0.2785s/iter; left time: 8885.8359s
	iters: 300, epoch: 14 | loss: 0.2366126
	speed: 0.2695s/iter; left time: 8572.2242s
Epoch: 14 cost time: 101.70520091056824
Epoch: 14, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.822 Vali Acc: 0.683 Test Loss: 0.822 Test Acc: 0.683
Validation loss decreased (-0.678484 --> -0.683306).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2155828
	speed: 0.8350s/iter; left time: 26416.4687s
	iters: 200, epoch: 15 | loss: 0.2614962
	speed: 0.2695s/iter; left time: 8498.1610s
	iters: 300, epoch: 15 | loss: 0.1689293
	speed: 0.2526s/iter; left time: 7941.5799s
Epoch: 15 cost time: 96.76689434051514
Epoch: 15, Steps: 369 | Train Loss: 0.311 Vali Loss: 0.810 Vali Acc: 0.665 Test Loss: 0.810 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0745376
	speed: 0.8215s/iter; left time: 25684.7034s
	iters: 200, epoch: 16 | loss: 0.2666533
	speed: 0.2534s/iter; left time: 7896.5182s
	iters: 300, epoch: 16 | loss: 0.0911615
	speed: 0.2620s/iter; left time: 8140.3967s
Epoch: 16 cost time: 96.00865936279297
Epoch: 16, Steps: 369 | Train Loss: 0.269 Vali Loss: 1.021 Vali Acc: 0.668 Test Loss: 1.021 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1400066
	speed: 0.8454s/iter; left time: 26120.1598s
	iters: 200, epoch: 17 | loss: 0.0678639
	speed: 0.2721s/iter; left time: 8378.5046s
	iters: 300, epoch: 17 | loss: 0.0282013
	speed: 0.2766s/iter; left time: 8489.6585s
Epoch: 17 cost time: 102.73712205886841
Epoch: 17, Steps: 369 | Train Loss: 0.228 Vali Loss: 0.995 Vali Acc: 0.662 Test Loss: 0.995 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2924812
	speed: 0.8657s/iter; left time: 26427.1638s
	iters: 200, epoch: 18 | loss: 0.1877562
	speed: 0.2630s/iter; left time: 8001.4286s
	iters: 300, epoch: 18 | loss: 0.2171963
	speed: 0.2762s/iter; left time: 8377.5736s
Epoch: 18 cost time: 100.6549460887909
Epoch: 18, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.298 Vali Acc: 0.648 Test Loss: 1.298 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3145271
	speed: 0.8641s/iter; left time: 26061.6974s
	iters: 200, epoch: 19 | loss: 0.2131651
	speed: 0.2727s/iter; left time: 8196.9404s
	iters: 300, epoch: 19 | loss: 0.2687513
	speed: 0.2934s/iter; left time: 8788.6239s
Epoch: 19 cost time: 105.13532066345215
Epoch: 19, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.389 Vali Acc: 0.657 Test Loss: 1.389 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0469646
	speed: 0.8818s/iter; left time: 26270.2128s
	iters: 200, epoch: 20 | loss: 0.4863923
	speed: 0.2842s/iter; left time: 8438.1739s
	iters: 300, epoch: 20 | loss: 0.1213400
	speed: 0.2667s/iter; left time: 7892.1572s
Epoch: 20 cost time: 101.75681734085083
Epoch: 20, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.442 Vali Acc: 0.664 Test Loss: 1.442 Test Acc: 0.664
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1428170
	speed: 0.8188s/iter; left time: 24089.1823s
	iters: 200, epoch: 21 | loss: 0.1721628
	speed: 0.2566s/iter; left time: 7524.8827s
	iters: 300, epoch: 21 | loss: 0.3340665
	speed: 0.2542s/iter; left time: 7427.9504s
Epoch: 21 cost time: 94.84669423103333
Epoch: 21, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.585 Vali Acc: 0.661 Test Loss: 1.585 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2457628
	speed: 0.8155s/iter; left time: 23691.6404s
	iters: 200, epoch: 22 | loss: 0.0389657
	speed: 0.2526s/iter; left time: 7313.3251s
	iters: 300, epoch: 22 | loss: 0.1190443
	speed: 0.2559s/iter; left time: 7384.4059s
Epoch: 22 cost time: 94.27111673355103
Epoch: 22, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.603 Vali Acc: 0.660 Test Loss: 1.603 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.4581756
	speed: 0.8119s/iter; left time: 23288.5532s
	iters: 200, epoch: 23 | loss: 0.0026897
	speed: 0.2485s/iter; left time: 7103.9385s
	iters: 300, epoch: 23 | loss: 0.1128905
	speed: 0.2493s/iter; left time: 7100.1303s
Epoch: 23 cost time: 94.14012312889099
Epoch: 23, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.945 Vali Acc: 0.661 Test Loss: 1.945 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0078008
	speed: 0.8378s/iter; left time: 23722.2242s
	iters: 200, epoch: 24 | loss: 0.0243720
	speed: 0.2822s/iter; left time: 7961.8300s
	iters: 300, epoch: 24 | loss: 0.2564200
	speed: 0.2869s/iter; left time: 8065.5144s
Epoch: 24 cost time: 103.1158447265625
Epoch: 24, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.915 Vali Acc: 0.650 Test Loss: 1.915 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6833144154370034
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9478642
	speed: 0.2911s/iter; left time: 10711.3684s
	iters: 200, epoch: 1 | loss: 0.6596689
	speed: 0.2834s/iter; left time: 10399.3833s
	iters: 300, epoch: 1 | loss: 2.0018055
	speed: 0.2676s/iter; left time: 9793.3378s
Epoch: 1 cost time: 103.06155157089233
Epoch: 1, Steps: 369 | Train Loss: 0.777 Vali Loss: 1.396 Vali Acc: 0.571 Test Loss: 1.396 Test Acc: 0.571
Validation loss decreased (inf --> -0.570644).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6034687
	speed: 0.8594s/iter; left time: 31310.3544s
	iters: 200, epoch: 2 | loss: 0.8803406
	speed: 0.2845s/iter; left time: 10337.0946s
	iters: 300, epoch: 2 | loss: 0.8502716
	speed: 0.2617s/iter; left time: 9480.5009s
Epoch: 2 cost time: 101.13015604019165
Epoch: 2, Steps: 369 | Train Loss: 0.920 Vali Loss: 1.587 Vali Acc: 0.643 Test Loss: 1.587 Test Acc: 0.643
Validation loss decreased (-0.570644 --> -0.642720).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1134441
	speed: 0.8501s/iter; left time: 30656.6070s
	iters: 200, epoch: 3 | loss: 0.3215941
	speed: 0.2864s/iter; left time: 10299.5120s
	iters: 300, epoch: 3 | loss: 0.9661533
	speed: 0.2825s/iter; left time: 10130.8098s
Epoch: 3 cost time: 103.96020102500916
Epoch: 3, Steps: 369 | Train Loss: 1.057 Vali Loss: 2.109 Vali Acc: 0.615 Test Loss: 2.109 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4690306
	speed: 0.8626s/iter; left time: 30787.9787s
	iters: 200, epoch: 4 | loss: 1.1947807
	speed: 0.2768s/iter; left time: 9852.1449s
	iters: 300, epoch: 4 | loss: 1.7355298
	speed: 0.2505s/iter; left time: 8891.4052s
Epoch: 4 cost time: 98.95742845535278
Epoch: 4, Steps: 369 | Train Loss: 1.259 Vali Loss: 2.334 Vali Acc: 0.589 Test Loss: 2.334 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1598691
	speed: 0.8305s/iter; left time: 29337.4315s
	iters: 200, epoch: 5 | loss: 0.0678950
	speed: 0.2710s/iter; left time: 9544.7822s
	iters: 300, epoch: 5 | loss: 1.4325228
	speed: 0.2736s/iter; left time: 9610.3997s
Epoch: 5 cost time: 100.54282975196838
Epoch: 5, Steps: 369 | Train Loss: 1.191 Vali Loss: 1.259 Vali Acc: 0.618 Test Loss: 1.259 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4282138
	speed: 0.8418s/iter; left time: 29427.4604s
	iters: 200, epoch: 6 | loss: 0.5409886
	speed: 0.2828s/iter; left time: 9858.6681s
	iters: 300, epoch: 6 | loss: 0.4878642
	speed: 0.2655s/iter; left time: 9228.8656s
Epoch: 6 cost time: 103.1922824382782
Epoch: 6, Steps: 369 | Train Loss: 0.770 Vali Loss: 0.883 Vali Acc: 0.592 Test Loss: 0.883 Test Acc: 0.592
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.7968315
	speed: 0.8600s/iter; left time: 29744.5012s
	iters: 200, epoch: 7 | loss: 0.6692657
	speed: 0.2713s/iter; left time: 9354.8016s
	iters: 300, epoch: 7 | loss: 0.4704713
	speed: 0.2735s/iter; left time: 9403.8748s
Epoch: 7 cost time: 101.1238329410553
Epoch: 7, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.771 Vali Acc: 0.595 Test Loss: 0.771 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8902629
	speed: 0.8450s/iter; left time: 28915.7136s
	iters: 200, epoch: 8 | loss: 0.4602479
	speed: 0.2653s/iter; left time: 9051.4461s
	iters: 300, epoch: 8 | loss: 0.3007940
	speed: 0.2891s/iter; left time: 9834.4818s
Epoch: 8 cost time: 102.27028179168701
Epoch: 8, Steps: 369 | Train Loss: 0.638 Vali Loss: 0.707 Vali Acc: 0.613 Test Loss: 0.707 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3976976
	speed: 0.8727s/iter; left time: 29540.9974s
	iters: 200, epoch: 9 | loss: 0.6389949
	speed: 0.2691s/iter; left time: 9080.5325s
	iters: 300, epoch: 9 | loss: 0.5969433
	speed: 0.2704s/iter; left time: 9098.9981s
Epoch: 9 cost time: 102.1461398601532
Epoch: 9, Steps: 369 | Train Loss: 0.590 Vali Loss: 0.758 Vali Acc: 0.637 Test Loss: 0.758 Test Acc: 0.637
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5093991
	speed: 0.8890s/iter; left time: 29763.1389s
	iters: 200, epoch: 10 | loss: 0.6705554
	speed: 0.2783s/iter; left time: 9288.4164s
	iters: 300, epoch: 10 | loss: 0.7479618
	speed: 0.2917s/iter; left time: 9707.6128s
Epoch: 10 cost time: 105.78541994094849
Epoch: 10, Steps: 369 | Train Loss: 0.546 Vali Loss: 0.793 Vali Acc: 0.666 Test Loss: 0.793 Test Acc: 0.666
Validation loss decreased (-0.642720 --> -0.665713).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5286961
	speed: 0.8444s/iter; left time: 27958.3422s
	iters: 200, epoch: 11 | loss: 0.4187896
	speed: 0.2622s/iter; left time: 8656.0070s
	iters: 300, epoch: 11 | loss: 0.3321204
	speed: 0.2563s/iter; left time: 8435.2227s
Epoch: 11 cost time: 97.11465668678284
Epoch: 11, Steps: 369 | Train Loss: 0.520 Vali Loss: 0.748 Vali Acc: 0.675 Test Loss: 0.748 Test Acc: 0.675
Validation loss decreased (-0.665713 --> -0.675078).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6736432
	speed: 0.8174s/iter; left time: 26762.7705s
	iters: 200, epoch: 12 | loss: 0.5467477
	speed: 0.2567s/iter; left time: 8379.4162s
	iters: 300, epoch: 12 | loss: 0.5219437
	speed: 0.2700s/iter; left time: 8785.3087s
Epoch: 12 cost time: 97.59694314002991
Epoch: 12, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.700 Vali Acc: 0.671 Test Loss: 0.700 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7562044
	speed: 0.8325s/iter; left time: 26950.3229s
	iters: 200, epoch: 13 | loss: 0.5001691
	speed: 0.2844s/iter; left time: 9177.2177s
	iters: 300, epoch: 13 | loss: 0.4211670
	speed: 0.2659s/iter; left time: 8553.5810s
Epoch: 13 cost time: 101.72426509857178
Epoch: 13, Steps: 369 | Train Loss: 0.495 Vali Loss: 0.746 Vali Acc: 0.679 Test Loss: 0.746 Test Acc: 0.679
Validation loss decreased (-0.675078 --> -0.679334).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8226144
	speed: 0.8607s/iter; left time: 27545.9536s
	iters: 200, epoch: 14 | loss: 0.5378994
	speed: 0.2724s/iter; left time: 8690.8004s
	iters: 300, epoch: 14 | loss: 0.3953442
	speed: 0.2785s/iter; left time: 8856.5916s
Epoch: 14 cost time: 103.09401488304138
Epoch: 14, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.837 Vali Acc: 0.682 Test Loss: 0.837 Test Acc: 0.682
Validation loss decreased (-0.679334 --> -0.682455).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4377162
	speed: 0.8723s/iter; left time: 27593.6375s
	iters: 200, epoch: 15 | loss: 0.3704287
	speed: 0.2837s/iter; left time: 8946.2017s
	iters: 300, epoch: 15 | loss: 0.5952745
	speed: 0.2598s/iter; left time: 8167.6143s
Epoch: 15 cost time: 102.0036518573761
Epoch: 15, Steps: 369 | Train Loss: 0.467 Vali Loss: 0.755 Vali Acc: 0.673 Test Loss: 0.755 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2026164
	speed: 0.8457s/iter; left time: 26442.6919s
	iters: 200, epoch: 16 | loss: 0.3838827
	speed: 0.2617s/iter; left time: 8156.5298s
	iters: 300, epoch: 16 | loss: 0.1945377
	speed: 0.2698s/iter; left time: 8382.2856s
Epoch: 16 cost time: 99.81368708610535
Epoch: 16, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.797 Vali Acc: 0.666 Test Loss: 0.797 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5735810
	speed: 0.8771s/iter; left time: 27101.0157s
	iters: 200, epoch: 17 | loss: 0.5064265
	speed: 0.2817s/iter; left time: 8675.6556s
	iters: 300, epoch: 17 | loss: 0.2929341
	speed: 0.2785s/iter; left time: 8547.8902s
Epoch: 17 cost time: 104.15100932121277
Epoch: 17, Steps: 369 | Train Loss: 0.436 Vali Loss: 0.769 Vali Acc: 0.670 Test Loss: 0.769 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4530957
	speed: 0.8559s/iter; left time: 26128.3105s
	iters: 200, epoch: 18 | loss: 0.4377135
	speed: 0.2886s/iter; left time: 8782.3402s
	iters: 300, epoch: 18 | loss: 0.3338180
	speed: 0.2584s/iter; left time: 7836.6926s
Epoch: 18 cost time: 101.8400948047638
Epoch: 18, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.853 Vali Acc: 0.673 Test Loss: 0.853 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3791413
	speed: 0.8513s/iter; left time: 25675.2065s
	iters: 200, epoch: 19 | loss: 0.5710429
	speed: 0.2819s/iter; left time: 8473.3659s
	iters: 300, epoch: 19 | loss: 0.2682790
	speed: 0.2822s/iter; left time: 8454.7180s
Epoch: 19 cost time: 103.8100733757019
Epoch: 19, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.845 Vali Acc: 0.665 Test Loss: 0.845 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2083977
	speed: 1.0079s/iter; left time: 30026.7020s
	iters: 200, epoch: 20 | loss: 0.5134351
	speed: 0.3057s/iter; left time: 9075.4281s
	iters: 300, epoch: 20 | loss: 0.5931411
	speed: 0.2889s/iter; left time: 8547.4367s
Epoch: 20 cost time: 115.09050583839417
Epoch: 20, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.822 Vali Acc: 0.671 Test Loss: 0.822 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1348285
	speed: 0.9338s/iter; left time: 27473.3857s
	iters: 200, epoch: 21 | loss: 0.3167143
	speed: 0.3002s/iter; left time: 8803.1371s
	iters: 300, epoch: 21 | loss: 0.4591199
	speed: 0.3045s/iter; left time: 8898.8001s
Epoch: 21 cost time: 113.44938445091248
Epoch: 21, Steps: 369 | Train Loss: 0.378 Vali Loss: 0.802 Vali Acc: 0.674 Test Loss: 0.802 Test Acc: 0.674
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.5306714
	speed: 0.9403s/iter; left time: 27316.3419s
	iters: 200, epoch: 22 | loss: 0.2001181
	speed: 0.3051s/iter; left time: 8831.8640s
	iters: 300, epoch: 22 | loss: 0.1216264
	speed: 0.3097s/iter; left time: 8935.4103s
Epoch: 22 cost time: 112.0722873210907
Epoch: 22, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.797 Vali Acc: 0.664 Test Loss: 0.797 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3258220
	speed: 0.9689s/iter; left time: 27789.6786s
	iters: 200, epoch: 23 | loss: 0.5229838
	speed: 0.3100s/iter; left time: 8861.8253s
	iters: 300, epoch: 23 | loss: 0.3024680
	speed: 0.2996s/iter; left time: 8533.6574s
Epoch: 23 cost time: 113.80980610847473
Epoch: 23, Steps: 369 | Train Loss: 0.319 Vali Loss: 1.063 Vali Acc: 0.661 Test Loss: 1.063 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2059956
	speed: 0.9348s/iter; left time: 26468.8081s
	iters: 200, epoch: 24 | loss: 0.0876225
	speed: 0.3051s/iter; left time: 8608.4715s
	iters: 300, epoch: 24 | loss: 0.1818161
	speed: 0.3119s/iter; left time: 8768.1688s
Epoch: 24 cost time: 113.01097702980042
Epoch: 24, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.781 Vali Acc: 0.676 Test Loss: 0.781 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6824631101021567
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8151819
	speed: 0.3240s/iter; left time: 11923.3424s
	iters: 200, epoch: 1 | loss: 0.6131374
	speed: 0.2965s/iter; left time: 10880.6344s
	iters: 300, epoch: 1 | loss: 1.6005335
	speed: 0.2844s/iter; left time: 10408.0522s
Epoch: 1 cost time: 110.63433146476746
Epoch: 1, Steps: 369 | Train Loss: 0.796 Vali Loss: 1.127 Vali Acc: 0.585 Test Loss: 1.127 Test Acc: 0.585
Validation loss decreased (inf --> -0.585403).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3598201
	speed: 0.9040s/iter; left time: 32935.2346s
	iters: 200, epoch: 2 | loss: 0.6460859
	speed: 0.2856s/iter; left time: 10376.8365s
	iters: 300, epoch: 2 | loss: 1.8708661
	speed: 0.2947s/iter; left time: 10677.2790s
Epoch: 2 cost time: 106.28890204429626
Epoch: 2, Steps: 369 | Train Loss: 0.943 Vali Loss: 1.881 Vali Acc: 0.643 Test Loss: 1.881 Test Acc: 0.643
Validation loss decreased (-0.585403 --> -0.642717).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5746080
	speed: 0.9280s/iter; left time: 33467.0009s
	iters: 200, epoch: 3 | loss: 0.1117478
	speed: 0.3096s/iter; left time: 11132.4463s
	iters: 300, epoch: 3 | loss: 1.5944594
	speed: 0.3033s/iter; left time: 10878.9663s
Epoch: 3 cost time: 111.61753344535828
Epoch: 3, Steps: 369 | Train Loss: 1.085 Vali Loss: 2.596 Vali Acc: 0.640 Test Loss: 2.596 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2015021
	speed: 0.9045s/iter; left time: 32286.5720s
	iters: 200, epoch: 4 | loss: 2.7983775
	speed: 0.2959s/iter; left time: 10532.2850s
	iters: 300, epoch: 4 | loss: 1.4663099
	speed: 0.2844s/iter; left time: 10095.9491s
Epoch: 4 cost time: 107.06850123405457
Epoch: 4, Steps: 369 | Train Loss: 1.238 Vali Loss: 2.617 Vali Acc: 0.626 Test Loss: 2.617 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6224052
	speed: 0.9256s/iter; left time: 32695.7736s
	iters: 200, epoch: 5 | loss: 1.0576770
	speed: 0.3010s/iter; left time: 10603.7192s
	iters: 300, epoch: 5 | loss: 0.3087584
	speed: 0.3000s/iter; left time: 10537.8671s
Epoch: 5 cost time: 111.98683524131775
Epoch: 5, Steps: 369 | Train Loss: 1.221 Vali Loss: 0.973 Vali Acc: 0.628 Test Loss: 0.973 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0813618
	speed: 0.9413s/iter; left time: 32903.8305s
	iters: 200, epoch: 6 | loss: 1.1288134
	speed: 0.3175s/iter; left time: 11068.2684s
	iters: 300, epoch: 6 | loss: 0.1924501
	speed: 0.3214s/iter; left time: 11169.1097s
Epoch: 6 cost time: 117.04559206962585
Epoch: 6, Steps: 369 | Train Loss: 1.004 Vali Loss: 1.481 Vali Acc: 0.553 Test Loss: 1.481 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9150518
	speed: 0.9647s/iter; left time: 33365.5630s
	iters: 200, epoch: 7 | loss: 1.6349099
	speed: 0.3073s/iter; left time: 10598.3723s
	iters: 300, epoch: 7 | loss: 0.5049078
	speed: 0.3038s/iter; left time: 10445.3293s
Epoch: 7 cost time: 113.37814736366272
Epoch: 7, Steps: 369 | Train Loss: 0.651 Vali Loss: 0.755 Vali Acc: 0.681 Test Loss: 0.755 Test Acc: 0.681
Validation loss decreased (-0.642717 --> -0.681037).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2858965
	speed: 0.9896s/iter; left time: 33860.9299s
	iters: 200, epoch: 8 | loss: 0.5839112
	speed: 0.2905s/iter; left time: 9909.7836s
	iters: 300, epoch: 8 | loss: 0.1663982
	speed: 0.2802s/iter; left time: 9531.1884s
Epoch: 8 cost time: 109.38282418251038
Epoch: 8, Steps: 369 | Train Loss: 0.579 Vali Loss: 0.955 Vali Acc: 0.608 Test Loss: 0.955 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3076606
	speed: 0.8969s/iter; left time: 30357.9324s
	iters: 200, epoch: 9 | loss: 0.6119379
	speed: 0.2765s/iter; left time: 9330.4566s
	iters: 300, epoch: 9 | loss: 0.7843670
	speed: 0.2889s/iter; left time: 9722.2233s
Epoch: 9 cost time: 105.66988015174866
Epoch: 9, Steps: 369 | Train Loss: 0.565 Vali Loss: 0.736 Vali Acc: 0.647 Test Loss: 0.736 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5889198
	speed: 0.9022s/iter; left time: 30204.9916s
	iters: 200, epoch: 10 | loss: 0.7973046
	speed: 0.2653s/iter; left time: 8856.0205s
	iters: 300, epoch: 10 | loss: 0.4378358
	speed: 0.2831s/iter; left time: 9420.2599s
Epoch: 10 cost time: 101.80603384971619
Epoch: 10, Steps: 369 | Train Loss: 0.530 Vali Loss: 0.711 Vali Acc: 0.659 Test Loss: 0.711 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4130115
	speed: 0.9361s/iter; left time: 30996.5535s
	iters: 200, epoch: 11 | loss: 0.3990963
	speed: 0.2862s/iter; left time: 9448.0455s
	iters: 300, epoch: 11 | loss: 0.4467247
	speed: 0.2879s/iter; left time: 9474.3159s
Epoch: 11 cost time: 108.2329409122467
Epoch: 11, Steps: 369 | Train Loss: 0.469 Vali Loss: 0.902 Vali Acc: 0.625 Test Loss: 0.902 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0388908
	speed: 0.8866s/iter; left time: 29029.9289s
	iters: 200, epoch: 12 | loss: 0.2733457
	speed: 0.2798s/iter; left time: 9132.1918s
	iters: 300, epoch: 12 | loss: 0.4549661
	speed: 0.2878s/iter; left time: 9364.2500s
Epoch: 12 cost time: 104.51194429397583
Epoch: 12, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.798 Vali Acc: 0.679 Test Loss: 0.798 Test Acc: 0.679
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2991357
	speed: 0.9148s/iter; left time: 29613.4218s
	iters: 200, epoch: 13 | loss: 0.4620117
	speed: 0.2883s/iter; left time: 9305.8785s
	iters: 300, epoch: 13 | loss: 0.2516775
	speed: 0.2783s/iter; left time: 8953.6270s
Epoch: 13 cost time: 105.76091194152832
Epoch: 13, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.892 Vali Acc: 0.663 Test Loss: 0.892 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3895451
	speed: 0.8748s/iter; left time: 27998.0042s
	iters: 200, epoch: 14 | loss: 0.5394973
	speed: 0.2723s/iter; left time: 8687.3976s
	iters: 300, epoch: 14 | loss: 0.2164864
	speed: 0.2840s/iter; left time: 9031.3392s
Epoch: 14 cost time: 104.12996482849121
Epoch: 14, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.989 Vali Acc: 0.666 Test Loss: 0.989 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.5187811
	speed: 0.8887s/iter; left time: 28114.4605s
	iters: 200, epoch: 15 | loss: 0.3470447
	speed: 0.2962s/iter; left time: 9341.9095s
	iters: 300, epoch: 15 | loss: 0.2405237
	speed: 0.2855s/iter; left time: 8973.1885s
Epoch: 15 cost time: 106.03889203071594
Epoch: 15, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.869 Vali Acc: 0.660 Test Loss: 0.869 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2468021
	speed: 0.9238s/iter; left time: 28883.4910s
	iters: 200, epoch: 16 | loss: 0.3517258
	speed: 0.2977s/iter; left time: 9278.5566s
	iters: 300, epoch: 16 | loss: 0.2578923
	speed: 0.2945s/iter; left time: 9149.4039s
Epoch: 16 cost time: 110.81897759437561
Epoch: 16, Steps: 369 | Train Loss: 0.320 Vali Loss: 0.993 Vali Acc: 0.673 Test Loss: 0.993 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1941371
	speed: 0.9269s/iter; left time: 28639.4455s
	iters: 200, epoch: 17 | loss: 0.2358399
	speed: 0.2934s/iter; left time: 9035.4878s
	iters: 300, epoch: 17 | loss: 0.2023071
	speed: 0.2845s/iter; left time: 8733.4979s
Epoch: 17 cost time: 109.64910864830017
Epoch: 17, Steps: 369 | Train Loss: 0.284 Vali Loss: 1.058 Vali Acc: 0.661 Test Loss: 1.058 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.681044267877412
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9711204
	speed: 0.2874s/iter; left time: 10575.5561s
	iters: 200, epoch: 1 | loss: 0.5207039
	speed: 0.2770s/iter; left time: 10167.3159s
	iters: 300, epoch: 1 | loss: 1.6544139
	speed: 0.2770s/iter; left time: 10138.1151s
Epoch: 1 cost time: 104.01411890983582
Epoch: 1, Steps: 369 | Train Loss: 0.797 Vali Loss: 1.227 Vali Acc: 0.570 Test Loss: 1.227 Test Acc: 0.570
Validation loss decreased (inf --> -0.569795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7656567
	speed: 0.8854s/iter; left time: 32257.9884s
	iters: 200, epoch: 2 | loss: 0.6817471
	speed: 0.2786s/iter; left time: 10122.4104s
	iters: 300, epoch: 2 | loss: 0.7490832
	speed: 0.2821s/iter; left time: 10219.5662s
Epoch: 2 cost time: 104.52486944198608
Epoch: 2, Steps: 369 | Train Loss: 0.977 Vali Loss: 1.780 Vali Acc: 0.636 Test Loss: 1.780 Test Acc: 0.636
Validation loss decreased (-0.569795 --> -0.635624).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8094936
	speed: 0.8759s/iter; left time: 31587.1364s
	iters: 200, epoch: 3 | loss: 1.0161046
	speed: 0.2682s/iter; left time: 9644.2634s
	iters: 300, epoch: 3 | loss: 1.0817308
	speed: 0.2620s/iter; left time: 9396.8882s
Epoch: 3 cost time: 99.2208559513092
Epoch: 3, Steps: 369 | Train Loss: 1.053 Vali Loss: 2.070 Vali Acc: 0.626 Test Loss: 2.070 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3755611
	speed: 0.8523s/iter; left time: 30421.5337s
	iters: 200, epoch: 4 | loss: 1.4150349
	speed: 0.2644s/iter; left time: 9410.3773s
	iters: 300, epoch: 4 | loss: 1.7601137
	speed: 0.2666s/iter; left time: 9461.0958s
Epoch: 4 cost time: 100.59083843231201
Epoch: 4, Steps: 369 | Train Loss: 1.234 Vali Loss: 2.549 Vali Acc: 0.656 Test Loss: 2.549 Test Acc: 0.656
Validation loss decreased (-0.635624 --> -0.655480).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7967114
	speed: 0.8696s/iter; left time: 30719.9342s
	iters: 200, epoch: 5 | loss: 0.1727649
	speed: 0.2708s/iter; left time: 9540.4086s
	iters: 300, epoch: 5 | loss: 1.4637740
	speed: 0.2637s/iter; left time: 9263.0037s
Epoch: 5 cost time: 99.28952097892761
Epoch: 5, Steps: 369 | Train Loss: 1.490 Vali Loss: 2.120 Vali Acc: 0.650 Test Loss: 2.120 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3432040
	speed: 0.8602s/iter; left time: 30070.7768s
	iters: 200, epoch: 6 | loss: 0.7265165
	speed: 0.2734s/iter; left time: 9529.4311s
	iters: 300, epoch: 6 | loss: 0.1992491
	speed: 0.2703s/iter; left time: 9394.1375s
Epoch: 6 cost time: 102.8682951927185
Epoch: 6, Steps: 369 | Train Loss: 1.226 Vali Loss: 1.582 Vali Acc: 0.605 Test Loss: 1.582 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7884889
	speed: 0.8398s/iter; left time: 29046.0211s
	iters: 200, epoch: 7 | loss: 1.8607807
	speed: 0.2872s/iter; left time: 9904.4090s
	iters: 300, epoch: 7 | loss: 0.4707925
	speed: 0.2847s/iter; left time: 9789.7643s
Epoch: 7 cost time: 103.91205263137817
Epoch: 7, Steps: 369 | Train Loss: 0.729 Vali Loss: 1.015 Vali Acc: 0.620 Test Loss: 1.015 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3677826
	speed: 0.8511s/iter; left time: 29124.5584s
	iters: 200, epoch: 8 | loss: 0.5059879
	speed: 0.2699s/iter; left time: 9209.8922s
	iters: 300, epoch: 8 | loss: 0.1352588
	speed: 0.2717s/iter; left time: 9242.5357s
Epoch: 8 cost time: 100.95845532417297
Epoch: 8, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.766 Vali Acc: 0.656 Test Loss: 0.766 Test Acc: 0.656
Validation loss decreased (-0.655480 --> -0.656349).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5162014
	speed: 0.8392s/iter; left time: 28406.7977s
	iters: 200, epoch: 9 | loss: 0.4269086
	speed: 0.2728s/iter; left time: 9206.6284s
	iters: 300, epoch: 9 | loss: 0.5562152
	speed: 0.2739s/iter; left time: 9216.0074s
Epoch: 9 cost time: 100.73372459411621
Epoch: 9, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.919 Vali Acc: 0.581 Test Loss: 0.919 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8129562
	speed: 0.8607s/iter; left time: 28817.0440s
	iters: 200, epoch: 10 | loss: 0.7451400
	speed: 0.2744s/iter; left time: 9159.2827s
	iters: 300, epoch: 10 | loss: 0.3268553
	speed: 0.2726s/iter; left time: 9073.4951s
Epoch: 10 cost time: 101.48000383377075
Epoch: 10, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.974 Vali Acc: 0.666 Test Loss: 0.974 Test Acc: 0.666
Validation loss decreased (-0.656349 --> -0.665711).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2790231
	speed: 0.8972s/iter; left time: 29708.1108s
	iters: 200, epoch: 11 | loss: 0.1145034
	speed: 0.2778s/iter; left time: 9172.0050s
	iters: 300, epoch: 11 | loss: 0.3391027
	speed: 0.2884s/iter; left time: 9491.9364s
Epoch: 11 cost time: 104.55598735809326
Epoch: 11, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.728 Vali Acc: 0.676 Test Loss: 0.728 Test Acc: 0.676
Validation loss decreased (-0.665711 --> -0.676213).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5245355
	speed: 0.8912s/iter; left time: 29178.9308s
	iters: 200, epoch: 12 | loss: 0.4265840
	speed: 0.2833s/iter; left time: 9245.9435s
	iters: 300, epoch: 12 | loss: 0.3357593
	speed: 0.2717s/iter; left time: 8840.9209s
Epoch: 12 cost time: 102.84557223320007
Epoch: 12, Steps: 369 | Train Loss: 0.344 Vali Loss: 1.031 Vali Acc: 0.665 Test Loss: 1.031 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2212357
	speed: 0.8614s/iter; left time: 27885.3810s
	iters: 200, epoch: 13 | loss: 0.4855751
	speed: 0.2652s/iter; left time: 8558.8558s
	iters: 300, epoch: 13 | loss: 0.7803447
	speed: 0.2680s/iter; left time: 8622.4122s
Epoch: 13 cost time: 100.24017477035522
Epoch: 13, Steps: 369 | Train Loss: 0.325 Vali Loss: 0.812 Vali Acc: 0.656 Test Loss: 0.812 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4334746
	speed: 0.8904s/iter; left time: 28496.1039s
	iters: 200, epoch: 14 | loss: 0.5044858
	speed: 0.2756s/iter; left time: 8792.4533s
	iters: 300, epoch: 14 | loss: 0.1719624
	speed: 0.2787s/iter; left time: 8863.1363s
Epoch: 14 cost time: 102.54664444923401
Epoch: 14, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.970 Vali Acc: 0.659 Test Loss: 0.970 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2076219
	speed: 0.8906s/iter; left time: 28173.7472s
	iters: 200, epoch: 15 | loss: 0.0715227
	speed: 0.2761s/iter; left time: 8706.8023s
	iters: 300, epoch: 15 | loss: 0.0976910
	speed: 0.2716s/iter; left time: 8538.0210s
Epoch: 15 cost time: 101.89350652694702
Epoch: 15, Steps: 369 | Train Loss: 0.212 Vali Loss: 0.948 Vali Acc: 0.639 Test Loss: 0.948 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0385610
	speed: 0.9039s/iter; left time: 28262.7326s
	iters: 200, epoch: 16 | loss: 0.1039827
	speed: 0.2972s/iter; left time: 9262.8630s
	iters: 300, epoch: 16 | loss: 0.1098382
	speed: 0.2618s/iter; left time: 8133.4567s
Epoch: 16 cost time: 104.71937036514282
Epoch: 16, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.087 Vali Acc: 0.653 Test Loss: 1.087 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2873553
	speed: 0.8473s/iter; left time: 26178.4989s
	iters: 200, epoch: 17 | loss: 0.2073047
	speed: 0.2768s/iter; left time: 8523.3586s
	iters: 300, epoch: 17 | loss: 0.0156750
	speed: 0.2584s/iter; left time: 7932.3275s
Epoch: 17 cost time: 99.21454882621765
Epoch: 17, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.523 Vali Acc: 0.646 Test Loss: 1.523 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1395475
	speed: 0.8891s/iter; left time: 27142.2223s
	iters: 200, epoch: 18 | loss: 0.3135457
	speed: 0.2846s/iter; left time: 8659.8470s
	iters: 300, epoch: 18 | loss: 0.2609735
	speed: 0.2779s/iter; left time: 8427.0290s
Epoch: 18 cost time: 105.64627122879028
Epoch: 18, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.448 Vali Acc: 0.652 Test Loss: 1.448 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.3557684
	speed: 0.8573s/iter; left time: 25855.0726s
	iters: 200, epoch: 19 | loss: 0.0499757
	speed: 0.2667s/iter; left time: 8016.0907s
	iters: 300, epoch: 19 | loss: 0.1768235
	speed: 0.2761s/iter; left time: 8271.7079s
Epoch: 19 cost time: 101.63355755805969
Epoch: 19, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.364 Vali Acc: 0.652 Test Loss: 1.364 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0098471
	speed: 0.8964s/iter; left time: 26704.6548s
	iters: 200, epoch: 20 | loss: 0.3557194
	speed: 0.2741s/iter; left time: 8137.0329s
	iters: 300, epoch: 20 | loss: 0.2541518
	speed: 0.2779s/iter; left time: 8224.1336s
Epoch: 20 cost time: 104.64294338226318
Epoch: 20, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.803 Vali Acc: 0.651 Test Loss: 1.803 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0035178
	speed: 0.8899s/iter; left time: 26180.6954s
	iters: 200, epoch: 21 | loss: 0.0032557
	speed: 0.2610s/iter; left time: 7653.4561s
	iters: 300, epoch: 21 | loss: 0.0186557
	speed: 0.2690s/iter; left time: 7860.8701s
Epoch: 21 cost time: 100.5039496421814
Epoch: 21, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.292 Vali Acc: 0.630 Test Loss: 2.292 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6762202043132803
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8097757
	speed: 0.3279s/iter; left time: 12068.2859s
	iters: 200, epoch: 1 | loss: 0.3503123
	speed: 0.3001s/iter; left time: 11015.2531s
	iters: 300, epoch: 1 | loss: 1.6371293
	speed: 0.2873s/iter; left time: 10514.0508s
Epoch: 1 cost time: 110.98385667800903
Epoch: 1, Steps: 369 | Train Loss: 0.793 Vali Loss: 1.363 Vali Acc: 0.581 Test Loss: 1.363 Test Acc: 0.581
Validation loss decreased (inf --> -0.581144).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7103401
	speed: 0.8765s/iter; left time: 31930.9093s
	iters: 200, epoch: 2 | loss: 0.5811391
	speed: 0.2864s/iter; left time: 10405.6130s
	iters: 300, epoch: 2 | loss: 0.9545972
	speed: 0.2739s/iter; left time: 9923.9251s
Epoch: 2 cost time: 105.53299570083618
Epoch: 2, Steps: 369 | Train Loss: 0.969 Vali Loss: 1.630 Vali Acc: 0.634 Test Loss: 1.630 Test Acc: 0.634
Validation loss decreased (-0.581144 --> -0.634206).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1459290
	speed: 0.8917s/iter; left time: 32157.5755s
	iters: 200, epoch: 3 | loss: 0.6121303
	speed: 0.2862s/iter; left time: 10294.1785s
	iters: 300, epoch: 3 | loss: 3.4045556
	speed: 0.2844s/iter; left time: 10197.7950s
Epoch: 3 cost time: 104.82626008987427
Epoch: 3, Steps: 369 | Train Loss: 0.987 Vali Loss: 1.943 Vali Acc: 0.608 Test Loss: 1.943 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2319471
	speed: 0.8676s/iter; left time: 30966.3321s
	iters: 200, epoch: 4 | loss: 1.6808304
	speed: 0.2606s/iter; left time: 9277.4796s
	iters: 300, epoch: 4 | loss: 0.8458202
	speed: 0.2809s/iter; left time: 9969.6246s
Epoch: 4 cost time: 101.05608105659485
Epoch: 4, Steps: 369 | Train Loss: 0.871 Vali Loss: 1.021 Vali Acc: 0.624 Test Loss: 1.021 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8216460
	speed: 0.8660s/iter; left time: 30590.5578s
	iters: 200, epoch: 5 | loss: 0.3384303
	speed: 0.2764s/iter; left time: 9737.3938s
	iters: 300, epoch: 5 | loss: 0.7755688
	speed: 0.2810s/iter; left time: 9870.8293s
Epoch: 5 cost time: 104.69990468025208
Epoch: 5, Steps: 369 | Train Loss: 0.819 Vali Loss: 0.760 Vali Acc: 0.623 Test Loss: 0.760 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.8294618
	speed: 0.9136s/iter; left time: 31936.8341s
	iters: 200, epoch: 6 | loss: 0.3214200
	speed: 0.2739s/iter; left time: 9547.2525s
	iters: 300, epoch: 6 | loss: 0.3103669
	speed: 0.2802s/iter; left time: 9739.5170s
Epoch: 6 cost time: 104.90587496757507
Epoch: 6, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.787 Vali Acc: 0.635 Test Loss: 0.787 Test Acc: 0.635
Validation loss decreased (-0.634206 --> -0.634782).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5898330
	speed: 0.9078s/iter; left time: 31397.2798s
	iters: 200, epoch: 7 | loss: 0.5848151
	speed: 0.2868s/iter; left time: 9891.0757s
	iters: 300, epoch: 7 | loss: 0.5964603
	speed: 0.2827s/iter; left time: 9719.9459s
Epoch: 7 cost time: 105.66377305984497
Epoch: 7, Steps: 369 | Train Loss: 0.658 Vali Loss: 0.716 Vali Acc: 0.610 Test Loss: 0.716 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4636404
	speed: 0.8978s/iter; left time: 30719.5172s
	iters: 200, epoch: 8 | loss: 0.6097031
	speed: 0.2808s/iter; left time: 9582.0281s
	iters: 300, epoch: 8 | loss: 0.3035131
	speed: 0.2790s/iter; left time: 9490.3940s
Epoch: 8 cost time: 105.02867317199707
Epoch: 8, Steps: 369 | Train Loss: 0.622 Vali Loss: 0.696 Vali Acc: 0.651 Test Loss: 0.696 Test Acc: 0.651
Validation loss decreased (-0.634782 --> -0.650674).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4980688
	speed: 0.8892s/iter; left time: 30100.0001s
	iters: 200, epoch: 9 | loss: 0.9299026
	speed: 0.2883s/iter; left time: 9729.9414s
	iters: 300, epoch: 9 | loss: 0.5422338
	speed: 0.2889s/iter; left time: 9722.6363s
Epoch: 9 cost time: 106.70907068252563
Epoch: 9, Steps: 369 | Train Loss: 0.567 Vali Loss: 0.664 Vali Acc: 0.670 Test Loss: 0.664 Test Acc: 0.670
Validation loss decreased (-0.650674 --> -0.670254).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6713269
	speed: 0.9266s/iter; left time: 31021.1300s
	iters: 200, epoch: 10 | loss: 0.5334122
	speed: 0.2928s/iter; left time: 9773.6221s
	iters: 300, epoch: 10 | loss: 0.5018588
	speed: 0.2803s/iter; left time: 9328.2781s
Epoch: 10 cost time: 107.14699745178223
Epoch: 10, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.649 Vali Acc: 0.653 Test Loss: 0.649 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5416968
	speed: 0.8959s/iter; left time: 29664.9885s
	iters: 200, epoch: 11 | loss: 0.2550681
	speed: 0.2855s/iter; left time: 9423.4588s
	iters: 300, epoch: 11 | loss: 0.4294209
	speed: 0.2719s/iter; left time: 8949.6552s
Epoch: 11 cost time: 103.29988360404968
Epoch: 11, Steps: 369 | Train Loss: 0.537 Vali Loss: 0.665 Vali Acc: 0.677 Test Loss: 0.665 Test Acc: 0.677
Validation loss decreased (-0.670254 --> -0.677065).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4868464
	speed: 0.8460s/iter; left time: 27700.2014s
	iters: 200, epoch: 12 | loss: 0.6133026
	speed: 0.2849s/iter; left time: 9301.1193s
	iters: 300, epoch: 12 | loss: 0.6125643
	speed: 0.2815s/iter; left time: 9160.0489s
Epoch: 12 cost time: 103.59567975997925
Epoch: 12, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.651 Vali Acc: 0.665 Test Loss: 0.651 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7267568
	speed: 0.8780s/iter; left time: 28423.6500s
	iters: 200, epoch: 13 | loss: 0.5796441
	speed: 0.2825s/iter; left time: 9117.1443s
	iters: 300, epoch: 13 | loss: 0.2644406
	speed: 0.2730s/iter; left time: 8781.8515s
Epoch: 13 cost time: 103.48921418190002
Epoch: 13, Steps: 369 | Train Loss: 0.505 Vali Loss: 0.682 Vali Acc: 0.669 Test Loss: 0.682 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6282763
	speed: 0.8716s/iter; left time: 27896.0577s
	iters: 200, epoch: 14 | loss: 0.7465193
	speed: 0.2901s/iter; left time: 9254.9470s
	iters: 300, epoch: 14 | loss: 0.5097268
	speed: 0.2963s/iter; left time: 9424.4049s
Epoch: 14 cost time: 106.41867756843567
Epoch: 14, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.716 Vali Acc: 0.689 Test Loss: 0.716 Test Acc: 0.689
Validation loss decreased (-0.677065 --> -0.689266).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2597729
	speed: 0.9060s/iter; left time: 28660.8114s
	iters: 200, epoch: 15 | loss: 0.4034124
	speed: 0.2820s/iter; left time: 8892.0084s
	iters: 300, epoch: 15 | loss: 0.3641555
	speed: 0.2805s/iter; left time: 8818.5658s
Epoch: 15 cost time: 104.80786943435669
Epoch: 15, Steps: 369 | Train Loss: 0.468 Vali Loss: 0.659 Vali Acc: 0.683 Test Loss: 0.659 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4002868
	speed: 0.8823s/iter; left time: 27585.5630s
	iters: 200, epoch: 16 | loss: 0.5094594
	speed: 0.2868s/iter; left time: 8939.3121s
	iters: 300, epoch: 16 | loss: 0.2080795
	speed: 0.2769s/iter; left time: 8601.3595s
Epoch: 16 cost time: 105.23571538925171
Epoch: 16, Steps: 369 | Train Loss: 0.453 Vali Loss: 0.690 Vali Acc: 0.682 Test Loss: 0.690 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5345046
	speed: 0.9053s/iter; left time: 27971.5604s
	iters: 200, epoch: 17 | loss: 0.3309030
	speed: 0.2865s/iter; left time: 8823.5183s
	iters: 300, epoch: 17 | loss: 0.2863341
	speed: 0.2908s/iter; left time: 8926.2457s
Epoch: 17 cost time: 107.0200514793396
Epoch: 17, Steps: 369 | Train Loss: 0.440 Vali Loss: 0.671 Vali Acc: 0.693 Test Loss: 0.671 Test Acc: 0.693
Validation loss decreased (-0.689266 --> -0.692956).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.8748643
	speed: 0.8984s/iter; left time: 27426.2037s
	iters: 200, epoch: 18 | loss: 0.4222215
	speed: 0.2897s/iter; left time: 8815.0837s
	iters: 300, epoch: 18 | loss: 0.3123289
	speed: 0.2917s/iter; left time: 8845.2811s
Epoch: 18 cost time: 107.1809241771698
Epoch: 18, Steps: 369 | Train Loss: 0.428 Vali Loss: 0.762 Vali Acc: 0.680 Test Loss: 0.762 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6749055
	speed: 0.8953s/iter; left time: 27000.4476s
	iters: 200, epoch: 19 | loss: 0.5017442
	speed: 0.2840s/iter; left time: 8536.9883s
	iters: 300, epoch: 19 | loss: 0.2577007
	speed: 0.2796s/iter; left time: 8377.9661s
Epoch: 19 cost time: 106.05014371871948
Epoch: 19, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.840 Vali Acc: 0.683 Test Loss: 0.840 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1756009
	speed: 0.9036s/iter; left time: 26916.8012s
	iters: 200, epoch: 20 | loss: 0.4534473
	speed: 0.2775s/iter; left time: 8240.1423s
	iters: 300, epoch: 20 | loss: 0.5123165
	speed: 0.2777s/iter; left time: 8218.5213s
Epoch: 20 cost time: 104.91359090805054
Epoch: 20, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.781 Vali Acc: 0.678 Test Loss: 0.781 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2417777
	speed: 0.9074s/iter; left time: 26697.3887s
	iters: 200, epoch: 21 | loss: 0.1914042
	speed: 0.2925s/iter; left time: 8576.2228s
	iters: 300, epoch: 21 | loss: 0.2699451
	speed: 0.2887s/iter; left time: 8435.2618s
Epoch: 21 cost time: 108.59587526321411
Epoch: 21, Steps: 369 | Train Loss: 0.376 Vali Loss: 0.776 Vali Acc: 0.673 Test Loss: 0.776 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.4132335
	speed: 0.9077s/iter; left time: 26369.0911s
	iters: 200, epoch: 22 | loss: 0.2402728
	speed: 0.2840s/iter; left time: 8221.3376s
	iters: 300, epoch: 22 | loss: 0.3407145
	speed: 0.2745s/iter; left time: 7919.0223s
Epoch: 22 cost time: 102.57651901245117
Epoch: 22, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.742 Vali Acc: 0.690 Test Loss: 0.742 Test Acc: 0.690
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2852554
	speed: 0.8739s/iter; left time: 25066.3147s
	iters: 200, epoch: 23 | loss: 0.1977416
	speed: 0.2858s/iter; left time: 8168.8509s
	iters: 300, epoch: 23 | loss: 0.4667077
	speed: 0.2909s/iter; left time: 8285.4542s
Epoch: 23 cost time: 106.41026854515076
Epoch: 23, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.767 Vali Acc: 0.676 Test Loss: 0.767 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.2192283
	speed: 0.8857s/iter; left time: 25076.6100s
	iters: 200, epoch: 24 | loss: 0.0694367
	speed: 0.2819s/iter; left time: 7953.1120s
	iters: 300, epoch: 24 | loss: 0.1833167
	speed: 0.2827s/iter; left time: 7947.2400s
Epoch: 24 cost time: 103.41603064537048
Epoch: 24, Steps: 369 | Train Loss: 0.317 Vali Loss: 0.837 Vali Acc: 0.684 Test Loss: 0.837 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.3976328
	speed: 0.8617s/iter; left time: 24079.8427s
	iters: 200, epoch: 25 | loss: 0.2839679
	speed: 0.2849s/iter; left time: 7934.4182s
	iters: 300, epoch: 25 | loss: 0.1167319
	speed: 0.2853s/iter; left time: 7915.7009s
Epoch: 25 cost time: 103.56811785697937
Epoch: 25, Steps: 369 | Train Loss: 0.297 Vali Loss: 0.758 Vali Acc: 0.682 Test Loss: 0.758 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1124300
	speed: 0.8817s/iter; left time: 24312.7752s
	iters: 200, epoch: 26 | loss: 0.2967558
	speed: 0.2715s/iter; left time: 7459.2071s
	iters: 300, epoch: 26 | loss: 0.3255926
	speed: 0.2833s/iter; left time: 7756.5000s
Epoch: 26 cost time: 103.79434275627136
Epoch: 26, Steps: 369 | Train Loss: 0.267 Vali Loss: 0.881 Vali Acc: 0.686 Test Loss: 0.881 Test Acc: 0.686
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.2257395
	speed: 0.8673s/iter; left time: 23595.7881s
	iters: 200, epoch: 27 | loss: 0.1363432
	speed: 0.2867s/iter; left time: 7771.3699s
	iters: 300, epoch: 27 | loss: 0.2817465
	speed: 0.2862s/iter; left time: 7728.8490s
Epoch: 27 cost time: 105.77187466621399
Epoch: 27, Steps: 369 | Train Loss: 0.236 Vali Loss: 0.933 Vali Acc: 0.681 Test Loss: 0.933 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6929625425652668
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8168142
	speed: 0.3176s/iter; left time: 11687.1077s
	iters: 200, epoch: 1 | loss: 0.3790035
	speed: 0.2866s/iter; left time: 10520.1295s
	iters: 300, epoch: 1 | loss: 1.1990848
	speed: 0.3033s/iter; left time: 11102.6707s
Epoch: 1 cost time: 110.83343625068665
Epoch: 1, Steps: 369 | Train Loss: 0.790 Vali Loss: 1.424 Vali Acc: 0.577 Test Loss: 1.424 Test Acc: 0.577
Validation loss decreased (inf --> -0.577455).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8820359
	speed: 0.9378s/iter; left time: 34164.1501s
	iters: 200, epoch: 2 | loss: 0.7703111
	speed: 0.2934s/iter; left time: 10658.3714s
	iters: 300, epoch: 2 | loss: 1.0840979
	speed: 0.3092s/iter; left time: 11202.6083s
Epoch: 2 cost time: 112.5495662689209
Epoch: 2, Steps: 369 | Train Loss: 0.936 Vali Loss: 1.489 Vali Acc: 0.610 Test Loss: 1.489 Test Acc: 0.610
Validation loss decreased (-0.577455 --> -0.609520).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4196806
	speed: 0.9277s/iter; left time: 33457.0916s
	iters: 200, epoch: 3 | loss: 0.3886520
	speed: 0.3006s/iter; left time: 10811.2186s
	iters: 300, epoch: 3 | loss: 1.2101707
	speed: 0.2977s/iter; left time: 10675.6303s
Epoch: 3 cost time: 108.59744930267334
Epoch: 3, Steps: 369 | Train Loss: 0.946 Vali Loss: 1.539 Vali Acc: 0.647 Test Loss: 1.539 Test Acc: 0.647
Validation loss decreased (-0.609520 --> -0.647260).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9172477
	speed: 0.9113s/iter; left time: 32528.1208s
	iters: 200, epoch: 4 | loss: 0.9281307
	speed: 0.2951s/iter; left time: 10502.2414s
	iters: 300, epoch: 4 | loss: 1.1140317
	speed: 0.2953s/iter; left time: 10480.2033s
Epoch: 4 cost time: 110.63139533996582
Epoch: 4, Steps: 369 | Train Loss: 0.759 Vali Loss: 0.720 Vali Acc: 0.625 Test Loss: 0.720 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5783868
	speed: 0.8993s/iter; left time: 31769.4179s
	iters: 200, epoch: 5 | loss: 0.3902311
	speed: 0.2893s/iter; left time: 10192.1915s
	iters: 300, epoch: 5 | loss: 1.0724593
	speed: 0.2925s/iter; left time: 10273.1083s
Epoch: 5 cost time: 107.06464791297913
Epoch: 5, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.692 Vali Acc: 0.664 Test Loss: 0.692 Test Acc: 0.664
Validation loss decreased (-0.647260 --> -0.664011).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4147488
	speed: 0.8689s/iter; left time: 30372.2207s
	iters: 200, epoch: 6 | loss: 0.3308846
	speed: 0.3019s/iter; left time: 10524.2174s
	iters: 300, epoch: 6 | loss: 0.6132530
	speed: 0.2897s/iter; left time: 10067.0971s
Epoch: 6 cost time: 106.95745015144348
Epoch: 6, Steps: 369 | Train Loss: 0.636 Vali Loss: 0.833 Vali Acc: 0.649 Test Loss: 0.833 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3537504
	speed: 0.8969s/iter; left time: 31020.1199s
	iters: 200, epoch: 7 | loss: 1.2383064
	speed: 0.2670s/iter; left time: 9206.8863s
	iters: 300, epoch: 7 | loss: 0.4839777
	speed: 0.2871s/iter; left time: 9871.0344s
Epoch: 7 cost time: 103.58509087562561
Epoch: 7, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.747 Vali Acc: 0.668 Test Loss: 0.747 Test Acc: 0.668
Validation loss decreased (-0.664011 --> -0.667983).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3913423
	speed: 0.9152s/iter; left time: 31315.2520s
	iters: 200, epoch: 8 | loss: 0.5289766
	speed: 0.2877s/iter; left time: 9816.1425s
	iters: 300, epoch: 8 | loss: 0.1926729
	speed: 0.2854s/iter; left time: 9707.9593s
Epoch: 8 cost time: 108.86325407028198
Epoch: 8, Steps: 369 | Train Loss: 0.506 Vali Loss: 0.725 Vali Acc: 0.680 Test Loss: 0.725 Test Acc: 0.680
Validation loss decreased (-0.667983 --> -0.680469).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4875045
	speed: 0.9436s/iter; left time: 31940.0378s
	iters: 200, epoch: 9 | loss: 0.3344926
	speed: 0.2893s/iter; left time: 9763.7982s
	iters: 300, epoch: 9 | loss: 0.3775493
	speed: 0.2905s/iter; left time: 9776.3056s
Epoch: 9 cost time: 108.97140598297119
Epoch: 9, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.881 Vali Acc: 0.650 Test Loss: 0.881 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6782800
	speed: 0.8880s/iter; left time: 29730.1354s
	iters: 200, epoch: 10 | loss: 0.5131853
	speed: 0.2742s/iter; left time: 9153.3815s
	iters: 300, epoch: 10 | loss: 0.4791088
	speed: 0.2700s/iter; left time: 8985.7777s
Epoch: 10 cost time: 102.13679027557373
Epoch: 10, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.907 Vali Acc: 0.632 Test Loss: 0.907 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4870943
	speed: 0.8956s/iter; left time: 29655.6153s
	iters: 200, epoch: 11 | loss: 0.1977682
	speed: 0.2910s/iter; left time: 9606.1049s
	iters: 300, epoch: 11 | loss: 0.4423663
	speed: 0.2795s/iter; left time: 9199.5168s
Epoch: 11 cost time: 106.3506510257721
Epoch: 11, Steps: 369 | Train Loss: 0.368 Vali Loss: 0.773 Vali Acc: 0.655 Test Loss: 0.773 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4798755
	speed: 0.8878s/iter; left time: 29069.7214s
	iters: 200, epoch: 12 | loss: 0.7032558
	speed: 0.2761s/iter; left time: 9010.9801s
	iters: 300, epoch: 12 | loss: 0.3326275
	speed: 0.2788s/iter; left time: 9071.9256s
Epoch: 12 cost time: 102.83089590072632
Epoch: 12, Steps: 369 | Train Loss: 0.339 Vali Loss: 1.017 Vali Acc: 0.647 Test Loss: 1.017 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1781130
	speed: 0.8434s/iter; left time: 27304.7490s
	iters: 200, epoch: 13 | loss: 0.2768479
	speed: 0.2613s/iter; left time: 8431.6499s
	iters: 300, epoch: 13 | loss: 0.4367104
	speed: 0.2679s/iter; left time: 8617.7156s
Epoch: 13 cost time: 98.89866352081299
Epoch: 13, Steps: 369 | Train Loss: 0.320 Vali Loss: 0.871 Vali Acc: 0.661 Test Loss: 0.871 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5217732
	speed: 0.8709s/iter; left time: 27872.4983s
	iters: 200, epoch: 14 | loss: 0.7480390
	speed: 0.2689s/iter; left time: 8578.1372s
	iters: 300, epoch: 14 | loss: 0.1619665
	speed: 0.2690s/iter; left time: 8554.1080s
Epoch: 14 cost time: 102.32053184509277
Epoch: 14, Steps: 369 | Train Loss: 0.312 Vali Loss: 1.277 Vali Acc: 0.667 Test Loss: 1.277 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3244795
	speed: 0.8869s/iter; left time: 28056.5867s
	iters: 200, epoch: 15 | loss: 0.2197614
	speed: 0.2679s/iter; left time: 8448.2178s
	iters: 300, epoch: 15 | loss: 0.1363678
	speed: 0.2673s/iter; left time: 8402.3796s
Epoch: 15 cost time: 100.32135677337646
Epoch: 15, Steps: 369 | Train Loss: 0.262 Vali Loss: 0.996 Vali Acc: 0.641 Test Loss: 0.996 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.1039424
	speed: 0.8617s/iter; left time: 26941.1587s
	iters: 200, epoch: 16 | loss: 0.2074421
	speed: 0.2800s/iter; left time: 8726.0446s
	iters: 300, epoch: 16 | loss: 0.1129092
	speed: 0.2785s/iter; left time: 8652.1962s
Epoch: 16 cost time: 103.09717345237732
Epoch: 16, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.280 Vali Acc: 0.642 Test Loss: 1.280 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0277503
	speed: 0.8878s/iter; left time: 27429.3196s
	iters: 200, epoch: 17 | loss: 0.0645178
	speed: 0.2681s/iter; left time: 8257.7398s
	iters: 300, epoch: 17 | loss: 0.0405882
	speed: 0.2759s/iter; left time: 8469.3467s
Epoch: 17 cost time: 101.5216908454895
Epoch: 17, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.333 Vali Acc: 0.656 Test Loss: 1.333 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0959097
	speed: 0.8575s/iter; left time: 26178.6175s
	iters: 200, epoch: 18 | loss: 0.2007606
	speed: 0.2741s/iter; left time: 8339.1693s
	iters: 300, epoch: 18 | loss: 0.2554644
	speed: 0.2782s/iter; left time: 8437.4926s
Epoch: 18 cost time: 102.70064973831177
Epoch: 18, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.077 Vali Acc: 0.638 Test Loss: 1.077 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6804767309875142
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6925759
	speed: 0.2976s/iter; left time: 10951.6740s
	iters: 200, epoch: 1 | loss: 0.6931474
	speed: 0.2749s/iter; left time: 10090.6533s
	iters: 300, epoch: 1 | loss: 0.6929623
	speed: 0.2725s/iter; left time: 9973.5968s
Epoch: 1 cost time: 102.60143995285034
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6947297
	speed: 0.8571s/iter; left time: 31226.6471s
	iters: 200, epoch: 2 | loss: 0.6926160
	speed: 0.2792s/iter; left time: 10145.6817s
	iters: 300, epoch: 2 | loss: 0.6931497
	speed: 0.2790s/iter; left time: 10109.8554s
Epoch: 2 cost time: 105.2317795753479
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6950673
	speed: 0.9008s/iter; left time: 32483.7858s
	iters: 200, epoch: 3 | loss: 0.6923032
	speed: 0.2827s/iter; left time: 10167.0503s
	iters: 300, epoch: 3 | loss: 0.6932764
	speed: 0.2833s/iter; left time: 10159.6081s
Epoch: 3 cost time: 105.22946333885193
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6936120
	speed: 0.8882s/iter; left time: 31704.9197s
	iters: 200, epoch: 4 | loss: 0.6931407
	speed: 0.2908s/iter; left time: 10351.1546s
	iters: 300, epoch: 4 | loss: 0.6935374
	speed: 0.2713s/iter; left time: 9628.1629s
Epoch: 4 cost time: 105.75204586982727
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6945597
	speed: 0.9129s/iter; left time: 32249.0207s
	iters: 200, epoch: 5 | loss: 0.6931511
	speed: 0.2883s/iter; left time: 10154.6181s
	iters: 300, epoch: 5 | loss: 0.6935576
	speed: 0.2775s/iter; left time: 9746.8171s
Epoch: 5 cost time: 105.83302021026611
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6925402
	speed: 0.9117s/iter; left time: 31869.3999s
	iters: 200, epoch: 6 | loss: 0.6898014
	speed: 0.2998s/iter; left time: 10451.0732s
	iters: 300, epoch: 6 | loss: 0.6911549
	speed: 0.2906s/iter; left time: 10100.9364s
Epoch: 6 cost time: 109.57059717178345
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6931010
	speed: 0.8876s/iter; left time: 30701.0943s
	iters: 200, epoch: 7 | loss: 0.6961904
	speed: 0.2845s/iter; left time: 9811.2145s
	iters: 300, epoch: 7 | loss: 0.6933246
	speed: 0.2640s/iter; left time: 9077.6031s
Epoch: 7 cost time: 101.24444842338562
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6925237
	speed: 0.8251s/iter; left time: 28233.9195s
	iters: 200, epoch: 8 | loss: 0.6926164
	speed: 0.2720s/iter; left time: 9281.0974s
	iters: 300, epoch: 8 | loss: 0.6931764
	speed: 0.2775s/iter; left time: 9440.0374s
Epoch: 8 cost time: 101.4101300239563
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6923066
	speed: 0.9042s/iter; left time: 30604.9631s
	iters: 200, epoch: 9 | loss: 0.6938330
	speed: 0.2880s/iter; left time: 9720.7105s
	iters: 300, epoch: 9 | loss: 0.6933923
	speed: 0.2907s/iter; left time: 9781.4430s
Epoch: 9 cost time: 107.86990427970886
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6956246
	speed: 0.8834s/iter; left time: 29577.8168s
	iters: 200, epoch: 10 | loss: 0.6931772
	speed: 0.2752s/iter; left time: 9186.5519s
	iters: 300, epoch: 10 | loss: 0.6924097
	speed: 0.2718s/iter; left time: 9043.9765s
Epoch: 10 cost time: 103.71458530426025
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6915466
	speed: 0.8702s/iter; left time: 28813.8856s
	iters: 200, epoch: 11 | loss: 0.6933351
	speed: 0.2869s/iter; left time: 9471.5615s
	iters: 300, epoch: 11 | loss: 0.6931033
	speed: 0.2888s/iter; left time: 9505.7633s
Epoch: 11 cost time: 106.22621202468872
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.6940523
	speed: 0.9006s/iter; left time: 29486.1437s
	iters: 200, epoch: 12 | loss: 0.6930315
	speed: 0.2811s/iter; left time: 9175.8254s
	iters: 300, epoch: 12 | loss: 0.6931472
	speed: 0.2906s/iter; left time: 9457.4581s
Epoch: 12 cost time: 106.57636380195618
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6951465
	speed: 0.8936s/iter; left time: 28928.5185s
	iters: 200, epoch: 13 | loss: 0.6940061
	speed: 0.2711s/iter; left time: 8749.7113s
	iters: 300, epoch: 13 | loss: 0.6929387
	speed: 0.2760s/iter; left time: 8879.6652s
Epoch: 13 cost time: 103.58673882484436
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6931559
	speed: 0.8870s/iter; left time: 28386.1210s
	iters: 200, epoch: 14 | loss: 0.6964583
	speed: 0.2673s/iter; left time: 8527.7328s
	iters: 300, epoch: 14 | loss: 0.6930562
	speed: 0.2775s/iter; left time: 8825.0722s
Epoch: 14 cost time: 104.2753689289093
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6920358
	speed: 0.8975s/iter; left time: 28392.7076s
	iters: 200, epoch: 15 | loss: 0.6924745
	speed: 0.2695s/iter; left time: 8499.3705s
	iters: 300, epoch: 15 | loss: 0.6886575
	speed: 0.2723s/iter; left time: 8559.6442s
Epoch: 15 cost time: 102.17099642753601
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6917953
	speed: 0.8598s/iter; left time: 26883.3372s
	iters: 200, epoch: 16 | loss: 0.6969287
	speed: 0.2949s/iter; left time: 9189.6442s
	iters: 300, epoch: 16 | loss: 0.6922156
	speed: 0.2927s/iter; left time: 9091.5640s
Epoch: 16 cost time: 107.0830225944519
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.6932496
	speed: 0.8796s/iter; left time: 27177.0115s
	iters: 200, epoch: 17 | loss: 0.6931589
	speed: 0.2799s/iter; left time: 8621.1686s
	iters: 300, epoch: 17 | loss: 0.6919978
	speed: 0.2736s/iter; left time: 8397.7248s
Epoch: 17 cost time: 102.79511785507202
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.6935666
	speed: 0.8631s/iter; left time: 26349.0256s
	iters: 200, epoch: 18 | loss: 0.6933746
	speed: 0.2995s/iter; left time: 9112.5219s
	iters: 300, epoch: 18 | loss: 0.6933016
	speed: 0.2862s/iter; left time: 8678.7495s
Epoch: 18 cost time: 106.38534355163574
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 9288194
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7460317
	speed: 0.2890s/iter; left time: 10634.5604s
	iters: 200, epoch: 1 | loss: 0.9546217
	speed: 0.2686s/iter; left time: 9859.4925s
	iters: 300, epoch: 1 | loss: 0.7682399
	speed: 0.2575s/iter; left time: 9425.8996s
Epoch: 1 cost time: 99.80525469779968
Epoch: 1, Steps: 369 | Train Loss: 0.760 Vali Loss: 1.297 Vali Acc: 0.598 Test Loss: 1.297 Test Acc: 0.598
Validation loss decreased (inf --> -0.597887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0350609
	speed: 0.8334s/iter; left time: 30361.9903s
	iters: 200, epoch: 2 | loss: 0.1206112
	speed: 0.2729s/iter; left time: 9913.6990s
	iters: 300, epoch: 2 | loss: 0.5794282
	speed: 0.2776s/iter; left time: 10057.4183s
Epoch: 2 cost time: 101.29122614860535
Epoch: 2, Steps: 369 | Train Loss: 0.828 Vali Loss: 1.862 Vali Acc: 0.618 Test Loss: 1.862 Test Acc: 0.618
Validation loss decreased (-0.597887 --> -0.618029).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6116375
	speed: 0.8801s/iter; left time: 31737.2780s
	iters: 200, epoch: 3 | loss: 0.6739281
	speed: 0.2794s/iter; left time: 10046.5490s
	iters: 300, epoch: 3 | loss: 4.4142380
	speed: 0.2763s/iter; left time: 9907.2637s
Epoch: 3 cost time: 102.59853625297546
Epoch: 3, Steps: 369 | Train Loss: 1.073 Vali Loss: 2.320 Vali Acc: 0.630 Test Loss: 2.320 Test Acc: 0.630
Validation loss decreased (-0.618029 --> -0.630227).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7560977
	speed: 0.8313s/iter; left time: 29671.5342s
	iters: 200, epoch: 4 | loss: 1.0655529
	speed: 0.2565s/iter; left time: 9130.6319s
	iters: 300, epoch: 4 | loss: 1.9437295
	speed: 0.2680s/iter; left time: 9513.6949s
Epoch: 4 cost time: 98.42524695396423
Epoch: 4, Steps: 369 | Train Loss: 1.145 Vali Loss: 2.664 Vali Acc: 0.618 Test Loss: 2.664 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2532545
	speed: 0.8364s/iter; left time: 29546.4855s
	iters: 200, epoch: 5 | loss: 2.0683024
	speed: 0.2689s/iter; left time: 9471.4520s
	iters: 300, epoch: 5 | loss: 1.4243048
	speed: 0.2795s/iter; left time: 9816.1680s
Epoch: 5 cost time: 101.84629440307617
Epoch: 5, Steps: 369 | Train Loss: 1.267 Vali Loss: 2.639 Vali Acc: 0.636 Test Loss: 2.639 Test Acc: 0.636
Validation loss decreased (-0.630227 --> -0.636182).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2412166
	speed: 0.8446s/iter; left time: 29523.8149s
	iters: 200, epoch: 6 | loss: 0.6107717
	speed: 0.2645s/iter; left time: 9218.6572s
	iters: 300, epoch: 6 | loss: 1.2999758
	speed: 0.2703s/iter; left time: 9394.5587s
Epoch: 6 cost time: 98.68141627311707
Epoch: 6, Steps: 369 | Train Loss: 1.400 Vali Loss: 2.418 Vali Acc: 0.624 Test Loss: 2.418 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6672238
	speed: 0.8214s/iter; left time: 28410.5843s
	iters: 200, epoch: 7 | loss: 0.1068599
	speed: 0.2558s/iter; left time: 8820.0900s
	iters: 300, epoch: 7 | loss: 1.0785154
	speed: 0.2652s/iter; left time: 9119.5537s
Epoch: 7 cost time: 96.9423611164093
Epoch: 7, Steps: 369 | Train Loss: 1.303 Vali Loss: 3.325 Vali Acc: 0.646 Test Loss: 3.325 Test Acc: 0.646
Validation loss decreased (-0.636182 --> -0.645540).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2265586
	speed: 0.8380s/iter; left time: 28674.1828s
	iters: 200, epoch: 8 | loss: 0.6097777
	speed: 0.2559s/iter; left time: 8732.0720s
	iters: 300, epoch: 8 | loss: 1.0899692
	speed: 0.2658s/iter; left time: 9042.2379s
Epoch: 8 cost time: 96.76099562644958
Epoch: 8, Steps: 369 | Train Loss: 0.988 Vali Loss: 1.368 Vali Acc: 0.640 Test Loss: 1.368 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6430495
	speed: 0.8164s/iter; left time: 27632.6470s
	iters: 200, epoch: 9 | loss: 0.3450256
	speed: 0.2538s/iter; left time: 8564.1041s
	iters: 300, epoch: 9 | loss: 0.5435600
	speed: 0.2615s/iter; left time: 8800.6815s
Epoch: 9 cost time: 94.48814272880554
Epoch: 9, Steps: 369 | Train Loss: 0.664 Vali Loss: 0.876 Vali Acc: 0.647 Test Loss: 0.876 Test Acc: 0.647
Validation loss decreased (-0.645540 --> -0.646700).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5239029
	speed: 0.8385s/iter; left time: 28074.2950s
	iters: 200, epoch: 10 | loss: 0.2295190
	speed: 0.2651s/iter; left time: 8847.9007s
	iters: 300, epoch: 10 | loss: 0.7924232
	speed: 0.2699s/iter; left time: 8982.7134s
Epoch: 10 cost time: 99.48096776008606
Epoch: 10, Steps: 369 | Train Loss: 0.454 Vali Loss: 1.166 Vali Acc: 0.664 Test Loss: 1.166 Test Acc: 0.664
Validation loss decreased (-0.646700 --> -0.664290).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0806160
	speed: 0.9039s/iter; left time: 29927.5112s
	iters: 200, epoch: 11 | loss: 0.4377657
	speed: 0.2686s/iter; left time: 8865.8217s
	iters: 300, epoch: 11 | loss: 0.4226825
	speed: 0.2515s/iter; left time: 8276.5220s
Epoch: 11 cost time: 98.70873999595642
Epoch: 11, Steps: 369 | Train Loss: 0.381 Vali Loss: 1.005 Vali Acc: 0.670 Test Loss: 1.005 Test Acc: 0.670
Validation loss decreased (-0.664290 --> -0.669683).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9856019
	speed: 0.8473s/iter; left time: 27742.2426s
	iters: 200, epoch: 12 | loss: 0.1990740
	speed: 0.2669s/iter; left time: 8710.5211s
	iters: 300, epoch: 12 | loss: 0.1040858
	speed: 0.2671s/iter; left time: 8691.2087s
Epoch: 12 cost time: 98.82303929328918
Epoch: 12, Steps: 369 | Train Loss: 0.355 Vali Loss: 1.093 Vali Acc: 0.655 Test Loss: 1.093 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0798579
	speed: 0.8577s/iter; left time: 27766.8831s
	iters: 200, epoch: 13 | loss: 0.1621441
	speed: 0.2754s/iter; left time: 8887.5321s
	iters: 300, epoch: 13 | loss: 0.5142084
	speed: 0.2797s/iter; left time: 8997.2107s
Epoch: 13 cost time: 101.92940902709961
Epoch: 13, Steps: 369 | Train Loss: 0.326 Vali Loss: 1.050 Vali Acc: 0.665 Test Loss: 1.050 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.2661684
	speed: 0.8674s/iter; left time: 27759.5163s
	iters: 200, epoch: 14 | loss: 0.1591607
	speed: 0.2896s/iter; left time: 9240.3387s
	iters: 300, epoch: 14 | loss: 0.1855797
	speed: 0.2872s/iter; left time: 9134.0420s
Epoch: 14 cost time: 106.44963669776917
Epoch: 14, Steps: 369 | Train Loss: 0.292 Vali Loss: 1.178 Vali Acc: 0.650 Test Loss: 1.178 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0469198
	speed: 0.8770s/iter; left time: 27745.3603s
	iters: 200, epoch: 15 | loss: 0.1742708
	speed: 0.2846s/iter; left time: 8974.3731s
	iters: 300, epoch: 15 | loss: 0.2975571
	speed: 0.2797s/iter; left time: 8790.8098s
Epoch: 15 cost time: 104.60840129852295
Epoch: 15, Steps: 369 | Train Loss: 0.261 Vali Loss: 1.159 Vali Acc: 0.645 Test Loss: 1.159 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0511879
	speed: 0.9247s/iter; left time: 28910.7351s
	iters: 200, epoch: 16 | loss: 0.1311337
	speed: 0.2791s/iter; left time: 8699.1975s
	iters: 300, epoch: 16 | loss: 0.0428619
	speed: 0.2776s/iter; left time: 8623.5769s
Epoch: 16 cost time: 104.02538681030273
Epoch: 16, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.324 Vali Acc: 0.647 Test Loss: 1.324 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2722290
	speed: 0.8909s/iter; left time: 27526.2613s
	iters: 200, epoch: 17 | loss: 0.0710249
	speed: 0.2751s/iter; left time: 8471.9132s
	iters: 300, epoch: 17 | loss: 0.2484863
	speed: 0.2788s/iter; left time: 8558.7910s
Epoch: 17 cost time: 104.19080948829651
Epoch: 17, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.410 Vali Acc: 0.645 Test Loss: 1.410 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2215107
	speed: 0.9141s/iter; left time: 27905.9451s
	iters: 200, epoch: 18 | loss: 0.4131442
	speed: 0.2996s/iter; left time: 9115.0448s
	iters: 300, epoch: 18 | loss: 0.2873164
	speed: 0.2822s/iter; left time: 8558.2760s
Epoch: 18 cost time: 107.3675889968872
Epoch: 18, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.650 Vali Acc: 0.641 Test Loss: 1.650 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.1074827
	speed: 0.8806s/iter; left time: 26557.4137s
	iters: 200, epoch: 19 | loss: 0.0270027
	speed: 0.2680s/iter; left time: 8055.7366s
	iters: 300, epoch: 19 | loss: 0.0249334
	speed: 0.2836s/iter; left time: 8496.2689s
Epoch: 19 cost time: 102.6041054725647
Epoch: 19, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.904 Vali Acc: 0.638 Test Loss: 1.904 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2721033
	speed: 0.8869s/iter; left time: 26420.1202s
	iters: 200, epoch: 20 | loss: 0.0306526
	speed: 0.2868s/iter; left time: 8514.8764s
	iters: 300, epoch: 20 | loss: 0.2880889
	speed: 0.2921s/iter; left time: 8642.2706s
Epoch: 20 cost time: 108.32783818244934
Epoch: 20, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.753 Vali Acc: 0.642 Test Loss: 1.753 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0060299
	speed: 0.8928s/iter; left time: 26268.1608s
	iters: 200, epoch: 21 | loss: 0.0436305
	speed: 0.2925s/iter; left time: 8577.4488s
	iters: 300, epoch: 21 | loss: 0.1815741
	speed: 0.2743s/iter; left time: 8014.5232s
Epoch: 21 cost time: 103.15256357192993
Epoch: 21, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.817 Vali Acc: 0.659 Test Loss: 1.817 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6696935300794552
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8871324
	speed: 0.2922s/iter; left time: 10752.0065s
	iters: 200, epoch: 1 | loss: 0.8363199
	speed: 0.2825s/iter; left time: 10366.8148s
	iters: 300, epoch: 1 | loss: 1.0044758
	speed: 0.2732s/iter; left time: 9999.7229s
Epoch: 1 cost time: 104.61859822273254
Epoch: 1, Steps: 369 | Train Loss: 0.776 Vali Loss: 1.607 Vali Acc: 0.576 Test Loss: 1.607 Test Acc: 0.576
Validation loss decreased (inf --> -0.576318).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1051757
	speed: 0.9088s/iter; left time: 33108.7722s
	iters: 200, epoch: 2 | loss: 0.0629647
	speed: 0.2891s/iter; left time: 10504.6107s
	iters: 300, epoch: 2 | loss: 0.7020466
	speed: 0.2910s/iter; left time: 10542.6372s
Epoch: 2 cost time: 106.64389848709106
Epoch: 2, Steps: 369 | Train Loss: 0.866 Vali Loss: 1.796 Vali Acc: 0.629 Test Loss: 1.796 Test Acc: 0.629
Validation loss decreased (-0.576318 --> -0.629097).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1653475
	speed: 0.8666s/iter; left time: 31250.9429s
	iters: 200, epoch: 3 | loss: 1.5420382
	speed: 0.2671s/iter; left time: 9606.8067s
	iters: 300, epoch: 3 | loss: 3.6382976
	speed: 0.2595s/iter; left time: 9306.6448s
Epoch: 3 cost time: 97.93334197998047
Epoch: 3, Steps: 369 | Train Loss: 1.015 Vali Loss: 2.462 Vali Acc: 0.613 Test Loss: 2.462 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9561309
	speed: 0.8387s/iter; left time: 29935.8406s
	iters: 200, epoch: 4 | loss: 1.4202306
	speed: 0.2707s/iter; left time: 9636.6937s
	iters: 300, epoch: 4 | loss: 1.7197497
	speed: 0.2738s/iter; left time: 9719.7302s
Epoch: 4 cost time: 100.78081583976746
Epoch: 4, Steps: 369 | Train Loss: 1.191 Vali Loss: 3.447 Vali Acc: 0.619 Test Loss: 3.447 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2865009
	speed: 0.8952s/iter; left time: 31622.2556s
	iters: 200, epoch: 5 | loss: 2.9074419
	speed: 0.2985s/iter; left time: 10515.1853s
	iters: 300, epoch: 5 | loss: 1.2075980
	speed: 0.2919s/iter; left time: 10252.4213s
Epoch: 5 cost time: 108.3754448890686
Epoch: 5, Steps: 369 | Train Loss: 1.332 Vali Loss: 2.593 Vali Acc: 0.605 Test Loss: 2.593 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5781128
	speed: 0.8423s/iter; left time: 29443.2386s
	iters: 200, epoch: 6 | loss: 1.1447812
	speed: 0.2756s/iter; left time: 9606.6177s
	iters: 300, epoch: 6 | loss: 2.6331575
	speed: 0.2745s/iter; left time: 9539.9777s
Epoch: 6 cost time: 102.3375916481018
Epoch: 6, Steps: 369 | Train Loss: 1.308 Vali Loss: 2.680 Vali Acc: 0.606 Test Loss: 2.680 Test Acc: 0.606
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.8138641
	speed: 0.8442s/iter; left time: 29199.4643s
	iters: 200, epoch: 7 | loss: 0.4257393
	speed: 0.2735s/iter; left time: 9431.2367s
	iters: 300, epoch: 7 | loss: 0.5821712
	speed: 0.2882s/iter; left time: 9909.9752s
Epoch: 7 cost time: 104.23175692558289
Epoch: 7, Steps: 369 | Train Loss: 1.205 Vali Loss: 2.495 Vali Acc: 0.628 Test Loss: 2.495 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8143712
	speed: 0.8931s/iter; left time: 30559.9830s
	iters: 200, epoch: 8 | loss: 0.9195958
	speed: 0.2758s/iter; left time: 9408.4857s
	iters: 300, epoch: 8 | loss: 0.3386991
	speed: 0.2853s/iter; left time: 9704.6145s
Epoch: 8 cost time: 104.67574429512024
Epoch: 8, Steps: 369 | Train Loss: 0.767 Vali Loss: 1.177 Vali Acc: 0.642 Test Loss: 1.177 Test Acc: 0.642
Validation loss decreased (-0.629097 --> -0.641589).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4528692
	speed: 0.8801s/iter; left time: 29791.4355s
	iters: 200, epoch: 9 | loss: 1.1100546
	speed: 0.2933s/iter; left time: 9897.9891s
	iters: 300, epoch: 9 | loss: 0.1787556
	speed: 0.2696s/iter; left time: 9073.2231s
Epoch: 9 cost time: 105.8979344367981
Epoch: 9, Steps: 369 | Train Loss: 0.577 Vali Loss: 0.852 Vali Acc: 0.634 Test Loss: 0.852 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.7508410
	speed: 0.9059s/iter; left time: 30328.3419s
	iters: 200, epoch: 10 | loss: 0.3162403
	speed: 0.2956s/iter; left time: 9866.2043s
	iters: 300, epoch: 10 | loss: 0.3428345
	speed: 0.2748s/iter; left time: 9146.3341s
Epoch: 10 cost time: 104.96453309059143
Epoch: 10, Steps: 369 | Train Loss: 0.485 Vali Loss: 0.825 Vali Acc: 0.666 Test Loss: 0.825 Test Acc: 0.666
Validation loss decreased (-0.641589 --> -0.665713).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1454536
	speed: 0.9029s/iter; left time: 29896.4136s
	iters: 200, epoch: 11 | loss: 0.3980789
	speed: 0.2848s/iter; left time: 9400.8467s
	iters: 300, epoch: 11 | loss: 0.3901081
	speed: 0.2925s/iter; left time: 9625.6069s
Epoch: 11 cost time: 107.37099242210388
Epoch: 11, Steps: 369 | Train Loss: 0.417 Vali Loss: 1.179 Vali Acc: 0.649 Test Loss: 1.179 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4653392
	speed: 0.9112s/iter; left time: 29835.4378s
	iters: 200, epoch: 12 | loss: 0.2514095
	speed: 0.2845s/iter; left time: 9285.4599s
	iters: 300, epoch: 12 | loss: 0.4037151
	speed: 0.2869s/iter; left time: 9337.8031s
Epoch: 12 cost time: 106.68214988708496
Epoch: 12, Steps: 369 | Train Loss: 0.389 Vali Loss: 1.004 Vali Acc: 0.667 Test Loss: 1.004 Test Acc: 0.667
Validation loss decreased (-0.665713 --> -0.667130).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2604145
	speed: 0.9053s/iter; left time: 29308.3373s
	iters: 200, epoch: 13 | loss: 0.1291263
	speed: 0.2874s/iter; left time: 9275.4117s
	iters: 300, epoch: 13 | loss: 0.4862727
	speed: 0.2815s/iter; left time: 9055.3093s
Epoch: 13 cost time: 106.00162124633789
Epoch: 13, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.849 Vali Acc: 0.669 Test Loss: 0.849 Test Acc: 0.669
Validation loss decreased (-0.667130 --> -0.669118).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4823262
	speed: 0.9263s/iter; left time: 29646.8070s
	iters: 200, epoch: 14 | loss: 0.0679344
	speed: 0.2707s/iter; left time: 8635.0840s
	iters: 300, epoch: 14 | loss: 0.2150927
	speed: 0.2759s/iter; left time: 8774.3087s
Epoch: 14 cost time: 103.21048593521118
Epoch: 14, Steps: 369 | Train Loss: 0.321 Vali Loss: 1.133 Vali Acc: 0.668 Test Loss: 1.133 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0638112
	speed: 0.8950s/iter; left time: 28312.2209s
	iters: 200, epoch: 15 | loss: 0.1912013
	speed: 0.2804s/iter; left time: 8841.4761s
	iters: 300, epoch: 15 | loss: 0.3284955
	speed: 0.2826s/iter; left time: 8882.0599s
Epoch: 15 cost time: 103.8785195350647
Epoch: 15, Steps: 369 | Train Loss: 0.289 Vali Loss: 1.011 Vali Acc: 0.644 Test Loss: 1.011 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1018647
	speed: 0.8651s/iter; left time: 27048.3564s
	iters: 200, epoch: 16 | loss: 0.2383842
	speed: 0.2871s/iter; left time: 8948.0063s
	iters: 300, epoch: 16 | loss: 0.1168028
	speed: 0.2751s/iter; left time: 8547.1859s
Epoch: 16 cost time: 104.21351385116577
Epoch: 16, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.158 Vali Acc: 0.662 Test Loss: 1.158 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1205405
	speed: 0.9066s/iter; left time: 28010.4149s
	iters: 200, epoch: 17 | loss: 0.3338617
	speed: 0.2724s/iter; left time: 8387.9109s
	iters: 300, epoch: 17 | loss: 0.2013368
	speed: 0.2900s/iter; left time: 8901.7903s
Epoch: 17 cost time: 104.94654631614685
Epoch: 17, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.203 Vali Acc: 0.664 Test Loss: 1.203 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0822059
	speed: 0.9477s/iter; left time: 28930.0847s
	iters: 200, epoch: 18 | loss: 0.1374774
	speed: 0.3126s/iter; left time: 9510.4937s
	iters: 300, epoch: 18 | loss: 0.2212612
	speed: 0.2867s/iter; left time: 8694.6621s
Epoch: 18 cost time: 112.87695789337158
Epoch: 18, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.200 Vali Acc: 0.644 Test Loss: 1.200 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1128065
	speed: 0.9239s/iter; left time: 27865.1645s
	iters: 200, epoch: 19 | loss: 0.2915847
	speed: 0.2822s/iter; left time: 8482.6986s
	iters: 300, epoch: 19 | loss: 0.2378520
	speed: 0.2849s/iter; left time: 8536.4185s
Epoch: 19 cost time: 106.51606583595276
Epoch: 19, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.442 Vali Acc: 0.627 Test Loss: 1.442 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0680606
	speed: 0.8974s/iter; left time: 26732.4111s
	iters: 200, epoch: 20 | loss: 0.0674284
	speed: 0.2849s/iter; left time: 8458.6882s
	iters: 300, epoch: 20 | loss: 0.2665473
	speed: 0.3000s/iter; left time: 8876.7814s
Epoch: 20 cost time: 107.69970440864563
Epoch: 20, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.336 Vali Acc: 0.657 Test Loss: 1.336 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1669818
	speed: 0.9219s/iter; left time: 27122.4057s
	iters: 200, epoch: 21 | loss: 0.3769324
	speed: 0.2970s/iter; left time: 8708.9904s
	iters: 300, epoch: 21 | loss: 0.4687325
	speed: 0.3026s/iter; left time: 8842.6141s
Epoch: 21 cost time: 110.29615783691406
Epoch: 21, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.404 Vali Acc: 0.658 Test Loss: 1.404 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2828616
	speed: 0.9066s/iter; left time: 26338.0542s
	iters: 200, epoch: 22 | loss: 0.1315157
	speed: 0.2946s/iter; left time: 8528.5389s
	iters: 300, epoch: 22 | loss: 0.2033147
	speed: 0.2819s/iter; left time: 8133.0656s
Epoch: 22 cost time: 107.86835312843323
Epoch: 22, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.683 Vali Acc: 0.647 Test Loss: 1.683 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0054840
	speed: 0.9018s/iter; left time: 25866.2286s
	iters: 200, epoch: 23 | loss: 0.0171199
	speed: 0.2780s/iter; left time: 7944.6568s
	iters: 300, epoch: 23 | loss: 0.0739781
	speed: 0.2649s/iter; left time: 7544.7341s
Epoch: 23 cost time: 102.98715543746948
Epoch: 23, Steps: 369 | Train Loss: 0.127 Vali Loss: 2.056 Vali Acc: 0.649 Test Loss: 2.056 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6691259931895573
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8373758
	speed: 0.3196s/iter; left time: 11762.2006s
	iters: 200, epoch: 1 | loss: 1.0910934
	speed: 0.2912s/iter; left time: 10688.4447s
	iters: 300, epoch: 1 | loss: 0.4249338
	speed: 0.2962s/iter; left time: 10840.3389s
Epoch: 1 cost time: 111.94396209716797
Epoch: 1, Steps: 369 | Train Loss: 0.790 Vali Loss: 2.064 Vali Acc: 0.546 Test Loss: 2.064 Test Acc: 0.546
Validation loss decreased (inf --> -0.546234).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1484485
	speed: 0.9106s/iter; left time: 33174.0741s
	iters: 200, epoch: 2 | loss: 0.1164732
	speed: 0.2759s/iter; left time: 10023.8726s
	iters: 300, epoch: 2 | loss: 1.7335172
	speed: 0.2724s/iter; left time: 9867.8995s
Epoch: 2 cost time: 103.74321293830872
Epoch: 2, Steps: 369 | Train Loss: 0.866 Vali Loss: 1.875 Vali Acc: 0.624 Test Loss: 1.875 Test Acc: 0.624
Validation loss decreased (-0.546234 --> -0.624272).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5105368
	speed: 0.9020s/iter; left time: 32529.0300s
	iters: 200, epoch: 3 | loss: 2.3467395
	speed: 0.2899s/iter; left time: 10425.6649s
	iters: 300, epoch: 3 | loss: 3.0574899
	speed: 0.2923s/iter; left time: 10484.2284s
Epoch: 3 cost time: 107.43000626564026
Epoch: 3, Steps: 369 | Train Loss: 1.008 Vali Loss: 2.297 Vali Acc: 0.596 Test Loss: 2.297 Test Acc: 0.596
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3857441
	speed: 0.8930s/iter; left time: 31875.1126s
	iters: 200, epoch: 4 | loss: 0.8599027
	speed: 0.3053s/iter; left time: 10866.7689s
	iters: 300, epoch: 4 | loss: 0.7266078
	speed: 0.3047s/iter; left time: 10813.7497s
Epoch: 4 cost time: 112.40896725654602
Epoch: 4, Steps: 369 | Train Loss: 1.224 Vali Loss: 3.149 Vali Acc: 0.613 Test Loss: 3.149 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8314412
	speed: 0.9068s/iter; left time: 32033.9156s
	iters: 200, epoch: 5 | loss: 0.4950011
	speed: 0.2830s/iter; left time: 9969.1810s
	iters: 300, epoch: 5 | loss: 0.2016132
	speed: 0.2929s/iter; left time: 10288.6229s
Epoch: 5 cost time: 107.34190607070923
Epoch: 5, Steps: 369 | Train Loss: 1.326 Vali Loss: 3.102 Vali Acc: 0.631 Test Loss: 3.102 Test Acc: 0.631
Validation loss decreased (-0.624272 --> -0.630786).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4097778
	speed: 0.9159s/iter; left time: 32017.5182s
	iters: 200, epoch: 6 | loss: 0.8884267
	speed: 0.2920s/iter; left time: 10178.9517s
	iters: 300, epoch: 6 | loss: 1.2013828
	speed: 0.2956s/iter; left time: 10273.4834s
Epoch: 6 cost time: 109.75583815574646
Epoch: 6, Steps: 369 | Train Loss: 1.267 Vali Loss: 1.063 Vali Acc: 0.587 Test Loss: 1.063 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6351532
	speed: 0.9196s/iter; left time: 31805.0147s
	iters: 200, epoch: 7 | loss: 1.0522957
	speed: 0.2853s/iter; left time: 9840.3030s
	iters: 300, epoch: 7 | loss: 0.4035303
	speed: 0.2839s/iter; left time: 9762.9523s
Epoch: 7 cost time: 105.608065366745
Epoch: 7, Steps: 369 | Train Loss: 0.806 Vali Loss: 0.942 Vali Acc: 0.634 Test Loss: 0.942 Test Acc: 0.634
Validation loss decreased (-0.630786 --> -0.633929).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7306551
	speed: 0.8911s/iter; left time: 30491.3606s
	iters: 200, epoch: 8 | loss: 0.5974841
	speed: 0.2905s/iter; left time: 9911.5841s
	iters: 300, epoch: 8 | loss: 0.6143907
	speed: 0.2839s/iter; left time: 9658.6939s
Epoch: 8 cost time: 106.98137831687927
Epoch: 8, Steps: 369 | Train Loss: 0.660 Vali Loss: 0.807 Vali Acc: 0.625 Test Loss: 0.807 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6145343
	speed: 0.8912s/iter; left time: 30166.7766s
	iters: 200, epoch: 9 | loss: 0.5872309
	speed: 0.2838s/iter; left time: 9577.9946s
	iters: 300, epoch: 9 | loss: 0.6909524
	speed: 0.2934s/iter; left time: 9871.3062s
Epoch: 9 cost time: 106.84072923660278
Epoch: 9, Steps: 369 | Train Loss: 0.602 Vali Loss: 0.767 Vali Acc: 0.657 Test Loss: 0.767 Test Acc: 0.657
Validation loss decreased (-0.633929 --> -0.656916).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8307359
	speed: 0.9253s/iter; left time: 30978.5086s
	iters: 200, epoch: 10 | loss: 0.3847334
	speed: 0.2734s/iter; left time: 9127.4222s
	iters: 300, epoch: 10 | loss: 0.5815541
	speed: 0.2786s/iter; left time: 9270.6838s
Epoch: 10 cost time: 104.63121628761292
Epoch: 10, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.874 Vali Acc: 0.661 Test Loss: 0.874 Test Acc: 0.661
Validation loss decreased (-0.656916 --> -0.660604).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3686981
	speed: 0.9065s/iter; left time: 30015.0641s
	iters: 200, epoch: 11 | loss: 0.4096808
	speed: 0.2793s/iter; left time: 9219.2364s
	iters: 300, epoch: 11 | loss: 0.5559877
	speed: 0.2738s/iter; left time: 9010.0651s
Epoch: 11 cost time: 103.593181848526
Epoch: 11, Steps: 369 | Train Loss: 0.515 Vali Loss: 0.813 Vali Acc: 0.653 Test Loss: 0.813 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4248206
	speed: 0.8810s/iter; left time: 28847.2430s
	iters: 200, epoch: 12 | loss: 0.4536085
	speed: 0.2832s/iter; left time: 9243.0561s
	iters: 300, epoch: 12 | loss: 0.6798016
	speed: 0.2758s/iter; left time: 8974.0122s
Epoch: 12 cost time: 103.71005988121033
Epoch: 12, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.930 Vali Acc: 0.657 Test Loss: 0.930 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3621812
	speed: 0.8731s/iter; left time: 28265.6503s
	iters: 200, epoch: 13 | loss: 0.2052445
	speed: 0.2838s/iter; left time: 9157.7171s
	iters: 300, epoch: 13 | loss: 0.5416861
	speed: 0.2822s/iter; left time: 9079.3238s
Epoch: 13 cost time: 105.37198448181152
Epoch: 13, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.927 Vali Acc: 0.670 Test Loss: 0.927 Test Acc: 0.670
Validation loss decreased (-0.660604 --> -0.669968).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1865351
	speed: 0.8999s/iter; left time: 28800.3667s
	iters: 200, epoch: 14 | loss: 0.4369010
	speed: 0.2800s/iter; left time: 8934.3195s
	iters: 300, epoch: 14 | loss: 0.3952702
	speed: 0.2770s/iter; left time: 8808.3549s
Epoch: 14 cost time: 104.02063417434692
Epoch: 14, Steps: 369 | Train Loss: 0.411 Vali Loss: 1.013 Vali Acc: 0.667 Test Loss: 1.013 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1677547
	speed: 0.9143s/iter; left time: 28925.3965s
	iters: 200, epoch: 15 | loss: 0.2989833
	speed: 0.2839s/iter; left time: 8952.6435s
	iters: 300, epoch: 15 | loss: 0.2564290
	speed: 0.2903s/iter; left time: 9125.5180s
Epoch: 15 cost time: 106.75855016708374
Epoch: 15, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.930 Vali Acc: 0.652 Test Loss: 0.930 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1756669
	speed: 0.9087s/iter; left time: 28410.9354s
	iters: 200, epoch: 16 | loss: 0.1239914
	speed: 0.2768s/iter; left time: 8626.6115s
	iters: 300, epoch: 16 | loss: 0.0827018
	speed: 0.2825s/iter; left time: 8774.7799s
Epoch: 16 cost time: 103.50147271156311
Epoch: 16, Steps: 369 | Train Loss: 0.345 Vali Loss: 1.027 Vali Acc: 0.661 Test Loss: 1.027 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3647555
	speed: 0.8501s/iter; left time: 26265.2945s
	iters: 200, epoch: 17 | loss: 0.2222411
	speed: 0.2804s/iter; left time: 8636.6571s
	iters: 300, epoch: 17 | loss: 0.3599463
	speed: 0.2774s/iter; left time: 8514.0510s
Epoch: 17 cost time: 104.79719281196594
Epoch: 17, Steps: 369 | Train Loss: 0.327 Vali Loss: 1.005 Vali Acc: 0.655 Test Loss: 1.005 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2100667
	speed: 0.8819s/iter; left time: 26923.0371s
	iters: 200, epoch: 18 | loss: 0.2523499
	speed: 0.2935s/iter; left time: 8932.0751s
	iters: 300, epoch: 18 | loss: 0.3041417
	speed: 0.2878s/iter; left time: 8729.1432s
Epoch: 18 cost time: 105.75740647315979
Epoch: 18, Steps: 369 | Train Loss: 0.305 Vali Loss: 1.029 Vali Acc: 0.666 Test Loss: 1.029 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.2973249
	speed: 0.8790s/iter; left time: 26508.7467s
	iters: 200, epoch: 19 | loss: 0.1458424
	speed: 0.2777s/iter; left time: 8346.5197s
	iters: 300, epoch: 19 | loss: 0.3194373
	speed: 0.2705s/iter; left time: 8104.7048s
Epoch: 19 cost time: 102.2851824760437
Epoch: 19, Steps: 369 | Train Loss: 0.285 Vali Loss: 1.088 Vali Acc: 0.642 Test Loss: 1.088 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1623838
	speed: 0.9090s/iter; left time: 27079.3572s
	iters: 200, epoch: 20 | loss: 0.3445157
	speed: 0.2813s/iter; left time: 8350.7839s
	iters: 300, epoch: 20 | loss: 0.7325874
	speed: 0.2727s/iter; left time: 8067.8574s
Epoch: 20 cost time: 105.06329393386841
Epoch: 20, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.062 Vali Acc: 0.657 Test Loss: 1.062 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1476836
	speed: 0.9228s/iter; left time: 27151.1694s
	iters: 200, epoch: 21 | loss: 0.1809808
	speed: 0.2905s/iter; left time: 8516.3335s
	iters: 300, epoch: 21 | loss: 0.1100442
	speed: 0.2713s/iter; left time: 7928.1289s
Epoch: 21 cost time: 107.12387108802795
Epoch: 21, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.091 Vali Acc: 0.663 Test Loss: 1.091 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4127460
	speed: 0.8684s/iter; left time: 25228.2715s
	iters: 200, epoch: 22 | loss: 0.1235743
	speed: 0.2771s/iter; left time: 8022.4952s
	iters: 300, epoch: 22 | loss: 0.2257429
	speed: 0.2776s/iter; left time: 8008.4034s
Epoch: 22 cost time: 103.15430283546448
Epoch: 22, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.247 Vali Acc: 0.660 Test Loss: 1.247 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2868080
	speed: 0.9035s/iter; left time: 25913.8334s
	iters: 200, epoch: 23 | loss: 0.0962547
	speed: 0.2980s/iter; left time: 8518.7192s
	iters: 300, epoch: 23 | loss: 0.2023809
	speed: 0.2916s/iter; left time: 8304.5109s
Epoch: 23 cost time: 109.43505835533142
Epoch: 23, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.449 Vali Acc: 0.652 Test Loss: 1.449 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6699772985244041
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7894014
	speed: 0.3329s/iter; left time: 12252.1188s
	iters: 200, epoch: 1 | loss: 1.1626669
	speed: 0.2951s/iter; left time: 10828.6454s
	iters: 300, epoch: 1 | loss: 0.4968044
	speed: 0.2879s/iter; left time: 10538.4809s
Epoch: 1 cost time: 110.81882071495056
Epoch: 1, Steps: 369 | Train Loss: 0.810 Vali Loss: 1.577 Vali Acc: 0.568 Test Loss: 1.577 Test Acc: 0.568
Validation loss decreased (inf --> -0.568089).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1819865
	speed: 0.8663s/iter; left time: 31560.4162s
	iters: 200, epoch: 2 | loss: 0.1332728
	speed: 0.2858s/iter; left time: 10383.1431s
	iters: 300, epoch: 2 | loss: 1.2389303
	speed: 0.2779s/iter; left time: 10070.3142s
Epoch: 2 cost time: 105.27361965179443
Epoch: 2, Steps: 369 | Train Loss: 0.947 Vali Loss: 2.109 Vali Acc: 0.625 Test Loss: 2.109 Test Acc: 0.625
Validation loss decreased (-0.568089 --> -0.625405).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5898377
	speed: 0.8727s/iter; left time: 31473.8350s
	iters: 200, epoch: 3 | loss: 3.6926174
	speed: 0.2745s/iter; left time: 9870.5036s
	iters: 300, epoch: 3 | loss: 5.0801721
	speed: 0.2921s/iter; left time: 10475.5494s
Epoch: 3 cost time: 106.42022323608398
Epoch: 3, Steps: 369 | Train Loss: 1.072 Vali Loss: 2.551 Vali Acc: 0.619 Test Loss: 2.551 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0735737
	speed: 0.9100s/iter; left time: 32482.6879s
	iters: 200, epoch: 4 | loss: 1.1006432
	speed: 0.2768s/iter; left time: 9853.3239s
	iters: 300, epoch: 4 | loss: 1.2987396
	speed: 0.2856s/iter; left time: 10135.4881s
Epoch: 4 cost time: 106.90689730644226
Epoch: 4, Steps: 369 | Train Loss: 1.184 Vali Loss: 3.007 Vali Acc: 0.609 Test Loss: 3.007 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4610172
	speed: 0.9129s/iter; left time: 32247.9249s
	iters: 200, epoch: 5 | loss: 1.5416806
	speed: 0.2833s/iter; left time: 9977.5944s
	iters: 300, epoch: 5 | loss: 1.2811710
	speed: 0.2865s/iter; left time: 10064.6834s
Epoch: 5 cost time: 105.16221237182617
Epoch: 5, Steps: 369 | Train Loss: 1.318 Vali Loss: 2.942 Vali Acc: 0.639 Test Loss: 2.942 Test Acc: 0.639
Validation loss decreased (-0.625405 --> -0.639017).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1799887
	speed: 0.9104s/iter; left time: 31823.3550s
	iters: 200, epoch: 6 | loss: 1.2261871
	speed: 0.2958s/iter; left time: 10308.7686s
	iters: 300, epoch: 6 | loss: 2.0507383
	speed: 0.2937s/iter; left time: 10207.9619s
Epoch: 6 cost time: 109.88129091262817
Epoch: 6, Steps: 369 | Train Loss: 1.430 Vali Loss: 2.214 Vali Acc: 0.644 Test Loss: 2.214 Test Acc: 0.644
Validation loss decreased (-0.639017 --> -0.644132).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5956543
	speed: 0.9141s/iter; left time: 31615.7387s
	iters: 200, epoch: 7 | loss: 1.0899671
	speed: 0.2762s/iter; left time: 9525.0902s
	iters: 300, epoch: 7 | loss: 0.4826016
	speed: 0.2880s/iter; left time: 9904.3382s
Epoch: 7 cost time: 106.12083196640015
Epoch: 7, Steps: 369 | Train Loss: 0.862 Vali Loss: 1.155 Vali Acc: 0.658 Test Loss: 1.155 Test Acc: 0.658
Validation loss decreased (-0.644132 --> -0.658047).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7663767
	speed: 0.8683s/iter; left time: 29711.1602s
	iters: 200, epoch: 8 | loss: 0.5765734
	speed: 0.2742s/iter; left time: 9356.6864s
	iters: 300, epoch: 8 | loss: 0.2324409
	speed: 0.2671s/iter; left time: 9085.8191s
Epoch: 8 cost time: 102.31386947631836
Epoch: 8, Steps: 369 | Train Loss: 0.519 Vali Loss: 0.889 Vali Acc: 0.663 Test Loss: 0.889 Test Acc: 0.663
Validation loss decreased (-0.658047 --> -0.662590).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5052509
	speed: 0.8536s/iter; left time: 28892.0410s
	iters: 200, epoch: 9 | loss: 0.6132389
	speed: 0.2868s/iter; left time: 9680.2953s
	iters: 300, epoch: 9 | loss: 0.5295036
	speed: 0.2776s/iter; left time: 9340.6155s
Epoch: 9 cost time: 104.9980115890503
Epoch: 9, Steps: 369 | Train Loss: 0.471 Vali Loss: 0.836 Vali Acc: 0.643 Test Loss: 0.836 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3308758
	speed: 0.8696s/iter; left time: 29114.2451s
	iters: 200, epoch: 10 | loss: 0.3554093
	speed: 0.2801s/iter; left time: 9348.9297s
	iters: 300, epoch: 10 | loss: 0.3579278
	speed: 0.2794s/iter; left time: 9299.9732s
Epoch: 10 cost time: 102.68093609809875
Epoch: 10, Steps: 369 | Train Loss: 0.426 Vali Loss: 1.239 Vali Acc: 0.657 Test Loss: 1.239 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2013124
	speed: 0.8926s/iter; left time: 29553.5958s
	iters: 200, epoch: 11 | loss: 0.4000759
	speed: 0.2811s/iter; left time: 9279.9764s
	iters: 300, epoch: 11 | loss: 0.3314168
	speed: 0.2732s/iter; left time: 8991.9750s
Epoch: 11 cost time: 104.02856397628784
Epoch: 11, Steps: 369 | Train Loss: 0.353 Vali Loss: 0.957 Vali Acc: 0.673 Test Loss: 0.957 Test Acc: 0.673
Validation loss decreased (-0.662590 --> -0.672805).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5569577
	speed: 0.9144s/iter; left time: 29940.8143s
	iters: 200, epoch: 12 | loss: 0.2493134
	speed: 0.2910s/iter; left time: 9499.6049s
	iters: 300, epoch: 12 | loss: 0.4333826
	speed: 0.2882s/iter; left time: 9380.1612s
Epoch: 12 cost time: 107.40516066551208
Epoch: 12, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.046 Vali Acc: 0.660 Test Loss: 1.046 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3612664
	speed: 0.8579s/iter; left time: 27774.3400s
	iters: 200, epoch: 13 | loss: 0.1440903
	speed: 0.2827s/iter; left time: 9124.3818s
	iters: 300, epoch: 13 | loss: 0.4814599
	speed: 0.2656s/iter; left time: 8543.6191s
Epoch: 13 cost time: 101.18002700805664
Epoch: 13, Steps: 369 | Train Loss: 0.379 Vali Loss: 0.996 Vali Acc: 0.634 Test Loss: 0.996 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.2702420
	speed: 0.8647s/iter; left time: 27674.0785s
	iters: 200, epoch: 14 | loss: 0.0677840
	speed: 0.2751s/iter; left time: 8777.0022s
	iters: 300, epoch: 14 | loss: 0.2770039
	speed: 0.2774s/iter; left time: 8822.3076s
Epoch: 14 cost time: 103.57655596733093
Epoch: 14, Steps: 369 | Train Loss: 0.372 Vali Loss: 1.314 Vali Acc: 0.644 Test Loss: 1.314 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2693901
	speed: 0.9132s/iter; left time: 28890.0153s
	iters: 200, epoch: 15 | loss: 0.1285479
	speed: 0.2812s/iter; left time: 8868.2401s
	iters: 300, epoch: 15 | loss: 0.1044227
	speed: 0.2756s/iter; left time: 8662.0315s
Epoch: 15 cost time: 104.69250679016113
Epoch: 15, Steps: 369 | Train Loss: 0.313 Vali Loss: 1.116 Vali Acc: 0.652 Test Loss: 1.116 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1368856
	speed: 0.8877s/iter; left time: 27756.2049s
	iters: 200, epoch: 16 | loss: 0.1340348
	speed: 0.2791s/iter; left time: 8698.8623s
	iters: 300, epoch: 16 | loss: 0.2125744
	speed: 0.2747s/iter; left time: 8532.5732s
Epoch: 16 cost time: 104.58675909042358
Epoch: 16, Steps: 369 | Train Loss: 0.272 Vali Loss: 1.419 Vali Acc: 0.646 Test Loss: 1.419 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2593650
	speed: 0.8653s/iter; left time: 26734.0057s
	iters: 200, epoch: 17 | loss: 0.2331980
	speed: 0.2790s/iter; left time: 8591.2434s
	iters: 300, epoch: 17 | loss: 0.2548828
	speed: 0.2792s/iter; left time: 8569.0938s
Epoch: 17 cost time: 103.52441430091858
Epoch: 17, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.237 Vali Acc: 0.650 Test Loss: 1.237 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2310096
	speed: 0.8707s/iter; left time: 26580.4178s
	iters: 200, epoch: 18 | loss: 0.3089319
	speed: 0.2795s/iter; left time: 8504.6213s
	iters: 300, epoch: 18 | loss: 0.1600845
	speed: 0.2794s/iter; left time: 8472.3673s
Epoch: 18 cost time: 103.20906972885132
Epoch: 18, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.191 Vali Acc: 0.648 Test Loss: 1.191 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.7389733
	speed: 0.9177s/iter; left time: 27678.2740s
	iters: 200, epoch: 19 | loss: 0.0348951
	speed: 0.2755s/iter; left time: 8282.2034s
	iters: 300, epoch: 19 | loss: 0.1764299
	speed: 0.2919s/iter; left time: 8745.0921s
Epoch: 19 cost time: 105.98027896881104
Epoch: 19, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.588 Vali Acc: 0.649 Test Loss: 1.588 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0429122
	speed: 0.8779s/iter; left time: 26151.8419s
	iters: 200, epoch: 20 | loss: 0.1596401
	speed: 0.2712s/iter; left time: 8050.6877s
	iters: 300, epoch: 20 | loss: 0.0680341
	speed: 0.2857s/iter; left time: 8455.0356s
Epoch: 20 cost time: 104.4313530921936
Epoch: 20, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.508 Vali Acc: 0.644 Test Loss: 1.508 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0675872
	speed: 0.8683s/iter; left time: 25547.2404s
	iters: 200, epoch: 21 | loss: 0.2200015
	speed: 0.2662s/iter; left time: 7805.8417s
	iters: 300, epoch: 21 | loss: 0.1262789
	speed: 0.2760s/iter; left time: 8064.5454s
Epoch: 21 cost time: 101.55075812339783
Epoch: 21, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.465 Vali Acc: 0.643 Test Loss: 1.465 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9591886
	speed: 0.2939s/iter; left time: 10814.3405s
	iters: 200, epoch: 1 | loss: 0.8202572
	speed: 0.2629s/iter; left time: 9647.8040s
	iters: 300, epoch: 1 | loss: 0.8295959
	speed: 0.2720s/iter; left time: 9955.0927s
Epoch: 1 cost time: 101.79169583320618
Epoch: 1, Steps: 369 | Train Loss: 0.798 Vali Loss: 1.743 Vali Acc: 0.559 Test Loss: 1.743 Test Acc: 0.559
Validation loss decreased (inf --> -0.559006).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2886807
	speed: 0.8222s/iter; left time: 29952.6603s
	iters: 200, epoch: 2 | loss: 0.1341682
	speed: 0.2712s/iter; left time: 9854.5615s
	iters: 300, epoch: 2 | loss: 1.2215414
	speed: 0.2759s/iter; left time: 9997.6194s
Epoch: 2 cost time: 100.87712717056274
Epoch: 2, Steps: 369 | Train Loss: 0.926 Vali Loss: 1.720 Vali Acc: 0.654 Test Loss: 1.720 Test Acc: 0.654
Validation loss decreased (-0.559006 --> -0.653785).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2626546
	speed: 0.8741s/iter; left time: 31523.6315s
	iters: 200, epoch: 3 | loss: 2.1370864
	speed: 0.2857s/iter; left time: 10273.5865s
	iters: 300, epoch: 3 | loss: 4.5511684
	speed: 0.2842s/iter; left time: 10193.8619s
Epoch: 3 cost time: 105.53159809112549
Epoch: 3, Steps: 369 | Train Loss: 1.070 Vali Loss: 2.031 Vali Acc: 0.628 Test Loss: 2.031 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2364011
	speed: 0.8554s/iter; left time: 30533.8038s
	iters: 200, epoch: 4 | loss: 0.8955328
	speed: 0.2746s/iter; left time: 9773.8104s
	iters: 300, epoch: 4 | loss: 0.9895162
	speed: 0.2734s/iter; left time: 9704.4370s
Epoch: 4 cost time: 101.77006697654724
Epoch: 4, Steps: 369 | Train Loss: 1.124 Vali Loss: 2.784 Vali Acc: 0.641 Test Loss: 2.784 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0953062
	speed: 0.8582s/iter; left time: 30317.1655s
	iters: 200, epoch: 5 | loss: 1.0266387
	speed: 0.2690s/iter; left time: 9476.1924s
	iters: 300, epoch: 5 | loss: 2.6412411
	speed: 0.2853s/iter; left time: 10022.4253s
Epoch: 5 cost time: 104.23222923278809
Epoch: 5, Steps: 369 | Train Loss: 1.279 Vali Loss: 2.478 Vali Acc: 0.623 Test Loss: 2.478 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9494184
	speed: 0.8952s/iter; left time: 31292.7548s
	iters: 200, epoch: 6 | loss: 1.6003520
	speed: 0.2752s/iter; left time: 9593.2395s
	iters: 300, epoch: 6 | loss: 1.3042423
	speed: 0.2759s/iter; left time: 9589.8777s
Epoch: 6 cost time: 104.81021118164062
Epoch: 6, Steps: 369 | Train Loss: 1.547 Vali Loss: 2.417 Vali Acc: 0.645 Test Loss: 2.417 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.1336033
	speed: 0.8810s/iter; left time: 30471.0826s
	iters: 200, epoch: 7 | loss: 0.8727704
	speed: 0.2810s/iter; left time: 9690.8175s
	iters: 300, epoch: 7 | loss: 1.3560822
	speed: 0.2719s/iter; left time: 9349.0215s
Epoch: 7 cost time: 103.65469312667847
Epoch: 7, Steps: 369 | Train Loss: 1.206 Vali Loss: 1.345 Vali Acc: 0.676 Test Loss: 1.345 Test Acc: 0.676
Validation loss decreased (-0.653785 --> -0.675923).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6382574
	speed: 0.9058s/iter; left time: 30995.3931s
	iters: 200, epoch: 8 | loss: 0.4227114
	speed: 0.2810s/iter; left time: 9587.4224s
	iters: 300, epoch: 8 | loss: 0.2785369
	speed: 0.2646s/iter; left time: 9000.9832s
Epoch: 8 cost time: 104.12291431427002
Epoch: 8, Steps: 369 | Train Loss: 0.755 Vali Loss: 0.926 Vali Acc: 0.673 Test Loss: 0.926 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6907918
	speed: 0.9020s/iter; left time: 30532.8375s
	iters: 200, epoch: 9 | loss: 0.3777117
	speed: 0.2781s/iter; left time: 9385.2542s
	iters: 300, epoch: 9 | loss: 0.6524856
	speed: 0.2725s/iter; left time: 9169.2294s
Epoch: 9 cost time: 104.70113611221313
Epoch: 9, Steps: 369 | Train Loss: 0.573 Vali Loss: 0.795 Vali Acc: 0.656 Test Loss: 0.795 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5384140
	speed: 0.9236s/iter; left time: 30920.6124s
	iters: 200, epoch: 10 | loss: 0.4700889
	speed: 0.2861s/iter; left time: 9550.8866s
	iters: 300, epoch: 10 | loss: 0.4747939
	speed: 0.2835s/iter; left time: 9433.6170s
Epoch: 10 cost time: 106.5812635421753
Epoch: 10, Steps: 369 | Train Loss: 0.398 Vali Loss: 1.105 Vali Acc: 0.658 Test Loss: 1.105 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2164996
	speed: 0.9062s/iter; left time: 30005.3780s
	iters: 200, epoch: 11 | loss: 0.3654446
	speed: 0.2747s/iter; left time: 9067.3834s
	iters: 300, epoch: 11 | loss: 0.3614015
	speed: 0.2769s/iter; left time: 9113.9780s
Epoch: 11 cost time: 104.66673707962036
Epoch: 11, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.893 Vali Acc: 0.678 Test Loss: 0.893 Test Acc: 0.678
Validation loss decreased (-0.675923 --> -0.678198).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4772914
	speed: 0.9135s/iter; left time: 29909.5074s
	iters: 200, epoch: 12 | loss: 0.2635452
	speed: 0.2914s/iter; left time: 9512.4026s
	iters: 300, epoch: 12 | loss: 0.3799273
	speed: 0.2774s/iter; left time: 9027.1837s
Epoch: 12 cost time: 106.23965668678284
Epoch: 12, Steps: 369 | Train Loss: 0.361 Vali Loss: 0.858 Vali Acc: 0.673 Test Loss: 0.858 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1994067
	speed: 0.9060s/iter; left time: 29330.2754s
	iters: 200, epoch: 13 | loss: 0.1922319
	speed: 0.2817s/iter; left time: 9090.9769s
	iters: 300, epoch: 13 | loss: 0.2976404
	speed: 0.2705s/iter; left time: 8703.9775s
Epoch: 13 cost time: 103.67152547836304
Epoch: 13, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.105 Vali Acc: 0.662 Test Loss: 1.105 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0715865
	speed: 0.8600s/iter; left time: 27522.1379s
	iters: 200, epoch: 14 | loss: 0.1683118
	speed: 0.2782s/iter; left time: 8877.1549s
	iters: 300, epoch: 14 | loss: 0.2822369
	speed: 0.2723s/iter; left time: 8658.6769s
Epoch: 14 cost time: 101.84861779212952
Epoch: 14, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.194 Vali Acc: 0.665 Test Loss: 1.194 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0666427
	speed: 0.8895s/iter; left time: 28139.2160s
	iters: 200, epoch: 15 | loss: 0.2031577
	speed: 0.2754s/iter; left time: 8685.3868s
	iters: 300, epoch: 15 | loss: 0.1192946
	speed: 0.2731s/iter; left time: 8584.1860s
Epoch: 15 cost time: 102.0302324295044
Epoch: 15, Steps: 369 | Train Loss: 0.220 Vali Loss: 0.879 Vali Acc: 0.648 Test Loss: 0.879 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0963889
	speed: 0.8682s/iter; left time: 27144.9831s
	iters: 200, epoch: 16 | loss: 0.1737207
	speed: 0.2757s/iter; left time: 8591.8000s
	iters: 300, epoch: 16 | loss: 0.0486719
	speed: 0.2628s/iter; left time: 8165.4246s
Epoch: 16 cost time: 100.80594539642334
Epoch: 16, Steps: 369 | Train Loss: 0.208 Vali Loss: 1.616 Vali Acc: 0.654 Test Loss: 1.616 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1989465
	speed: 0.9242s/iter; left time: 28555.6757s
	iters: 200, epoch: 17 | loss: 0.0732952
	speed: 0.2865s/iter; left time: 8821.9637s
	iters: 300, epoch: 17 | loss: 0.3559015
	speed: 0.2653s/iter; left time: 8145.1946s
Epoch: 17 cost time: 105.06045389175415
Epoch: 17, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.138 Vali Acc: 0.645 Test Loss: 1.138 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2109129
	speed: 0.8546s/iter; left time: 26090.6585s
	iters: 200, epoch: 18 | loss: 0.1088447
	speed: 0.2784s/iter; left time: 8472.1422s
	iters: 300, epoch: 18 | loss: 0.0802707
	speed: 0.2722s/iter; left time: 8256.3275s
Epoch: 18 cost time: 101.29785180091858
Epoch: 18, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.483 Vali Acc: 0.650 Test Loss: 1.483 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0710888
	speed: 0.9231s/iter; left time: 27838.5667s
	iters: 200, epoch: 19 | loss: 0.0293080
	speed: 0.2761s/iter; left time: 8298.4370s
	iters: 300, epoch: 19 | loss: 0.4251973
	speed: 0.2757s/iter; left time: 8260.2509s
Epoch: 19 cost time: 104.5359959602356
Epoch: 19, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.712 Vali Acc: 0.635 Test Loss: 1.712 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1410897
	speed: 0.8531s/iter; left time: 25413.8668s
	iters: 200, epoch: 20 | loss: 0.0702282
	speed: 0.2871s/iter; left time: 8524.5746s
	iters: 300, epoch: 20 | loss: 0.1497720
	speed: 0.2719s/iter; left time: 8045.1001s
Epoch: 20 cost time: 103.34628629684448
Epoch: 20, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.363 Vali Acc: 0.647 Test Loss: 1.363 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0065636
	speed: 0.8945s/iter; left time: 26316.1350s
	iters: 200, epoch: 21 | loss: 0.0069038
	speed: 0.2889s/iter; left time: 8471.8277s
	iters: 300, epoch: 21 | loss: 0.1153436
	speed: 0.2842s/iter; left time: 8303.3613s
Epoch: 21 cost time: 107.53971862792969
Epoch: 21, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.720 Vali Acc: 0.645 Test Loss: 1.720 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9120855
	speed: 0.2976s/iter; left time: 10951.9107s
	iters: 200, epoch: 1 | loss: 0.9288013
	speed: 0.2769s/iter; left time: 10163.5658s
	iters: 300, epoch: 1 | loss: 0.4672261
	speed: 0.2773s/iter; left time: 10149.8984s
Epoch: 1 cost time: 104.77652621269226
Epoch: 1, Steps: 369 | Train Loss: 0.786 Vali Loss: 1.524 Vali Acc: 0.604 Test Loss: 1.524 Test Acc: 0.604
Validation loss decreased (inf --> -0.604412).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2273707
	speed: 0.8704s/iter; left time: 31709.2871s
	iters: 200, epoch: 2 | loss: 0.0865342
	speed: 0.2985s/iter; left time: 10843.3986s
	iters: 300, epoch: 2 | loss: 1.8908317
	speed: 0.2933s/iter; left time: 10625.2578s
Epoch: 2 cost time: 108.5312237739563
Epoch: 2, Steps: 369 | Train Loss: 0.900 Vali Loss: 1.962 Vali Acc: 0.627 Test Loss: 1.962 Test Acc: 0.627
Validation loss decreased (-0.604412 --> -0.626825).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1961508
	speed: 0.9236s/iter; left time: 33308.4545s
	iters: 200, epoch: 3 | loss: 0.6217862
	speed: 0.2885s/iter; left time: 10373.5404s
	iters: 300, epoch: 3 | loss: 4.0074596
	speed: 0.2824s/iter; left time: 10126.2944s
Epoch: 3 cost time: 104.52240872383118
Epoch: 3, Steps: 369 | Train Loss: 1.070 Vali Loss: 2.251 Vali Acc: 0.627 Test Loss: 2.251 Test Acc: 0.627
Validation loss decreased (-0.626825 --> -0.627390).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6209927
	speed: 0.8743s/iter; left time: 31208.7789s
	iters: 200, epoch: 4 | loss: 0.9302480
	speed: 0.2899s/iter; left time: 10319.5211s
	iters: 300, epoch: 4 | loss: 0.9855148
	speed: 0.2813s/iter; left time: 9985.1896s
Epoch: 4 cost time: 106.1344952583313
Epoch: 4, Steps: 369 | Train Loss: 0.919 Vali Loss: 1.589 Vali Acc: 0.636 Test Loss: 1.589 Test Acc: 0.636
Validation loss decreased (-0.627390 --> -0.635625).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8655022
	speed: 0.8908s/iter; left time: 31466.5595s
	iters: 200, epoch: 5 | loss: 0.6142420
	speed: 0.2894s/iter; left time: 10193.3816s
	iters: 300, epoch: 5 | loss: 0.6576686
	speed: 0.2866s/iter; left time: 10066.3313s
Epoch: 5 cost time: 106.76390385627747
Epoch: 5, Steps: 369 | Train Loss: 0.778 Vali Loss: 0.753 Vali Acc: 0.643 Test Loss: 0.753 Test Acc: 0.643
Validation loss decreased (-0.635625 --> -0.643296).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5984242
	speed: 0.8707s/iter; left time: 30436.6517s
	iters: 200, epoch: 6 | loss: 0.3310500
	speed: 0.2917s/iter; left time: 10168.8420s
	iters: 300, epoch: 6 | loss: 1.0021443
	speed: 0.2865s/iter; left time: 9956.0093s
Epoch: 6 cost time: 106.6150074005127
Epoch: 6, Steps: 369 | Train Loss: 0.689 Vali Loss: 1.037 Vali Acc: 0.627 Test Loss: 1.037 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2807694
	speed: 0.8697s/iter; left time: 30080.5565s
	iters: 200, epoch: 7 | loss: 0.7511362
	speed: 0.2729s/iter; left time: 9410.2262s
	iters: 300, epoch: 7 | loss: 0.5568066
	speed: 0.2708s/iter; left time: 9312.9660s
Epoch: 7 cost time: 101.23060917854309
Epoch: 7, Steps: 369 | Train Loss: 0.758 Vali Loss: 0.809 Vali Acc: 0.630 Test Loss: 0.809 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4723504
	speed: 0.8474s/iter; left time: 28996.6443s
	iters: 200, epoch: 8 | loss: 0.9305754
	speed: 0.2937s/iter; left time: 10018.8476s
	iters: 300, epoch: 8 | loss: 0.4432831
	speed: 0.2936s/iter; left time: 9986.4743s
Epoch: 8 cost time: 106.48374605178833
Epoch: 8, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.752 Vali Acc: 0.596 Test Loss: 0.752 Test Acc: 0.596
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3580610
	speed: 0.9041s/iter; left time: 30602.2096s
	iters: 200, epoch: 9 | loss: 0.4511906
	speed: 0.2921s/iter; left time: 9857.4997s
	iters: 300, epoch: 9 | loss: 0.4916508
	speed: 0.2593s/iter; left time: 8725.6449s
Epoch: 9 cost time: 103.59585523605347
Epoch: 9, Steps: 369 | Train Loss: 0.625 Vali Loss: 0.718 Vali Acc: 0.632 Test Loss: 0.718 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5832914
	speed: 0.8365s/iter; left time: 28007.3129s
	iters: 200, epoch: 10 | loss: 0.7340373
	speed: 0.2769s/iter; left time: 9243.9376s
	iters: 300, epoch: 10 | loss: 0.7879140
	speed: 0.2853s/iter; left time: 9496.3561s
Epoch: 10 cost time: 102.849609375
Epoch: 10, Steps: 369 | Train Loss: 0.614 Vali Loss: 0.767 Vali Acc: 0.663 Test Loss: 0.767 Test Acc: 0.663
Validation loss decreased (-0.643296 --> -0.663159).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3339547
	speed: 0.8886s/iter; left time: 29423.9679s
	iters: 200, epoch: 11 | loss: 0.5019836
	speed: 0.2791s/iter; left time: 9213.3489s
	iters: 300, epoch: 11 | loss: 0.7557771
	speed: 0.2784s/iter; left time: 9163.3440s
Epoch: 11 cost time: 103.41273188591003
Epoch: 11, Steps: 369 | Train Loss: 0.569 Vali Loss: 0.822 Vali Acc: 0.643 Test Loss: 0.822 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7080429
	speed: 0.8810s/iter; left time: 28847.2946s
	iters: 200, epoch: 12 | loss: 0.4798278
	speed: 0.2996s/iter; left time: 9778.6921s
	iters: 300, epoch: 12 | loss: 0.4479806
	speed: 0.2807s/iter; left time: 9134.3401s
Epoch: 12 cost time: 106.81174087524414
Epoch: 12, Steps: 369 | Train Loss: 0.537 Vali Loss: 0.766 Vali Acc: 0.659 Test Loss: 0.766 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6458377
	speed: 0.8831s/iter; left time: 28588.6459s
	iters: 200, epoch: 13 | loss: 0.3589207
	speed: 0.2875s/iter; left time: 9279.8363s
	iters: 300, epoch: 13 | loss: 0.5407974
	speed: 0.2847s/iter; left time: 9159.0806s
Epoch: 13 cost time: 103.63143181800842
Epoch: 13, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.746 Vali Acc: 0.657 Test Loss: 0.746 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.3424323
	speed: 0.9088s/iter; left time: 29084.8315s
	iters: 200, epoch: 14 | loss: 0.2522657
	speed: 0.2864s/iter; left time: 9136.5494s
	iters: 300, epoch: 14 | loss: 0.3269182
	speed: 0.2816s/iter; left time: 8955.6729s
Epoch: 14 cost time: 106.64714431762695
Epoch: 14, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.740 Vali Acc: 0.671 Test Loss: 0.740 Test Acc: 0.671
Validation loss decreased (-0.663159 --> -0.670537).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5820673
	speed: 0.8890s/iter; left time: 28124.8720s
	iters: 200, epoch: 15 | loss: 0.4558401
	speed: 0.2857s/iter; left time: 9008.6349s
	iters: 300, epoch: 15 | loss: 0.3388790
	speed: 0.2786s/iter; left time: 8758.9353s
Epoch: 15 cost time: 104.61091423034668
Epoch: 15, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.788 Vali Acc: 0.675 Test Loss: 0.788 Test Acc: 0.675
Validation loss decreased (-0.670537 --> -0.674510).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2734553
	speed: 0.8602s/iter; left time: 26894.3024s
	iters: 200, epoch: 16 | loss: 0.3742423
	speed: 0.2817s/iter; left time: 8778.2238s
	iters: 300, epoch: 16 | loss: 0.3503683
	speed: 0.2837s/iter; left time: 8813.0140s
Epoch: 16 cost time: 103.17041826248169
Epoch: 16, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.767 Vali Acc: 0.680 Test Loss: 0.767 Test Acc: 0.680
Validation loss decreased (-0.674510 --> -0.679902).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6684186
	speed: 0.8761s/iter; left time: 27069.1445s
	iters: 200, epoch: 17 | loss: 0.2210910
	speed: 0.2820s/iter; left time: 8685.4726s
	iters: 300, epoch: 17 | loss: 0.6003730
	speed: 0.2787s/iter; left time: 8555.7188s
Epoch: 17 cost time: 103.2564754486084
Epoch: 17, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.720 Vali Acc: 0.678 Test Loss: 0.720 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5487330
	speed: 0.8757s/iter; left time: 26734.8538s
	iters: 200, epoch: 18 | loss: 0.3376004
	speed: 0.2840s/iter; left time: 8640.5624s
	iters: 300, epoch: 18 | loss: 0.4690558
	speed: 0.2789s/iter; left time: 8457.5368s
Epoch: 18 cost time: 105.32113075256348
Epoch: 18, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.748 Vali Acc: 0.678 Test Loss: 0.748 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.2554357
	speed: 0.8654s/iter; left time: 26099.1418s
	iters: 200, epoch: 19 | loss: 0.3306679
	speed: 0.2867s/iter; left time: 8618.0712s
	iters: 300, epoch: 19 | loss: 0.4196864
	speed: 0.2735s/iter; left time: 8192.8638s
Epoch: 19 cost time: 102.71693563461304
Epoch: 19, Steps: 369 | Train Loss: 0.422 Vali Loss: 0.725 Vali Acc: 0.676 Test Loss: 0.725 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3265052
	speed: 0.8328s/iter; left time: 24809.4759s
	iters: 200, epoch: 20 | loss: 0.3959836
	speed: 0.2808s/iter; left time: 8336.4602s
	iters: 300, epoch: 20 | loss: 0.6491559
	speed: 0.2803s/iter; left time: 8295.3495s
Epoch: 20 cost time: 103.1347177028656
Epoch: 20, Steps: 369 | Train Loss: 0.397 Vali Loss: 0.701 Vali Acc: 0.678 Test Loss: 0.701 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3843602
	speed: 0.8718s/iter; left time: 25648.4139s
	iters: 200, epoch: 21 | loss: 0.3798038
	speed: 0.2814s/iter; left time: 8249.9506s
	iters: 300, epoch: 21 | loss: 0.1538423
	speed: 0.2809s/iter; left time: 8207.1367s
Epoch: 21 cost time: 104.66821265220642
Epoch: 21, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.821 Vali Acc: 0.668 Test Loss: 0.821 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4762554
	speed: 0.8213s/iter; left time: 23860.6949s
	iters: 200, epoch: 22 | loss: 0.1806594
	speed: 0.2562s/iter; left time: 7418.0327s
	iters: 300, epoch: 22 | loss: 0.2129609
	speed: 0.2690s/iter; left time: 7761.1095s
Epoch: 22 cost time: 96.76814079284668
Epoch: 22, Steps: 369 | Train Loss: 0.367 Vali Loss: 0.831 Vali Acc: 0.669 Test Loss: 0.831 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2920503
	speed: 0.8332s/iter; left time: 23898.1009s
	iters: 200, epoch: 23 | loss: 0.3388023
	speed: 0.2627s/iter; left time: 7508.7626s
	iters: 300, epoch: 23 | loss: 0.5230327
	speed: 0.2680s/iter; left time: 7633.5546s
Epoch: 23 cost time: 98.38596749305725
Epoch: 23, Steps: 369 | Train Loss: 0.343 Vali Loss: 0.953 Vali Acc: 0.667 Test Loss: 0.953 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2069064
	speed: 0.8340s/iter; left time: 23613.4215s
	iters: 200, epoch: 24 | loss: 0.4630128
	speed: 0.2784s/iter; left time: 7854.4133s
	iters: 300, epoch: 24 | loss: 0.3725208
	speed: 0.2750s/iter; left time: 7730.7141s
Epoch: 24 cost time: 101.63970804214478
Epoch: 24, Steps: 369 | Train Loss: 0.308 Vali Loss: 0.821 Vali Acc: 0.675 Test Loss: 0.821 Test Acc: 0.675
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2891057
	speed: 0.8765s/iter; left time: 24493.7760s
	iters: 200, epoch: 25 | loss: 0.1577861
	speed: 0.2835s/iter; left time: 7894.9321s
	iters: 300, epoch: 25 | loss: 0.3805665
	speed: 0.2744s/iter; left time: 7613.9359s
Epoch: 25 cost time: 103.72933554649353
Epoch: 25, Steps: 369 | Train Loss: 0.278 Vali Loss: 1.070 Vali Acc: 0.669 Test Loss: 1.070 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1496884
	speed: 0.8522s/iter; left time: 23501.0054s
	iters: 200, epoch: 26 | loss: 0.2863892
	speed: 0.2732s/iter; left time: 7505.7330s
	iters: 300, epoch: 26 | loss: 0.3714648
	speed: 0.2841s/iter; left time: 7776.7364s
Epoch: 26 cost time: 102.11423945426941
Epoch: 26, Steps: 369 | Train Loss: 0.252 Vali Loss: 0.878 Vali Acc: 0.656 Test Loss: 0.878 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6799091940976163
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8717147
	speed: 0.3032s/iter; left time: 11159.4265s
	iters: 200, epoch: 1 | loss: 0.7292750
	speed: 0.2870s/iter; left time: 10532.8269s
	iters: 300, epoch: 1 | loss: 0.5923266
	speed: 0.2751s/iter; left time: 10068.0353s
Epoch: 1 cost time: 106.13656830787659
Epoch: 1, Steps: 369 | Train Loss: 0.793 Vali Loss: 1.370 Vali Acc: 0.583 Test Loss: 1.370 Test Acc: 0.583
Validation loss decreased (inf --> -0.583414).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2812819
	speed: 0.8449s/iter; left time: 30779.8937s
	iters: 200, epoch: 2 | loss: 0.0468315
	speed: 0.2710s/iter; left time: 9846.6733s
	iters: 300, epoch: 2 | loss: 1.5305544
	speed: 0.2678s/iter; left time: 9701.2773s
Epoch: 2 cost time: 100.7770323753357
Epoch: 2, Steps: 369 | Train Loss: 0.903 Vali Loss: 1.678 Vali Acc: 0.647 Test Loss: 1.678 Test Acc: 0.647
Validation loss decreased (-0.583414 --> -0.646692).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4704309
	speed: 0.8503s/iter; left time: 30664.3699s
	iters: 200, epoch: 3 | loss: 2.6947517
	speed: 0.2673s/iter; left time: 9614.3751s
	iters: 300, epoch: 3 | loss: 3.1121535
	speed: 0.2705s/iter; left time: 9701.2402s
Epoch: 3 cost time: 100.0585789680481
Epoch: 3, Steps: 369 | Train Loss: 1.008 Vali Loss: 1.897 Vali Acc: 0.631 Test Loss: 1.897 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5310252
	speed: 0.8198s/iter; left time: 29263.5193s
	iters: 200, epoch: 4 | loss: 0.5327724
	speed: 0.2754s/iter; left time: 9803.3310s
	iters: 300, epoch: 4 | loss: 0.4676792
	speed: 0.2609s/iter; left time: 9259.9496s
Epoch: 4 cost time: 100.12495851516724
Epoch: 4, Steps: 369 | Train Loss: 0.879 Vali Loss: 1.416 Vali Acc: 0.636 Test Loss: 1.416 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6274347
	speed: 0.8170s/iter; left time: 28861.4753s
	iters: 200, epoch: 5 | loss: 1.1374155
	speed: 0.2744s/iter; left time: 9667.2907s
	iters: 300, epoch: 5 | loss: 0.7915831
	speed: 0.2771s/iter; left time: 9732.3831s
Epoch: 5 cost time: 100.2082109451294
Epoch: 5, Steps: 369 | Train Loss: 0.680 Vali Loss: 0.848 Vali Acc: 0.589 Test Loss: 0.848 Test Acc: 0.589
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5377088
	speed: 0.8448s/iter; left time: 29532.4783s
	iters: 200, epoch: 6 | loss: 0.2723912
	speed: 0.2824s/iter; left time: 9844.6648s
	iters: 300, epoch: 6 | loss: 0.4362457
	speed: 0.2589s/iter; left time: 8998.0605s
Epoch: 6 cost time: 100.10190916061401
Epoch: 6, Steps: 369 | Train Loss: 0.587 Vali Loss: 0.827 Vali Acc: 0.657 Test Loss: 0.827 Test Acc: 0.657
Validation loss decreased (-0.646692 --> -0.657483).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6426032
	speed: 0.7897s/iter; left time: 27312.0687s
	iters: 200, epoch: 7 | loss: 0.3538665
	speed: 0.2553s/iter; left time: 8805.4194s
	iters: 300, epoch: 7 | loss: 0.3928502
	speed: 0.2719s/iter; left time: 9350.4690s
Epoch: 7 cost time: 99.20640540122986
Epoch: 7, Steps: 369 | Train Loss: 0.590 Vali Loss: 1.218 Vali Acc: 0.635 Test Loss: 1.218 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7057313
	speed: 0.8672s/iter; left time: 29675.5143s
	iters: 200, epoch: 8 | loss: 0.5784379
	speed: 0.2795s/iter; left time: 9536.2137s
	iters: 300, epoch: 8 | loss: 0.8433912
	speed: 0.2708s/iter; left time: 9213.2442s
Epoch: 8 cost time: 102.5130889415741
Epoch: 8, Steps: 369 | Train Loss: 0.694 Vali Loss: 0.862 Vali Acc: 0.617 Test Loss: 0.862 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5298086
	speed: 0.8306s/iter; left time: 28115.3909s
	iters: 200, epoch: 9 | loss: 0.6039155
	speed: 0.2839s/iter; left time: 9581.7141s
	iters: 300, epoch: 9 | loss: 0.6193962
	speed: 0.2821s/iter; left time: 9492.3239s
Epoch: 9 cost time: 105.2229814529419
Epoch: 9, Steps: 369 | Train Loss: 0.674 Vali Loss: 0.773 Vali Acc: 0.637 Test Loss: 0.773 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3984278
	speed: 0.8397s/iter; left time: 28113.9152s
	iters: 200, epoch: 10 | loss: 0.5628051
	speed: 0.2580s/iter; left time: 8613.2435s
	iters: 300, epoch: 10 | loss: 0.8197503
	speed: 0.2594s/iter; left time: 8633.9707s
Epoch: 10 cost time: 98.60370874404907
Epoch: 10, Steps: 369 | Train Loss: 0.639 Vali Loss: 0.734 Vali Acc: 0.605 Test Loss: 0.734 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4318681
	speed: 0.8204s/iter; left time: 27164.1061s
	iters: 200, epoch: 11 | loss: 0.6516383
	speed: 0.2545s/iter; left time: 8402.5916s
	iters: 300, epoch: 11 | loss: 0.6430246
	speed: 0.2586s/iter; left time: 8509.8568s
Epoch: 11 cost time: 95.78914880752563
Epoch: 11, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.737 Vali Acc: 0.582 Test Loss: 0.737 Test Acc: 0.582
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6182774
	speed: 0.7931s/iter; left time: 25968.5149s
	iters: 200, epoch: 12 | loss: 0.7203008
	speed: 0.2697s/iter; left time: 8803.4814s
	iters: 300, epoch: 12 | loss: 0.5838371
	speed: 0.2768s/iter; left time: 9008.1223s
Epoch: 12 cost time: 100.98101997375488
Epoch: 12, Steps: 369 | Train Loss: 0.705 Vali Loss: 0.745 Vali Acc: 0.577 Test Loss: 0.745 Test Acc: 0.577
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6998542
	speed: 0.8404s/iter; left time: 27206.7970s
	iters: 200, epoch: 13 | loss: 0.6913575
	speed: 0.2625s/iter; left time: 8471.7186s
	iters: 300, epoch: 13 | loss: 0.8329383
	speed: 0.2592s/iter; left time: 8340.5100s
Epoch: 13 cost time: 98.19656181335449
Epoch: 13, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.709 Vali Acc: 0.598 Test Loss: 0.709 Test Acc: 0.598
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4539386
	speed: 0.8230s/iter; left time: 26338.2949s
	iters: 200, epoch: 14 | loss: 0.6111664
	speed: 0.2834s/iter; left time: 9043.0136s
	iters: 300, epoch: 14 | loss: 0.5162866
	speed: 0.2704s/iter; left time: 8598.5297s
Epoch: 14 cost time: 101.80636668205261
Epoch: 14, Steps: 369 | Train Loss: 0.674 Vali Loss: 0.698 Vali Acc: 0.619 Test Loss: 0.698 Test Acc: 0.619
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5121980
	speed: 0.8524s/iter; left time: 26967.0546s
	iters: 200, epoch: 15 | loss: 0.4514920
	speed: 0.2553s/iter; left time: 8051.1665s
	iters: 300, epoch: 15 | loss: 0.5297638
	speed: 0.2711s/iter; left time: 8522.8861s
Epoch: 15 cost time: 97.59036660194397
Epoch: 15, Steps: 369 | Train Loss: 0.640 Vali Loss: 0.701 Vali Acc: 0.611 Test Loss: 0.701 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.5332763
	speed: 0.8238s/iter; left time: 25756.8478s
	iters: 200, epoch: 16 | loss: 0.5598892
	speed: 0.2659s/iter; left time: 8285.7671s
	iters: 300, epoch: 16 | loss: 0.4368576
	speed: 0.2860s/iter; left time: 8886.3364s
Epoch: 16 cost time: 104.33545804023743
Epoch: 16, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.675 Vali Acc: 0.647 Test Loss: 0.675 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6574914869466515
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6931486
	speed: 0.2773s/iter; left time: 10204.0061s
	iters: 200, epoch: 1 | loss: 0.6930832
	speed: 0.2676s/iter; left time: 9822.6808s
	iters: 300, epoch: 1 | loss: 0.6938279
	speed: 0.2680s/iter; left time: 9809.1269s
Epoch: 1 cost time: 99.52736282348633
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6931306
	speed: 0.8136s/iter; left time: 29641.9111s
	iters: 200, epoch: 2 | loss: 0.6930036
	speed: 0.2518s/iter; left time: 9148.9214s
	iters: 300, epoch: 2 | loss: 0.6935768
	speed: 0.2599s/iter; left time: 9416.5915s
Epoch: 2 cost time: 95.6497049331665
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6928046
	speed: 0.8347s/iter; left time: 30102.5148s
	iters: 200, epoch: 3 | loss: 0.6961263
	speed: 0.2738s/iter; left time: 9847.8040s
	iters: 300, epoch: 3 | loss: 0.6918828
	speed: 0.2685s/iter; left time: 9629.0482s
Epoch: 3 cost time: 100.68839716911316
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6931767
	speed: 0.8196s/iter; left time: 29253.3650s
	iters: 200, epoch: 4 | loss: 0.6931702
	speed: 0.2801s/iter; left time: 9968.6815s
	iters: 300, epoch: 4 | loss: 0.6937510
	speed: 0.2791s/iter; left time: 9906.8820s
Epoch: 4 cost time: 104.39950942993164
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6930345
	speed: 0.8971s/iter; left time: 31689.7982s
	iters: 200, epoch: 5 | loss: 0.6922404
	speed: 0.2871s/iter; left time: 10114.4821s
	iters: 300, epoch: 5 | loss: 0.6935102
	speed: 0.2674s/iter; left time: 9390.8442s
Epoch: 5 cost time: 104.85448098182678
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6930392
	speed: 0.8361s/iter; left time: 29225.7158s
	iters: 200, epoch: 6 | loss: 0.6931556
	speed: 0.2800s/iter; left time: 9760.2797s
	iters: 300, epoch: 6 | loss: 0.6960226
	speed: 0.2762s/iter; left time: 9599.9786s
Epoch: 6 cost time: 104.66490817070007
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6931494
	speed: 0.8794s/iter; left time: 30415.4811s
	iters: 200, epoch: 7 | loss: 0.6915666
	speed: 0.2801s/iter; left time: 9658.2754s
	iters: 300, epoch: 7 | loss: 0.6930987
	speed: 0.2823s/iter; left time: 9706.0143s
Epoch: 7 cost time: 103.73193550109863
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6931940
	speed: 0.8540s/iter; left time: 29222.9426s
	iters: 200, epoch: 8 | loss: 0.6931532
	speed: 0.2784s/iter; left time: 9498.3449s
	iters: 300, epoch: 8 | loss: 0.6931472
	speed: 0.2618s/iter; left time: 8907.4948s
Epoch: 8 cost time: 100.42107462882996
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6935815
	speed: 0.8011s/iter; left time: 27115.7927s
	iters: 200, epoch: 9 | loss: 0.6944562
	speed: 0.2627s/iter; left time: 8864.7245s
	iters: 300, epoch: 9 | loss: 0.6990567
	speed: 0.2618s/iter; left time: 8809.7348s
Epoch: 9 cost time: 97.70499324798584
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6930217
	speed: 0.8083s/iter; left time: 27061.1783s
	iters: 200, epoch: 10 | loss: 0.6909097
	speed: 0.2746s/iter; left time: 9166.9890s
	iters: 300, epoch: 10 | loss: 0.6930867
	speed: 0.2649s/iter; left time: 8817.2396s
Epoch: 10 cost time: 98.95494103431702
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6932656
	speed: 0.8074s/iter; left time: 26734.8038s
	iters: 200, epoch: 11 | loss: 0.6931825
	speed: 0.2618s/iter; left time: 8643.7296s
	iters: 300, epoch: 11 | loss: 0.6931813
	speed: 0.2589s/iter; left time: 8520.1998s
Epoch: 11 cost time: 96.64963960647583
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6923869
	speed: 0.7926s/iter; left time: 25952.1889s
	iters: 200, epoch: 12 | loss: 0.6983176
	speed: 0.2726s/iter; left time: 8899.0145s
	iters: 300, epoch: 12 | loss: 0.6932079
	speed: 0.2806s/iter; left time: 9129.6611s
Epoch: 12 cost time: 100.91726303100586
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6931632
	speed: 0.8350s/iter; left time: 27030.6024s
	iters: 200, epoch: 13 | loss: 0.6931477
	speed: 0.2659s/iter; left time: 8582.0063s
	iters: 300, epoch: 13 | loss: 0.6923024
	speed: 0.2526s/iter; left time: 8128.2752s
Epoch: 13 cost time: 97.39342069625854
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6933770
	speed: 0.8130s/iter; left time: 26018.1159s
	iters: 200, epoch: 14 | loss: 0.6931530
	speed: 0.2713s/iter; left time: 8656.8169s
	iters: 300, epoch: 14 | loss: 0.6931581
	speed: 0.2693s/iter; left time: 8563.2681s
Epoch: 14 cost time: 99.01323223114014
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6933774
	speed: 0.8191s/iter; left time: 25913.2908s
	iters: 200, epoch: 15 | loss: 0.6941696
	speed: 0.2596s/iter; left time: 8185.5771s
	iters: 300, epoch: 15 | loss: 0.6917204
	speed: 0.2567s/iter; left time: 8069.0150s
Epoch: 15 cost time: 96.71852135658264
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6932167
	speed: 0.8164s/iter; left time: 25524.3645s
	iters: 200, epoch: 16 | loss: 0.6912171
	speed: 0.2671s/iter; left time: 8325.8306s
	iters: 300, epoch: 16 | loss: 0.6931472
	speed: 0.2658s/iter; left time: 8258.3812s
Epoch: 16 cost time: 98.98602938652039
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6932777
	speed: 0.8105s/iter; left time: 25040.5020s
	iters: 200, epoch: 17 | loss: 0.6919919
	speed: 0.2499s/iter; left time: 7696.8816s
	iters: 300, epoch: 17 | loss: 0.6934338
	speed: 0.2597s/iter; left time: 7970.8215s
Epoch: 17 cost time: 95.38759970664978
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.6932973
	speed: 0.7951s/iter; left time: 24273.9675s
	iters: 200, epoch: 18 | loss: 0.6931520
	speed: 0.2700s/iter; left time: 8217.0656s
	iters: 300, epoch: 18 | loss: 0.6942103
	speed: 0.2667s/iter; left time: 8088.5667s
Epoch: 18 cost time: 98.63557600975037
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6960822
	speed: 0.8289s/iter; left time: 24998.3072s
	iters: 200, epoch: 19 | loss: 0.6945718
	speed: 0.2648s/iter; left time: 7959.7888s
	iters: 300, epoch: 19 | loss: 0.6951164
	speed: 0.2570s/iter; left time: 7700.3196s
Epoch: 19 cost time: 98.95541095733643
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6931643
	speed: 0.8199s/iter; left time: 24425.5795s
	iters: 200, epoch: 20 | loss: 0.6936355
	speed: 0.2719s/iter; left time: 8071.6564s
	iters: 300, epoch: 20 | loss: 0.6927232
	speed: 0.2751s/iter; left time: 8140.4918s
Epoch: 20 cost time: 100.4621307849884
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.6976537
	speed: 0.8004s/iter; left time: 23548.4317s
	iters: 200, epoch: 21 | loss: 0.6966148
	speed: 0.2455s/iter; left time: 7199.4350s
	iters: 300, epoch: 21 | loss: 0.6931471
	speed: 0.2597s/iter; left time: 7588.5803s
Epoch: 21 cost time: 94.43042182922363
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.6931795
	speed: 0.7761s/iter; left time: 22548.0753s
	iters: 200, epoch: 22 | loss: 0.6917244
	speed: 0.2627s/iter; left time: 7605.5671s
	iters: 300, epoch: 22 | loss: 0.6931477
	speed: 0.2684s/iter; left time: 7742.5485s
Epoch: 22 cost time: 97.6437156200409
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.6931651
	speed: 0.8455s/iter; left time: 24252.5075s
	iters: 200, epoch: 23 | loss: 0.6931471
	speed: 0.2759s/iter; left time: 7886.7849s
	iters: 300, epoch: 23 | loss: 0.6910589
	speed: 0.2742s/iter; left time: 7809.6653s
Epoch: 23 cost time: 102.13365316390991
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.6939424
	speed: 0.8251s/iter; left time: 23361.0484s
	iters: 200, epoch: 24 | loss: 0.6932181
	speed: 0.2841s/iter; left time: 8016.9917s
	iters: 300, epoch: 24 | loss: 0.6919252
	speed: 0.2792s/iter; left time: 7848.1835s
Epoch: 24 cost time: 103.92729139328003
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.6923794
	speed: 0.8291s/iter; left time: 23170.1396s
	iters: 200, epoch: 25 | loss: 0.6931481
	speed: 0.2696s/iter; left time: 7507.1529s
	iters: 300, epoch: 25 | loss: 0.6947377
	speed: 0.2819s/iter; left time: 7820.1316s
Epoch: 25 cost time: 102.53932499885559
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.6984693
	speed: 0.8749s/iter; left time: 24126.9102s
	iters: 200, epoch: 26 | loss: 0.6931750
	speed: 0.2879s/iter; left time: 7908.9742s
	iters: 300, epoch: 26 | loss: 0.6931476
	speed: 0.2830s/iter; left time: 7747.1419s
Epoch: 26 cost time: 105.27203345298767
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.6948234
	speed: 0.8576s/iter; left time: 23333.2404s
	iters: 200, epoch: 27 | loss: 0.6926493
	speed: 0.2756s/iter; left time: 7470.3844s
	iters: 300, epoch: 27 | loss: 0.6919972
	speed: 0.2751s/iter; left time: 7428.7745s
Epoch: 27 cost time: 103.0627429485321
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.6951637
	speed: 0.8797s/iter; left time: 23608.2127s
	iters: 200, epoch: 28 | loss: 0.6927235
	speed: 0.2808s/iter; left time: 7507.5537s
	iters: 300, epoch: 28 | loss: 0.6937321
	speed: 0.2667s/iter; left time: 7104.8666s
Epoch: 28 cost time: 103.22991037368774
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.6996539
	speed: 0.8182s/iter; left time: 21658.2383s
	iters: 200, epoch: 29 | loss: 0.6911802
	speed: 0.2590s/iter; left time: 6829.7565s
	iters: 300, epoch: 29 | loss: 0.6932279
	speed: 0.2631s/iter; left time: 6911.2386s
Epoch: 29 cost time: 97.246511220932
Epoch: 29, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.6931592
	speed: 0.8289s/iter; left time: 21634.2058s
	iters: 200, epoch: 30 | loss: 0.6932050
	speed: 0.2734s/iter; left time: 7108.7933s
	iters: 300, epoch: 30 | loss: 0.6934112
	speed: 0.2754s/iter; left time: 7133.2113s
Epoch: 30 cost time: 100.74127626419067
Epoch: 30, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.6956977
	speed: 0.8292s/iter; left time: 21336.0812s
	iters: 200, epoch: 31 | loss: 0.6972842
	speed: 0.2663s/iter; left time: 6824.9744s
	iters: 300, epoch: 31 | loss: 0.6933536
	speed: 0.2674s/iter; left time: 6826.4888s
Epoch: 31 cost time: 99.66842484474182
Epoch: 31, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.6909506
	speed: 0.8567s/iter; left time: 21726.9153s
	iters: 200, epoch: 32 | loss: 0.6950191
	speed: 0.2683s/iter; left time: 6778.0663s
	iters: 300, epoch: 32 | loss: 0.6920449
	speed: 0.2558s/iter; left time: 6435.4170s
Epoch: 32 cost time: 99.0042552947998
Epoch: 32, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.6952122
	speed: 0.7910s/iter; left time: 19770.0699s
	iters: 200, epoch: 33 | loss: 0.6931639
	speed: 0.2606s/iter; left time: 6487.1545s
	iters: 300, epoch: 33 | loss: 0.6931666
	speed: 0.2527s/iter; left time: 6265.7893s
Epoch: 33 cost time: 95.44478511810303
Epoch: 33, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.6931913
	speed: 0.8142s/iter; left time: 20049.7750s
	iters: 200, epoch: 34 | loss: 0.6955732
	speed: 0.2630s/iter; left time: 6450.2665s
	iters: 300, epoch: 34 | loss: 0.6943106
	speed: 0.2550s/iter; left time: 6228.8718s
Epoch: 34 cost time: 97.8204824924469
Epoch: 34, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 8894978
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5273579
	speed: 0.2770s/iter; left time: 10195.3988s
	iters: 200, epoch: 1 | loss: 1.2121691
	speed: 0.2764s/iter; left time: 10143.3893s
	iters: 300, epoch: 1 | loss: 0.8430588
	speed: 0.2835s/iter; left time: 10376.9855s
Epoch: 1 cost time: 103.245201587677
Epoch: 1, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.849 Vali Acc: 0.653 Test Loss: 0.849 Test Acc: 0.653
Validation loss decreased (inf --> -0.652659).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6289473
	speed: 0.8549s/iter; left time: 31145.5399s
	iters: 200, epoch: 2 | loss: 0.5801024
	speed: 0.2666s/iter; left time: 9685.2163s
	iters: 300, epoch: 2 | loss: 0.8886766
	speed: 0.2808s/iter; left time: 10173.5963s
Epoch: 2 cost time: 100.4795126914978
Epoch: 2, Steps: 369 | Train Loss: 0.666 Vali Loss: 1.058 Vali Acc: 0.643 Test Loss: 1.058 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6619517
	speed: 0.8331s/iter; left time: 30045.7028s
	iters: 200, epoch: 3 | loss: 0.3828867
	speed: 0.2647s/iter; left time: 9518.1889s
	iters: 300, epoch: 3 | loss: 1.1037592
	speed: 0.2690s/iter; left time: 9645.3730s
Epoch: 3 cost time: 101.01708769798279
Epoch: 3, Steps: 369 | Train Loss: 0.730 Vali Loss: 1.051 Vali Acc: 0.665 Test Loss: 1.051 Test Acc: 0.665
Validation loss decreased (-0.652659 --> -0.664859).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6101703
	speed: 0.8549s/iter; left time: 30513.8338s
	iters: 200, epoch: 4 | loss: 1.0548915
	speed: 0.2750s/iter; left time: 9786.6395s
	iters: 300, epoch: 4 | loss: 0.9084345
	speed: 0.2693s/iter; left time: 9559.5779s
Epoch: 4 cost time: 101.16497492790222
Epoch: 4, Steps: 369 | Train Loss: 0.709 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6538470
	speed: 0.8266s/iter; left time: 29200.8223s
	iters: 200, epoch: 5 | loss: 0.2439296
	speed: 0.2844s/iter; left time: 10018.8320s
	iters: 300, epoch: 5 | loss: 0.7013525
	speed: 0.2854s/iter; left time: 10025.0318s
Epoch: 5 cost time: 105.30215096473694
Epoch: 5, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.779 Vali Acc: 0.659 Test Loss: 0.779 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3264916
	speed: 0.8534s/iter; left time: 29832.6947s
	iters: 200, epoch: 6 | loss: 0.4564240
	speed: 0.2631s/iter; left time: 9171.0856s
	iters: 300, epoch: 6 | loss: 0.7793605
	speed: 0.2633s/iter; left time: 9152.6189s
Epoch: 6 cost time: 98.86229085922241
Epoch: 6, Steps: 369 | Train Loss: 0.534 Vali Loss: 1.144 Vali Acc: 0.639 Test Loss: 1.144 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7392982
	speed: 0.8125s/iter; left time: 28102.6165s
	iters: 200, epoch: 7 | loss: 0.5329646
	speed: 0.2779s/iter; left time: 9584.9315s
	iters: 300, epoch: 7 | loss: 0.5557250
	speed: 0.2756s/iter; left time: 9475.4281s
Epoch: 7 cost time: 101.2356379032135
Epoch: 7, Steps: 369 | Train Loss: 0.543 Vali Loss: 0.787 Vali Acc: 0.648 Test Loss: 0.787 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4677612
	speed: 0.8534s/iter; left time: 29200.6307s
	iters: 200, epoch: 8 | loss: 0.3129674
	speed: 0.2738s/iter; left time: 9341.0080s
	iters: 300, epoch: 8 | loss: 0.6767303
	speed: 0.2763s/iter; left time: 9397.5504s
Epoch: 8 cost time: 101.06952500343323
Epoch: 8, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.770 Vali Acc: 0.659 Test Loss: 0.770 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.9107283
	speed: 0.8481s/iter; left time: 28706.0670s
	iters: 200, epoch: 9 | loss: 0.3926969
	speed: 0.2987s/iter; left time: 10079.2732s
	iters: 300, epoch: 9 | loss: 0.4759439
	speed: 0.2897s/iter; left time: 9749.1962s
Epoch: 9 cost time: 108.39042258262634
Epoch: 9, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.777 Vali Acc: 0.661 Test Loss: 0.777 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.3502159
	speed: 0.8623s/iter; left time: 28870.4896s
	iters: 200, epoch: 10 | loss: 0.6801615
	speed: 0.2873s/iter; left time: 9589.2572s
	iters: 300, epoch: 10 | loss: 0.3304651
	speed: 0.2885s/iter; left time: 9601.5398s
Epoch: 10 cost time: 106.29921817779541
Epoch: 10, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.813 Vali Acc: 0.655 Test Loss: 0.813 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.4363587
	speed: 0.8803s/iter; left time: 29146.1225s
	iters: 200, epoch: 11 | loss: 0.4159931
	speed: 0.2914s/iter; left time: 9619.4799s
	iters: 300, epoch: 11 | loss: 0.5964079
	speed: 0.2763s/iter; left time: 9092.3847s
Epoch: 11 cost time: 104.29664659500122
Epoch: 11, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.898 Vali Acc: 0.657 Test Loss: 0.898 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5122023
	speed: 0.8230s/iter; left time: 26945.9556s
	iters: 200, epoch: 12 | loss: 0.4597761
	speed: 0.2674s/iter; left time: 8727.1697s
	iters: 300, epoch: 12 | loss: 0.2731045
	speed: 0.2751s/iter; left time: 8950.9290s
Epoch: 12 cost time: 99.90877842903137
Epoch: 12, Steps: 369 | Train Loss: 0.379 Vali Loss: 0.826 Vali Acc: 0.662 Test Loss: 0.826 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4643144
	speed: 0.8219s/iter; left time: 26607.0601s
	iters: 200, epoch: 13 | loss: 0.3729891
	speed: 0.2721s/iter; left time: 8780.1488s
	iters: 300, epoch: 13 | loss: 0.1011156
	speed: 0.2835s/iter; left time: 9119.4395s
Epoch: 13 cost time: 101.03100275993347
Epoch: 13, Steps: 369 | Train Loss: 0.355 Vali Loss: 0.888 Vali Acc: 0.654 Test Loss: 0.888 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6648694665153235
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5728455
	speed: 0.2899s/iter; left time: 10668.5734s
	iters: 200, epoch: 1 | loss: 1.0140736
	speed: 0.2722s/iter; left time: 9990.1168s
	iters: 300, epoch: 1 | loss: 1.0168446
	speed: 0.2769s/iter; left time: 10134.3503s
Epoch: 1 cost time: 102.58930587768555
Epoch: 1, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.878 Vali Acc: 0.660 Test Loss: 0.878 Test Acc: 0.660
Validation loss decreased (inf --> -0.659753).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3317012
	speed: 0.8016s/iter; left time: 29204.1832s
	iters: 200, epoch: 2 | loss: 0.4007627
	speed: 0.2645s/iter; left time: 9610.6709s
	iters: 300, epoch: 2 | loss: 1.1377928
	speed: 0.2580s/iter; left time: 9349.3471s
Epoch: 2 cost time: 97.18361258506775
Epoch: 2, Steps: 369 | Train Loss: 0.660 Vali Loss: 0.979 Vali Acc: 0.640 Test Loss: 0.979 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7743016
	speed: 0.7987s/iter; left time: 28802.3614s
	iters: 200, epoch: 3 | loss: 0.4432645
	speed: 0.2971s/iter; left time: 10685.9239s
	iters: 300, epoch: 3 | loss: 0.7799063
	speed: 0.2835s/iter; left time: 10165.9935s
Epoch: 3 cost time: 104.13010478019714
Epoch: 3, Steps: 369 | Train Loss: 0.740 Vali Loss: 1.131 Vali Acc: 0.671 Test Loss: 1.131 Test Acc: 0.671
Validation loss decreased (-0.659753 --> -0.670817).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7825408
	speed: 0.8346s/iter; left time: 29790.7303s
	iters: 200, epoch: 4 | loss: 0.4108198
	speed: 0.2610s/iter; left time: 9290.7330s
	iters: 300, epoch: 4 | loss: 0.7737448
	speed: 0.2678s/iter; left time: 9505.5460s
Epoch: 4 cost time: 99.0325357913971
Epoch: 4, Steps: 369 | Train Loss: 0.731 Vali Loss: 1.167 Vali Acc: 0.666 Test Loss: 1.167 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7325946
	speed: 0.8189s/iter; left time: 28927.3445s
	iters: 200, epoch: 5 | loss: 0.2551548
	speed: 0.2768s/iter; left time: 9751.2256s
	iters: 300, epoch: 5 | loss: 0.9888021
	speed: 0.2765s/iter; left time: 9711.9564s
Epoch: 5 cost time: 101.32282614707947
Epoch: 5, Steps: 369 | Train Loss: 0.740 Vali Loss: 1.062 Vali Acc: 0.616 Test Loss: 1.062 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2196701
	speed: 0.8416s/iter; left time: 29418.5214s
	iters: 200, epoch: 6 | loss: 0.4997056
	speed: 0.2614s/iter; left time: 9111.3709s
	iters: 300, epoch: 6 | loss: 0.5913207
	speed: 0.2736s/iter; left time: 9509.8965s
Epoch: 6 cost time: 98.41391468048096
Epoch: 6, Steps: 369 | Train Loss: 0.576 Vali Loss: 1.184 Vali Acc: 0.638 Test Loss: 1.184 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6690810
	speed: 0.8236s/iter; left time: 28484.3462s
	iters: 200, epoch: 7 | loss: 0.4176461
	speed: 0.2695s/iter; left time: 9295.5168s
	iters: 300, epoch: 7 | loss: 0.5067622
	speed: 0.2742s/iter; left time: 9427.6715s
Epoch: 7 cost time: 100.21105623245239
Epoch: 7, Steps: 369 | Train Loss: 0.514 Vali Loss: 0.772 Vali Acc: 0.675 Test Loss: 0.772 Test Acc: 0.675
Validation loss decreased (-0.670817 --> -0.674510).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6574508
	speed: 0.8450s/iter; left time: 28912.6616s
	iters: 200, epoch: 8 | loss: 0.2932540
	speed: 0.2643s/iter; left time: 9018.0659s
	iters: 300, epoch: 8 | loss: 0.4803356
	speed: 0.2564s/iter; left time: 8723.3247s
Epoch: 8 cost time: 100.01577734947205
Epoch: 8, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.838 Vali Acc: 0.649 Test Loss: 0.838 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3752164
	speed: 0.8066s/iter; left time: 27303.9356s
	iters: 200, epoch: 9 | loss: 0.3817210
	speed: 0.2632s/iter; left time: 8883.6183s
	iters: 300, epoch: 9 | loss: 0.4863890
	speed: 0.2758s/iter; left time: 9279.2902s
Epoch: 9 cost time: 98.45854830741882
Epoch: 9, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.778 Vali Acc: 0.661 Test Loss: 0.778 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6127302
	speed: 0.8337s/iter; left time: 27913.6543s
	iters: 200, epoch: 10 | loss: 0.3478096
	speed: 0.2718s/iter; left time: 9073.0785s
	iters: 300, epoch: 10 | loss: 0.2268009
	speed: 0.2663s/iter; left time: 8863.8739s
Epoch: 10 cost time: 99.42651200294495
Epoch: 10, Steps: 369 | Train Loss: 0.419 Vali Loss: 0.727 Vali Acc: 0.679 Test Loss: 0.727 Test Acc: 0.679
Validation loss decreased (-0.674510 --> -0.678767).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3957327
	speed: 0.7973s/iter; left time: 26399.6824s
	iters: 200, epoch: 11 | loss: 0.3835809
	speed: 0.2607s/iter; left time: 8604.9096s
	iters: 300, epoch: 11 | loss: 0.8816487
	speed: 0.2614s/iter; left time: 8603.9709s
Epoch: 11 cost time: 96.1197018623352
Epoch: 11, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.850 Vali Acc: 0.663 Test Loss: 0.850 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5902081
	speed: 0.8249s/iter; left time: 27007.2969s
	iters: 200, epoch: 12 | loss: 0.3414573
	speed: 0.2703s/iter; left time: 8821.6559s
	iters: 300, epoch: 12 | loss: 0.1143731
	speed: 0.2670s/iter; left time: 8688.5559s
Epoch: 12 cost time: 100.36271786689758
Epoch: 12, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.898 Vali Acc: 0.669 Test Loss: 0.898 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2496443
	speed: 0.8196s/iter; left time: 26533.7197s
	iters: 200, epoch: 13 | loss: 0.3895761
	speed: 0.2732s/iter; left time: 8815.5501s
	iters: 300, epoch: 13 | loss: 0.0751716
	speed: 0.2823s/iter; left time: 9083.0944s
Epoch: 13 cost time: 101.64239883422852
Epoch: 13, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.989 Vali Acc: 0.661 Test Loss: 0.989 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6418244
	speed: 0.8624s/iter; left time: 27599.1630s
	iters: 200, epoch: 14 | loss: 0.1812632
	speed: 0.2677s/iter; left time: 8541.4247s
	iters: 300, epoch: 14 | loss: 0.2641607
	speed: 0.2701s/iter; left time: 8590.8845s
Epoch: 14 cost time: 102.2324788570404
Epoch: 14, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.949 Vali Acc: 0.651 Test Loss: 0.949 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0597368
	speed: 0.8201s/iter; left time: 25943.0217s
	iters: 200, epoch: 15 | loss: 0.0382512
	speed: 0.2553s/iter; left time: 8052.3651s
	iters: 300, epoch: 15 | loss: 0.2094186
	speed: 0.2701s/iter; left time: 8490.6936s
Epoch: 15 cost time: 99.40518307685852
Epoch: 15, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.975 Vali Acc: 0.668 Test Loss: 0.975 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0476264
	speed: 0.8437s/iter; left time: 26378.4038s
	iters: 200, epoch: 16 | loss: 0.1738442
	speed: 0.2659s/iter; left time: 8287.6517s
	iters: 300, epoch: 16 | loss: 0.1965477
	speed: 0.2480s/iter; left time: 7703.6029s
Epoch: 16 cost time: 96.79423689842224
Epoch: 16, Steps: 369 | Train Loss: 0.252 Vali Loss: 1.241 Vali Acc: 0.652 Test Loss: 1.241 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.3808246
	speed: 0.7694s/iter; left time: 23773.4597s
	iters: 200, epoch: 17 | loss: 0.4239129
	speed: 0.2544s/iter; left time: 7835.9797s
	iters: 300, epoch: 17 | loss: 0.0540710
	speed: 0.2520s/iter; left time: 7735.2136s
Epoch: 17 cost time: 94.13205432891846
Epoch: 17, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.255 Vali Acc: 0.664 Test Loss: 1.255 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.1130244
	speed: 0.8180s/iter; left time: 24971.4660s
	iters: 200, epoch: 18 | loss: 0.2455062
	speed: 0.2696s/iter; left time: 8202.6791s
	iters: 300, epoch: 18 | loss: 0.1593508
	speed: 0.2663s/iter; left time: 8076.7478s
Epoch: 18 cost time: 99.52852988243103
Epoch: 18, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.331 Vali Acc: 0.654 Test Loss: 1.331 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1818648
	speed: 0.8076s/iter; left time: 24357.7257s
	iters: 200, epoch: 19 | loss: 0.0232043
	speed: 0.2578s/iter; left time: 7748.1032s
	iters: 300, epoch: 19 | loss: 0.2343290
	speed: 0.2600s/iter; left time: 7789.4272s
Epoch: 19 cost time: 97.0126588344574
Epoch: 19, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.450 Vali Acc: 0.632 Test Loss: 1.450 Test Acc: 0.632
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0215672
	speed: 0.8303s/iter; left time: 24733.7674s
	iters: 200, epoch: 20 | loss: 0.0512849
	speed: 0.2690s/iter; left time: 7986.7304s
	iters: 300, epoch: 20 | loss: 0.0701523
	speed: 0.2535s/iter; left time: 7500.1756s
Epoch: 20 cost time: 97.40708780288696
Epoch: 20, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.629 Vali Acc: 0.654 Test Loss: 1.629 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6787741203178207
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6604460
	speed: 0.2712s/iter; left time: 9978.6321s
	iters: 200, epoch: 1 | loss: 1.0044371
	speed: 0.2612s/iter; left time: 9586.8879s
	iters: 300, epoch: 1 | loss: 1.0185721
	speed: 0.2583s/iter; left time: 9454.2166s
Epoch: 1 cost time: 98.11598372459412
Epoch: 1, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.874 Vali Acc: 0.644 Test Loss: 0.874 Test Acc: 0.644
Validation loss decreased (inf --> -0.643578).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4524601
	speed: 0.8617s/iter; left time: 31392.8078s
	iters: 200, epoch: 2 | loss: 0.6113393
	speed: 0.2824s/iter; left time: 10261.0212s
	iters: 300, epoch: 2 | loss: 0.7536303
	speed: 0.2764s/iter; left time: 10015.8536s
Epoch: 2 cost time: 102.51332235336304
Epoch: 2, Steps: 369 | Train Loss: 0.667 Vali Loss: 1.150 Vali Acc: 0.648 Test Loss: 1.150 Test Acc: 0.648
Validation loss decreased (-0.643578 --> -0.648116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7762882
	speed: 0.8237s/iter; left time: 29704.9785s
	iters: 200, epoch: 3 | loss: 0.7052126
	speed: 0.2688s/iter; left time: 9665.9700s
	iters: 300, epoch: 3 | loss: 1.2772719
	speed: 0.2690s/iter; left time: 9648.4116s
Epoch: 3 cost time: 99.63048911094666
Epoch: 3, Steps: 369 | Train Loss: 0.756 Vali Loss: 1.261 Vali Acc: 0.619 Test Loss: 1.261 Test Acc: 0.619
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0378549
	speed: 0.8343s/iter; left time: 29780.4626s
	iters: 200, epoch: 4 | loss: 0.5723571
	speed: 0.2607s/iter; left time: 9280.2538s
	iters: 300, epoch: 4 | loss: 0.6291857
	speed: 0.2640s/iter; left time: 9368.7155s
Epoch: 4 cost time: 98.05930805206299
Epoch: 4, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.802 Vali Acc: 0.658 Test Loss: 0.802 Test Acc: 0.658
Validation loss decreased (-0.648116 --> -0.658335).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6072956
	speed: 0.8052s/iter; left time: 28445.1839s
	iters: 200, epoch: 5 | loss: 0.7063721
	speed: 0.2571s/iter; left time: 9055.3532s
	iters: 300, epoch: 5 | loss: 0.4942572
	speed: 0.2612s/iter; left time: 9174.4219s
Epoch: 5 cost time: 95.90921974182129
Epoch: 5, Steps: 369 | Train Loss: 0.607 Vali Loss: 0.745 Vali Acc: 0.658 Test Loss: 0.745 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6450601
	speed: 0.8111s/iter; left time: 28351.9848s
	iters: 200, epoch: 6 | loss: 0.8471770
	speed: 0.2665s/iter; left time: 9288.6112s
	iters: 300, epoch: 6 | loss: 0.9994832
	speed: 0.2618s/iter; left time: 9097.9020s
Epoch: 6 cost time: 97.94281101226807
Epoch: 6, Steps: 369 | Train Loss: 0.571 Vali Loss: 0.819 Vali Acc: 0.646 Test Loss: 0.819 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6957769
	speed: 0.7837s/iter; left time: 27104.4656s
	iters: 200, epoch: 7 | loss: 0.6717902
	speed: 0.2459s/iter; left time: 8481.5986s
	iters: 300, epoch: 7 | loss: 0.5241718
	speed: 0.2461s/iter; left time: 8463.8764s
Epoch: 7 cost time: 92.88771629333496
Epoch: 7, Steps: 369 | Train Loss: 0.578 Vali Loss: 0.760 Vali Acc: 0.641 Test Loss: 0.760 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4869042
	speed: 0.7958s/iter; left time: 27231.7496s
	iters: 200, epoch: 8 | loss: 0.3846187
	speed: 0.2737s/iter; left time: 9337.0934s
	iters: 300, epoch: 8 | loss: 1.0879591
	speed: 0.2618s/iter; left time: 8905.9023s
Epoch: 8 cost time: 98.86781024932861
Epoch: 8, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.715 Vali Acc: 0.669 Test Loss: 0.715 Test Acc: 0.669
Validation loss decreased (-0.658335 --> -0.668835).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6891719
	speed: 0.8200s/iter; left time: 27757.7546s
	iters: 200, epoch: 9 | loss: 0.5516290
	speed: 0.2622s/iter; left time: 8848.3064s
	iters: 300, epoch: 9 | loss: 0.6988631
	speed: 0.2656s/iter; left time: 8936.2986s
Epoch: 9 cost time: 98.7409029006958
Epoch: 9, Steps: 369 | Train Loss: 0.535 Vali Loss: 0.667 Vali Acc: 0.669 Test Loss: 0.667 Test Acc: 0.669
Validation loss decreased (-0.668835 --> -0.668836).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5281507
	speed: 0.8511s/iter; left time: 28494.9534s
	iters: 200, epoch: 10 | loss: 0.8612149
	speed: 0.2681s/iter; left time: 8949.6684s
	iters: 300, epoch: 10 | loss: 0.4536592
	speed: 0.2698s/iter; left time: 8978.0374s
Epoch: 10 cost time: 100.4847424030304
Epoch: 10, Steps: 369 | Train Loss: 0.505 Vali Loss: 0.697 Vali Acc: 0.663 Test Loss: 0.697 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7444037
	speed: 0.7991s/iter; left time: 26460.1690s
	iters: 200, epoch: 11 | loss: 0.5497819
	speed: 0.2664s/iter; left time: 8793.2812s
	iters: 300, epoch: 11 | loss: 0.7501827
	speed: 0.2729s/iter; left time: 8980.1318s
Epoch: 11 cost time: 99.69611859321594
Epoch: 11, Steps: 369 | Train Loss: 0.486 Vali Loss: 0.702 Vali Acc: 0.663 Test Loss: 0.702 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7844786
	speed: 0.8387s/iter; left time: 27462.1552s
	iters: 200, epoch: 12 | loss: 0.6315944
	speed: 0.2606s/iter; left time: 8506.4872s
	iters: 300, epoch: 12 | loss: 0.2698677
	speed: 0.2530s/iter; left time: 8233.4958s
Epoch: 12 cost time: 96.01587557792664
Epoch: 12, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.683 Vali Acc: 0.690 Test Loss: 0.683 Test Acc: 0.690
Validation loss decreased (-0.668836 --> -0.689834).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6937772
	speed: 0.7723s/iter; left time: 25003.2092s
	iters: 200, epoch: 13 | loss: 0.5067260
	speed: 0.2536s/iter; left time: 8182.8595s
	iters: 300, epoch: 13 | loss: 0.3730697
	speed: 0.2642s/iter; left time: 8499.7802s
Epoch: 13 cost time: 94.80105066299438
Epoch: 13, Steps: 369 | Train Loss: 0.464 Vali Loss: 0.736 Vali Acc: 0.649 Test Loss: 0.736 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4350780
	speed: 0.8124s/iter; left time: 25998.8390s
	iters: 200, epoch: 14 | loss: 0.5587185
	speed: 0.2506s/iter; left time: 7995.8901s
	iters: 300, epoch: 14 | loss: 0.2168209
	speed: 0.2529s/iter; left time: 8042.9321s
Epoch: 14 cost time: 94.71645307540894
Epoch: 14, Steps: 369 | Train Loss: 0.457 Vali Loss: 0.701 Vali Acc: 0.681 Test Loss: 0.701 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2479836
	speed: 0.8097s/iter; left time: 25614.9030s
	iters: 200, epoch: 15 | loss: 0.1936825
	speed: 0.2578s/iter; left time: 8128.2367s
	iters: 300, epoch: 15 | loss: 0.2621073
	speed: 0.2724s/iter; left time: 8561.6700s
Epoch: 15 cost time: 98.6995017528534
Epoch: 15, Steps: 369 | Train Loss: 0.457 Vali Loss: 0.706 Vali Acc: 0.687 Test Loss: 0.706 Test Acc: 0.687
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2825231
	speed: 0.8151s/iter; left time: 25485.2043s
	iters: 200, epoch: 16 | loss: 0.4142174
	speed: 0.2477s/iter; left time: 7719.8880s
	iters: 300, epoch: 16 | loss: 0.2532159
	speed: 0.2509s/iter; left time: 7793.6059s
Epoch: 16 cost time: 94.1309461593628
Epoch: 16, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.779 Vali Acc: 0.689 Test Loss: 0.779 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5955880
	speed: 0.7730s/iter; left time: 23883.5264s
	iters: 200, epoch: 17 | loss: 0.3758941
	speed: 0.2580s/iter; left time: 7946.3178s
	iters: 300, epoch: 17 | loss: 0.3153932
	speed: 0.2716s/iter; left time: 8336.8735s
Epoch: 17 cost time: 96.28189206123352
Epoch: 17, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.763 Vali Acc: 0.695 Test Loss: 0.763 Test Acc: 0.695
Validation loss decreased (-0.689834 --> -0.695225).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5765020
	speed: 0.8293s/iter; left time: 25317.5490s
	iters: 200, epoch: 18 | loss: 0.5745968
	speed: 0.2562s/iter; left time: 7797.0223s
	iters: 300, epoch: 18 | loss: 0.4757360
	speed: 0.2519s/iter; left time: 7640.7403s
Epoch: 18 cost time: 96.78459692001343
Epoch: 18, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.724 Vali Acc: 0.673 Test Loss: 0.724 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1993833
	speed: 0.7828s/iter; left time: 23609.3068s
	iters: 200, epoch: 19 | loss: 0.2855589
	speed: 0.2636s/iter; left time: 7922.4938s
	iters: 300, epoch: 19 | loss: 0.5073816
	speed: 0.2634s/iter; left time: 7890.9866s
Epoch: 19 cost time: 96.48625183105469
Epoch: 19, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.861 Vali Acc: 0.678 Test Loss: 0.861 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2773893
	speed: 0.8225s/iter; left time: 24502.3590s
	iters: 200, epoch: 20 | loss: 0.2542220
	speed: 0.2606s/iter; left time: 7737.3843s
	iters: 300, epoch: 20 | loss: 0.2694885
	speed: 0.2595s/iter; left time: 7679.2287s
Epoch: 20 cost time: 98.63603734970093
Epoch: 20, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.779 Vali Acc: 0.677 Test Loss: 0.779 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4066503
	speed: 0.7987s/iter; left time: 23497.7773s
	iters: 200, epoch: 21 | loss: 0.2914415
	speed: 0.2675s/iter; left time: 7844.0622s
	iters: 300, epoch: 21 | loss: 0.5032055
	speed: 0.2786s/iter; left time: 8141.0905s
Epoch: 21 cost time: 99.1299638748169
Epoch: 21, Steps: 369 | Train Loss: 0.309 Vali Loss: 0.861 Vali Acc: 0.677 Test Loss: 0.861 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.5022307
	speed: 0.8051s/iter; left time: 23390.0112s
	iters: 200, epoch: 22 | loss: 0.5636579
	speed: 0.2517s/iter; left time: 7285.9991s
	iters: 300, epoch: 22 | loss: 0.2101814
	speed: 0.2497s/iter; left time: 7205.0952s
Epoch: 22 cost time: 93.63981580734253
Epoch: 22, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.044 Vali Acc: 0.669 Test Loss: 1.044 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2285708
	speed: 0.7700s/iter; left time: 22086.3008s
	iters: 200, epoch: 23 | loss: 0.1523926
	speed: 0.2602s/iter; left time: 7437.1758s
	iters: 300, epoch: 23 | loss: 0.1454633
	speed: 0.2724s/iter; left time: 7757.9412s
Epoch: 23 cost time: 98.27351760864258
Epoch: 23, Steps: 369 | Train Loss: 0.244 Vali Loss: 0.985 Vali Acc: 0.663 Test Loss: 0.985 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.1432667
	speed: 0.8449s/iter; left time: 23921.4596s
	iters: 200, epoch: 24 | loss: 0.1012023
	speed: 0.2657s/iter; left time: 7497.1014s
	iters: 300, epoch: 24 | loss: 0.1403934
	speed: 0.2590s/iter; left time: 7282.4514s
Epoch: 24 cost time: 98.32986569404602
Epoch: 24, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1666920
	speed: 0.7984s/iter; left time: 22312.0304s
	iters: 200, epoch: 25 | loss: 0.2428496
	speed: 0.2575s/iter; left time: 7169.3029s
	iters: 300, epoch: 25 | loss: 0.0418247
	speed: 0.2510s/iter; left time: 6962.9437s
Epoch: 25 cost time: 96.06731152534485
Epoch: 25, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0020477
	speed: 0.8020s/iter; left time: 22114.8423s
	iters: 200, epoch: 26 | loss: 0.0829324
	speed: 0.2527s/iter; left time: 6943.1162s
	iters: 300, epoch: 26 | loss: 0.0973510
	speed: 0.2465s/iter; left time: 6748.3511s
Epoch: 26 cost time: 94.2141969203949
Epoch: 26, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.473 Vali Acc: 0.647 Test Loss: 1.473 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0109895
	speed: 0.7905s/iter; left time: 21506.3771s
	iters: 200, epoch: 27 | loss: 0.1079013
	speed: 0.2636s/iter; left time: 7144.9824s
	iters: 300, epoch: 27 | loss: 0.0193960
	speed: 0.2655s/iter; left time: 7170.5616s
Epoch: 27 cost time: 96.95954203605652
Epoch: 27, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.640 Vali Acc: 0.645 Test Loss: 1.640 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6952326901248581
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7136800
	speed: 0.2833s/iter; left time: 10423.8928s
	iters: 200, epoch: 1 | loss: 0.9751908
	speed: 0.2653s/iter; left time: 9735.3916s
	iters: 300, epoch: 1 | loss: 0.9730215
	speed: 0.2678s/iter; left time: 9801.2105s
Epoch: 1 cost time: 100.05948972702026
Epoch: 1, Steps: 369 | Train Loss: 0.743 Vali Loss: 0.896 Vali Acc: 0.648 Test Loss: 0.896 Test Acc: 0.648
Validation loss decreased (inf --> -0.648118).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3533375
	speed: 0.8244s/iter; left time: 30033.8877s
	iters: 200, epoch: 2 | loss: 0.6871623
	speed: 0.2630s/iter; left time: 9556.9152s
	iters: 300, epoch: 2 | loss: 0.8015395
	speed: 0.2705s/iter; left time: 9801.2125s
Epoch: 2 cost time: 100.14752507209778
Epoch: 2, Steps: 369 | Train Loss: 0.698 Vali Loss: 0.932 Vali Acc: 0.666 Test Loss: 0.932 Test Acc: 0.666
Validation loss decreased (-0.648118 --> -0.665995).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5265845
	speed: 0.8085s/iter; left time: 29155.9709s
	iters: 200, epoch: 3 | loss: 0.3960970
	speed: 0.2366s/iter; left time: 8508.1746s
	iters: 300, epoch: 3 | loss: 0.9206890
	speed: 0.2462s/iter; left time: 8830.6049s
Epoch: 3 cost time: 91.42699813842773
Epoch: 3, Steps: 369 | Train Loss: 0.766 Vali Loss: 1.268 Vali Acc: 0.656 Test Loss: 1.268 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1643953
	speed: 0.7703s/iter; left time: 27495.7752s
	iters: 200, epoch: 4 | loss: 0.4311037
	speed: 0.2606s/iter; left time: 9274.2223s
	iters: 300, epoch: 4 | loss: 0.3912914
	speed: 0.2707s/iter; left time: 9609.9926s
Epoch: 4 cost time: 97.98076915740967
Epoch: 4, Steps: 369 | Train Loss: 0.782 Vali Loss: 1.232 Vali Acc: 0.611 Test Loss: 1.232 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.1952101
	speed: 0.8442s/iter; left time: 29822.2040s
	iters: 200, epoch: 5 | loss: 0.4854649
	speed: 0.2830s/iter; left time: 9969.0213s
	iters: 300, epoch: 5 | loss: 0.4725154
	speed: 0.2693s/iter; left time: 9460.2027s
Epoch: 5 cost time: 104.26607179641724
Epoch: 5, Steps: 369 | Train Loss: 0.647 Vali Loss: 0.723 Vali Acc: 0.643 Test Loss: 0.723 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6170673
	speed: 0.8561s/iter; left time: 29925.1066s
	iters: 200, epoch: 6 | loss: 0.3802368
	speed: 0.2736s/iter; left time: 9535.0231s
	iters: 300, epoch: 6 | loss: 0.4592081
	speed: 0.2631s/iter; left time: 9143.0112s
Epoch: 6 cost time: 100.78484797477722
Epoch: 6, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.860 Vali Acc: 0.646 Test Loss: 0.860 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5728227
	speed: 0.8092s/iter; left time: 27988.3139s
	iters: 200, epoch: 7 | loss: 0.7133276
	speed: 0.2735s/iter; left time: 9432.0854s
	iters: 300, epoch: 7 | loss: 0.6964843
	speed: 0.2842s/iter; left time: 9771.2410s
Epoch: 7 cost time: 103.34887552261353
Epoch: 7, Steps: 369 | Train Loss: 0.560 Vali Loss: 0.708 Vali Acc: 0.641 Test Loss: 0.708 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6942596
	speed: 0.8511s/iter; left time: 29123.8291s
	iters: 200, epoch: 8 | loss: 0.4633589
	speed: 0.2683s/iter; left time: 9153.9643s
	iters: 300, epoch: 8 | loss: 0.5849733
	speed: 0.2684s/iter; left time: 9130.5545s
Epoch: 8 cost time: 99.60889077186584
Epoch: 8, Steps: 369 | Train Loss: 0.519 Vali Loss: 0.719 Vali Acc: 0.658 Test Loss: 0.719 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.3637065
	speed: 0.7904s/iter; left time: 26754.3606s
	iters: 200, epoch: 9 | loss: 0.7436789
	speed: 0.2625s/iter; left time: 8859.9184s
	iters: 300, epoch: 9 | loss: 0.4525398
	speed: 0.2655s/iter; left time: 8935.3967s
Epoch: 9 cost time: 98.13393306732178
Epoch: 9, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.707 Vali Acc: 0.678 Test Loss: 0.707 Test Acc: 0.678
Validation loss decreased (-0.665995 --> -0.677916).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5372486
	speed: 0.8198s/iter; left time: 27448.0079s
	iters: 200, epoch: 10 | loss: 0.6239712
	speed: 0.2606s/iter; left time: 8697.4848s
	iters: 300, epoch: 10 | loss: 0.3548348
	speed: 0.2682s/iter; left time: 8924.6030s
Epoch: 10 cost time: 98.16240239143372
Epoch: 10, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.744 Vali Acc: 0.673 Test Loss: 0.744 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4472271
	speed: 0.8448s/iter; left time: 27973.0075s
	iters: 200, epoch: 11 | loss: 0.5422339
	speed: 0.2676s/iter; left time: 8832.6180s
	iters: 300, epoch: 11 | loss: 0.5196919
	speed: 0.2573s/iter; left time: 8467.5722s
Epoch: 11 cost time: 97.92026400566101
Epoch: 11, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.768 Vali Acc: 0.664 Test Loss: 0.768 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6804916
	speed: 0.7613s/iter; left time: 24926.3158s
	iters: 200, epoch: 12 | loss: 0.4253947
	speed: 0.2573s/iter; left time: 8400.2758s
	iters: 300, epoch: 12 | loss: 0.2451822
	speed: 0.2661s/iter; left time: 8660.0351s
Epoch: 12 cost time: 96.83101463317871
Epoch: 12, Steps: 369 | Train Loss: 0.455 Vali Loss: 0.758 Vali Acc: 0.646 Test Loss: 0.758 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3267419
	speed: 0.8045s/iter; left time: 26044.2939s
	iters: 200, epoch: 13 | loss: 0.5557007
	speed: 0.2515s/iter; left time: 8117.7177s
	iters: 300, epoch: 13 | loss: 0.4574889
	speed: 0.2479s/iter; left time: 7975.3657s
Epoch: 13 cost time: 93.09457468986511
Epoch: 13, Steps: 369 | Train Loss: 0.436 Vali Loss: 0.824 Vali Acc: 0.674 Test Loss: 0.824 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5329415
	speed: 0.7554s/iter; left time: 24175.5924s
	iters: 200, epoch: 14 | loss: 0.3322294
	speed: 0.2777s/iter; left time: 8861.3336s
	iters: 300, epoch: 14 | loss: 0.2828039
	speed: 0.2754s/iter; left time: 8757.9022s
Epoch: 14 cost time: 101.0450496673584
Epoch: 14, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.769 Vali Acc: 0.681 Test Loss: 0.769 Test Acc: 0.681
Validation loss decreased (-0.677916 --> -0.681320).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1186301
	speed: 0.8011s/iter; left time: 25342.9167s
	iters: 200, epoch: 15 | loss: 0.1461233
	speed: 0.2691s/iter; left time: 8484.7087s
	iters: 300, epoch: 15 | loss: 0.3619091
	speed: 0.2679s/iter; left time: 8422.6500s
Epoch: 15 cost time: 101.40741038322449
Epoch: 15, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.755 Vali Acc: 0.680 Test Loss: 0.755 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1911793
	speed: 0.8293s/iter; left time: 25928.3478s
	iters: 200, epoch: 16 | loss: 0.2110435
	speed: 0.2560s/iter; left time: 7978.8162s
	iters: 300, epoch: 16 | loss: 0.5002105
	speed: 0.2487s/iter; left time: 7727.2126s
Epoch: 16 cost time: 94.03690910339355
Epoch: 16, Steps: 369 | Train Loss: 0.376 Vali Loss: 0.930 Vali Acc: 0.665 Test Loss: 0.930 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6731976
	speed: 0.7762s/iter; left time: 23981.1043s
	iters: 200, epoch: 17 | loss: 0.3106119
	speed: 0.2725s/iter; left time: 8391.1819s
	iters: 300, epoch: 17 | loss: 0.3697986
	speed: 0.2914s/iter; left time: 8944.0309s
Epoch: 17 cost time: 101.41925883293152
Epoch: 17, Steps: 369 | Train Loss: 0.362 Vali Loss: 0.859 Vali Acc: 0.684 Test Loss: 0.859 Test Acc: 0.684
Validation loss decreased (-0.681320 --> -0.684157).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3442206
	speed: 0.8206s/iter; left time: 25050.3156s
	iters: 200, epoch: 18 | loss: 0.6990838
	speed: 0.2584s/iter; left time: 7862.4966s
	iters: 300, epoch: 18 | loss: 0.4272747
	speed: 0.2638s/iter; left time: 8000.2852s
Epoch: 18 cost time: 97.77736806869507
Epoch: 18, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.807 Vali Acc: 0.664 Test Loss: 0.807 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3477603
	speed: 0.8318s/iter; left time: 25084.9404s
	iters: 200, epoch: 19 | loss: 0.2416408
	speed: 0.2726s/iter; left time: 8192.9076s
	iters: 300, epoch: 19 | loss: 0.4390294
	speed: 0.2572s/iter; left time: 7705.5735s
Epoch: 19 cost time: 97.42793774604797
Epoch: 19, Steps: 369 | Train Loss: 0.310 Vali Loss: 1.057 Vali Acc: 0.655 Test Loss: 1.057 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2951393
	speed: 0.7393s/iter; left time: 22022.2814s
	iters: 200, epoch: 20 | loss: 0.2422321
	speed: 0.2627s/iter; left time: 7800.8491s
	iters: 300, epoch: 20 | loss: 0.2179499
	speed: 0.2670s/iter; left time: 7899.7228s
Epoch: 20 cost time: 96.17270612716675
Epoch: 20, Steps: 369 | Train Loss: 0.289 Vali Loss: 0.979 Vali Acc: 0.670 Test Loss: 0.979 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.5783033
	speed: 0.7882s/iter; left time: 23189.9512s
	iters: 200, epoch: 21 | loss: 0.1732399
	speed: 0.2640s/iter; left time: 7742.0625s
	iters: 300, epoch: 21 | loss: 0.6312138
	speed: 0.2458s/iter; left time: 7181.6412s
Epoch: 21 cost time: 93.94168066978455
Epoch: 21, Steps: 369 | Train Loss: 0.259 Vali Loss: 1.049 Vali Acc: 0.657 Test Loss: 1.049 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.2106429
	speed: 0.7918s/iter; left time: 23004.4093s
	iters: 200, epoch: 22 | loss: 0.6402383
	speed: 0.2920s/iter; left time: 8453.3360s
	iters: 300, epoch: 22 | loss: 0.4684132
	speed: 0.2737s/iter; left time: 7897.6987s
Epoch: 22 cost time: 104.57794880867004
Epoch: 22, Steps: 369 | Train Loss: 0.236 Vali Loss: 1.262 Vali Acc: 0.662 Test Loss: 1.262 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1484930
	speed: 0.7789s/iter; left time: 22340.0281s
	iters: 200, epoch: 23 | loss: 0.2567312
	speed: 0.2434s/iter; left time: 6956.1008s
	iters: 300, epoch: 23 | loss: 0.0800559
	speed: 0.2490s/iter; left time: 7091.4743s
Epoch: 23 cost time: 95.50823402404785
Epoch: 23, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.207 Vali Acc: 0.646 Test Loss: 1.207 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.1292155
	speed: 0.8455s/iter; left time: 23938.8229s
	iters: 200, epoch: 24 | loss: 0.2228769
	speed: 0.2735s/iter; left time: 7717.5977s
	iters: 300, epoch: 24 | loss: 0.0739685
	speed: 0.2641s/iter; left time: 7425.8471s
Epoch: 24 cost time: 99.87547278404236
Epoch: 24, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.334 Vali Acc: 0.653 Test Loss: 1.334 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0768384
	speed: 0.7826s/iter; left time: 21870.7478s
	iters: 200, epoch: 25 | loss: 0.1231121
	speed: 0.2701s/iter; left time: 7520.3603s
	iters: 300, epoch: 25 | loss: 0.0656058
	speed: 0.2610s/iter; left time: 7240.9767s
Epoch: 25 cost time: 98.77836775779724
Epoch: 25, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.368 Vali Acc: 0.644 Test Loss: 1.368 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0068865
	speed: 0.8096s/iter; left time: 22324.2297s
	iters: 200, epoch: 26 | loss: 0.1746987
	speed: 0.2571s/iter; left time: 7064.7095s
	iters: 300, epoch: 26 | loss: 0.1118118
	speed: 0.2595s/iter; left time: 7105.3640s
Epoch: 26 cost time: 98.12732028961182
Epoch: 26, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.899 Vali Acc: 0.647 Test Loss: 1.899 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.5446395
	speed: 0.7709s/iter; left time: 20974.9252s
	iters: 200, epoch: 27 | loss: 0.1597405
	speed: 0.2402s/iter; left time: 6509.9252s
	iters: 300, epoch: 27 | loss: 0.0407676
	speed: 0.2553s/iter; left time: 6893.6772s
Epoch: 27 cost time: 93.16590476036072
Epoch: 27, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.623 Vali Acc: 0.651 Test Loss: 1.623 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6841657207718501
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7597890
	speed: 0.2736s/iter; left time: 10069.1490s
	iters: 200, epoch: 1 | loss: 1.1373250
	speed: 0.2527s/iter; left time: 9273.2291s
	iters: 300, epoch: 1 | loss: 1.4482077
	speed: 0.2603s/iter; left time: 9528.8580s
Epoch: 1 cost time: 96.0115237236023
Epoch: 1, Steps: 369 | Train Loss: 0.738 Vali Loss: 0.842 Vali Acc: 0.654 Test Loss: 0.842 Test Acc: 0.654
Validation loss decreased (inf --> -0.653510).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4544718
	speed: 0.7795s/iter; left time: 28399.8908s
	iters: 200, epoch: 2 | loss: 0.9744639
	speed: 0.2643s/iter; left time: 9600.8404s
	iters: 300, epoch: 2 | loss: 1.3590196
	speed: 0.2651s/iter; left time: 9604.6397s
Epoch: 2 cost time: 98.12142825126648
Epoch: 2, Steps: 369 | Train Loss: 0.699 Vali Loss: 1.183 Vali Acc: 0.632 Test Loss: 1.183 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6513032
	speed: 0.7756s/iter; left time: 27970.2242s
	iters: 200, epoch: 3 | loss: 0.4597054
	speed: 0.2538s/iter; left time: 9126.2360s
	iters: 300, epoch: 3 | loss: 0.2580952
	speed: 0.2461s/iter; left time: 8827.6492s
Epoch: 3 cost time: 95.32844972610474
Epoch: 3, Steps: 369 | Train Loss: 0.738 Vali Loss: 1.208 Vali Acc: 0.664 Test Loss: 1.208 Test Acc: 0.664
Validation loss decreased (-0.653510 --> -0.664006).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1981692
	speed: 0.8345s/iter; left time: 29785.9641s
	iters: 200, epoch: 4 | loss: 0.8918633
	speed: 0.2728s/iter; left time: 9708.7084s
	iters: 300, epoch: 4 | loss: 0.4186800
	speed: 0.2606s/iter; left time: 9251.4550s
Epoch: 4 cost time: 101.89722228050232
Epoch: 4, Steps: 369 | Train Loss: 0.768 Vali Loss: 1.380 Vali Acc: 0.636 Test Loss: 1.380 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4650751
	speed: 0.7727s/iter; left time: 27296.2918s
	iters: 200, epoch: 5 | loss: 0.9187216
	speed: 0.2689s/iter; left time: 9471.2645s
	iters: 300, epoch: 5 | loss: 0.4742885
	speed: 0.2737s/iter; left time: 9614.5085s
Epoch: 5 cost time: 98.29147553443909
Epoch: 5, Steps: 369 | Train Loss: 0.759 Vali Loss: 1.275 Vali Acc: 0.629 Test Loss: 1.275 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7217049
	speed: 0.8314s/iter; left time: 29061.5657s
	iters: 200, epoch: 6 | loss: 0.7760978
	speed: 0.2636s/iter; left time: 9189.3376s
	iters: 300, epoch: 6 | loss: 0.4262721
	speed: 0.2465s/iter; left time: 8567.4380s
Epoch: 6 cost time: 96.1951150894165
Epoch: 6, Steps: 369 | Train Loss: 0.619 Vali Loss: 1.039 Vali Acc: 0.654 Test Loss: 1.039 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.1399907
	speed: 0.7501s/iter; left time: 25944.6545s
	iters: 200, epoch: 7 | loss: 0.7830554
	speed: 0.2693s/iter; left time: 9286.5072s
	iters: 300, epoch: 7 | loss: 0.3279611
	speed: 0.2655s/iter; left time: 9129.7289s
Epoch: 7 cost time: 96.8158369064331
Epoch: 7, Steps: 369 | Train Loss: 0.560 Vali Loss: 0.872 Vali Acc: 0.609 Test Loss: 0.872 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3938633
	speed: 0.7392s/iter; left time: 25295.4976s
	iters: 200, epoch: 8 | loss: 0.3905270
	speed: 0.2453s/iter; left time: 8368.2416s
	iters: 300, epoch: 8 | loss: 0.6933120
	speed: 0.2533s/iter; left time: 8615.0848s
Epoch: 8 cost time: 92.69347643852234
Epoch: 8, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.710 Vali Acc: 0.660 Test Loss: 0.710 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5001273
	speed: 0.8079s/iter; left time: 27345.2034s
	iters: 200, epoch: 9 | loss: 0.3893049
	speed: 0.2565s/iter; left time: 8658.0541s
	iters: 300, epoch: 9 | loss: 0.4981643
	speed: 0.2447s/iter; left time: 8234.3318s
Epoch: 9 cost time: 95.4660530090332
Epoch: 9, Steps: 369 | Train Loss: 0.530 Vali Loss: 0.710 Vali Acc: 0.660 Test Loss: 0.710 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5353627
	speed: 0.7644s/iter; left time: 25593.5944s
	iters: 200, epoch: 10 | loss: 0.6103069
	speed: 0.2665s/iter; left time: 8897.2231s
	iters: 300, epoch: 10 | loss: 0.3440999
	speed: 0.2791s/iter; left time: 9287.4516s
Epoch: 10 cost time: 100.97405457496643
Epoch: 10, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.735 Vali Acc: 0.640 Test Loss: 0.735 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.5668268
	speed: 0.8132s/iter; left time: 26924.7879s
	iters: 200, epoch: 11 | loss: 0.4380193
	speed: 0.2507s/iter; left time: 8274.5165s
	iters: 300, epoch: 11 | loss: 0.8041353
	speed: 0.2493s/iter; left time: 8205.4100s
Epoch: 11 cost time: 92.29391813278198
Epoch: 11, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.704 Vali Acc: 0.680 Test Loss: 0.704 Test Acc: 0.680
Validation loss decreased (-0.664006 --> -0.680470).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7868837
	speed: 0.8162s/iter; left time: 26722.9584s
	iters: 200, epoch: 12 | loss: 0.7598230
	speed: 0.2870s/iter; left time: 9368.9779s
	iters: 300, epoch: 12 | loss: 0.2652618
	speed: 0.2706s/iter; left time: 8807.1890s
Epoch: 12 cost time: 102.82249212265015
Epoch: 12, Steps: 369 | Train Loss: 0.468 Vali Loss: 0.786 Vali Acc: 0.667 Test Loss: 0.786 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4851325
	speed: 0.7606s/iter; left time: 24622.6647s
	iters: 200, epoch: 13 | loss: 0.5032769
	speed: 0.2717s/iter; left time: 8769.0776s
	iters: 300, epoch: 13 | loss: 0.2381887
	speed: 0.2811s/iter; left time: 9042.7157s
Epoch: 13 cost time: 100.06536483764648
Epoch: 13, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.702 Vali Acc: 0.669 Test Loss: 0.702 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6456968
	speed: 0.8241s/iter; left time: 26374.8807s
	iters: 200, epoch: 14 | loss: 0.3743879
	speed: 0.2660s/iter; left time: 8484.9291s
	iters: 300, epoch: 14 | loss: 0.2608915
	speed: 0.2700s/iter; left time: 8585.7788s
Epoch: 14 cost time: 97.74902391433716
Epoch: 14, Steps: 369 | Train Loss: 0.445 Vali Loss: 0.737 Vali Acc: 0.668 Test Loss: 0.737 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2460180
	speed: 0.7756s/iter; left time: 24537.1630s
	iters: 200, epoch: 15 | loss: 0.1413356
	speed: 0.2732s/iter; left time: 8614.5919s
	iters: 300, epoch: 15 | loss: 0.1457667
	speed: 0.2666s/iter; left time: 8380.7298s
Epoch: 15 cost time: 100.12140703201294
Epoch: 15, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.694 Vali Acc: 0.672 Test Loss: 0.694 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1819970
	speed: 0.7921s/iter; left time: 24765.3196s
	iters: 200, epoch: 16 | loss: 0.3859908
	speed: 0.2638s/iter; left time: 8220.5588s
	iters: 300, epoch: 16 | loss: 0.2902473
	speed: 0.2668s/iter; left time: 8287.6934s
Epoch: 16 cost time: 99.58663511276245
Epoch: 16, Steps: 369 | Train Loss: 0.413 Vali Loss: 0.815 Vali Acc: 0.692 Test Loss: 0.815 Test Acc: 0.692
Validation loss decreased (-0.680470 --> -0.692103).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6898749
	speed: 0.8305s/iter; left time: 25659.5575s
	iters: 200, epoch: 17 | loss: 0.3920400
	speed: 0.2944s/iter; left time: 9067.1935s
	iters: 300, epoch: 17 | loss: 0.3521455
	speed: 0.2622s/iter; left time: 8048.7391s
Epoch: 17 cost time: 101.89650535583496
Epoch: 17, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.775 Vali Acc: 0.697 Test Loss: 0.775 Test Acc: 0.697
Validation loss decreased (-0.692103 --> -0.696644).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3430365
	speed: 0.7777s/iter; left time: 23740.2000s
	iters: 200, epoch: 18 | loss: 0.4058630
	speed: 0.2514s/iter; left time: 7650.4028s
	iters: 300, epoch: 18 | loss: 0.0916164
	speed: 0.2658s/iter; left time: 8060.7406s
Epoch: 18 cost time: 95.70346665382385
Epoch: 18, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.754 Vali Acc: 0.672 Test Loss: 0.754 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1745427
	speed: 0.7934s/iter; left time: 23927.7162s
	iters: 200, epoch: 19 | loss: 0.2788240
	speed: 0.2630s/iter; left time: 7906.1363s
	iters: 300, epoch: 19 | loss: 0.4533263
	speed: 0.2522s/iter; left time: 7556.7961s
Epoch: 19 cost time: 96.46878170967102
Epoch: 19, Steps: 369 | Train Loss: 0.345 Vali Loss: 0.840 Vali Acc: 0.669 Test Loss: 0.840 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2639787
	speed: 0.7736s/iter; left time: 23046.4543s
	iters: 200, epoch: 20 | loss: 0.0919326
	speed: 0.2549s/iter; left time: 7568.6220s
	iters: 300, epoch: 20 | loss: 0.3077631
	speed: 0.2514s/iter; left time: 7440.0300s
Epoch: 20 cost time: 96.18719720840454
Epoch: 20, Steps: 369 | Train Loss: 0.312 Vali Loss: 0.840 Vali Acc: 0.670 Test Loss: 0.840 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2363859
	speed: 0.7660s/iter; left time: 22535.6283s
	iters: 200, epoch: 21 | loss: 0.2561819
	speed: 0.2620s/iter; left time: 7681.1070s
	iters: 300, epoch: 21 | loss: 0.5240260
	speed: 0.2550s/iter; left time: 7450.6206s
Epoch: 21 cost time: 95.5902943611145
Epoch: 21, Steps: 369 | Train Loss: 0.286 Vali Loss: 0.836 Vali Acc: 0.684 Test Loss: 0.836 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.4134020
	speed: 0.7390s/iter; left time: 21469.9816s
	iters: 200, epoch: 22 | loss: 0.7160662
	speed: 0.2531s/iter; left time: 7326.9694s
	iters: 300, epoch: 22 | loss: 0.1902509
	speed: 0.2619s/iter; left time: 7556.8140s
Epoch: 22 cost time: 93.57045698165894
Epoch: 22, Steps: 369 | Train Loss: 0.263 Vali Loss: 0.887 Vali Acc: 0.669 Test Loss: 0.887 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2169588
	speed: 0.7808s/iter; left time: 22395.0511s
	iters: 200, epoch: 23 | loss: 0.2577989
	speed: 0.2534s/iter; left time: 7244.3232s
	iters: 300, epoch: 23 | loss: 0.1576353
	speed: 0.2540s/iter; left time: 7234.1514s
Epoch: 23 cost time: 93.53370714187622
Epoch: 23, Steps: 369 | Train Loss: 0.235 Vali Loss: 0.908 Vali Acc: 0.666 Test Loss: 0.908 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.1398516
	speed: 0.7854s/iter; left time: 22238.9194s
	iters: 200, epoch: 24 | loss: 0.2432929
	speed: 0.2634s/iter; left time: 7431.7604s
	iters: 300, epoch: 24 | loss: 0.3294447
	speed: 0.2619s/iter; left time: 7363.2534s
Epoch: 24 cost time: 98.134352684021
Epoch: 24, Steps: 369 | Train Loss: 0.221 Vali Loss: 0.894 Vali Acc: 0.656 Test Loss: 0.894 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.1575317
	speed: 0.7835s/iter; left time: 21895.3168s
	iters: 200, epoch: 25 | loss: 0.1060986
	speed: 0.2521s/iter; left time: 7019.5858s
	iters: 300, epoch: 25 | loss: 0.1700222
	speed: 0.2445s/iter; left time: 6783.4908s
Epoch: 25 cost time: 94.15108323097229
Epoch: 25, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.016 Vali Acc: 0.658 Test Loss: 1.016 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0306800
	speed: 0.7720s/iter; left time: 21289.8158s
	iters: 200, epoch: 26 | loss: 0.2461611
	speed: 0.2656s/iter; left time: 7298.8387s
	iters: 300, epoch: 26 | loss: 0.1771075
	speed: 0.2570s/iter; left time: 7036.4760s
Epoch: 26 cost time: 95.55707955360413
Epoch: 26, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.244 Vali Acc: 0.663 Test Loss: 1.244 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0783069
	speed: 0.7518s/iter; left time: 20454.7668s
	iters: 200, epoch: 27 | loss: 0.1407903
	speed: 0.2440s/iter; left time: 6613.9826s
	iters: 300, epoch: 27 | loss: 0.0686990
	speed: 0.2547s/iter; left time: 6879.1338s
Epoch: 27 cost time: 93.16680216789246
Epoch: 27, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.498 Vali Acc: 0.656 Test Loss: 1.498 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6966515323496028
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7160776
	speed: 0.2536s/iter; left time: 9334.1778s
	iters: 200, epoch: 1 | loss: 1.2418309
	speed: 0.2446s/iter; left time: 8976.0903s
	iters: 300, epoch: 1 | loss: 1.0611483
	speed: 0.2467s/iter; left time: 9029.4809s
Epoch: 1 cost time: 91.18399715423584
Epoch: 1, Steps: 369 | Train Loss: 0.757 Vali Loss: 0.886 Vali Acc: 0.657 Test Loss: 0.886 Test Acc: 0.657
Validation loss decreased (inf --> -0.657199).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4439028
	speed: 0.7341s/iter; left time: 26742.9647s
	iters: 200, epoch: 2 | loss: 1.0060395
	speed: 0.2445s/iter; left time: 8883.4945s
	iters: 300, epoch: 2 | loss: 0.7339449
	speed: 0.2458s/iter; left time: 8906.3723s
Epoch: 2 cost time: 90.85722994804382
Epoch: 2, Steps: 369 | Train Loss: 0.685 Vali Loss: 1.182 Vali Acc: 0.628 Test Loss: 1.182 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2370205
	speed: 0.7282s/iter; left time: 26261.9052s
	iters: 200, epoch: 3 | loss: 0.7976143
	speed: 0.2391s/iter; left time: 8599.7789s
	iters: 300, epoch: 3 | loss: 0.7385110
	speed: 0.2414s/iter; left time: 8657.8338s
Epoch: 3 cost time: 89.56948113441467
Epoch: 3, Steps: 369 | Train Loss: 0.699 Vali Loss: 1.175 Vali Acc: 0.642 Test Loss: 1.175 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7689629
	speed: 0.7772s/iter; left time: 27740.4403s
	iters: 200, epoch: 4 | loss: 0.9027811
	speed: 0.2596s/iter; left time: 9241.3557s
	iters: 300, epoch: 4 | loss: 0.3675141
	speed: 0.2335s/iter; left time: 8288.5753s
Epoch: 4 cost time: 92.85943603515625
Epoch: 4, Steps: 369 | Train Loss: 0.646 Vali Loss: 1.011 Vali Acc: 0.656 Test Loss: 1.011 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7948037
	speed: 0.7659s/iter; left time: 27055.7004s
	iters: 200, epoch: 5 | loss: 0.4522745
	speed: 0.2489s/iter; left time: 8768.1469s
	iters: 300, epoch: 5 | loss: 0.7237843
	speed: 0.2546s/iter; left time: 8941.9099s
Epoch: 5 cost time: 92.73550367355347
Epoch: 5, Steps: 369 | Train Loss: 0.594 Vali Loss: 0.747 Vali Acc: 0.663 Test Loss: 0.747 Test Acc: 0.663
Validation loss decreased (-0.657199 --> -0.662592).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6306167
	speed: 0.7538s/iter; left time: 26350.7968s
	iters: 200, epoch: 6 | loss: 0.5333810
	speed: 0.2345s/iter; left time: 8172.1708s
	iters: 300, epoch: 6 | loss: 0.8353540
	speed: 0.2377s/iter; left time: 8261.8409s
Epoch: 6 cost time: 89.23788237571716
Epoch: 6, Steps: 369 | Train Loss: 0.546 Vali Loss: 0.832 Vali Acc: 0.629 Test Loss: 0.832 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6116591
	speed: 0.7516s/iter; left time: 25997.1271s
	iters: 200, epoch: 7 | loss: 0.5777714
	speed: 0.2603s/iter; left time: 8977.6305s
	iters: 300, epoch: 7 | loss: 0.5420331
	speed: 0.2599s/iter; left time: 8936.6218s
Epoch: 7 cost time: 96.02505278587341
Epoch: 7, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.683 Vali Acc: 0.677 Test Loss: 0.683 Test Acc: 0.677
Validation loss decreased (-0.662592 --> -0.676781).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4968346
	speed: 0.7964s/iter; left time: 27251.2507s
	iters: 200, epoch: 8 | loss: 0.3074619
	speed: 0.2669s/iter; left time: 9106.2194s
	iters: 300, epoch: 8 | loss: 0.7618630
	speed: 0.2622s/iter; left time: 8919.3509s
Epoch: 8 cost time: 95.835693359375
Epoch: 8, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.702 Vali Acc: 0.678 Test Loss: 0.702 Test Acc: 0.678
Validation loss decreased (-0.676781 --> -0.677916).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4989210
	speed: 0.8250s/iter; left time: 27924.4082s
	iters: 200, epoch: 9 | loss: 0.3121760
	speed: 0.2728s/iter; left time: 9207.9137s
	iters: 300, epoch: 9 | loss: 0.2862266
	speed: 0.2755s/iter; left time: 9270.1558s
Epoch: 9 cost time: 99.70012903213501
Epoch: 9, Steps: 369 | Train Loss: 0.458 Vali Loss: 0.660 Vali Acc: 0.664 Test Loss: 0.660 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5488371
	speed: 0.7227s/iter; left time: 24196.7270s
	iters: 200, epoch: 10 | loss: 0.5453564
	speed: 0.2539s/iter; left time: 8476.7986s
	iters: 300, epoch: 10 | loss: 0.3451199
	speed: 0.2560s/iter; left time: 8519.2931s
Epoch: 10 cost time: 94.51894640922546
Epoch: 10, Steps: 369 | Train Loss: 0.449 Vali Loss: 0.717 Vali Acc: 0.677 Test Loss: 0.717 Test Acc: 0.677
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4423996
	speed: 0.7960s/iter; left time: 26355.6399s
	iters: 200, epoch: 11 | loss: 0.3097360
	speed: 0.2550s/iter; left time: 8417.8835s
	iters: 300, epoch: 11 | loss: 0.7931888
	speed: 0.2318s/iter; left time: 7629.1122s
Epoch: 11 cost time: 91.55994701385498
Epoch: 11, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.679 Vali Acc: 0.684 Test Loss: 0.679 Test Acc: 0.684
Validation loss decreased (-0.677916 --> -0.684159).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5214072
	speed: 0.7375s/iter; left time: 24146.7369s
	iters: 200, epoch: 12 | loss: 0.4238677
	speed: 0.2425s/iter; left time: 7915.2879s
	iters: 300, epoch: 12 | loss: 0.2275086
	speed: 0.2539s/iter; left time: 8263.4367s
Epoch: 12 cost time: 92.89216184616089
Epoch: 12, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.765 Vali Acc: 0.663 Test Loss: 0.765 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4563672
	speed: 0.7612s/iter; left time: 24643.0647s
	iters: 200, epoch: 13 | loss: 0.3441968
	speed: 0.2426s/iter; left time: 7829.5841s
	iters: 300, epoch: 13 | loss: 0.2761579
	speed: 0.2377s/iter; left time: 7646.8745s
Epoch: 13 cost time: 88.63739609718323
Epoch: 13, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.686 Vali Acc: 0.676 Test Loss: 0.686 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3563153
	speed: 0.7386s/iter; left time: 23639.2748s
	iters: 200, epoch: 14 | loss: 0.2628175
	speed: 0.2531s/iter; left time: 8073.8804s
	iters: 300, epoch: 14 | loss: 0.2770653
	speed: 0.2539s/iter; left time: 8073.8972s
Epoch: 14 cost time: 92.94258761405945
Epoch: 14, Steps: 369 | Train Loss: 0.352 Vali Loss: 0.754 Vali Acc: 0.670 Test Loss: 0.754 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2298102
	speed: 0.7434s/iter; left time: 23515.9168s
	iters: 200, epoch: 15 | loss: 0.0850720
	speed: 0.2280s/iter; left time: 7190.1140s
	iters: 300, epoch: 15 | loss: 0.4451424
	speed: 0.2318s/iter; left time: 7287.3775s
Epoch: 15 cost time: 85.48814988136292
Epoch: 15, Steps: 369 | Train Loss: 0.350 Vali Loss: 0.744 Vali Acc: 0.671 Test Loss: 0.744 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1154110
	speed: 0.7316s/iter; left time: 22872.6550s
	iters: 200, epoch: 16 | loss: 0.2163121
	speed: 0.2642s/iter; left time: 8233.9728s
	iters: 300, epoch: 16 | loss: 0.3400448
	speed: 0.2570s/iter; left time: 7985.0915s
Epoch: 16 cost time: 94.69496393203735
Epoch: 16, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.989 Vali Acc: 0.676 Test Loss: 0.989 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5225230
	speed: 0.7257s/iter; left time: 22421.4900s
	iters: 200, epoch: 17 | loss: 0.4295352
	speed: 0.2365s/iter; left time: 7282.8373s
	iters: 300, epoch: 17 | loss: 0.2015191
	speed: 0.2335s/iter; left time: 7168.4787s
Epoch: 17 cost time: 88.38213896751404
Epoch: 17, Steps: 369 | Train Loss: 0.303 Vali Loss: 0.924 Vali Acc: 0.682 Test Loss: 0.924 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3433419
	speed: 0.7806s/iter; left time: 23830.7046s
	iters: 200, epoch: 18 | loss: 0.6412483
	speed: 0.2748s/iter; left time: 8361.7052s
	iters: 300, epoch: 18 | loss: 0.1953764
	speed: 0.2514s/iter; left time: 7625.6047s
Epoch: 18 cost time: 96.23175740242004
Epoch: 18, Steps: 369 | Train Loss: 0.271 Vali Loss: 0.803 Vali Acc: 0.663 Test Loss: 0.803 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2400717
	speed: 0.7425s/iter; left time: 22393.6344s
	iters: 200, epoch: 19 | loss: 0.1139049
	speed: 0.2551s/iter; left time: 7666.7519s
	iters: 300, epoch: 19 | loss: 0.1729853
	speed: 0.2500s/iter; left time: 7491.1291s
Epoch: 19 cost time: 92.90867567062378
Epoch: 19, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.063 Vali Acc: 0.649 Test Loss: 1.063 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0670584
	speed: 0.7777s/iter; left time: 23166.6768s
	iters: 200, epoch: 20 | loss: 0.0661634
	speed: 0.2741s/iter; left time: 8138.0233s
	iters: 300, epoch: 20 | loss: 0.4495228
	speed: 0.2869s/iter; left time: 8488.3642s
Epoch: 20 cost time: 102.02166032791138
Epoch: 20, Steps: 369 | Train Loss: 0.226 Vali Loss: 0.978 Vali Acc: 0.670 Test Loss: 0.978 Test Acc: 0.670
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.3884425
	speed: 0.7793s/iter; left time: 22927.8849s
	iters: 200, epoch: 21 | loss: 0.0568269
	speed: 0.2645s/iter; left time: 7756.0172s
	iters: 300, epoch: 21 | loss: 0.1886591
	speed: 0.2703s/iter; left time: 7898.0494s
Epoch: 21 cost time: 100.13743901252747
Epoch: 21, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.183 Vali Acc: 0.657 Test Loss: 1.183 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6841657207718501
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7423071
	speed: 0.2618s/iter; left time: 9635.8547s
	iters: 200, epoch: 1 | loss: 1.2654891
	speed: 0.2763s/iter; left time: 10141.3833s
	iters: 300, epoch: 1 | loss: 0.7401367
	speed: 0.2719s/iter; left time: 9951.7716s
Epoch: 1 cost time: 100.99224042892456
Epoch: 1, Steps: 369 | Train Loss: 0.748 Vali Loss: 0.888 Vali Acc: 0.652 Test Loss: 0.888 Test Acc: 0.652
Validation loss decreased (inf --> -0.652375).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6563246
	speed: 0.8125s/iter; left time: 29599.3414s
	iters: 200, epoch: 2 | loss: 1.0162768
	speed: 0.2645s/iter; left time: 9608.7582s
	iters: 300, epoch: 2 | loss: 1.1108586
	speed: 0.2861s/iter; left time: 10364.3151s
Epoch: 2 cost time: 99.34479522705078
Epoch: 2, Steps: 369 | Train Loss: 0.694 Vali Loss: 0.945 Vali Acc: 0.654 Test Loss: 0.945 Test Acc: 0.654
Validation loss decreased (-0.652375 --> -0.654361).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6165673
	speed: 0.7938s/iter; left time: 28627.0067s
	iters: 200, epoch: 3 | loss: 0.8168288
	speed: 0.2615s/iter; left time: 9404.2094s
	iters: 300, epoch: 3 | loss: 0.7211983
	speed: 0.2910s/iter; left time: 10437.4280s
Epoch: 3 cost time: 102.32674431800842
Epoch: 3, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.859 Vali Acc: 0.666 Test Loss: 0.859 Test Acc: 0.666
Validation loss decreased (-0.654361 --> -0.666280).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5307621
	speed: 0.8083s/iter; left time: 28850.7429s
	iters: 200, epoch: 4 | loss: 0.5471301
	speed: 0.2538s/iter; left time: 9032.0702s
	iters: 300, epoch: 4 | loss: 0.4367097
	speed: 0.2550s/iter; left time: 9049.7280s
Epoch: 4 cost time: 96.73421335220337
Epoch: 4, Steps: 369 | Train Loss: 0.623 Vali Loss: 0.879 Vali Acc: 0.610 Test Loss: 0.879 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6020164
	speed: 0.8341s/iter; left time: 29465.3948s
	iters: 200, epoch: 5 | loss: 0.4817159
	speed: 0.2576s/iter; left time: 9075.5396s
	iters: 300, epoch: 5 | loss: 0.3602343
	speed: 0.2594s/iter; left time: 9111.8460s
Epoch: 5 cost time: 96.96324014663696
Epoch: 5, Steps: 369 | Train Loss: 0.608 Vali Loss: 0.728 Vali Acc: 0.616 Test Loss: 0.728 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5770001
	speed: 0.8056s/iter; left time: 28161.5272s
	iters: 200, epoch: 6 | loss: 0.3310803
	speed: 0.2756s/iter; left time: 9608.0208s
	iters: 300, epoch: 6 | loss: 0.7876891
	speed: 0.2683s/iter; left time: 9324.7740s
Epoch: 6 cost time: 101.30394053459167
Epoch: 6, Steps: 369 | Train Loss: 0.588 Vali Loss: 0.804 Vali Acc: 0.636 Test Loss: 0.804 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7146980
	speed: 0.7979s/iter; left time: 27596.9392s
	iters: 200, epoch: 7 | loss: 1.1085944
	speed: 0.2619s/iter; left time: 9033.8240s
	iters: 300, epoch: 7 | loss: 0.5014749
	speed: 0.2613s/iter; left time: 8985.0065s
Epoch: 7 cost time: 98.2123384475708
Epoch: 7, Steps: 369 | Train Loss: 0.580 Vali Loss: 0.746 Vali Acc: 0.655 Test Loss: 0.746 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.4637714
	speed: 0.8124s/iter; left time: 27798.0527s
	iters: 200, epoch: 8 | loss: 0.4194928
	speed: 0.2744s/iter; left time: 9361.3348s
	iters: 300, epoch: 8 | loss: 0.6097557
	speed: 0.2729s/iter; left time: 9282.6986s
Epoch: 8 cost time: 100.16688990592957
Epoch: 8, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.727 Vali Acc: 0.666 Test Loss: 0.727 Test Acc: 0.666
Validation loss decreased (-0.666280 --> -0.666281).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4105995
	speed: 0.8158s/iter; left time: 27612.5192s
	iters: 200, epoch: 9 | loss: 0.3295463
	speed: 0.2857s/iter; left time: 9643.2199s
	iters: 300, epoch: 9 | loss: 0.5177436
	speed: 0.2753s/iter; left time: 9262.0548s
Epoch: 9 cost time: 103.72740077972412
Epoch: 9, Steps: 369 | Train Loss: 0.538 Vali Loss: 0.718 Vali Acc: 0.669 Test Loss: 0.718 Test Acc: 0.669
Validation loss decreased (-0.666281 --> -0.669403).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5619047
	speed: 0.8232s/iter; left time: 27561.8873s
	iters: 200, epoch: 10 | loss: 0.3966199
	speed: 0.2826s/iter; left time: 9434.0104s
	iters: 300, epoch: 10 | loss: 0.3589393
	speed: 0.2690s/iter; left time: 8953.3530s
Epoch: 10 cost time: 103.28548336029053
Epoch: 10, Steps: 369 | Train Loss: 0.498 Vali Loss: 0.694 Vali Acc: 0.678 Test Loss: 0.694 Test Acc: 0.678
Validation loss decreased (-0.669403 --> -0.677632).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5401239
	speed: 0.7654s/iter; left time: 25342.7006s
	iters: 200, epoch: 11 | loss: 0.2987574
	speed: 0.2512s/iter; left time: 8293.5599s
	iters: 300, epoch: 11 | loss: 0.9804541
	speed: 0.2733s/iter; left time: 8992.9728s
Epoch: 11 cost time: 96.59947562217712
Epoch: 11, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.716 Vali Acc: 0.670 Test Loss: 0.716 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5389543
	speed: 0.7775s/iter; left time: 25457.8303s
	iters: 200, epoch: 12 | loss: 0.5472797
	speed: 0.2623s/iter; left time: 8561.6912s
	iters: 300, epoch: 12 | loss: 0.2870469
	speed: 0.2721s/iter; left time: 8855.2048s
Epoch: 12 cost time: 97.4894483089447
Epoch: 12, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.671 Vali Acc: 0.688 Test Loss: 0.671 Test Acc: 0.688
Validation loss decreased (-0.677632 --> -0.688416).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3077486
	speed: 0.7612s/iter; left time: 24643.7311s
	iters: 200, epoch: 13 | loss: 0.5915534
	speed: 0.2521s/iter; left time: 8136.5539s
	iters: 300, epoch: 13 | loss: 0.4256263
	speed: 0.2621s/iter; left time: 8431.2610s
Epoch: 13 cost time: 96.6494517326355
Epoch: 13, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.653 Vali Acc: 0.694 Test Loss: 0.653 Test Acc: 0.694
Validation loss decreased (-0.688416 --> -0.694091).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4820274
	speed: 0.7953s/iter; left time: 25452.2483s
	iters: 200, epoch: 14 | loss: 0.3825438
	speed: 0.2542s/iter; left time: 8109.9691s
	iters: 300, epoch: 14 | loss: 0.3773310
	speed: 0.2529s/iter; left time: 8044.1372s
Epoch: 14 cost time: 94.48049879074097
Epoch: 14, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.694 Vali Acc: 0.689 Test Loss: 0.694 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1106533
	speed: 0.7877s/iter; left time: 24919.5923s
	iters: 200, epoch: 15 | loss: 0.1776933
	speed: 0.2597s/iter; left time: 8190.4817s
	iters: 300, epoch: 15 | loss: 0.3009615
	speed: 0.2590s/iter; left time: 8141.7418s
Epoch: 15 cost time: 96.76889944076538
Epoch: 15, Steps: 369 | Train Loss: 0.434 Vali Loss: 0.714 Vali Acc: 0.687 Test Loss: 0.714 Test Acc: 0.687
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1557583
	speed: 0.8172s/iter; left time: 25549.1474s
	iters: 200, epoch: 16 | loss: 0.4048814
	speed: 0.2630s/iter; left time: 8197.3278s
	iters: 300, epoch: 16 | loss: 0.3914492
	speed: 0.2437s/iter; left time: 7569.6831s
Epoch: 16 cost time: 96.39610052108765
Epoch: 16, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.775 Vali Acc: 0.692 Test Loss: 0.775 Test Acc: 0.692
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6397762
	speed: 0.7941s/iter; left time: 24534.7771s
	iters: 200, epoch: 17 | loss: 0.3939703
	speed: 0.2804s/iter; left time: 8635.5118s
	iters: 300, epoch: 17 | loss: 0.3746886
	speed: 0.2573s/iter; left time: 7897.3467s
Epoch: 17 cost time: 98.08817315101624
Epoch: 17, Steps: 369 | Train Loss: 0.401 Vali Loss: 0.733 Vali Acc: 0.695 Test Loss: 0.733 Test Acc: 0.695
Validation loss decreased (-0.694091 --> -0.694658).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3730364
	speed: 0.7914s/iter; left time: 24158.4310s
	iters: 200, epoch: 18 | loss: 0.4463742
	speed: 0.2549s/iter; left time: 7757.5091s
	iters: 300, epoch: 18 | loss: 0.3125200
	speed: 0.2700s/iter; left time: 8188.2040s
Epoch: 18 cost time: 98.74480533599854
Epoch: 18, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.647 Vali Acc: 0.675 Test Loss: 0.647 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.2565970
	speed: 0.8241s/iter; left time: 24854.5540s
	iters: 200, epoch: 19 | loss: 0.3592157
	speed: 0.2532s/iter; left time: 7610.9763s
	iters: 300, epoch: 19 | loss: 0.4052357
	speed: 0.2467s/iter; left time: 7391.2661s
Epoch: 19 cost time: 93.88356518745422
Epoch: 19, Steps: 369 | Train Loss: 0.379 Vali Loss: 0.730 Vali Acc: 0.675 Test Loss: 0.730 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.5992079
	speed: 0.7329s/iter; left time: 21832.9210s
	iters: 200, epoch: 20 | loss: 0.4230316
	speed: 0.2703s/iter; left time: 8023.9258s
	iters: 300, epoch: 20 | loss: 0.4998105
	speed: 0.2780s/iter; left time: 8224.5429s
Epoch: 20 cost time: 99.32966256141663
Epoch: 20, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.738 Vali Acc: 0.671 Test Loss: 0.738 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4335397
	speed: 0.7654s/iter; left time: 22518.4340s
	iters: 200, epoch: 21 | loss: 0.3132675
	speed: 0.2611s/iter; left time: 7655.0291s
	iters: 300, epoch: 21 | loss: 0.2685413
	speed: 0.2515s/iter; left time: 7350.3918s
Epoch: 21 cost time: 94.35394334793091
Epoch: 21, Steps: 369 | Train Loss: 0.338 Vali Loss: 0.811 Vali Acc: 0.682 Test Loss: 0.811 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3276671
	speed: 0.8330s/iter; left time: 24201.1007s
	iters: 200, epoch: 22 | loss: 0.6797215
	speed: 0.2775s/iter; left time: 8034.4674s
	iters: 300, epoch: 22 | loss: 0.3380523
	speed: 0.2480s/iter; left time: 7154.9068s
Epoch: 22 cost time: 97.62777948379517
Epoch: 22, Steps: 369 | Train Loss: 0.322 Vali Loss: 0.806 Vali Acc: 0.685 Test Loss: 0.806 Test Acc: 0.685
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.4410489
	speed: 0.7346s/iter; left time: 21069.1429s
	iters: 200, epoch: 23 | loss: 0.3338039
	speed: 0.2439s/iter; left time: 6971.3465s
	iters: 300, epoch: 23 | loss: 0.1593244
	speed: 0.2588s/iter; left time: 7370.9825s
Epoch: 23 cost time: 94.10109257698059
Epoch: 23, Steps: 369 | Train Loss: 0.310 Vali Loss: 0.783 Vali Acc: 0.664 Test Loss: 0.783 Test Acc: 0.664
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.2112136
	speed: 0.8090s/iter; left time: 22907.0996s
	iters: 200, epoch: 24 | loss: 0.2592909
	speed: 0.2400s/iter; left time: 6772.1151s
	iters: 300, epoch: 24 | loss: 0.5118691
	speed: 0.2481s/iter; left time: 6973.7626s
Epoch: 24 cost time: 91.34325861930847
Epoch: 24, Steps: 369 | Train Loss: 0.273 Vali Loss: 0.795 Vali Acc: 0.661 Test Loss: 0.795 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2674060
	speed: 0.7640s/iter; left time: 21349.2053s
	iters: 200, epoch: 25 | loss: 0.1187842
	speed: 0.2600s/iter; left time: 7240.5606s
	iters: 300, epoch: 25 | loss: 0.3043832
	speed: 0.2592s/iter; left time: 7190.6867s
Epoch: 25 cost time: 96.5655505657196
Epoch: 25, Steps: 369 | Train Loss: 0.244 Vali Loss: 0.899 Vali Acc: 0.649 Test Loss: 0.899 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1149621
	speed: 0.7682s/iter; left time: 21184.0637s
	iters: 200, epoch: 26 | loss: 0.2910127
	speed: 0.2543s/iter; left time: 6987.1350s
	iters: 300, epoch: 26 | loss: 0.1024355
	speed: 0.2526s/iter; left time: 6916.0547s
Epoch: 26 cost time: 95.01945304870605
Epoch: 26, Steps: 369 | Train Loss: 0.219 Vali Loss: 0.942 Vali Acc: 0.662 Test Loss: 0.942 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0221136
	speed: 0.8119s/iter; left time: 22089.2787s
	iters: 200, epoch: 27 | loss: 0.0734016
	speed: 0.2617s/iter; left time: 7095.1564s
	iters: 300, epoch: 27 | loss: 0.2253096
	speed: 0.2544s/iter; left time: 6871.5702s
Epoch: 27 cost time: 97.83140683174133
Epoch: 27, Steps: 369 | Train Loss: 0.181 Vali Loss: 1.055 Vali Acc: 0.661 Test Loss: 1.055 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6946651532349603
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6934533
	speed: 0.2730s/iter; left time: 10046.8593s
	iters: 200, epoch: 1 | loss: 0.6931490
	speed: 0.2663s/iter; left time: 9773.0849s
	iters: 300, epoch: 1 | loss: 0.6931529
	speed: 0.2633s/iter; left time: 9636.5757s
Epoch: 1 cost time: 98.45596170425415
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6927407
	speed: 0.8286s/iter; left time: 30187.3210s
	iters: 200, epoch: 2 | loss: 0.6931481
	speed: 0.2753s/iter; left time: 10001.3657s
	iters: 300, epoch: 2 | loss: 0.6918741
	speed: 0.2724s/iter; left time: 9868.0017s
Epoch: 2 cost time: 102.4676103591919
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6907495
	speed: 0.7944s/iter; left time: 28646.7764s
	iters: 200, epoch: 3 | loss: 0.6931891
	speed: 0.2543s/iter; left time: 9144.5620s
	iters: 300, epoch: 3 | loss: 0.6922302
	speed: 0.2453s/iter; left time: 8795.6416s
Epoch: 3 cost time: 93.49610948562622
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6961275
	speed: 0.8188s/iter; left time: 29226.2822s
	iters: 200, epoch: 4 | loss: 0.6932094
	speed: 0.2748s/iter; left time: 9779.6898s
	iters: 300, epoch: 4 | loss: 0.6939837
	speed: 0.2604s/iter; left time: 9242.7462s
Epoch: 4 cost time: 98.55298328399658
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6913968
	speed: 0.7374s/iter; left time: 26050.0766s
	iters: 200, epoch: 5 | loss: 0.6918150
	speed: 0.2556s/iter; left time: 9002.4359s
	iters: 300, epoch: 5 | loss: 0.6914834
	speed: 0.2690s/iter; left time: 9447.2350s
Epoch: 5 cost time: 96.70614838600159
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6937390
	speed: 0.8139s/iter; left time: 28451.8448s
	iters: 200, epoch: 6 | loss: 0.6927603
	speed: 0.2331s/iter; left time: 8125.7089s
	iters: 300, epoch: 6 | loss: 0.6943927
	speed: 0.2420s/iter; left time: 8411.8024s
Epoch: 6 cost time: 90.32129406929016
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6942562
	speed: 0.7227s/iter; left time: 24995.5047s
	iters: 200, epoch: 7 | loss: 0.6942673
	speed: 0.2517s/iter; left time: 8679.2224s
	iters: 300, epoch: 7 | loss: 0.6922497
	speed: 0.2640s/iter; left time: 9076.9506s
Epoch: 7 cost time: 93.74415183067322
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6935086
	speed: 0.8097s/iter; left time: 27705.5021s
	iters: 200, epoch: 8 | loss: 0.6920807
	speed: 0.2447s/iter; left time: 8350.1389s
	iters: 300, epoch: 8 | loss: 0.6933321
	speed: 0.2404s/iter; left time: 8177.6717s
Epoch: 8 cost time: 91.83025765419006
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6935800
	speed: 0.7818s/iter; left time: 26463.0147s
	iters: 200, epoch: 9 | loss: 0.6905922
	speed: 0.2758s/iter; left time: 9308.5401s
	iters: 300, epoch: 9 | loss: 0.6931883
	speed: 0.2622s/iter; left time: 8823.7914s
Epoch: 9 cost time: 98.79314613342285
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6933628
	speed: 0.7297s/iter; left time: 24430.3242s
	iters: 200, epoch: 10 | loss: 0.6919427
	speed: 0.2444s/iter; left time: 8156.9470s
	iters: 300, epoch: 10 | loss: 0.6936909
	speed: 0.2591s/iter; left time: 8621.6582s
Epoch: 10 cost time: 93.34814071655273
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6931565
	speed: 0.8057s/iter; left time: 26676.0808s
	iters: 200, epoch: 11 | loss: 0.6920460
	speed: 0.2499s/iter; left time: 8250.1160s
	iters: 300, epoch: 11 | loss: 0.6931474
	speed: 0.2357s/iter; left time: 7757.2257s
Epoch: 11 cost time: 91.45561838150024
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6901678
	speed: 0.7177s/iter; left time: 23500.2606s
	iters: 200, epoch: 12 | loss: 0.6955281
	speed: 0.2519s/iter; left time: 8220.9696s
	iters: 300, epoch: 12 | loss: 0.6944799
	speed: 0.2639s/iter; left time: 8589.1856s
Epoch: 12 cost time: 94.70407152175903
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6932176
	speed: 0.7804s/iter; left time: 25262.3686s
	iters: 200, epoch: 13 | loss: 0.6894363
	speed: 0.2323s/iter; left time: 7495.5897s
	iters: 300, epoch: 13 | loss: 0.6943570
	speed: 0.2340s/iter; left time: 7527.2578s
Epoch: 13 cost time: 89.0288314819336
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6916128
	speed: 0.7539s/iter; left time: 24126.8524s
	iters: 200, epoch: 14 | loss: 0.6931840
	speed: 0.2587s/iter; left time: 8254.6263s
	iters: 300, epoch: 14 | loss: 0.6934954
	speed: 0.2561s/iter; left time: 8146.4881s
Epoch: 14 cost time: 94.66987180709839
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6923891
	speed: 0.7508s/iter; left time: 23753.1292s
	iters: 200, epoch: 15 | loss: 0.6935779
	speed: 0.2321s/iter; left time: 7318.8981s
	iters: 300, epoch: 15 | loss: 0.6931708
	speed: 0.2536s/iter; left time: 7971.8895s
Epoch: 15 cost time: 91.4010214805603
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6938390
	speed: 0.7690s/iter; left time: 24043.5496s
	iters: 200, epoch: 16 | loss: 0.6904833
	speed: 0.2603s/iter; left time: 8111.2481s
	iters: 300, epoch: 16 | loss: 0.6931476
	speed: 0.2603s/iter; left time: 8086.9412s
Epoch: 16 cost time: 96.60061717033386
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6936910
	speed: 0.7941s/iter; left time: 24533.8746s
	iters: 200, epoch: 17 | loss: 0.6931754
	speed: 0.2679s/iter; left time: 8249.4590s
	iters: 300, epoch: 17 | loss: 0.6940493
	speed: 0.2567s/iter; left time: 7880.9675s
Epoch: 17 cost time: 97.43366312980652
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6966903
	speed: 0.7950s/iter; left time: 24270.1473s
	iters: 200, epoch: 18 | loss: 0.6963515
	speed: 0.2636s/iter; left time: 8019.9787s
	iters: 300, epoch: 18 | loss: 0.6939052
	speed: 0.2664s/iter; left time: 8080.8527s
Epoch: 18 cost time: 97.63170266151428
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6939046
	speed: 0.7775s/iter; left time: 23447.3744s
	iters: 200, epoch: 19 | loss: 0.6931635
	speed: 0.2473s/iter; left time: 7432.7600s
	iters: 300, epoch: 19 | loss: 0.6941260
	speed: 0.2528s/iter; left time: 7573.2830s
Epoch: 19 cost time: 92.9319396018982
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6931680
	speed: 0.7639s/iter; left time: 22755.5259s
	iters: 200, epoch: 20 | loss: 0.6931573
	speed: 0.2475s/iter; left time: 7347.6353s
	iters: 300, epoch: 20 | loss: 0.6939669
	speed: 0.2449s/iter; left time: 7247.1624s
Epoch: 20 cost time: 90.57368969917297
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.6949019
	speed: 0.7204s/iter; left time: 21194.9233s
	iters: 200, epoch: 21 | loss: 0.6935954
	speed: 0.2465s/iter; left time: 7228.9051s
	iters: 300, epoch: 21 | loss: 0.6931475
	speed: 0.2501s/iter; left time: 7307.9650s
Epoch: 21 cost time: 92.279061794281
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6932312
	speed: 0.7682s/iter; left time: 22316.6442s
	iters: 200, epoch: 22 | loss: 0.6929531
	speed: 0.2386s/iter; left time: 6908.1344s
	iters: 300, epoch: 22 | loss: 0.6931579
	speed: 0.2489s/iter; left time: 7179.9104s
Epoch: 22 cost time: 90.65643739700317
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.6935171
	speed: 0.7960s/iter; left time: 22832.2004s
	iters: 200, epoch: 23 | loss: 0.6931615
	speed: 0.2749s/iter; left time: 7857.9941s
	iters: 300, epoch: 23 | loss: 0.6926712
	speed: 0.2855s/iter; left time: 8131.4125s
Epoch: 23 cost time: 102.71527671813965
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.6934868
	speed: 0.7738s/iter; left time: 21910.6566s
	iters: 200, epoch: 24 | loss: 0.6935219
	speed: 0.2515s/iter; left time: 7094.5000s
	iters: 300, epoch: 24 | loss: 0.6944577
	speed: 0.2720s/iter; left time: 7646.0685s
Epoch: 24 cost time: 97.83485651016235
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.6956457
	speed: 0.8477s/iter; left time: 23689.5990s
	iters: 200, epoch: 25 | loss: 0.6952741
	speed: 0.2529s/iter; left time: 7040.7710s
	iters: 300, epoch: 25 | loss: 0.6929840
	speed: 0.2558s/iter; left time: 7095.8568s
Epoch: 25 cost time: 97.92834615707397
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.6939933
	speed: 0.8378s/iter; left time: 23104.4842s
	iters: 200, epoch: 26 | loss: 0.6931698
	speed: 0.2881s/iter; left time: 7914.8531s
	iters: 300, epoch: 26 | loss: 0.6964508
	speed: 0.2738s/iter; left time: 7495.7728s
Epoch: 26 cost time: 103.07681608200073
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6931549
	speed: 0.7726s/iter; left time: 21019.5972s
	iters: 200, epoch: 27 | loss: 0.6926412
	speed: 0.2668s/iter; left time: 7231.6771s
	iters: 300, epoch: 27 | loss: 0.6940334
	speed: 0.2692s/iter; left time: 7269.4005s
Epoch: 27 cost time: 100.10599207878113
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.6930200
	speed: 0.8253s/iter; left time: 22148.4076s
	iters: 200, epoch: 28 | loss: 0.6931869
	speed: 0.2448s/iter; left time: 6546.4125s
	iters: 300, epoch: 28 | loss: 0.6912025
	speed: 0.2481s/iter; left time: 6609.1824s
Epoch: 28 cost time: 92.80294156074524
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.6922142
	speed: 0.8099s/iter; left time: 21437.1038s
	iters: 200, epoch: 29 | loss: 0.6925296
	speed: 0.2748s/iter; left time: 7246.0326s
	iters: 300, epoch: 29 | loss: 0.6930966
	speed: 0.2507s/iter; left time: 6584.4042s
Epoch: 29 cost time: 99.04087448120117
Epoch: 29, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.6982224
	speed: 0.7631s/iter; left time: 19917.8496s
	iters: 200, epoch: 30 | loss: 0.6930088
	speed: 0.2620s/iter; left time: 6811.2487s
	iters: 300, epoch: 30 | loss: 0.6952153
	speed: 0.2634s/iter; left time: 6822.2270s
Epoch: 30 cost time: 97.0375428199768
Epoch: 30, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 5348610
model size : 30.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5692078
	speed: 0.2757s/iter; left time: 10144.9430s
	iters: 200, epoch: 1 | loss: 0.4285160
	speed: 0.2389s/iter; left time: 8769.5008s
	iters: 300, epoch: 1 | loss: 0.7714302
	speed: 0.2485s/iter; left time: 9096.5954s
Epoch: 1 cost time: 94.58942818641663
Epoch: 1, Steps: 369 | Train Loss: 0.676 Vali Loss: 1.092 Vali Acc: 0.613 Test Loss: 1.092 Test Acc: 0.613
Validation loss decreased (inf --> -0.612645).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4838909
	speed: 0.7948s/iter; left time: 28954.9472s
	iters: 200, epoch: 2 | loss: 0.3250701
	speed: 0.2578s/iter; left time: 9366.9867s
	iters: 300, epoch: 2 | loss: 0.5237135
	speed: 0.2383s/iter; left time: 8632.8799s
Epoch: 2 cost time: 93.10984492301941
Epoch: 2, Steps: 369 | Train Loss: 0.644 Vali Loss: 1.061 Vali Acc: 0.646 Test Loss: 1.061 Test Acc: 0.646
Validation loss decreased (-0.612645 --> -0.646414).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6011190
	speed: 0.7447s/iter; left time: 26855.9681s
	iters: 200, epoch: 3 | loss: 0.4697591
	speed: 0.2702s/iter; left time: 9715.9603s
	iters: 300, epoch: 3 | loss: 0.7150731
	speed: 0.2573s/iter; left time: 9226.2840s
Epoch: 3 cost time: 96.41706109046936
Epoch: 3, Steps: 369 | Train Loss: 0.654 Vali Loss: 1.467 Vali Acc: 0.636 Test Loss: 1.467 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7272930
	speed: 0.7569s/iter; left time: 27018.1197s
	iters: 200, epoch: 4 | loss: 1.4441423
	speed: 0.2478s/iter; left time: 8821.8395s
	iters: 300, epoch: 4 | loss: 0.8490008
	speed: 0.2553s/iter; left time: 9060.8787s
Epoch: 4 cost time: 93.23957347869873
Epoch: 4, Steps: 369 | Train Loss: 0.694 Vali Loss: 1.490 Vali Acc: 0.644 Test Loss: 1.490 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7830839
	speed: 0.7600s/iter; left time: 26848.6438s
	iters: 200, epoch: 5 | loss: 0.6791126
	speed: 0.2329s/iter; left time: 8204.9630s
	iters: 300, epoch: 5 | loss: 1.0130731
	speed: 0.2342s/iter; left time: 8226.6473s
Epoch: 5 cost time: 89.5431580543518
Epoch: 5, Steps: 369 | Train Loss: 0.711 Vali Loss: 2.222 Vali Acc: 0.630 Test Loss: 2.222 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.8000135
	speed: 0.7450s/iter; left time: 26041.0299s
	iters: 200, epoch: 6 | loss: 1.4696432
	speed: 0.2679s/iter; left time: 9338.6229s
	iters: 300, epoch: 6 | loss: 0.6102448
	speed: 0.2740s/iter; left time: 9523.1454s
Epoch: 6 cost time: 98.02634525299072
Epoch: 6, Steps: 369 | Train Loss: 0.659 Vali Loss: 1.518 Vali Acc: 0.650 Test Loss: 1.518 Test Acc: 0.650
Validation loss decreased (-0.646414 --> -0.649815).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0148818
	speed: 0.7845s/iter; left time: 27132.5094s
	iters: 200, epoch: 7 | loss: 0.3970666
	speed: 0.2730s/iter; left time: 9415.5901s
	iters: 300, epoch: 7 | loss: 0.3882439
	speed: 0.2658s/iter; left time: 9138.7770s
Epoch: 7 cost time: 98.4003324508667
Epoch: 7, Steps: 369 | Train Loss: 0.620 Vali Loss: 1.679 Vali Acc: 0.618 Test Loss: 1.679 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7350459
	speed: 0.7878s/iter; left time: 26956.8148s
	iters: 200, epoch: 8 | loss: 0.6404389
	speed: 0.2423s/iter; left time: 8265.4836s
	iters: 300, epoch: 8 | loss: 1.0747138
	speed: 0.2560s/iter; left time: 8709.4465s
Epoch: 8 cost time: 93.19706606864929
Epoch: 8, Steps: 369 | Train Loss: 0.521 Vali Loss: 1.890 Vali Acc: 0.652 Test Loss: 1.890 Test Acc: 0.652
Validation loss decreased (-0.649815 --> -0.651797).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2565657
	speed: 0.8226s/iter; left time: 27845.8609s
	iters: 200, epoch: 9 | loss: 0.4520696
	speed: 0.2593s/iter; left time: 8749.4555s
	iters: 300, epoch: 9 | loss: 1.0529766
	speed: 0.2490s/iter; left time: 8377.7965s
Epoch: 9 cost time: 96.69850778579712
Epoch: 9, Steps: 369 | Train Loss: 0.439 Vali Loss: 1.446 Vali Acc: 0.650 Test Loss: 1.446 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0185761
	speed: 0.8019s/iter; left time: 26847.5806s
	iters: 200, epoch: 10 | loss: 0.5711016
	speed: 0.2923s/iter; left time: 9757.1358s
	iters: 300, epoch: 10 | loss: 1.0448439
	speed: 0.2720s/iter; left time: 9053.2851s
Epoch: 10 cost time: 102.62710857391357
Epoch: 10, Steps: 369 | Train Loss: 0.389 Vali Loss: 1.162 Vali Acc: 0.652 Test Loss: 1.162 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1307416
	speed: 0.7822s/iter; left time: 25899.2793s
	iters: 200, epoch: 11 | loss: 0.4772993
	speed: 0.2751s/iter; left time: 9082.5483s
	iters: 300, epoch: 11 | loss: 0.1634039
	speed: 0.2718s/iter; left time: 8944.6595s
Epoch: 11 cost time: 99.60783171653748
Epoch: 11, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.311 Vali Acc: 0.650 Test Loss: 1.311 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2041525
	speed: 0.7984s/iter; left time: 26142.2175s
	iters: 200, epoch: 12 | loss: 0.1712667
	speed: 0.2645s/iter; left time: 8634.7900s
	iters: 300, epoch: 12 | loss: 0.2470009
	speed: 0.2812s/iter; left time: 9149.5582s
Epoch: 12 cost time: 98.43776750564575
Epoch: 12, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.417 Vali Acc: 0.656 Test Loss: 1.417 Test Acc: 0.656
Validation loss decreased (-0.651797 --> -0.656342).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0221504
	speed: 0.7950s/iter; left time: 25736.3803s
	iters: 200, epoch: 13 | loss: 0.4186074
	speed: 0.2517s/iter; left time: 8122.4642s
	iters: 300, epoch: 13 | loss: 0.1753077
	speed: 0.2534s/iter; left time: 8154.1233s
Epoch: 13 cost time: 94.60925197601318
Epoch: 13, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.519 Vali Acc: 0.656 Test Loss: 1.519 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1273807
	speed: 0.8296s/iter; left time: 26550.4220s
	iters: 200, epoch: 14 | loss: 0.3250905
	speed: 0.2673s/iter; left time: 8528.0616s
	iters: 300, epoch: 14 | loss: 0.0536142
	speed: 0.2609s/iter; left time: 8296.9836s
Epoch: 14 cost time: 100.25458264350891
Epoch: 14, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.534 Vali Acc: 0.656 Test Loss: 1.534 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0430581
	speed: 0.8436s/iter; left time: 26686.1565s
	iters: 200, epoch: 15 | loss: 0.0083793
	speed: 0.2611s/iter; left time: 8234.3801s
	iters: 300, epoch: 15 | loss: 0.0185228
	speed: 0.2491s/iter; left time: 7831.7864s
Epoch: 15 cost time: 97.17398929595947
Epoch: 15, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.567 Vali Acc: 0.663 Test Loss: 1.567 Test Acc: 0.663
Validation loss decreased (-0.656342 --> -0.662867).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2379937
	speed: 0.7715s/iter; left time: 24120.2455s
	iters: 200, epoch: 16 | loss: 0.0830424
	speed: 0.2687s/iter; left time: 8373.6823s
	iters: 300, epoch: 16 | loss: 0.1127412
	speed: 0.2626s/iter; left time: 8157.0200s
Epoch: 16 cost time: 98.6828224658966
Epoch: 16, Steps: 369 | Train Loss: 0.087 Vali Loss: 1.791 Vali Acc: 0.649 Test Loss: 1.791 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0163886
	speed: 0.8046s/iter; left time: 24859.9761s
	iters: 200, epoch: 17 | loss: 0.1865347
	speed: 0.2608s/iter; left time: 8033.2010s
	iters: 300, epoch: 17 | loss: 0.0050733
	speed: 0.2540s/iter; left time: 7797.0893s
Epoch: 17 cost time: 95.92544627189636
Epoch: 17, Steps: 369 | Train Loss: 0.071 Vali Loss: 2.013 Vali Acc: 0.648 Test Loss: 2.013 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2153569
	speed: 0.7633s/iter; left time: 23301.1148s
	iters: 200, epoch: 18 | loss: 0.0642505
	speed: 0.2595s/iter; left time: 7895.8138s
	iters: 300, epoch: 18 | loss: 0.0060258
	speed: 0.2628s/iter; left time: 7970.3317s
Epoch: 18 cost time: 96.13511443138123
Epoch: 18, Steps: 369 | Train Loss: 0.074 Vali Loss: 1.960 Vali Acc: 0.659 Test Loss: 1.960 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0006793
	speed: 0.7507s/iter; left time: 22641.6952s
	iters: 200, epoch: 19 | loss: 0.1120249
	speed: 0.2545s/iter; left time: 7649.2183s
	iters: 300, epoch: 19 | loss: 0.1844642
	speed: 0.2666s/iter; left time: 7986.4048s
Epoch: 19 cost time: 95.55168318748474
Epoch: 19, Steps: 369 | Train Loss: 0.060 Vali Loss: 1.948 Vali Acc: 0.669 Test Loss: 1.948 Test Acc: 0.669
Validation loss decreased (-0.662867 --> -0.668823).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0128523
	speed: 0.8162s/iter; left time: 24313.8727s
	iters: 200, epoch: 20 | loss: 0.0092897
	speed: 0.2542s/iter; left time: 7547.3380s
	iters: 300, epoch: 20 | loss: 0.0116688
	speed: 0.2474s/iter; left time: 7321.0880s
Epoch: 20 cost time: 93.12192606925964
Epoch: 20, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.361 Vali Acc: 0.659 Test Loss: 2.361 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3401899
	speed: 0.7833s/iter; left time: 23046.4029s
	iters: 200, epoch: 21 | loss: 0.0033875
	speed: 0.2481s/iter; left time: 7275.8692s
	iters: 300, epoch: 21 | loss: 0.1274682
	speed: 0.2415s/iter; left time: 7056.2883s
Epoch: 21 cost time: 91.55976486206055
Epoch: 21, Steps: 369 | Train Loss: 0.054 Vali Loss: 2.151 Vali Acc: 0.655 Test Loss: 2.151 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0282621
	speed: 0.7524s/iter; left time: 21859.8778s
	iters: 200, epoch: 22 | loss: 0.0106224
	speed: 0.2668s/iter; left time: 7723.5812s
	iters: 300, epoch: 22 | loss: 0.0320823
	speed: 0.2686s/iter; left time: 7750.4268s
Epoch: 22 cost time: 97.09628558158875
Epoch: 22, Steps: 369 | Train Loss: 0.056 Vali Loss: 1.839 Vali Acc: 0.665 Test Loss: 1.839 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0054052
	speed: 0.7544s/iter; left time: 21638.6991s
	iters: 200, epoch: 23 | loss: 0.0038234
	speed: 0.2418s/iter; left time: 6911.4341s
	iters: 300, epoch: 23 | loss: 0.0034130
	speed: 0.2442s/iter; left time: 6956.4747s
Epoch: 23 cost time: 91.5870954990387
Epoch: 23, Steps: 369 | Train Loss: 0.042 Vali Loss: 2.244 Vali Acc: 0.652 Test Loss: 2.244 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0012615
	speed: 0.8034s/iter; left time: 22747.2651s
	iters: 200, epoch: 24 | loss: 0.2271892
	speed: 0.2509s/iter; left time: 7077.8154s
	iters: 300, epoch: 24 | loss: 0.2529799
	speed: 0.2549s/iter; left time: 7166.5853s
Epoch: 24 cost time: 95.16247749328613
Epoch: 24, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.037 Vali Acc: 0.653 Test Loss: 2.037 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0424437
	speed: 0.8157s/iter; left time: 22795.5399s
	iters: 200, epoch: 25 | loss: 0.1831395
	speed: 0.2746s/iter; left time: 7645.8334s
	iters: 300, epoch: 25 | loss: 0.0486013
	speed: 0.2735s/iter; left time: 7589.5162s
Epoch: 25 cost time: 100.56947612762451
Epoch: 25, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.215 Vali Acc: 0.668 Test Loss: 2.215 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0150013
	speed: 0.7378s/iter; left time: 20346.8769s
	iters: 200, epoch: 26 | loss: 0.0068669
	speed: 0.2496s/iter; left time: 6857.3923s
	iters: 300, epoch: 26 | loss: 0.0083832
	speed: 0.2634s/iter; left time: 7209.5402s
Epoch: 26 cost time: 94.82335925102234
Epoch: 26, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.258 Vali Acc: 0.651 Test Loss: 2.258 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0387687
	speed: 0.7713s/iter; left time: 20985.0362s
	iters: 200, epoch: 27 | loss: 0.0007613
	speed: 0.2436s/iter; left time: 6603.2318s
	iters: 300, epoch: 27 | loss: 0.0201226
	speed: 0.2543s/iter; left time: 6867.9848s
Epoch: 27 cost time: 91.35524654388428
Epoch: 27, Steps: 369 | Train Loss: 0.029 Vali Loss: 2.888 Vali Acc: 0.656 Test Loss: 2.888 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0059495
	speed: 0.8003s/iter; left time: 21479.7563s
	iters: 200, epoch: 28 | loss: 0.0484148
	speed: 0.2538s/iter; left time: 6786.6924s
	iters: 300, epoch: 28 | loss: 0.0519285
	speed: 0.2494s/iter; left time: 6643.8913s
Epoch: 28 cost time: 93.62704491615295
Epoch: 28, Steps: 369 | Train Loss: 0.034 Vali Loss: 2.166 Vali Acc: 0.661 Test Loss: 2.166 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0012295
	speed: 0.7240s/iter; left time: 19163.4889s
	iters: 200, epoch: 29 | loss: 0.0013953
	speed: 0.2507s/iter; left time: 6610.9650s
	iters: 300, epoch: 29 | loss: 0.0414831
	speed: 0.2536s/iter; left time: 6662.8237s
Epoch: 29 cost time: 92.5167624950409
Epoch: 29, Steps: 369 | Train Loss: 0.043 Vali Loss: 2.487 Vali Acc: 0.663 Test Loss: 2.487 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6688422247446084
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6796710
	speed: 0.2819s/iter; left time: 10375.0784s
	iters: 200, epoch: 1 | loss: 0.5131647
	speed: 0.2676s/iter; left time: 9821.0597s
	iters: 300, epoch: 1 | loss: 0.9237661
	speed: 0.2791s/iter; left time: 10215.1258s
Epoch: 1 cost time: 102.57545471191406
Epoch: 1, Steps: 369 | Train Loss: 0.684 Vali Loss: 1.121 Vali Acc: 0.630 Test Loss: 1.121 Test Acc: 0.630
Validation loss decreased (inf --> -0.629671).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4944690
	speed: 0.8251s/iter; left time: 30060.3170s
	iters: 200, epoch: 2 | loss: 0.7553464
	speed: 0.2681s/iter; left time: 9739.3330s
	iters: 300, epoch: 2 | loss: 0.4464593
	speed: 0.2683s/iter; left time: 9719.8068s
Epoch: 2 cost time: 100.16038870811462
Epoch: 2, Steps: 369 | Train Loss: 0.646 Vali Loss: 1.039 Vali Acc: 0.648 Test Loss: 1.039 Test Acc: 0.648
Validation loss decreased (-0.629671 --> -0.647549).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5326464
	speed: 0.8550s/iter; left time: 30833.2126s
	iters: 200, epoch: 3 | loss: 0.3686349
	speed: 0.2849s/iter; left time: 10244.8610s
	iters: 300, epoch: 3 | loss: 0.5619935
	speed: 0.2642s/iter; left time: 9476.5277s
Epoch: 3 cost time: 103.61219596862793
Epoch: 3, Steps: 369 | Train Loss: 0.624 Vali Loss: 1.449 Vali Acc: 0.638 Test Loss: 1.449 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7969894
	speed: 0.8080s/iter; left time: 28840.7299s
	iters: 200, epoch: 4 | loss: 0.5545065
	speed: 0.2675s/iter; left time: 9521.3728s
	iters: 300, epoch: 4 | loss: 0.7477399
	speed: 0.2717s/iter; left time: 9643.5238s
Epoch: 4 cost time: 99.02270770072937
Epoch: 4, Steps: 369 | Train Loss: 0.681 Vali Loss: 1.468 Vali Acc: 0.653 Test Loss: 1.468 Test Acc: 0.653
Validation loss decreased (-0.647549 --> -0.653220).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5098485
	speed: 0.7477s/iter; left time: 26412.9020s
	iters: 200, epoch: 5 | loss: 0.9589074
	speed: 0.2532s/iter; left time: 8920.4421s
	iters: 300, epoch: 5 | loss: 0.5379745
	speed: 0.2607s/iter; left time: 9157.4559s
Epoch: 5 cost time: 96.13585090637207
Epoch: 5, Steps: 369 | Train Loss: 0.702 Vali Loss: 2.094 Vali Acc: 0.632 Test Loss: 2.094 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2876388
	speed: 0.8034s/iter; left time: 28082.7362s
	iters: 200, epoch: 6 | loss: 1.2854513
	speed: 0.2740s/iter; left time: 9548.9843s
	iters: 300, epoch: 6 | loss: 0.6817427
	speed: 0.2618s/iter; left time: 9098.2568s
Epoch: 6 cost time: 98.47596406936646
Epoch: 6, Steps: 369 | Train Loss: 0.698 Vali Loss: 1.463 Vali Acc: 0.638 Test Loss: 1.463 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6081583
	speed: 0.7842s/iter; left time: 27121.9786s
	iters: 200, epoch: 7 | loss: 0.6021389
	speed: 0.2663s/iter; left time: 9184.2677s
	iters: 300, epoch: 7 | loss: 0.3062055
	speed: 0.2418s/iter; left time: 8316.1450s
Epoch: 7 cost time: 95.2071886062622
Epoch: 7, Steps: 369 | Train Loss: 0.600 Vali Loss: 1.155 Vali Acc: 0.654 Test Loss: 1.155 Test Acc: 0.654
Validation loss decreased (-0.653220 --> -0.654358).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6577330
	speed: 0.7561s/iter; left time: 25871.8839s
	iters: 200, epoch: 8 | loss: 0.5824981
	speed: 0.2763s/iter; left time: 9426.9470s
	iters: 300, epoch: 8 | loss: 0.5443181
	speed: 0.2759s/iter; left time: 9384.4541s
Epoch: 8 cost time: 99.36407375335693
Epoch: 8, Steps: 369 | Train Loss: 0.540 Vali Loss: 0.903 Vali Acc: 0.666 Test Loss: 0.903 Test Acc: 0.666
Validation loss decreased (-0.654358 --> -0.666279).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4040991
	speed: 0.7931s/iter; left time: 26844.1721s
	iters: 200, epoch: 9 | loss: 0.5034936
	speed: 0.2540s/iter; left time: 8571.5493s
	iters: 300, epoch: 9 | loss: 0.3772052
	speed: 0.2355s/iter; left time: 7925.8253s
Epoch: 9 cost time: 92.1263198852539
Epoch: 9, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.933 Vali Acc: 0.644 Test Loss: 0.933 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2116964
	speed: 0.7416s/iter; left time: 24829.0911s
	iters: 200, epoch: 10 | loss: 0.2362672
	speed: 0.2572s/iter; left time: 8586.4066s
	iters: 300, epoch: 10 | loss: 0.3779993
	speed: 0.2548s/iter; left time: 8481.3065s
Epoch: 10 cost time: 94.7751989364624
Epoch: 10, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.860 Vali Acc: 0.629 Test Loss: 0.860 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1085635
	speed: 0.7690s/iter; left time: 25463.3006s
	iters: 200, epoch: 11 | loss: 0.2416326
	speed: 0.2669s/iter; left time: 8809.0417s
	iters: 300, epoch: 11 | loss: 0.5187674
	speed: 0.2572s/iter; left time: 8464.7292s
Epoch: 11 cost time: 97.52853202819824
Epoch: 11, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.983 Vali Acc: 0.646 Test Loss: 0.983 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2396998
	speed: 0.8096s/iter; left time: 26508.7608s
	iters: 200, epoch: 12 | loss: 0.4365355
	speed: 0.2427s/iter; left time: 7921.4439s
	iters: 300, epoch: 12 | loss: 0.4149529
	speed: 0.2417s/iter; left time: 7864.1869s
Epoch: 12 cost time: 92.39027833938599
Epoch: 12, Steps: 369 | Train Loss: 0.362 Vali Loss: 1.022 Vali Acc: 0.659 Test Loss: 1.022 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2865097
	speed: 0.7542s/iter; left time: 24416.4054s
	iters: 200, epoch: 13 | loss: 0.2480165
	speed: 0.2588s/iter; left time: 8351.3887s
	iters: 300, epoch: 13 | loss: 0.2449258
	speed: 0.2533s/iter; left time: 8147.8466s
Epoch: 13 cost time: 93.85544633865356
Epoch: 13, Steps: 369 | Train Loss: 0.317 Vali Loss: 1.134 Vali Acc: 0.646 Test Loss: 1.134 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.4300187
	speed: 0.7359s/iter; left time: 23551.7345s
	iters: 200, epoch: 14 | loss: 0.1535546
	speed: 0.2494s/iter; left time: 7956.1548s
	iters: 300, epoch: 14 | loss: 0.4410656
	speed: 0.2594s/iter; left time: 8251.5359s
Epoch: 14 cost time: 94.2980968952179
Epoch: 14, Steps: 369 | Train Loss: 0.288 Vali Loss: 1.257 Vali Acc: 0.658 Test Loss: 1.257 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1971103
	speed: 0.7814s/iter; left time: 24720.8197s
	iters: 200, epoch: 15 | loss: 0.2175672
	speed: 0.2379s/iter; left time: 7503.3335s
	iters: 300, epoch: 15 | loss: 0.2630950
	speed: 0.2403s/iter; left time: 7553.3918s
Epoch: 15 cost time: 88.30919408798218
Epoch: 15, Steps: 369 | Train Loss: 0.269 Vali Loss: 1.184 Vali Acc: 0.645 Test Loss: 1.184 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2518958
	speed: 0.7876s/iter; left time: 24625.5237s
	iters: 200, epoch: 16 | loss: 0.4150469
	speed: 0.2724s/iter; left time: 8489.6217s
	iters: 300, epoch: 16 | loss: 0.0958853
	speed: 0.2547s/iter; left time: 7911.1117s
Epoch: 16 cost time: 98.80308699607849
Epoch: 16, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.235 Vali Acc: 0.657 Test Loss: 1.235 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1504956
	speed: 0.8018s/iter; left time: 24774.4615s
	iters: 200, epoch: 17 | loss: 0.3087385
	speed: 0.2716s/iter; left time: 8365.6735s
	iters: 300, epoch: 17 | loss: 0.2295458
	speed: 0.2562s/iter; left time: 7864.7404s
Epoch: 17 cost time: 97.1190927028656
Epoch: 17, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.280 Vali Acc: 0.657 Test Loss: 1.280 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.1612805
	speed: 0.7481s/iter; left time: 22837.0853s
	iters: 200, epoch: 18 | loss: 0.4358047
	speed: 0.2540s/iter; left time: 7728.4390s
	iters: 300, epoch: 18 | loss: 0.2409370
	speed: 0.2554s/iter; left time: 7747.1679s
Epoch: 18 cost time: 95.27918124198914
Epoch: 18, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.649 Vali Acc: 0.650 Test Loss: 1.649 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6662883087400681
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7140589
	speed: 0.2668s/iter; left time: 9818.5879s
	iters: 200, epoch: 1 | loss: 0.4813484
	speed: 0.2396s/iter; left time: 8795.0717s
	iters: 300, epoch: 1 | loss: 0.9673504
	speed: 0.2438s/iter; left time: 8921.7444s
Epoch: 1 cost time: 91.96103739738464
Epoch: 1, Steps: 369 | Train Loss: 0.690 Vali Loss: 1.069 Vali Acc: 0.623 Test Loss: 1.069 Test Acc: 0.623
Validation loss decreased (inf --> -0.623429).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3701333
	speed: 0.8156s/iter; left time: 29712.6794s
	iters: 200, epoch: 2 | loss: 0.5803164
	speed: 0.2649s/iter; left time: 9625.6747s
	iters: 300, epoch: 2 | loss: 0.3094327
	speed: 0.2589s/iter; left time: 9380.4386s
Epoch: 2 cost time: 99.65486216545105
Epoch: 2, Steps: 369 | Train Loss: 0.644 Vali Loss: 1.074 Vali Acc: 0.644 Test Loss: 1.074 Test Acc: 0.644
Validation loss decreased (-0.623429 --> -0.643860).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5581431
	speed: 0.8055s/iter; left time: 29047.3218s
	iters: 200, epoch: 3 | loss: 0.4489093
	speed: 0.2577s/iter; left time: 9266.3405s
	iters: 300, epoch: 3 | loss: 0.4159109
	speed: 0.2654s/iter; left time: 9519.1522s
Epoch: 3 cost time: 95.81043410301208
Epoch: 3, Steps: 369 | Train Loss: 0.650 Vali Loss: 1.369 Vali Acc: 0.621 Test Loss: 1.369 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6685165
	speed: 0.7404s/iter; left time: 26427.2122s
	iters: 200, epoch: 4 | loss: 0.5319259
	speed: 0.2453s/iter; left time: 8732.9283s
	iters: 300, epoch: 4 | loss: 0.8649325
	speed: 0.2576s/iter; left time: 9143.3622s
Epoch: 4 cost time: 92.75664758682251
Epoch: 4, Steps: 369 | Train Loss: 0.709 Vali Loss: 1.501 Vali Acc: 0.622 Test Loss: 1.501 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.6545819
	speed: 0.7770s/iter; left time: 27447.4153s
	iters: 200, epoch: 5 | loss: 0.8211414
	speed: 0.2347s/iter; left time: 8265.9306s
	iters: 300, epoch: 5 | loss: 1.0028497
	speed: 0.2388s/iter; left time: 8386.4279s
Epoch: 5 cost time: 88.08681178092957
Epoch: 5, Steps: 369 | Train Loss: 0.690 Vali Loss: 1.916 Vali Acc: 0.625 Test Loss: 1.916 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5606893
	speed: 0.7793s/iter; left time: 27240.0570s
	iters: 200, epoch: 6 | loss: 1.6423461
	speed: 0.2616s/iter; left time: 9116.8630s
	iters: 300, epoch: 6 | loss: 0.6320172
	speed: 0.2592s/iter; left time: 9008.0133s
Epoch: 6 cost time: 96.893230676651
Epoch: 6, Steps: 369 | Train Loss: 0.591 Vali Loss: 0.994 Vali Acc: 0.624 Test Loss: 0.994 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.2843136
	speed: 0.7963s/iter; left time: 27541.3464s
	iters: 200, epoch: 7 | loss: 0.5321630
	speed: 0.2688s/iter; left time: 9271.0560s
	iters: 300, epoch: 7 | loss: 0.4770853
	speed: 0.2581s/iter; left time: 8874.1544s
Epoch: 7 cost time: 97.94748091697693
Epoch: 7, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.704 Vali Acc: 0.645 Test Loss: 0.704 Test Acc: 0.645
Validation loss decreased (-0.643860 --> -0.644999).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5728635
	speed: 0.7748s/iter; left time: 26510.4389s
	iters: 200, epoch: 8 | loss: 0.5132797
	speed: 0.2555s/iter; left time: 8717.4609s
	iters: 300, epoch: 8 | loss: 0.6623068
	speed: 0.2642s/iter; left time: 8986.7351s
Epoch: 8 cost time: 96.79870629310608
Epoch: 8, Steps: 369 | Train Loss: 0.588 Vali Loss: 0.710 Vali Acc: 0.641 Test Loss: 0.710 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6121967
	speed: 0.8223s/iter; left time: 27832.8305s
	iters: 200, epoch: 9 | loss: 0.8953364
	speed: 0.2407s/iter; left time: 8123.3619s
	iters: 300, epoch: 9 | loss: 0.5036823
	speed: 0.2424s/iter; left time: 8157.8915s
Epoch: 9 cost time: 91.88616228103638
Epoch: 9, Steps: 369 | Train Loss: 0.593 Vali Loss: 0.760 Vali Acc: 0.605 Test Loss: 0.760 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5743629
	speed: 0.7785s/iter; left time: 26064.3180s
	iters: 200, epoch: 10 | loss: 0.3312252
	speed: 0.2697s/iter; left time: 9001.1227s
	iters: 300, epoch: 10 | loss: 0.6578712
	speed: 0.2527s/iter; left time: 8408.6714s
Epoch: 10 cost time: 98.51508235931396
Epoch: 10, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.675 Vali Acc: 0.658 Test Loss: 0.675 Test Acc: 0.658
Validation loss decreased (-0.644999 --> -0.658336).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2500100
	speed: 0.7555s/iter; left time: 25016.9230s
	iters: 200, epoch: 11 | loss: 0.8654936
	speed: 0.2721s/iter; left time: 8983.6929s
	iters: 300, epoch: 11 | loss: 0.5431104
	speed: 0.2523s/iter; left time: 8303.6397s
Epoch: 11 cost time: 96.4795732498169
Epoch: 11, Steps: 369 | Train Loss: 0.534 Vali Loss: 0.732 Vali Acc: 0.649 Test Loss: 0.732 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4997891
	speed: 0.8063s/iter; left time: 26400.6084s
	iters: 200, epoch: 12 | loss: 0.3417245
	speed: 0.2681s/iter; left time: 8751.1416s
	iters: 300, epoch: 12 | loss: 0.5708640
	speed: 0.2726s/iter; left time: 8872.2982s
Epoch: 12 cost time: 100.27291655540466
Epoch: 12, Steps: 369 | Train Loss: 0.504 Vali Loss: 0.769 Vali Acc: 0.651 Test Loss: 0.769 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3485718
	speed: 0.7648s/iter; left time: 24759.2694s
	iters: 200, epoch: 13 | loss: 0.4764450
	speed: 0.2401s/iter; left time: 7748.0696s
	iters: 300, epoch: 13 | loss: 0.6423170
	speed: 0.2583s/iter; left time: 8309.8490s
Epoch: 13 cost time: 93.46051263809204
Epoch: 13, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.745 Vali Acc: 0.651 Test Loss: 0.745 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6801550
	speed: 0.8073s/iter; left time: 25835.2648s
	iters: 200, epoch: 14 | loss: 0.4929663
	speed: 0.2503s/iter; left time: 7984.3610s
	iters: 300, epoch: 14 | loss: 0.4253541
	speed: 0.2365s/iter; left time: 7520.2034s
Epoch: 14 cost time: 92.10889959335327
Epoch: 14, Steps: 369 | Train Loss: 0.460 Vali Loss: 0.801 Vali Acc: 0.659 Test Loss: 0.801 Test Acc: 0.659
Validation loss decreased (-0.658336 --> -0.658619).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2243471
	speed: 0.8021s/iter; left time: 25374.7828s
	iters: 200, epoch: 15 | loss: 0.3328917
	speed: 0.2536s/iter; left time: 7996.0162s
	iters: 300, epoch: 15 | loss: 0.3218661
	speed: 0.2525s/iter; left time: 7938.0256s
Epoch: 15 cost time: 96.7761538028717
Epoch: 15, Steps: 369 | Train Loss: 0.440 Vali Loss: 0.686 Vali Acc: 0.672 Test Loss: 0.686 Test Acc: 0.672
Validation loss decreased (-0.658619 --> -0.671673).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3972884
	speed: 0.8306s/iter; left time: 25970.3851s
	iters: 200, epoch: 16 | loss: 0.7378016
	speed: 0.2487s/iter; left time: 7750.6043s
	iters: 300, epoch: 16 | loss: 0.5133775
	speed: 0.2390s/iter; left time: 7426.2783s
Epoch: 16 cost time: 94.26729989051819
Epoch: 16, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.734 Vali Acc: 0.675 Test Loss: 0.734 Test Acc: 0.675
Validation loss decreased (-0.671673 --> -0.675078).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6445349
	speed: 0.8287s/iter; left time: 25603.4885s
	iters: 200, epoch: 17 | loss: 0.4931886
	speed: 0.2578s/iter; left time: 7940.4784s
	iters: 300, epoch: 17 | loss: 0.6154758
	speed: 0.2580s/iter; left time: 7919.5673s
Epoch: 17 cost time: 97.85617423057556
Epoch: 17, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.743 Vali Acc: 0.673 Test Loss: 0.743 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8618700
	speed: 0.8240s/iter; left time: 25155.0300s
	iters: 200, epoch: 18 | loss: 0.4831153
	speed: 0.2414s/iter; left time: 7346.2250s
	iters: 300, epoch: 18 | loss: 0.2299581
	speed: 0.2399s/iter; left time: 7276.6844s
Epoch: 18 cost time: 92.63808798789978
Epoch: 18, Steps: 369 | Train Loss: 0.380 Vali Loss: 0.806 Vali Acc: 0.667 Test Loss: 0.806 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4290025
	speed: 0.8096s/iter; left time: 24415.6746s
	iters: 200, epoch: 19 | loss: 0.4489318
	speed: 0.2585s/iter; left time: 7770.5487s
	iters: 300, epoch: 19 | loss: 0.3607646
	speed: 0.2678s/iter; left time: 8024.3149s
Epoch: 19 cost time: 98.87567067146301
Epoch: 19, Steps: 369 | Train Loss: 0.359 Vali Loss: 0.815 Vali Acc: 0.671 Test Loss: 0.815 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3889162
	speed: 0.8122s/iter; left time: 24194.7505s
	iters: 200, epoch: 20 | loss: 0.3786475
	speed: 0.2497s/iter; left time: 7414.2756s
	iters: 300, epoch: 20 | loss: 0.2289915
	speed: 0.2525s/iter; left time: 7472.5492s
Epoch: 20 cost time: 95.00292563438416
Epoch: 20, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.855 Vali Acc: 0.669 Test Loss: 0.855 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.8269062
	speed: 0.8349s/iter; left time: 24563.1246s
	iters: 200, epoch: 21 | loss: 0.4568271
	speed: 0.2735s/iter; left time: 8019.3250s
	iters: 300, epoch: 21 | loss: 0.6833559
	speed: 0.2562s/iter; left time: 7486.8525s
Epoch: 21 cost time: 98.63500189781189
Epoch: 21, Steps: 369 | Train Loss: 0.321 Vali Loss: 0.951 Vali Acc: 0.657 Test Loss: 0.951 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2345393
	speed: 0.7606s/iter; left time: 22096.3402s
	iters: 200, epoch: 22 | loss: 0.1810353
	speed: 0.2537s/iter; left time: 7345.1104s
	iters: 300, epoch: 22 | loss: 0.4915198
	speed: 0.2482s/iter; left time: 7159.8508s
Epoch: 22 cost time: 93.96738266944885
Epoch: 22, Steps: 369 | Train Loss: 0.294 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.675078 --> -0.675359).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1267319
	speed: 0.8073s/iter; left time: 23154.8794s
	iters: 200, epoch: 23 | loss: 0.1739339
	speed: 0.2629s/iter; left time: 7514.4462s
	iters: 300, epoch: 23 | loss: 0.1602822
	speed: 0.2216s/iter; left time: 6310.8395s
Epoch: 23 cost time: 93.10097169876099
Epoch: 23, Steps: 369 | Train Loss: 0.264 Vali Loss: 0.989 Vali Acc: 0.668 Test Loss: 0.989 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.3045390
	speed: 0.7797s/iter; left time: 22077.6269s
	iters: 200, epoch: 24 | loss: 0.4056227
	speed: 0.2680s/iter; left time: 7562.0954s
	iters: 300, epoch: 24 | loss: 0.3729309
	speed: 0.2580s/iter; left time: 7253.1606s
Epoch: 24 cost time: 99.27645206451416
Epoch: 24, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.048 Vali Acc: 0.656 Test Loss: 1.048 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.3575507
	speed: 0.7936s/iter; left time: 22178.0599s
	iters: 200, epoch: 25 | loss: 0.2359153
	speed: 0.2699s/iter; left time: 7516.6069s
	iters: 300, epoch: 25 | loss: 0.6457375
	speed: 0.2483s/iter; left time: 6890.2603s
Epoch: 25 cost time: 96.38028717041016
Epoch: 25, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.029 Vali Acc: 0.673 Test Loss: 1.029 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0393535
	speed: 0.7868s/iter; left time: 21697.0228s
	iters: 200, epoch: 26 | loss: 0.2530516
	speed: 0.2760s/iter; left time: 7582.0569s
	iters: 300, epoch: 26 | loss: 0.0796037
	speed: 0.2517s/iter; left time: 6890.8983s
Epoch: 26 cost time: 96.37333679199219
Epoch: 26, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.310 Vali Acc: 0.658 Test Loss: 1.310 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0152200
	speed: 0.7449s/iter; left time: 20267.7093s
	iters: 200, epoch: 27 | loss: 0.0473629
	speed: 0.2564s/iter; left time: 6950.7102s
	iters: 300, epoch: 27 | loss: 0.3406855
	speed: 0.2560s/iter; left time: 6913.9531s
Epoch: 27 cost time: 93.64305806159973
Epoch: 27, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.765 Vali Acc: 0.668 Test Loss: 1.765 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0200168
	speed: 0.7992s/iter; left time: 21449.9469s
	iters: 200, epoch: 28 | loss: 0.0578778
	speed: 0.2568s/iter; left time: 6867.5687s
	iters: 300, epoch: 28 | loss: 0.1855996
	speed: 0.2521s/iter; left time: 6715.4351s
Epoch: 28 cost time: 96.6516363620758
Epoch: 28, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.548 Vali Acc: 0.661 Test Loss: 1.548 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0088756
	speed: 0.7616s/iter; left time: 20158.9920s
	iters: 200, epoch: 29 | loss: 0.1067683
	speed: 0.2303s/iter; left time: 6072.5253s
	iters: 300, epoch: 29 | loss: 0.1305725
	speed: 0.2532s/iter; left time: 6652.2577s
Epoch: 29 cost time: 92.14243650436401
Epoch: 29, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.424 Vali Acc: 0.663 Test Loss: 1.424 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0150512
	speed: 0.7681s/iter; left time: 20047.6451s
	iters: 200, epoch: 30 | loss: 0.0228045
	speed: 0.2636s/iter; left time: 6853.4617s
	iters: 300, epoch: 30 | loss: 0.2355621
	speed: 0.2602s/iter; left time: 6737.9890s
Epoch: 30 cost time: 95.18590593338013
Epoch: 30, Steps: 369 | Train Loss: 0.075 Vali Loss: 1.957 Vali Acc: 0.663 Test Loss: 1.957 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0213283
	speed: 0.7444s/iter; left time: 19154.6866s
	iters: 200, epoch: 31 | loss: 0.0631700
	speed: 0.2585s/iter; left time: 6625.2881s
	iters: 300, epoch: 31 | loss: 0.0565125
	speed: 0.2608s/iter; left time: 6657.9221s
Epoch: 31 cost time: 95.52738642692566
Epoch: 31, Steps: 369 | Train Loss: 0.066 Vali Loss: 2.075 Vali Acc: 0.648 Test Loss: 2.075 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0548662
	speed: 0.8016s/iter; left time: 20330.9469s
	iters: 200, epoch: 32 | loss: 0.0659018
	speed: 0.2516s/iter; left time: 6356.2451s
	iters: 300, epoch: 32 | loss: 0.1790596
	speed: 0.2339s/iter; left time: 5885.6701s
Epoch: 32 cost time: 93.56638813018799
Epoch: 32, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.115 Vali Acc: 0.652 Test Loss: 2.115 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7489341
	speed: 0.2751s/iter; left time: 10125.2612s
	iters: 200, epoch: 1 | loss: 0.6767335
	speed: 0.2723s/iter; left time: 9993.7514s
	iters: 300, epoch: 1 | loss: 0.5166608
	speed: 0.2679s/iter; left time: 9805.1352s
Epoch: 1 cost time: 98.92440414428711
Epoch: 1, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.977 Vali Acc: 0.642 Test Loss: 0.977 Test Acc: 0.642
Validation loss decreased (inf --> -0.641874).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7294809
	speed: 0.7944s/iter; left time: 28940.9435s
	iters: 200, epoch: 2 | loss: 1.0618930
	speed: 0.2561s/iter; left time: 9306.0419s
	iters: 300, epoch: 2 | loss: 0.4078790
	speed: 0.2543s/iter; left time: 9212.0861s
Epoch: 2 cost time: 95.76032853126526
Epoch: 2, Steps: 369 | Train Loss: 0.669 Vali Loss: 1.048 Vali Acc: 0.636 Test Loss: 1.048 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8776364
	speed: 0.8057s/iter; left time: 29055.9663s
	iters: 200, epoch: 3 | loss: 0.5304638
	speed: 0.2599s/iter; left time: 9345.3438s
	iters: 300, epoch: 3 | loss: 0.6852406
	speed: 0.2631s/iter; left time: 9436.6827s
Epoch: 3 cost time: 99.8486099243164
Epoch: 3, Steps: 369 | Train Loss: 0.662 Vali Loss: 1.457 Vali Acc: 0.631 Test Loss: 1.457 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7471967
	speed: 0.7742s/iter; left time: 27632.7915s
	iters: 200, epoch: 4 | loss: 1.6778027
	speed: 0.2639s/iter; left time: 9394.3447s
	iters: 300, epoch: 4 | loss: 1.0000703
	speed: 0.2452s/iter; left time: 8704.1276s
Epoch: 4 cost time: 94.72266912460327
Epoch: 4, Steps: 369 | Train Loss: 0.718 Vali Loss: 1.687 Vali Acc: 0.621 Test Loss: 1.687 Test Acc: 0.621
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4247608
	speed: 0.7546s/iter; left time: 26655.2209s
	iters: 200, epoch: 5 | loss: 0.6897187
	speed: 0.2659s/iter; left time: 9366.2751s
	iters: 300, epoch: 5 | loss: 0.5130494
	speed: 0.2515s/iter; left time: 8833.6613s
Epoch: 5 cost time: 95.23587656021118
Epoch: 5, Steps: 369 | Train Loss: 0.695 Vali Loss: 2.160 Vali Acc: 0.613 Test Loss: 2.160 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7400207
	speed: 0.7095s/iter; left time: 24801.5268s
	iters: 200, epoch: 6 | loss: 0.9670295
	speed: 0.2385s/iter; left time: 8312.6207s
	iters: 300, epoch: 6 | loss: 0.7114066
	speed: 0.2531s/iter; left time: 8795.0382s
Epoch: 6 cost time: 91.6265959739685
Epoch: 6, Steps: 369 | Train Loss: 0.715 Vali Loss: 1.572 Vali Acc: 0.638 Test Loss: 1.572 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.9799563
	speed: 0.7320s/iter; left time: 25317.8451s
	iters: 200, epoch: 7 | loss: 0.1448517
	speed: 0.2406s/iter; left time: 8297.7752s
	iters: 300, epoch: 7 | loss: 0.2441610
	speed: 0.2553s/iter; left time: 8779.1355s
Epoch: 7 cost time: 92.82153511047363
Epoch: 7, Steps: 369 | Train Loss: 0.598 Vali Loss: 1.072 Vali Acc: 0.657 Test Loss: 1.072 Test Acc: 0.657
Validation loss decreased (-0.641874 --> -0.656913).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2853743
	speed: 0.7745s/iter; left time: 26502.2834s
	iters: 200, epoch: 8 | loss: 0.6263365
	speed: 0.2542s/iter; left time: 8673.9834s
	iters: 300, epoch: 8 | loss: 0.4514611
	speed: 0.2536s/iter; left time: 8626.6011s
Epoch: 8 cost time: 94.41713786125183
Epoch: 8, Steps: 369 | Train Loss: 0.490 Vali Loss: 0.823 Vali Acc: 0.661 Test Loss: 0.823 Test Acc: 0.661
Validation loss decreased (-0.656913 --> -0.661172).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3073773
	speed: 0.7792s/iter; left time: 26374.2454s
	iters: 200, epoch: 9 | loss: 0.5395081
	speed: 0.2369s/iter; left time: 7996.4934s
	iters: 300, epoch: 9 | loss: 0.5425476
	speed: 0.2208s/iter; left time: 7429.8828s
Epoch: 9 cost time: 86.95849776268005
Epoch: 9, Steps: 369 | Train Loss: 0.435 Vali Loss: 0.984 Vali Acc: 0.625 Test Loss: 0.984 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3080961
	speed: 0.7491s/iter; left time: 25080.8476s
	iters: 200, epoch: 10 | loss: 0.3717364
	speed: 0.2639s/iter; left time: 8809.3440s
	iters: 300, epoch: 10 | loss: 0.5555539
	speed: 0.2356s/iter; left time: 7841.6060s
Epoch: 10 cost time: 92.66420865058899
Epoch: 10, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.762 Vali Acc: 0.656 Test Loss: 0.762 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2291039
	speed: 0.7935s/iter; left time: 26272.5708s
	iters: 200, epoch: 11 | loss: 0.4758618
	speed: 0.2878s/iter; left time: 9499.8654s
	iters: 300, epoch: 11 | loss: 0.3914964
	speed: 0.2579s/iter; left time: 8488.9258s
Epoch: 11 cost time: 101.51583886146545
Epoch: 11, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.879 Vali Acc: 0.639 Test Loss: 0.879 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1687590
	speed: 0.7474s/iter; left time: 24470.7822s
	iters: 200, epoch: 12 | loss: 0.3650792
	speed: 0.2704s/iter; left time: 8825.4113s
	iters: 300, epoch: 12 | loss: 0.3604474
	speed: 0.2602s/iter; left time: 8469.0443s
Epoch: 12 cost time: 94.6609435081482
Epoch: 12, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.958 Vali Acc: 0.637 Test Loss: 0.958 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1607849
	speed: 0.7395s/iter; left time: 23939.1082s
	iters: 200, epoch: 13 | loss: 0.3706140
	speed: 0.2690s/iter; left time: 8680.3669s
	iters: 300, epoch: 13 | loss: 0.3357859
	speed: 0.2647s/iter; left time: 8517.5779s
Epoch: 13 cost time: 99.85863637924194
Epoch: 13, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.920 Vali Acc: 0.657 Test Loss: 0.920 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.4969504
	speed: 0.7660s/iter; left time: 24515.9649s
	iters: 200, epoch: 14 | loss: 0.1752037
	speed: 0.2602s/iter; left time: 8302.5701s
	iters: 300, epoch: 14 | loss: 0.2520050
	speed: 0.2513s/iter; left time: 7992.2757s
Epoch: 14 cost time: 95.16317820549011
Epoch: 14, Steps: 369 | Train Loss: 0.297 Vali Loss: 0.949 Vali Acc: 0.671 Test Loss: 0.949 Test Acc: 0.671
Validation loss decreased (-0.661172 --> -0.670535).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1781612
	speed: 0.7661s/iter; left time: 24235.0908s
	iters: 200, epoch: 15 | loss: 0.1168774
	speed: 0.2348s/iter; left time: 7405.0665s
	iters: 300, epoch: 15 | loss: 0.1861722
	speed: 0.2522s/iter; left time: 7927.8207s
Epoch: 15 cost time: 93.29962873458862
Epoch: 15, Steps: 369 | Train Loss: 0.276 Vali Loss: 0.953 Vali Acc: 0.660 Test Loss: 0.953 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0672770
	speed: 0.8055s/iter; left time: 25183.8495s
	iters: 200, epoch: 16 | loss: 0.5978760
	speed: 0.2560s/iter; left time: 7979.1617s
	iters: 300, epoch: 16 | loss: 0.3550705
	speed: 0.2732s/iter; left time: 8487.9287s
Epoch: 16 cost time: 98.52067255973816
Epoch: 16, Steps: 369 | Train Loss: 0.262 Vali Loss: 1.095 Vali Acc: 0.660 Test Loss: 1.095 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1338035
	speed: 0.7777s/iter; left time: 24029.7028s
	iters: 200, epoch: 17 | loss: 0.6485099
	speed: 0.2469s/iter; left time: 7604.2299s
	iters: 300, epoch: 17 | loss: 0.3583587
	speed: 0.2479s/iter; left time: 7608.2622s
Epoch: 17 cost time: 91.39308524131775
Epoch: 17, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.098 Vali Acc: 0.651 Test Loss: 1.098 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4544870
	speed: 0.7462s/iter; left time: 22780.5932s
	iters: 200, epoch: 18 | loss: 0.5964469
	speed: 0.2419s/iter; left time: 7360.2916s
	iters: 300, epoch: 18 | loss: 0.2501687
	speed: 0.2377s/iter; left time: 7210.0749s
Epoch: 18 cost time: 88.43874526023865
Epoch: 18, Steps: 369 | Train Loss: 0.211 Vali Loss: 1.195 Vali Acc: 0.657 Test Loss: 1.195 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2036807
	speed: 0.7507s/iter; left time: 22640.1580s
	iters: 200, epoch: 19 | loss: 0.0648193
	speed: 0.2389s/iter; left time: 7181.7923s
	iters: 300, epoch: 19 | loss: 0.3271168
	speed: 0.2378s/iter; left time: 7124.3085s
Epoch: 19 cost time: 90.18255829811096
Epoch: 19, Steps: 369 | Train Loss: 0.182 Vali Loss: 1.265 Vali Acc: 0.641 Test Loss: 1.265 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0105183
	speed: 0.7613s/iter; left time: 22678.0351s
	iters: 200, epoch: 20 | loss: 0.0815239
	speed: 0.2583s/iter; left time: 7667.6642s
	iters: 300, epoch: 20 | loss: 0.0325323
	speed: 0.2615s/iter; left time: 7737.4149s
Epoch: 20 cost time: 96.92984509468079
Epoch: 20, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.509 Vali Acc: 0.649 Test Loss: 1.509 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2174092
	speed: 0.7885s/iter; left time: 23199.5520s
	iters: 200, epoch: 21 | loss: 0.0290904
	speed: 0.2649s/iter; left time: 7766.7594s
	iters: 300, epoch: 21 | loss: 0.6145263
	speed: 0.2727s/iter; left time: 7968.3573s
Epoch: 21 cost time: 98.84439373016357
Epoch: 21, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.618 Vali Acc: 0.639 Test Loss: 1.618 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0366613
	speed: 0.7023s/iter; left time: 20403.2073s
	iters: 200, epoch: 22 | loss: 0.2504448
	speed: 0.2452s/iter; left time: 7098.9569s
	iters: 300, epoch: 22 | loss: 0.0223288
	speed: 0.2509s/iter; left time: 7237.7278s
Epoch: 22 cost time: 90.13986468315125
Epoch: 22, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.853 Vali Acc: 0.644 Test Loss: 1.853 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0724422
	speed: 0.7087s/iter; left time: 20328.2267s
	iters: 200, epoch: 23 | loss: 0.0706795
	speed: 0.2464s/iter; left time: 7042.2013s
	iters: 300, epoch: 23 | loss: 0.0112954
	speed: 0.2570s/iter; left time: 7321.2628s
Epoch: 23 cost time: 94.38802170753479
Epoch: 23, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.941 Vali Acc: 0.650 Test Loss: 1.941 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0285362
	speed: 0.7634s/iter; left time: 21615.0187s
	iters: 200, epoch: 24 | loss: 0.0146679
	speed: 0.2355s/iter; left time: 6644.1984s
	iters: 300, epoch: 24 | loss: 0.3854720
	speed: 0.2544s/iter; left time: 7150.9222s
Epoch: 24 cost time: 92.56513094902039
Epoch: 24, Steps: 369 | Train Loss: 0.084 Vali Loss: 1.645 Vali Acc: 0.633 Test Loss: 1.645 Test Acc: 0.633
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6705448354143019
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7308212
	speed: 0.2554s/iter; left time: 9398.5785s
	iters: 200, epoch: 1 | loss: 0.6373963
	speed: 0.2584s/iter; left time: 9483.4528s
	iters: 300, epoch: 1 | loss: 0.6845660
	speed: 0.2675s/iter; left time: 9789.0628s
Epoch: 1 cost time: 97.2715334892273
Epoch: 1, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.954 Vali Acc: 0.635 Test Loss: 0.954 Test Acc: 0.635
Validation loss decreased (inf --> -0.634780).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4768078
	speed: 0.8249s/iter; left time: 30050.9723s
	iters: 200, epoch: 2 | loss: 0.3643889
	speed: 0.2646s/iter; left time: 9612.2083s
	iters: 300, epoch: 2 | loss: 0.5135642
	speed: 0.2540s/iter; left time: 9203.9601s
Epoch: 2 cost time: 95.97479057312012
Epoch: 2, Steps: 369 | Train Loss: 0.655 Vali Loss: 1.078 Vali Acc: 0.636 Test Loss: 1.078 Test Acc: 0.636
Validation loss decreased (-0.634780 --> -0.636482).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6544273
	speed: 0.7692s/iter; left time: 27739.3651s
	iters: 200, epoch: 3 | loss: 0.3729251
	speed: 0.2708s/iter; left time: 9738.3938s
	iters: 300, epoch: 3 | loss: 0.5888848
	speed: 0.2436s/iter; left time: 8737.5475s
Epoch: 3 cost time: 95.83697390556335
Epoch: 3, Steps: 369 | Train Loss: 0.653 Vali Loss: 1.308 Vali Acc: 0.640 Test Loss: 1.308 Test Acc: 0.640
Validation loss decreased (-0.636482 --> -0.639885).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4609915
	speed: 0.8020s/iter; left time: 28627.9176s
	iters: 200, epoch: 4 | loss: 0.5418311
	speed: 0.2697s/iter; left time: 9600.8279s
	iters: 300, epoch: 4 | loss: 1.7431774
	speed: 0.2697s/iter; left time: 9573.1735s
Epoch: 4 cost time: 99.97133779525757
Epoch: 4, Steps: 369 | Train Loss: 0.680 Vali Loss: 1.494 Vali Acc: 0.641 Test Loss: 1.494 Test Acc: 0.641
Validation loss decreased (-0.639885 --> -0.640734).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9266372
	speed: 0.8053s/iter; left time: 28446.8899s
	iters: 200, epoch: 5 | loss: 0.9129395
	speed: 0.2840s/iter; left time: 10004.0027s
	iters: 300, epoch: 5 | loss: 0.5555624
	speed: 0.2630s/iter; left time: 9238.2234s
Epoch: 5 cost time: 100.83426451683044
Epoch: 5, Steps: 369 | Train Loss: 0.712 Vali Loss: 1.945 Vali Acc: 0.622 Test Loss: 1.945 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5186244
	speed: 0.8407s/iter; left time: 29388.3253s
	iters: 200, epoch: 6 | loss: 1.3918658
	speed: 0.2789s/iter; left time: 9721.2592s
	iters: 300, epoch: 6 | loss: 0.6960571
	speed: 0.2704s/iter; left time: 9399.2118s
Epoch: 6 cost time: 102.0823380947113
Epoch: 6, Steps: 369 | Train Loss: 0.719 Vali Loss: 1.556 Vali Acc: 0.640 Test Loss: 1.556 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4397093
	speed: 0.7857s/iter; left time: 27174.4625s
	iters: 200, epoch: 7 | loss: 0.5897172
	speed: 0.2493s/iter; left time: 8599.0105s
	iters: 300, epoch: 7 | loss: 0.8835780
	speed: 0.2504s/iter; left time: 8610.9443s
Epoch: 7 cost time: 94.60784792900085
Epoch: 7, Steps: 369 | Train Loss: 0.669 Vali Loss: 1.457 Vali Acc: 0.655 Test Loss: 1.457 Test Acc: 0.655
Validation loss decreased (-0.640734 --> -0.654639).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2021176
	speed: 0.8110s/iter; left time: 27750.6365s
	iters: 200, epoch: 8 | loss: 0.3792881
	speed: 0.2659s/iter; left time: 9071.2019s
	iters: 300, epoch: 8 | loss: 0.5194141
	speed: 0.2437s/iter; left time: 8289.9086s
Epoch: 8 cost time: 97.33438420295715
Epoch: 8, Steps: 369 | Train Loss: 0.576 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1954780
	speed: 0.8469s/iter; left time: 28665.9938s
	iters: 200, epoch: 9 | loss: 0.6015878
	speed: 0.2769s/iter; left time: 9346.2323s
	iters: 300, epoch: 9 | loss: 0.7463604
	speed: 0.2616s/iter; left time: 8803.9868s
Epoch: 9 cost time: 103.42462301254272
Epoch: 9, Steps: 369 | Train Loss: 0.461 Vali Loss: 1.134 Vali Acc: 0.653 Test Loss: 1.134 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2455495
	speed: 0.8559s/iter; left time: 28653.9926s
	iters: 200, epoch: 10 | loss: 0.3300520
	speed: 0.2667s/iter; left time: 8903.0786s
	iters: 300, epoch: 10 | loss: 0.5752530
	speed: 0.2522s/iter; left time: 8392.4403s
Epoch: 10 cost time: 100.22119379043579
Epoch: 10, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.809 Vali Acc: 0.616 Test Loss: 0.809 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0835346
	speed: 0.8207s/iter; left time: 27173.4512s
	iters: 200, epoch: 11 | loss: 0.9161283
	speed: 0.2433s/iter; left time: 8031.9951s
	iters: 300, epoch: 11 | loss: 0.2197939
	speed: 0.2381s/iter; left time: 7835.0386s
Epoch: 11 cost time: 91.76964926719666
Epoch: 11, Steps: 369 | Train Loss: 0.316 Vali Loss: 0.971 Vali Acc: 0.656 Test Loss: 0.971 Test Acc: 0.656
Validation loss decreased (-0.654639 --> -0.655779).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2843735
	speed: 0.7609s/iter; left time: 24912.3819s
	iters: 200, epoch: 12 | loss: 0.4493138
	speed: 0.2461s/iter; left time: 8032.2371s
	iters: 300, epoch: 12 | loss: 0.0899312
	speed: 0.2720s/iter; left time: 8850.4215s
Epoch: 12 cost time: 96.79658150672913
Epoch: 12, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.017 Vali Acc: 0.658 Test Loss: 1.017 Test Acc: 0.658
Validation loss decreased (-0.655779 --> -0.658049).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0770246
	speed: 0.8661s/iter; left time: 28038.9276s
	iters: 200, epoch: 13 | loss: 0.2971323
	speed: 0.2492s/iter; left time: 8042.4079s
	iters: 300, epoch: 13 | loss: 0.0789400
	speed: 0.2501s/iter; left time: 8045.8760s
Epoch: 13 cost time: 97.46115350723267
Epoch: 13, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.030 Vali Acc: 0.646 Test Loss: 1.030 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3899153
	speed: 0.8267s/iter; left time: 26458.9433s
	iters: 200, epoch: 14 | loss: 0.0782457
	speed: 0.2656s/iter; left time: 8472.2960s
	iters: 300, epoch: 14 | loss: 0.1411962
	speed: 0.2683s/iter; left time: 8533.9051s
Epoch: 14 cost time: 99.60117435455322
Epoch: 14, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.137 Vali Acc: 0.657 Test Loss: 1.137 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0382965
	speed: 0.8025s/iter; left time: 25387.1516s
	iters: 200, epoch: 15 | loss: 0.0698556
	speed: 0.2422s/iter; left time: 7637.2578s
	iters: 300, epoch: 15 | loss: 0.2731018
	speed: 0.2273s/iter; left time: 7144.3259s
Epoch: 15 cost time: 90.68169713020325
Epoch: 15, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.357 Vali Acc: 0.642 Test Loss: 1.357 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1227549
	speed: 0.7207s/iter; left time: 22533.5381s
	iters: 200, epoch: 16 | loss: 0.1974173
	speed: 0.2551s/iter; left time: 7951.7437s
	iters: 300, epoch: 16 | loss: 0.1242455
	speed: 0.2616s/iter; left time: 8126.0653s
Epoch: 16 cost time: 94.59902477264404
Epoch: 16, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.474 Vali Acc: 0.641 Test Loss: 1.474 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1027649
	speed: 0.7808s/iter; left time: 24123.0136s
	iters: 200, epoch: 17 | loss: 0.2061688
	speed: 0.2577s/iter; left time: 7937.2017s
	iters: 300, epoch: 17 | loss: 0.2941670
	speed: 0.2738s/iter; left time: 8404.3617s
Epoch: 17 cost time: 98.6586389541626
Epoch: 17, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.501 Vali Acc: 0.651 Test Loss: 1.501 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2168887
	speed: 0.7756s/iter; left time: 23677.2829s
	iters: 200, epoch: 18 | loss: 0.0280831
	speed: 0.2269s/iter; left time: 6903.1340s
	iters: 300, epoch: 18 | loss: 0.2247702
	speed: 0.2506s/iter; left time: 7599.6698s
Epoch: 18 cost time: 90.3808012008667
Epoch: 18, Steps: 369 | Train Loss: 0.082 Vali Loss: 1.626 Vali Acc: 0.645 Test Loss: 1.626 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0365123
	speed: 0.7657s/iter; left time: 23093.8993s
	iters: 200, epoch: 19 | loss: 0.0617738
	speed: 0.2385s/iter; left time: 7170.4184s
	iters: 300, epoch: 19 | loss: 0.0232500
	speed: 0.2371s/iter; left time: 7102.7871s
Epoch: 19 cost time: 90.57176661491394
Epoch: 19, Steps: 369 | Train Loss: 0.074 Vali Loss: 2.099 Vali Acc: 0.635 Test Loss: 2.099 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0444622
	speed: 0.7822s/iter; left time: 23302.6173s
	iters: 200, epoch: 20 | loss: 0.1309154
	speed: 0.2456s/iter; left time: 7291.3310s
	iters: 300, epoch: 20 | loss: 0.0086845
	speed: 0.2419s/iter; left time: 7157.2123s
Epoch: 20 cost time: 92.12179946899414
Epoch: 20, Steps: 369 | Train Loss: 0.074 Vali Loss: 1.719 Vali Acc: 0.643 Test Loss: 1.719 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0091994
	speed: 0.7799s/iter; left time: 22946.7179s
	iters: 200, epoch: 21 | loss: 0.0134656
	speed: 0.2724s/iter; left time: 7987.9744s
	iters: 300, epoch: 21 | loss: 0.0421628
	speed: 0.2554s/iter; left time: 7462.3432s
Epoch: 21 cost time: 97.06005668640137
Epoch: 21, Steps: 369 | Train Loss: 0.058 Vali Loss: 2.398 Vali Acc: 0.658 Test Loss: 2.398 Test Acc: 0.658
Validation loss decreased (-0.658049 --> -0.658319).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0182273
	speed: 0.8010s/iter; left time: 23269.3784s
	iters: 200, epoch: 22 | loss: 0.0120626
	speed: 0.2661s/iter; left time: 7703.8093s
	iters: 300, epoch: 22 | loss: 0.0412921
	speed: 0.2569s/iter; left time: 7412.9173s
Epoch: 22 cost time: 96.11093950271606
Epoch: 22, Steps: 369 | Train Loss: 0.048 Vali Loss: 2.112 Vali Acc: 0.658 Test Loss: 2.112 Test Acc: 0.658
Validation loss decreased (-0.658319 --> -0.658322).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0054501
	speed: 0.7631s/iter; left time: 21887.8071s
	iters: 200, epoch: 23 | loss: 0.0003700
	speed: 0.2487s/iter; left time: 7108.0436s
	iters: 300, epoch: 23 | loss: 0.1150414
	speed: 0.2704s/iter; left time: 7703.1924s
Epoch: 23 cost time: 95.32991695404053
Epoch: 23, Steps: 369 | Train Loss: 0.059 Vali Loss: 1.933 Vali Acc: 0.639 Test Loss: 1.933 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0020419
	speed: 0.7429s/iter; left time: 21034.5308s
	iters: 200, epoch: 24 | loss: 0.0018654
	speed: 0.2585s/iter; left time: 7293.4684s
	iters: 300, epoch: 24 | loss: 0.1650826
	speed: 0.2514s/iter; left time: 7066.6815s
Epoch: 24 cost time: 93.69662261009216
Epoch: 24, Steps: 369 | Train Loss: 0.052 Vali Loss: 2.165 Vali Acc: 0.644 Test Loss: 2.165 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0346315
	speed: 0.7540s/iter; left time: 21071.3487s
	iters: 200, epoch: 25 | loss: 0.0032627
	speed: 0.2526s/iter; left time: 7033.8627s
	iters: 300, epoch: 25 | loss: 0.0097684
	speed: 0.2671s/iter; left time: 7410.4923s
Epoch: 25 cost time: 95.39758706092834
Epoch: 25, Steps: 369 | Train Loss: 0.044 Vali Loss: 1.688 Vali Acc: 0.650 Test Loss: 1.688 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000337
	speed: 0.7845s/iter; left time: 21634.7317s
	iters: 200, epoch: 26 | loss: 0.0019091
	speed: 0.2399s/iter; left time: 6590.8705s
	iters: 300, epoch: 26 | loss: 0.1696493
	speed: 0.2573s/iter; left time: 7044.0950s
Epoch: 26 cost time: 92.73453307151794
Epoch: 26, Steps: 369 | Train Loss: 0.038 Vali Loss: 1.679 Vali Acc: 0.653 Test Loss: 1.679 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0173631
	speed: 0.7463s/iter; left time: 20304.7998s
	iters: 200, epoch: 27 | loss: 0.0040410
	speed: 0.2408s/iter; left time: 6526.3037s
	iters: 300, epoch: 27 | loss: 0.1201230
	speed: 0.2494s/iter; left time: 6735.5520s
Epoch: 27 cost time: 92.99004125595093
Epoch: 27, Steps: 369 | Train Loss: 0.040 Vali Loss: 1.889 Vali Acc: 0.673 Test Loss: 1.889 Test Acc: 0.673
Validation loss decreased (-0.658322 --> -0.672796).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000875
	speed: 0.8182s/iter; left time: 21959.9843s
	iters: 200, epoch: 28 | loss: 0.0224730
	speed: 0.2447s/iter; left time: 6543.2333s
	iters: 300, epoch: 28 | loss: 0.0012684
	speed: 0.2384s/iter; left time: 6350.0740s
Epoch: 28 cost time: 92.78502655029297
Epoch: 28, Steps: 369 | Train Loss: 0.048 Vali Loss: 1.709 Vali Acc: 0.652 Test Loss: 1.709 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0039646
	speed: 0.7899s/iter; left time: 20907.3038s
	iters: 200, epoch: 29 | loss: 0.0036649
	speed: 0.2715s/iter; left time: 7158.1379s
	iters: 300, epoch: 29 | loss: 0.0075105
	speed: 0.2547s/iter; left time: 6691.3550s
Epoch: 29 cost time: 98.22502851486206
Epoch: 29, Steps: 369 | Train Loss: 0.028 Vali Loss: 2.554 Vali Acc: 0.654 Test Loss: 2.554 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0231599
	speed: 0.8084s/iter; left time: 21100.0300s
	iters: 200, epoch: 30 | loss: 0.0008390
	speed: 0.2467s/iter; left time: 6415.3503s
	iters: 300, epoch: 30 | loss: 0.3249196
	speed: 0.2577s/iter; left time: 6675.4789s
Epoch: 30 cost time: 94.03114366531372
Epoch: 30, Steps: 369 | Train Loss: 0.047 Vali Loss: 2.137 Vali Acc: 0.648 Test Loss: 2.137 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000521
	speed: 0.7215s/iter; left time: 18565.1262s
	iters: 200, epoch: 31 | loss: 0.0720581
	speed: 0.2500s/iter; left time: 6408.6132s
	iters: 300, epoch: 31 | loss: 0.0019564
	speed: 0.2718s/iter; left time: 6939.5961s
Epoch: 31 cost time: 94.53782939910889
Epoch: 31, Steps: 369 | Train Loss: 0.041 Vali Loss: 2.311 Vali Acc: 0.652 Test Loss: 2.311 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.1000595
	speed: 0.7601s/iter; left time: 19277.1308s
	iters: 200, epoch: 32 | loss: 0.0007446
	speed: 0.2325s/iter; left time: 5873.1328s
	iters: 300, epoch: 32 | loss: 0.0015146
	speed: 0.2361s/iter; left time: 5940.7257s
Epoch: 32 cost time: 87.7275903224945
Epoch: 32, Steps: 369 | Train Loss: 0.031 Vali Loss: 2.205 Vali Acc: 0.654 Test Loss: 2.205 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0014720
	speed: 0.7824s/iter; left time: 19555.0594s
	iters: 200, epoch: 33 | loss: 0.0026206
	speed: 0.2732s/iter; left time: 6800.0695s
	iters: 300, epoch: 33 | loss: 0.0022635
	speed: 0.2735s/iter; left time: 6779.9106s
Epoch: 33 cost time: 101.34804034233093
Epoch: 33, Steps: 369 | Train Loss: 0.032 Vali Loss: 2.708 Vali Acc: 0.646 Test Loss: 2.708 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000055
	speed: 0.8182s/iter; left time: 20146.6262s
	iters: 200, epoch: 34 | loss: 0.0547781
	speed: 0.2418s/iter; left time: 5931.1206s
	iters: 300, epoch: 34 | loss: 0.0125650
	speed: 0.2377s/iter; left time: 5804.8339s
Epoch: 34 cost time: 91.66661310195923
Epoch: 34, Steps: 369 | Train Loss: 0.037 Vali Loss: 2.067 Vali Acc: 0.641 Test Loss: 2.067 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0016303
	speed: 0.7897s/iter; left time: 19153.0383s
	iters: 200, epoch: 35 | loss: 0.0001140
	speed: 0.2435s/iter; left time: 5880.9440s
	iters: 300, epoch: 35 | loss: 0.0191469
	speed: 0.2465s/iter; left time: 5929.5305s
Epoch: 35 cost time: 94.2998719215393
Epoch: 35, Steps: 369 | Train Loss: 0.022 Vali Loss: 2.324 Vali Acc: 0.648 Test Loss: 2.324 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0133834
	speed: 0.7598s/iter; left time: 18147.5045s
	iters: 200, epoch: 36 | loss: 0.0000593
	speed: 0.2525s/iter; left time: 6006.8519s
	iters: 300, epoch: 36 | loss: 0.0001695
	speed: 0.2314s/iter; left time: 5480.5864s
Epoch: 36 cost time: 90.61639785766602
Epoch: 36, Steps: 369 | Train Loss: 0.023 Vali Loss: 2.356 Vali Acc: 0.641 Test Loss: 2.356 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0602439
	speed: 0.7950s/iter; left time: 18696.5206s
	iters: 200, epoch: 37 | loss: 0.0014842
	speed: 0.2754s/iter; left time: 6449.5047s
	iters: 300, epoch: 37 | loss: 0.0050559
	speed: 0.2720s/iter; left time: 6341.4195s
Epoch: 37 cost time: 101.5042417049408
Epoch: 37, Steps: 369 | Train Loss: 0.030 Vali Loss: 2.515 Vali Acc: 0.640 Test Loss: 2.515 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5675901
	speed: 0.3007s/iter; left time: 11065.1428s
	iters: 200, epoch: 1 | loss: 0.6276982
	speed: 0.2713s/iter; left time: 9955.9118s
	iters: 300, epoch: 1 | loss: 0.6119661
	speed: 0.2586s/iter; left time: 9463.6019s
Epoch: 1 cost time: 100.43852996826172
Epoch: 1, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.942 Vali Acc: 0.654 Test Loss: 0.942 Test Acc: 0.654
Validation loss decreased (inf --> -0.653793).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5376638
	speed: 0.7929s/iter; left time: 28886.5489s
	iters: 200, epoch: 2 | loss: 0.3170086
	speed: 0.2744s/iter; left time: 9969.0513s
	iters: 300, epoch: 2 | loss: 1.0158238
	speed: 0.2430s/iter; left time: 8804.6636s
Epoch: 2 cost time: 97.72108006477356
Epoch: 2, Steps: 369 | Train Loss: 0.698 Vali Loss: 1.204 Vali Acc: 0.643 Test Loss: 1.204 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0503203
	speed: 0.7660s/iter; left time: 27623.1685s
	iters: 200, epoch: 3 | loss: 0.3837706
	speed: 0.2653s/iter; left time: 9540.1244s
	iters: 300, epoch: 3 | loss: 0.3425822
	speed: 0.2762s/iter; left time: 9906.6153s
Epoch: 3 cost time: 97.11310386657715
Epoch: 3, Steps: 369 | Train Loss: 0.688 Vali Loss: 1.557 Vali Acc: 0.612 Test Loss: 1.557 Test Acc: 0.612
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.2077723
	speed: 0.7965s/iter; left time: 28430.3195s
	iters: 200, epoch: 4 | loss: 1.1739200
	speed: 0.2959s/iter; left time: 10532.9645s
	iters: 300, epoch: 4 | loss: 1.0946126
	speed: 0.2894s/iter; left time: 10271.0877s
Epoch: 4 cost time: 104.14838433265686
Epoch: 4, Steps: 369 | Train Loss: 0.738 Vali Loss: 1.243 Vali Acc: 0.663 Test Loss: 1.243 Test Acc: 0.663
Validation loss decreased (-0.653793 --> -0.662587).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7053252
	speed: 0.7898s/iter; left time: 27898.1542s
	iters: 200, epoch: 5 | loss: 1.0025938
	speed: 0.2812s/iter; left time: 9906.4521s
	iters: 300, epoch: 5 | loss: 0.5537941
	speed: 0.2783s/iter; left time: 9775.8594s
Epoch: 5 cost time: 103.2785415649414
Epoch: 5, Steps: 369 | Train Loss: 0.713 Vali Loss: 1.789 Vali Acc: 0.629 Test Loss: 1.789 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0066447
	speed: 0.8096s/iter; left time: 28299.0687s
	iters: 200, epoch: 6 | loss: 0.6997218
	speed: 0.2698s/iter; left time: 9405.5798s
	iters: 300, epoch: 6 | loss: 0.9331967
	speed: 0.2597s/iter; left time: 9026.2994s
Epoch: 6 cost time: 99.08037614822388
Epoch: 6, Steps: 369 | Train Loss: 0.650 Vali Loss: 0.966 Vali Acc: 0.642 Test Loss: 0.966 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7159736
	speed: 0.7771s/iter; left time: 26879.1190s
	iters: 200, epoch: 7 | loss: 0.2858738
	speed: 0.2607s/iter; left time: 8989.4167s
	iters: 300, epoch: 7 | loss: 0.3371751
	speed: 0.2588s/iter; left time: 8900.5152s
Epoch: 7 cost time: 96.83911728858948
Epoch: 7, Steps: 369 | Train Loss: 0.552 Vali Loss: 0.749 Vali Acc: 0.665 Test Loss: 0.749 Test Acc: 0.665
Validation loss decreased (-0.662587 --> -0.665146).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3779988
	speed: 0.8230s/iter; left time: 28162.3783s
	iters: 200, epoch: 8 | loss: 0.3802610
	speed: 0.2645s/iter; left time: 9022.9251s
	iters: 300, epoch: 8 | loss: 0.2920614
	speed: 0.2813s/iter; left time: 9569.9622s
Epoch: 8 cost time: 102.77105712890625
Epoch: 8, Steps: 369 | Train Loss: 0.497 Vali Loss: 0.718 Vali Acc: 0.670 Test Loss: 0.718 Test Acc: 0.670
Validation loss decreased (-0.665146 --> -0.669686).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5114628
	speed: 0.8493s/iter; left time: 28748.5351s
	iters: 200, epoch: 9 | loss: 0.5672692
	speed: 0.2611s/iter; left time: 8810.3279s
	iters: 300, epoch: 9 | loss: 0.3533766
	speed: 0.2586s/iter; left time: 8702.7217s
Epoch: 9 cost time: 99.17730116844177
Epoch: 9, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.707 Vali Acc: 0.672 Test Loss: 0.707 Test Acc: 0.672
Validation loss decreased (-0.669686 --> -0.671673).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1407088
	speed: 0.8244s/iter; left time: 27601.2658s
	iters: 200, epoch: 10 | loss: 0.3456071
	speed: 0.2644s/iter; left time: 8827.0386s
	iters: 300, epoch: 10 | loss: 0.6187845
	speed: 0.2732s/iter; left time: 9091.5908s
Epoch: 10 cost time: 101.42946743965149
Epoch: 10, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.698 Vali Acc: 0.650 Test Loss: 0.698 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1057845
	speed: 0.8416s/iter; left time: 27866.0941s
	iters: 200, epoch: 11 | loss: 0.4228462
	speed: 0.2631s/iter; left time: 8685.5081s
	iters: 300, epoch: 11 | loss: 0.3026543
	speed: 0.2664s/iter; left time: 8767.7894s
Epoch: 11 cost time: 101.04806113243103
Epoch: 11, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.767 Vali Acc: 0.656 Test Loss: 0.767 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3833734
	speed: 0.8688s/iter; left time: 28446.3148s
	iters: 200, epoch: 12 | loss: 0.4606261
	speed: 0.2799s/iter; left time: 9137.2779s
	iters: 300, epoch: 12 | loss: 0.1317925
	speed: 0.2824s/iter; left time: 9188.3941s
Epoch: 12 cost time: 104.637455701828
Epoch: 12, Steps: 369 | Train Loss: 0.321 Vali Loss: 0.853 Vali Acc: 0.662 Test Loss: 0.853 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1383207
	speed: 0.8228s/iter; left time: 26636.1931s
	iters: 200, epoch: 13 | loss: 0.1554155
	speed: 0.2653s/iter; left time: 8560.7875s
	iters: 300, epoch: 13 | loss: 0.4971955
	speed: 0.2984s/iter; left time: 9601.6879s
Epoch: 13 cost time: 103.20509266853333
Epoch: 13, Steps: 369 | Train Loss: 0.286 Vali Loss: 0.832 Vali Acc: 0.677 Test Loss: 0.832 Test Acc: 0.677
Validation loss decreased (-0.671673 --> -0.677347).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2861867
	speed: 0.8461s/iter; left time: 27078.7048s
	iters: 200, epoch: 14 | loss: 0.1192022
	speed: 0.2778s/iter; left time: 8863.3831s
	iters: 300, epoch: 14 | loss: 0.5429645
	speed: 0.2872s/iter; left time: 9135.1567s
Epoch: 14 cost time: 103.93394827842712
Epoch: 14, Steps: 369 | Train Loss: 0.260 Vali Loss: 0.875 Vali Acc: 0.672 Test Loss: 0.875 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0464698
	speed: 0.8274s/iter; left time: 26175.2636s
	iters: 200, epoch: 15 | loss: 0.1431820
	speed: 0.2938s/iter; left time: 9264.1815s
	iters: 300, epoch: 15 | loss: 0.2330802
	speed: 0.2845s/iter; left time: 8943.3884s
Epoch: 15 cost time: 105.01879167556763
Epoch: 15, Steps: 369 | Train Loss: 0.249 Vali Loss: 0.955 Vali Acc: 0.663 Test Loss: 0.955 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1730462
	speed: 0.8006s/iter; left time: 25030.8304s
	iters: 200, epoch: 16 | loss: 0.1998411
	speed: 0.2838s/iter; left time: 8844.1510s
	iters: 300, epoch: 16 | loss: 0.2359470
	speed: 0.2940s/iter; left time: 9132.0256s
Epoch: 16 cost time: 102.41944479942322
Epoch: 16, Steps: 369 | Train Loss: 0.217 Vali Loss: 0.983 Vali Acc: 0.674 Test Loss: 0.983 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1242698
	speed: 0.8014s/iter; left time: 24760.3465s
	iters: 200, epoch: 17 | loss: 0.3467217
	speed: 0.2919s/iter; left time: 8988.7703s
	iters: 300, epoch: 17 | loss: 0.3563292
	speed: 0.2893s/iter; left time: 8881.8700s
Epoch: 17 cost time: 104.91360592842102
Epoch: 17, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.035 Vali Acc: 0.661 Test Loss: 1.035 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2401047
	speed: 0.8431s/iter; left time: 25738.0047s
	iters: 200, epoch: 18 | loss: 0.1938347
	speed: 0.2983s/iter; left time: 9076.8706s
	iters: 300, epoch: 18 | loss: 0.3713340
	speed: 0.2890s/iter; left time: 8765.0110s
Epoch: 18 cost time: 107.34701633453369
Epoch: 18, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.318 Vali Acc: 0.657 Test Loss: 1.318 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.2650732
	speed: 0.8100s/iter; left time: 24428.0871s
	iters: 200, epoch: 19 | loss: 0.1123161
	speed: 0.2770s/iter; left time: 8327.6924s
	iters: 300, epoch: 19 | loss: 0.2538781
	speed: 0.2857s/iter; left time: 8559.0479s
Epoch: 19 cost time: 103.69358038902283
Epoch: 19, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.405 Vali Acc: 0.651 Test Loss: 1.405 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0579551
	speed: 0.8243s/iter; left time: 24556.6996s
	iters: 200, epoch: 20 | loss: 0.0364383
	speed: 0.2660s/iter; left time: 7897.9364s
	iters: 300, epoch: 20 | loss: 0.0397172
	speed: 0.2753s/iter; left time: 8146.6943s
Epoch: 20 cost time: 101.31126856803894
Epoch: 20, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.627 Vali Acc: 0.643 Test Loss: 1.627 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1772968
	speed: 0.8370s/iter; left time: 24624.1617s
	iters: 200, epoch: 21 | loss: 0.0485133
	speed: 0.2656s/iter; left time: 7788.9044s
	iters: 300, epoch: 21 | loss: 0.2140606
	speed: 0.2708s/iter; left time: 7912.6376s
Epoch: 21 cost time: 98.85759091377258
Epoch: 21, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.577 Vali Acc: 0.645 Test Loss: 1.577 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0515379
	speed: 0.8172s/iter; left time: 23740.8776s
	iters: 200, epoch: 22 | loss: 0.1457092
	speed: 0.2849s/iter; left time: 8249.8283s
	iters: 300, epoch: 22 | loss: 0.0251648
	speed: 0.2705s/iter; left time: 7805.2613s
Epoch: 22 cost time: 103.71453714370728
Epoch: 22, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.608 Vali Acc: 0.655 Test Loss: 1.608 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0258846
	speed: 0.8161s/iter; left time: 23406.8705s
	iters: 200, epoch: 23 | loss: 0.0242507
	speed: 0.2681s/iter; left time: 7663.1213s
	iters: 300, epoch: 23 | loss: 0.0845190
	speed: 0.2787s/iter; left time: 7937.4099s
Epoch: 23 cost time: 100.93227815628052
Epoch: 23, Steps: 369 | Train Loss: 0.109 Vali Loss: 2.189 Vali Acc: 0.654 Test Loss: 2.189 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677355278093076
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5588873
	speed: 0.2614s/iter; left time: 9619.2312s
	iters: 200, epoch: 1 | loss: 0.5594121
	speed: 0.2716s/iter; left time: 9969.7361s
	iters: 300, epoch: 1 | loss: 0.6815962
	speed: 0.2643s/iter; left time: 9671.9769s
Epoch: 1 cost time: 97.57425880432129
Epoch: 1, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.933 Vali Acc: 0.664 Test Loss: 0.933 Test Acc: 0.664
Validation loss decreased (inf --> -0.663725).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3765695
	speed: 0.7507s/iter; left time: 27348.3413s
	iters: 200, epoch: 2 | loss: 0.3840647
	speed: 0.2387s/iter; left time: 8673.1291s
	iters: 300, epoch: 2 | loss: 0.9073504
	speed: 0.2542s/iter; left time: 9208.3824s
Epoch: 2 cost time: 92.81592202186584
Epoch: 2, Steps: 369 | Train Loss: 0.677 Vali Loss: 1.139 Vali Acc: 0.648 Test Loss: 1.139 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8611681
	speed: 0.8020s/iter; left time: 28920.8801s
	iters: 200, epoch: 3 | loss: 0.7379395
	speed: 0.2520s/iter; left time: 9063.8699s
	iters: 300, epoch: 3 | loss: 0.4207851
	speed: 0.2439s/iter; left time: 8747.8998s
Epoch: 3 cost time: 93.93064212799072
Epoch: 3, Steps: 369 | Train Loss: 0.692 Vali Loss: 1.404 Vali Acc: 0.630 Test Loss: 1.404 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7235554
	speed: 0.8194s/iter; left time: 29247.4128s
	iters: 200, epoch: 4 | loss: 0.9178721
	speed: 0.2548s/iter; left time: 9067.7887s
	iters: 300, epoch: 4 | loss: 0.8746243
	speed: 0.2512s/iter; left time: 8917.7135s
Epoch: 4 cost time: 94.36859273910522
Epoch: 4, Steps: 369 | Train Loss: 0.721 Vali Loss: 1.410 Vali Acc: 0.649 Test Loss: 1.410 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.4607589
	speed: 0.7788s/iter; left time: 27511.3745s
	iters: 200, epoch: 5 | loss: 1.1839943
	speed: 0.2767s/iter; left time: 9747.0903s
	iters: 300, epoch: 5 | loss: 0.4205261
	speed: 0.2615s/iter; left time: 9185.9280s
Epoch: 5 cost time: 99.01213192939758
Epoch: 5, Steps: 369 | Train Loss: 0.758 Vali Loss: 1.567 Vali Acc: 0.631 Test Loss: 1.567 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8663643
	speed: 0.7561s/iter; left time: 26431.2458s
	iters: 200, epoch: 6 | loss: 1.2645698
	speed: 0.2727s/iter; left time: 9506.1470s
	iters: 300, epoch: 6 | loss: 1.0009310
	speed: 0.2693s/iter; left time: 9361.1941s
Epoch: 6 cost time: 98.10312104225159
Epoch: 6, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.989 Vali Acc: 0.605 Test Loss: 0.989 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5513856
	speed: 0.7628s/iter; left time: 26384.3246s
	iters: 200, epoch: 7 | loss: 0.4330512
	speed: 0.2514s/iter; left time: 8671.3685s
	iters: 300, epoch: 7 | loss: 0.4987289
	speed: 0.2627s/iter; left time: 9032.6589s
Epoch: 7 cost time: 94.99938893318176
Epoch: 7, Steps: 369 | Train Loss: 0.580 Vali Loss: 0.770 Vali Acc: 0.614 Test Loss: 0.770 Test Acc: 0.614
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.5534531
	speed: 0.7871s/iter; left time: 26931.7173s
	iters: 200, epoch: 8 | loss: 0.5898881
	speed: 0.2404s/iter; left time: 8203.3887s
	iters: 300, epoch: 8 | loss: 0.5259449
	speed: 0.2463s/iter; left time: 8379.2855s
Epoch: 8 cost time: 91.74681949615479
Epoch: 8, Steps: 369 | Train Loss: 0.528 Vali Loss: 0.715 Vali Acc: 0.660 Test Loss: 0.715 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4071311
	speed: 0.7661s/iter; left time: 25931.6566s
	iters: 200, epoch: 9 | loss: 0.6673855
	speed: 0.2541s/iter; left time: 8574.7204s
	iters: 300, epoch: 9 | loss: 0.7369894
	speed: 0.2607s/iter; left time: 8773.0147s
Epoch: 9 cost time: 94.81052708625793
Epoch: 9, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.801 Vali Acc: 0.663 Test Loss: 0.801 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.3058354
	speed: 0.7664s/iter; left time: 25659.6365s
	iters: 200, epoch: 10 | loss: 0.2801537
	speed: 0.2538s/iter; left time: 8471.8590s
	iters: 300, epoch: 10 | loss: 0.3908504
	speed: 0.2468s/iter; left time: 8214.2661s
Epoch: 10 cost time: 92.51081466674805
Epoch: 10, Steps: 369 | Train Loss: 0.494 Vali Loss: 0.656 Vali Acc: 0.671 Test Loss: 0.656 Test Acc: 0.671
Validation loss decreased (-0.663725 --> -0.670822).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1688288
	speed: 0.8085s/iter; left time: 26770.6342s
	iters: 200, epoch: 11 | loss: 0.4094921
	speed: 0.2493s/iter; left time: 8228.4821s
	iters: 300, epoch: 11 | loss: 0.4850743
	speed: 0.2617s/iter; left time: 8611.9071s
Epoch: 11 cost time: 95.72130107879639
Epoch: 11, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.762 Vali Acc: 0.651 Test Loss: 0.762 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5971977
	speed: 0.8243s/iter; left time: 26990.6603s
	iters: 200, epoch: 12 | loss: 0.4965143
	speed: 0.2626s/iter; left time: 8570.4073s
	iters: 300, epoch: 12 | loss: 0.3411828
	speed: 0.2532s/iter; left time: 8240.7906s
Epoch: 12 cost time: 98.1183032989502
Epoch: 12, Steps: 369 | Train Loss: 0.436 Vali Loss: 0.734 Vali Acc: 0.683 Test Loss: 0.734 Test Acc: 0.683
Validation loss decreased (-0.670822 --> -0.683307).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3390005
	speed: 0.8461s/iter; left time: 27392.1992s
	iters: 200, epoch: 13 | loss: 0.4385675
	speed: 0.2476s/iter; left time: 7992.2398s
	iters: 300, epoch: 13 | loss: 0.4357215
	speed: 0.2546s/iter; left time: 8191.4261s
Epoch: 13 cost time: 97.1055862903595
Epoch: 13, Steps: 369 | Train Loss: 0.413 Vali Loss: 0.735 Vali Acc: 0.661 Test Loss: 0.735 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3389106
	speed: 0.8001s/iter; left time: 25607.5079s
	iters: 200, epoch: 14 | loss: 0.2558153
	speed: 0.2584s/iter; left time: 8243.4541s
	iters: 300, epoch: 14 | loss: 0.5022277
	speed: 0.2551s/iter; left time: 8112.1278s
Epoch: 14 cost time: 96.13603711128235
Epoch: 14, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.726 Vali Acc: 0.680 Test Loss: 0.726 Test Acc: 0.680
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2388997
	speed: 0.8223s/iter; left time: 26014.5788s
	iters: 200, epoch: 15 | loss: 0.2012565
	speed: 0.2509s/iter; left time: 7911.1048s
	iters: 300, epoch: 15 | loss: 0.2913904
	speed: 0.2620s/iter; left time: 8235.6485s
Epoch: 15 cost time: 96.81286716461182
Epoch: 15, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.761 Vali Acc: 0.677 Test Loss: 0.761 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2073753
	speed: 0.8072s/iter; left time: 25237.1815s
	iters: 200, epoch: 16 | loss: 0.6254735
	speed: 0.2473s/iter; left time: 7707.1487s
	iters: 300, epoch: 16 | loss: 0.3499231
	speed: 0.2496s/iter; left time: 7753.7242s
Epoch: 16 cost time: 92.9241349697113
Epoch: 16, Steps: 369 | Train Loss: 0.327 Vali Loss: 0.904 Vali Acc: 0.665 Test Loss: 0.904 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2035440
	speed: 0.7884s/iter; left time: 24359.7626s
	iters: 200, epoch: 17 | loss: 0.4535845
	speed: 0.2447s/iter; left time: 7537.4593s
	iters: 300, epoch: 17 | loss: 0.2797604
	speed: 0.2475s/iter; left time: 7596.0877s
Epoch: 17 cost time: 93.31660485267639
Epoch: 17, Steps: 369 | Train Loss: 0.304 Vali Loss: 0.801 Vali Acc: 0.661 Test Loss: 0.801 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6121942
	speed: 0.8120s/iter; left time: 24789.5996s
	iters: 200, epoch: 18 | loss: 0.7040666
	speed: 0.2566s/iter; left time: 7809.1154s
	iters: 300, epoch: 18 | loss: 0.1927394
	speed: 0.2668s/iter; left time: 8092.5952s
Epoch: 18 cost time: 98.25849056243896
Epoch: 18, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.025 Vali Acc: 0.659 Test Loss: 1.025 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2998726
	speed: 0.7993s/iter; left time: 24104.7276s
	iters: 200, epoch: 19 | loss: 0.2884493
	speed: 0.2700s/iter; left time: 8114.8587s
	iters: 300, epoch: 19 | loss: 0.3738080
	speed: 0.2722s/iter; left time: 8153.8060s
Epoch: 19 cost time: 98.93589878082275
Epoch: 19, Steps: 369 | Train Loss: 0.248 Vali Loss: 0.923 Vali Acc: 0.673 Test Loss: 0.923 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0530893
	speed: 0.8088s/iter; left time: 24094.1918s
	iters: 200, epoch: 20 | loss: 0.2192217
	speed: 0.2686s/iter; left time: 7975.5825s
	iters: 300, epoch: 20 | loss: 0.2745986
	speed: 0.2564s/iter; left time: 7585.5372s
Epoch: 20 cost time: 97.77404046058655
Epoch: 20, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.051 Vali Acc: 0.658 Test Loss: 1.051 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3992246
	speed: 0.8238s/iter; left time: 24237.6330s
	iters: 200, epoch: 21 | loss: 0.2038720
	speed: 0.2548s/iter; left time: 7471.0160s
	iters: 300, epoch: 21 | loss: 0.3776158
	speed: 0.2693s/iter; left time: 7870.1224s
Epoch: 21 cost time: 98.36881041526794
Epoch: 21, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.089 Vali Acc: 0.646 Test Loss: 1.089 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0620330
	speed: 0.8048s/iter; left time: 23380.8466s
	iters: 200, epoch: 22 | loss: 0.2628180
	speed: 0.2758s/iter; left time: 7984.9919s
	iters: 300, epoch: 22 | loss: 0.0887786
	speed: 0.2631s/iter; left time: 7591.9193s
Epoch: 22 cost time: 97.66402411460876
Epoch: 22, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.167 Vali Acc: 0.658 Test Loss: 1.167 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6833144154370034
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6925335
	speed: 0.2734s/iter; left time: 10061.8294s
	iters: 200, epoch: 1 | loss: 0.6939958
	speed: 0.2641s/iter; left time: 9693.6502s
	iters: 300, epoch: 1 | loss: 0.6922665
	speed: 0.2722s/iter; left time: 9961.4758s
Epoch: 1 cost time: 100.63507008552551
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6938530
	speed: 0.8194s/iter; left time: 29850.8134s
	iters: 200, epoch: 2 | loss: 0.6939235
	speed: 0.2835s/iter; left time: 10301.5377s
	iters: 300, epoch: 2 | loss: 0.6925684
	speed: 0.2443s/iter; left time: 8851.9407s
Epoch: 2 cost time: 96.73558950424194
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6928382
	speed: 0.7371s/iter; left time: 26581.3031s
	iters: 200, epoch: 3 | loss: 0.6931483
	speed: 0.2467s/iter; left time: 8870.6704s
	iters: 300, epoch: 3 | loss: 0.6947238
	speed: 0.2309s/iter; left time: 8281.9182s
Epoch: 3 cost time: 90.23543381690979
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6942707
	speed: 0.7837s/iter; left time: 27971.9749s
	iters: 200, epoch: 4 | loss: 0.6955781
	speed: 0.2524s/iter; left time: 8984.9125s
	iters: 300, epoch: 4 | loss: 0.6932243
	speed: 0.2487s/iter; left time: 8826.1239s
Epoch: 4 cost time: 94.94412589073181
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6923845
	speed: 0.7922s/iter; left time: 27984.2454s
	iters: 200, epoch: 5 | loss: 0.6971132
	speed: 0.2491s/iter; left time: 8772.9483s
	iters: 300, epoch: 5 | loss: 0.6918061
	speed: 0.2494s/iter; left time: 8759.1345s
Epoch: 5 cost time: 93.32147741317749
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6920396
	speed: 0.7707s/iter; left time: 26939.8132s
	iters: 200, epoch: 6 | loss: 0.6940642
	speed: 0.2470s/iter; left time: 8609.9757s
	iters: 300, epoch: 6 | loss: 0.6923108
	speed: 0.2474s/iter; left time: 8600.2193s
Epoch: 6 cost time: 93.63610100746155
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6931442
	speed: 0.8245s/iter; left time: 28517.3547s
	iters: 200, epoch: 7 | loss: 0.6931493
	speed: 0.2546s/iter; left time: 8780.5839s
	iters: 300, epoch: 7 | loss: 0.6937969
	speed: 0.2484s/iter; left time: 8540.0287s
Epoch: 7 cost time: 96.86383509635925
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6931760
	speed: 0.7577s/iter; left time: 25927.0308s
	iters: 200, epoch: 8 | loss: 0.6917501
	speed: 0.2407s/iter; left time: 8212.1115s
	iters: 300, epoch: 8 | loss: 0.6951074
	speed: 0.2592s/iter; left time: 8818.9035s
Epoch: 8 cost time: 94.10198640823364
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6941648
	speed: 0.8024s/iter; left time: 27161.1203s
	iters: 200, epoch: 9 | loss: 0.6932606
	speed: 0.2764s/iter; left time: 9329.1287s
	iters: 300, epoch: 9 | loss: 0.6923193
	speed: 0.2729s/iter; left time: 9181.7623s
Epoch: 9 cost time: 99.56839919090271
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6958110
	speed: 0.7751s/iter; left time: 25951.2335s
	iters: 200, epoch: 10 | loss: 0.6923310
	speed: 0.2401s/iter; left time: 8013.3389s
	iters: 300, epoch: 10 | loss: 0.6913642
	speed: 0.2546s/iter; left time: 8472.4063s
Epoch: 10 cost time: 92.51212620735168
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6933833
	speed: 0.7963s/iter; left time: 26365.4192s
	iters: 200, epoch: 11 | loss: 0.6957387
	speed: 0.2777s/iter; left time: 9166.2597s
	iters: 300, epoch: 11 | loss: 0.6951980
	speed: 0.2837s/iter; left time: 9337.8367s
Epoch: 11 cost time: 102.51883172988892
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6919159
	speed: 0.7734s/iter; left time: 25321.9047s
	iters: 200, epoch: 12 | loss: 0.7030541
	speed: 0.2471s/iter; left time: 8065.4524s
	iters: 300, epoch: 12 | loss: 0.6931553
	speed: 0.2523s/iter; left time: 8211.7678s
Epoch: 12 cost time: 92.9717264175415
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6932648
	speed: 0.7492s/iter; left time: 24253.6854s
	iters: 200, epoch: 13 | loss: 0.6921702
	speed: 0.2591s/iter; left time: 8362.3421s
	iters: 300, epoch: 13 | loss: 0.6934199
	speed: 0.2620s/iter; left time: 8429.2182s
Epoch: 13 cost time: 95.72301602363586
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 3775746
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6849054
	speed: 0.2942s/iter; left time: 10826.3562s
	iters: 200, epoch: 1 | loss: 0.5325315
	speed: 0.2773s/iter; left time: 10176.9060s
	iters: 300, epoch: 1 | loss: 0.8705645
	speed: 0.2486s/iter; left time: 9098.8040s
Epoch: 1 cost time: 99.21680021286011
Epoch: 1, Steps: 369 | Train Loss: 0.680 Vali Loss: 0.818 Vali Acc: 0.655 Test Loss: 0.818 Test Acc: 0.655
Validation loss decreased (inf --> -0.654929).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8207359
	speed: 0.7974s/iter; left time: 29051.0352s
	iters: 200, epoch: 2 | loss: 0.4902065
	speed: 0.2584s/iter; left time: 9389.4956s
	iters: 300, epoch: 2 | loss: 1.3186268
	speed: 0.2605s/iter; left time: 9440.1490s
Epoch: 2 cost time: 97.6961874961853
Epoch: 2, Steps: 369 | Train Loss: 0.621 Vali Loss: 1.244 Vali Acc: 0.615 Test Loss: 1.244 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8433616
	speed: 0.8329s/iter; left time: 30036.6466s
	iters: 200, epoch: 3 | loss: 0.2056714
	speed: 0.2638s/iter; left time: 9488.4519s
	iters: 300, epoch: 3 | loss: 0.1009790
	speed: 0.2549s/iter; left time: 9139.7107s
Epoch: 3 cost time: 98.65541815757751
Epoch: 3, Steps: 369 | Train Loss: 0.574 Vali Loss: 1.357 Vali Acc: 0.645 Test Loss: 1.357 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6373169
	speed: 0.7933s/iter; left time: 28314.8398s
	iters: 200, epoch: 4 | loss: 0.1485385
	speed: 0.2761s/iter; left time: 9826.9893s
	iters: 300, epoch: 4 | loss: 0.2967079
	speed: 0.2616s/iter; left time: 9284.6041s
Epoch: 4 cost time: 100.55783534049988
Epoch: 4, Steps: 369 | Train Loss: 0.613 Vali Loss: 1.384 Vali Acc: 0.646 Test Loss: 1.384 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0980684
	speed: 0.8421s/iter; left time: 29747.4834s
	iters: 200, epoch: 5 | loss: 1.2601851
	speed: 0.2693s/iter; left time: 9487.4869s
	iters: 300, epoch: 5 | loss: 0.5566815
	speed: 0.2649s/iter; left time: 9303.8431s
Epoch: 5 cost time: 102.5278263092041
Epoch: 5, Steps: 369 | Train Loss: 0.661 Vali Loss: 1.894 Vali Acc: 0.614 Test Loss: 1.894 Test Acc: 0.614
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3021085
	speed: 0.8184s/iter; left time: 28609.5479s
	iters: 200, epoch: 6 | loss: 0.4306566
	speed: 0.2525s/iter; left time: 8800.0509s
	iters: 300, epoch: 6 | loss: 0.2268393
	speed: 0.2620s/iter; left time: 9107.0175s
Epoch: 6 cost time: 96.36350560188293
Epoch: 6, Steps: 369 | Train Loss: 0.573 Vali Loss: 1.781 Vali Acc: 0.649 Test Loss: 1.781 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1591186
	speed: 0.8079s/iter; left time: 27944.4478s
	iters: 200, epoch: 7 | loss: 0.3755936
	speed: 0.2673s/iter; left time: 9217.0498s
	iters: 300, epoch: 7 | loss: 0.4561662
	speed: 0.2805s/iter; left time: 9646.5318s
Epoch: 7 cost time: 100.35983276367188
Epoch: 7, Steps: 369 | Train Loss: 0.590 Vali Loss: 1.952 Vali Acc: 0.649 Test Loss: 1.952 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0559914
	speed: 0.8267s/iter; left time: 28289.3832s
	iters: 200, epoch: 8 | loss: 0.6817669
	speed: 0.2711s/iter; left time: 9248.2190s
	iters: 300, epoch: 8 | loss: 0.0451700
	speed: 0.2670s/iter; left time: 9082.0626s
Epoch: 8 cost time: 100.1006121635437
Epoch: 8, Steps: 369 | Train Loss: 0.527 Vali Loss: 2.080 Vali Acc: 0.642 Test Loss: 2.080 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0974975
	speed: 0.8049s/iter; left time: 27244.2245s
	iters: 200, epoch: 9 | loss: 0.2280224
	speed: 0.2843s/iter; left time: 9596.2056s
	iters: 300, epoch: 9 | loss: 0.1217240
	speed: 0.2701s/iter; left time: 9089.9014s
Epoch: 9 cost time: 102.8394980430603
Epoch: 9, Steps: 369 | Train Loss: 0.529 Vali Loss: 1.961 Vali Acc: 0.653 Test Loss: 1.961 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.2671369
	speed: 0.8328s/iter; left time: 27880.7150s
	iters: 200, epoch: 10 | loss: 0.4103709
	speed: 0.2561s/iter; left time: 8548.2305s
	iters: 300, epoch: 10 | loss: 1.0105174
	speed: 0.2536s/iter; left time: 8439.0827s
Epoch: 10 cost time: 98.36452317237854
Epoch: 10, Steps: 369 | Train Loss: 0.444 Vali Loss: 2.193 Vali Acc: 0.657 Test Loss: 2.193 Test Acc: 0.657
Validation loss decreased (-0.654929 --> -0.656902).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7341853
	speed: 0.8241s/iter; left time: 27286.4009s
	iters: 200, epoch: 11 | loss: 0.2528736
	speed: 0.2642s/iter; left time: 8722.3870s
	iters: 300, epoch: 11 | loss: 0.0203800
	speed: 0.2866s/iter; left time: 9430.6510s
Epoch: 11 cost time: 101.79540657997131
Epoch: 11, Steps: 369 | Train Loss: 0.398 Vali Loss: 1.957 Vali Acc: 0.648 Test Loss: 1.957 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5113949
	speed: 0.8274s/iter; left time: 27090.1233s
	iters: 200, epoch: 12 | loss: 0.1840707
	speed: 0.2774s/iter; left time: 9053.4070s
	iters: 300, epoch: 12 | loss: 0.4406606
	speed: 0.2824s/iter; left time: 9189.4445s
Epoch: 12 cost time: 101.95527935028076
Epoch: 12, Steps: 369 | Train Loss: 0.325 Vali Loss: 2.044 Vali Acc: 0.631 Test Loss: 2.044 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2787800
	speed: 0.8316s/iter; left time: 26920.1397s
	iters: 200, epoch: 13 | loss: 0.5927976
	speed: 0.2695s/iter; left time: 8698.6307s
	iters: 300, epoch: 13 | loss: 0.2847551
	speed: 0.2798s/iter; left time: 9003.2434s
Epoch: 13 cost time: 103.81338310241699
Epoch: 13, Steps: 369 | Train Loss: 0.292 Vali Loss: 2.171 Vali Acc: 0.652 Test Loss: 2.171 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0322345
	speed: 0.8330s/iter; left time: 26658.5670s
	iters: 200, epoch: 14 | loss: 0.2755406
	speed: 0.2447s/iter; left time: 7807.9809s
	iters: 300, epoch: 14 | loss: 0.2407373
	speed: 0.2554s/iter; left time: 8123.4352s
Epoch: 14 cost time: 98.43180441856384
Epoch: 14, Steps: 369 | Train Loss: 0.234 Vali Loss: 2.164 Vali Acc: 0.657 Test Loss: 2.164 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0059511
	speed: 0.8237s/iter; left time: 26057.7901s
	iters: 200, epoch: 15 | loss: 0.0086126
	speed: 0.2740s/iter; left time: 8640.5962s
	iters: 300, epoch: 15 | loss: 0.0493763
	speed: 0.2704s/iter; left time: 8499.5900s
Epoch: 15 cost time: 100.41856837272644
Epoch: 15, Steps: 369 | Train Loss: 0.204 Vali Loss: 2.184 Vali Acc: 0.649 Test Loss: 2.184 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1039978
	speed: 0.7810s/iter; left time: 24419.4898s
	iters: 200, epoch: 16 | loss: 0.2173292
	speed: 0.2800s/iter; left time: 8725.5945s
	iters: 300, epoch: 16 | loss: 0.0197425
	speed: 0.2938s/iter; left time: 9127.2669s
Epoch: 16 cost time: 103.0299654006958
Epoch: 16, Steps: 369 | Train Loss: 0.179 Vali Loss: 2.110 Vali Acc: 0.638 Test Loss: 2.110 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0886246
	speed: 0.7939s/iter; left time: 24528.3860s
	iters: 200, epoch: 17 | loss: 0.0036621
	speed: 0.2620s/iter; left time: 8068.3448s
	iters: 300, epoch: 17 | loss: 0.1609277
	speed: 0.2781s/iter; left time: 8536.1466s
Epoch: 17 cost time: 99.47032308578491
Epoch: 17, Steps: 369 | Train Loss: 0.135 Vali Loss: 2.383 Vali Acc: 0.635 Test Loss: 2.383 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0326939
	speed: 0.8108s/iter; left time: 24752.8096s
	iters: 200, epoch: 18 | loss: 0.1031878
	speed: 0.2758s/iter; left time: 8392.3549s
	iters: 300, epoch: 18 | loss: 0.1968228
	speed: 0.2785s/iter; left time: 8447.8419s
Epoch: 18 cost time: 101.39583420753479
Epoch: 18, Steps: 369 | Train Loss: 0.125 Vali Loss: 2.375 Vali Acc: 0.647 Test Loss: 2.375 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1812378
	speed: 0.8087s/iter; left time: 24390.9983s
	iters: 200, epoch: 19 | loss: 0.0271717
	speed: 0.2808s/iter; left time: 8439.4753s
	iters: 300, epoch: 19 | loss: 0.0003647
	speed: 0.2703s/iter; left time: 8098.0085s
Epoch: 19 cost time: 101.6993978023529
Epoch: 19, Steps: 369 | Train Loss: 0.115 Vali Loss: 2.374 Vali Acc: 0.649 Test Loss: 2.374 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0186454
	speed: 0.8391s/iter; left time: 24997.7185s
	iters: 200, epoch: 20 | loss: 0.1564209
	speed: 0.2791s/iter; left time: 8285.2039s
	iters: 300, epoch: 20 | loss: 0.3969558
	speed: 0.2706s/iter; left time: 8006.7592s
Epoch: 20 cost time: 101.52306580543518
Epoch: 20, Steps: 369 | Train Loss: 0.103 Vali Loss: 2.530 Vali Acc: 0.638 Test Loss: 2.530 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6569239500567536
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8353947
	speed: 0.2806s/iter; left time: 10324.6818s
	iters: 200, epoch: 1 | loss: 0.6627676
	speed: 0.2800s/iter; left time: 10275.3101s
	iters: 300, epoch: 1 | loss: 0.7590466
	speed: 0.2812s/iter; left time: 10292.8612s
Epoch: 1 cost time: 104.75704884529114
Epoch: 1, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.813 Vali Acc: 0.652 Test Loss: 0.813 Test Acc: 0.652
Validation loss decreased (inf --> -0.651524).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8913171
	speed: 0.8524s/iter; left time: 31053.9134s
	iters: 200, epoch: 2 | loss: 0.3563554
	speed: 0.2618s/iter; left time: 9510.0942s
	iters: 300, epoch: 2 | loss: 0.8986915
	speed: 0.2726s/iter; left time: 9875.2950s
Epoch: 2 cost time: 100.51893258094788
Epoch: 2, Steps: 369 | Train Loss: 0.618 Vali Loss: 1.307 Vali Acc: 0.613 Test Loss: 1.307 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8608009
	speed: 0.7970s/iter; left time: 28741.0964s
	iters: 200, epoch: 3 | loss: 0.1981295
	speed: 0.2751s/iter; left time: 9895.2017s
	iters: 300, epoch: 3 | loss: 0.2990047
	speed: 0.2723s/iter; left time: 9767.0595s
Epoch: 3 cost time: 100.95455002784729
Epoch: 3, Steps: 369 | Train Loss: 0.591 Vali Loss: 1.201 Vali Acc: 0.644 Test Loss: 1.201 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4708096
	speed: 0.8357s/iter; left time: 29830.0214s
	iters: 200, epoch: 4 | loss: 0.4796238
	speed: 0.2816s/iter; left time: 10023.5254s
	iters: 300, epoch: 4 | loss: 0.4411497
	speed: 0.2694s/iter; left time: 9561.7623s
Epoch: 4 cost time: 100.85414004325867
Epoch: 4, Steps: 369 | Train Loss: 0.583 Vali Loss: 1.499 Vali Acc: 0.642 Test Loss: 1.499 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1592901
	speed: 0.7833s/iter; left time: 27668.9160s
	iters: 200, epoch: 5 | loss: 0.4449601
	speed: 0.2807s/iter; left time: 9888.2553s
	iters: 300, epoch: 5 | loss: 0.5280485
	speed: 0.2836s/iter; left time: 9961.6077s
Epoch: 5 cost time: 102.42341589927673
Epoch: 5, Steps: 369 | Train Loss: 0.634 Vali Loss: 1.526 Vali Acc: 0.637 Test Loss: 1.526 Test Acc: 0.637
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8648033
	speed: 0.7986s/iter; left time: 27916.1600s
	iters: 200, epoch: 6 | loss: 0.5815539
	speed: 0.2884s/iter; left time: 10051.3532s
	iters: 300, epoch: 6 | loss: 0.3006688
	speed: 0.2791s/iter; left time: 9699.0330s
Epoch: 6 cost time: 99.89789152145386
Epoch: 6, Steps: 369 | Train Loss: 0.604 Vali Loss: 2.175 Vali Acc: 0.608 Test Loss: 2.175 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7966200
	speed: 0.7868s/iter; left time: 27214.3597s
	iters: 200, epoch: 7 | loss: 0.5079610
	speed: 0.2940s/iter; left time: 10138.8845s
	iters: 300, epoch: 7 | loss: 0.0500487
	speed: 0.2757s/iter; left time: 9480.5232s
Epoch: 7 cost time: 104.51376295089722
Epoch: 7, Steps: 369 | Train Loss: 0.582 Vali Loss: 1.926 Vali Acc: 0.644 Test Loss: 1.926 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.1304066
	speed: 0.7958s/iter; left time: 27230.0366s
	iters: 200, epoch: 8 | loss: 0.8402268
	speed: 0.2912s/iter; left time: 9934.0991s
	iters: 300, epoch: 8 | loss: 1.7863046
	speed: 0.2784s/iter; left time: 9471.4234s
Epoch: 8 cost time: 101.8240716457367
Epoch: 8, Steps: 369 | Train Loss: 0.534 Vali Loss: 1.918 Vali Acc: 0.629 Test Loss: 1.918 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.1727623
	speed: 0.8079s/iter; left time: 27347.6876s
	iters: 200, epoch: 9 | loss: 0.2192664
	speed: 0.2557s/iter; left time: 8629.4155s
	iters: 300, epoch: 9 | loss: 1.2531224
	speed: 0.2746s/iter; left time: 9238.8066s
Epoch: 9 cost time: 98.79773187637329
Epoch: 9, Steps: 369 | Train Loss: 0.487 Vali Loss: 1.840 Vali Acc: 0.659 Test Loss: 1.840 Test Acc: 0.659
Validation loss decreased (-0.651524 --> -0.658608).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7607419
	speed: 0.7756s/iter; left time: 25966.5744s
	iters: 200, epoch: 10 | loss: 0.4354549
	speed: 0.2530s/iter; left time: 8444.6805s
	iters: 300, epoch: 10 | loss: 0.9915826
	speed: 0.2490s/iter; left time: 8287.9449s
Epoch: 10 cost time: 94.89863061904907
Epoch: 10, Steps: 369 | Train Loss: 0.419 Vali Loss: 2.147 Vali Acc: 0.636 Test Loss: 2.147 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2459937
	speed: 0.8381s/iter; left time: 27749.8482s
	iters: 200, epoch: 11 | loss: 0.1161298
	speed: 0.2559s/iter; left time: 8446.5265s
	iters: 300, epoch: 11 | loss: 0.1718915
	speed: 0.2619s/iter; left time: 8620.1765s
Epoch: 11 cost time: 97.02880811691284
Epoch: 11, Steps: 369 | Train Loss: 0.375 Vali Loss: 2.100 Vali Acc: 0.644 Test Loss: 2.100 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0114981
	speed: 0.7748s/iter; left time: 25369.3362s
	iters: 200, epoch: 12 | loss: 0.1667338
	speed: 0.2742s/iter; left time: 8949.4245s
	iters: 300, epoch: 12 | loss: 0.6643832
	speed: 0.2647s/iter; left time: 8615.4077s
Epoch: 12 cost time: 99.29015803337097
Epoch: 12, Steps: 369 | Train Loss: 0.356 Vali Loss: 2.247 Vali Acc: 0.648 Test Loss: 2.247 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.7188938
	speed: 0.8072s/iter; left time: 26131.6556s
	iters: 200, epoch: 13 | loss: 0.0877589
	speed: 0.2710s/iter; left time: 8745.9299s
	iters: 300, epoch: 13 | loss: 0.0037949
	speed: 0.2707s/iter; left time: 8709.1355s
Epoch: 13 cost time: 100.93358302116394
Epoch: 13, Steps: 369 | Train Loss: 0.261 Vali Loss: 2.268 Vali Acc: 0.662 Test Loss: 2.268 Test Acc: 0.662
Validation loss decreased (-0.658608 --> -0.661725).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1039864
	speed: 0.7450s/iter; left time: 23843.8974s
	iters: 200, epoch: 14 | loss: 0.0835743
	speed: 0.2847s/iter; left time: 9082.2278s
	iters: 300, epoch: 14 | loss: 0.0032326
	speed: 0.2718s/iter; left time: 8644.9906s
Epoch: 14 cost time: 100.82363891601562
Epoch: 14, Steps: 369 | Train Loss: 0.252 Vali Loss: 2.043 Vali Acc: 0.662 Test Loss: 2.043 Test Acc: 0.662
Validation loss decreased (-0.661725 --> -0.662295).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0670993
	speed: 0.8055s/iter; left time: 25483.4077s
	iters: 200, epoch: 15 | loss: 0.1968755
	speed: 0.2731s/iter; left time: 8612.1656s
	iters: 300, epoch: 15 | loss: 0.4145653
	speed: 0.2686s/iter; left time: 8442.2699s
Epoch: 15 cost time: 99.63219380378723
Epoch: 15, Steps: 369 | Train Loss: 0.195 Vali Loss: 2.296 Vali Acc: 0.645 Test Loss: 2.296 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0060629
	speed: 0.7510s/iter; left time: 23481.5013s
	iters: 200, epoch: 16 | loss: 0.0464474
	speed: 0.2543s/iter; left time: 7925.8908s
	iters: 300, epoch: 16 | loss: 0.0009625
	speed: 0.2742s/iter; left time: 8519.1771s
Epoch: 16 cost time: 96.48116397857666
Epoch: 16, Steps: 369 | Train Loss: 0.181 Vali Loss: 2.111 Vali Acc: 0.660 Test Loss: 2.111 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2519892
	speed: 0.8231s/iter; left time: 25430.3705s
	iters: 200, epoch: 17 | loss: 0.0194448
	speed: 0.2666s/iter; left time: 8209.7958s
	iters: 300, epoch: 17 | loss: 0.0336164
	speed: 0.2476s/iter; left time: 7601.0366s
Epoch: 17 cost time: 98.58953547477722
Epoch: 17, Steps: 369 | Train Loss: 0.136 Vali Loss: 2.357 Vali Acc: 0.657 Test Loss: 2.357 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0785020
	speed: 0.8190s/iter; left time: 25003.6525s
	iters: 200, epoch: 18 | loss: 0.1134973
	speed: 0.2725s/iter; left time: 8292.6458s
	iters: 300, epoch: 18 | loss: 0.1823599
	speed: 0.2863s/iter; left time: 8682.6197s
Epoch: 18 cost time: 101.56467938423157
Epoch: 18, Steps: 369 | Train Loss: 0.143 Vali Loss: 2.298 Vali Acc: 0.643 Test Loss: 2.298 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0352258
	speed: 0.7870s/iter; left time: 23733.9234s
	iters: 200, epoch: 19 | loss: 0.0374329
	speed: 0.2565s/iter; left time: 7711.5293s
	iters: 300, epoch: 19 | loss: 0.4081342
	speed: 0.2742s/iter; left time: 8214.7183s
Epoch: 19 cost time: 98.10587120056152
Epoch: 19, Steps: 369 | Train Loss: 0.118 Vali Loss: 2.425 Vali Acc: 0.657 Test Loss: 2.425 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0315983
	speed: 0.7854s/iter; left time: 23395.6498s
	iters: 200, epoch: 20 | loss: 0.1024640
	speed: 0.2433s/iter; left time: 7223.8938s
	iters: 300, epoch: 20 | loss: 0.0047568
	speed: 0.2376s/iter; left time: 7031.2521s
Epoch: 20 cost time: 91.15671801567078
Epoch: 20, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.972 Vali Acc: 0.637 Test Loss: 2.972 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1128600
	speed: 0.7111s/iter; left time: 20921.8175s
	iters: 200, epoch: 21 | loss: 0.2071382
	speed: 0.2650s/iter; left time: 7770.7539s
	iters: 300, epoch: 21 | loss: 0.2342789
	speed: 0.2539s/iter; left time: 7418.9945s
Epoch: 21 cost time: 94.39423394203186
Epoch: 21, Steps: 369 | Train Loss: 0.107 Vali Loss: 2.185 Vali Acc: 0.652 Test Loss: 2.185 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0836160
	speed: 0.7635s/iter; left time: 22181.4347s
	iters: 200, epoch: 22 | loss: 0.0017111
	speed: 0.2585s/iter; left time: 7483.6950s
	iters: 300, epoch: 22 | loss: 0.0002402
	speed: 0.2584s/iter; left time: 7455.0516s
Epoch: 22 cost time: 97.09949111938477
Epoch: 22, Steps: 369 | Train Loss: 0.080 Vali Loss: 2.328 Vali Acc: 0.650 Test Loss: 2.328 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0353528
	speed: 0.8077s/iter; left time: 23166.8518s
	iters: 200, epoch: 23 | loss: 0.0070067
	speed: 0.2595s/iter; left time: 7417.6340s
	iters: 300, epoch: 23 | loss: 0.0055478
	speed: 0.2720s/iter; left time: 7747.5928s
Epoch: 23 cost time: 99.7155339717865
Epoch: 23, Steps: 369 | Train Loss: 0.055 Vali Loss: 2.501 Vali Acc: 0.653 Test Loss: 2.501 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0230404
	speed: 0.8100s/iter; left time: 22934.8266s
	iters: 200, epoch: 24 | loss: 0.0104064
	speed: 0.2715s/iter; left time: 7659.1293s
	iters: 300, epoch: 24 | loss: 0.0660508
	speed: 0.2819s/iter; left time: 7924.9799s
Epoch: 24 cost time: 102.69129776954651
Epoch: 24, Steps: 369 | Train Loss: 0.064 Vali Loss: 2.381 Vali Acc: 0.655 Test Loss: 2.381 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6623155505107832
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8236319
	speed: 0.2528s/iter; left time: 9302.9710s
	iters: 200, epoch: 1 | loss: 0.6325887
	speed: 0.2288s/iter; left time: 8396.9576s
	iters: 300, epoch: 1 | loss: 0.5984855
	speed: 0.2289s/iter; left time: 8377.4279s
Epoch: 1 cost time: 87.4996829032898
Epoch: 1, Steps: 369 | Train Loss: 0.694 Vali Loss: 0.839 Vali Acc: 0.653 Test Loss: 0.839 Test Acc: 0.653
Validation loss decreased (inf --> -0.652659).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0056802
	speed: 0.7086s/iter; left time: 25814.7343s
	iters: 200, epoch: 2 | loss: 0.4184686
	speed: 0.2332s/iter; left time: 8473.8195s
	iters: 300, epoch: 2 | loss: 0.8060813
	speed: 0.2304s/iter; left time: 8346.8824s
Epoch: 2 cost time: 84.90871548652649
Epoch: 2, Steps: 369 | Train Loss: 0.630 Vali Loss: 1.393 Vali Acc: 0.615 Test Loss: 1.393 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7575517
	speed: 0.6879s/iter; left time: 24806.6469s
	iters: 200, epoch: 3 | loss: 0.6779729
	speed: 0.2051s/iter; left time: 7377.5879s
	iters: 300, epoch: 3 | loss: 0.4827867
	speed: 0.2184s/iter; left time: 7833.6871s
Epoch: 3 cost time: 80.24370455741882
Epoch: 3, Steps: 369 | Train Loss: 0.583 Vali Loss: 1.379 Vali Acc: 0.639 Test Loss: 1.379 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4485631
	speed: 0.7077s/iter; left time: 25259.9255s
	iters: 200, epoch: 4 | loss: 0.2249227
	speed: 0.2440s/iter; left time: 8686.2613s
	iters: 300, epoch: 4 | loss: 0.7598757
	speed: 0.2407s/iter; left time: 8542.9028s
Epoch: 4 cost time: 88.78091979026794
Epoch: 4, Steps: 369 | Train Loss: 0.603 Vali Loss: 1.547 Vali Acc: 0.640 Test Loss: 1.547 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0157343
	speed: 0.7231s/iter; left time: 25542.9191s
	iters: 200, epoch: 5 | loss: 0.4068862
	speed: 0.2306s/iter; left time: 8121.7012s
	iters: 300, epoch: 5 | loss: 0.5081500
	speed: 0.2347s/iter; left time: 8242.5283s
Epoch: 5 cost time: 87.2276976108551
Epoch: 5, Steps: 369 | Train Loss: 0.606 Vali Loss: 1.532 Vali Acc: 0.626 Test Loss: 1.532 Test Acc: 0.626
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5748792
	speed: 0.7375s/iter; left time: 25778.3343s
	iters: 200, epoch: 6 | loss: 0.6388850
	speed: 0.2321s/iter; left time: 8088.8012s
	iters: 300, epoch: 6 | loss: 0.7772269
	speed: 0.2262s/iter; left time: 7861.6539s
Epoch: 6 cost time: 86.04241490364075
Epoch: 6, Steps: 369 | Train Loss: 0.585 Vali Loss: 1.815 Vali Acc: 0.621 Test Loss: 1.815 Test Acc: 0.621
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0555226
	speed: 0.7428s/iter; left time: 25692.2441s
	iters: 200, epoch: 7 | loss: 0.5152517
	speed: 0.2450s/iter; left time: 8448.2137s
	iters: 300, epoch: 7 | loss: 0.8959790
	speed: 0.2324s/iter; left time: 7992.2298s
Epoch: 7 cost time: 88.91681432723999
Epoch: 7, Steps: 369 | Train Loss: 0.617 Vali Loss: 1.833 Vali Acc: 0.642 Test Loss: 1.833 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3485101
	speed: 0.6933s/iter; left time: 23724.2722s
	iters: 200, epoch: 8 | loss: 0.4583105
	speed: 0.2316s/iter; left time: 7902.8144s
	iters: 300, epoch: 8 | loss: 0.4732727
	speed: 0.2322s/iter; left time: 7897.9179s
Epoch: 8 cost time: 85.03107237815857
Epoch: 8, Steps: 369 | Train Loss: 0.544 Vali Loss: 1.866 Vali Acc: 0.623 Test Loss: 1.866 Test Acc: 0.623
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.0764512
	speed: 0.7005s/iter; left time: 23709.5885s
	iters: 200, epoch: 9 | loss: 0.1377706
	speed: 0.2365s/iter; left time: 7981.7764s
	iters: 300, epoch: 9 | loss: 0.5252351
	speed: 0.2232s/iter; left time: 7511.2825s
Epoch: 9 cost time: 85.49446129798889
Epoch: 9, Steps: 369 | Train Loss: 0.510 Vali Loss: 1.812 Vali Acc: 0.634 Test Loss: 1.812 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.4972504
	speed: 0.7224s/iter; left time: 24185.5880s
	iters: 200, epoch: 10 | loss: 0.0582394
	speed: 0.2497s/iter; left time: 8335.6983s
	iters: 300, epoch: 10 | loss: 0.0557330
	speed: 0.2423s/iter; left time: 8063.1271s
Epoch: 10 cost time: 89.59855628013611
Epoch: 10, Steps: 369 | Train Loss: 0.421 Vali Loss: 1.985 Vali Acc: 0.633 Test Loss: 1.985 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0075209
	speed: 0.7216s/iter; left time: 23891.4226s
	iters: 200, epoch: 11 | loss: 0.1360770
	speed: 0.2240s/iter; left time: 7394.8701s
	iters: 300, epoch: 11 | loss: 0.6534264
	speed: 0.2267s/iter; left time: 7459.8145s
Epoch: 11 cost time: 85.07841110229492
Epoch: 11, Steps: 369 | Train Loss: 0.365 Vali Loss: 2.109 Vali Acc: 0.641 Test Loss: 2.109 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6526674233825198
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7326245
	speed: 0.2675s/iter; left time: 9844.2907s
	iters: 200, epoch: 1 | loss: 0.7040131
	speed: 0.2501s/iter; left time: 9178.2702s
	iters: 300, epoch: 1 | loss: 0.8023449
	speed: 0.2430s/iter; left time: 8895.7514s
Epoch: 1 cost time: 93.56406497955322
Epoch: 1, Steps: 369 | Train Loss: 0.712 Vali Loss: 0.818 Vali Acc: 0.661 Test Loss: 0.818 Test Acc: 0.661
Validation loss decreased (inf --> -0.661172).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6320111
	speed: 0.7823s/iter; left time: 28501.3187s
	iters: 200, epoch: 2 | loss: 0.4189041
	speed: 0.2589s/iter; left time: 9405.6911s
	iters: 300, epoch: 2 | loss: 1.3438642
	speed: 0.2667s/iter; left time: 9662.3190s
Epoch: 2 cost time: 98.50944638252258
Epoch: 2, Steps: 369 | Train Loss: 0.645 Vali Loss: 1.050 Vali Acc: 0.640 Test Loss: 1.050 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7183152
	speed: 0.7684s/iter; left time: 27712.6115s
	iters: 200, epoch: 3 | loss: 0.9753814
	speed: 0.2389s/iter; left time: 8591.2558s
	iters: 300, epoch: 3 | loss: 0.4536085
	speed: 0.2258s/iter; left time: 8098.4723s
Epoch: 3 cost time: 87.63539433479309
Epoch: 3, Steps: 369 | Train Loss: 0.583 Vali Loss: 1.390 Vali Acc: 0.622 Test Loss: 1.390 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5365070
	speed: 0.7361s/iter; left time: 26272.7510s
	iters: 200, epoch: 4 | loss: 0.0932729
	speed: 0.2599s/iter; left time: 9249.1132s
	iters: 300, epoch: 4 | loss: 0.9752545
	speed: 0.2624s/iter; left time: 9312.8144s
Epoch: 4 cost time: 95.17231440544128
Epoch: 4, Steps: 369 | Train Loss: 0.647 Vali Loss: 1.372 Vali Acc: 0.661 Test Loss: 1.372 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2035139
	speed: 0.7558s/iter; left time: 26697.6584s
	iters: 200, epoch: 5 | loss: 0.8124896
	speed: 0.2436s/iter; left time: 8581.8675s
	iters: 300, epoch: 5 | loss: 0.2103781
	speed: 0.2493s/iter; left time: 8756.4548s
Epoch: 5 cost time: 92.61440110206604
Epoch: 5, Steps: 369 | Train Loss: 0.651 Vali Loss: 1.457 Vali Acc: 0.642 Test Loss: 1.457 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6973580
	speed: 0.7929s/iter; left time: 27716.5108s
	iters: 200, epoch: 6 | loss: 1.3239782
	speed: 0.2562s/iter; left time: 8931.0425s
	iters: 300, epoch: 6 | loss: 1.2577026
	speed: 0.2430s/iter; left time: 8445.8669s
Epoch: 6 cost time: 93.77011585235596
Epoch: 6, Steps: 369 | Train Loss: 0.566 Vali Loss: 1.940 Vali Acc: 0.649 Test Loss: 1.940 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.4126226
	speed: 0.7435s/iter; left time: 25714.0561s
	iters: 200, epoch: 7 | loss: 0.5824027
	speed: 0.2477s/iter; left time: 8542.3506s
	iters: 300, epoch: 7 | loss: 0.4981004
	speed: 0.2482s/iter; left time: 8534.1229s
Epoch: 7 cost time: 92.55144095420837
Epoch: 7, Steps: 369 | Train Loss: 0.578 Vali Loss: 2.304 Vali Acc: 0.616 Test Loss: 2.304 Test Acc: 0.616
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.2723898
	speed: 0.7928s/iter; left time: 27127.6879s
	iters: 200, epoch: 8 | loss: 0.6884135
	speed: 0.2578s/iter; left time: 8794.2615s
	iters: 300, epoch: 8 | loss: 0.8856955
	speed: 0.2362s/iter; left time: 8033.8060s
Epoch: 8 cost time: 91.74743580818176
Epoch: 8, Steps: 369 | Train Loss: 0.585 Vali Loss: 1.969 Vali Acc: 0.619 Test Loss: 1.969 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.5558431
	speed: 0.7146s/iter; left time: 24188.1887s
	iters: 200, epoch: 9 | loss: 0.1969578
	speed: 0.2481s/iter; left time: 8371.6094s
	iters: 300, epoch: 9 | loss: 0.6311005
	speed: 0.2602s/iter; left time: 8754.3579s
Epoch: 9 cost time: 93.16542267799377
Epoch: 9, Steps: 369 | Train Loss: 0.522 Vali Loss: 2.029 Vali Acc: 0.638 Test Loss: 2.029 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0401790
	speed: 0.7786s/iter; left time: 26065.9293s
	iters: 200, epoch: 10 | loss: 0.3244832
	speed: 0.2300s/iter; left time: 7675.8058s
	iters: 300, epoch: 10 | loss: 0.4995342
	speed: 0.2483s/iter; left time: 8261.8445s
Epoch: 10 cost time: 89.92352175712585
Epoch: 10, Steps: 369 | Train Loss: 0.422 Vali Loss: 2.112 Vali Acc: 0.633 Test Loss: 2.112 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0114060
	speed: 0.7669s/iter; left time: 25392.0110s
	iters: 200, epoch: 11 | loss: 0.4681110
	speed: 0.2776s/iter; left time: 9163.3109s
	iters: 300, epoch: 11 | loss: 0.1452390
	speed: 0.2652s/iter; left time: 8728.5620s
Epoch: 11 cost time: 100.46771502494812
Epoch: 11, Steps: 369 | Train Loss: 0.400 Vali Loss: 2.068 Vali Acc: 0.643 Test Loss: 2.068 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6611804767309876
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8180419
	speed: 0.2609s/iter; left time: 9602.8618s
	iters: 200, epoch: 1 | loss: 0.7283969
	speed: 0.2509s/iter; left time: 9208.1134s
	iters: 300, epoch: 1 | loss: 0.7778443
	speed: 0.2865s/iter; left time: 10487.5139s
Epoch: 1 cost time: 98.85566663742065
Epoch: 1, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.887 Vali Acc: 0.640 Test Loss: 0.887 Test Acc: 0.640
Validation loss decreased (inf --> -0.639889).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8243676
	speed: 0.8131s/iter; left time: 29622.7990s
	iters: 200, epoch: 2 | loss: 0.2186912
	speed: 0.2447s/iter; left time: 8891.4283s
	iters: 300, epoch: 2 | loss: 1.2298281
	speed: 0.2382s/iter; left time: 8629.1982s
Epoch: 2 cost time: 91.73815560340881
Epoch: 2, Steps: 369 | Train Loss: 0.632 Vali Loss: 1.157 Vali Acc: 0.634 Test Loss: 1.157 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5673862
	speed: 0.7526s/iter; left time: 27139.5122s
	iters: 200, epoch: 3 | loss: 0.1591707
	speed: 0.2618s/iter; left time: 9416.1229s
	iters: 300, epoch: 3 | loss: 0.4778890
	speed: 0.2589s/iter; left time: 9284.2730s
Epoch: 3 cost time: 97.77846336364746
Epoch: 3, Steps: 369 | Train Loss: 0.577 Vali Loss: 1.451 Vali Acc: 0.640 Test Loss: 1.451 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6411237
	speed: 0.7508s/iter; left time: 26799.3056s
	iters: 200, epoch: 4 | loss: 0.3995383
	speed: 0.2648s/iter; left time: 9423.9609s
	iters: 300, epoch: 4 | loss: 1.1199596
	speed: 0.2646s/iter; left time: 9391.7841s
Epoch: 4 cost time: 95.26225304603577
Epoch: 4, Steps: 369 | Train Loss: 0.587 Vali Loss: 1.363 Vali Acc: 0.646 Test Loss: 1.363 Test Acc: 0.646
Validation loss decreased (-0.639889 --> -0.646127).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2840357
	speed: 0.7907s/iter; left time: 27929.8928s
	iters: 200, epoch: 5 | loss: 0.2360320
	speed: 0.2597s/iter; left time: 9148.6491s
	iters: 300, epoch: 5 | loss: 0.5874126
	speed: 0.2677s/iter; left time: 9404.3174s
Epoch: 5 cost time: 99.3073799610138
Epoch: 5, Steps: 369 | Train Loss: 0.629 Vali Loss: 1.825 Vali Acc: 0.611 Test Loss: 1.825 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8401694
	speed: 0.7947s/iter; left time: 27778.1821s
	iters: 200, epoch: 6 | loss: 0.6079613
	speed: 0.2419s/iter; left time: 8432.4232s
	iters: 300, epoch: 6 | loss: 0.4726807
	speed: 0.2511s/iter; left time: 8727.9844s
Epoch: 6 cost time: 93.5401086807251
Epoch: 6, Steps: 369 | Train Loss: 0.610 Vali Loss: 1.596 Vali Acc: 0.657 Test Loss: 1.596 Test Acc: 0.657
Validation loss decreased (-0.646127 --> -0.656624).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3953736
	speed: 0.7599s/iter; left time: 26282.7735s
	iters: 200, epoch: 7 | loss: 0.5796233
	speed: 0.2613s/iter; left time: 9011.3176s
	iters: 300, epoch: 7 | loss: 0.2804519
	speed: 0.2659s/iter; left time: 9143.8084s
Epoch: 7 cost time: 96.45487785339355
Epoch: 7, Steps: 369 | Train Loss: 0.608 Vali Loss: 1.974 Vali Acc: 0.652 Test Loss: 1.974 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4850160
	speed: 0.7691s/iter; left time: 26316.0072s
	iters: 200, epoch: 8 | loss: 1.0526228
	speed: 0.2533s/iter; left time: 8642.7888s
	iters: 300, epoch: 8 | loss: 0.2548702
	speed: 0.2535s/iter; left time: 8623.8667s
Epoch: 8 cost time: 95.48926067352295
Epoch: 8, Steps: 369 | Train Loss: 0.582 Vali Loss: 2.388 Vali Acc: 0.605 Test Loss: 2.388 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2104226
	speed: 0.7760s/iter; left time: 26268.3977s
	iters: 200, epoch: 9 | loss: 0.1128439
	speed: 0.2634s/iter; left time: 8888.3688s
	iters: 300, epoch: 9 | loss: 0.2776892
	speed: 0.2612s/iter; left time: 8788.1985s
Epoch: 9 cost time: 97.14135456085205
Epoch: 9, Steps: 369 | Train Loss: 0.548 Vali Loss: 1.767 Vali Acc: 0.635 Test Loss: 1.767 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2680755
	speed: 0.7530s/iter; left time: 25211.9875s
	iters: 200, epoch: 10 | loss: 0.3807219
	speed: 0.2708s/iter; left time: 9039.4336s
	iters: 300, epoch: 10 | loss: 0.9654258
	speed: 0.2713s/iter; left time: 9029.7239s
Epoch: 10 cost time: 97.99061632156372
Epoch: 10, Steps: 369 | Train Loss: 0.516 Vali Loss: 2.276 Vali Acc: 0.642 Test Loss: 2.276 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2500482
	speed: 0.8120s/iter; left time: 26887.7690s
	iters: 200, epoch: 11 | loss: 0.3757254
	speed: 0.2704s/iter; left time: 8925.2241s
	iters: 300, epoch: 11 | loss: 0.0259851
	speed: 0.2759s/iter; left time: 9078.6417s
Epoch: 11 cost time: 101.40855598449707
Epoch: 11, Steps: 369 | Train Loss: 0.466 Vali Loss: 1.938 Vali Acc: 0.656 Test Loss: 1.938 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2576905
	speed: 0.8376s/iter; left time: 27425.8420s
	iters: 200, epoch: 12 | loss: 0.1421193
	speed: 0.2468s/iter; left time: 8056.7435s
	iters: 300, epoch: 12 | loss: 0.8362293
	speed: 0.2429s/iter; left time: 7903.9666s
Epoch: 12 cost time: 96.10626196861267
Epoch: 12, Steps: 369 | Train Loss: 0.429 Vali Loss: 2.164 Vali Acc: 0.650 Test Loss: 2.164 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4966468
	speed: 0.7857s/iter; left time: 25435.7443s
	iters: 200, epoch: 13 | loss: 0.1888368
	speed: 0.2744s/iter; left time: 8856.8965s
	iters: 300, epoch: 13 | loss: 0.2458988
	speed: 0.2658s/iter; left time: 8552.4469s
Epoch: 13 cost time: 99.97063088417053
Epoch: 13, Steps: 369 | Train Loss: 0.401 Vali Loss: 1.741 Vali Acc: 0.660 Test Loss: 1.741 Test Acc: 0.660
Validation loss decreased (-0.656624 --> -0.660312).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4123169
	speed: 0.7452s/iter; left time: 23847.9287s
	iters: 200, epoch: 14 | loss: 0.3803839
	speed: 0.2514s/iter; left time: 8019.0976s
	iters: 300, epoch: 14 | loss: 0.2982854
	speed: 0.2578s/iter; left time: 8198.1415s
Epoch: 14 cost time: 96.35477375984192
Epoch: 14, Steps: 369 | Train Loss: 0.307 Vali Loss: 1.753 Vali Acc: 0.646 Test Loss: 1.753 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5787869
	speed: 0.8147s/iter; left time: 25773.7626s
	iters: 200, epoch: 15 | loss: 0.2027772
	speed: 0.2392s/iter; left time: 7543.8546s
	iters: 300, epoch: 15 | loss: 0.6216899
	speed: 0.2370s/iter; left time: 7449.4155s
Epoch: 15 cost time: 90.3457190990448
Epoch: 15, Steps: 369 | Train Loss: 0.262 Vali Loss: 1.914 Vali Acc: 0.648 Test Loss: 1.914 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0485183
	speed: 0.7386s/iter; left time: 23092.3977s
	iters: 200, epoch: 16 | loss: 0.0931927
	speed: 0.2730s/iter; left time: 8507.3331s
	iters: 300, epoch: 16 | loss: 0.3617437
	speed: 0.2819s/iter; left time: 8756.7236s
Epoch: 16 cost time: 101.186763048172
Epoch: 16, Steps: 369 | Train Loss: 0.229 Vali Loss: 2.138 Vali Acc: 0.639 Test Loss: 2.138 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1706715
	speed: 0.7837s/iter; left time: 24215.4507s
	iters: 200, epoch: 17 | loss: 0.4378654
	speed: 0.2570s/iter; left time: 7915.4379s
	iters: 300, epoch: 17 | loss: 0.0112493
	speed: 0.2656s/iter; left time: 8153.6672s
Epoch: 17 cost time: 96.0838532447815
Epoch: 17, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.849 Vali Acc: 0.666 Test Loss: 1.849 Test Acc: 0.666
Validation loss decreased (-0.660312 --> -0.665986).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4680618
	speed: 0.8222s/iter; left time: 25099.2681s
	iters: 200, epoch: 18 | loss: 0.1937579
	speed: 0.2400s/iter; left time: 7301.4187s
	iters: 300, epoch: 18 | loss: 0.0151198
	speed: 0.2529s/iter; left time: 7671.3523s
Epoch: 18 cost time: 93.27693819999695
Epoch: 18, Steps: 369 | Train Loss: 0.165 Vali Loss: 2.297 Vali Acc: 0.635 Test Loss: 2.297 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0160825
	speed: 0.7460s/iter; left time: 22498.8785s
	iters: 200, epoch: 19 | loss: 0.2676150
	speed: 0.2393s/iter; left time: 7193.0142s
	iters: 300, epoch: 19 | loss: 0.1322880
	speed: 0.2556s/iter; left time: 7658.5947s
Epoch: 19 cost time: 94.96456837654114
Epoch: 19, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.895 Vali Acc: 0.665 Test Loss: 1.895 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1667280
	speed: 0.7734s/iter; left time: 23038.6760s
	iters: 200, epoch: 20 | loss: 0.0105608
	speed: 0.2549s/iter; left time: 7568.7986s
	iters: 300, epoch: 20 | loss: 0.0473330
	speed: 0.2805s/iter; left time: 8299.5498s
Epoch: 20 cost time: 97.45371294021606
Epoch: 20, Steps: 369 | Train Loss: 0.122 Vali Loss: 2.401 Vali Acc: 0.669 Test Loss: 2.401 Test Acc: 0.669
Validation loss decreased (-0.665986 --> -0.668534).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0145871
	speed: 0.8094s/iter; left time: 23813.2639s
	iters: 200, epoch: 21 | loss: 0.0093487
	speed: 0.2503s/iter; left time: 7337.5889s
	iters: 300, epoch: 21 | loss: 0.0760463
	speed: 0.2604s/iter; left time: 7608.4645s
Epoch: 21 cost time: 96.73440337181091
Epoch: 21, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.260 Vali Acc: 0.643 Test Loss: 2.260 Test Acc: 0.643
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0091430
	speed: 0.8217s/iter; left time: 23871.0730s
	iters: 200, epoch: 22 | loss: 0.2434257
	speed: 0.2695s/iter; left time: 7803.6901s
	iters: 300, epoch: 22 | loss: 0.2051899
	speed: 0.2438s/iter; left time: 7034.6883s
Epoch: 22 cost time: 97.3498055934906
Epoch: 22, Steps: 369 | Train Loss: 0.119 Vali Loss: 2.220 Vali Acc: 0.668 Test Loss: 2.220 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0164998
	speed: 0.7177s/iter; left time: 20587.0940s
	iters: 200, epoch: 23 | loss: 0.1742164
	speed: 0.2350s/iter; left time: 6717.5070s
	iters: 300, epoch: 23 | loss: 0.0377333
	speed: 0.2575s/iter; left time: 7335.2329s
Epoch: 23 cost time: 90.86297845840454
Epoch: 23, Steps: 369 | Train Loss: 0.103 Vali Loss: 2.187 Vali Acc: 0.651 Test Loss: 2.187 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0004181
	speed: 0.8069s/iter; left time: 22846.7238s
	iters: 200, epoch: 24 | loss: 0.0011244
	speed: 0.2244s/iter; left time: 6330.4341s
	iters: 300, epoch: 24 | loss: 0.0302576
	speed: 0.2428s/iter; left time: 6825.2203s
Epoch: 24 cost time: 87.49195051193237
Epoch: 24, Steps: 369 | Train Loss: 0.096 Vali Loss: 2.268 Vali Acc: 0.655 Test Loss: 2.268 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0361269
	speed: 0.7307s/iter; left time: 20420.7225s
	iters: 200, epoch: 25 | loss: 0.1536787
	speed: 0.2626s/iter; left time: 7312.4850s
	iters: 300, epoch: 25 | loss: 0.0013887
	speed: 0.2841s/iter; left time: 7882.5517s
Epoch: 25 cost time: 100.5473952293396
Epoch: 25, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.419 Vali Acc: 0.655 Test Loss: 2.419 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.3107671
	speed: 0.7875s/iter; left time: 21715.4761s
	iters: 200, epoch: 26 | loss: 0.0173804
	speed: 0.2649s/iter; left time: 7277.1045s
	iters: 300, epoch: 26 | loss: 0.0080131
	speed: 0.2547s/iter; left time: 6972.3773s
Epoch: 26 cost time: 96.05999827384949
Epoch: 26, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.467 Vali Acc: 0.657 Test Loss: 2.467 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1848527
	speed: 0.7696s/iter; left time: 20937.4200s
	iters: 200, epoch: 27 | loss: 0.0973655
	speed: 0.2740s/iter; left time: 7427.4139s
	iters: 300, epoch: 27 | loss: 0.2537007
	speed: 0.2527s/iter; left time: 6826.0008s
Epoch: 27 cost time: 95.8112804889679
Epoch: 27, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.090 Vali Acc: 0.656 Test Loss: 2.090 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0177000
	speed: 0.7746s/iter; left time: 20788.1863s
	iters: 200, epoch: 28 | loss: 0.0104197
	speed: 0.2637s/iter; left time: 7051.9186s
	iters: 300, epoch: 28 | loss: 0.0064025
	speed: 0.2449s/iter; left time: 6522.4086s
Epoch: 28 cost time: 93.91370820999146
Epoch: 28, Steps: 369 | Train Loss: 0.056 Vali Loss: 2.147 Vali Acc: 0.655 Test Loss: 2.147 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0002254
	speed: 0.7611s/iter; left time: 20144.8489s
	iters: 200, epoch: 29 | loss: 0.5655092
	speed: 0.2760s/iter; left time: 7277.8191s
	iters: 300, epoch: 29 | loss: 0.0001576
	speed: 0.2723s/iter; left time: 7152.5244s
Epoch: 29 cost time: 101.43078875541687
Epoch: 29, Steps: 369 | Train Loss: 0.026 Vali Loss: 3.134 Vali Acc: 0.653 Test Loss: 3.134 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0033819
	speed: 0.8063s/iter; left time: 21045.0122s
	iters: 200, epoch: 30 | loss: 0.5437671
	speed: 0.2466s/iter; left time: 6412.8585s
	iters: 300, epoch: 30 | loss: 0.0053599
	speed: 0.2706s/iter; left time: 7007.9589s
Epoch: 30 cost time: 95.32781600952148
Epoch: 30, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.025 Vali Acc: 0.657 Test Loss: 2.025 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6685584562996595
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7792708
	speed: 0.2849s/iter; left time: 10484.9951s
	iters: 200, epoch: 1 | loss: 0.7189757
	speed: 0.2598s/iter; left time: 9535.2101s
	iters: 300, epoch: 1 | loss: 0.6876372
	speed: 0.2284s/iter; left time: 8359.4073s
Epoch: 1 cost time: 93.71223545074463
Epoch: 1, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.896 Vali Acc: 0.656 Test Loss: 0.896 Test Acc: 0.656
Validation loss decreased (inf --> -0.656347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7189007
	speed: 0.7714s/iter; left time: 28103.7393s
	iters: 200, epoch: 2 | loss: 0.4187668
	speed: 0.2869s/iter; left time: 10422.3724s
	iters: 300, epoch: 2 | loss: 1.3733084
	speed: 0.2654s/iter; left time: 9616.0810s
Epoch: 2 cost time: 100.2988109588623
Epoch: 2, Steps: 369 | Train Loss: 0.657 Vali Loss: 1.155 Vali Acc: 0.636 Test Loss: 1.155 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0541636
	speed: 0.7890s/iter; left time: 28452.2062s
	iters: 200, epoch: 3 | loss: 0.5830824
	speed: 0.2713s/iter; left time: 9756.7518s
	iters: 300, epoch: 3 | loss: 0.7423658
	speed: 0.2692s/iter; left time: 9655.3236s
Epoch: 3 cost time: 98.96876525878906
Epoch: 3, Steps: 369 | Train Loss: 0.600 Vali Loss: 1.373 Vali Acc: 0.614 Test Loss: 1.373 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6466892
	speed: 0.7461s/iter; left time: 26629.9066s
	iters: 200, epoch: 4 | loss: 0.4765425
	speed: 0.2591s/iter; left time: 9224.1275s
	iters: 300, epoch: 4 | loss: 0.6249312
	speed: 0.2616s/iter; left time: 9284.1224s
Epoch: 4 cost time: 93.32322192192078
Epoch: 4, Steps: 369 | Train Loss: 0.611 Vali Loss: 1.507 Vali Acc: 0.630 Test Loss: 1.507 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3201756
	speed: 0.7446s/iter; left time: 26303.2859s
	iters: 200, epoch: 5 | loss: 1.0338796
	speed: 0.2548s/iter; left time: 8976.1813s
	iters: 300, epoch: 5 | loss: 1.9747320
	speed: 0.2482s/iter; left time: 8719.0246s
Epoch: 5 cost time: 93.8564555644989
Epoch: 5, Steps: 369 | Train Loss: 0.609 Vali Loss: 2.048 Vali Acc: 0.600 Test Loss: 2.048 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9170835
	speed: 0.7351s/iter; left time: 25695.0242s
	iters: 200, epoch: 6 | loss: 0.7325794
	speed: 0.2395s/iter; left time: 8347.1790s
	iters: 300, epoch: 6 | loss: 0.2434337
	speed: 0.2544s/iter; left time: 8840.8837s
Epoch: 6 cost time: 90.58164072036743
Epoch: 6, Steps: 369 | Train Loss: 0.596 Vali Loss: 1.573 Vali Acc: 0.639 Test Loss: 1.573 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7538475
	speed: 0.7734s/iter; left time: 26751.2433s
	iters: 200, epoch: 7 | loss: 0.4433011
	speed: 0.2509s/iter; left time: 8651.3957s
	iters: 300, epoch: 7 | loss: 0.8063762
	speed: 0.2683s/iter; left time: 9224.8075s
Epoch: 7 cost time: 96.22460699081421
Epoch: 7, Steps: 369 | Train Loss: 0.576 Vali Loss: 1.605 Vali Acc: 0.642 Test Loss: 1.605 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3906529
	speed: 0.7441s/iter; left time: 25463.0719s
	iters: 200, epoch: 8 | loss: 0.9838108
	speed: 0.2538s/iter; left time: 8658.0561s
	iters: 300, epoch: 8 | loss: 0.2781923
	speed: 0.2535s/iter; left time: 8622.9149s
Epoch: 8 cost time: 91.62165927886963
Epoch: 8, Steps: 369 | Train Loss: 0.498 Vali Loss: 1.332 Vali Acc: 0.619 Test Loss: 1.332 Test Acc: 0.619
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.2546836
	speed: 0.7634s/iter; left time: 25841.5175s
	iters: 200, epoch: 9 | loss: 0.2859057
	speed: 0.2533s/iter; left time: 8550.0449s
	iters: 300, epoch: 9 | loss: 0.8776205
	speed: 0.2486s/iter; left time: 8366.8189s
Epoch: 9 cost time: 94.9122793674469
Epoch: 9, Steps: 369 | Train Loss: 0.464 Vali Loss: 1.157 Vali Acc: 0.634 Test Loss: 1.157 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7462607
	speed: 0.7478s/iter; left time: 25035.7341s
	iters: 200, epoch: 10 | loss: 0.5333917
	speed: 0.2467s/iter; left time: 8233.5756s
	iters: 300, epoch: 10 | loss: 0.7630475
	speed: 0.2458s/iter; left time: 8180.8817s
Epoch: 10 cost time: 91.77598166465759
Epoch: 10, Steps: 369 | Train Loss: 0.469 Vali Loss: 0.946 Vali Acc: 0.638 Test Loss: 0.946 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.2543457
	speed: 0.7784s/iter; left time: 25774.9896s
	iters: 200, epoch: 11 | loss: 0.6193127
	speed: 0.2563s/iter; left time: 8459.9408s
	iters: 300, epoch: 11 | loss: 0.2198323
	speed: 0.2717s/iter; left time: 8941.5150s
Epoch: 11 cost time: 97.84609365463257
Epoch: 11, Steps: 369 | Train Loss: 0.451 Vali Loss: 0.896 Vali Acc: 0.647 Test Loss: 0.896 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6563564131668559
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6903696
	speed: 0.2848s/iter; left time: 10480.2418s
	iters: 200, epoch: 1 | loss: 0.6824287
	speed: 0.2463s/iter; left time: 9040.1074s
	iters: 300, epoch: 1 | loss: 0.8994137
	speed: 0.2482s/iter; left time: 9084.4272s
Epoch: 1 cost time: 95.82862901687622
Epoch: 1, Steps: 369 | Train Loss: 0.729 Vali Loss: 0.851 Vali Acc: 0.667 Test Loss: 0.851 Test Acc: 0.667
Validation loss decreased (inf --> -0.666847).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7853279
	speed: 0.7236s/iter; left time: 26363.4132s
	iters: 200, epoch: 2 | loss: 0.4093727
	speed: 0.2301s/iter; left time: 8359.9600s
	iters: 300, epoch: 2 | loss: 1.2937870
	speed: 0.2353s/iter; left time: 8526.7303s
Epoch: 2 cost time: 86.36432647705078
Epoch: 2, Steps: 369 | Train Loss: 0.656 Vali Loss: 1.064 Vali Acc: 0.633 Test Loss: 1.064 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4223663
	speed: 0.7170s/iter; left time: 25855.7807s
	iters: 200, epoch: 3 | loss: 0.5650867
	speed: 0.2444s/iter; left time: 8790.5184s
	iters: 300, epoch: 3 | loss: 0.8196846
	speed: 0.2594s/iter; left time: 9302.9371s
Epoch: 3 cost time: 95.77063512802124
Epoch: 3, Steps: 369 | Train Loss: 0.614 Vali Loss: 1.360 Vali Acc: 0.632 Test Loss: 1.360 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9579269
	speed: 0.7813s/iter; left time: 27887.5750s
	iters: 200, epoch: 4 | loss: 0.5176219
	speed: 0.2793s/iter; left time: 9941.0694s
	iters: 300, epoch: 4 | loss: 0.8789731
	speed: 0.2566s/iter; left time: 9109.2192s
Epoch: 4 cost time: 98.868976354599
Epoch: 4, Steps: 369 | Train Loss: 0.598 Vali Loss: 1.259 Vali Acc: 0.647 Test Loss: 1.259 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3849156
	speed: 0.7428s/iter; left time: 26237.9336s
	iters: 200, epoch: 5 | loss: 0.2932954
	speed: 0.2569s/iter; left time: 9048.2738s
	iters: 300, epoch: 5 | loss: 0.8404823
	speed: 0.2552s/iter; left time: 8965.3972s
Epoch: 5 cost time: 94.30224084854126
Epoch: 5, Steps: 369 | Train Loss: 0.527 Vali Loss: 1.146 Vali Acc: 0.650 Test Loss: 1.146 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6286742
	speed: 0.7188s/iter; left time: 25126.4508s
	iters: 200, epoch: 6 | loss: 0.8952845
	speed: 0.2478s/iter; left time: 8638.4582s
	iters: 300, epoch: 6 | loss: 0.3726513
	speed: 0.2470s/iter; left time: 8585.1352s
Epoch: 6 cost time: 89.02710461616516
Epoch: 6, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.946 Vali Acc: 0.648 Test Loss: 0.946 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7959325
	speed: 0.6858s/iter; left time: 23719.5780s
	iters: 200, epoch: 7 | loss: 0.6006515
	speed: 0.2452s/iter; left time: 8454.7417s
	iters: 300, epoch: 7 | loss: 0.5520741
	speed: 0.2451s/iter; left time: 8426.8590s
Epoch: 7 cost time: 91.1913583278656
Epoch: 7, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.896 Vali Acc: 0.629 Test Loss: 0.896 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.5864000
	speed: 0.7429s/iter; left time: 25420.3108s
	iters: 200, epoch: 8 | loss: 0.6855059
	speed: 0.2441s/iter; left time: 8327.0361s
	iters: 300, epoch: 8 | loss: 0.7190170
	speed: 0.2599s/iter; left time: 8841.9302s
Epoch: 8 cost time: 89.9873104095459
Epoch: 8, Steps: 369 | Train Loss: 0.621 Vali Loss: 0.750 Vali Acc: 0.649 Test Loss: 0.750 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.3750138
	speed: 0.7298s/iter; left time: 24701.4450s
	iters: 200, epoch: 9 | loss: 0.4731198
	speed: 0.2459s/iter; left time: 8298.7270s
	iters: 300, epoch: 9 | loss: 0.6951315
	speed: 0.2479s/iter; left time: 8340.2792s
Epoch: 9 cost time: 91.9246518611908
Epoch: 9, Steps: 369 | Train Loss: 0.613 Vali Loss: 0.665 Vali Acc: 0.659 Test Loss: 0.665 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.8813363
	speed: 0.7220s/iter; left time: 24172.8922s
	iters: 200, epoch: 10 | loss: 0.4968313
	speed: 0.2371s/iter; left time: 7914.7009s
	iters: 300, epoch: 10 | loss: 0.2993850
	speed: 0.2356s/iter; left time: 7841.0040s
Epoch: 10 cost time: 90.24046206474304
Epoch: 10, Steps: 369 | Train Loss: 0.568 Vali Loss: 0.715 Vali Acc: 0.663 Test Loss: 0.715 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6530495
	speed: 0.7554s/iter; left time: 25011.1090s
	iters: 200, epoch: 11 | loss: 0.5138838
	speed: 0.2680s/iter; left time: 8845.3601s
	iters: 300, epoch: 11 | loss: 0.4664797
	speed: 0.2483s/iter; left time: 8171.8305s
Epoch: 11 cost time: 94.55508852005005
Epoch: 11, Steps: 369 | Train Loss: 0.542 Vali Loss: 0.686 Vali Acc: 0.680 Test Loss: 0.686 Test Acc: 0.680
Validation loss decreased (-0.666847 --> -0.680470).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7250801
	speed: 0.7164s/iter; left time: 23455.0542s
	iters: 200, epoch: 12 | loss: 0.4727951
	speed: 0.2448s/iter; left time: 7992.1721s
	iters: 300, epoch: 12 | loss: 0.3472631
	speed: 0.2589s/iter; left time: 8424.4218s
Epoch: 12 cost time: 92.83154201507568
Epoch: 12, Steps: 369 | Train Loss: 0.516 Vali Loss: 0.662 Vali Acc: 0.680 Test Loss: 0.662 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3103197
	speed: 0.7273s/iter; left time: 23543.5696s
	iters: 200, epoch: 13 | loss: 0.3660718
	speed: 0.2611s/iter; left time: 8426.7112s
	iters: 300, epoch: 13 | loss: 0.7611001
	speed: 0.2493s/iter; left time: 8021.5303s
Epoch: 13 cost time: 93.30479431152344
Epoch: 13, Steps: 369 | Train Loss: 0.500 Vali Loss: 0.718 Vali Acc: 0.661 Test Loss: 0.718 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5101042
	speed: 0.7248s/iter; left time: 23195.8144s
	iters: 200, epoch: 14 | loss: 0.6229901
	speed: 0.2408s/iter; left time: 7683.3903s
	iters: 300, epoch: 14 | loss: 0.4897940
	speed: 0.2405s/iter; left time: 7647.3608s
Epoch: 14 cost time: 87.57982683181763
Epoch: 14, Steps: 369 | Train Loss: 0.490 Vali Loss: 0.678 Vali Acc: 0.684 Test Loss: 0.678 Test Acc: 0.684
Validation loss decreased (-0.680470 --> -0.683875).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2215066
	speed: 0.6893s/iter; left time: 21804.7360s
	iters: 200, epoch: 15 | loss: 0.5000693
	speed: 0.2527s/iter; left time: 7970.0442s
	iters: 300, epoch: 15 | loss: 0.4218036
	speed: 0.2667s/iter; left time: 8382.3302s
Epoch: 15 cost time: 93.95491337776184
Epoch: 15, Steps: 369 | Train Loss: 0.455 Vali Loss: 0.765 Vali Acc: 0.665 Test Loss: 0.765 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3387931
	speed: 0.7401s/iter; left time: 23139.3976s
	iters: 200, epoch: 16 | loss: 0.2439373
	speed: 0.2396s/iter; left time: 7468.8111s
	iters: 300, epoch: 16 | loss: 0.6095034
	speed: 0.2422s/iter; left time: 7525.3448s
Epoch: 16 cost time: 89.02037954330444
Epoch: 16, Steps: 369 | Train Loss: 0.432 Vali Loss: 0.738 Vali Acc: 0.667 Test Loss: 0.738 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3647193
	speed: 0.7312s/iter; left time: 22590.6923s
	iters: 200, epoch: 17 | loss: 0.2884571
	speed: 0.2654s/iter; left time: 8174.2936s
	iters: 300, epoch: 17 | loss: 0.3806296
	speed: 0.2549s/iter; left time: 7823.9186s
Epoch: 17 cost time: 95.41088843345642
Epoch: 17, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.777 Vali Acc: 0.683 Test Loss: 0.777 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7583092
	speed: 0.7640s/iter; left time: 23324.6757s
	iters: 200, epoch: 18 | loss: 0.2314978
	speed: 0.2414s/iter; left time: 7346.1023s
	iters: 300, epoch: 18 | loss: 0.2070401
	speed: 0.2360s/iter; left time: 7156.6219s
Epoch: 18 cost time: 90.12560892105103
Epoch: 18, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.789 Vali Acc: 0.684 Test Loss: 0.789 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3037705
	speed: 0.7234s/iter; left time: 21816.5281s
	iters: 200, epoch: 19 | loss: 0.2992701
	speed: 0.2525s/iter; left time: 7590.4273s
	iters: 300, epoch: 19 | loss: 0.5659463
	speed: 0.2538s/iter; left time: 7605.0558s
Epoch: 19 cost time: 93.16826868057251
Epoch: 19, Steps: 369 | Train Loss: 0.387 Vali Loss: 0.774 Vali Acc: 0.680 Test Loss: 0.774 Test Acc: 0.680
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2482557
	speed: 0.7365s/iter; left time: 21940.6535s
	iters: 200, epoch: 20 | loss: 0.6072592
	speed: 0.2536s/iter; left time: 7530.1403s
	iters: 300, epoch: 20 | loss: 0.3732467
	speed: 0.2506s/iter; left time: 7413.8895s
Epoch: 20 cost time: 93.12572503089905
Epoch: 20, Steps: 369 | Train Loss: 0.363 Vali Loss: 0.780 Vali Acc: 0.665 Test Loss: 0.780 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2608323
	speed: 0.7399s/iter; left time: 21769.3462s
	iters: 200, epoch: 21 | loss: 0.3631149
	speed: 0.2807s/iter; left time: 8231.1246s
	iters: 300, epoch: 21 | loss: 0.3864178
	speed: 0.2575s/iter; left time: 7523.5240s
Epoch: 21 cost time: 98.04108357429504
Epoch: 21, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.773 Vali Acc: 0.669 Test Loss: 0.773 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3017815
	speed: 0.7375s/iter; left time: 21424.4446s
	iters: 200, epoch: 22 | loss: 0.5302277
	speed: 0.2395s/iter; left time: 6933.7472s
	iters: 300, epoch: 22 | loss: 0.1679555
	speed: 0.2350s/iter; left time: 6780.6702s
Epoch: 22 cost time: 87.53797554969788
Epoch: 22, Steps: 369 | Train Loss: 0.331 Vali Loss: 0.967 Vali Acc: 0.677 Test Loss: 0.967 Test Acc: 0.677
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.4667362
	speed: 0.6855s/iter; left time: 19662.6256s
	iters: 200, epoch: 23 | loss: 0.2841663
	speed: 0.2430s/iter; left time: 6945.6816s
	iters: 300, epoch: 23 | loss: 0.2287116
	speed: 0.2437s/iter; left time: 6941.9362s
Epoch: 23 cost time: 89.62206768989563
Epoch: 23, Steps: 369 | Train Loss: 0.313 Vali Loss: 1.003 Vali Acc: 0.663 Test Loss: 1.003 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.3033781
	speed: 0.7148s/iter; left time: 20238.6967s
	iters: 200, epoch: 24 | loss: 0.3623000
	speed: 0.2378s/iter; left time: 6708.0593s
	iters: 300, epoch: 24 | loss: 0.1319742
	speed: 0.2357s/iter; left time: 6625.3785s
Epoch: 24 cost time: 88.34341931343079
Epoch: 24, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.980 Vali Acc: 0.658 Test Loss: 0.980 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6838819523269013
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6929656
	speed: 0.2564s/iter; left time: 9436.8914s
	iters: 200, epoch: 1 | loss: 0.6934418
	speed: 0.2636s/iter; left time: 9676.1091s
	iters: 300, epoch: 1 | loss: 0.6931480
	speed: 0.2567s/iter; left time: 9395.6561s
Epoch: 1 cost time: 96.16117835044861
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6931545
	speed: 0.7680s/iter; left time: 27979.3792s
	iters: 200, epoch: 2 | loss: 0.6934629
	speed: 0.2387s/iter; left time: 8671.7968s
	iters: 300, epoch: 2 | loss: 0.6941810
	speed: 0.2413s/iter; left time: 8742.4042s
Epoch: 2 cost time: 92.38888454437256
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6940088
	speed: 0.7418s/iter; left time: 26750.9025s
	iters: 200, epoch: 3 | loss: 0.6939570
	speed: 0.2623s/iter; left time: 9431.9015s
	iters: 300, epoch: 3 | loss: 0.6940290
	speed: 0.2543s/iter; left time: 9119.6562s
Epoch: 3 cost time: 95.00613808631897
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6933089
	speed: 0.7307s/iter; left time: 26081.4249s
	iters: 200, epoch: 4 | loss: 0.6932330
	speed: 0.2153s/iter; left time: 7663.9212s
	iters: 300, epoch: 4 | loss: 0.6931697
	speed: 0.2321s/iter; left time: 8238.6234s
Epoch: 4 cost time: 84.6691300868988
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6932483
	speed: 0.6991s/iter; left time: 24694.2816s
	iters: 200, epoch: 5 | loss: 0.6930734
	speed: 0.2397s/iter; left time: 8442.6748s
	iters: 300, epoch: 5 | loss: 0.6935720
	speed: 0.2466s/iter; left time: 8662.6353s
Epoch: 5 cost time: 91.74300360679626
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6931723
	speed: 0.7983s/iter; left time: 27904.2094s
	iters: 200, epoch: 6 | loss: 0.6926628
	speed: 0.2511s/iter; left time: 8752.4562s
	iters: 300, epoch: 6 | loss: 0.6931634
	speed: 0.2555s/iter; left time: 8880.1778s
Epoch: 6 cost time: 95.15873098373413
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6925546
	speed: 0.7396s/iter; left time: 25581.8496s
	iters: 200, epoch: 7 | loss: 0.6935369
	speed: 0.2560s/iter; left time: 8827.4279s
	iters: 300, epoch: 7 | loss: 0.6926734
	speed: 0.2486s/iter; left time: 8549.1530s
Epoch: 7 cost time: 94.83894968032837
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6909693
	speed: 0.7501s/iter; left time: 25666.0919s
	iters: 200, epoch: 8 | loss: 0.6921455
	speed: 0.2435s/iter; left time: 8307.2982s
	iters: 300, epoch: 8 | loss: 0.6936167
	speed: 0.2478s/iter; left time: 8430.8779s
Epoch: 8 cost time: 90.94377064704895
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6932501
	speed: 0.7635s/iter; left time: 25842.6381s
	iters: 200, epoch: 9 | loss: 0.6928064
	speed: 0.2635s/iter; left time: 8892.0702s
	iters: 300, epoch: 9 | loss: 0.6940240
	speed: 0.2626s/iter; left time: 8837.0732s
Epoch: 9 cost time: 96.42129921913147
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6935878
	speed: 0.7470s/iter; left time: 25008.8043s
	iters: 200, epoch: 10 | loss: 0.6928224
	speed: 0.2360s/iter; left time: 7877.1323s
	iters: 300, epoch: 10 | loss: 0.6939517
	speed: 0.2439s/iter; left time: 8117.3996s
Epoch: 10 cost time: 88.91608619689941
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6931555
	speed: 0.7161s/iter; left time: 23711.8120s
	iters: 200, epoch: 11 | loss: 0.6932634
	speed: 0.2395s/iter; left time: 7905.9586s
	iters: 300, epoch: 11 | loss: 0.6936647
	speed: 0.2446s/iter; left time: 8049.0387s
Epoch: 11 cost time: 90.70997357368469
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6974857
	speed: 0.7638s/iter; left time: 25008.7414s
	iters: 200, epoch: 12 | loss: 0.6917648
	speed: 0.2593s/iter; left time: 8462.9638s
	iters: 300, epoch: 12 | loss: 0.6925480
	speed: 0.2388s/iter; left time: 7771.8116s
Epoch: 12 cost time: 92.7052264213562
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6943641
	speed: 0.7123s/iter; left time: 23058.7885s
	iters: 200, epoch: 13 | loss: 0.6925334
	speed: 0.2454s/iter; left time: 7921.0636s
	iters: 300, epoch: 13 | loss: 0.6962563
	speed: 0.2649s/iter; left time: 8523.1963s
Epoch: 13 cost time: 95.0232949256897
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6933154
	speed: 0.7871s/iter; left time: 25191.9264s
	iters: 200, epoch: 14 | loss: 0.6932006
	speed: 0.2424s/iter; left time: 7733.5482s
	iters: 300, epoch: 14 | loss: 0.6931676
	speed: 0.2430s/iter; left time: 7728.6071s
Epoch: 14 cost time: 94.38586235046387
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6921678
	speed: 0.7484s/iter; left time: 23674.6382s
	iters: 200, epoch: 15 | loss: 0.6928057
	speed: 0.2529s/iter; left time: 7973.8624s
	iters: 300, epoch: 15 | loss: 0.6907696
	speed: 0.2494s/iter; left time: 7841.0125s
Epoch: 15 cost time: 94.62006402015686
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 2989314
model size : 21.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8263684
	speed: 0.2720s/iter; left time: 10008.0627s
	iters: 200, epoch: 1 | loss: 0.8505610
	speed: 0.2414s/iter; left time: 8858.2418s
	iters: 300, epoch: 1 | loss: 0.7721788
	speed: 0.2384s/iter; left time: 8725.8964s
Epoch: 1 cost time: 92.71213507652283
Epoch: 1, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.727 Vali Acc: 0.661 Test Loss: 0.727 Test Acc: 0.661
Validation loss decreased (inf --> -0.661457).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6930113
	speed: 0.7667s/iter; left time: 27932.0719s
	iters: 200, epoch: 2 | loss: 0.9748502
	speed: 0.2684s/iter; left time: 9753.2431s
	iters: 300, epoch: 2 | loss: 0.3835529
	speed: 0.2534s/iter; left time: 9179.7478s
Epoch: 2 cost time: 96.525319814682
Epoch: 2, Steps: 369 | Train Loss: 0.592 Vali Loss: 1.049 Vali Acc: 0.627 Test Loss: 1.049 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2429215
	speed: 0.7398s/iter; left time: 26677.6966s
	iters: 200, epoch: 3 | loss: 0.1613928
	speed: 0.2432s/iter; left time: 8746.5891s
	iters: 300, epoch: 3 | loss: 0.2590502
	speed: 0.2350s/iter; left time: 8429.5636s
Epoch: 3 cost time: 89.45212602615356
Epoch: 3, Steps: 369 | Train Loss: 0.545 Vali Loss: 1.298 Vali Acc: 0.638 Test Loss: 1.298 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7042045
	speed: 0.7513s/iter; left time: 26815.8060s
	iters: 200, epoch: 4 | loss: 0.9726029
	speed: 0.2588s/iter; left time: 9213.2950s
	iters: 300, epoch: 4 | loss: 0.3935620
	speed: 0.2468s/iter; left time: 8759.6482s
Epoch: 4 cost time: 93.8152277469635
Epoch: 4, Steps: 369 | Train Loss: 0.511 Vali Loss: 1.765 Vali Acc: 0.629 Test Loss: 1.765 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0007057
	speed: 0.7301s/iter; left time: 25792.3179s
	iters: 200, epoch: 5 | loss: 0.1654591
	speed: 0.2507s/iter; left time: 8829.7988s
	iters: 300, epoch: 5 | loss: 0.5321370
	speed: 0.2631s/iter; left time: 9242.2210s
Epoch: 5 cost time: 93.841805934906
Epoch: 5, Steps: 369 | Train Loss: 0.539 Vali Loss: 1.897 Vali Acc: 0.596 Test Loss: 1.897 Test Acc: 0.596
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0674055
	speed: 0.8139s/iter; left time: 28449.1505s
	iters: 200, epoch: 6 | loss: 0.5839911
	speed: 0.2600s/iter; left time: 9063.1471s
	iters: 300, epoch: 6 | loss: 1.1031860
	speed: 0.2637s/iter; left time: 9166.4932s
Epoch: 6 cost time: 97.79001927375793
Epoch: 6, Steps: 369 | Train Loss: 0.522 Vali Loss: 1.822 Vali Acc: 0.615 Test Loss: 1.822 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.9695253
	speed: 0.7618s/iter; left time: 26348.1516s
	iters: 200, epoch: 7 | loss: 0.6606345
	speed: 0.2790s/iter; left time: 9620.7874s
	iters: 300, epoch: 7 | loss: 0.6661179
	speed: 0.2597s/iter; left time: 8931.7003s
Epoch: 7 cost time: 98.65160417556763
Epoch: 7, Steps: 369 | Train Loss: 0.500 Vali Loss: 1.952 Vali Acc: 0.676 Test Loss: 1.952 Test Acc: 0.676
Validation loss decreased (-0.661457 --> -0.676201).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0695504
	speed: 0.7594s/iter; left time: 25986.3957s
	iters: 200, epoch: 8 | loss: 0.5665467
	speed: 0.2369s/iter; left time: 8084.0690s
	iters: 300, epoch: 8 | loss: 0.8027883
	speed: 0.2374s/iter; left time: 8074.3450s
Epoch: 8 cost time: 88.30815315246582
Epoch: 8, Steps: 369 | Train Loss: 0.515 Vali Loss: 2.060 Vali Acc: 0.642 Test Loss: 2.060 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1875810
	speed: 0.7057s/iter; left time: 23888.7867s
	iters: 200, epoch: 9 | loss: 0.0369152
	speed: 0.2659s/iter; left time: 8975.3510s
	iters: 300, epoch: 9 | loss: 0.1440998
	speed: 0.2550s/iter; left time: 8580.5570s
Epoch: 9 cost time: 94.43193554878235
Epoch: 9, Steps: 369 | Train Loss: 0.446 Vali Loss: 2.279 Vali Acc: 0.642 Test Loss: 2.279 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3613704
	speed: 0.7635s/iter; left time: 25563.4924s
	iters: 200, epoch: 10 | loss: 0.2980799
	speed: 0.2431s/iter; left time: 8113.5694s
	iters: 300, epoch: 10 | loss: 0.8797595
	speed: 0.2524s/iter; left time: 8400.7477s
Epoch: 10 cost time: 90.51984810829163
Epoch: 10, Steps: 369 | Train Loss: 0.440 Vali Loss: 2.609 Vali Acc: 0.625 Test Loss: 2.609 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3241471
	speed: 0.7400s/iter; left time: 24502.5371s
	iters: 200, epoch: 11 | loss: 0.1512528
	speed: 0.2472s/iter; left time: 8160.9450s
	iters: 300, epoch: 11 | loss: 0.6037993
	speed: 0.2525s/iter; left time: 8311.0878s
Epoch: 11 cost time: 94.07420325279236
Epoch: 11, Steps: 369 | Train Loss: 0.428 Vali Loss: 2.514 Vali Acc: 0.625 Test Loss: 2.514 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2964727
	speed: 0.7169s/iter; left time: 23471.3437s
	iters: 200, epoch: 12 | loss: 1.4032280
	speed: 0.2394s/iter; left time: 7814.2402s
	iters: 300, epoch: 12 | loss: 0.4964166
	speed: 0.2319s/iter; left time: 7545.1414s
Epoch: 12 cost time: 87.13249135017395
Epoch: 12, Steps: 369 | Train Loss: 0.417 Vali Loss: 2.718 Vali Acc: 0.631 Test Loss: 2.718 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9246200
	speed: 0.7323s/iter; left time: 23707.3353s
	iters: 200, epoch: 13 | loss: 0.0358609
	speed: 0.2507s/iter; left time: 8089.4328s
	iters: 300, epoch: 13 | loss: 0.2864681
	speed: 0.2670s/iter; left time: 8589.4755s
Epoch: 13 cost time: 95.97056651115417
Epoch: 13, Steps: 369 | Train Loss: 0.376 Vali Loss: 2.747 Vali Acc: 0.625 Test Loss: 2.747 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.4197081
	speed: 0.7231s/iter; left time: 23141.4031s
	iters: 200, epoch: 14 | loss: 0.9034765
	speed: 0.2401s/iter; left time: 7659.3167s
	iters: 300, epoch: 14 | loss: 0.0002773
	speed: 0.2335s/iter; left time: 7424.9631s
Epoch: 14 cost time: 86.47041940689087
Epoch: 14, Steps: 369 | Train Loss: 0.336 Vali Loss: 2.846 Vali Acc: 0.630 Test Loss: 2.846 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0144060
	speed: 0.7370s/iter; left time: 23314.0436s
	iters: 200, epoch: 15 | loss: 0.6443735
	speed: 0.2463s/iter; left time: 7766.9636s
	iters: 300, epoch: 15 | loss: 0.1591086
	speed: 0.2451s/iter; left time: 7704.3408s
Epoch: 15 cost time: 91.25886106491089
Epoch: 15, Steps: 369 | Train Loss: 0.330 Vali Loss: 2.383 Vali Acc: 0.638 Test Loss: 2.383 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1616875
	speed: 0.7033s/iter; left time: 21990.3053s
	iters: 200, epoch: 16 | loss: 0.3091533
	speed: 0.2338s/iter; left time: 7287.5917s
	iters: 300, epoch: 16 | loss: 0.5467411
	speed: 0.2267s/iter; left time: 7043.0699s
Epoch: 16 cost time: 87.32895708084106
Epoch: 16, Steps: 369 | Train Loss: 0.321 Vali Loss: 2.984 Vali Acc: 0.655 Test Loss: 2.984 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0049849
	speed: 0.7366s/iter; left time: 22757.5839s
	iters: 200, epoch: 17 | loss: 0.7093288
	speed: 0.2509s/iter; left time: 7725.5209s
	iters: 300, epoch: 17 | loss: 0.0040249
	speed: 0.2408s/iter; left time: 7392.7503s
Epoch: 17 cost time: 91.09041595458984
Epoch: 17, Steps: 369 | Train Loss: 0.263 Vali Loss: 3.302 Vali Acc: 0.650 Test Loss: 3.302 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6762202043132803
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7993447
	speed: 0.2525s/iter; left time: 9291.1388s
	iters: 200, epoch: 1 | loss: 0.8035157
	speed: 0.2538s/iter; left time: 9316.1787s
	iters: 300, epoch: 1 | loss: 0.6788538
	speed: 0.2673s/iter; left time: 9783.3539s
Epoch: 1 cost time: 95.61386489868164
Epoch: 1, Steps: 369 | Train Loss: 0.671 Vali Loss: 0.765 Vali Acc: 0.658 Test Loss: 0.765 Test Acc: 0.658
Validation loss decreased (inf --> -0.657768).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5891289
	speed: 0.7343s/iter; left time: 26753.2412s
	iters: 200, epoch: 2 | loss: 1.1811701
	speed: 0.2326s/iter; left time: 8449.3779s
	iters: 300, epoch: 2 | loss: 0.5457774
	speed: 0.2334s/iter; left time: 8457.0351s
Epoch: 2 cost time: 85.28239130973816
Epoch: 2, Steps: 369 | Train Loss: 0.616 Vali Loss: 1.124 Vali Acc: 0.644 Test Loss: 1.124 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1199648
	speed: 0.7127s/iter; left time: 25700.4151s
	iters: 200, epoch: 3 | loss: 0.1357470
	speed: 0.2620s/iter; left time: 9421.8143s
	iters: 300, epoch: 3 | loss: 0.3290440
	speed: 0.2572s/iter; left time: 9225.7382s
Epoch: 3 cost time: 94.79569458961487
Epoch: 3, Steps: 369 | Train Loss: 0.542 Vali Loss: 1.233 Vali Acc: 0.624 Test Loss: 1.233 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1054723
	speed: 0.7832s/iter; left time: 27954.7380s
	iters: 200, epoch: 4 | loss: 1.5037616
	speed: 0.2404s/iter; left time: 8555.5904s
	iters: 300, epoch: 4 | loss: 0.0107606
	speed: 0.2543s/iter; left time: 9026.1641s
Epoch: 4 cost time: 93.43310284614563
Epoch: 4, Steps: 369 | Train Loss: 0.565 Vali Loss: 1.359 Vali Acc: 0.671 Test Loss: 1.359 Test Acc: 0.671
Validation loss decreased (-0.657768 --> -0.670815).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0750533
	speed: 0.7707s/iter; left time: 27223.7352s
	iters: 200, epoch: 5 | loss: 0.6965024
	speed: 0.2611s/iter; left time: 9196.7724s
	iters: 300, epoch: 5 | loss: 0.2642313
	speed: 0.2585s/iter; left time: 9078.2816s
Epoch: 5 cost time: 94.72888278961182
Epoch: 5, Steps: 369 | Train Loss: 0.518 Vali Loss: 2.011 Vali Acc: 0.609 Test Loss: 2.011 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4132128
	speed: 0.7058s/iter; left time: 24671.7638s
	iters: 200, epoch: 6 | loss: 0.9117342
	speed: 0.2411s/iter; left time: 8403.8309s
	iters: 300, epoch: 6 | loss: 0.2826877
	speed: 0.2506s/iter; left time: 8709.8859s
Epoch: 6 cost time: 91.53556156158447
Epoch: 6, Steps: 369 | Train Loss: 0.519 Vali Loss: 1.711 Vali Acc: 0.640 Test Loss: 1.711 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1971752
	speed: 0.7432s/iter; left time: 25704.4238s
	iters: 200, epoch: 7 | loss: 0.8330320
	speed: 0.2445s/iter; left time: 8430.8166s
	iters: 300, epoch: 7 | loss: 0.7295863
	speed: 0.2343s/iter; left time: 8057.7369s
Epoch: 7 cost time: 88.30147242546082
Epoch: 7, Steps: 369 | Train Loss: 0.509 Vali Loss: 1.935 Vali Acc: 0.637 Test Loss: 1.935 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1284699
	speed: 0.7072s/iter; left time: 24197.2849s
	iters: 200, epoch: 8 | loss: 0.0076451
	speed: 0.2388s/iter; left time: 8147.2114s
	iters: 300, epoch: 8 | loss: 0.5199163
	speed: 0.2387s/iter; left time: 8120.6314s
Epoch: 8 cost time: 87.82847690582275
Epoch: 8, Steps: 369 | Train Loss: 0.514 Vali Loss: 1.997 Vali Acc: 0.645 Test Loss: 1.997 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3659116
	speed: 0.7211s/iter; left time: 24409.1926s
	iters: 200, epoch: 9 | loss: 0.2098811
	speed: 0.2379s/iter; left time: 8027.2662s
	iters: 300, epoch: 9 | loss: 0.0913666
	speed: 0.2295s/iter; left time: 7722.3971s
Epoch: 9 cost time: 87.0324444770813
Epoch: 9, Steps: 369 | Train Loss: 0.467 Vali Loss: 2.017 Vali Acc: 0.620 Test Loss: 2.017 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1661656
	speed: 0.6693s/iter; left time: 22409.3480s
	iters: 200, epoch: 10 | loss: 0.0868942
	speed: 0.2218s/iter; left time: 7403.2411s
	iters: 300, epoch: 10 | loss: 0.2170298
	speed: 0.2335s/iter; left time: 7771.3179s
Epoch: 10 cost time: 84.95402097702026
Epoch: 10, Steps: 369 | Train Loss: 0.466 Vali Loss: 2.317 Vali Acc: 0.625 Test Loss: 2.317 Test Acc: 0.625
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2514485
	speed: 0.7511s/iter; left time: 24868.5767s
	iters: 200, epoch: 11 | loss: 0.1227441
	speed: 0.2410s/iter; left time: 7954.6501s
	iters: 300, epoch: 11 | loss: 1.0017288
	speed: 0.2424s/iter; left time: 7978.0263s
Epoch: 11 cost time: 90.34356164932251
Epoch: 11, Steps: 369 | Train Loss: 0.403 Vali Loss: 2.503 Vali Acc: 0.616 Test Loss: 2.503 Test Acc: 0.616
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4773041
	speed: 0.7443s/iter; left time: 24370.6794s
	iters: 200, epoch: 12 | loss: 0.4787877
	speed: 0.2502s/iter; left time: 8166.0455s
	iters: 300, epoch: 12 | loss: 0.5829834
	speed: 0.2532s/iter; left time: 8239.1911s
Epoch: 12 cost time: 93.43140482902527
Epoch: 12, Steps: 369 | Train Loss: 0.386 Vali Loss: 2.500 Vali Acc: 0.615 Test Loss: 2.500 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3179970
	speed: 0.7522s/iter; left time: 24351.0279s
	iters: 200, epoch: 13 | loss: 0.0265774
	speed: 0.2200s/iter; left time: 7098.9233s
	iters: 300, epoch: 13 | loss: 0.0199166
	speed: 0.2357s/iter; left time: 7583.1228s
Epoch: 13 cost time: 86.08999943733215
Epoch: 13, Steps: 369 | Train Loss: 0.368 Vali Loss: 2.642 Vali Acc: 0.642 Test Loss: 2.642 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1270245
	speed: 0.6899s/iter; left time: 22078.4097s
	iters: 200, epoch: 14 | loss: 0.0309782
	speed: 0.2451s/iter; left time: 7819.5209s
	iters: 300, epoch: 14 | loss: 0.1691272
	speed: 0.2457s/iter; left time: 7814.6032s
Epoch: 14 cost time: 89.29630541801453
Epoch: 14, Steps: 369 | Train Loss: 0.334 Vali Loss: 2.846 Vali Acc: 0.642 Test Loss: 2.846 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6708286038592508
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7934029
	speed: 0.2553s/iter; left time: 9394.6276s
	iters: 200, epoch: 1 | loss: 0.9344727
	speed: 0.2494s/iter; left time: 9151.9428s
	iters: 300, epoch: 1 | loss: 0.6967705
	speed: 0.2463s/iter; left time: 9015.7593s
Epoch: 1 cost time: 92.23280239105225
Epoch: 1, Steps: 369 | Train Loss: 0.679 Vali Loss: 0.766 Vali Acc: 0.646 Test Loss: 0.766 Test Acc: 0.646
Validation loss decreased (inf --> -0.646133).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4033153
	speed: 0.7783s/iter; left time: 28355.7020s
	iters: 200, epoch: 2 | loss: 1.1537526
	speed: 0.2597s/iter; left time: 9434.6124s
	iters: 300, epoch: 2 | loss: 0.8162928
	speed: 0.2551s/iter; left time: 9241.8012s
Epoch: 2 cost time: 94.51856064796448
Epoch: 2, Steps: 369 | Train Loss: 0.613 Vali Loss: 1.082 Vali Acc: 0.631 Test Loss: 1.082 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3475191
	speed: 0.7026s/iter; left time: 25336.1268s
	iters: 200, epoch: 3 | loss: 0.4185754
	speed: 0.2749s/iter; left time: 9885.4550s
	iters: 300, epoch: 3 | loss: 0.2987117
	speed: 0.2648s/iter; left time: 9495.3519s
Epoch: 3 cost time: 94.73978042602539
Epoch: 3, Steps: 369 | Train Loss: 0.565 Vali Loss: 1.094 Vali Acc: 0.658 Test Loss: 1.094 Test Acc: 0.658
Validation loss decreased (-0.646133 --> -0.658048).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1897091
	speed: 0.7657s/iter; left time: 27329.9626s
	iters: 200, epoch: 4 | loss: 1.0145781
	speed: 0.2624s/iter; left time: 9341.2361s
	iters: 300, epoch: 4 | loss: 0.1300902
	speed: 0.2445s/iter; left time: 8676.8375s
Epoch: 4 cost time: 94.66287779808044
Epoch: 4, Steps: 369 | Train Loss: 0.532 Vali Loss: 1.649 Vali Acc: 0.652 Test Loss: 1.649 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3128297
	speed: 0.7396s/iter; left time: 26127.5051s
	iters: 200, epoch: 5 | loss: 1.2850970
	speed: 0.2549s/iter; left time: 8979.5724s
	iters: 300, epoch: 5 | loss: 0.6891913
	speed: 0.2481s/iter; left time: 8715.3949s
Epoch: 5 cost time: 92.27721953392029
Epoch: 5, Steps: 369 | Train Loss: 0.533 Vali Loss: 1.756 Vali Acc: 0.608 Test Loss: 1.756 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5843098
	speed: 0.7448s/iter; left time: 26034.8724s
	iters: 200, epoch: 6 | loss: 0.0063212
	speed: 0.2348s/iter; left time: 8183.1281s
	iters: 300, epoch: 6 | loss: 0.2184232
	speed: 0.2417s/iter; left time: 8399.7120s
Epoch: 6 cost time: 90.34019827842712
Epoch: 6, Steps: 369 | Train Loss: 0.516 Vali Loss: 2.178 Vali Acc: 0.591 Test Loss: 2.178 Test Acc: 0.591
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0003715
	speed: 0.7319s/iter; left time: 25312.7861s
	iters: 200, epoch: 7 | loss: 0.8105692
	speed: 0.2563s/iter; left time: 8838.6732s
	iters: 300, epoch: 7 | loss: 0.2018803
	speed: 0.2406s/iter; left time: 8273.9976s
Epoch: 7 cost time: 92.48352551460266
Epoch: 7, Steps: 369 | Train Loss: 0.507 Vali Loss: 1.905 Vali Acc: 0.628 Test Loss: 1.905 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5402174
	speed: 0.7280s/iter; left time: 24911.5724s
	iters: 200, epoch: 8 | loss: 0.1160422
	speed: 0.2285s/iter; left time: 7795.1038s
	iters: 300, epoch: 8 | loss: 0.6341473
	speed: 0.2342s/iter; left time: 7965.3389s
Epoch: 8 cost time: 86.16105318069458
Epoch: 8, Steps: 369 | Train Loss: 0.501 Vali Loss: 1.999 Vali Acc: 0.638 Test Loss: 1.999 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.2860918
	speed: 0.7238s/iter; left time: 24500.1158s
	iters: 200, epoch: 9 | loss: 1.2354782
	speed: 0.2441s/iter; left time: 8236.7048s
	iters: 300, epoch: 9 | loss: 0.5152423
	speed: 0.2413s/iter; left time: 8119.5478s
Epoch: 9 cost time: 90.29159140586853
Epoch: 9, Steps: 369 | Train Loss: 0.442 Vali Loss: 2.350 Vali Acc: 0.623 Test Loss: 2.350 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2338320
	speed: 0.7316s/iter; left time: 24493.0255s
	iters: 200, epoch: 10 | loss: 0.4903844
	speed: 0.2447s/iter; left time: 8166.6283s
	iters: 300, epoch: 10 | loss: 1.2325323
	speed: 0.2441s/iter; left time: 8122.9526s
Epoch: 10 cost time: 90.36983323097229
Epoch: 10, Steps: 369 | Train Loss: 0.475 Vali Loss: 2.128 Vali Acc: 0.638 Test Loss: 2.128 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2834876
	speed: 0.7145s/iter; left time: 23658.2464s
	iters: 200, epoch: 11 | loss: 1.3685312
	speed: 0.2369s/iter; left time: 7819.2146s
	iters: 300, epoch: 11 | loss: 0.7412251
	speed: 0.2371s/iter; left time: 7804.0962s
Epoch: 11 cost time: 88.86076331138611
Epoch: 11, Steps: 369 | Train Loss: 0.461 Vali Loss: 2.335 Vali Acc: 0.639 Test Loss: 2.335 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1134128
	speed: 0.7099s/iter; left time: 23242.9665s
	iters: 200, epoch: 12 | loss: 0.1560412
	speed: 0.2332s/iter; left time: 7613.1280s
	iters: 300, epoch: 12 | loss: 0.1981701
	speed: 0.2335s/iter; left time: 7599.5640s
Epoch: 12 cost time: 88.29706072807312
Epoch: 12, Steps: 369 | Train Loss: 0.405 Vali Loss: 2.267 Vali Acc: 0.635 Test Loss: 2.267 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6633624
	speed: 0.7532s/iter; left time: 24383.6062s
	iters: 200, epoch: 13 | loss: 0.0001572
	speed: 0.2507s/iter; left time: 8090.0378s
	iters: 300, epoch: 13 | loss: 0.3401841
	speed: 0.2592s/iter; left time: 8340.2394s
Epoch: 13 cost time: 94.27934956550598
Epoch: 13, Steps: 369 | Train Loss: 0.388 Vali Loss: 2.261 Vali Acc: 0.657 Test Loss: 2.261 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6580590238365494
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7812109
	speed: 0.2680s/iter; left time: 9863.6524s
	iters: 200, epoch: 1 | loss: 0.8114979
	speed: 0.2438s/iter; left time: 8946.4530s
	iters: 300, epoch: 1 | loss: 0.8271795
	speed: 0.2375s/iter; left time: 8692.6639s
Epoch: 1 cost time: 92.96354508399963
Epoch: 1, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.767 Vali Acc: 0.678 Test Loss: 0.767 Test Acc: 0.678
Validation loss decreased (inf --> -0.677631).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3896601
	speed: 0.7286s/iter; left time: 26543.7934s
	iters: 200, epoch: 2 | loss: 1.1309261
	speed: 0.2392s/iter; left time: 8692.3048s
	iters: 300, epoch: 2 | loss: 0.8209862
	speed: 0.2316s/iter; left time: 8391.2543s
Epoch: 2 cost time: 89.13295483589172
Epoch: 2, Steps: 369 | Train Loss: 0.620 Vali Loss: 1.027 Vali Acc: 0.654 Test Loss: 1.027 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3542545
	speed: 0.7207s/iter; left time: 25991.4946s
	iters: 200, epoch: 3 | loss: 0.1505471
	speed: 0.2442s/iter; left time: 8783.4509s
	iters: 300, epoch: 3 | loss: 0.2762105
	speed: 0.2502s/iter; left time: 8972.2286s
Epoch: 3 cost time: 90.22597026824951
Epoch: 3, Steps: 369 | Train Loss: 0.594 Vali Loss: 1.137 Vali Acc: 0.644 Test Loss: 1.137 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1537416
	speed: 0.7470s/iter; left time: 26662.2602s
	iters: 200, epoch: 4 | loss: 1.3177148
	speed: 0.2518s/iter; left time: 8963.9724s
	iters: 300, epoch: 4 | loss: 0.0873853
	speed: 0.2337s/iter; left time: 8296.6587s
Epoch: 4 cost time: 91.72199845314026
Epoch: 4, Steps: 369 | Train Loss: 0.544 Vali Loss: 1.596 Vali Acc: 0.639 Test Loss: 1.596 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5821643
	speed: 0.6914s/iter; left time: 24424.1453s
	iters: 200, epoch: 5 | loss: 0.1874868
	speed: 0.2327s/iter; left time: 8197.3797s
	iters: 300, epoch: 5 | loss: 0.3891718
	speed: 0.2302s/iter; left time: 8085.2283s
Epoch: 5 cost time: 85.26055765151978
Epoch: 5, Steps: 369 | Train Loss: 0.533 Vali Loss: 2.015 Vali Acc: 0.589 Test Loss: 2.015 Test Acc: 0.589
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4674365
	speed: 0.7019s/iter; left time: 24535.4302s
	iters: 200, epoch: 6 | loss: 0.4452958
	speed: 0.2308s/iter; left time: 8045.7451s
	iters: 300, epoch: 6 | loss: 0.5966914
	speed: 0.2343s/iter; left time: 8143.2210s
Epoch: 6 cost time: 88.0084593296051
Epoch: 6, Steps: 369 | Train Loss: 0.514 Vali Loss: 1.927 Vali Acc: 0.626 Test Loss: 1.927 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.3101290
	speed: 0.7361s/iter; left time: 25460.5769s
	iters: 200, epoch: 7 | loss: 0.6711844
	speed: 0.2470s/iter; left time: 8519.1222s
	iters: 300, epoch: 7 | loss: 0.4572020
	speed: 0.2491s/iter; left time: 8566.1888s
Epoch: 7 cost time: 93.87337183952332
Epoch: 7, Steps: 369 | Train Loss: 0.528 Vali Loss: 1.938 Vali Acc: 0.658 Test Loss: 1.938 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3269431
	speed: 0.7341s/iter; left time: 25120.9619s
	iters: 200, epoch: 8 | loss: 0.2554025
	speed: 0.2615s/iter; left time: 8923.2812s
	iters: 300, epoch: 8 | loss: 0.3019544
	speed: 0.2596s/iter; left time: 8831.5015s
Epoch: 8 cost time: 95.9408073425293
Epoch: 8, Steps: 369 | Train Loss: 0.533 Vali Loss: 1.866 Vali Acc: 0.641 Test Loss: 1.866 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.4285215
	speed: 0.7280s/iter; left time: 24641.0400s
	iters: 200, epoch: 9 | loss: 0.2168162
	speed: 0.2377s/iter; left time: 8021.2272s
	iters: 300, epoch: 9 | loss: 0.5545792
	speed: 0.2633s/iter; left time: 8861.1356s
Epoch: 9 cost time: 92.54037404060364
Epoch: 9, Steps: 369 | Train Loss: 0.447 Vali Loss: 2.215 Vali Acc: 0.620 Test Loss: 2.215 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.9322429
	speed: 0.7339s/iter; left time: 24570.7674s
	iters: 200, epoch: 10 | loss: 0.2005450
	speed: 0.2426s/iter; left time: 8098.2714s
	iters: 300, epoch: 10 | loss: 0.3277300
	speed: 0.2314s/iter; left time: 7701.8118s
Epoch: 10 cost time: 89.57642197608948
Epoch: 10, Steps: 369 | Train Loss: 0.483 Vali Loss: 2.398 Vali Acc: 0.623 Test Loss: 2.398 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.9561988
	speed: 0.7204s/iter; left time: 23853.2661s
	iters: 200, epoch: 11 | loss: 0.7729363
	speed: 0.2447s/iter; left time: 8077.2817s
	iters: 300, epoch: 11 | loss: 0.1173312
	speed: 0.2278s/iter; left time: 7496.2986s
Epoch: 11 cost time: 89.67227482795715
Epoch: 11, Steps: 369 | Train Loss: 0.420 Vali Loss: 2.291 Vali Acc: 0.656 Test Loss: 2.291 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677639046538025
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8480492
	speed: 0.2542s/iter; left time: 9356.5980s
	iters: 200, epoch: 1 | loss: 0.7186932
	speed: 0.2216s/iter; left time: 8134.4909s
	iters: 300, epoch: 1 | loss: 0.7535806
	speed: 0.2220s/iter; left time: 8124.9668s
Epoch: 1 cost time: 85.35137629508972
Epoch: 1, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.799 Vali Acc: 0.654 Test Loss: 0.799 Test Acc: 0.654
Validation loss decreased (inf --> -0.653795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6324639
	speed: 0.6994s/iter; left time: 25480.0567s
	iters: 200, epoch: 2 | loss: 1.2795626
	speed: 0.2239s/iter; left time: 8133.3310s
	iters: 300, epoch: 2 | loss: 0.7589105
	speed: 0.2231s/iter; left time: 8083.7714s
Epoch: 2 cost time: 86.63680267333984
Epoch: 2, Steps: 369 | Train Loss: 0.621 Vali Loss: 1.058 Vali Acc: 0.635 Test Loss: 1.058 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4159529
	speed: 0.7162s/iter; left time: 25827.0161s
	iters: 200, epoch: 3 | loss: 0.6585773
	speed: 0.2303s/iter; left time: 8283.9839s
	iters: 300, epoch: 3 | loss: 0.2705913
	speed: 0.2298s/iter; left time: 8242.7412s
Epoch: 3 cost time: 85.79751658439636
Epoch: 3, Steps: 369 | Train Loss: 0.562 Vali Loss: 1.246 Vali Acc: 0.628 Test Loss: 1.246 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2068867
	speed: 0.7252s/iter; left time: 25885.0892s
	iters: 200, epoch: 4 | loss: 1.6227981
	speed: 0.2360s/iter; left time: 8400.9975s
	iters: 300, epoch: 4 | loss: 0.0115929
	speed: 0.2454s/iter; left time: 8708.7961s
Epoch: 4 cost time: 91.32064843177795
Epoch: 4, Steps: 369 | Train Loss: 0.529 Vali Loss: 1.543 Vali Acc: 0.654 Test Loss: 1.543 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.9657897
	speed: 0.7755s/iter; left time: 27393.2815s
	iters: 200, epoch: 5 | loss: 0.7563254
	speed: 0.2571s/iter; left time: 9054.6757s
	iters: 300, epoch: 5 | loss: 0.4306638
	speed: 0.2547s/iter; left time: 8945.0043s
Epoch: 5 cost time: 94.72898888587952
Epoch: 5, Steps: 369 | Train Loss: 0.523 Vali Loss: 1.982 Vali Acc: 0.609 Test Loss: 1.982 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5323468
	speed: 0.6893s/iter; left time: 24095.8937s
	iters: 200, epoch: 6 | loss: 0.4944863
	speed: 0.2158s/iter; left time: 7522.7767s
	iters: 300, epoch: 6 | loss: 0.6513563
	speed: 0.2315s/iter; left time: 8046.9859s
Epoch: 6 cost time: 83.4194917678833
Epoch: 6, Steps: 369 | Train Loss: 0.490 Vali Loss: 1.814 Vali Acc: 0.635 Test Loss: 1.814 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0462912
	speed: 0.7058s/iter; left time: 24411.1587s
	iters: 200, epoch: 7 | loss: 0.1669750
	speed: 0.2212s/iter; left time: 7630.0240s
	iters: 300, epoch: 7 | loss: 0.7017839
	speed: 0.2528s/iter; left time: 8693.8448s
Epoch: 7 cost time: 90.6571843624115
Epoch: 7, Steps: 369 | Train Loss: 0.494 Vali Loss: 1.902 Vali Acc: 0.658 Test Loss: 1.902 Test Acc: 0.658
Validation loss decreased (-0.653795 --> -0.658040).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2695428
	speed: 0.7546s/iter; left time: 25822.5583s
	iters: 200, epoch: 8 | loss: 0.0380968
	speed: 0.2490s/iter; left time: 8495.6418s
	iters: 300, epoch: 8 | loss: 0.1625849
	speed: 0.2495s/iter; left time: 8488.7610s
Epoch: 8 cost time: 91.50278377532959
Epoch: 8, Steps: 369 | Train Loss: 0.496 Vali Loss: 2.501 Vali Acc: 0.618 Test Loss: 2.501 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7238297
	speed: 0.6965s/iter; left time: 23577.0478s
	iters: 200, epoch: 9 | loss: 0.6152121
	speed: 0.2255s/iter; left time: 7610.7716s
	iters: 300, epoch: 9 | loss: 0.8247345
	speed: 0.2314s/iter; left time: 7785.2484s
Epoch: 9 cost time: 84.11069679260254
Epoch: 9, Steps: 369 | Train Loss: 0.496 Vali Loss: 2.201 Vali Acc: 0.622 Test Loss: 2.201 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6840846
	speed: 0.6798s/iter; left time: 22760.9057s
	iters: 200, epoch: 10 | loss: 0.6494537
	speed: 0.2387s/iter; left time: 7966.7325s
	iters: 300, epoch: 10 | loss: 0.0039869
	speed: 0.2426s/iter; left time: 8074.3967s
Epoch: 10 cost time: 87.8558120727539
Epoch: 10, Steps: 369 | Train Loss: 0.477 Vali Loss: 2.388 Vali Acc: 0.617 Test Loss: 2.388 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3320788
	speed: 0.7233s/iter; left time: 23948.7443s
	iters: 200, epoch: 11 | loss: 0.4801320
	speed: 0.2640s/iter; left time: 8716.2941s
	iters: 300, epoch: 11 | loss: 0.5754909
	speed: 0.2448s/iter; left time: 8057.5033s
Epoch: 11 cost time: 92.26112031936646
Epoch: 11, Steps: 369 | Train Loss: 0.426 Vali Loss: 2.354 Vali Acc: 0.635 Test Loss: 2.354 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0731118
	speed: 0.7494s/iter; left time: 24536.8054s
	iters: 200, epoch: 12 | loss: 0.2700123
	speed: 0.2599s/iter; left time: 8483.0197s
	iters: 300, epoch: 12 | loss: 0.4423247
	speed: 0.2486s/iter; left time: 8090.3743s
Epoch: 12 cost time: 95.06647968292236
Epoch: 12, Steps: 369 | Train Loss: 0.437 Vali Loss: 2.474 Vali Acc: 0.624 Test Loss: 2.474 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7596180
	speed: 0.7604s/iter; left time: 24615.3564s
	iters: 200, epoch: 13 | loss: 0.0391900
	speed: 0.2269s/iter; left time: 7321.6270s
	iters: 300, epoch: 13 | loss: 0.5824423
	speed: 0.2355s/iter; left time: 7577.0278s
Epoch: 13 cost time: 87.44449591636658
Epoch: 13, Steps: 369 | Train Loss: 0.433 Vali Loss: 2.496 Vali Acc: 0.640 Test Loss: 2.496 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0613952
	speed: 0.7299s/iter; left time: 23360.6584s
	iters: 200, epoch: 14 | loss: 0.5454295
	speed: 0.2336s/iter; left time: 7452.5973s
	iters: 300, epoch: 14 | loss: 0.0247310
	speed: 0.2335s/iter; left time: 7425.1969s
Epoch: 14 cost time: 89.42974805831909
Epoch: 14, Steps: 369 | Train Loss: 0.414 Vali Loss: 2.734 Vali Acc: 0.644 Test Loss: 2.734 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1868246
	speed: 0.6931s/iter; left time: 21925.2277s
	iters: 200, epoch: 15 | loss: 0.0673095
	speed: 0.2270s/iter; left time: 7158.2752s
	iters: 300, epoch: 15 | loss: 0.1935620
	speed: 0.2159s/iter; left time: 6785.4567s
Epoch: 15 cost time: 83.25053811073303
Epoch: 15, Steps: 369 | Train Loss: 0.387 Vali Loss: 2.437 Vali Acc: 0.671 Test Loss: 2.437 Test Acc: 0.671
Validation loss decreased (-0.658040 --> -0.671088).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0034378
	speed: 0.7211s/iter; left time: 22546.0488s
	iters: 200, epoch: 16 | loss: 0.4380400
	speed: 0.2368s/iter; left time: 7378.6252s
	iters: 300, epoch: 16 | loss: 0.1978964
	speed: 0.2425s/iter; left time: 7534.0904s
Epoch: 16 cost time: 89.31352210044861
Epoch: 16, Steps: 369 | Train Loss: 0.354 Vali Loss: 2.401 Vali Acc: 0.668 Test Loss: 2.401 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1080222
	speed: 0.7232s/iter; left time: 22345.1655s
	iters: 200, epoch: 17 | loss: 0.9893022
	speed: 0.2244s/iter; left time: 6910.9094s
	iters: 300, epoch: 17 | loss: 0.6034713
	speed: 0.2328s/iter; left time: 7145.4352s
Epoch: 17 cost time: 85.79137110710144
Epoch: 17, Steps: 369 | Train Loss: 0.333 Vali Loss: 2.951 Vali Acc: 0.669 Test Loss: 2.951 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0064903
	speed: 0.6865s/iter; left time: 20958.2371s
	iters: 200, epoch: 18 | loss: 0.2494438
	speed: 0.2189s/iter; left time: 6660.9907s
	iters: 300, epoch: 18 | loss: 0.0054725
	speed: 0.2301s/iter; left time: 6979.6255s
Epoch: 18 cost time: 84.67572784423828
Epoch: 18, Steps: 369 | Train Loss: 0.334 Vali Loss: 2.692 Vali Acc: 0.641 Test Loss: 2.692 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3446803
	speed: 0.7083s/iter; left time: 21361.1371s
	iters: 200, epoch: 19 | loss: 0.5682504
	speed: 0.2279s/iter; left time: 6851.8897s
	iters: 300, epoch: 19 | loss: 0.0090435
	speed: 0.2397s/iter; left time: 7180.1667s
Epoch: 19 cost time: 87.42626690864563
Epoch: 19, Steps: 369 | Train Loss: 0.307 Vali Loss: 2.422 Vali Acc: 0.638 Test Loss: 2.422 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0381392
	speed: 0.7481s/iter; left time: 22284.5970s
	iters: 200, epoch: 20 | loss: 0.2305792
	speed: 0.2469s/iter; left time: 7331.3352s
	iters: 300, epoch: 20 | loss: 0.3113959
	speed: 0.2522s/iter; left time: 7463.0600s
Epoch: 20 cost time: 92.82385206222534
Epoch: 20, Steps: 369 | Train Loss: 0.266 Vali Loss: 2.592 Vali Acc: 0.644 Test Loss: 2.592 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1987278
	speed: 0.7436s/iter; left time: 21877.8045s
	iters: 200, epoch: 21 | loss: 0.4378270
	speed: 0.2311s/iter; left time: 6775.8164s
	iters: 300, epoch: 21 | loss: 0.2455921
	speed: 0.2346s/iter; left time: 6856.1830s
Epoch: 21 cost time: 86.84542179107666
Epoch: 21, Steps: 369 | Train Loss: 0.236 Vali Loss: 2.989 Vali Acc: 0.648 Test Loss: 2.989 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2427118
	speed: 0.6725s/iter; left time: 19537.6621s
	iters: 200, epoch: 22 | loss: 0.0449938
	speed: 0.2222s/iter; left time: 6434.1995s
	iters: 300, epoch: 22 | loss: 0.0523944
	speed: 0.2217s/iter; left time: 6396.3173s
Epoch: 22 cost time: 81.84331512451172
Epoch: 22, Steps: 369 | Train Loss: 0.203 Vali Loss: 2.697 Vali Acc: 0.650 Test Loss: 2.697 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0086268
	speed: 0.6796s/iter; left time: 19492.5618s
	iters: 200, epoch: 23 | loss: 0.0395833
	speed: 0.2432s/iter; left time: 6950.9295s
	iters: 300, epoch: 23 | loss: 0.3119125
	speed: 0.2444s/iter; left time: 6960.7745s
Epoch: 23 cost time: 89.14643096923828
Epoch: 23, Steps: 369 | Train Loss: 0.185 Vali Loss: 2.884 Vali Acc: 0.624 Test Loss: 2.884 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1468289
	speed: 0.7344s/iter; left time: 20792.9942s
	iters: 200, epoch: 24 | loss: 0.5511603
	speed: 0.2337s/iter; left time: 6593.1846s
	iters: 300, epoch: 24 | loss: 0.1570079
	speed: 0.2387s/iter; left time: 6710.8817s
Epoch: 24 cost time: 87.60307788848877
Epoch: 24, Steps: 369 | Train Loss: 0.172 Vali Loss: 2.232 Vali Acc: 0.649 Test Loss: 2.232 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.6224136
	speed: 0.6959s/iter; left time: 19447.8542s
	iters: 200, epoch: 25 | loss: 0.1234503
	speed: 0.2258s/iter; left time: 6286.9973s
	iters: 300, epoch: 25 | loss: 0.0208152
	speed: 0.2284s/iter; left time: 6336.8891s
Epoch: 25 cost time: 84.68412256240845
Epoch: 25, Steps: 369 | Train Loss: 0.153 Vali Loss: 2.481 Vali Acc: 0.661 Test Loss: 2.481 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5940489
	speed: 0.2469s/iter; left time: 9085.8844s
	iters: 200, epoch: 1 | loss: 0.9174653
	speed: 0.2246s/iter; left time: 8243.3223s
	iters: 300, epoch: 1 | loss: 0.8319712
	speed: 0.2279s/iter; left time: 8340.9858s
Epoch: 1 cost time: 85.46768712997437
Epoch: 1, Steps: 369 | Train Loss: 0.708 Vali Loss: 0.871 Vali Acc: 0.654 Test Loss: 0.871 Test Acc: 0.654
Validation loss decreased (inf --> -0.654361).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3631701
	speed: 0.7064s/iter; left time: 25735.2072s
	iters: 200, epoch: 2 | loss: 1.2738318
	speed: 0.2377s/iter; left time: 8634.8874s
	iters: 300, epoch: 2 | loss: 0.5571424
	speed: 0.2523s/iter; left time: 9141.6758s
Epoch: 2 cost time: 89.21412777900696
Epoch: 2, Steps: 369 | Train Loss: 0.613 Vali Loss: 1.153 Vali Acc: 0.663 Test Loss: 1.153 Test Acc: 0.663
Validation loss decreased (-0.654361 --> -0.662588).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5120385
	speed: 0.7150s/iter; left time: 25784.9021s
	iters: 200, epoch: 3 | loss: 0.2930981
	speed: 0.2420s/iter; left time: 8703.3187s
	iters: 300, epoch: 3 | loss: 0.3335590
	speed: 0.2307s/iter; left time: 8273.4106s
Epoch: 3 cost time: 88.10013437271118
Epoch: 3, Steps: 369 | Train Loss: 0.612 Vali Loss: 1.261 Vali Acc: 0.640 Test Loss: 1.261 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0131846
	speed: 0.7007s/iter; left time: 25010.6787s
	iters: 200, epoch: 4 | loss: 0.9329463
	speed: 0.2335s/iter; left time: 8310.0123s
	iters: 300, epoch: 4 | loss: 0.1576567
	speed: 0.2330s/iter; left time: 8268.8391s
Epoch: 4 cost time: 86.48486709594727
Epoch: 4, Steps: 369 | Train Loss: 0.536 Vali Loss: 1.596 Vali Acc: 0.632 Test Loss: 1.596 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.7016455
	speed: 0.7099s/iter; left time: 25076.0729s
	iters: 200, epoch: 5 | loss: 1.4215343
	speed: 0.2358s/iter; left time: 8305.7470s
	iters: 300, epoch: 5 | loss: 0.5382476
	speed: 0.2381s/iter; left time: 8364.3135s
Epoch: 5 cost time: 87.56952667236328
Epoch: 5, Steps: 369 | Train Loss: 0.550 Vali Loss: 1.800 Vali Acc: 0.619 Test Loss: 1.800 Test Acc: 0.619
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5299451
	speed: 0.7172s/iter; left time: 25071.0331s
	iters: 200, epoch: 6 | loss: 1.0842527
	speed: 0.2377s/iter; left time: 8284.5861s
	iters: 300, epoch: 6 | loss: 0.6823044
	speed: 0.2403s/iter; left time: 8351.7157s
Epoch: 6 cost time: 88.81482863426208
Epoch: 6, Steps: 369 | Train Loss: 0.506 Vali Loss: 1.891 Vali Acc: 0.648 Test Loss: 1.891 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3398373
	speed: 0.7123s/iter; left time: 24637.1836s
	iters: 200, epoch: 7 | loss: 0.3460811
	speed: 0.2365s/iter; left time: 8154.5010s
	iters: 300, epoch: 7 | loss: 0.2876389
	speed: 0.2289s/iter; left time: 7872.7316s
Epoch: 7 cost time: 87.54435801506042
Epoch: 7, Steps: 369 | Train Loss: 0.512 Vali Loss: 1.849 Vali Acc: 0.648 Test Loss: 1.849 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8225153
	speed: 0.7139s/iter; left time: 24427.5845s
	iters: 200, epoch: 8 | loss: 1.8926764
	speed: 0.2411s/iter; left time: 8224.2168s
	iters: 300, epoch: 8 | loss: 1.2790288
	speed: 0.2365s/iter; left time: 8044.1018s
Epoch: 8 cost time: 88.26121115684509
Epoch: 8, Steps: 369 | Train Loss: 0.513 Vali Loss: 1.866 Vali Acc: 0.652 Test Loss: 1.866 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6267834
	speed: 0.7210s/iter; left time: 24406.0710s
	iters: 200, epoch: 9 | loss: 0.2831240
	speed: 0.2364s/iter; left time: 7978.6553s
	iters: 300, epoch: 9 | loss: 0.1231945
	speed: 0.2299s/iter; left time: 7736.7128s
Epoch: 9 cost time: 86.26282215118408
Epoch: 9, Steps: 369 | Train Loss: 0.471 Vali Loss: 2.213 Vali Acc: 0.628 Test Loss: 2.213 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5246690
	speed: 0.6885s/iter; left time: 23051.0841s
	iters: 200, epoch: 10 | loss: 0.1343792
	speed: 0.2296s/iter; left time: 7665.6116s
	iters: 300, epoch: 10 | loss: 0.2157848
	speed: 0.2390s/iter; left time: 7953.4693s
Epoch: 10 cost time: 87.21030116081238
Epoch: 10, Steps: 369 | Train Loss: 0.468 Vali Loss: 1.927 Vali Acc: 0.622 Test Loss: 1.927 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0723570
	speed: 0.7139s/iter; left time: 23639.4571s
	iters: 200, epoch: 11 | loss: 0.1740756
	speed: 0.2436s/iter; left time: 8041.3974s
	iters: 300, epoch: 11 | loss: 0.4285216
	speed: 0.2472s/iter; left time: 8136.6830s
Epoch: 11 cost time: 90.4536280632019
Epoch: 11, Steps: 369 | Train Loss: 0.411 Vali Loss: 2.154 Vali Acc: 0.629 Test Loss: 2.154 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1611525
	speed: 0.7356s/iter; left time: 24086.4533s
	iters: 200, epoch: 12 | loss: 0.2268209
	speed: 0.2596s/iter; left time: 8474.4952s
	iters: 300, epoch: 12 | loss: 0.5393342
	speed: 0.2374s/iter; left time: 7725.8745s
Epoch: 12 cost time: 90.70164179801941
Epoch: 12, Steps: 369 | Train Loss: 0.425 Vali Loss: 2.275 Vali Acc: 0.629 Test Loss: 2.275 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6625993189557321
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6750055
	speed: 0.2680s/iter; left time: 9862.2558s
	iters: 200, epoch: 1 | loss: 0.8402173
	speed: 0.2361s/iter; left time: 8665.9916s
	iters: 300, epoch: 1 | loss: 0.7236490
	speed: 0.2309s/iter; left time: 8452.4432s
Epoch: 1 cost time: 90.09665203094482
Epoch: 1, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.854 Vali Acc: 0.663 Test Loss: 0.854 Test Acc: 0.663
Validation loss decreased (inf --> -0.662875).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3282586
	speed: 0.7254s/iter; left time: 26427.2216s
	iters: 200, epoch: 2 | loss: 1.2926350
	speed: 0.2599s/iter; left time: 9444.2765s
	iters: 300, epoch: 2 | loss: 0.4770626
	speed: 0.2589s/iter; left time: 9382.0577s
Epoch: 2 cost time: 97.04015278816223
Epoch: 2, Steps: 369 | Train Loss: 0.624 Vali Loss: 1.058 Vali Acc: 0.678 Test Loss: 1.058 Test Acc: 0.678
Validation loss decreased (-0.662875 --> -0.678196).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3542332
	speed: 0.7734s/iter; left time: 27892.9258s
	iters: 200, epoch: 3 | loss: 0.4015276
	speed: 0.2420s/iter; left time: 8701.3593s
	iters: 300, epoch: 3 | loss: 0.4321640
	speed: 0.2475s/iter; left time: 8877.3621s
Epoch: 3 cost time: 91.97396540641785
Epoch: 3, Steps: 369 | Train Loss: 0.593 Vali Loss: 1.102 Vali Acc: 0.657 Test Loss: 1.102 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3903116
	speed: 0.7267s/iter; left time: 25939.4538s
	iters: 200, epoch: 4 | loss: 0.9962661
	speed: 0.2548s/iter; left time: 9068.5818s
	iters: 300, epoch: 4 | loss: 0.2165801
	speed: 0.2422s/iter; left time: 8595.5662s
Epoch: 4 cost time: 92.44544005393982
Epoch: 4, Steps: 369 | Train Loss: 0.525 Vali Loss: 1.423 Vali Acc: 0.650 Test Loss: 1.423 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4503426
	speed: 0.7539s/iter; left time: 26633.2171s
	iters: 200, epoch: 5 | loss: 0.3904629
	speed: 0.2644s/iter; left time: 9312.6590s
	iters: 300, epoch: 5 | loss: 0.0504755
	speed: 0.2636s/iter; left time: 9259.3577s
Epoch: 5 cost time: 96.91162848472595
Epoch: 5, Steps: 369 | Train Loss: 0.531 Vali Loss: 2.349 Vali Acc: 0.562 Test Loss: 2.349 Test Acc: 0.562
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5441918
	speed: 0.7528s/iter; left time: 26313.5881s
	iters: 200, epoch: 6 | loss: 0.7405545
	speed: 0.2685s/iter; left time: 9358.1513s
	iters: 300, epoch: 6 | loss: 0.3147908
	speed: 0.2545s/iter; left time: 8846.9216s
Epoch: 6 cost time: 97.54915308952332
Epoch: 6, Steps: 369 | Train Loss: 0.496 Vali Loss: 2.337 Vali Acc: 0.601 Test Loss: 2.337 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9069219
	speed: 0.7716s/iter; left time: 26688.1674s
	iters: 200, epoch: 7 | loss: 1.0962540
	speed: 0.2386s/iter; left time: 8230.1750s
	iters: 300, epoch: 7 | loss: 0.2059756
	speed: 0.2437s/iter; left time: 8381.8179s
Epoch: 7 cost time: 90.06321406364441
Epoch: 7, Steps: 369 | Train Loss: 0.502 Vali Loss: 1.693 Vali Acc: 0.664 Test Loss: 1.693 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0128692
	speed: 0.7201s/iter; left time: 24641.5681s
	iters: 200, epoch: 8 | loss: 0.0442841
	speed: 0.2578s/iter; left time: 8796.8427s
	iters: 300, epoch: 8 | loss: 0.1492518
	speed: 0.2455s/iter; left time: 8351.3660s
Epoch: 8 cost time: 93.2954638004303
Epoch: 8, Steps: 369 | Train Loss: 0.468 Vali Loss: 1.922 Vali Acc: 0.669 Test Loss: 1.922 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.2634576
	speed: 0.7054s/iter; left time: 23877.3887s
	iters: 200, epoch: 9 | loss: 0.9439662
	speed: 0.2309s/iter; left time: 7791.3806s
	iters: 300, epoch: 9 | loss: 0.1860347
	speed: 0.2369s/iter; left time: 7971.2552s
Epoch: 9 cost time: 85.67692041397095
Epoch: 9, Steps: 369 | Train Loss: 0.483 Vali Loss: 1.952 Vali Acc: 0.640 Test Loss: 1.952 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2579896
	speed: 0.7690s/iter; left time: 25745.5318s
	iters: 200, epoch: 10 | loss: 0.0305756
	speed: 0.2589s/iter; left time: 8642.1363s
	iters: 300, epoch: 10 | loss: 0.4520273
	speed: 0.2607s/iter; left time: 8674.5302s
Epoch: 10 cost time: 99.2593126296997
Epoch: 10, Steps: 369 | Train Loss: 0.460 Vali Loss: 1.789 Vali Acc: 0.636 Test Loss: 1.789 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1052808
	speed: 0.7719s/iter; left time: 25558.3474s
	iters: 200, epoch: 11 | loss: 0.2295312
	speed: 0.2388s/iter; left time: 7883.5260s
	iters: 300, epoch: 11 | loss: 0.1694968
	speed: 0.2517s/iter; left time: 8282.9351s
Epoch: 11 cost time: 90.44777584075928
Epoch: 11, Steps: 369 | Train Loss: 0.374 Vali Loss: 1.650 Vali Acc: 0.642 Test Loss: 1.650 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.4255039
	speed: 0.7000s/iter; left time: 22918.9772s
	iters: 200, epoch: 12 | loss: 0.1412958
	speed: 0.2426s/iter; left time: 7918.0135s
	iters: 300, epoch: 12 | loss: 0.5182731
	speed: 0.2616s/iter; left time: 8513.8522s
Epoch: 12 cost time: 91.47548818588257
Epoch: 12, Steps: 369 | Train Loss: 0.340 Vali Loss: 1.549 Vali Acc: 0.646 Test Loss: 1.549 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6931795
	speed: 0.2525s/iter; left time: 9291.2314s
	iters: 200, epoch: 1 | loss: 0.6931638
	speed: 0.2547s/iter; left time: 9348.9527s
	iters: 300, epoch: 1 | loss: 0.6931975
	speed: 0.2479s/iter; left time: 9075.1771s
Epoch: 1 cost time: 92.82977509498596
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6941800
	speed: 0.7469s/iter; left time: 27212.0232s
	iters: 200, epoch: 2 | loss: 0.6931981
	speed: 0.2478s/iter; left time: 9004.2412s
	iters: 300, epoch: 2 | loss: 0.6934303
	speed: 0.2531s/iter; left time: 9169.7933s
Epoch: 2 cost time: 91.9607949256897
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6941380
	speed: 0.7206s/iter; left time: 25987.5098s
	iters: 200, epoch: 3 | loss: 0.6936508
	speed: 0.2394s/iter; left time: 8611.2614s
	iters: 300, epoch: 3 | loss: 0.6942674
	speed: 0.2484s/iter; left time: 8909.2982s
Epoch: 3 cost time: 90.12480044364929
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6931520
	speed: 0.7195s/iter; left time: 25682.9199s
	iters: 200, epoch: 4 | loss: 0.6914341
	speed: 0.2470s/iter; left time: 8790.0151s
	iters: 300, epoch: 4 | loss: 0.6926113
	speed: 0.2365s/iter; left time: 8392.7010s
Epoch: 4 cost time: 89.71454977989197
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6931486
	speed: 0.7006s/iter; left time: 24747.8203s
	iters: 200, epoch: 5 | loss: 0.6931551
	speed: 0.2394s/iter; left time: 8432.5240s
	iters: 300, epoch: 5 | loss: 0.6927393
	speed: 0.2592s/iter; left time: 9105.0104s
Epoch: 5 cost time: 91.38164448738098
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6923010
	speed: 0.7734s/iter; left time: 27033.3856s
	iters: 200, epoch: 6 | loss: 0.6931834
	speed: 0.2780s/iter; left time: 9691.0753s
	iters: 300, epoch: 6 | loss: 0.6931564
	speed: 0.2643s/iter; left time: 9184.3749s
Epoch: 6 cost time: 98.78722143173218
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6931623
	speed: 0.7591s/iter; left time: 26256.6542s
	iters: 200, epoch: 7 | loss: 0.6945054
	speed: 0.2503s/iter; left time: 8633.4423s
	iters: 300, epoch: 7 | loss: 0.6928412
	speed: 0.2477s/iter; left time: 8517.5031s
Epoch: 7 cost time: 94.04291439056396
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6931515
	speed: 0.7404s/iter; left time: 25334.5855s
	iters: 200, epoch: 8 | loss: 0.6934763
	speed: 0.2691s/iter; left time: 9180.4494s
	iters: 300, epoch: 8 | loss: 0.6921513
	speed: 0.2696s/iter; left time: 9171.5656s
Epoch: 8 cost time: 99.19434261322021
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6923845
	speed: 0.8060s/iter; left time: 27282.4969s
	iters: 200, epoch: 9 | loss: 0.6934136
	speed: 0.2582s/iter; left time: 8714.6460s
	iters: 300, epoch: 9 | loss: 0.6937568
	speed: 0.2596s/iter; left time: 8735.2238s
Epoch: 9 cost time: 97.23952150344849
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6934633
	speed: 0.7825s/iter; left time: 26199.4551s
	iters: 200, epoch: 10 | loss: 0.6933364
	speed: 0.2573s/iter; left time: 8587.0516s
	iters: 300, epoch: 10 | loss: 0.6931614
	speed: 0.2566s/iter; left time: 8541.2025s
Epoch: 10 cost time: 94.46035575866699
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6935858
	speed: 0.7371s/iter; left time: 24407.2158s
	iters: 200, epoch: 11 | loss: 0.6932348
	speed: 0.2469s/iter; left time: 8151.3058s
	iters: 300, epoch: 11 | loss: 0.6930082
	speed: 0.2439s/iter; left time: 8027.9436s
Epoch: 11 cost time: 92.36059665679932
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 2596098
model size : 19.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8659801
	speed: 0.2563s/iter; left time: 9433.8369s
	iters: 200, epoch: 1 | loss: 0.6551403
	speed: 0.2414s/iter; left time: 8861.2639s
	iters: 300, epoch: 1 | loss: 1.1166960
	speed: 0.2500s/iter; left time: 9149.4296s
Epoch: 1 cost time: 93.93276619911194
Epoch: 1, Steps: 369 | Train Loss: 0.667 Vali Loss: 0.865 Vali Acc: 0.635 Test Loss: 0.865 Test Acc: 0.635
Validation loss decreased (inf --> -0.634498).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2228822
	speed: 0.8026s/iter; left time: 29242.0611s
	iters: 200, epoch: 2 | loss: 0.3408943
	speed: 0.2647s/iter; left time: 9615.7803s
	iters: 300, epoch: 2 | loss: 0.5425950
	speed: 0.2608s/iter; left time: 9448.6933s
Epoch: 2 cost time: 97.50079536437988
Epoch: 2, Steps: 369 | Train Loss: 0.586 Vali Loss: 1.116 Vali Acc: 0.621 Test Loss: 1.116 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4577281
	speed: 0.7542s/iter; left time: 27199.6099s
	iters: 200, epoch: 3 | loss: 0.5954194
	speed: 0.2463s/iter; left time: 8856.3246s
	iters: 300, epoch: 3 | loss: 0.6736188
	speed: 0.2422s/iter; left time: 8685.7287s
Epoch: 3 cost time: 91.58866167068481
Epoch: 3, Steps: 369 | Train Loss: 0.515 Vali Loss: 1.328 Vali Acc: 0.632 Test Loss: 1.328 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2119886
	speed: 0.7809s/iter; left time: 27872.4796s
	iters: 200, epoch: 4 | loss: 0.6006644
	speed: 0.2669s/iter; left time: 9499.6736s
	iters: 300, epoch: 4 | loss: 0.0864301
	speed: 0.2634s/iter; left time: 9349.5674s
Epoch: 4 cost time: 99.46321129798889
Epoch: 4, Steps: 369 | Train Loss: 0.491 Vali Loss: 1.748 Vali Acc: 0.627 Test Loss: 1.748 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0714332
	speed: 0.7767s/iter; left time: 27438.5374s
	iters: 200, epoch: 5 | loss: 0.4724632
	speed: 0.2632s/iter; left time: 9272.0952s
	iters: 300, epoch: 5 | loss: 0.1678666
	speed: 0.2628s/iter; left time: 9232.5305s
Epoch: 5 cost time: 98.11076140403748
Epoch: 5, Steps: 369 | Train Loss: 0.525 Vali Loss: 1.858 Vali Acc: 0.627 Test Loss: 1.858 Test Acc: 0.627
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5051711
	speed: 0.7979s/iter; left time: 27891.6851s
	iters: 200, epoch: 6 | loss: 1.3090968
	speed: 0.2823s/iter; left time: 9840.6585s
	iters: 300, epoch: 6 | loss: 0.2740956
	speed: 0.2653s/iter; left time: 9221.1500s
Epoch: 6 cost time: 99.96312475204468
Epoch: 6, Steps: 369 | Train Loss: 0.460 Vali Loss: 2.077 Vali Acc: 0.617 Test Loss: 2.077 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.3072544
	speed: 0.7653s/iter; left time: 26469.7638s
	iters: 200, epoch: 7 | loss: 0.3964535
	speed: 0.2379s/iter; left time: 8205.6857s
	iters: 300, epoch: 7 | loss: 0.9751444
	speed: 0.2622s/iter; left time: 9015.8262s
Epoch: 7 cost time: 92.75271105766296
Epoch: 7, Steps: 369 | Train Loss: 0.438 Vali Loss: 1.987 Vali Acc: 0.650 Test Loss: 1.987 Test Acc: 0.650
Validation loss decreased (-0.634498 --> -0.649810).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0121685
	speed: 0.7456s/iter; left time: 25513.2994s
	iters: 200, epoch: 8 | loss: 0.5407539
	speed: 0.2644s/iter; left time: 9020.0987s
	iters: 300, epoch: 8 | loss: 0.1907949
	speed: 0.2650s/iter; left time: 9013.2285s
Epoch: 8 cost time: 97.13838291168213
Epoch: 8, Steps: 369 | Train Loss: 0.448 Vali Loss: 2.381 Vali Acc: 0.642 Test Loss: 2.381 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5384886
	speed: 0.8059s/iter; left time: 27278.4683s
	iters: 200, epoch: 9 | loss: 0.0042600
	speed: 0.2685s/iter; left time: 9063.2009s
	iters: 300, epoch: 9 | loss: 1.1638659
	speed: 0.2676s/iter; left time: 9004.9480s
Epoch: 9 cost time: 99.60030961036682
Epoch: 9, Steps: 369 | Train Loss: 0.415 Vali Loss: 2.337 Vali Acc: 0.639 Test Loss: 2.337 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5250649
	speed: 0.7970s/iter; left time: 26682.6036s
	iters: 200, epoch: 10 | loss: 1.2670913
	speed: 0.2565s/iter; left time: 8561.1475s
	iters: 300, epoch: 10 | loss: 0.0054227
	speed: 0.2549s/iter; left time: 8481.6355s
Epoch: 10 cost time: 97.57600545883179
Epoch: 10, Steps: 369 | Train Loss: 0.393 Vali Loss: 3.012 Vali Acc: 0.624 Test Loss: 3.012 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5597551
	speed: 0.8094s/iter; left time: 26800.8722s
	iters: 200, epoch: 11 | loss: 0.0092006
	speed: 0.2718s/iter; left time: 8973.5210s
	iters: 300, epoch: 11 | loss: 1.5622333
	speed: 0.2651s/iter; left time: 8723.1620s
Epoch: 11 cost time: 97.37143588066101
Epoch: 11, Steps: 369 | Train Loss: 0.436 Vali Loss: 2.613 Vali Acc: 0.640 Test Loss: 2.613 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0072862
	speed: 0.7656s/iter; left time: 25066.2481s
	iters: 200, epoch: 12 | loss: 0.0006801
	speed: 0.2357s/iter; left time: 7692.1634s
	iters: 300, epoch: 12 | loss: 0.5848243
	speed: 0.2515s/iter; left time: 8183.5658s
Epoch: 12 cost time: 94.0081422328949
Epoch: 12, Steps: 369 | Train Loss: 0.354 Vali Loss: 2.621 Vali Acc: 0.648 Test Loss: 2.621 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0443713
	speed: 0.7832s/iter; left time: 25353.3611s
	iters: 200, epoch: 13 | loss: 0.3778724
	speed: 0.2397s/iter; left time: 7737.1637s
	iters: 300, epoch: 13 | loss: 0.2601572
	speed: 0.2412s/iter; left time: 7760.7747s
Epoch: 13 cost time: 92.03834247589111
Epoch: 13, Steps: 369 | Train Loss: 0.345 Vali Loss: 2.672 Vali Acc: 0.659 Test Loss: 2.672 Test Acc: 0.659
Validation loss decreased (-0.649810 --> -0.658600).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0278554
	speed: 0.7247s/iter; left time: 23194.7013s
	iters: 200, epoch: 14 | loss: 0.2531524
	speed: 0.2376s/iter; left time: 7580.3519s
	iters: 300, epoch: 14 | loss: 0.3928091
	speed: 0.2405s/iter; left time: 7649.4876s
Epoch: 14 cost time: 88.79728627204895
Epoch: 14, Steps: 369 | Train Loss: 0.359 Vali Loss: 2.966 Vali Acc: 0.657 Test Loss: 2.966 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4165239
	speed: 0.7130s/iter; left time: 22556.6830s
	iters: 200, epoch: 15 | loss: 0.4347998
	speed: 0.2322s/iter; left time: 7321.5493s
	iters: 300, epoch: 15 | loss: 0.1585020
	speed: 0.2360s/iter; left time: 7419.2081s
Epoch: 15 cost time: 87.23191928863525
Epoch: 15, Steps: 369 | Train Loss: 0.375 Vali Loss: 2.975 Vali Acc: 0.646 Test Loss: 2.975 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4099734
	speed: 0.6919s/iter; left time: 21634.0656s
	iters: 200, epoch: 16 | loss: 0.0166067
	speed: 0.2242s/iter; left time: 6986.0687s
	iters: 300, epoch: 16 | loss: 0.0001546
	speed: 0.2303s/iter; left time: 7155.5654s
Epoch: 16 cost time: 84.96480202674866
Epoch: 16, Steps: 369 | Train Loss: 0.320 Vali Loss: 2.668 Vali Acc: 0.656 Test Loss: 2.668 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0299183
	speed: 0.6944s/iter; left time: 21454.9646s
	iters: 200, epoch: 17 | loss: 0.2432208
	speed: 0.2455s/iter; left time: 7560.8469s
	iters: 300, epoch: 17 | loss: 0.0936766
	speed: 0.2494s/iter; left time: 7654.4738s
Epoch: 17 cost time: 90.88087010383606
Epoch: 17, Steps: 369 | Train Loss: 0.351 Vali Loss: 3.464 Vali Acc: 0.650 Test Loss: 3.464 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0003732
	speed: 0.7618s/iter; left time: 23256.3537s
	iters: 200, epoch: 18 | loss: 0.1836340
	speed: 0.2486s/iter; left time: 7564.0918s
	iters: 300, epoch: 18 | loss: 0.1829287
	speed: 0.2348s/iter; left time: 7122.2419s
Epoch: 18 cost time: 90.75166153907776
Epoch: 18, Steps: 369 | Train Loss: 0.300 Vali Loss: 3.190 Vali Acc: 0.635 Test Loss: 3.190 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0293508
	speed: 0.7156s/iter; left time: 21581.2788s
	iters: 200, epoch: 19 | loss: 0.3380114
	speed: 0.2332s/iter; left time: 7010.1957s
	iters: 300, epoch: 19 | loss: 0.9194711
	speed: 0.2379s/iter; left time: 7126.2029s
Epoch: 19 cost time: 87.55042290687561
Epoch: 19, Steps: 369 | Train Loss: 0.290 Vali Loss: 2.991 Vali Acc: 0.655 Test Loss: 2.991 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7398578
	speed: 0.7105s/iter; left time: 21164.5163s
	iters: 200, epoch: 20 | loss: 0.3736579
	speed: 0.2475s/iter; left time: 7349.2761s
	iters: 300, epoch: 20 | loss: 0.3756835
	speed: 0.2420s/iter; left time: 7159.3200s
Epoch: 20 cost time: 90.29026794433594
Epoch: 20, Steps: 369 | Train Loss: 0.306 Vali Loss: 3.182 Vali Acc: 0.643 Test Loss: 3.182 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0239294
	speed: 0.7371s/iter; left time: 21685.6328s
	iters: 200, epoch: 21 | loss: 0.3121489
	speed: 0.2440s/iter; left time: 7154.8051s
	iters: 300, epoch: 21 | loss: 0.1780064
	speed: 0.2515s/iter; left time: 7347.9914s
Epoch: 21 cost time: 92.02211737632751
Epoch: 21, Steps: 369 | Train Loss: 0.286 Vali Loss: 3.243 Vali Acc: 0.655 Test Loss: 3.243 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0398366
	speed: 0.7425s/iter; left time: 21572.5220s
	iters: 200, epoch: 22 | loss: 0.2905957
	speed: 0.2310s/iter; left time: 6686.6484s
	iters: 300, epoch: 22 | loss: 0.9244882
	speed: 0.2295s/iter; left time: 6620.7405s
Epoch: 22 cost time: 88.48263049125671
Epoch: 22, Steps: 369 | Train Loss: 0.287 Vali Loss: 3.245 Vali Acc: 0.628 Test Loss: 3.245 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0206483
	speed: 0.6944s/iter; left time: 19917.7295s
	iters: 200, epoch: 23 | loss: 0.2352426
	speed: 0.2354s/iter; left time: 6727.6809s
	iters: 300, epoch: 23 | loss: 0.8009103
	speed: 0.2427s/iter; left time: 6911.6993s
Epoch: 23 cost time: 87.83178043365479
Epoch: 23, Steps: 369 | Train Loss: 0.224 Vali Loss: 3.184 Vali Acc: 0.659 Test Loss: 3.184 Test Acc: 0.659
Validation loss decreased (-0.658600 --> -0.659446).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1479432
	speed: 0.7180s/iter; left time: 20328.9076s
	iters: 200, epoch: 24 | loss: 0.1945331
	speed: 0.2301s/iter; left time: 6491.9527s
	iters: 300, epoch: 24 | loss: 0.4570231
	speed: 0.2427s/iter; left time: 6821.9973s
Epoch: 24 cost time: 88.13686895370483
Epoch: 24, Steps: 369 | Train Loss: 0.228 Vali Loss: 2.946 Vali Acc: 0.653 Test Loss: 2.946 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.2302142
	speed: 0.7152s/iter; left time: 19985.7649s
	iters: 200, epoch: 25 | loss: 0.0700017
	speed: 0.2487s/iter; left time: 6926.3522s
	iters: 300, epoch: 25 | loss: 0.4184408
	speed: 0.2424s/iter; left time: 6725.4592s
Epoch: 25 cost time: 90.57259345054626
Epoch: 25, Steps: 369 | Train Loss: 0.248 Vali Loss: 3.256 Vali Acc: 0.632 Test Loss: 3.256 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0008024
	speed: 0.7241s/iter; left time: 19969.1189s
	iters: 200, epoch: 26 | loss: 0.0257942
	speed: 0.2462s/iter; left time: 6764.6607s
	iters: 300, epoch: 26 | loss: 0.1514077
	speed: 0.2472s/iter; left time: 6768.1462s
Epoch: 26 cost time: 90.25916647911072
Epoch: 26, Steps: 369 | Train Loss: 0.198 Vali Loss: 2.956 Vali Acc: 0.648 Test Loss: 2.956 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3294960
	speed: 0.7389s/iter; left time: 20102.0458s
	iters: 200, epoch: 27 | loss: 0.5403881
	speed: 0.2481s/iter; left time: 6725.0474s
	iters: 300, epoch: 27 | loss: 0.0089607
	speed: 0.2388s/iter; left time: 6449.9981s
Epoch: 27 cost time: 90.08540773391724
Epoch: 27, Steps: 369 | Train Loss: 0.180 Vali Loss: 3.100 Vali Acc: 0.665 Test Loss: 3.100 Test Acc: 0.665
Validation loss decreased (-0.659446 --> -0.665406).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.2703003
	speed: 0.7037s/iter; left time: 18886.6438s
	iters: 200, epoch: 28 | loss: 0.0003097
	speed: 0.2380s/iter; left time: 6364.4716s
	iters: 300, epoch: 28 | loss: 0.0961532
	speed: 0.2297s/iter; left time: 6119.8202s
Epoch: 28 cost time: 86.88993120193481
Epoch: 28, Steps: 369 | Train Loss: 0.172 Vali Loss: 2.985 Vali Acc: 0.645 Test Loss: 2.985 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0009485
	speed: 0.7272s/iter; left time: 19249.1758s
	iters: 200, epoch: 29 | loss: 0.0134548
	speed: 0.2583s/iter; left time: 6811.3897s
	iters: 300, epoch: 29 | loss: 0.4423329
	speed: 0.2586s/iter; left time: 6794.2297s
Epoch: 29 cost time: 94.09660792350769
Epoch: 29, Steps: 369 | Train Loss: 0.149 Vali Loss: 2.765 Vali Acc: 0.652 Test Loss: 2.765 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0023459
	speed: 0.7154s/iter; left time: 18670.8316s
	iters: 200, epoch: 30 | loss: 0.0001990
	speed: 0.2373s/iter; left time: 6169.1864s
	iters: 300, epoch: 30 | loss: 0.0118078
	speed: 0.2419s/iter; left time: 6264.7150s
Epoch: 30 cost time: 89.28640341758728
Epoch: 30, Steps: 369 | Train Loss: 0.132 Vali Loss: 2.966 Vali Acc: 0.635 Test Loss: 2.966 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.2675183
	speed: 0.6849s/iter; left time: 17623.2588s
	iters: 200, epoch: 31 | loss: 0.0002690
	speed: 0.2305s/iter; left time: 5907.0710s
	iters: 300, epoch: 31 | loss: 0.3781764
	speed: 0.2329s/iter; left time: 5946.6494s
Epoch: 31 cost time: 85.60352420806885
Epoch: 31, Steps: 369 | Train Loss: 0.127 Vali Loss: 2.929 Vali Acc: 0.640 Test Loss: 2.929 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.1226561
	speed: 0.6906s/iter; left time: 17513.8569s
	iters: 200, epoch: 32 | loss: 0.0010476
	speed: 0.2386s/iter; left time: 6026.7062s
	iters: 300, epoch: 32 | loss: 0.0945593
	speed: 0.2361s/iter; left time: 5939.9348s
Epoch: 32 cost time: 88.98157477378845
Epoch: 32, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.799 Vali Acc: 0.647 Test Loss: 2.799 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0037322
	speed: 0.7640s/iter; left time: 19095.0037s
	iters: 200, epoch: 33 | loss: 0.0573712
	speed: 0.2510s/iter; left time: 6247.6890s
	iters: 300, epoch: 33 | loss: 0.0083863
	speed: 0.2458s/iter; left time: 6093.6052s
Epoch: 33 cost time: 92.34032797813416
Epoch: 33, Steps: 369 | Train Loss: 0.101 Vali Loss: 2.865 Vali Acc: 0.646 Test Loss: 2.865 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0830993
	speed: 0.7353s/iter; left time: 18105.7366s
	iters: 200, epoch: 34 | loss: 0.0012404
	speed: 0.2545s/iter; left time: 6241.8983s
	iters: 300, epoch: 34 | loss: 0.0246132
	speed: 0.2485s/iter; left time: 6070.2535s
Epoch: 34 cost time: 91.80441093444824
Epoch: 34, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.590 Vali Acc: 0.661 Test Loss: 2.590 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.1136006
	speed: 0.7435s/iter; left time: 18034.7253s
	iters: 200, epoch: 35 | loss: 0.0992782
	speed: 0.2400s/iter; left time: 5797.0918s
	iters: 300, epoch: 35 | loss: 0.1195350
	speed: 0.2514s/iter; left time: 6046.3390s
Epoch: 35 cost time: 92.23601365089417
Epoch: 35, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.998 Vali Acc: 0.651 Test Loss: 2.998 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0013648
	speed: 0.8075s/iter; left time: 19288.3158s
	iters: 200, epoch: 36 | loss: 0.0179333
	speed: 0.2528s/iter; left time: 6013.6771s
	iters: 300, epoch: 36 | loss: 0.0061422
	speed: 0.2384s/iter; left time: 5647.2592s
Epoch: 36 cost time: 93.37835335731506
Epoch: 36, Steps: 369 | Train Loss: 0.060 Vali Loss: 2.886 Vali Acc: 0.658 Test Loss: 2.886 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.1216212
	speed: 0.7441s/iter; left time: 17498.4845s
	iters: 200, epoch: 37 | loss: 0.0107998
	speed: 0.2497s/iter; left time: 5846.3138s
	iters: 300, epoch: 37 | loss: 0.0397105
	speed: 0.2466s/iter; left time: 5750.1365s
Epoch: 37 cost time: 92.38012218475342
Epoch: 37, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.736 Vali Acc: 0.630 Test Loss: 2.736 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9112497
	speed: 0.2572s/iter; left time: 9465.4615s
	iters: 200, epoch: 1 | loss: 0.8197065
	speed: 0.2269s/iter; left time: 8326.8987s
	iters: 300, epoch: 1 | loss: 1.0695192
	speed: 0.2529s/iter; left time: 9257.3201s
Epoch: 1 cost time: 90.7256600856781
Epoch: 1, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.847 Vali Acc: 0.639 Test Loss: 0.847 Test Acc: 0.639
Validation loss decreased (inf --> -0.639322).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2449705
	speed: 0.7316s/iter; left time: 26654.1673s
	iters: 200, epoch: 2 | loss: 0.2512560
	speed: 0.2724s/iter; left time: 9895.2539s
	iters: 300, epoch: 2 | loss: 0.3114224
	speed: 0.2644s/iter; left time: 9579.0060s
Epoch: 2 cost time: 97.77499032020569
Epoch: 2, Steps: 369 | Train Loss: 0.574 Vali Loss: 1.165 Vali Acc: 0.633 Test Loss: 1.165 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4263130
	speed: 0.7559s/iter; left time: 27259.3889s
	iters: 200, epoch: 3 | loss: 0.5555875
	speed: 0.2380s/iter; left time: 8558.5452s
	iters: 300, epoch: 3 | loss: 1.3000129
	speed: 0.2577s/iter; left time: 9243.6060s
Epoch: 3 cost time: 91.25148844718933
Epoch: 3, Steps: 369 | Train Loss: 0.536 Vali Loss: 1.589 Vali Acc: 0.609 Test Loss: 1.589 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6745407
	speed: 0.7051s/iter; left time: 25166.6890s
	iters: 200, epoch: 4 | loss: 0.8088101
	speed: 0.2396s/iter; left time: 8527.0726s
	iters: 300, epoch: 4 | loss: 0.1933215
	speed: 0.2452s/iter; left time: 8704.8083s
Epoch: 4 cost time: 92.1285753250122
Epoch: 4, Steps: 369 | Train Loss: 0.521 Vali Loss: 1.891 Vali Acc: 0.605 Test Loss: 1.891 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4849893
	speed: 0.7574s/iter; left time: 26756.6664s
	iters: 200, epoch: 5 | loss: 0.5114427
	speed: 0.2294s/iter; left time: 8080.8275s
	iters: 300, epoch: 5 | loss: 0.0986701
	speed: 0.2513s/iter; left time: 8826.1382s
Epoch: 5 cost time: 92.05217933654785
Epoch: 5, Steps: 369 | Train Loss: 0.499 Vali Loss: 2.121 Vali Acc: 0.619 Test Loss: 2.121 Test Acc: 0.619
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2869737
	speed: 0.7492s/iter; left time: 26190.6913s
	iters: 200, epoch: 6 | loss: 0.4323172
	speed: 0.2429s/iter; left time: 8467.4332s
	iters: 300, epoch: 6 | loss: 0.2330756
	speed: 0.2395s/iter; left time: 8322.7987s
Epoch: 6 cost time: 91.17321801185608
Epoch: 6, Steps: 369 | Train Loss: 0.475 Vali Loss: 1.958 Vali Acc: 0.620 Test Loss: 1.958 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.4669849
	speed: 0.7178s/iter; left time: 24827.1480s
	iters: 200, epoch: 7 | loss: 0.2323746
	speed: 0.2270s/iter; left time: 7828.1980s
	iters: 300, epoch: 7 | loss: 0.4021557
	speed: 0.2450s/iter; left time: 8425.6722s
Epoch: 7 cost time: 85.75076961517334
Epoch: 7, Steps: 369 | Train Loss: 0.467 Vali Loss: 2.199 Vali Acc: 0.630 Test Loss: 2.199 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8748008
	speed: 0.7368s/iter; left time: 25212.5244s
	iters: 200, epoch: 8 | loss: 1.1131397
	speed: 0.2513s/iter; left time: 8572.9737s
	iters: 300, epoch: 8 | loss: 0.3335169
	speed: 0.2501s/iter; left time: 8508.4811s
Epoch: 8 cost time: 95.09549498558044
Epoch: 8, Steps: 369 | Train Loss: 0.441 Vali Loss: 2.002 Vali Acc: 0.645 Test Loss: 2.002 Test Acc: 0.645
Validation loss decreased (-0.639322 --> -0.645269).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4454532
	speed: 0.7322s/iter; left time: 24783.6187s
	iters: 200, epoch: 9 | loss: 0.1133728
	speed: 0.2359s/iter; left time: 7961.9981s
	iters: 300, epoch: 9 | loss: 0.1001257
	speed: 0.2402s/iter; left time: 8081.4123s
Epoch: 9 cost time: 88.02482509613037
Epoch: 9, Steps: 369 | Train Loss: 0.380 Vali Loss: 2.462 Vali Acc: 0.655 Test Loss: 2.462 Test Acc: 0.655
Validation loss decreased (-0.645269 --> -0.654629).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3525094
	speed: 0.7098s/iter; left time: 23763.1246s
	iters: 200, epoch: 10 | loss: 0.4434987
	speed: 0.2247s/iter; left time: 7499.0433s
	iters: 300, epoch: 10 | loss: 0.5744990
	speed: 0.2304s/iter; left time: 7666.9719s
Epoch: 10 cost time: 83.34750127792358
Epoch: 10, Steps: 369 | Train Loss: 0.378 Vali Loss: 2.730 Vali Acc: 0.640 Test Loss: 2.730 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5711332
	speed: 0.6787s/iter; left time: 22472.9063s
	iters: 200, epoch: 11 | loss: 0.2299984
	speed: 0.2291s/iter; left time: 7562.2332s
	iters: 300, epoch: 11 | loss: 0.3381977
	speed: 0.2477s/iter; left time: 8152.3802s
Epoch: 11 cost time: 87.54111886024475
Epoch: 11, Steps: 369 | Train Loss: 0.418 Vali Loss: 2.351 Vali Acc: 0.640 Test Loss: 2.351 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0148518
	speed: 0.7546s/iter; left time: 24708.1498s
	iters: 200, epoch: 12 | loss: 0.5162290
	speed: 0.2471s/iter; left time: 8067.3861s
	iters: 300, epoch: 12 | loss: 1.0295718
	speed: 0.2386s/iter; left time: 7766.1073s
Epoch: 12 cost time: 91.56272768974304
Epoch: 12, Steps: 369 | Train Loss: 0.369 Vali Loss: 2.528 Vali Acc: 0.646 Test Loss: 2.528 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0117825
	speed: 0.7100s/iter; left time: 22984.0856s
	iters: 200, epoch: 13 | loss: 0.0061802
	speed: 0.2583s/iter; left time: 8337.6701s
	iters: 300, epoch: 13 | loss: 0.0965237
	speed: 0.2504s/iter; left time: 8056.0574s
Epoch: 13 cost time: 93.55486702919006
Epoch: 13, Steps: 369 | Train Loss: 0.349 Vali Loss: 2.831 Vali Acc: 0.639 Test Loss: 2.831 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0182364
	speed: 0.7655s/iter; left time: 24498.7108s
	iters: 200, epoch: 14 | loss: 0.5456811
	speed: 0.2517s/iter; left time: 8030.4521s
	iters: 300, epoch: 14 | loss: 0.2758017
	speed: 0.2416s/iter; left time: 7683.1353s
Epoch: 14 cost time: 90.71529221534729
Epoch: 14, Steps: 369 | Train Loss: 0.364 Vali Loss: 2.456 Vali Acc: 0.664 Test Loss: 2.456 Test Acc: 0.664
Validation loss decreased (-0.654629 --> -0.664277).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0260104
	speed: 0.7254s/iter; left time: 22947.6691s
	iters: 200, epoch: 15 | loss: 1.0130939
	speed: 0.2266s/iter; left time: 7146.0688s
	iters: 300, epoch: 15 | loss: 0.0105525
	speed: 0.2314s/iter; left time: 7273.0274s
Epoch: 15 cost time: 86.66940593719482
Epoch: 15, Steps: 369 | Train Loss: 0.343 Vali Loss: 2.623 Vali Acc: 0.668 Test Loss: 2.623 Test Acc: 0.668
Validation loss decreased (-0.664277 --> -0.667965).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6363162
	speed: 0.6886s/iter; left time: 21530.8585s
	iters: 200, epoch: 16 | loss: 0.1064395
	speed: 0.2329s/iter; left time: 7259.7579s
	iters: 300, epoch: 16 | loss: 0.2515806
	speed: 0.2204s/iter; left time: 6847.9678s
Epoch: 16 cost time: 84.75214314460754
Epoch: 16, Steps: 369 | Train Loss: 0.313 Vali Loss: 2.796 Vali Acc: 0.654 Test Loss: 2.796 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4601271
	speed: 0.7308s/iter; left time: 22580.8674s
	iters: 200, epoch: 17 | loss: 0.4922276
	speed: 0.2501s/iter; left time: 7702.6854s
	iters: 300, epoch: 17 | loss: 0.0551804
	speed: 0.2465s/iter; left time: 7566.8801s
Epoch: 17 cost time: 92.11218190193176
Epoch: 17, Steps: 369 | Train Loss: 0.338 Vali Loss: 2.771 Vali Acc: 0.657 Test Loss: 2.771 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2220625
	speed: 0.7324s/iter; left time: 22357.8579s
	iters: 200, epoch: 18 | loss: 0.5651875
	speed: 0.2205s/iter; left time: 6708.6300s
	iters: 300, epoch: 18 | loss: 0.0421005
	speed: 0.2389s/iter; left time: 7244.8580s
Epoch: 18 cost time: 84.45027184486389
Epoch: 18, Steps: 369 | Train Loss: 0.261 Vali Loss: 3.441 Vali Acc: 0.642 Test Loss: 3.441 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0700533
	speed: 0.6821s/iter; left time: 20570.5012s
	iters: 200, epoch: 19 | loss: 0.1642664
	speed: 0.2225s/iter; left time: 6688.3570s
	iters: 300, epoch: 19 | loss: 0.1648550
	speed: 0.2215s/iter; left time: 6637.2854s
Epoch: 19 cost time: 83.80178642272949
Epoch: 19, Steps: 369 | Train Loss: 0.316 Vali Loss: 2.815 Vali Acc: 0.652 Test Loss: 2.815 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.6242937
	speed: 0.6963s/iter; left time: 20743.6851s
	iters: 200, epoch: 20 | loss: 0.0012791
	speed: 0.2427s/iter; left time: 7205.8943s
	iters: 300, epoch: 20 | loss: 0.0006261
	speed: 0.2570s/iter; left time: 7605.3502s
Epoch: 20 cost time: 92.15934014320374
Epoch: 20, Steps: 369 | Train Loss: 0.275 Vali Loss: 3.200 Vali Acc: 0.639 Test Loss: 3.200 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2797231
	speed: 0.7781s/iter; left time: 22892.4486s
	iters: 200, epoch: 21 | loss: 0.1740634
	speed: 0.2672s/iter; left time: 7833.3309s
	iters: 300, epoch: 21 | loss: 0.2452024
	speed: 0.2641s/iter; left time: 7716.4975s
Epoch: 21 cost time: 97.61770725250244
Epoch: 21, Steps: 369 | Train Loss: 0.251 Vali Loss: 3.124 Vali Acc: 0.647 Test Loss: 3.124 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0780216
	speed: 0.7303s/iter; left time: 21216.5482s
	iters: 200, epoch: 22 | loss: 0.6907946
	speed: 0.2299s/iter; left time: 6657.2111s
	iters: 300, epoch: 22 | loss: 1.3751615
	speed: 0.2372s/iter; left time: 6845.0136s
Epoch: 22 cost time: 87.290846824646
Epoch: 22, Steps: 369 | Train Loss: 0.255 Vali Loss: 3.061 Vali Acc: 0.662 Test Loss: 3.061 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0008010
	speed: 0.6973s/iter; left time: 20000.6733s
	iters: 200, epoch: 23 | loss: 0.3672732
	speed: 0.2428s/iter; left time: 6939.2878s
	iters: 300, epoch: 23 | loss: 0.2446810
	speed: 0.2531s/iter; left time: 7208.2553s
Epoch: 23 cost time: 87.66644024848938
Epoch: 23, Steps: 369 | Train Loss: 0.250 Vali Loss: 2.872 Vali Acc: 0.642 Test Loss: 2.872 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.6691070
	speed: 0.6872s/iter; left time: 19458.6456s
	iters: 200, epoch: 24 | loss: 0.3229244
	speed: 0.2381s/iter; left time: 6716.6704s
	iters: 300, epoch: 24 | loss: 0.1228381
	speed: 0.2475s/iter; left time: 6958.4597s
Epoch: 24 cost time: 89.78246927261353
Epoch: 24, Steps: 369 | Train Loss: 0.224 Vali Loss: 3.184 Vali Acc: 0.630 Test Loss: 3.184 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0940348
	speed: 0.7363s/iter; left time: 20574.8506s
	iters: 200, epoch: 25 | loss: 0.1372323
	speed: 0.2582s/iter; left time: 7188.9186s
	iters: 300, epoch: 25 | loss: 0.1737759
	speed: 0.2754s/iter; left time: 7640.2329s
Epoch: 25 cost time: 92.5525712966919
Epoch: 25, Steps: 369 | Train Loss: 0.221 Vali Loss: 3.323 Vali Acc: 0.639 Test Loss: 3.323 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9151766
	speed: 0.2377s/iter; left time: 8748.7511s
	iters: 200, epoch: 1 | loss: 0.7956189
	speed: 0.2180s/iter; left time: 8002.3802s
	iters: 300, epoch: 1 | loss: 1.1698992
	speed: 0.2220s/iter; left time: 8125.1690s
Epoch: 1 cost time: 83.29263544082642
Epoch: 1, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.917 Vali Acc: 0.639 Test Loss: 0.917 Test Acc: 0.639
Validation loss decreased (inf --> -0.638754).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2579706
	speed: 0.7108s/iter; left time: 25894.7908s
	iters: 200, epoch: 2 | loss: 0.3010457
	speed: 0.2283s/iter; left time: 8294.6749s
	iters: 300, epoch: 2 | loss: 0.2748917
	speed: 0.2268s/iter; left time: 8216.6799s
Epoch: 2 cost time: 86.97200870513916
Epoch: 2, Steps: 369 | Train Loss: 0.597 Vali Loss: 1.133 Vali Acc: 0.627 Test Loss: 1.133 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8370902
	speed: 0.7329s/iter; left time: 26431.5171s
	iters: 200, epoch: 3 | loss: 1.1823536
	speed: 0.2431s/iter; left time: 8741.4682s
	iters: 300, epoch: 3 | loss: 0.7647619
	speed: 0.2337s/iter; left time: 8380.2934s
Epoch: 3 cost time: 88.41264081001282
Epoch: 3, Steps: 369 | Train Loss: 0.521 Vali Loss: 1.543 Vali Acc: 0.619 Test Loss: 1.543 Test Acc: 0.619
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1926388
	speed: 0.7029s/iter; left time: 25090.4416s
	iters: 200, epoch: 4 | loss: 0.4014329
	speed: 0.2236s/iter; left time: 7959.8844s
	iters: 300, epoch: 4 | loss: 0.1492472
	speed: 0.2258s/iter; left time: 8013.0804s
Epoch: 4 cost time: 83.37555837631226
Epoch: 4, Steps: 369 | Train Loss: 0.512 Vali Loss: 1.744 Vali Acc: 0.615 Test Loss: 1.744 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1664987
	speed: 0.6596s/iter; left time: 23300.2491s
	iters: 200, epoch: 5 | loss: 0.0196087
	speed: 0.2331s/iter; left time: 8210.4551s
	iters: 300, epoch: 5 | loss: 0.4997880
	speed: 0.2306s/iter; left time: 8099.8488s
Epoch: 5 cost time: 84.62807202339172
Epoch: 5, Steps: 369 | Train Loss: 0.495 Vali Loss: 2.013 Vali Acc: 0.615 Test Loss: 2.013 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3496666
	speed: 0.6921s/iter; left time: 24192.4040s
	iters: 200, epoch: 6 | loss: 0.2411072
	speed: 0.2287s/iter; left time: 7970.9204s
	iters: 300, epoch: 6 | loss: 0.5359756
	speed: 0.2347s/iter; left time: 8155.8035s
Epoch: 6 cost time: 85.72161746025085
Epoch: 6, Steps: 369 | Train Loss: 0.470 Vali Loss: 2.064 Vali Acc: 0.614 Test Loss: 2.064 Test Acc: 0.614
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.6534971
	speed: 0.6827s/iter; left time: 23613.1045s
	iters: 200, epoch: 7 | loss: 0.0188411
	speed: 0.2313s/iter; left time: 7978.3357s
	iters: 300, epoch: 7 | loss: 0.2794687
	speed: 0.2294s/iter; left time: 7886.6704s
Epoch: 7 cost time: 85.75577807426453
Epoch: 7, Steps: 369 | Train Loss: 0.440 Vali Loss: 1.955 Vali Acc: 0.643 Test Loss: 1.955 Test Acc: 0.643
Validation loss decreased (-0.638754 --> -0.643000).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3536276
	speed: 0.7052s/iter; left time: 24131.3993s
	iters: 200, epoch: 8 | loss: 0.2485977
	speed: 0.2413s/iter; left time: 8231.7679s
	iters: 300, epoch: 8 | loss: 0.7221336
	speed: 0.2227s/iter; left time: 7576.2479s
Epoch: 8 cost time: 86.1553316116333
Epoch: 8, Steps: 369 | Train Loss: 0.475 Vali Loss: 2.053 Vali Acc: 0.626 Test Loss: 2.053 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8764816
	speed: 0.6757s/iter; left time: 22870.3289s
	iters: 200, epoch: 9 | loss: 1.5694114
	speed: 0.2232s/iter; left time: 7533.3535s
	iters: 300, epoch: 9 | loss: 1.0143102
	speed: 0.2186s/iter; left time: 7354.0389s
Epoch: 9 cost time: 83.08154845237732
Epoch: 9, Steps: 369 | Train Loss: 0.423 Vali Loss: 2.351 Vali Acc: 0.615 Test Loss: 2.351 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2278791
	speed: 0.6493s/iter; left time: 21738.2712s
	iters: 200, epoch: 10 | loss: 0.7878796
	speed: 0.2255s/iter; left time: 7526.4341s
	iters: 300, epoch: 10 | loss: 0.0464933
	speed: 0.2437s/iter; left time: 8109.1456s
Epoch: 10 cost time: 85.34630823135376
Epoch: 10, Steps: 369 | Train Loss: 0.339 Vali Loss: 2.902 Vali Acc: 0.632 Test Loss: 2.902 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0998358
	speed: 0.7220s/iter; left time: 23906.9761s
	iters: 200, epoch: 11 | loss: 0.5254503
	speed: 0.2358s/iter; left time: 7783.3175s
	iters: 300, epoch: 11 | loss: 1.3101028
	speed: 0.2429s/iter; left time: 7993.2982s
Epoch: 11 cost time: 87.25946164131165
Epoch: 11, Steps: 369 | Train Loss: 0.432 Vali Loss: 2.631 Vali Acc: 0.645 Test Loss: 2.631 Test Acc: 0.645
Validation loss decreased (-0.643000 --> -0.645263).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2966256
	speed: 0.6476s/iter; left time: 21204.4550s
	iters: 200, epoch: 12 | loss: 0.0338752
	speed: 0.2091s/iter; left time: 6824.3284s
	iters: 300, epoch: 12 | loss: 0.2864259
	speed: 0.2088s/iter; left time: 6794.2571s
Epoch: 12 cost time: 78.67390394210815
Epoch: 12, Steps: 369 | Train Loss: 0.380 Vali Loss: 2.848 Vali Acc: 0.615 Test Loss: 2.848 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1477325
	speed: 0.6656s/iter; left time: 21546.3798s
	iters: 200, epoch: 13 | loss: 0.5199459
	speed: 0.2228s/iter; left time: 7191.5366s
	iters: 300, epoch: 13 | loss: 0.5032750
	speed: 0.2243s/iter; left time: 7216.7481s
Epoch: 13 cost time: 83.81009435653687
Epoch: 13, Steps: 369 | Train Loss: 0.379 Vali Loss: 2.753 Vali Acc: 0.615 Test Loss: 2.753 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0974464
	speed: 0.6783s/iter; left time: 21708.9137s
	iters: 200, epoch: 14 | loss: 0.0806099
	speed: 0.2261s/iter; left time: 7213.9490s
	iters: 300, epoch: 14 | loss: 0.5113400
	speed: 0.2272s/iter; left time: 7227.0023s
Epoch: 14 cost time: 83.96300458908081
Epoch: 14, Steps: 369 | Train Loss: 0.345 Vali Loss: 2.618 Vali Acc: 0.642 Test Loss: 2.618 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6736080
	speed: 0.6737s/iter; left time: 21311.1087s
	iters: 200, epoch: 15 | loss: 0.6232400
	speed: 0.2281s/iter; left time: 7191.9212s
	iters: 300, epoch: 15 | loss: 1.0572183
	speed: 0.2414s/iter; left time: 7589.6965s
Epoch: 15 cost time: 86.20029926300049
Epoch: 15, Steps: 369 | Train Loss: 0.345 Vali Loss: 3.110 Vali Acc: 0.638 Test Loss: 3.110 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3550828
	speed: 0.6861s/iter; left time: 21451.6960s
	iters: 200, epoch: 16 | loss: 0.0022461
	speed: 0.2193s/iter; left time: 6833.1494s
	iters: 300, epoch: 16 | loss: 0.2266366
	speed: 0.2272s/iter; left time: 7056.7519s
Epoch: 16 cost time: 83.36660385131836
Epoch: 16, Steps: 369 | Train Loss: 0.316 Vali Loss: 3.049 Vali Acc: 0.633 Test Loss: 3.049 Test Acc: 0.633
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6454985
	speed: 0.6538s/iter; left time: 20199.8355s
	iters: 200, epoch: 17 | loss: 0.2905673
	speed: 0.2215s/iter; left time: 6820.5582s
	iters: 300, epoch: 17 | loss: 0.2123326
	speed: 0.2181s/iter; left time: 6693.9195s
Epoch: 17 cost time: 80.71872997283936
Epoch: 17, Steps: 369 | Train Loss: 0.309 Vali Loss: 3.247 Vali Acc: 0.613 Test Loss: 3.247 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0083659
	speed: 0.6480s/iter; left time: 19782.5516s
	iters: 200, epoch: 18 | loss: 0.5574638
	speed: 0.2293s/iter; left time: 6977.5782s
	iters: 300, epoch: 18 | loss: 0.0512379
	speed: 0.2332s/iter; left time: 7073.7772s
Epoch: 18 cost time: 85.4845757484436
Epoch: 18, Steps: 369 | Train Loss: 0.282 Vali Loss: 3.057 Vali Acc: 0.641 Test Loss: 3.057 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0429335
	speed: 0.7114s/iter; left time: 21454.2419s
	iters: 200, epoch: 19 | loss: 0.0582008
	speed: 0.2210s/iter; left time: 6643.7854s
	iters: 300, epoch: 19 | loss: 0.9942094
	speed: 0.2252s/iter; left time: 6748.0854s
Epoch: 19 cost time: 83.56677198410034
Epoch: 19, Steps: 369 | Train Loss: 0.263 Vali Loss: 3.126 Vali Acc: 0.636 Test Loss: 3.126 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0040418
	speed: 0.6488s/iter; left time: 19326.4348s
	iters: 200, epoch: 20 | loss: 0.0686716
	speed: 0.2316s/iter; left time: 6875.6363s
	iters: 300, epoch: 20 | loss: 0.0485091
	speed: 0.2235s/iter; left time: 6612.8689s
Epoch: 20 cost time: 84.69252276420593
Epoch: 20, Steps: 369 | Train Loss: 0.287 Vali Loss: 3.024 Vali Acc: 0.624 Test Loss: 3.024 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0034276
	speed: 0.7077s/iter; left time: 20822.2059s
	iters: 200, epoch: 21 | loss: 0.1099603
	speed: 0.2358s/iter; left time: 6914.6285s
	iters: 300, epoch: 21 | loss: 0.2844170
	speed: 0.2151s/iter; left time: 6285.8829s
Epoch: 21 cost time: 84.16260743141174
Epoch: 21, Steps: 369 | Train Loss: 0.230 Vali Loss: 3.214 Vali Acc: 0.641 Test Loss: 3.214 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6452894438138479
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7931279
	speed: 0.2414s/iter; left time: 8883.1256s
	iters: 200, epoch: 1 | loss: 0.7718670
	speed: 0.2392s/iter; left time: 8778.2064s
	iters: 300, epoch: 1 | loss: 0.7623481
	speed: 0.2328s/iter; left time: 8521.6961s
Epoch: 1 cost time: 87.51629519462585
Epoch: 1, Steps: 369 | Train Loss: 0.690 Vali Loss: 0.923 Vali Acc: 0.625 Test Loss: 0.923 Test Acc: 0.625
Validation loss decreased (inf --> -0.624565).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2618920
	speed: 0.7156s/iter; left time: 26069.1243s
	iters: 200, epoch: 2 | loss: 0.2044435
	speed: 0.2406s/iter; left time: 8740.5692s
	iters: 300, epoch: 2 | loss: 0.6773537
	speed: 0.2266s/iter; left time: 8209.4151s
Epoch: 2 cost time: 86.03695821762085
Epoch: 2, Steps: 369 | Train Loss: 0.601 Vali Loss: 1.019 Vali Acc: 0.650 Test Loss: 1.019 Test Acc: 0.650
Validation loss decreased (-0.624565 --> -0.649820).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7456796
	speed: 0.6586s/iter; left time: 23751.1391s
	iters: 200, epoch: 3 | loss: 0.9842642
	speed: 0.2250s/iter; left time: 8092.0356s
	iters: 300, epoch: 3 | loss: 0.4287226
	speed: 0.2217s/iter; left time: 7949.2883s
Epoch: 3 cost time: 82.37563633918762
Epoch: 3, Steps: 369 | Train Loss: 0.524 Vali Loss: 1.345 Vali Acc: 0.624 Test Loss: 1.345 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0984493
	speed: 0.6675s/iter; left time: 23826.7037s
	iters: 200, epoch: 4 | loss: 0.1603030
	speed: 0.2277s/iter; left time: 8106.4617s
	iters: 300, epoch: 4 | loss: 0.1833548
	speed: 0.2245s/iter; left time: 7967.4193s
Epoch: 4 cost time: 83.1799144744873
Epoch: 4, Steps: 369 | Train Loss: 0.521 Vali Loss: 1.671 Vali Acc: 0.621 Test Loss: 1.671 Test Acc: 0.621
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6537840
	speed: 0.6852s/iter; left time: 24205.6247s
	iters: 200, epoch: 5 | loss: 0.4048124
	speed: 0.2346s/iter; left time: 8265.4484s
	iters: 300, epoch: 5 | loss: 0.9352795
	speed: 0.2434s/iter; left time: 8548.5558s
Epoch: 5 cost time: 87.46354556083679
Epoch: 5, Steps: 369 | Train Loss: 0.487 Vali Loss: 1.798 Vali Acc: 0.609 Test Loss: 1.798 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5859439
	speed: 0.7085s/iter; left time: 24765.3971s
	iters: 200, epoch: 6 | loss: 0.6791892
	speed: 0.2484s/iter; left time: 8659.8100s
	iters: 300, epoch: 6 | loss: 0.3109131
	speed: 0.2314s/iter; left time: 8043.2360s
Epoch: 6 cost time: 89.13058638572693
Epoch: 6, Steps: 369 | Train Loss: 0.480 Vali Loss: 2.405 Vali Acc: 0.625 Test Loss: 2.405 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5375186
	speed: 0.7391s/iter; left time: 25563.2982s
	iters: 200, epoch: 7 | loss: 0.1492009
	speed: 0.2387s/iter; left time: 8230.7204s
	iters: 300, epoch: 7 | loss: 0.7446543
	speed: 0.2377s/iter; left time: 8172.8392s
Epoch: 7 cost time: 87.90436911582947
Epoch: 7, Steps: 369 | Train Loss: 0.468 Vali Loss: 2.157 Vali Acc: 0.637 Test Loss: 2.157 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.6616895
	speed: 0.6790s/iter; left time: 23234.5650s
	iters: 200, epoch: 8 | loss: 0.7929757
	speed: 0.2272s/iter; left time: 7752.9803s
	iters: 300, epoch: 8 | loss: 0.5986737
	speed: 0.2313s/iter; left time: 7869.2139s
Epoch: 8 cost time: 86.05035471916199
Epoch: 8, Steps: 369 | Train Loss: 0.476 Vali Loss: 2.901 Vali Acc: 0.622 Test Loss: 2.901 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7796785
	speed: 0.7150s/iter; left time: 24201.5459s
	iters: 200, epoch: 9 | loss: 0.7901287
	speed: 0.2249s/iter; left time: 7590.6866s
	iters: 300, epoch: 9 | loss: 1.5114341
	speed: 0.2246s/iter; left time: 7555.9460s
Epoch: 9 cost time: 84.74523496627808
Epoch: 9, Steps: 369 | Train Loss: 0.416 Vali Loss: 2.149 Vali Acc: 0.654 Test Loss: 2.149 Test Acc: 0.654
Validation loss decreased (-0.649820 --> -0.653781).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2477140
	speed: 0.6721s/iter; left time: 22503.1532s
	iters: 200, epoch: 10 | loss: 0.5654454
	speed: 0.2249s/iter; left time: 7505.8438s
	iters: 300, epoch: 10 | loss: 0.1333737
	speed: 0.2213s/iter; left time: 7363.2292s
Epoch: 10 cost time: 81.89935636520386
Epoch: 10, Steps: 369 | Train Loss: 0.407 Vali Loss: 2.669 Vali Acc: 0.640 Test Loss: 2.669 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0111904
	speed: 0.6532s/iter; left time: 21628.0441s
	iters: 200, epoch: 11 | loss: 0.5344386
	speed: 0.2270s/iter; left time: 7492.5444s
	iters: 300, epoch: 11 | loss: 1.0507234
	speed: 0.2293s/iter; left time: 7546.8041s
Epoch: 11 cost time: 84.32714009284973
Epoch: 11, Steps: 369 | Train Loss: 0.366 Vali Loss: 2.573 Vali Acc: 0.647 Test Loss: 2.573 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0135167
	speed: 0.7110s/iter; left time: 23278.3588s
	iters: 200, epoch: 12 | loss: 0.0004649
	speed: 0.2343s/iter; left time: 7648.0740s
	iters: 300, epoch: 12 | loss: 0.2922285
	speed: 0.2296s/iter; left time: 7471.3489s
Epoch: 12 cost time: 87.07640743255615
Epoch: 12, Steps: 369 | Train Loss: 0.365 Vali Loss: 2.638 Vali Acc: 0.639 Test Loss: 2.638 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0379246
	speed: 0.7395s/iter; left time: 23940.6066s
	iters: 200, epoch: 13 | loss: 0.0461690
	speed: 0.2521s/iter; left time: 8135.9124s
	iters: 300, epoch: 13 | loss: 0.3157362
	speed: 0.2559s/iter; left time: 8233.7288s
Epoch: 13 cost time: 93.87291431427002
Epoch: 13, Steps: 369 | Train Loss: 0.333 Vali Loss: 2.682 Vali Acc: 0.623 Test Loss: 2.682 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1297359
	speed: 0.7606s/iter; left time: 24341.0220s
	iters: 200, epoch: 14 | loss: 0.2863850
	speed: 0.2331s/iter; left time: 7436.5665s
	iters: 300, epoch: 14 | loss: 0.4680316
	speed: 0.2411s/iter; left time: 7666.4631s
Epoch: 14 cost time: 89.38733100891113
Epoch: 14, Steps: 369 | Train Loss: 0.368 Vali Loss: 2.745 Vali Acc: 0.640 Test Loss: 2.745 Test Acc: 0.640
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0001202
	speed: 0.7038s/iter; left time: 22265.3372s
	iters: 200, epoch: 15 | loss: 0.6431865
	speed: 0.2216s/iter; left time: 6987.6649s
	iters: 300, epoch: 15 | loss: 0.0003465
	speed: 0.2161s/iter; left time: 6793.4631s
Epoch: 15 cost time: 82.18360757827759
Epoch: 15, Steps: 369 | Train Loss: 0.352 Vali Loss: 2.751 Vali Acc: 0.643 Test Loss: 2.751 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2088292
	speed: 0.6844s/iter; left time: 21397.8503s
	iters: 200, epoch: 16 | loss: 0.7181665
	speed: 0.2325s/iter; left time: 7246.3062s
	iters: 300, epoch: 16 | loss: 0.3152450
	speed: 0.2461s/iter; left time: 7645.3061s
Epoch: 16 cost time: 88.09795951843262
Epoch: 16, Steps: 369 | Train Loss: 0.327 Vali Loss: 2.894 Vali Acc: 0.646 Test Loss: 2.894 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3383925
	speed: 0.7207s/iter; left time: 22267.7788s
	iters: 200, epoch: 17 | loss: 0.0687830
	speed: 0.2460s/iter; left time: 7575.1282s
	iters: 300, epoch: 17 | loss: 0.0056325
	speed: 0.2465s/iter; left time: 7568.2611s
Epoch: 17 cost time: 89.69366407394409
Epoch: 17, Steps: 369 | Train Loss: 0.323 Vali Loss: 2.866 Vali Acc: 0.672 Test Loss: 2.866 Test Acc: 0.672
Validation loss decreased (-0.653781 --> -0.672219).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5091100
	speed: 0.7199s/iter; left time: 21975.7693s
	iters: 200, epoch: 18 | loss: 0.4958151
	speed: 0.2250s/iter; left time: 6847.3232s
	iters: 300, epoch: 18 | loss: 0.1594997
	speed: 0.2354s/iter; left time: 7139.9366s
Epoch: 18 cost time: 87.21854186058044
Epoch: 18, Steps: 369 | Train Loss: 0.305 Vali Loss: 3.182 Vali Acc: 0.648 Test Loss: 3.182 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0069559
	speed: 0.7477s/iter; left time: 22548.7303s
	iters: 200, epoch: 19 | loss: 0.2205458
	speed: 0.2490s/iter; left time: 7485.3702s
	iters: 300, epoch: 19 | loss: 0.0166430
	speed: 0.2416s/iter; left time: 7238.2564s
Epoch: 19 cost time: 90.25772619247437
Epoch: 19, Steps: 369 | Train Loss: 0.287 Vali Loss: 2.854 Vali Acc: 0.648 Test Loss: 2.854 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2363253
	speed: 0.7103s/iter; left time: 21158.9710s
	iters: 200, epoch: 20 | loss: 1.0913438
	speed: 0.2547s/iter; left time: 7562.4567s
	iters: 300, epoch: 20 | loss: 0.0529399
	speed: 0.2574s/iter; left time: 7616.7072s
Epoch: 20 cost time: 94.08960390090942
Epoch: 20, Steps: 369 | Train Loss: 0.293 Vali Loss: 3.338 Vali Acc: 0.624 Test Loss: 3.338 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0812124
	speed: 0.7535s/iter; left time: 22167.8655s
	iters: 200, epoch: 21 | loss: 0.0001325
	speed: 0.2323s/iter; left time: 6811.5721s
	iters: 300, epoch: 21 | loss: 0.0000313
	speed: 0.2598s/iter; left time: 7590.3759s
Epoch: 21 cost time: 92.9390184879303
Epoch: 21, Steps: 369 | Train Loss: 0.245 Vali Loss: 3.037 Vali Acc: 0.641 Test Loss: 3.037 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0046665
	speed: 0.7457s/iter; left time: 21664.2029s
	iters: 200, epoch: 22 | loss: 0.0007673
	speed: 0.2452s/iter; left time: 7098.1223s
	iters: 300, epoch: 22 | loss: 0.1130497
	speed: 0.2269s/iter; left time: 6546.1573s
Epoch: 22 cost time: 89.17454862594604
Epoch: 22, Steps: 369 | Train Loss: 0.252 Vali Loss: 3.189 Vali Acc: 0.646 Test Loss: 3.189 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.5270317
	speed: 0.6938s/iter; left time: 19899.2201s
	iters: 200, epoch: 23 | loss: 0.1691786
	speed: 0.2167s/iter; left time: 6193.3212s
	iters: 300, epoch: 23 | loss: 0.0140917
	speed: 0.2247s/iter; left time: 6398.9589s
Epoch: 23 cost time: 83.0854184627533
Epoch: 23, Steps: 369 | Train Loss: 0.227 Vali Loss: 3.309 Vali Acc: 0.644 Test Loss: 3.309 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0737791
	speed: 0.7373s/iter; left time: 20874.5348s
	iters: 200, epoch: 24 | loss: 0.2227909
	speed: 0.2632s/iter; left time: 7426.6913s
	iters: 300, epoch: 24 | loss: 0.0010003
	speed: 0.2490s/iter; left time: 7001.3618s
Epoch: 24 cost time: 94.82901048660278
Epoch: 24, Steps: 369 | Train Loss: 0.219 Vali Loss: 3.259 Vali Acc: 0.638 Test Loss: 3.259 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0015516
	speed: 0.7262s/iter; left time: 20294.2204s
	iters: 200, epoch: 25 | loss: 0.0096986
	speed: 0.2433s/iter; left time: 6775.4797s
	iters: 300, epoch: 25 | loss: 0.0112938
	speed: 0.2429s/iter; left time: 6738.0098s
Epoch: 25 cost time: 88.65827202796936
Epoch: 25, Steps: 369 | Train Loss: 0.217 Vali Loss: 3.390 Vali Acc: 0.618 Test Loss: 3.390 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0084374
	speed: 0.7211s/iter; left time: 19885.3151s
	iters: 200, epoch: 26 | loss: 0.0899610
	speed: 0.2272s/iter; left time: 6243.7693s
	iters: 300, epoch: 26 | loss: 0.1148001
	speed: 0.2306s/iter; left time: 6314.1364s
Epoch: 26 cost time: 84.98416948318481
Epoch: 26, Steps: 369 | Train Loss: 0.203 Vali Loss: 3.037 Vali Acc: 0.677 Test Loss: 3.037 Test Acc: 0.677
Validation loss decreased (-0.672219 --> -0.676757).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0005174
	speed: 0.6864s/iter; left time: 18673.6744s
	iters: 200, epoch: 27 | loss: 0.0187967
	speed: 0.2487s/iter; left time: 6740.7578s
	iters: 300, epoch: 27 | loss: 0.0014963
	speed: 0.2476s/iter; left time: 6687.8878s
Epoch: 27 cost time: 92.61147451400757
Epoch: 27, Steps: 369 | Train Loss: 0.157 Vali Loss: 2.977 Vali Acc: 0.662 Test Loss: 2.977 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.4990162
	speed: 0.7548s/iter; left time: 20257.1555s
	iters: 200, epoch: 28 | loss: 0.3163812
	speed: 0.2354s/iter; left time: 6293.9260s
	iters: 300, epoch: 28 | loss: 0.0028690
	speed: 0.2444s/iter; left time: 6509.5770s
Epoch: 28 cost time: 90.83400344848633
Epoch: 28, Steps: 369 | Train Loss: 0.175 Vali Loss: 2.818 Vali Acc: 0.651 Test Loss: 2.818 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0026154
	speed: 0.7167s/iter; left time: 18970.6630s
	iters: 200, epoch: 29 | loss: 0.0005226
	speed: 0.2362s/iter; left time: 6227.3824s
	iters: 300, epoch: 29 | loss: 0.0962029
	speed: 0.2339s/iter; left time: 6144.5348s
Epoch: 29 cost time: 87.14520502090454
Epoch: 29, Steps: 369 | Train Loss: 0.120 Vali Loss: 2.792 Vali Acc: 0.641 Test Loss: 2.792 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.1162107
	speed: 0.7118s/iter; left time: 18578.5942s
	iters: 200, epoch: 30 | loss: 0.0007159
	speed: 0.2305s/iter; left time: 5992.8388s
	iters: 300, epoch: 30 | loss: 0.0103863
	speed: 0.2476s/iter; left time: 6412.2699s
Epoch: 30 cost time: 89.75896334648132
Epoch: 30, Steps: 369 | Train Loss: 0.110 Vali Loss: 2.996 Vali Acc: 0.638 Test Loss: 2.996 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.3156713
	speed: 0.7366s/iter; left time: 18954.4301s
	iters: 200, epoch: 31 | loss: 0.2203764
	speed: 0.2410s/iter; left time: 6176.9925s
	iters: 300, epoch: 31 | loss: 0.2466558
	speed: 0.2401s/iter; left time: 6129.3513s
Epoch: 31 cost time: 89.16681337356567
Epoch: 31, Steps: 369 | Train Loss: 0.093 Vali Loss: 2.941 Vali Acc: 0.650 Test Loss: 2.941 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000075
	speed: 0.7235s/iter; left time: 18348.4891s
	iters: 200, epoch: 32 | loss: 0.0149126
	speed: 0.2608s/iter; left time: 6588.2079s
	iters: 300, epoch: 32 | loss: 0.0554165
	speed: 0.2532s/iter; left time: 6369.9847s
Epoch: 32 cost time: 94.47788858413696
Epoch: 32, Steps: 369 | Train Loss: 0.089 Vali Loss: 3.023 Vali Acc: 0.658 Test Loss: 3.023 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0061174
	speed: 0.7010s/iter; left time: 17521.0784s
	iters: 200, epoch: 33 | loss: 0.0517783
	speed: 0.2179s/iter; left time: 5424.5483s
	iters: 300, epoch: 33 | loss: 0.0379893
	speed: 0.2301s/iter; left time: 5705.9980s
Epoch: 33 cost time: 83.87906670570374
Epoch: 33, Steps: 369 | Train Loss: 0.122 Vali Loss: 2.615 Vali Acc: 0.657 Test Loss: 2.615 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0965764
	speed: 0.7270s/iter; left time: 17901.9107s
	iters: 200, epoch: 34 | loss: 0.1113059
	speed: 0.2335s/iter; left time: 5726.5724s
	iters: 300, epoch: 34 | loss: 0.0033029
	speed: 0.2285s/iter; left time: 5580.4730s
Epoch: 34 cost time: 86.4375388622284
Epoch: 34, Steps: 369 | Train Loss: 0.100 Vali Loss: 2.853 Vali Acc: 0.666 Test Loss: 2.853 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0266328
	speed: 0.7136s/iter; left time: 17308.5271s
	iters: 200, epoch: 35 | loss: 0.0059562
	speed: 0.2350s/iter; left time: 5675.7832s
	iters: 300, epoch: 35 | loss: 0.0066515
	speed: 0.2296s/iter; left time: 5523.3971s
Epoch: 35 cost time: 88.55772399902344
Epoch: 35, Steps: 369 | Train Loss: 0.070 Vali Loss: 2.723 Vali Acc: 0.661 Test Loss: 2.723 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0037713
	speed: 0.7713s/iter; left time: 18422.8273s
	iters: 200, epoch: 36 | loss: 0.0677580
	speed: 0.2544s/iter; left time: 6051.1157s
	iters: 300, epoch: 36 | loss: 0.0090720
	speed: 0.2471s/iter; left time: 5851.6288s
Epoch: 36 cost time: 93.57837796211243
Epoch: 36, Steps: 369 | Train Loss: 0.062 Vali Loss: 2.801 Vali Acc: 0.663 Test Loss: 2.801 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.9670536
	speed: 0.2606s/iter; left time: 9589.7578s
	iters: 200, epoch: 1 | loss: 0.7728828
	speed: 0.2412s/iter; left time: 8851.9035s
	iters: 300, epoch: 1 | loss: 0.9256821
	speed: 0.2410s/iter; left time: 8820.5272s
Epoch: 1 cost time: 91.52574896812439
Epoch: 1, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.961 Vali Acc: 0.631 Test Loss: 0.961 Test Acc: 0.631
Validation loss decreased (inf --> -0.630524).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5835783
	speed: 0.6977s/iter; left time: 25419.6551s
	iters: 200, epoch: 2 | loss: 0.3532644
	speed: 0.2344s/iter; left time: 8515.0262s
	iters: 300, epoch: 2 | loss: 1.3635644
	speed: 0.2459s/iter; left time: 8907.9245s
Epoch: 2 cost time: 88.22003221511841
Epoch: 2, Steps: 369 | Train Loss: 0.617 Vali Loss: 1.207 Vali Acc: 0.630 Test Loss: 1.207 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4149374
	speed: 0.7538s/iter; left time: 27183.4142s
	iters: 200, epoch: 3 | loss: 0.6090442
	speed: 0.2444s/iter; left time: 8789.8153s
	iters: 300, epoch: 3 | loss: 0.4069320
	speed: 0.2535s/iter; left time: 9091.9257s
Epoch: 3 cost time: 91.54547238349915
Epoch: 3, Steps: 369 | Train Loss: 0.545 Vali Loss: 1.669 Vali Acc: 0.597 Test Loss: 1.669 Test Acc: 0.597
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4362901
	speed: 0.6558s/iter; left time: 23408.9624s
	iters: 200, epoch: 4 | loss: 0.2790918
	speed: 0.2149s/iter; left time: 7649.0130s
	iters: 300, epoch: 4 | loss: 0.2694528
	speed: 0.2031s/iter; left time: 7210.0023s
Epoch: 4 cost time: 79.84920382499695
Epoch: 4, Steps: 369 | Train Loss: 0.515 Vali Loss: 1.695 Vali Acc: 0.627 Test Loss: 1.695 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1393367
	speed: 0.6943s/iter; left time: 24526.4328s
	iters: 200, epoch: 5 | loss: 0.2211717
	speed: 0.2311s/iter; left time: 8141.7947s
	iters: 300, epoch: 5 | loss: 0.1545204
	speed: 0.2278s/iter; left time: 8003.2022s
Epoch: 5 cost time: 83.42261242866516
Epoch: 5, Steps: 369 | Train Loss: 0.488 Vali Loss: 1.601 Vali Acc: 0.626 Test Loss: 1.601 Test Acc: 0.626
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3449621
	speed: 0.6478s/iter; left time: 22643.5906s
	iters: 200, epoch: 6 | loss: 0.2557729
	speed: 0.2584s/iter; left time: 9007.8986s
	iters: 300, epoch: 6 | loss: 0.2774425
	speed: 0.2518s/iter; left time: 8752.6667s
Epoch: 6 cost time: 90.9791567325592
Epoch: 6, Steps: 369 | Train Loss: 0.453 Vali Loss: 1.754 Vali Acc: 0.629 Test Loss: 1.754 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2677978
	speed: 0.7580s/iter; left time: 26215.6519s
	iters: 200, epoch: 7 | loss: 0.0017337
	speed: 0.2407s/iter; left time: 8302.0727s
	iters: 300, epoch: 7 | loss: 1.0960894
	speed: 0.2315s/iter; left time: 7962.2295s
Epoch: 7 cost time: 89.4584105014801
Epoch: 7, Steps: 369 | Train Loss: 0.409 Vali Loss: 2.225 Vali Acc: 0.637 Test Loss: 2.225 Test Acc: 0.637
Validation loss decreased (-0.630524 --> -0.637322).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5647417
	speed: 0.7229s/iter; left time: 24735.6074s
	iters: 200, epoch: 8 | loss: 0.1189493
	speed: 0.2614s/iter; left time: 8919.4061s
	iters: 300, epoch: 8 | loss: 0.8306946
	speed: 0.2485s/iter; left time: 8452.9676s
Epoch: 8 cost time: 93.3721091747284
Epoch: 8, Steps: 369 | Train Loss: 0.406 Vali Loss: 1.940 Vali Acc: 0.621 Test Loss: 1.940 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0055696
	speed: 0.7216s/iter; left time: 24424.9746s
	iters: 200, epoch: 9 | loss: 0.0442248
	speed: 0.2317s/iter; left time: 7818.2789s
	iters: 300, epoch: 9 | loss: 0.0300513
	speed: 0.2313s/iter; left time: 7782.7161s
Epoch: 9 cost time: 86.46656799316406
Epoch: 9, Steps: 369 | Train Loss: 0.382 Vali Loss: 2.189 Vali Acc: 0.663 Test Loss: 2.189 Test Acc: 0.663
Validation loss decreased (-0.637322 --> -0.663429).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1216820
	speed: 0.6822s/iter; left time: 22839.6389s
	iters: 200, epoch: 10 | loss: 0.3871805
	speed: 0.2260s/iter; left time: 7542.9535s
	iters: 300, epoch: 10 | loss: 0.0051688
	speed: 0.2139s/iter; left time: 7120.1674s
Epoch: 10 cost time: 83.21422719955444
Epoch: 10, Steps: 369 | Train Loss: 0.341 Vali Loss: 2.772 Vali Acc: 0.625 Test Loss: 2.772 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0007528
	speed: 0.6892s/iter; left time: 22819.0886s
	iters: 200, epoch: 11 | loss: 0.2832423
	speed: 0.2383s/iter; left time: 7865.0190s
	iters: 300, epoch: 11 | loss: 0.5322452
	speed: 0.2342s/iter; left time: 7708.8957s
Epoch: 11 cost time: 86.99232792854309
Epoch: 11, Steps: 369 | Train Loss: 0.443 Vali Loss: 2.618 Vali Acc: 0.648 Test Loss: 2.618 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0362743
	speed: 0.6864s/iter; left time: 22474.9311s
	iters: 200, epoch: 12 | loss: 0.4717424
	speed: 0.2179s/iter; left time: 7111.9663s
	iters: 300, epoch: 12 | loss: 0.3546093
	speed: 0.2217s/iter; left time: 7213.8305s
Epoch: 12 cost time: 82.70889854431152
Epoch: 12, Steps: 369 | Train Loss: 0.350 Vali Loss: 2.560 Vali Acc: 0.639 Test Loss: 2.560 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6666780
	speed: 0.6687s/iter; left time: 21646.3133s
	iters: 200, epoch: 13 | loss: 0.0092624
	speed: 0.2259s/iter; left time: 7290.8259s
	iters: 300, epoch: 13 | loss: 0.5924744
	speed: 0.2245s/iter; left time: 7223.1061s
Epoch: 13 cost time: 83.52286529541016
Epoch: 13, Steps: 369 | Train Loss: 0.372 Vali Loss: 2.518 Vali Acc: 0.660 Test Loss: 2.518 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.7153375
	speed: 0.6833s/iter; left time: 21868.4754s
	iters: 200, epoch: 14 | loss: 1.1238135
	speed: 0.2349s/iter; left time: 7493.9640s
	iters: 300, epoch: 14 | loss: 0.3832130
	speed: 0.2406s/iter; left time: 7651.9596s
Epoch: 14 cost time: 87.72049355506897
Epoch: 14, Steps: 369 | Train Loss: 0.368 Vali Loss: 2.781 Vali Acc: 0.604 Test Loss: 2.781 Test Acc: 0.604
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4755327
	speed: 0.7224s/iter; left time: 22853.6063s
	iters: 200, epoch: 15 | loss: 0.0625196
	speed: 0.2374s/iter; left time: 7487.5896s
	iters: 300, epoch: 15 | loss: 0.0122603
	speed: 0.2306s/iter; left time: 7250.2211s
Epoch: 15 cost time: 87.87358522415161
Epoch: 15, Steps: 369 | Train Loss: 0.435 Vali Loss: 3.036 Vali Acc: 0.641 Test Loss: 3.036 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1369629
	speed: 0.6660s/iter; left time: 20823.5086s
	iters: 200, epoch: 16 | loss: 0.0628226
	speed: 0.2188s/iter; left time: 6819.6251s
	iters: 300, epoch: 16 | loss: 0.0919948
	speed: 0.2171s/iter; left time: 6743.5654s
Epoch: 16 cost time: 81.89826202392578
Epoch: 16, Steps: 369 | Train Loss: 0.362 Vali Loss: 2.808 Vali Acc: 0.634 Test Loss: 2.808 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.6122194
	speed: 0.6681s/iter; left time: 20640.9483s
	iters: 200, epoch: 17 | loss: 0.8255433
	speed: 0.2370s/iter; left time: 7299.2314s
	iters: 300, epoch: 17 | loss: 0.3401663
	speed: 0.2292s/iter; left time: 7034.6336s
Epoch: 17 cost time: 86.09115171432495
Epoch: 17, Steps: 369 | Train Loss: 0.389 Vali Loss: 2.849 Vali Acc: 0.644 Test Loss: 2.849 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0546548
	speed: 0.7018s/iter; left time: 21423.1153s
	iters: 200, epoch: 18 | loss: 0.4075573
	speed: 0.2252s/iter; left time: 6852.8790s
	iters: 300, epoch: 18 | loss: 0.0010014
	speed: 0.2250s/iter; left time: 6824.3154s
Epoch: 18 cost time: 85.29783320426941
Epoch: 18, Steps: 369 | Train Loss: 0.331 Vali Loss: 2.991 Vali Acc: 0.639 Test Loss: 2.991 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9694950
	speed: 0.7015s/iter; left time: 21157.0139s
	iters: 200, epoch: 19 | loss: 0.4426722
	speed: 0.2285s/iter; left time: 6867.3706s
	iters: 300, epoch: 19 | loss: 0.1168046
	speed: 0.2244s/iter; left time: 6721.9969s
Epoch: 19 cost time: 85.44751834869385
Epoch: 19, Steps: 369 | Train Loss: 0.336 Vali Loss: 2.855 Vali Acc: 0.657 Test Loss: 2.855 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6634506242905789
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8809905
	speed: 0.2386s/iter; left time: 8782.4208s
	iters: 200, epoch: 1 | loss: 0.5859661
	speed: 0.2380s/iter; left time: 8733.9034s
	iters: 300, epoch: 1 | loss: 0.8550324
	speed: 0.2392s/iter; left time: 8755.0574s
Epoch: 1 cost time: 87.99417448043823
Epoch: 1, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.909 Vali Acc: 0.651 Test Loss: 0.909 Test Acc: 0.651
Validation loss decreased (inf --> -0.650956).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2195406
	speed: 0.7167s/iter; left time: 26111.5560s
	iters: 200, epoch: 2 | loss: 0.4522659
	speed: 0.2299s/iter; left time: 8353.3971s
	iters: 300, epoch: 2 | loss: 0.6742154
	speed: 0.2344s/iter; left time: 8492.3568s
Epoch: 2 cost time: 86.45001912117004
Epoch: 2, Steps: 369 | Train Loss: 0.624 Vali Loss: 1.026 Vali Acc: 0.645 Test Loss: 1.026 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5525940
	speed: 0.6820s/iter; left time: 24594.4544s
	iters: 200, epoch: 3 | loss: 0.5138389
	speed: 0.2309s/iter; left time: 8304.0480s
	iters: 300, epoch: 3 | loss: 0.7073895
	speed: 0.2378s/iter; left time: 8528.0254s
Epoch: 3 cost time: 86.09830665588379
Epoch: 3, Steps: 369 | Train Loss: 0.567 Vali Loss: 1.418 Vali Acc: 0.609 Test Loss: 1.418 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6236590
	speed: 0.7241s/iter; left time: 25847.7995s
	iters: 200, epoch: 4 | loss: 0.3661102
	speed: 0.2370s/iter; left time: 8434.5893s
	iters: 300, epoch: 4 | loss: 0.4511026
	speed: 0.2405s/iter; left time: 8536.9722s
Epoch: 4 cost time: 90.5928373336792
Epoch: 4, Steps: 369 | Train Loss: 0.528 Vali Loss: 1.557 Vali Acc: 0.622 Test Loss: 1.557 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1892296
	speed: 0.7135s/iter; left time: 25205.0483s
	iters: 200, epoch: 5 | loss: 0.4400837
	speed: 0.2217s/iter; left time: 7810.2608s
	iters: 300, epoch: 5 | loss: 0.3168770
	speed: 0.2358s/iter; left time: 8281.4561s
Epoch: 5 cost time: 85.38921427726746
Epoch: 5, Steps: 369 | Train Loss: 0.491 Vali Loss: 1.696 Vali Acc: 0.633 Test Loss: 1.696 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2454994
	speed: 0.7128s/iter; left time: 24917.3502s
	iters: 200, epoch: 6 | loss: 1.4103158
	speed: 0.2395s/iter; left time: 8348.4285s
	iters: 300, epoch: 6 | loss: 0.2032421
	speed: 0.2369s/iter; left time: 8233.6177s
Epoch: 6 cost time: 89.99857473373413
Epoch: 6, Steps: 369 | Train Loss: 0.462 Vali Loss: 1.764 Vali Acc: 0.617 Test Loss: 1.764 Test Acc: 0.617
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5399649
	speed: 0.7337s/iter; left time: 25376.4133s
	iters: 200, epoch: 7 | loss: 0.3918174
	speed: 0.2364s/iter; left time: 8152.0209s
	iters: 300, epoch: 7 | loss: 1.1385926
	speed: 0.2258s/iter; left time: 7765.7033s
Epoch: 7 cost time: 86.83346509933472
Epoch: 7, Steps: 369 | Train Loss: 0.421 Vali Loss: 2.079 Vali Acc: 0.652 Test Loss: 2.079 Test Acc: 0.652
Validation loss decreased (-0.650956 --> -0.651795).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0047772
	speed: 0.6603s/iter; left time: 22595.5860s
	iters: 200, epoch: 8 | loss: 0.9297821
	speed: 0.2261s/iter; left time: 7712.9540s
	iters: 300, epoch: 8 | loss: 0.1926618
	speed: 0.2226s/iter; left time: 7572.1215s
Epoch: 8 cost time: 82.11027264595032
Epoch: 8, Steps: 369 | Train Loss: 0.405 Vali Loss: 2.055 Vali Acc: 0.624 Test Loss: 2.055 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2260916
	speed: 0.6610s/iter; left time: 22374.1021s
	iters: 200, epoch: 9 | loss: 0.5384668
	speed: 0.2337s/iter; left time: 7887.7580s
	iters: 300, epoch: 9 | loss: 0.6864784
	speed: 0.2335s/iter; left time: 7855.9417s
Epoch: 9 cost time: 85.3794891834259
Epoch: 9, Steps: 369 | Train Loss: 0.370 Vali Loss: 2.240 Vali Acc: 0.650 Test Loss: 2.240 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3101009
	speed: 0.7084s/iter; left time: 23715.6421s
	iters: 200, epoch: 10 | loss: 0.6532957
	speed: 0.2589s/iter; left time: 8642.9147s
	iters: 300, epoch: 10 | loss: 0.5888736
	speed: 0.2576s/iter; left time: 8573.4331s
Epoch: 10 cost time: 93.34335207939148
Epoch: 10, Steps: 369 | Train Loss: 0.381 Vali Loss: 2.638 Vali Acc: 0.635 Test Loss: 2.638 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5572935
	speed: 0.7198s/iter; left time: 23833.5316s
	iters: 200, epoch: 11 | loss: 0.1447761
	speed: 0.2153s/iter; left time: 7105.9938s
	iters: 300, epoch: 11 | loss: 0.2633684
	speed: 0.2296s/iter; left time: 7556.4029s
Epoch: 11 cost time: 85.12460470199585
Epoch: 11, Steps: 369 | Train Loss: 0.377 Vali Loss: 2.431 Vali Acc: 0.649 Test Loss: 2.431 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2252199
	speed: 0.7174s/iter; left time: 23490.2390s
	iters: 200, epoch: 12 | loss: 0.3853546
	speed: 0.2308s/iter; left time: 7535.0946s
	iters: 300, epoch: 12 | loss: 0.2385381
	speed: 0.2334s/iter; left time: 7596.6272s
Epoch: 12 cost time: 87.24188017845154
Epoch: 12, Steps: 369 | Train Loss: 0.419 Vali Loss: 2.352 Vali Acc: 0.666 Test Loss: 2.352 Test Acc: 0.666
Validation loss decreased (-0.651795 --> -0.666265).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4482354
	speed: 0.7315s/iter; left time: 23679.8343s
	iters: 200, epoch: 13 | loss: 1.3673562
	speed: 0.2505s/iter; left time: 8085.0101s
	iters: 300, epoch: 13 | loss: 0.0971101
	speed: 0.2576s/iter; left time: 8288.5306s
Epoch: 13 cost time: 94.79025316238403
Epoch: 13, Steps: 369 | Train Loss: 0.405 Vali Loss: 2.737 Vali Acc: 0.631 Test Loss: 2.737 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3802004
	speed: 0.7663s/iter; left time: 24525.6465s
	iters: 200, epoch: 14 | loss: 0.0357408
	speed: 0.2574s/iter; left time: 8212.8323s
	iters: 300, epoch: 14 | loss: 0.4424345
	speed: 0.2412s/iter; left time: 7670.4891s
Epoch: 14 cost time: 90.69243788719177
Epoch: 14, Steps: 369 | Train Loss: 0.364 Vali Loss: 2.676 Vali Acc: 0.631 Test Loss: 2.676 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0306654
	speed: 0.6712s/iter; left time: 21232.8595s
	iters: 200, epoch: 15 | loss: 1.0364552
	speed: 0.2196s/iter; left time: 6925.7463s
	iters: 300, epoch: 15 | loss: 0.3608878
	speed: 0.2497s/iter; left time: 7849.2266s
Epoch: 15 cost time: 85.02762079238892
Epoch: 15, Steps: 369 | Train Loss: 0.405 Vali Loss: 2.272 Vali Acc: 0.665 Test Loss: 2.272 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0076300
	speed: 0.6521s/iter; left time: 20387.2911s
	iters: 200, epoch: 16 | loss: 0.1328219
	speed: 0.2291s/iter; left time: 7141.5075s
	iters: 300, epoch: 16 | loss: 0.5070207
	speed: 0.2353s/iter; left time: 7310.0195s
Epoch: 16 cost time: 85.73521494865417
Epoch: 16, Steps: 369 | Train Loss: 0.360 Vali Loss: 2.888 Vali Acc: 0.660 Test Loss: 2.888 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1683736
	speed: 0.7312s/iter; left time: 22593.2970s
	iters: 200, epoch: 17 | loss: 0.6121785
	speed: 0.2280s/iter; left time: 7022.1600s
	iters: 300, epoch: 17 | loss: 0.0028562
	speed: 0.2271s/iter; left time: 6971.8809s
Epoch: 17 cost time: 86.03763103485107
Epoch: 17, Steps: 369 | Train Loss: 0.354 Vali Loss: 2.745 Vali Acc: 0.655 Test Loss: 2.745 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0707028
	speed: 0.6772s/iter; left time: 20674.3643s
	iters: 200, epoch: 18 | loss: 0.0003615
	speed: 0.2223s/iter; left time: 6765.5998s
	iters: 300, epoch: 18 | loss: 0.3312218
	speed: 0.2240s/iter; left time: 6793.2372s
Epoch: 18 cost time: 83.25863313674927
Epoch: 18, Steps: 369 | Train Loss: 0.339 Vali Loss: 3.207 Vali Acc: 0.646 Test Loss: 3.207 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1033762
	speed: 0.6680s/iter; left time: 20146.7390s
	iters: 200, epoch: 19 | loss: 0.0708873
	speed: 0.2205s/iter; left time: 6628.7435s
	iters: 300, epoch: 19 | loss: 0.0704011
	speed: 0.2097s/iter; left time: 6283.7854s
Epoch: 19 cost time: 80.99035835266113
Epoch: 19, Steps: 369 | Train Loss: 0.326 Vali Loss: 2.721 Vali Acc: 0.666 Test Loss: 2.721 Test Acc: 0.666
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6937565
	speed: 0.7194s/iter; left time: 21432.3551s
	iters: 200, epoch: 20 | loss: 0.2901993
	speed: 0.2499s/iter; left time: 7420.4344s
	iters: 300, epoch: 20 | loss: 0.1735412
	speed: 0.2493s/iter; left time: 7375.4461s
Epoch: 20 cost time: 92.23980689048767
Epoch: 20, Steps: 369 | Train Loss: 0.289 Vali Loss: 2.946 Vali Acc: 0.619 Test Loss: 2.946 Test Acc: 0.619
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2161129
	speed: 0.7519s/iter; left time: 22122.5290s
	iters: 200, epoch: 21 | loss: 0.2582449
	speed: 0.2364s/iter; left time: 6932.1992s
	iters: 300, epoch: 21 | loss: 0.0168325
	speed: 0.2313s/iter; left time: 6759.1554s
Epoch: 21 cost time: 87.22654008865356
Epoch: 21, Steps: 369 | Train Loss: 0.288 Vali Loss: 2.644 Vali Acc: 0.646 Test Loss: 2.644 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2685066
	speed: 0.6954s/iter; left time: 20201.5356s
	iters: 200, epoch: 22 | loss: 0.1330186
	speed: 0.2626s/iter; left time: 7603.4855s
	iters: 300, epoch: 22 | loss: 0.3846851
	speed: 0.2150s/iter; left time: 6202.0165s
Epoch: 22 cost time: 89.11917090415955
Epoch: 22, Steps: 369 | Train Loss: 0.283 Vali Loss: 3.012 Vali Acc: 0.650 Test Loss: 3.012 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6662883087400681
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 1.0919801
	speed: 0.2540s/iter; left time: 9347.3376s
	iters: 200, epoch: 1 | loss: 0.5591432
	speed: 0.2263s/iter; left time: 8306.7696s
	iters: 300, epoch: 1 | loss: 0.7612331
	speed: 0.2199s/iter; left time: 8046.8536s
Epoch: 1 cost time: 86.11654424667358
Epoch: 1, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.891 Vali Acc: 0.649 Test Loss: 0.891 Test Acc: 0.649
Validation loss decreased (inf --> -0.648970).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2870267
	speed: 0.7267s/iter; left time: 26476.1678s
	iters: 200, epoch: 2 | loss: 0.1515377
	speed: 0.2339s/iter; left time: 8496.2836s
	iters: 300, epoch: 2 | loss: 0.4899072
	speed: 0.2380s/iter; left time: 8622.6680s
Epoch: 2 cost time: 88.65867376327515
Epoch: 2, Steps: 369 | Train Loss: 0.617 Vali Loss: 1.103 Vali Acc: 0.631 Test Loss: 1.103 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1839558
	speed: 0.6948s/iter; left time: 25057.9023s
	iters: 200, epoch: 3 | loss: 0.6833605
	speed: 0.2324s/iter; left time: 8356.4526s
	iters: 300, epoch: 3 | loss: 0.9889815
	speed: 0.2363s/iter; left time: 8473.1232s
Epoch: 3 cost time: 84.688711643219
Epoch: 3, Steps: 369 | Train Loss: 0.547 Vali Loss: 1.395 Vali Acc: 0.624 Test Loss: 1.395 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2733704
	speed: 0.6577s/iter; left time: 23476.0925s
	iters: 200, epoch: 4 | loss: 0.2604654
	speed: 0.2443s/iter; left time: 8694.5393s
	iters: 300, epoch: 4 | loss: 0.3125723
	speed: 0.2520s/iter; left time: 8943.8791s
Epoch: 4 cost time: 86.82448410987854
Epoch: 4, Steps: 369 | Train Loss: 0.501 Vali Loss: 1.503 Vali Acc: 0.620 Test Loss: 1.503 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8416350
	speed: 0.7015s/iter; left time: 24778.7984s
	iters: 200, epoch: 5 | loss: 0.5503118
	speed: 0.2463s/iter; left time: 8677.5708s
	iters: 300, epoch: 5 | loss: 0.0424825
	speed: 0.2377s/iter; left time: 8348.1673s
Epoch: 5 cost time: 90.4734001159668
Epoch: 5, Steps: 369 | Train Loss: 0.454 Vali Loss: 1.481 Vali Acc: 0.633 Test Loss: 1.481 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1225120
	speed: 0.7271s/iter; left time: 25415.7145s
	iters: 200, epoch: 6 | loss: 0.9386647
	speed: 0.2431s/iter; left time: 8475.0879s
	iters: 300, epoch: 6 | loss: 0.1512179
	speed: 0.2317s/iter; left time: 8053.1401s
Epoch: 6 cost time: 88.52349925041199
Epoch: 6, Steps: 369 | Train Loss: 0.469 Vali Loss: 1.874 Vali Acc: 0.596 Test Loss: 1.874 Test Acc: 0.596
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6115671
	speed: 0.6819s/iter; left time: 23586.0081s
	iters: 200, epoch: 7 | loss: 0.0562826
	speed: 0.2232s/iter; left time: 7696.6581s
	iters: 300, epoch: 7 | loss: 0.1325043
	speed: 0.2453s/iter; left time: 8436.7475s
Epoch: 7 cost time: 86.79906034469604
Epoch: 7, Steps: 369 | Train Loss: 0.410 Vali Loss: 1.840 Vali Acc: 0.648 Test Loss: 1.840 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0214967
	speed: 0.7301s/iter; left time: 24982.1257s
	iters: 200, epoch: 8 | loss: 0.3549793
	speed: 0.2442s/iter; left time: 8333.1899s
	iters: 300, epoch: 8 | loss: 0.2348696
	speed: 0.2333s/iter; left time: 7937.8084s
Epoch: 8 cost time: 88.96621251106262
Epoch: 8, Steps: 369 | Train Loss: 0.390 Vali Loss: 2.241 Vali Acc: 0.651 Test Loss: 2.241 Test Acc: 0.651
Validation loss decreased (-0.648970 --> -0.650942).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2661543
	speed: 0.7245s/iter; left time: 24523.9321s
	iters: 200, epoch: 9 | loss: 0.4030459
	speed: 0.2487s/iter; left time: 8391.8986s
	iters: 300, epoch: 9 | loss: 0.4378958
	speed: 0.2425s/iter; left time: 8159.3901s
Epoch: 9 cost time: 92.23981857299805
Epoch: 9, Steps: 369 | Train Loss: 0.411 Vali Loss: 2.306 Vali Acc: 0.657 Test Loss: 2.306 Test Acc: 0.657
Validation loss decreased (-0.650942 --> -0.657185).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0054188
	speed: 0.7075s/iter; left time: 23687.6520s
	iters: 200, epoch: 10 | loss: 0.7563457
	speed: 0.2343s/iter; left time: 7821.4313s
	iters: 300, epoch: 10 | loss: 0.4456322
	speed: 0.2366s/iter; left time: 7875.6284s
Epoch: 10 cost time: 86.93652319908142
Epoch: 10, Steps: 369 | Train Loss: 0.387 Vali Loss: 2.426 Vali Acc: 0.645 Test Loss: 2.426 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3174638
	speed: 0.7094s/iter; left time: 23489.6387s
	iters: 200, epoch: 11 | loss: 0.6397566
	speed: 0.2438s/iter; left time: 8048.9750s
	iters: 300, epoch: 11 | loss: 0.3679655
	speed: 0.2444s/iter; left time: 8043.3507s
Epoch: 11 cost time: 90.27634406089783
Epoch: 11, Steps: 369 | Train Loss: 0.430 Vali Loss: 2.283 Vali Acc: 0.651 Test Loss: 2.283 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8229769
	speed: 0.6961s/iter; left time: 22790.9720s
	iters: 200, epoch: 12 | loss: 0.4164294
	speed: 0.2353s/iter; left time: 7681.8460s
	iters: 300, epoch: 12 | loss: 0.9182678
	speed: 0.2331s/iter; left time: 7586.0470s
Epoch: 12 cost time: 85.91382050514221
Epoch: 12, Steps: 369 | Train Loss: 0.395 Vali Loss: 2.338 Vali Acc: 0.653 Test Loss: 2.338 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4134274
	speed: 0.7020s/iter; left time: 22725.7322s
	iters: 200, epoch: 13 | loss: 0.1155542
	speed: 0.2431s/iter; left time: 7845.9698s
	iters: 300, epoch: 13 | loss: 0.1004058
	speed: 0.2363s/iter; left time: 7603.7911s
Epoch: 13 cost time: 88.35301470756531
Epoch: 13, Steps: 369 | Train Loss: 0.312 Vali Loss: 2.771 Vali Acc: 0.633 Test Loss: 2.771 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1534769
	speed: 0.7211s/iter; left time: 23077.6204s
	iters: 200, epoch: 14 | loss: 0.3890687
	speed: 0.2384s/iter; left time: 7605.8900s
	iters: 300, epoch: 14 | loss: 0.4684707
	speed: 0.2332s/iter; left time: 7418.0467s
Epoch: 14 cost time: 87.85849642753601
Epoch: 14, Steps: 369 | Train Loss: 0.347 Vali Loss: 2.553 Vali Acc: 0.654 Test Loss: 2.553 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1331752
	speed: 0.7074s/iter; left time: 22379.5803s
	iters: 200, epoch: 15 | loss: 0.9760820
	speed: 0.2375s/iter; left time: 7491.1036s
	iters: 300, epoch: 15 | loss: 0.0432634
	speed: 0.2538s/iter; left time: 7976.7778s
Epoch: 15 cost time: 91.33814430236816
Epoch: 15, Steps: 369 | Train Loss: 0.398 Vali Loss: 2.406 Vali Acc: 0.646 Test Loss: 2.406 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2128716
	speed: 0.7548s/iter; left time: 23598.7042s
	iters: 200, epoch: 16 | loss: 0.4349476
	speed: 0.2682s/iter; left time: 8358.3706s
	iters: 300, epoch: 16 | loss: 0.0893885
	speed: 0.2650s/iter; left time: 8232.9594s
Epoch: 16 cost time: 97.26683282852173
Epoch: 16, Steps: 369 | Train Loss: 0.344 Vali Loss: 2.445 Vali Acc: 0.661 Test Loss: 2.445 Test Acc: 0.661
Validation loss decreased (-0.657185 --> -0.661440).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8898719
	speed: 0.7135s/iter; left time: 22046.5023s
	iters: 200, epoch: 17 | loss: 1.0283582
	speed: 0.2399s/iter; left time: 7387.9691s
	iters: 300, epoch: 17 | loss: 0.0276006
	speed: 0.2274s/iter; left time: 6981.7175s
Epoch: 17 cost time: 86.06065797805786
Epoch: 17, Steps: 369 | Train Loss: 0.329 Vali Loss: 2.432 Vali Acc: 0.642 Test Loss: 2.432 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2351809
	speed: 0.7488s/iter; left time: 22860.7253s
	iters: 200, epoch: 18 | loss: 0.6071561
	speed: 0.2541s/iter; left time: 7732.5607s
	iters: 300, epoch: 18 | loss: 0.5901210
	speed: 0.2369s/iter; left time: 7185.4726s
Epoch: 18 cost time: 92.74099445343018
Epoch: 18, Steps: 369 | Train Loss: 0.294 Vali Loss: 2.428 Vali Acc: 0.652 Test Loss: 2.428 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.7553869
	speed: 0.7129s/iter; left time: 21500.2385s
	iters: 200, epoch: 19 | loss: 0.2239294
	speed: 0.2380s/iter; left time: 7155.5149s
	iters: 300, epoch: 19 | loss: 0.1230879
	speed: 0.2333s/iter; left time: 6990.8914s
Epoch: 19 cost time: 89.17556095123291
Epoch: 19, Steps: 369 | Train Loss: 0.246 Vali Loss: 2.157 Vali Acc: 0.668 Test Loss: 2.157 Test Acc: 0.668
Validation loss decreased (-0.661440 --> -0.667686).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5004014
	speed: 0.7526s/iter; left time: 22420.2511s
	iters: 200, epoch: 20 | loss: 0.2052107
	speed: 0.2479s/iter; left time: 7358.9735s
	iters: 300, epoch: 20 | loss: 0.0699206
	speed: 0.2307s/iter; left time: 6827.4437s
Epoch: 20 cost time: 90.13373470306396
Epoch: 20, Steps: 369 | Train Loss: 0.260 Vali Loss: 2.125 Vali Acc: 0.633 Test Loss: 2.125 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1697303
	speed: 0.6958s/iter; left time: 20471.3726s
	iters: 200, epoch: 21 | loss: 0.4259034
	speed: 0.2350s/iter; left time: 6890.2088s
	iters: 300, epoch: 21 | loss: 0.0247918
	speed: 0.2290s/iter; left time: 6692.1909s
Epoch: 21 cost time: 86.33715748786926
Epoch: 21, Steps: 369 | Train Loss: 0.223 Vali Loss: 2.062 Vali Acc: 0.640 Test Loss: 2.062 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2691233
	speed: 0.7080s/iter; left time: 20567.5741s
	iters: 200, epoch: 22 | loss: 0.0175516
	speed: 0.2527s/iter; left time: 7317.3055s
	iters: 300, epoch: 22 | loss: 0.3327560
	speed: 0.2650s/iter; left time: 7644.9587s
Epoch: 22 cost time: 95.81125950813293
Epoch: 22, Steps: 369 | Train Loss: 0.226 Vali Loss: 2.148 Vali Acc: 0.661 Test Loss: 2.148 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0011269
	speed: 0.7920s/iter; left time: 22717.7401s
	iters: 200, epoch: 23 | loss: 0.5922937
	speed: 0.2615s/iter; left time: 7473.9698s
	iters: 300, epoch: 23 | loss: 0.3719330
	speed: 0.2671s/iter; left time: 7608.5416s
Epoch: 23 cost time: 98.58434200286865
Epoch: 23, Steps: 369 | Train Loss: 0.201 Vali Loss: 2.062 Vali Acc: 0.648 Test Loss: 2.062 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0050078
	speed: 0.7251s/iter; left time: 20530.4392s
	iters: 200, epoch: 24 | loss: 0.0230198
	speed: 0.2321s/iter; left time: 6548.4225s
	iters: 300, epoch: 24 | loss: 0.3806938
	speed: 0.2525s/iter; left time: 7099.6591s
Epoch: 24 cost time: 89.93283081054688
Epoch: 24, Steps: 369 | Train Loss: 0.208 Vali Loss: 2.082 Vali Acc: 0.651 Test Loss: 2.082 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.2777703
	speed: 0.7144s/iter; left time: 19964.8139s
	iters: 200, epoch: 25 | loss: 0.1913704
	speed: 0.2345s/iter; left time: 6528.9022s
	iters: 300, epoch: 25 | loss: 0.3646501
	speed: 0.2532s/iter; left time: 7026.2145s
Epoch: 25 cost time: 88.89393472671509
Epoch: 25, Steps: 369 | Train Loss: 0.174 Vali Loss: 2.001 Vali Acc: 0.656 Test Loss: 2.001 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1042942
	speed: 0.6946s/iter; left time: 19153.7561s
	iters: 200, epoch: 26 | loss: 0.2789405
	speed: 0.2309s/iter; left time: 6344.4264s
	iters: 300, epoch: 26 | loss: 0.1807855
	speed: 0.2328s/iter; left time: 6372.4342s
Epoch: 26 cost time: 86.80364274978638
Epoch: 26, Steps: 369 | Train Loss: 0.139 Vali Loss: 2.398 Vali Acc: 0.654 Test Loss: 2.398 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0004663
	speed: 0.7368s/iter; left time: 20046.0416s
	iters: 200, epoch: 27 | loss: 0.2292649
	speed: 0.2581s/iter; left time: 6995.5168s
	iters: 300, epoch: 27 | loss: 0.1425130
	speed: 0.2472s/iter; left time: 6677.3474s
Epoch: 27 cost time: 92.941397190094
Epoch: 27, Steps: 369 | Train Loss: 0.163 Vali Loss: 2.245 Vali Acc: 0.664 Test Loss: 2.245 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.4985663
	speed: 0.7219s/iter; left time: 19375.6398s
	iters: 200, epoch: 28 | loss: 0.0030404
	speed: 0.2304s/iter; left time: 6161.2334s
	iters: 300, epoch: 28 | loss: 0.2787887
	speed: 0.2340s/iter; left time: 6232.1332s
Epoch: 28 cost time: 86.91905617713928
Epoch: 28, Steps: 369 | Train Loss: 0.146 Vali Loss: 2.047 Vali Acc: 0.643 Test Loss: 2.047 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0019555
	speed: 0.7150s/iter; left time: 18925.9854s
	iters: 200, epoch: 29 | loss: 0.0629600
	speed: 0.2661s/iter; left time: 7018.0470s
	iters: 300, epoch: 29 | loss: 0.0206531
	speed: 0.2712s/iter; left time: 7123.3200s
Epoch: 29 cost time: 98.3772337436676
Epoch: 29, Steps: 369 | Train Loss: 0.143 Vali Loss: 2.014 Vali Acc: 0.659 Test Loss: 2.014 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6677071509648127
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6937626
	speed: 0.2535s/iter; left time: 9327.4583s
	iters: 200, epoch: 1 | loss: 0.6937916
	speed: 0.2401s/iter; left time: 8810.7358s
	iters: 300, epoch: 1 | loss: 0.6926667
	speed: 0.2334s/iter; left time: 8542.5780s
Epoch: 1 cost time: 89.45678615570068
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6924583
	speed: 0.7142s/iter; left time: 26021.4562s
	iters: 200, epoch: 2 | loss: 0.6947049
	speed: 0.2385s/iter; left time: 8666.7449s
	iters: 300, epoch: 2 | loss: 0.6917121
	speed: 0.2409s/iter; left time: 8729.9374s
Epoch: 2 cost time: 90.15328335762024
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6931540
	speed: 0.7361s/iter; left time: 26544.7988s
	iters: 200, epoch: 3 | loss: 0.6924895
	speed: 0.2435s/iter; left time: 8756.0705s
	iters: 300, epoch: 3 | loss: 0.6932136
	speed: 0.2547s/iter; left time: 9133.5332s
Epoch: 3 cost time: 92.98747491836548
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6932747
	speed: 0.7151s/iter; left time: 25526.1536s
	iters: 200, epoch: 4 | loss: 0.6935012
	speed: 0.2357s/iter; left time: 8388.2297s
	iters: 300, epoch: 4 | loss: 0.6929527
	speed: 0.2424s/iter; left time: 8605.1163s
Epoch: 4 cost time: 90.11026811599731
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6928886
	speed: 0.7380s/iter; left time: 26068.9977s
	iters: 200, epoch: 5 | loss: 0.6931843
	speed: 0.2496s/iter; left time: 8790.7340s
	iters: 300, epoch: 5 | loss: 0.6928903
	speed: 0.2265s/iter; left time: 7956.4518s
Epoch: 5 cost time: 89.47787737846375
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6953381
	speed: 0.7308s/iter; left time: 25545.5272s
	iters: 200, epoch: 6 | loss: 0.6925960
	speed: 0.2405s/iter; left time: 8382.7665s
	iters: 300, epoch: 6 | loss: 0.6936672
	speed: 0.2488s/iter; left time: 8646.1068s
Epoch: 6 cost time: 90.93940091133118
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6929407
	speed: 0.6970s/iter; left time: 24107.4205s
	iters: 200, epoch: 7 | loss: 0.6942238
	speed: 0.2395s/iter; left time: 8261.2309s
	iters: 300, epoch: 7 | loss: 0.6913633
	speed: 0.2323s/iter; left time: 7987.3288s
Epoch: 7 cost time: 86.09559750556946
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6927283
	speed: 0.6689s/iter; left time: 22888.4434s
	iters: 200, epoch: 8 | loss: 0.6931527
	speed: 0.2264s/iter; left time: 7725.1381s
	iters: 300, epoch: 8 | loss: 0.6928971
	speed: 0.2267s/iter; left time: 7710.2794s
Epoch: 8 cost time: 84.52989649772644
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6931689
	speed: 0.7134s/iter; left time: 24147.0821s
	iters: 200, epoch: 9 | loss: 0.6928294
	speed: 0.2399s/iter; left time: 8095.1081s
	iters: 300, epoch: 9 | loss: 0.6906316
	speed: 0.2468s/iter; left time: 8304.3643s
Epoch: 9 cost time: 90.94789242744446
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6945018
	speed: 0.7304s/iter; left time: 24452.3526s
	iters: 200, epoch: 10 | loss: 0.6921934
	speed: 0.2336s/iter; left time: 7797.8074s
	iters: 300, epoch: 10 | loss: 0.6931515
	speed: 0.2327s/iter; left time: 7744.2589s
Epoch: 10 cost time: 87.00814700126648
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6937128
	speed: 0.6982s/iter; left time: 23117.5087s
	iters: 200, epoch: 11 | loss: 0.6927027
	speed: 0.2454s/iter; left time: 8102.0711s
	iters: 300, epoch: 11 | loss: 0.6931505
	speed: 0.2445s/iter; left time: 8046.7786s
Epoch: 11 cost time: 91.07764315605164
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.6960834
	speed: 0.7564s/iter; left time: 24767.0818s
	iters: 200, epoch: 12 | loss: 0.6931857
	speed: 0.2574s/iter; left time: 8401.6771s
	iters: 300, epoch: 12 | loss: 0.6931545
	speed: 0.2364s/iter; left time: 7693.8679s
Epoch: 12 cost time: 90.91748428344727
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6925151
	speed: 0.6866s/iter; left time: 22227.9740s
	iters: 200, epoch: 13 | loss: 0.6957384
	speed: 0.2251s/iter; left time: 7264.1013s
	iters: 300, epoch: 13 | loss: 0.6932885
	speed: 0.2235s/iter; left time: 7191.1845s
Epoch: 13 cost time: 83.9983446598053
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.6932424
	speed: 0.6908s/iter; left time: 22107.7922s
	iters: 200, epoch: 14 | loss: 0.6929410
	speed: 0.2337s/iter; left time: 7454.8096s
	iters: 300, epoch: 14 | loss: 0.6854632
	speed: 0.2356s/iter; left time: 7494.5429s
Epoch: 14 cost time: 87.15252256393433
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.6955229
	speed: 0.7263s/iter; left time: 22975.2685s
	iters: 200, epoch: 15 | loss: 0.6938084
	speed: 0.2336s/iter; left time: 7366.1350s
	iters: 300, epoch: 15 | loss: 0.6939090
	speed: 0.2379s/iter; left time: 7477.0383s
Epoch: 15 cost time: 88.50178289413452
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.6932145
	speed: 0.7069s/iter; left time: 22101.5172s
	iters: 200, epoch: 16 | loss: 0.6931683
	speed: 0.2302s/iter; left time: 7173.6607s
	iters: 300, epoch: 16 | loss: 0.6931601
	speed: 0.2328s/iter; left time: 7233.2244s
Epoch: 16 cost time: 87.50402474403381
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.6921893
	speed: 0.7543s/iter; left time: 23306.2926s
	iters: 200, epoch: 17 | loss: 0.6901293
	speed: 0.2513s/iter; left time: 7737.8536s
	iters: 300, epoch: 17 | loss: 0.6941088
	speed: 0.2389s/iter; left time: 7334.4665s
Epoch: 17 cost time: 91.93873953819275
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 2399490
model size : 18.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6638106
	speed: 0.2815s/iter; left time: 10360.7711s
	iters: 200, epoch: 1 | loss: 1.2869570
	speed: 0.2658s/iter; left time: 9754.3640s
	iters: 300, epoch: 1 | loss: 0.5524296
	speed: 0.2683s/iter; left time: 9820.5555s
Epoch: 1 cost time: 98.92006134986877
Epoch: 1, Steps: 369 | Train Loss: 0.664 Vali Loss: 0.693 Vali Acc: 0.662 Test Loss: 0.693 Test Acc: 0.662
Validation loss decreased (inf --> -0.661741).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4955250
	speed: 0.6762s/iter; left time: 24636.9103s
	iters: 200, epoch: 2 | loss: 0.5121885
	speed: 0.2043s/iter; left time: 7422.7511s
	iters: 300, epoch: 2 | loss: 0.8128434
	speed: 0.2062s/iter; left time: 7469.2544s
Epoch: 2 cost time: 78.97053718566895
Epoch: 2, Steps: 369 | Train Loss: 0.559 Vali Loss: 0.845 Vali Acc: 0.650 Test Loss: 0.845 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5410330
	speed: 0.6956s/iter; left time: 25086.8581s
	iters: 200, epoch: 3 | loss: 0.2061636
	speed: 0.2360s/iter; left time: 8485.6185s
	iters: 300, epoch: 3 | loss: 0.5172542
	speed: 0.2443s/iter; left time: 8759.8528s
Epoch: 3 cost time: 87.46357989311218
Epoch: 3, Steps: 369 | Train Loss: 0.522 Vali Loss: 0.892 Vali Acc: 0.662 Test Loss: 0.892 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5684460
	speed: 0.6944s/iter; left time: 24784.9174s
	iters: 200, epoch: 4 | loss: 0.6133648
	speed: 0.2267s/iter; left time: 8069.3502s
	iters: 300, epoch: 4 | loss: 0.1551769
	speed: 0.2342s/iter; left time: 8311.5183s
Epoch: 4 cost time: 87.22143411636353
Epoch: 4, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.968 Vali Acc: 0.660 Test Loss: 0.968 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3132430
	speed: 0.7234s/iter; left time: 25554.6640s
	iters: 200, epoch: 5 | loss: 0.5226628
	speed: 0.2358s/iter; left time: 8307.2915s
	iters: 300, epoch: 5 | loss: 0.6177385
	speed: 0.2333s/iter; left time: 8195.9875s
Epoch: 5 cost time: 88.16114044189453
Epoch: 5, Steps: 369 | Train Loss: 0.462 Vali Loss: 1.091 Vali Acc: 0.667 Test Loss: 1.091 Test Acc: 0.667
Validation loss decreased (-0.661741 --> -0.667412).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2876304
	speed: 0.6790s/iter; left time: 23734.6265s
	iters: 200, epoch: 6 | loss: 1.2365673
	speed: 0.2346s/iter; left time: 8177.3566s
	iters: 300, epoch: 6 | loss: 0.6281468
	speed: 0.2421s/iter; left time: 8414.3986s
Epoch: 6 cost time: 87.95162153244019
Epoch: 6, Steps: 369 | Train Loss: 0.421 Vali Loss: 1.238 Vali Acc: 0.659 Test Loss: 1.238 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2391482
	speed: 0.7211s/iter; left time: 24942.1941s
	iters: 200, epoch: 7 | loss: 0.2095537
	speed: 0.2217s/iter; left time: 7644.4130s
	iters: 300, epoch: 7 | loss: 0.2504501
	speed: 0.2259s/iter; left time: 7767.0635s
Epoch: 7 cost time: 83.64618277549744
Epoch: 7, Steps: 369 | Train Loss: 0.350 Vali Loss: 1.352 Vali Acc: 0.660 Test Loss: 1.352 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3181176
	speed: 0.6936s/iter; left time: 23732.8145s
	iters: 200, epoch: 8 | loss: 0.3051346
	speed: 0.2248s/iter; left time: 7670.6952s
	iters: 300, epoch: 8 | loss: 0.5440009
	speed: 0.2209s/iter; left time: 7515.3061s
Epoch: 8 cost time: 84.33146095275879
Epoch: 8, Steps: 369 | Train Loss: 0.287 Vali Loss: 1.437 Vali Acc: 0.661 Test Loss: 1.437 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1332197
	speed: 0.6664s/iter; left time: 22556.7933s
	iters: 200, epoch: 9 | loss: 0.2203132
	speed: 0.2243s/iter; left time: 7570.8396s
	iters: 300, epoch: 9 | loss: 0.0126869
	speed: 0.2268s/iter; left time: 7632.2348s
Epoch: 9 cost time: 83.89652299880981
Epoch: 9, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.498 Vali Acc: 0.662 Test Loss: 1.498 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0100926
	speed: 0.7434s/iter; left time: 24888.6655s
	iters: 200, epoch: 10 | loss: 0.1372682
	speed: 0.2555s/iter; left time: 8529.8098s
	iters: 300, epoch: 10 | loss: 0.5709064
	speed: 0.2442s/iter; left time: 8126.8083s
Epoch: 10 cost time: 91.87463617324829
Epoch: 10, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.828 Vali Acc: 0.652 Test Loss: 1.828 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3729704
	speed: 0.6826s/iter; left time: 22601.4004s
	iters: 200, epoch: 11 | loss: 0.0475383
	speed: 0.2298s/iter; left time: 7585.7327s
	iters: 300, epoch: 11 | loss: 0.0687841
	speed: 0.2414s/iter; left time: 7945.7001s
Epoch: 11 cost time: 86.2841010093689
Epoch: 11, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.649 Vali Acc: 0.666 Test Loss: 1.649 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2475872
	speed: 0.7226s/iter; left time: 23660.2258s
	iters: 200, epoch: 12 | loss: 0.0865096
	speed: 0.2286s/iter; left time: 7462.0676s
	iters: 300, epoch: 12 | loss: 0.0803367
	speed: 0.2375s/iter; left time: 7730.1440s
Epoch: 12 cost time: 86.85254406929016
Epoch: 12, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.947 Vali Acc: 0.656 Test Loss: 1.947 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0020536
	speed: 0.7081s/iter; left time: 22924.1905s
	iters: 200, epoch: 13 | loss: 0.0807572
	speed: 0.2486s/iter; left time: 8023.9783s
	iters: 300, epoch: 13 | loss: 0.0558448
	speed: 0.2432s/iter; left time: 7825.5730s
Epoch: 13 cost time: 90.43768286705017
Epoch: 13, Steps: 369 | Train Loss: 0.120 Vali Loss: 2.184 Vali Acc: 0.663 Test Loss: 2.184 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2411264
	speed: 0.7058s/iter; left time: 22588.0660s
	iters: 200, epoch: 14 | loss: 0.2775722
	speed: 0.2285s/iter; left time: 7289.5737s
	iters: 300, epoch: 14 | loss: 0.1579770
	speed: 0.2359s/iter; left time: 7501.7832s
Epoch: 14 cost time: 86.3372323513031
Epoch: 14, Steps: 369 | Train Loss: 0.114 Vali Loss: 2.273 Vali Acc: 0.656 Test Loss: 2.273 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0550724
	speed: 0.7094s/iter; left time: 22440.8088s
	iters: 200, epoch: 15 | loss: 0.0025551
	speed: 0.2561s/iter; left time: 8076.7850s
	iters: 300, epoch: 15 | loss: 0.0282133
	speed: 0.2594s/iter; left time: 8153.5381s
Epoch: 15 cost time: 94.0145947933197
Epoch: 15, Steps: 369 | Train Loss: 0.126 Vali Loss: 2.289 Vali Acc: 0.660 Test Loss: 2.289 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6674233825198638
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6957253
	speed: 0.2572s/iter; left time: 9466.8600s
	iters: 200, epoch: 1 | loss: 1.2533393
	speed: 0.2442s/iter; left time: 8962.7259s
	iters: 300, epoch: 1 | loss: 0.5507982
	speed: 0.2549s/iter; left time: 9328.0967s
Epoch: 1 cost time: 92.61553454399109
Epoch: 1, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.704 Vali Acc: 0.648 Test Loss: 0.704 Test Acc: 0.648
Validation loss decreased (inf --> -0.648404).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4164459
	speed: 0.7027s/iter; left time: 25601.3843s
	iters: 200, epoch: 2 | loss: 0.6103182
	speed: 0.2319s/iter; left time: 8423.6931s
	iters: 300, epoch: 2 | loss: 0.7710632
	speed: 0.2195s/iter; left time: 7953.6073s
Epoch: 2 cost time: 84.14126896858215
Epoch: 2, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.824 Vali Acc: 0.647 Test Loss: 0.824 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9394212
	speed: 0.7082s/iter; left time: 25539.2904s
	iters: 200, epoch: 3 | loss: 0.1397540
	speed: 0.2534s/iter; left time: 9113.5386s
	iters: 300, epoch: 3 | loss: 0.3961661
	speed: 0.2404s/iter; left time: 8619.9755s
Epoch: 3 cost time: 91.45595192909241
Epoch: 3, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.975 Vali Acc: 0.638 Test Loss: 0.975 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1127964
	speed: 0.6999s/iter; left time: 24983.3765s
	iters: 200, epoch: 4 | loss: 0.4549406
	speed: 0.2432s/iter; left time: 8657.4484s
	iters: 300, epoch: 4 | loss: 0.2952438
	speed: 0.2727s/iter; left time: 9680.5361s
Epoch: 4 cost time: 93.16693019866943
Epoch: 4, Steps: 369 | Train Loss: 0.467 Vali Loss: 1.062 Vali Acc: 0.662 Test Loss: 1.062 Test Acc: 0.662
Validation loss decreased (-0.648404 --> -0.662021).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2499084
	speed: 0.7360s/iter; left time: 25998.0283s
	iters: 200, epoch: 5 | loss: 0.5116410
	speed: 0.2304s/iter; left time: 8116.0772s
	iters: 300, epoch: 5 | loss: 0.4876778
	speed: 0.2315s/iter; left time: 8130.5489s
Epoch: 5 cost time: 87.34024858474731
Epoch: 5, Steps: 369 | Train Loss: 0.448 Vali Loss: 1.120 Vali Acc: 0.656 Test Loss: 1.120 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7412834
	speed: 0.6802s/iter; left time: 23778.1196s
	iters: 200, epoch: 6 | loss: 0.7656598
	speed: 0.2453s/iter; left time: 8551.5870s
	iters: 300, epoch: 6 | loss: 0.3822530
	speed: 0.2505s/iter; left time: 8707.6472s
Epoch: 6 cost time: 90.36685013771057
Epoch: 6, Steps: 369 | Train Loss: 0.409 Vali Loss: 1.222 Vali Acc: 0.655 Test Loss: 1.222 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1492916
	speed: 0.7514s/iter; left time: 25989.6841s
	iters: 200, epoch: 7 | loss: 0.1391773
	speed: 0.2317s/iter; left time: 7991.7881s
	iters: 300, epoch: 7 | loss: 0.1654323
	speed: 0.2264s/iter; left time: 7783.6065s
Epoch: 7 cost time: 86.44911313056946
Epoch: 7, Steps: 369 | Train Loss: 0.366 Vali Loss: 1.341 Vali Acc: 0.658 Test Loss: 1.341 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3409339
	speed: 0.7028s/iter; left time: 24049.9392s
	iters: 200, epoch: 8 | loss: 0.5728576
	speed: 0.2472s/iter; left time: 8432.4502s
	iters: 300, epoch: 8 | loss: 0.5240960
	speed: 0.2391s/iter; left time: 8134.6344s
Epoch: 8 cost time: 89.81793808937073
Epoch: 8, Steps: 369 | Train Loss: 0.297 Vali Loss: 1.527 Vali Acc: 0.650 Test Loss: 1.527 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0767871
	speed: 0.6863s/iter; left time: 23231.8710s
	iters: 200, epoch: 9 | loss: 0.1688492
	speed: 0.2310s/iter; left time: 7796.0787s
	iters: 300, epoch: 9 | loss: 0.0065651
	speed: 0.2445s/iter; left time: 8226.5189s
Epoch: 9 cost time: 88.1791250705719
Epoch: 9, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.585 Vali Acc: 0.660 Test Loss: 1.585 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0120998
	speed: 0.7427s/iter; left time: 24864.2282s
	iters: 200, epoch: 10 | loss: 0.1325325
	speed: 0.2187s/iter; left time: 7300.9489s
	iters: 300, epoch: 10 | loss: 0.0470012
	speed: 0.2275s/iter; left time: 7570.4095s
Epoch: 10 cost time: 85.55173921585083
Epoch: 10, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.701 Vali Acc: 0.645 Test Loss: 1.701 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2871904
	speed: 0.7299s/iter; left time: 24166.9086s
	iters: 200, epoch: 11 | loss: 0.0148271
	speed: 0.2470s/iter; left time: 8153.5594s
	iters: 300, epoch: 11 | loss: 0.1230981
	speed: 0.2580s/iter; left time: 8491.3269s
Epoch: 11 cost time: 92.70362091064453
Epoch: 11, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.650 Vali Acc: 0.638 Test Loss: 1.650 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3074202
	speed: 0.6961s/iter; left time: 22790.6547s
	iters: 200, epoch: 12 | loss: 0.2650075
	speed: 0.2413s/iter; left time: 7877.6155s
	iters: 300, epoch: 12 | loss: 0.4693144
	speed: 0.2493s/iter; left time: 8113.6431s
Epoch: 12 cost time: 89.91742658615112
Epoch: 12, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.840 Vali Acc: 0.653 Test Loss: 1.840 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0191201
	speed: 0.7436s/iter; left time: 24072.6369s
	iters: 200, epoch: 13 | loss: 0.0520218
	speed: 0.2244s/iter; left time: 7242.8624s
	iters: 300, epoch: 13 | loss: 0.0482643
	speed: 0.2208s/iter; left time: 7103.4906s
Epoch: 13 cost time: 84.79282855987549
Epoch: 13, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.797 Vali Acc: 0.651 Test Loss: 1.797 Test Acc: 0.651
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1982332
	speed: 0.6685s/iter; left time: 21394.5803s
	iters: 200, epoch: 14 | loss: 0.1734419
	speed: 0.2338s/iter; left time: 7459.8769s
	iters: 300, epoch: 14 | loss: 0.0722305
	speed: 0.2294s/iter; left time: 7295.9198s
Epoch: 14 cost time: 86.09668350219727
Epoch: 14, Steps: 369 | Train Loss: 0.095 Vali Loss: 2.104 Vali Acc: 0.653 Test Loss: 2.104 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6620317820658342
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6966072
	speed: 0.2397s/iter; left time: 8819.5762s
	iters: 200, epoch: 1 | loss: 1.0494798
	speed: 0.2267s/iter; left time: 8318.7369s
	iters: 300, epoch: 1 | loss: 0.5696276
	speed: 0.2276s/iter; left time: 8331.8422s
Epoch: 1 cost time: 86.21987962722778
Epoch: 1, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.758 Vali Acc: 0.632 Test Loss: 0.758 Test Acc: 0.632
Validation loss decreased (inf --> -0.631661).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5780388
	speed: 0.7402s/iter; left time: 26965.9865s
	iters: 200, epoch: 2 | loss: 0.6893560
	speed: 0.2487s/iter; left time: 9037.5005s
	iters: 300, epoch: 2 | loss: 0.9922322
	speed: 0.2423s/iter; left time: 8780.7763s
Epoch: 2 cost time: 91.63576197624207
Epoch: 2, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.759 Vali Acc: 0.666 Test Loss: 0.759 Test Acc: 0.666
Validation loss decreased (-0.631661 --> -0.665997).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6167356
	speed: 0.6889s/iter; left time: 24843.6780s
	iters: 200, epoch: 3 | loss: 0.1681249
	speed: 0.2336s/iter; left time: 8399.5444s
	iters: 300, epoch: 3 | loss: 0.4396811
	speed: 0.2356s/iter; left time: 8450.6194s
Epoch: 3 cost time: 86.04949045181274
Epoch: 3, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.897 Vali Acc: 0.635 Test Loss: 0.897 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2377824
	speed: 0.7200s/iter; left time: 25701.4149s
	iters: 200, epoch: 4 | loss: 0.7601039
	speed: 0.2370s/iter; left time: 8435.8139s
	iters: 300, epoch: 4 | loss: 0.2834590
	speed: 0.2321s/iter; left time: 8237.4014s
Epoch: 4 cost time: 88.2986090183258
Epoch: 4, Steps: 369 | Train Loss: 0.500 Vali Loss: 1.050 Vali Acc: 0.640 Test Loss: 1.050 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2250585
	speed: 0.6800s/iter; left time: 24021.9241s
	iters: 200, epoch: 5 | loss: 0.4595289
	speed: 0.2366s/iter; left time: 8334.5969s
	iters: 300, epoch: 5 | loss: 0.6521626
	speed: 0.2284s/iter; left time: 8020.9881s
Epoch: 5 cost time: 85.06223607063293
Epoch: 5, Steps: 369 | Train Loss: 0.472 Vali Loss: 1.129 Vali Acc: 0.644 Test Loss: 1.129 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.8878633
	speed: 0.6853s/iter; left time: 23953.9373s
	iters: 200, epoch: 6 | loss: 0.3316177
	speed: 0.2238s/iter; left time: 7799.8953s
	iters: 300, epoch: 6 | loss: 0.6457939
	speed: 0.2255s/iter; left time: 7836.0946s
Epoch: 6 cost time: 81.8811662197113
Epoch: 6, Steps: 369 | Train Loss: 0.415 Vali Loss: 1.103 Vali Acc: 0.659 Test Loss: 1.103 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0537168
	speed: 0.6639s/iter; left time: 22960.8789s
	iters: 200, epoch: 7 | loss: 0.0253367
	speed: 0.2603s/iter; left time: 8976.1177s
	iters: 300, epoch: 7 | loss: 0.1102111
	speed: 0.2519s/iter; left time: 8660.4293s
Epoch: 7 cost time: 92.99177122116089
Epoch: 7, Steps: 369 | Train Loss: 0.353 Vali Loss: 1.358 Vali Acc: 0.653 Test Loss: 1.358 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2619794
	speed: 0.7132s/iter; left time: 24405.5685s
	iters: 200, epoch: 8 | loss: 0.1009978
	speed: 0.2276s/iter; left time: 7764.2219s
	iters: 300, epoch: 8 | loss: 0.1193119
	speed: 0.2123s/iter; left time: 7223.4690s
Epoch: 8 cost time: 84.75496006011963
Epoch: 8, Steps: 369 | Train Loss: 0.302 Vali Loss: 1.405 Vali Acc: 0.663 Test Loss: 1.405 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1459118
	speed: 0.7197s/iter; left time: 24360.1997s
	iters: 200, epoch: 9 | loss: 0.1323100
	speed: 0.2291s/iter; left time: 7730.7335s
	iters: 300, epoch: 9 | loss: 0.3813481
	speed: 0.2258s/iter; left time: 7597.4607s
Epoch: 9 cost time: 83.72985243797302
Epoch: 9, Steps: 369 | Train Loss: 0.261 Vali Loss: 1.347 Vali Acc: 0.665 Test Loss: 1.347 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0357735
	speed: 0.6718s/iter; left time: 22491.4931s
	iters: 200, epoch: 10 | loss: 0.0991199
	speed: 0.2417s/iter; left time: 8068.4592s
	iters: 300, epoch: 10 | loss: 0.1150621
	speed: 0.2439s/iter; left time: 8116.9854s
Epoch: 10 cost time: 89.55711126327515
Epoch: 10, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.577 Vali Acc: 0.666 Test Loss: 1.577 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0215178
	speed: 0.7356s/iter; left time: 24357.1760s
	iters: 200, epoch: 11 | loss: 0.0151606
	speed: 0.2227s/iter; left time: 7351.4711s
	iters: 300, epoch: 11 | loss: 0.0197434
	speed: 0.2203s/iter; left time: 7251.3214s
Epoch: 11 cost time: 84.13710761070251
Epoch: 11, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.795 Vali Acc: 0.679 Test Loss: 1.795 Test Acc: 0.679
Validation loss decreased (-0.665997 --> -0.679324).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0514382
	speed: 0.6710s/iter; left time: 21971.0093s
	iters: 200, epoch: 12 | loss: 0.2429909
	speed: 0.2273s/iter; left time: 7420.9507s
	iters: 300, epoch: 12 | loss: 0.0341141
	speed: 0.2369s/iter; left time: 7710.8195s
Epoch: 12 cost time: 86.1154625415802
Epoch: 12, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.798 Vali Acc: 0.661 Test Loss: 1.798 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0259935
	speed: 0.6805s/iter; left time: 22031.4015s
	iters: 200, epoch: 13 | loss: 0.0771404
	speed: 0.2296s/iter; left time: 7408.7970s
	iters: 300, epoch: 13 | loss: 0.0505080
	speed: 0.2331s/iter; left time: 7500.5826s
Epoch: 13 cost time: 86.57843899726868
Epoch: 13, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.028 Vali Acc: 0.656 Test Loss: 2.028 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5354324
	speed: 0.7564s/iter; left time: 24209.0134s
	iters: 200, epoch: 14 | loss: 0.2371717
	speed: 0.2407s/iter; left time: 7679.8580s
	iters: 300, epoch: 14 | loss: 0.0553171
	speed: 0.2182s/iter; left time: 6938.6424s
Epoch: 14 cost time: 87.55080580711365
Epoch: 14, Steps: 369 | Train Loss: 0.118 Vali Loss: 2.037 Vali Acc: 0.660 Test Loss: 2.037 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0384613
	speed: 0.6660s/iter; left time: 21068.5120s
	iters: 200, epoch: 15 | loss: 0.0110041
	speed: 0.2302s/iter; left time: 7259.3600s
	iters: 300, epoch: 15 | loss: 0.0169381
	speed: 0.2362s/iter; left time: 7425.3207s
Epoch: 15 cost time: 85.7953531742096
Epoch: 15, Steps: 369 | Train Loss: 0.130 Vali Loss: 2.071 Vali Acc: 0.664 Test Loss: 2.071 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0388313
	speed: 0.6972s/iter; left time: 21800.1084s
	iters: 200, epoch: 16 | loss: 0.0006915
	speed: 0.2220s/iter; left time: 6920.0214s
	iters: 300, epoch: 16 | loss: 0.0130420
	speed: 0.2307s/iter; left time: 7167.1657s
Epoch: 16 cost time: 84.120849609375
Epoch: 16, Steps: 369 | Train Loss: 0.099 Vali Loss: 2.122 Vali Acc: 0.662 Test Loss: 2.122 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0157250
	speed: 0.7190s/iter; left time: 22214.3748s
	iters: 200, epoch: 17 | loss: 0.0823592
	speed: 0.2451s/iter; left time: 7549.6684s
	iters: 300, epoch: 17 | loss: 0.0952121
	speed: 0.2400s/iter; left time: 7366.0125s
Epoch: 17 cost time: 89.73989176750183
Epoch: 17, Steps: 369 | Train Loss: 0.077 Vali Loss: 2.367 Vali Acc: 0.655 Test Loss: 2.367 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000957
	speed: 0.6724s/iter; left time: 20527.6326s
	iters: 200, epoch: 18 | loss: 0.0102166
	speed: 0.2194s/iter; left time: 6674.8098s
	iters: 300, epoch: 18 | loss: 0.1368105
	speed: 0.2337s/iter; left time: 7088.9239s
Epoch: 18 cost time: 84.82409358024597
Epoch: 18, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.245 Vali Acc: 0.648 Test Loss: 2.245 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0388512
	speed: 0.7264s/iter; left time: 21908.0608s
	iters: 200, epoch: 19 | loss: 0.0023148
	speed: 0.2506s/iter; left time: 7532.4518s
	iters: 300, epoch: 19 | loss: 0.0004189
	speed: 0.2296s/iter; left time: 6879.4199s
Epoch: 19 cost time: 89.03435850143433
Epoch: 19, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.612 Vali Acc: 0.648 Test Loss: 2.612 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0214608
	speed: 0.6841s/iter; left time: 20380.2673s
	iters: 200, epoch: 20 | loss: 0.3149356
	speed: 0.2547s/iter; left time: 7561.4423s
	iters: 300, epoch: 20 | loss: 0.0779342
	speed: 0.2407s/iter; left time: 7123.5926s
Epoch: 20 cost time: 89.3878424167633
Epoch: 20, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.428 Vali Acc: 0.653 Test Loss: 2.428 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0025846
	speed: 0.7082s/iter; left time: 20837.2851s
	iters: 200, epoch: 21 | loss: 0.0033243
	speed: 0.2372s/iter; left time: 6954.8032s
	iters: 300, epoch: 21 | loss: 0.0012873
	speed: 0.2309s/iter; left time: 6747.3917s
Epoch: 21 cost time: 86.21093773841858
Epoch: 21, Steps: 369 | Train Loss: 0.081 Vali Loss: 2.362 Vali Acc: 0.659 Test Loss: 2.362 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6793416572077186
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7912418
	speed: 0.2595s/iter; left time: 9549.5193s
	iters: 200, epoch: 1 | loss: 0.9373062
	speed: 0.2421s/iter; left time: 8885.6653s
	iters: 300, epoch: 1 | loss: 0.6266800
	speed: 0.2503s/iter; left time: 9162.7812s
Epoch: 1 cost time: 92.19917249679565
Epoch: 1, Steps: 369 | Train Loss: 0.691 Vali Loss: 0.754 Vali Acc: 0.638 Test Loss: 0.754 Test Acc: 0.638
Validation loss decreased (inf --> -0.638471).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4249836
	speed: 0.7297s/iter; left time: 26585.7716s
	iters: 200, epoch: 2 | loss: 0.4639819
	speed: 0.2634s/iter; left time: 9569.5387s
	iters: 300, epoch: 2 | loss: 0.9308105
	speed: 0.2725s/iter; left time: 9873.9208s
Epoch: 2 cost time: 97.39429640769958
Epoch: 2, Steps: 369 | Train Loss: 0.577 Vali Loss: 0.830 Vali Acc: 0.665 Test Loss: 0.830 Test Acc: 0.665
Validation loss decreased (-0.638471 --> -0.665429).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6500701
	speed: 0.7422s/iter; left time: 26766.1661s
	iters: 200, epoch: 3 | loss: 0.3316391
	speed: 0.2234s/iter; left time: 8035.8497s
	iters: 300, epoch: 3 | loss: 0.5477748
	speed: 0.2281s/iter; left time: 8178.7425s
Epoch: 3 cost time: 83.79959321022034
Epoch: 3, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.985 Vali Acc: 0.650 Test Loss: 0.985 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2038137
	speed: 0.6929s/iter; left time: 24732.9474s
	iters: 200, epoch: 4 | loss: 0.5496650
	speed: 0.2230s/iter; left time: 7938.9874s
	iters: 300, epoch: 4 | loss: 0.2148727
	speed: 0.2312s/iter; left time: 8207.9058s
Epoch: 4 cost time: 86.35210490226746
Epoch: 4, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.996 Vali Acc: 0.660 Test Loss: 0.996 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0680950
	speed: 0.7027s/iter; left time: 24823.0105s
	iters: 200, epoch: 5 | loss: 0.4250193
	speed: 0.2221s/iter; left time: 7821.7839s
	iters: 300, epoch: 5 | loss: 0.7163878
	speed: 0.2164s/iter; left time: 7600.1627s
Epoch: 5 cost time: 83.24480295181274
Epoch: 5, Steps: 369 | Train Loss: 0.467 Vali Loss: 1.051 Vali Acc: 0.651 Test Loss: 1.051 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1838937
	speed: 0.6579s/iter; left time: 22999.2909s
	iters: 200, epoch: 6 | loss: 0.3918404
	speed: 0.2269s/iter; left time: 7910.3787s
	iters: 300, epoch: 6 | loss: 0.5325529
	speed: 0.2207s/iter; left time: 7671.6330s
Epoch: 6 cost time: 82.97635173797607
Epoch: 6, Steps: 369 | Train Loss: 0.439 Vali Loss: 1.025 Vali Acc: 0.641 Test Loss: 1.025 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3948407
	speed: 0.6788s/iter; left time: 23477.4800s
	iters: 200, epoch: 7 | loss: 0.3491070
	speed: 0.2250s/iter; left time: 7758.7808s
	iters: 300, epoch: 7 | loss: 0.0501157
	speed: 0.2263s/iter; left time: 7781.0385s
Epoch: 7 cost time: 84.42985653877258
Epoch: 7, Steps: 369 | Train Loss: 0.373 Vali Loss: 1.201 Vali Acc: 0.654 Test Loss: 1.201 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1904636
	speed: 0.7647s/iter; left time: 26165.2749s
	iters: 200, epoch: 8 | loss: 0.0627050
	speed: 0.2782s/iter; left time: 9492.1406s
	iters: 300, epoch: 8 | loss: 0.1127242
	speed: 0.2677s/iter; left time: 9107.8816s
Epoch: 8 cost time: 101.30217361450195
Epoch: 8, Steps: 369 | Train Loss: 0.289 Vali Loss: 1.344 Vali Acc: 0.642 Test Loss: 1.344 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1868603
	speed: 0.7501s/iter; left time: 25390.8242s
	iters: 200, epoch: 9 | loss: 0.3496855
	speed: 0.2396s/iter; left time: 8085.9416s
	iters: 300, epoch: 9 | loss: 0.2447450
	speed: 0.2565s/iter; left time: 8630.5542s
Epoch: 9 cost time: 89.90813899040222
Epoch: 9, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.380 Vali Acc: 0.644 Test Loss: 1.380 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1904391
	speed: 0.7283s/iter; left time: 24384.0266s
	iters: 200, epoch: 10 | loss: 0.1362873
	speed: 0.2485s/iter; left time: 8294.4656s
	iters: 300, epoch: 10 | loss: 0.3649046
	speed: 0.2671s/iter; left time: 8887.6311s
Epoch: 10 cost time: 91.9956419467926
Epoch: 10, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.399 Vali Acc: 0.650 Test Loss: 1.399 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0496454
	speed: 0.7073s/iter; left time: 23420.2769s
	iters: 200, epoch: 11 | loss: 0.1209086
	speed: 0.2440s/iter; left time: 8055.3858s
	iters: 300, epoch: 11 | loss: 0.0435325
	speed: 0.2609s/iter; left time: 8586.4650s
Epoch: 11 cost time: 92.91515970230103
Epoch: 11, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.451 Vali Acc: 0.665 Test Loss: 1.451 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0573494
	speed: 0.7168s/iter; left time: 23470.1216s
	iters: 200, epoch: 12 | loss: 0.1328572
	speed: 0.2327s/iter; left time: 7594.9351s
	iters: 300, epoch: 12 | loss: 0.5195223
	speed: 0.2356s/iter; left time: 7667.4542s
Epoch: 12 cost time: 85.81235575675964
Epoch: 12, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.521 Vali Acc: 0.659 Test Loss: 1.521 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7927592
	speed: 0.2841s/iter; left time: 10456.6561s
	iters: 200, epoch: 1 | loss: 1.1153570
	speed: 0.2534s/iter; left time: 9298.4349s
	iters: 300, epoch: 1 | loss: 0.6042511
	speed: 0.2531s/iter; left time: 9264.3006s
Epoch: 1 cost time: 96.39843225479126
Epoch: 1, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.729 Vali Acc: 0.645 Test Loss: 0.729 Test Acc: 0.645
Validation loss decreased (inf --> -0.644998).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6726038
	speed: 0.7486s/iter; left time: 27271.3266s
	iters: 200, epoch: 2 | loss: 0.6915393
	speed: 0.2555s/iter; left time: 9282.5223s
	iters: 300, epoch: 2 | loss: 1.0098701
	speed: 0.2453s/iter; left time: 8888.4564s
Epoch: 2 cost time: 93.28188872337341
Epoch: 2, Steps: 369 | Train Loss: 0.578 Vali Loss: 0.854 Vali Acc: 0.667 Test Loss: 0.854 Test Acc: 0.667
Validation loss decreased (-0.644998 --> -0.667131).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6998495
	speed: 0.7000s/iter; left time: 25245.1109s
	iters: 200, epoch: 3 | loss: 0.3490227
	speed: 0.2162s/iter; left time: 7774.3113s
	iters: 300, epoch: 3 | loss: 0.6531630
	speed: 0.2335s/iter; left time: 8373.4037s
Epoch: 3 cost time: 85.22219681739807
Epoch: 3, Steps: 369 | Train Loss: 0.555 Vali Loss: 0.915 Vali Acc: 0.658 Test Loss: 0.915 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1060513
	speed: 0.7111s/iter; left time: 25380.7557s
	iters: 200, epoch: 4 | loss: 0.3782464
	speed: 0.2591s/iter; left time: 9221.8228s
	iters: 300, epoch: 4 | loss: 0.3864561
	speed: 0.2333s/iter; left time: 8279.7035s
Epoch: 4 cost time: 88.68838596343994
Epoch: 4, Steps: 369 | Train Loss: 0.514 Vali Loss: 0.993 Vali Acc: 0.671 Test Loss: 0.993 Test Acc: 0.671
Validation loss decreased (-0.667131 --> -0.670819).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3880453
	speed: 0.6851s/iter; left time: 24200.4822s
	iters: 200, epoch: 5 | loss: 0.8213283
	speed: 0.2397s/iter; left time: 8444.0867s
	iters: 300, epoch: 5 | loss: 0.0993169
	speed: 0.2370s/iter; left time: 8324.4651s
Epoch: 5 cost time: 87.98088884353638
Epoch: 5, Steps: 369 | Train Loss: 0.484 Vali Loss: 0.948 Vali Acc: 0.647 Test Loss: 0.948 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9708124
	speed: 0.7288s/iter; left time: 25477.3917s
	iters: 200, epoch: 6 | loss: 0.4366259
	speed: 0.2292s/iter; left time: 7989.2991s
	iters: 300, epoch: 6 | loss: 0.4649019
	speed: 0.2423s/iter; left time: 8421.1660s
Epoch: 6 cost time: 88.6585202217102
Epoch: 6, Steps: 369 | Train Loss: 0.448 Vali Loss: 1.105 Vali Acc: 0.631 Test Loss: 1.105 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0478402
	speed: 0.7152s/iter; left time: 24735.1153s
	iters: 200, epoch: 7 | loss: 0.2618295
	speed: 0.2805s/iter; left time: 9672.8157s
	iters: 300, epoch: 7 | loss: 0.1836979
	speed: 0.2686s/iter; left time: 9237.2470s
Epoch: 7 cost time: 98.51277327537537
Epoch: 7, Steps: 369 | Train Loss: 0.392 Vali Loss: 1.251 Vali Acc: 0.654 Test Loss: 1.251 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1867765
	speed: 0.7128s/iter; left time: 24390.1224s
	iters: 200, epoch: 8 | loss: 0.3665176
	speed: 0.2361s/iter; left time: 8055.6666s
	iters: 300, epoch: 8 | loss: 0.2992125
	speed: 0.2398s/iter; left time: 8156.9909s
Epoch: 8 cost time: 89.23561382293701
Epoch: 8, Steps: 369 | Train Loss: 0.330 Vali Loss: 1.360 Vali Acc: 0.651 Test Loss: 1.360 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3323694
	speed: 0.7347s/iter; left time: 24869.9195s
	iters: 200, epoch: 9 | loss: 0.2870091
	speed: 0.2323s/iter; left time: 7840.4453s
	iters: 300, epoch: 9 | loss: 0.2152876
	speed: 0.2309s/iter; left time: 7770.5119s
Epoch: 9 cost time: 87.49305891990662
Epoch: 9, Steps: 369 | Train Loss: 0.288 Vali Loss: 1.487 Vali Acc: 0.653 Test Loss: 1.487 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3268549
	speed: 0.7357s/iter; left time: 24630.1667s
	iters: 200, epoch: 10 | loss: 0.2941882
	speed: 0.2542s/iter; left time: 8486.4238s
	iters: 300, epoch: 10 | loss: 0.6168033
	speed: 0.2467s/iter; left time: 8211.8185s
Epoch: 10 cost time: 93.55220413208008
Epoch: 10, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.435 Vali Acc: 0.642 Test Loss: 1.435 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0173795
	speed: 0.7293s/iter; left time: 24147.9292s
	iters: 200, epoch: 11 | loss: 0.0425479
	speed: 0.2359s/iter; left time: 7786.4384s
	iters: 300, epoch: 11 | loss: 0.1164282
	speed: 0.2541s/iter; left time: 8361.6153s
Epoch: 11 cost time: 91.46505928039551
Epoch: 11, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.508 Vali Acc: 0.656 Test Loss: 1.508 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1934148
	speed: 0.7377s/iter; left time: 24155.0328s
	iters: 200, epoch: 12 | loss: 0.1567406
	speed: 0.2370s/iter; left time: 7735.1216s
	iters: 300, epoch: 12 | loss: 0.0030580
	speed: 0.2240s/iter; left time: 7290.1068s
Epoch: 12 cost time: 86.4772424697876
Epoch: 12, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.617 Vali Acc: 0.659 Test Loss: 1.617 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0619541
	speed: 0.7142s/iter; left time: 23120.9343s
	iters: 200, epoch: 13 | loss: 0.1014850
	speed: 0.2602s/iter; left time: 8398.2509s
	iters: 300, epoch: 13 | loss: 0.0918928
	speed: 0.2444s/iter; left time: 7862.8425s
Epoch: 13 cost time: 92.56578350067139
Epoch: 13, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.846 Vali Acc: 0.654 Test Loss: 1.846 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.4244660
	speed: 0.7323s/iter; left time: 23436.0364s
	iters: 200, epoch: 14 | loss: 0.1029483
	speed: 0.2319s/iter; left time: 7399.1850s
	iters: 300, epoch: 14 | loss: 0.0578185
	speed: 0.2373s/iter; left time: 7547.8167s
Epoch: 14 cost time: 86.96658635139465
Epoch: 14, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.798 Vali Acc: 0.659 Test Loss: 1.798 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6708286038592508
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7410495
	speed: 0.2478s/iter; left time: 9118.2463s
	iters: 200, epoch: 1 | loss: 0.9039961
	speed: 0.2349s/iter; left time: 8622.5089s
	iters: 300, epoch: 1 | loss: 0.6167045
	speed: 0.2364s/iter; left time: 8653.9763s
Epoch: 1 cost time: 88.6577308177948
Epoch: 1, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.724 Vali Acc: 0.638 Test Loss: 0.724 Test Acc: 0.638
Validation loss decreased (inf --> -0.638188).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7427745
	speed: 0.7410s/iter; left time: 26995.8228s
	iters: 200, epoch: 2 | loss: 0.7039950
	speed: 0.2598s/iter; left time: 9437.4882s
	iters: 300, epoch: 2 | loss: 1.4011226
	speed: 0.2457s/iter; left time: 8902.2645s
Epoch: 2 cost time: 92.10494494438171
Epoch: 2, Steps: 369 | Train Loss: 0.586 Vali Loss: 0.868 Vali Acc: 0.667 Test Loss: 0.868 Test Acc: 0.667
Validation loss decreased (-0.638188 --> -0.667131).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9268853
	speed: 0.7264s/iter; left time: 26197.2238s
	iters: 200, epoch: 3 | loss: 0.5976369
	speed: 0.2641s/iter; left time: 9496.2707s
	iters: 300, epoch: 3 | loss: 0.5752285
	speed: 0.2603s/iter; left time: 9336.8847s
Epoch: 3 cost time: 95.35717749595642
Epoch: 3, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.997 Vali Acc: 0.669 Test Loss: 0.997 Test Acc: 0.669
Validation loss decreased (-0.667131 --> -0.669400).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1296781
	speed: 0.7338s/iter; left time: 26192.8936s
	iters: 200, epoch: 4 | loss: 0.3341903
	speed: 0.2743s/iter; left time: 9764.0322s
	iters: 300, epoch: 4 | loss: 0.2476091
	speed: 0.2640s/iter; left time: 9369.2288s
Epoch: 4 cost time: 96.76934885978699
Epoch: 4, Steps: 369 | Train Loss: 0.515 Vali Loss: 1.032 Vali Acc: 0.676 Test Loss: 1.032 Test Acc: 0.676
Validation loss decreased (-0.669400 --> -0.675926).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2672684
	speed: 0.7717s/iter; left time: 27261.8167s
	iters: 200, epoch: 5 | loss: 0.7449803
	speed: 0.2708s/iter; left time: 9538.4291s
	iters: 300, epoch: 5 | loss: 0.4269027
	speed: 0.2459s/iter; left time: 8636.3484s
Epoch: 5 cost time: 95.7594006061554
Epoch: 5, Steps: 369 | Train Loss: 0.493 Vali Loss: 1.080 Vali Acc: 0.656 Test Loss: 1.080 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9725755
	speed: 0.7207s/iter; left time: 25193.6379s
	iters: 200, epoch: 6 | loss: 0.6192888
	speed: 0.2360s/iter; left time: 8225.3477s
	iters: 300, epoch: 6 | loss: 0.2957391
	speed: 0.2403s/iter; left time: 8351.9629s
Epoch: 6 cost time: 89.38160586357117
Epoch: 6, Steps: 369 | Train Loss: 0.454 Vali Loss: 1.155 Vali Acc: 0.631 Test Loss: 1.155 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1240282
	speed: 0.7459s/iter; left time: 25797.4828s
	iters: 200, epoch: 7 | loss: 0.3746629
	speed: 0.2724s/iter; left time: 9392.5784s
	iters: 300, epoch: 7 | loss: 0.2472174
	speed: 0.2745s/iter; left time: 9440.4218s
Epoch: 7 cost time: 97.08798861503601
Epoch: 7, Steps: 369 | Train Loss: 0.389 Vali Loss: 1.256 Vali Acc: 0.633 Test Loss: 1.256 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4320626
	speed: 0.7412s/iter; left time: 25363.2175s
	iters: 200, epoch: 8 | loss: 0.3412425
	speed: 0.2663s/iter; left time: 9085.5576s
	iters: 300, epoch: 8 | loss: 0.3874085
	speed: 0.2575s/iter; left time: 8758.4318s
Epoch: 8 cost time: 95.6851179599762
Epoch: 8, Steps: 369 | Train Loss: 0.322 Vali Loss: 1.292 Vali Acc: 0.642 Test Loss: 1.292 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1030939
	speed: 0.7324s/iter; left time: 24792.0433s
	iters: 200, epoch: 9 | loss: 0.1879571
	speed: 0.2605s/iter; left time: 8790.4840s
	iters: 300, epoch: 9 | loss: 0.0825846
	speed: 0.2711s/iter; left time: 9122.0912s
Epoch: 9 cost time: 95.71636390686035
Epoch: 9, Steps: 369 | Train Loss: 0.259 Vali Loss: 1.287 Vali Acc: 0.652 Test Loss: 1.287 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2073193
	speed: 0.7554s/iter; left time: 25289.1641s
	iters: 200, epoch: 10 | loss: 0.3539607
	speed: 0.2680s/iter; left time: 8947.0974s
	iters: 300, epoch: 10 | loss: 0.3508943
	speed: 0.2604s/iter; left time: 8667.0552s
Epoch: 10 cost time: 96.16325330734253
Epoch: 10, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.372 Vali Acc: 0.650 Test Loss: 1.372 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0335539
	speed: 0.7455s/iter; left time: 24685.2478s
	iters: 200, epoch: 11 | loss: 0.3859290
	speed: 0.2353s/iter; left time: 7767.0948s
	iters: 300, epoch: 11 | loss: 0.5591300
	speed: 0.2460s/iter; left time: 8095.9877s
Epoch: 11 cost time: 90.12053608894348
Epoch: 11, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.580 Vali Acc: 0.661 Test Loss: 1.580 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0701201
	speed: 0.7168s/iter; left time: 23470.6509s
	iters: 200, epoch: 12 | loss: 0.0418242
	speed: 0.2392s/iter; left time: 7807.7045s
	iters: 300, epoch: 12 | loss: 0.0560504
	speed: 0.2345s/iter; left time: 7631.2282s
Epoch: 12 cost time: 90.74697399139404
Epoch: 12, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.611 Vali Acc: 0.649 Test Loss: 1.611 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0066068
	speed: 0.7108s/iter; left time: 23011.2829s
	iters: 200, epoch: 13 | loss: 0.0759091
	speed: 0.2624s/iter; left time: 8468.2529s
	iters: 300, epoch: 13 | loss: 0.0418603
	speed: 0.2557s/iter; left time: 8225.3160s
Epoch: 13 cost time: 94.74229073524475
Epoch: 13, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.654 Vali Acc: 0.667 Test Loss: 1.654 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.3331379
	speed: 0.7928s/iter; left time: 25372.0821s
	iters: 200, epoch: 14 | loss: 0.2856948
	speed: 0.2502s/iter; left time: 7980.8282s
	iters: 300, epoch: 14 | loss: 0.1982602
	speed: 0.2465s/iter; left time: 7839.6493s
Epoch: 14 cost time: 92.76505708694458
Epoch: 14, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.813 Vali Acc: 0.651 Test Loss: 1.813 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6759364358683314
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6741258
	speed: 0.2650s/iter; left time: 9752.9114s
	iters: 200, epoch: 1 | loss: 0.9411203
	speed: 0.2508s/iter; left time: 9205.2515s
	iters: 300, epoch: 1 | loss: 0.5924332
	speed: 0.2580s/iter; left time: 9441.3435s
Epoch: 1 cost time: 95.07957530021667
Epoch: 1, Steps: 369 | Train Loss: 0.707 Vali Loss: 0.721 Vali Acc: 0.642 Test Loss: 0.721 Test Acc: 0.642
Validation loss decreased (inf --> -0.641593).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8533654
	speed: 0.7085s/iter; left time: 25811.8396s
	iters: 200, epoch: 2 | loss: 0.8866627
	speed: 0.2458s/iter; left time: 8928.6022s
	iters: 300, epoch: 2 | loss: 0.9483196
	speed: 0.2401s/iter; left time: 8701.0067s
Epoch: 2 cost time: 87.31715655326843
Epoch: 2, Steps: 369 | Train Loss: 0.605 Vali Loss: 0.801 Vali Acc: 0.668 Test Loss: 0.801 Test Acc: 0.668
Validation loss decreased (-0.641593 --> -0.668267).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7305877
	speed: 0.6927s/iter; left time: 24981.8536s
	iters: 200, epoch: 3 | loss: 0.6826996
	speed: 0.2209s/iter; left time: 7944.4234s
	iters: 300, epoch: 3 | loss: 0.6524128
	speed: 0.2201s/iter; left time: 7893.5676s
Epoch: 3 cost time: 83.25256061553955
Epoch: 3, Steps: 369 | Train Loss: 0.552 Vali Loss: 0.842 Vali Acc: 0.672 Test Loss: 0.842 Test Acc: 0.672
Validation loss decreased (-0.668267 --> -0.671671).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2797737
	speed: 0.6743s/iter; left time: 24067.0730s
	iters: 200, epoch: 4 | loss: 0.9511877
	speed: 0.2387s/iter; left time: 8497.3166s
	iters: 300, epoch: 4 | loss: 0.1665333
	speed: 0.2323s/iter; left time: 8244.5651s
Epoch: 4 cost time: 87.87654781341553
Epoch: 4, Steps: 369 | Train Loss: 0.523 Vali Loss: 1.084 Vali Acc: 0.674 Test Loss: 1.084 Test Acc: 0.674
Validation loss decreased (-0.671671 --> -0.673939).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1925457
	speed: 0.7323s/iter; left time: 25867.8616s
	iters: 200, epoch: 5 | loss: 0.7789947
	speed: 0.2325s/iter; left time: 8189.6278s
	iters: 300, epoch: 5 | loss: 0.4175082
	speed: 0.2348s/iter; left time: 8247.0346s
Epoch: 5 cost time: 86.9962329864502
Epoch: 5, Steps: 369 | Train Loss: 0.522 Vali Loss: 1.046 Vali Acc: 0.644 Test Loss: 1.046 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9321704
	speed: 0.7322s/iter; left time: 25594.0829s
	iters: 200, epoch: 6 | loss: 0.7201737
	speed: 0.2385s/iter; left time: 8313.4263s
	iters: 300, epoch: 6 | loss: 0.3815150
	speed: 0.2399s/iter; left time: 8338.3254s
Epoch: 6 cost time: 90.1197144985199
Epoch: 6, Steps: 369 | Train Loss: 0.438 Vali Loss: 1.074 Vali Acc: 0.648 Test Loss: 1.074 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1015936
	speed: 0.6930s/iter; left time: 23968.5478s
	iters: 200, epoch: 7 | loss: 0.2511658
	speed: 0.2307s/iter; left time: 7954.6001s
	iters: 300, epoch: 7 | loss: 0.2016355
	speed: 0.2363s/iter; left time: 8124.4388s
Epoch: 7 cost time: 87.36780261993408
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 1.025 Vali Acc: 0.652 Test Loss: 1.025 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4742115
	speed: 0.7473s/iter; left time: 25569.6908s
	iters: 200, epoch: 8 | loss: 0.2731774
	speed: 0.2495s/iter; left time: 8514.0036s
	iters: 300, epoch: 8 | loss: 0.3568207
	speed: 0.2286s/iter; left time: 7776.9207s
Epoch: 8 cost time: 88.92005848884583
Epoch: 8, Steps: 369 | Train Loss: 0.339 Vali Loss: 1.139 Vali Acc: 0.655 Test Loss: 1.139 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1974636
	speed: 0.6623s/iter; left time: 22418.0867s
	iters: 200, epoch: 9 | loss: 0.4058126
	speed: 0.2165s/iter; left time: 7307.8272s
	iters: 300, epoch: 9 | loss: 0.2465918
	speed: 0.2311s/iter; left time: 7776.9967s
Epoch: 9 cost time: 83.87598323822021
Epoch: 9, Steps: 369 | Train Loss: 0.283 Vali Loss: 1.097 Vali Acc: 0.675 Test Loss: 1.097 Test Acc: 0.675
Validation loss decreased (-0.673939 --> -0.675074).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1258765
	speed: 0.7109s/iter; left time: 23801.9789s
	iters: 200, epoch: 10 | loss: 0.0729624
	speed: 0.2182s/iter; left time: 7282.2918s
	iters: 300, epoch: 10 | loss: 0.2099425
	speed: 0.2210s/iter; left time: 7354.0841s
Epoch: 10 cost time: 83.10193490982056
Epoch: 10, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.168 Vali Acc: 0.658 Test Loss: 1.168 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1039401
	speed: 0.7083s/iter; left time: 23452.8207s
	iters: 200, epoch: 11 | loss: 0.1399850
	speed: 0.2538s/iter; left time: 8378.9408s
	iters: 300, epoch: 11 | loss: 0.1355689
	speed: 0.2435s/iter; left time: 8012.9103s
Epoch: 11 cost time: 92.92433476448059
Epoch: 11, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.320 Vali Acc: 0.648 Test Loss: 1.320 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0935463
	speed: 0.7574s/iter; left time: 24799.9075s
	iters: 200, epoch: 12 | loss: 0.0736232
	speed: 0.2290s/iter; left time: 7476.4537s
	iters: 300, epoch: 12 | loss: 0.0728424
	speed: 0.2249s/iter; left time: 7318.2635s
Epoch: 12 cost time: 84.61314177513123
Epoch: 12, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.496 Vali Acc: 0.654 Test Loss: 1.496 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0091255
	speed: 0.7156s/iter; left time: 23166.8897s
	iters: 200, epoch: 13 | loss: 0.0017692
	speed: 0.2424s/iter; left time: 7824.4645s
	iters: 300, epoch: 13 | loss: 0.0764442
	speed: 0.2433s/iter; left time: 7827.2355s
Epoch: 13 cost time: 90.54447937011719
Epoch: 13, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.560 Vali Acc: 0.659 Test Loss: 1.560 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0744146
	speed: 0.7093s/iter; left time: 22701.1903s
	iters: 200, epoch: 14 | loss: 0.0659621
	speed: 0.2251s/iter; left time: 7182.5525s
	iters: 300, epoch: 14 | loss: 0.0329887
	speed: 0.2220s/iter; left time: 7060.6234s
Epoch: 14 cost time: 83.7691867351532
Epoch: 14, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.609 Vali Acc: 0.650 Test Loss: 1.609 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0022935
	speed: 0.6953s/iter; left time: 21994.3692s
	iters: 200, epoch: 15 | loss: 0.0732993
	speed: 0.2377s/iter; left time: 7494.9771s
	iters: 300, epoch: 15 | loss: 0.0604377
	speed: 0.2404s/iter; left time: 7557.8506s
Epoch: 15 cost time: 87.9677357673645
Epoch: 15, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.731 Vali Acc: 0.663 Test Loss: 1.731 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1291026
	speed: 0.6860s/iter; left time: 21447.9826s
	iters: 200, epoch: 16 | loss: 0.0005967
	speed: 0.2541s/iter; left time: 7919.1911s
	iters: 300, epoch: 16 | loss: 0.0984004
	speed: 0.2431s/iter; left time: 7553.3682s
Epoch: 16 cost time: 90.96243691444397
Epoch: 16, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.579 Vali Acc: 0.647 Test Loss: 1.579 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0156229
	speed: 0.7556s/iter; left time: 23344.7610s
	iters: 200, epoch: 17 | loss: 0.0564894
	speed: 0.2287s/iter; left time: 7044.0459s
	iters: 300, epoch: 17 | loss: 0.1577501
	speed: 0.2462s/iter; left time: 7557.1757s
Epoch: 17 cost time: 90.83547043800354
Epoch: 17, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.987 Vali Acc: 0.642 Test Loss: 1.987 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2538638
	speed: 0.7285s/iter; left time: 22240.8592s
	iters: 200, epoch: 18 | loss: 0.0186975
	speed: 0.2427s/iter; left time: 7385.2386s
	iters: 300, epoch: 18 | loss: 0.0210280
	speed: 0.2279s/iter; left time: 6912.9544s
Epoch: 18 cost time: 87.13706851005554
Epoch: 18, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.980 Vali Acc: 0.655 Test Loss: 1.980 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0603434
	speed: 0.7145s/iter; left time: 21548.7748s
	iters: 200, epoch: 19 | loss: 0.1001936
	speed: 0.2584s/iter; left time: 7765.8076s
	iters: 300, epoch: 19 | loss: 0.1112804
	speed: 0.2408s/iter; left time: 7215.5663s
Epoch: 19 cost time: 91.97129130363464
Epoch: 19, Steps: 369 | Train Loss: 0.087 Vali Loss: 2.027 Vali Acc: 0.671 Test Loss: 2.027 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6750851305334846
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6929702
	speed: 0.2713s/iter; left time: 9983.7264s
	iters: 200, epoch: 1 | loss: 0.6928387
	speed: 0.2356s/iter; left time: 8646.1530s
	iters: 300, epoch: 1 | loss: 0.6931535
	speed: 0.2234s/iter; left time: 8176.0500s
Epoch: 1 cost time: 87.76947689056396
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6930603
	speed: 0.6732s/iter; left time: 24526.4921s
	iters: 200, epoch: 2 | loss: 0.6936284
	speed: 0.2564s/iter; left time: 9316.9137s
	iters: 300, epoch: 2 | loss: 0.6931472
	speed: 0.2317s/iter; left time: 8394.6002s
Epoch: 2 cost time: 89.74200010299683
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6930243
	speed: 0.7260s/iter; left time: 26182.8647s
	iters: 200, epoch: 3 | loss: 0.6921787
	speed: 0.2504s/iter; left time: 9004.5495s
	iters: 300, epoch: 3 | loss: 0.6948903
	speed: 0.2250s/iter; left time: 8068.4152s
Epoch: 3 cost time: 88.16026544570923
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6931472
	speed: 0.7090s/iter; left time: 25307.1796s
	iters: 200, epoch: 4 | loss: 0.6921975
	speed: 0.2329s/iter; left time: 8290.9683s
	iters: 300, epoch: 4 | loss: 0.6933848
	speed: 0.2323s/iter; left time: 8245.4732s
Epoch: 4 cost time: 88.84039664268494
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6927764
	speed: 0.7488s/iter; left time: 26451.5053s
	iters: 200, epoch: 5 | loss: 0.6929639
	speed: 0.2435s/iter; left time: 8577.4893s
	iters: 300, epoch: 5 | loss: 0.6929989
	speed: 0.2464s/iter; left time: 8655.5024s
Epoch: 5 cost time: 91.51596283912659
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6941782
	speed: 0.6822s/iter; left time: 23846.9673s
	iters: 200, epoch: 6 | loss: 0.6925128
	speed: 0.2201s/iter; left time: 7671.3341s
	iters: 300, epoch: 6 | loss: 0.6931635
	speed: 0.2224s/iter; left time: 7728.0431s
Epoch: 6 cost time: 82.41181683540344
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6907596
	speed: 0.7083s/iter; left time: 24496.8441s
	iters: 200, epoch: 7 | loss: 0.6931558
	speed: 0.2403s/iter; left time: 8287.7031s
	iters: 300, epoch: 7 | loss: 0.6931472
	speed: 0.2310s/iter; left time: 7944.6833s
Epoch: 7 cost time: 87.54380869865417
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6925219
	speed: 0.6978s/iter; left time: 23877.4281s
	iters: 200, epoch: 8 | loss: 0.6931521
	speed: 0.2218s/iter; left time: 7568.5151s
	iters: 300, epoch: 8 | loss: 0.6933759
	speed: 0.2233s/iter; left time: 7596.9141s
Epoch: 8 cost time: 83.21471738815308
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6930792
	speed: 0.6724s/iter; left time: 22760.0516s
	iters: 200, epoch: 9 | loss: 0.6903730
	speed: 0.2303s/iter; left time: 7772.0847s
	iters: 300, epoch: 9 | loss: 0.6996430
	speed: 0.2386s/iter; left time: 8028.5911s
Epoch: 9 cost time: 86.60290050506592
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6926603
	speed: 0.7312s/iter; left time: 24482.2345s
	iters: 200, epoch: 10 | loss: 0.6931474
	speed: 0.2429s/iter; left time: 8108.7085s
	iters: 300, epoch: 10 | loss: 0.6943423
	speed: 0.2469s/iter; left time: 8216.1934s
Epoch: 10 cost time: 88.30873560905457
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6929947
	speed: 0.6691s/iter; left time: 22154.4312s
	iters: 200, epoch: 11 | loss: 0.6931510
	speed: 0.2120s/iter; left time: 6998.8430s
	iters: 300, epoch: 11 | loss: 0.6935093
	speed: 0.2280s/iter; left time: 7503.7725s
Epoch: 11 cost time: 83.58093786239624
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.6935827
	speed: 0.6800s/iter; left time: 22264.9489s
	iters: 200, epoch: 12 | loss: 0.6928776
	speed: 0.2303s/iter; left time: 7518.4590s
	iters: 300, epoch: 12 | loss: 0.6959978
	speed: 0.2330s/iter; left time: 7582.8818s
Epoch: 12 cost time: 86.39898371696472
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6922325
	speed: 0.7024s/iter; left time: 22740.2444s
	iters: 200, epoch: 13 | loss: 0.6934995
	speed: 0.2149s/iter; left time: 6933.9877s
	iters: 300, epoch: 13 | loss: 0.6931472
	speed: 0.2236s/iter; left time: 7192.6027s
Epoch: 13 cost time: 80.9361879825592
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6929342
	speed: 0.6726s/iter; left time: 21527.4030s
	iters: 200, epoch: 14 | loss: 0.6930450
	speed: 0.2258s/iter; left time: 7203.9227s
	iters: 300, epoch: 14 | loss: 0.6931590
	speed: 0.2224s/iter; left time: 7074.4947s
Epoch: 14 cost time: 83.20130729675293
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6929761
	speed: 0.7032s/iter; left time: 22246.3026s
	iters: 200, epoch: 15 | loss: 0.6926719
	speed: 0.2362s/iter; left time: 7449.6445s
	iters: 300, epoch: 15 | loss: 0.6931519
	speed: 0.2480s/iter; left time: 7797.3408s
Epoch: 15 cost time: 89.5030632019043
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6982620
	speed: 0.7136s/iter; left time: 22311.3004s
	iters: 200, epoch: 16 | loss: 0.6930855
	speed: 0.2306s/iter; left time: 7187.1978s
	iters: 300, epoch: 16 | loss: 0.6935439
	speed: 0.2252s/iter; left time: 6997.5014s
Epoch: 16 cost time: 84.25943517684937
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.6938646
	speed: 0.6945s/iter; left time: 21459.0190s
	iters: 200, epoch: 17 | loss: 0.6931914
	speed: 0.2293s/iter; left time: 7061.9799s
	iters: 300, epoch: 17 | loss: 0.6940928
	speed: 0.2284s/iter; left time: 7011.6536s
Epoch: 17 cost time: 86.36327505111694
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.6925054
	speed: 0.7120s/iter; left time: 21737.3450s
	iters: 200, epoch: 18 | loss: 0.6928753
	speed: 0.2315s/iter; left time: 7044.0833s
	iters: 300, epoch: 18 | loss: 0.6932015
	speed: 0.2323s/iter; left time: 7046.5651s
Epoch: 18 cost time: 85.73927283287048
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 2162306
model size : 13.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5153283
	speed: 0.2371s/iter; left time: 8723.8287s
	iters: 200, epoch: 1 | loss: 0.5698735
	speed: 0.2283s/iter; left time: 8377.5688s
	iters: 300, epoch: 1 | loss: 0.9547576
	speed: 0.2210s/iter; left time: 8087.6326s
Epoch: 1 cost time: 84.1985092163086
Epoch: 1, Steps: 369 | Train Loss: 0.655 Vali Loss: 0.719 Vali Acc: 0.657 Test Loss: 0.719 Test Acc: 0.657
Validation loss decreased (inf --> -0.656917).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3122471
	speed: 0.7476s/iter; left time: 27236.3037s
	iters: 200, epoch: 2 | loss: 0.9841677
	speed: 0.2454s/iter; left time: 8917.5770s
	iters: 300, epoch: 2 | loss: 0.4189064
	speed: 0.2293s/iter; left time: 8306.2373s
Epoch: 2 cost time: 89.63157796859741
Epoch: 2, Steps: 369 | Train Loss: 0.540 Vali Loss: 0.829 Vali Acc: 0.654 Test Loss: 0.829 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3433031
	speed: 0.7028s/iter; left time: 25346.1093s
	iters: 200, epoch: 3 | loss: 0.2749010
	speed: 0.2242s/iter; left time: 8062.7463s
	iters: 300, epoch: 3 | loss: 0.6659416
	speed: 0.2304s/iter; left time: 8261.7869s
Epoch: 3 cost time: 84.48282194137573
Epoch: 3, Steps: 369 | Train Loss: 0.461 Vali Loss: 0.949 Vali Acc: 0.654 Test Loss: 0.949 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2041367
	speed: 0.7387s/iter; left time: 26366.0689s
	iters: 200, epoch: 4 | loss: 0.3588582
	speed: 0.2444s/iter; left time: 8700.3934s
	iters: 300, epoch: 4 | loss: 0.1862755
	speed: 0.2357s/iter; left time: 8364.4671s
Epoch: 4 cost time: 89.65222716331482
Epoch: 4, Steps: 369 | Train Loss: 0.442 Vali Loss: 1.087 Vali Acc: 0.644 Test Loss: 1.087 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2098186
	speed: 0.7324s/iter; left time: 25872.6098s
	iters: 200, epoch: 5 | loss: 0.5280030
	speed: 0.2280s/iter; left time: 8031.8318s
	iters: 300, epoch: 5 | loss: 0.4626338
	speed: 0.2271s/iter; left time: 7977.9113s
Epoch: 5 cost time: 85.89888381958008
Epoch: 5, Steps: 369 | Train Loss: 0.407 Vali Loss: 1.306 Vali Acc: 0.628 Test Loss: 1.306 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.5811055
	speed: 0.6837s/iter; left time: 23900.9821s
	iters: 200, epoch: 6 | loss: 0.3323949
	speed: 0.2249s/iter; left time: 7838.4530s
	iters: 300, epoch: 6 | loss: 0.4132962
	speed: 0.2264s/iter; left time: 7868.9764s
Epoch: 6 cost time: 83.87237119674683
Epoch: 6, Steps: 369 | Train Loss: 0.391 Vali Loss: 1.362 Vali Acc: 0.658 Test Loss: 1.362 Test Acc: 0.658
Validation loss decreased (-0.656917 --> -0.657762).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1818670
	speed: 0.7367s/iter; left time: 25479.4992s
	iters: 200, epoch: 7 | loss: 0.4186683
	speed: 0.2276s/iter; left time: 7849.7983s
	iters: 300, epoch: 7 | loss: 0.4385733
	speed: 0.2297s/iter; left time: 7897.6363s
Epoch: 7 cost time: 86.83336400985718
Epoch: 7, Steps: 369 | Train Loss: 0.350 Vali Loss: 1.474 Vali Acc: 0.652 Test Loss: 1.474 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4071978
	speed: 0.6833s/iter; left time: 23380.6496s
	iters: 200, epoch: 8 | loss: 0.6209652
	speed: 0.2179s/iter; left time: 7433.5611s
	iters: 300, epoch: 8 | loss: 0.2221266
	speed: 0.2206s/iter; left time: 7502.7755s
Epoch: 8 cost time: 81.75475215911865
Epoch: 8, Steps: 369 | Train Loss: 0.329 Vali Loss: 1.676 Vali Acc: 0.657 Test Loss: 1.676 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5926605
	speed: 0.6917s/iter; left time: 23414.9348s
	iters: 200, epoch: 9 | loss: 0.3821651
	speed: 0.2490s/iter; left time: 8403.9790s
	iters: 300, epoch: 9 | loss: 0.1152642
	speed: 0.2444s/iter; left time: 8222.5546s
Epoch: 9 cost time: 88.9821286201477
Epoch: 9, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.785 Vali Acc: 0.650 Test Loss: 1.785 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0290807
	speed: 0.7170s/iter; left time: 24005.1567s
	iters: 200, epoch: 10 | loss: 0.4610254
	speed: 0.2377s/iter; left time: 7934.2954s
	iters: 300, epoch: 10 | loss: 0.1599261
	speed: 0.2426s/iter; left time: 8072.3392s
Epoch: 10 cost time: 89.27350401878357
Epoch: 10, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.851 Vali Acc: 0.663 Test Loss: 1.851 Test Acc: 0.663
Validation loss decreased (-0.657762 --> -0.662581).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0213253
	speed: 0.7129s/iter; left time: 23604.7515s
	iters: 200, epoch: 11 | loss: 0.1675757
	speed: 0.2344s/iter; left time: 7738.0632s
	iters: 300, epoch: 11 | loss: 0.0773412
	speed: 0.2266s/iter; left time: 7458.4342s
Epoch: 11 cost time: 86.57994532585144
Epoch: 11, Steps: 369 | Train Loss: 0.208 Vali Loss: 1.815 Vali Acc: 0.648 Test Loss: 1.815 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0078832
	speed: 0.7210s/iter; left time: 23606.3550s
	iters: 200, epoch: 12 | loss: 0.2303921
	speed: 0.2282s/iter; left time: 7450.4118s
	iters: 300, epoch: 12 | loss: 0.2893192
	speed: 0.2218s/iter; left time: 7217.3246s
Epoch: 12 cost time: 84.90368747711182
Epoch: 12, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.908 Vali Acc: 0.650 Test Loss: 1.908 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0916133
	speed: 0.6849s/iter; left time: 22172.7327s
	iters: 200, epoch: 13 | loss: 0.5266151
	speed: 0.2209s/iter; left time: 7129.1994s
	iters: 300, epoch: 13 | loss: 0.2725964
	speed: 0.2304s/iter; left time: 7411.8062s
Epoch: 13 cost time: 83.89141654968262
Epoch: 13, Steps: 369 | Train Loss: 0.157 Vali Loss: 2.031 Vali Acc: 0.649 Test Loss: 2.031 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0043056
	speed: 0.6790s/iter; left time: 21729.8420s
	iters: 200, epoch: 14 | loss: 0.2333382
	speed: 0.2236s/iter; left time: 7134.8312s
	iters: 300, epoch: 14 | loss: 0.1110934
	speed: 0.2168s/iter; left time: 6893.8273s
Epoch: 14 cost time: 82.91265177726746
Epoch: 14, Steps: 369 | Train Loss: 0.136 Vali Loss: 2.183 Vali Acc: 0.652 Test Loss: 2.183 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0802928
	speed: 0.6980s/iter; left time: 22080.4942s
	iters: 200, epoch: 15 | loss: 0.0024289
	speed: 0.2318s/iter; left time: 7311.2700s
	iters: 300, epoch: 15 | loss: 0.0089867
	speed: 0.2351s/iter; left time: 7389.1236s
Epoch: 15 cost time: 87.23851895332336
Epoch: 15, Steps: 369 | Train Loss: 0.160 Vali Loss: 2.269 Vali Acc: 0.657 Test Loss: 2.269 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0031121
	speed: 0.7034s/iter; left time: 21991.3358s
	iters: 200, epoch: 16 | loss: 0.0237436
	speed: 0.2343s/iter; left time: 7301.2099s
	iters: 300, epoch: 16 | loss: 0.0173302
	speed: 0.2327s/iter; left time: 7230.3564s
Epoch: 16 cost time: 85.86639165878296
Epoch: 16, Steps: 369 | Train Loss: 0.120 Vali Loss: 2.278 Vali Acc: 0.656 Test Loss: 2.278 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0005545
	speed: 0.7126s/iter; left time: 22018.2250s
	iters: 200, epoch: 17 | loss: 0.0052915
	speed: 0.2235s/iter; left time: 6883.8808s
	iters: 300, epoch: 17 | loss: 0.2412985
	speed: 0.2311s/iter; left time: 7092.6748s
Epoch: 17 cost time: 85.8954553604126
Epoch: 17, Steps: 369 | Train Loss: 0.102 Vali Loss: 2.706 Vali Acc: 0.645 Test Loss: 2.706 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0072124
	speed: 0.7157s/iter; left time: 21848.5905s
	iters: 200, epoch: 18 | loss: 0.0103916
	speed: 0.2333s/iter; left time: 7100.1073s
	iters: 300, epoch: 18 | loss: 0.1202222
	speed: 0.2215s/iter; left time: 6716.2426s
Epoch: 18 cost time: 85.97304940223694
Epoch: 18, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.584 Vali Acc: 0.649 Test Loss: 2.584 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1133233
	speed: 0.6824s/iter; left time: 20579.4204s
	iters: 200, epoch: 19 | loss: 0.0859534
	speed: 0.2336s/iter; left time: 7021.1199s
	iters: 300, epoch: 19 | loss: 0.0004928
	speed: 0.2296s/iter; left time: 6879.6655s
Epoch: 19 cost time: 85.63783240318298
Epoch: 19, Steps: 369 | Train Loss: 0.097 Vali Loss: 2.661 Vali Acc: 0.664 Test Loss: 2.661 Test Acc: 0.664
Validation loss decreased (-0.662581 --> -0.663992).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2904713
	speed: 0.6911s/iter; left time: 20588.5707s
	iters: 200, epoch: 20 | loss: 0.2758189
	speed: 0.2324s/iter; left time: 6900.0518s
	iters: 300, epoch: 20 | loss: 0.7337243
	speed: 0.2332s/iter; left time: 6900.0062s
Epoch: 20 cost time: 86.07883214950562
Epoch: 20, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.668 Vali Acc: 0.656 Test Loss: 2.668 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3841715
	speed: 0.6878s/iter; left time: 20235.3693s
	iters: 200, epoch: 21 | loss: 0.0036434
	speed: 0.2218s/iter; left time: 6503.9489s
	iters: 300, epoch: 21 | loss: 0.0016201
	speed: 0.2263s/iter; left time: 6613.0717s
Epoch: 21 cost time: 84.76856303215027
Epoch: 21, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.803 Vali Acc: 0.665 Test Loss: 2.803 Test Acc: 0.665
Validation loss decreased (-0.663992 --> -0.665409).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001068
	speed: 0.6940s/iter; left time: 20162.8381s
	iters: 200, epoch: 22 | loss: 0.1023920
	speed: 0.2266s/iter; left time: 6561.8847s
	iters: 300, epoch: 22 | loss: 0.2990742
	speed: 0.2307s/iter; left time: 6656.1254s
Epoch: 22 cost time: 85.01318907737732
Epoch: 22, Steps: 369 | Train Loss: 0.115 Vali Loss: 2.935 Vali Acc: 0.661 Test Loss: 2.935 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0511870
	speed: 0.7079s/iter; left time: 20304.3278s
	iters: 200, epoch: 23 | loss: 0.0059220
	speed: 0.2338s/iter; left time: 6681.9069s
	iters: 300, epoch: 23 | loss: 0.0005037
	speed: 0.2336s/iter; left time: 6652.7591s
Epoch: 23 cost time: 88.05533981323242
Epoch: 23, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.738 Vali Acc: 0.652 Test Loss: 2.738 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0001654
	speed: 0.6996s/iter; left time: 19809.0512s
	iters: 200, epoch: 24 | loss: 0.0131379
	speed: 0.2354s/iter; left time: 6641.0739s
	iters: 300, epoch: 24 | loss: 0.2037223
	speed: 0.2447s/iter; left time: 6880.8154s
Epoch: 24 cost time: 86.9378228187561
Epoch: 24, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.909 Vali Acc: 0.661 Test Loss: 2.909 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0003669
	speed: 0.6622s/iter; left time: 18504.4505s
	iters: 200, epoch: 25 | loss: 0.0320691
	speed: 0.2171s/iter; left time: 6045.8873s
	iters: 300, epoch: 25 | loss: 0.4027422
	speed: 0.2226s/iter; left time: 6174.9297s
Epoch: 25 cost time: 82.45931339263916
Epoch: 25, Steps: 369 | Train Loss: 0.100 Vali Loss: 2.834 Vali Acc: 0.657 Test Loss: 2.834 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.1639851
	speed: 0.7357s/iter; left time: 20288.3178s
	iters: 200, epoch: 26 | loss: 0.2642728
	speed: 0.2357s/iter; left time: 6477.0334s
	iters: 300, epoch: 26 | loss: 0.0091709
	speed: 0.2313s/iter; left time: 6331.6181s
Epoch: 26 cost time: 86.53187036514282
Epoch: 26, Steps: 369 | Train Loss: 0.076 Vali Loss: 3.158 Vali Acc: 0.652 Test Loss: 3.158 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0002185
	speed: 0.6694s/iter; left time: 18211.6421s
	iters: 200, epoch: 27 | loss: 0.1527713
	speed: 0.2267s/iter; left time: 6145.5321s
	iters: 300, epoch: 27 | loss: 0.0450661
	speed: 0.2238s/iter; left time: 6044.9915s
Epoch: 27 cost time: 84.17658424377441
Epoch: 27, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.934 Vali Acc: 0.655 Test Loss: 2.934 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0006749
	speed: 0.7105s/iter; left time: 19067.6441s
	iters: 200, epoch: 28 | loss: 0.0015248
	speed: 0.2499s/iter; left time: 6680.6727s
	iters: 300, epoch: 28 | loss: 0.0911033
	speed: 0.2501s/iter; left time: 6663.1182s
Epoch: 28 cost time: 91.92365741729736
Epoch: 28, Steps: 369 | Train Loss: 0.064 Vali Loss: 3.114 Vali Acc: 0.663 Test Loss: 3.114 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0204604
	speed: 0.7086s/iter; left time: 18755.6843s
	iters: 200, epoch: 29 | loss: 0.1173833
	speed: 0.2264s/iter; left time: 5969.7646s
	iters: 300, epoch: 29 | loss: 0.0068071
	speed: 0.2200s/iter; left time: 5778.8545s
Epoch: 29 cost time: 83.71825790405273
Epoch: 29, Steps: 369 | Train Loss: 0.062 Vali Loss: 3.266 Vali Acc: 0.637 Test Loss: 3.266 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0002385
	speed: 0.6956s/iter; left time: 18155.1332s
	iters: 200, epoch: 30 | loss: 0.0002107
	speed: 0.2393s/iter; left time: 6222.3425s
	iters: 300, epoch: 30 | loss: 0.0004747
	speed: 0.2406s/iter; left time: 6232.3922s
Epoch: 30 cost time: 89.29407238960266
Epoch: 30, Steps: 369 | Train Loss: 0.057 Vali Loss: 3.056 Vali Acc: 0.659 Test Loss: 3.056 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.1200807
	speed: 0.7054s/iter; left time: 18151.5198s
	iters: 200, epoch: 31 | loss: 0.0038481
	speed: 0.2315s/iter; left time: 5932.6447s
	iters: 300, epoch: 31 | loss: 0.0001597
	speed: 0.2295s/iter; left time: 5860.1308s
Epoch: 31 cost time: 86.29214429855347
Epoch: 31, Steps: 369 | Train Loss: 0.073 Vali Loss: 3.262 Vali Acc: 0.652 Test Loss: 3.262 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5372700
	speed: 0.2539s/iter; left time: 9343.7624s
	iters: 200, epoch: 1 | loss: 0.4554422
	speed: 0.2396s/iter; left time: 8792.1412s
	iters: 300, epoch: 1 | loss: 0.9193628
	speed: 0.2329s/iter; left time: 8524.7509s
Epoch: 1 cost time: 88.25502467155457
Epoch: 1, Steps: 369 | Train Loss: 0.659 Vali Loss: 0.703 Vali Acc: 0.660 Test Loss: 0.703 Test Acc: 0.660
Validation loss decreased (inf --> -0.659755).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2942024
	speed: 0.6949s/iter; left time: 25317.6073s
	iters: 200, epoch: 2 | loss: 1.0566945
	speed: 0.2455s/iter; left time: 8917.7911s
	iters: 300, epoch: 2 | loss: 0.5015329
	speed: 0.2581s/iter; left time: 9350.8970s
Epoch: 2 cost time: 92.67852663993835
Epoch: 2, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.830 Vali Acc: 0.638 Test Loss: 0.830 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3309383
	speed: 0.7365s/iter; left time: 26559.5472s
	iters: 200, epoch: 3 | loss: 0.2334879
	speed: 0.2206s/iter; left time: 7934.2877s
	iters: 300, epoch: 3 | loss: 0.5495331
	speed: 0.2286s/iter; left time: 8198.5982s
Epoch: 3 cost time: 85.59795761108398
Epoch: 3, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.928 Vali Acc: 0.666 Test Loss: 0.928 Test Acc: 0.666
Validation loss decreased (-0.659755 --> -0.666279).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1052236
	speed: 0.6751s/iter; left time: 24098.0118s
	iters: 200, epoch: 4 | loss: 0.3737932
	speed: 0.2470s/iter; left time: 8791.8833s
	iters: 300, epoch: 4 | loss: 0.1492105
	speed: 0.2465s/iter; left time: 8747.6066s
Epoch: 4 cost time: 89.64140462875366
Epoch: 4, Steps: 369 | Train Loss: 0.449 Vali Loss: 1.013 Vali Acc: 0.646 Test Loss: 1.013 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1727869
	speed: 0.7368s/iter; left time: 26026.6748s
	iters: 200, epoch: 5 | loss: 0.4689000
	speed: 0.2347s/iter; left time: 8267.4932s
	iters: 300, epoch: 5 | loss: 0.6431329
	speed: 0.2182s/iter; left time: 7665.9655s
Epoch: 5 cost time: 85.42351841926575
Epoch: 5, Steps: 369 | Train Loss: 0.398 Vali Loss: 1.218 Vali Acc: 0.644 Test Loss: 1.218 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2894543
	speed: 0.6579s/iter; left time: 22996.8354s
	iters: 200, epoch: 6 | loss: 0.4541187
	speed: 0.2370s/iter; left time: 8259.3328s
	iters: 300, epoch: 6 | loss: 0.4292600
	speed: 0.2287s/iter; left time: 7949.9895s
Epoch: 6 cost time: 85.54441380500793
Epoch: 6, Steps: 369 | Train Loss: 0.383 Vali Loss: 1.221 Vali Acc: 0.640 Test Loss: 1.221 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0589803
	speed: 0.7077s/iter; left time: 24477.2873s
	iters: 200, epoch: 7 | loss: 0.5099379
	speed: 0.2355s/iter; left time: 8122.0052s
	iters: 300, epoch: 7 | loss: 0.1598527
	speed: 0.2363s/iter; left time: 8125.8665s
Epoch: 7 cost time: 89.3884711265564
Epoch: 7, Steps: 369 | Train Loss: 0.348 Vali Loss: 1.290 Vali Acc: 0.677 Test Loss: 1.290 Test Acc: 0.677
Validation loss decreased (-0.666279 --> -0.676775).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3806419
	speed: 0.7304s/iter; left time: 24992.9465s
	iters: 200, epoch: 8 | loss: 0.2375024
	speed: 0.2338s/iter; left time: 7977.1328s
	iters: 300, epoch: 8 | loss: 0.4908803
	speed: 0.2400s/iter; left time: 8164.8962s
Epoch: 8 cost time: 91.06557202339172
Epoch: 8, Steps: 369 | Train Loss: 0.343 Vali Loss: 1.523 Vali Acc: 0.648 Test Loss: 1.523 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4076435
	speed: 0.7322s/iter; left time: 24784.0281s
	iters: 200, epoch: 9 | loss: 0.1846825
	speed: 0.2439s/iter; left time: 8231.2564s
	iters: 300, epoch: 9 | loss: 0.6098303
	speed: 0.2427s/iter; left time: 8168.2261s
Epoch: 9 cost time: 89.88708138465881
Epoch: 9, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.648 Vali Acc: 0.662 Test Loss: 1.648 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0038765
	speed: 0.7414s/iter; left time: 24821.5312s
	iters: 200, epoch: 10 | loss: 0.0215872
	speed: 0.2629s/iter; left time: 8774.1531s
	iters: 300, epoch: 10 | loss: 0.1996340
	speed: 0.2466s/iter; left time: 8206.5241s
Epoch: 10 cost time: 95.36090683937073
Epoch: 10, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.857 Vali Acc: 0.659 Test Loss: 1.857 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0333746
	speed: 0.7165s/iter; left time: 23723.9707s
	iters: 200, epoch: 11 | loss: 0.0746257
	speed: 0.2396s/iter; left time: 7908.5688s
	iters: 300, epoch: 11 | loss: 0.0247912
	speed: 0.2205s/iter; left time: 7258.2552s
Epoch: 11 cost time: 84.77425527572632
Epoch: 11, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.674 Vali Acc: 0.671 Test Loss: 1.674 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1393536
	speed: 0.7185s/iter; left time: 23524.5376s
	iters: 200, epoch: 12 | loss: 0.1683949
	speed: 0.2749s/iter; left time: 8972.5577s
	iters: 300, epoch: 12 | loss: 0.0512156
	speed: 0.2626s/iter; left time: 8544.5712s
Epoch: 12 cost time: 97.8114709854126
Epoch: 12, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.915 Vali Acc: 0.661 Test Loss: 1.915 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1502131
	speed: 0.7435s/iter; left time: 24070.7580s
	iters: 200, epoch: 13 | loss: 0.2216841
	speed: 0.2431s/iter; left time: 7845.8441s
	iters: 300, epoch: 13 | loss: 0.6912453
	speed: 0.2385s/iter; left time: 7674.2139s
Epoch: 13 cost time: 91.38780665397644
Epoch: 13, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.997 Vali Acc: 0.660 Test Loss: 1.997 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0367675
	speed: 0.7467s/iter; left time: 23897.6275s
	iters: 200, epoch: 14 | loss: 0.2534677
	speed: 0.2465s/iter; left time: 7863.1207s
	iters: 300, epoch: 14 | loss: 0.0937462
	speed: 0.2452s/iter; left time: 7799.3155s
Epoch: 14 cost time: 92.01589965820312
Epoch: 14, Steps: 369 | Train Loss: 0.147 Vali Loss: 2.040 Vali Acc: 0.656 Test Loss: 2.040 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2848424
	speed: 0.7194s/iter; left time: 22758.8736s
	iters: 200, epoch: 15 | loss: 0.1640279
	speed: 0.2351s/iter; left time: 7414.5404s
	iters: 300, epoch: 15 | loss: 0.0599919
	speed: 0.2294s/iter; left time: 7212.4899s
Epoch: 15 cost time: 86.52874875068665
Epoch: 15, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.085 Vali Acc: 0.649 Test Loss: 2.085 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0036356
	speed: 0.6986s/iter; left time: 21842.6399s
	iters: 200, epoch: 16 | loss: 0.1456026
	speed: 0.2349s/iter; left time: 7320.4448s
	iters: 300, epoch: 16 | loss: 0.0246494
	speed: 0.2278s/iter; left time: 7078.3801s
Epoch: 16 cost time: 86.21678590774536
Epoch: 16, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.488 Vali Acc: 0.652 Test Loss: 2.488 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0224815
	speed: 0.7085s/iter; left time: 21891.7830s
	iters: 200, epoch: 17 | loss: 0.0605632
	speed: 0.2575s/iter; left time: 7930.6839s
	iters: 300, epoch: 17 | loss: 0.5866100
	speed: 0.2696s/iter; left time: 8276.7305s
Epoch: 17 cost time: 97.09177541732788
Epoch: 17, Steps: 369 | Train Loss: 0.108 Vali Loss: 2.427 Vali Acc: 0.653 Test Loss: 2.427 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5925561
	speed: 0.2517s/iter; left time: 9261.5796s
	iters: 200, epoch: 1 | loss: 0.4250276
	speed: 0.2496s/iter; left time: 9160.8312s
	iters: 300, epoch: 1 | loss: 0.7580334
	speed: 0.2358s/iter; left time: 8629.8672s
Epoch: 1 cost time: 89.86442804336548
Epoch: 1, Steps: 369 | Train Loss: 0.666 Vali Loss: 0.718 Vali Acc: 0.640 Test Loss: 0.718 Test Acc: 0.640
Validation loss decreased (inf --> -0.639607).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2052817
	speed: 0.7143s/iter; left time: 26023.7811s
	iters: 200, epoch: 2 | loss: 1.5159492
	speed: 0.2404s/iter; left time: 8735.8484s
	iters: 300, epoch: 2 | loss: 0.4984987
	speed: 0.2383s/iter; left time: 8635.6962s
Epoch: 2 cost time: 89.96603298187256
Epoch: 2, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.839 Vali Acc: 0.631 Test Loss: 0.839 Test Acc: 0.631
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2985077
	speed: 0.7292s/iter; left time: 26295.3537s
	iters: 200, epoch: 3 | loss: 0.1111919
	speed: 0.2305s/iter; left time: 8289.1296s
	iters: 300, epoch: 3 | loss: 0.3685203
	speed: 0.2369s/iter; left time: 8496.0441s
Epoch: 3 cost time: 89.31384444236755
Epoch: 3, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.945 Vali Acc: 0.650 Test Loss: 0.945 Test Acc: 0.650
Validation loss decreased (-0.639607 --> -0.649820).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2364093
	speed: 0.7391s/iter; left time: 26383.1198s
	iters: 200, epoch: 4 | loss: 0.3527601
	speed: 0.2525s/iter; left time: 8988.3623s
	iters: 300, epoch: 4 | loss: 0.4556029
	speed: 0.2488s/iter; left time: 8831.6001s
Epoch: 4 cost time: 91.0694329738617
Epoch: 4, Steps: 369 | Train Loss: 0.442 Vali Loss: 1.096 Vali Acc: 0.639 Test Loss: 1.096 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1005583
	speed: 0.6993s/iter; left time: 24701.7781s
	iters: 200, epoch: 5 | loss: 0.3655006
	speed: 0.2603s/iter; left time: 9168.4384s
	iters: 300, epoch: 5 | loss: 0.2989193
	speed: 0.2616s/iter; left time: 9189.9606s
Epoch: 5 cost time: 93.72059845924377
Epoch: 5, Steps: 369 | Train Loss: 0.418 Vali Loss: 1.126 Vali Acc: 0.637 Test Loss: 1.126 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4267182
	speed: 0.7587s/iter; left time: 26520.9959s
	iters: 200, epoch: 6 | loss: 0.7563640
	speed: 0.2564s/iter; left time: 8936.8141s
	iters: 300, epoch: 6 | loss: 0.6727072
	speed: 0.2519s/iter; left time: 8755.1191s
Epoch: 6 cost time: 93.67327857017517
Epoch: 6, Steps: 369 | Train Loss: 0.380 Vali Loss: 1.427 Vali Acc: 0.627 Test Loss: 1.427 Test Acc: 0.627
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6172254
	speed: 0.7222s/iter; left time: 24978.9955s
	iters: 200, epoch: 7 | loss: 0.7283725
	speed: 0.2543s/iter; left time: 8769.1613s
	iters: 300, epoch: 7 | loss: 0.1440834
	speed: 0.2398s/iter; left time: 8247.4580s
Epoch: 7 cost time: 92.11010313034058
Epoch: 7, Steps: 369 | Train Loss: 0.353 Vali Loss: 1.266 Vali Acc: 0.662 Test Loss: 1.266 Test Acc: 0.662
Validation loss decreased (-0.649820 --> -0.662019).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4261916
	speed: 0.7210s/iter; left time: 24669.7470s
	iters: 200, epoch: 8 | loss: 0.4927213
	speed: 0.2231s/iter; left time: 7613.2990s
	iters: 300, epoch: 8 | loss: 0.3262697
	speed: 0.2315s/iter; left time: 7875.9585s
Epoch: 8 cost time: 87.65005016326904
Epoch: 8, Steps: 369 | Train Loss: 0.330 Vali Loss: 1.369 Vali Acc: 0.640 Test Loss: 1.369 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2604152
	speed: 0.7150s/iter; left time: 24203.6676s
	iters: 200, epoch: 9 | loss: 0.3833165
	speed: 0.2345s/iter; left time: 7915.4769s
	iters: 300, epoch: 9 | loss: 0.3997535
	speed: 0.2311s/iter; left time: 7774.8047s
Epoch: 9 cost time: 88.2210545539856
Epoch: 9, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.551 Vali Acc: 0.665 Test Loss: 1.551 Test Acc: 0.665
Validation loss decreased (-0.662019 --> -0.664854).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0156756
	speed: 0.7316s/iter; left time: 24494.6974s
	iters: 200, epoch: 10 | loss: 0.3582751
	speed: 0.2558s/iter; left time: 8537.9339s
	iters: 300, epoch: 10 | loss: 0.1063635
	speed: 0.2475s/iter; left time: 8235.9304s
Epoch: 10 cost time: 93.2669746875763
Epoch: 10, Steps: 369 | Train Loss: 0.239 Vali Loss: 1.788 Vali Acc: 0.657 Test Loss: 1.788 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2580365
	speed: 0.7586s/iter; left time: 25118.4211s
	iters: 200, epoch: 11 | loss: 0.0100954
	speed: 0.2489s/iter; left time: 8216.0073s
	iters: 300, epoch: 11 | loss: 0.0144090
	speed: 0.2583s/iter; left time: 8502.3941s
Epoch: 11 cost time: 96.04744243621826
Epoch: 11, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.755 Vali Acc: 0.660 Test Loss: 1.755 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3349726
	speed: 0.7511s/iter; left time: 24591.4070s
	iters: 200, epoch: 12 | loss: 0.0264484
	speed: 0.2350s/iter; left time: 7672.1310s
	iters: 300, epoch: 12 | loss: 0.4389930
	speed: 0.2505s/iter; left time: 8151.6099s
Epoch: 12 cost time: 90.02763986587524
Epoch: 12, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.761 Vali Acc: 0.652 Test Loss: 1.761 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6302183
	speed: 0.6862s/iter; left time: 22214.4189s
	iters: 200, epoch: 13 | loss: 0.3891255
	speed: 0.2360s/iter; left time: 7616.0539s
	iters: 300, epoch: 13 | loss: 0.3033971
	speed: 0.2430s/iter; left time: 7819.4129s
Epoch: 13 cost time: 91.28657388687134
Epoch: 13, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.829 Vali Acc: 0.673 Test Loss: 1.829 Test Acc: 0.673
Validation loss decreased (-0.664854 --> -0.672797).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2915674
	speed: 0.7563s/iter; left time: 24206.1875s
	iters: 200, epoch: 14 | loss: 0.4099147
	speed: 0.2487s/iter; left time: 7933.0362s
	iters: 300, epoch: 14 | loss: 0.0223610
	speed: 0.2357s/iter; left time: 7495.8057s
Epoch: 14 cost time: 90.14712238311768
Epoch: 14, Steps: 369 | Train Loss: 0.148 Vali Loss: 2.115 Vali Acc: 0.645 Test Loss: 2.115 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1075430
	speed: 0.7035s/iter; left time: 22255.5614s
	iters: 200, epoch: 15 | loss: 0.1156208
	speed: 0.2452s/iter; left time: 7732.1841s
	iters: 300, epoch: 15 | loss: 0.0822999
	speed: 0.2340s/iter; left time: 7354.9951s
Epoch: 15 cost time: 88.95120859146118
Epoch: 15, Steps: 369 | Train Loss: 0.141 Vali Loss: 2.114 Vali Acc: 0.663 Test Loss: 2.114 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0020185
	speed: 0.7767s/iter; left time: 24284.7262s
	iters: 200, epoch: 16 | loss: 0.4972750
	speed: 0.2550s/iter; left time: 7946.7791s
	iters: 300, epoch: 16 | loss: 0.3277380
	speed: 0.2705s/iter; left time: 8404.5097s
Epoch: 16 cost time: 97.379567861557
Epoch: 16, Steps: 369 | Train Loss: 0.111 Vali Loss: 2.170 Vali Acc: 0.641 Test Loss: 2.170 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0075333
	speed: 0.7330s/iter; left time: 22646.4007s
	iters: 200, epoch: 17 | loss: 0.0014582
	speed: 0.2291s/iter; left time: 7055.4546s
	iters: 300, epoch: 17 | loss: 0.0785381
	speed: 0.2370s/iter; left time: 7275.1596s
Epoch: 17 cost time: 86.44810104370117
Epoch: 17, Steps: 369 | Train Loss: 0.133 Vali Loss: 2.438 Vali Acc: 0.646 Test Loss: 2.438 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3501422
	speed: 0.6776s/iter; left time: 20686.2987s
	iters: 200, epoch: 18 | loss: 0.0112045
	speed: 0.2441s/iter; left time: 7427.8567s
	iters: 300, epoch: 18 | loss: 0.0468953
	speed: 0.2511s/iter; left time: 7614.2965s
Epoch: 18 cost time: 92.72186303138733
Epoch: 18, Steps: 369 | Train Loss: 0.113 Vali Loss: 2.261 Vali Acc: 0.655 Test Loss: 2.261 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0007768
	speed: 0.7643s/iter; left time: 23050.2785s
	iters: 200, epoch: 19 | loss: 0.0472143
	speed: 0.2561s/iter; left time: 7697.5092s
	iters: 300, epoch: 19 | loss: 0.0003461
	speed: 0.2240s/iter; left time: 6710.7643s
Epoch: 19 cost time: 87.05114960670471
Epoch: 19, Steps: 369 | Train Loss: 0.086 Vali Loss: 2.493 Vali Acc: 0.646 Test Loss: 2.493 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2431940
	speed: 0.6615s/iter; left time: 19705.7727s
	iters: 200, epoch: 20 | loss: 0.0070752
	speed: 0.2468s/iter; left time: 7328.6950s
	iters: 300, epoch: 20 | loss: 0.0010700
	speed: 0.2595s/iter; left time: 7679.6486s
Epoch: 20 cost time: 91.66739010810852
Epoch: 20, Steps: 369 | Train Loss: 0.103 Vali Loss: 2.690 Vali Acc: 0.646 Test Loss: 2.690 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0189950
	speed: 0.7715s/iter; left time: 22697.9658s
	iters: 200, epoch: 21 | loss: 0.0011022
	speed: 0.2582s/iter; left time: 7569.9772s
	iters: 300, epoch: 21 | loss: 0.2993484
	speed: 0.2539s/iter; left time: 7420.2478s
Epoch: 21 cost time: 94.63196206092834
Epoch: 21, Steps: 369 | Train Loss: 0.104 Vali Loss: 2.637 Vali Acc: 0.652 Test Loss: 2.637 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0045384
	speed: 0.6781s/iter; left time: 19700.8761s
	iters: 200, epoch: 22 | loss: 0.2702136
	speed: 0.2271s/iter; left time: 6573.5521s
	iters: 300, epoch: 22 | loss: 0.0854930
	speed: 0.2242s/iter; left time: 6468.8084s
Epoch: 22 cost time: 84.26185870170593
Epoch: 22, Steps: 369 | Train Loss: 0.106 Vali Loss: 2.602 Vali Acc: 0.655 Test Loss: 2.602 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0193218
	speed: 0.6711s/iter; left time: 19249.7800s
	iters: 200, epoch: 23 | loss: 0.0767611
	speed: 0.2467s/iter; left time: 7051.1629s
	iters: 300, epoch: 23 | loss: 0.0366361
	speed: 0.2616s/iter; left time: 7449.7319s
Epoch: 23 cost time: 91.28206729888916
Epoch: 23, Steps: 369 | Train Loss: 0.086 Vali Loss: 2.636 Vali Acc: 0.657 Test Loss: 2.636 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5371408
	speed: 0.2448s/iter; left time: 9008.6526s
	iters: 200, epoch: 1 | loss: 0.4760660
	speed: 0.2300s/iter; left time: 8442.1769s
	iters: 300, epoch: 1 | loss: 0.7264664
	speed: 0.2649s/iter; left time: 9696.2700s
Epoch: 1 cost time: 92.06285095214844
Epoch: 1, Steps: 369 | Train Loss: 0.685 Vali Loss: 0.738 Vali Acc: 0.645 Test Loss: 0.738 Test Acc: 0.645
Validation loss decreased (inf --> -0.645282).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2916563
	speed: 0.7258s/iter; left time: 26443.6467s
	iters: 200, epoch: 2 | loss: 1.1417868
	speed: 0.2549s/iter; left time: 9260.8630s
	iters: 300, epoch: 2 | loss: 0.3895026
	speed: 0.2591s/iter; left time: 9386.7344s
Epoch: 2 cost time: 95.07386112213135
Epoch: 2, Steps: 369 | Train Loss: 0.558 Vali Loss: 0.814 Vali Acc: 0.640 Test Loss: 0.814 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3387630
	speed: 0.7513s/iter; left time: 27092.3959s
	iters: 200, epoch: 3 | loss: 0.1833223
	speed: 0.2525s/iter; left time: 9080.4572s
	iters: 300, epoch: 3 | loss: 0.5158631
	speed: 0.2319s/iter; left time: 8315.7265s
Epoch: 3 cost time: 89.25808954238892
Epoch: 3, Steps: 369 | Train Loss: 0.491 Vali Loss: 1.008 Vali Acc: 0.652 Test Loss: 1.008 Test Acc: 0.652
Validation loss decreased (-0.645282 --> -0.651806).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4656631
	speed: 0.6940s/iter; left time: 24770.8306s
	iters: 200, epoch: 4 | loss: 0.6437154
	speed: 0.2351s/iter; left time: 8368.6475s
	iters: 300, epoch: 4 | loss: 0.6884804
	speed: 0.2472s/iter; left time: 8773.3658s
Epoch: 4 cost time: 89.18479132652283
Epoch: 4, Steps: 369 | Train Loss: 0.471 Vali Loss: 1.005 Vali Acc: 0.656 Test Loss: 1.005 Test Acc: 0.656
Validation loss decreased (-0.651806 --> -0.655779).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5128806
	speed: 0.7492s/iter; left time: 26466.1581s
	iters: 200, epoch: 5 | loss: 0.1728600
	speed: 0.2474s/iter; left time: 8713.5490s
	iters: 300, epoch: 5 | loss: 0.1865069
	speed: 0.2398s/iter; left time: 8422.5271s
Epoch: 5 cost time: 92.49693059921265
Epoch: 5, Steps: 369 | Train Loss: 0.425 Vali Loss: 1.108 Vali Acc: 0.658 Test Loss: 1.108 Test Acc: 0.658
Validation loss decreased (-0.655779 --> -0.658332).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3707522
	speed: 0.7270s/iter; left time: 25414.1572s
	iters: 200, epoch: 6 | loss: 0.7053106
	speed: 0.2391s/iter; left time: 8335.6842s
	iters: 300, epoch: 6 | loss: 0.5416517
	speed: 0.2304s/iter; left time: 8007.1371s
Epoch: 6 cost time: 87.37718319892883
Epoch: 6, Steps: 369 | Train Loss: 0.404 Vali Loss: 1.249 Vali Acc: 0.648 Test Loss: 1.249 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4233660
	speed: 0.7493s/iter; left time: 25917.1108s
	iters: 200, epoch: 7 | loss: 0.5453033
	speed: 0.2572s/iter; left time: 8870.2024s
	iters: 300, epoch: 7 | loss: 0.2029060
	speed: 0.2586s/iter; left time: 8893.4519s
Epoch: 7 cost time: 95.07966136932373
Epoch: 7, Steps: 369 | Train Loss: 0.358 Vali Loss: 1.288 Vali Acc: 0.640 Test Loss: 1.288 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3547006
	speed: 0.7119s/iter; left time: 24360.7824s
	iters: 200, epoch: 8 | loss: 0.2154168
	speed: 0.2401s/iter; left time: 8192.0903s
	iters: 300, epoch: 8 | loss: 0.3770958
	speed: 0.2170s/iter; left time: 7381.4979s
Epoch: 8 cost time: 85.22672820091248
Epoch: 8, Steps: 369 | Train Loss: 0.360 Vali Loss: 1.458 Vali Acc: 0.669 Test Loss: 1.458 Test Acc: 0.669
Validation loss decreased (-0.658332 --> -0.668544).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3363468
	speed: 0.7002s/iter; left time: 23701.8613s
	iters: 200, epoch: 9 | loss: 0.0750106
	speed: 0.2347s/iter; left time: 7922.3537s
	iters: 300, epoch: 9 | loss: 1.1482450
	speed: 0.2621s/iter; left time: 8819.6387s
Epoch: 9 cost time: 91.52239894866943
Epoch: 9, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.509 Vali Acc: 0.661 Test Loss: 1.509 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1103403
	speed: 0.7335s/iter; left time: 24557.9321s
	iters: 200, epoch: 10 | loss: 0.1828005
	speed: 0.2393s/iter; left time: 7988.7063s
	iters: 300, epoch: 10 | loss: 0.6034237
	speed: 0.2377s/iter; left time: 7909.0431s
Epoch: 10 cost time: 89.69459962844849
Epoch: 10, Steps: 369 | Train Loss: 0.240 Vali Loss: 1.843 Vali Acc: 0.654 Test Loss: 1.843 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0847335
	speed: 0.7093s/iter; left time: 23487.1254s
	iters: 200, epoch: 11 | loss: 0.0524908
	speed: 0.2635s/iter; left time: 8699.0523s
	iters: 300, epoch: 11 | loss: 0.0881435
	speed: 0.2776s/iter; left time: 9137.5192s
Epoch: 11 cost time: 96.91398763656616
Epoch: 11, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.896 Vali Acc: 0.650 Test Loss: 1.896 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2467172
	speed: 0.7653s/iter; left time: 25056.8986s
	iters: 200, epoch: 12 | loss: 0.1498087
	speed: 0.2427s/iter; left time: 7920.9361s
	iters: 300, epoch: 12 | loss: 0.1138127
	speed: 0.2378s/iter; left time: 7738.0534s
Epoch: 12 cost time: 91.42392086982727
Epoch: 12, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.956 Vali Acc: 0.650 Test Loss: 1.956 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9309752
	speed: 0.7413s/iter; left time: 23999.3667s
	iters: 200, epoch: 13 | loss: 0.3474103
	speed: 0.2302s/iter; left time: 7427.8256s
	iters: 300, epoch: 13 | loss: 0.0179653
	speed: 0.2413s/iter; left time: 7764.3112s
Epoch: 13 cost time: 88.61868977546692
Epoch: 13, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.980 Vali Acc: 0.645 Test Loss: 1.980 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0082111
	speed: 0.7251s/iter; left time: 23206.8414s
	iters: 200, epoch: 14 | loss: 0.4193655
	speed: 0.2155s/iter; left time: 6874.2034s
	iters: 300, epoch: 14 | loss: 0.0075669
	speed: 0.2343s/iter; left time: 7450.5673s
Epoch: 14 cost time: 85.47873759269714
Epoch: 14, Steps: 369 | Train Loss: 0.153 Vali Loss: 2.024 Vali Acc: 0.643 Test Loss: 2.024 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0197818
	speed: 0.7668s/iter; left time: 24259.1573s
	iters: 200, epoch: 15 | loss: 0.0780865
	speed: 0.2437s/iter; left time: 7683.9272s
	iters: 300, epoch: 15 | loss: 0.5117080
	speed: 0.2590s/iter; left time: 8143.2246s
Epoch: 15 cost time: 94.18480181694031
Epoch: 15, Steps: 369 | Train Loss: 0.149 Vali Loss: 2.165 Vali Acc: 0.657 Test Loss: 2.165 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0631161
	speed: 0.7542s/iter; left time: 23582.3012s
	iters: 200, epoch: 16 | loss: 0.0008103
	speed: 0.2576s/iter; left time: 8028.1729s
	iters: 300, epoch: 16 | loss: 0.0176300
	speed: 0.2482s/iter; left time: 7711.0768s
Epoch: 16 cost time: 92.766916513443
Epoch: 16, Steps: 369 | Train Loss: 0.136 Vali Loss: 2.394 Vali Acc: 0.654 Test Loss: 2.394 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1810493
	speed: 0.7450s/iter; left time: 23016.7576s
	iters: 200, epoch: 17 | loss: 0.1787831
	speed: 0.2470s/iter; left time: 7605.6965s
	iters: 300, epoch: 17 | loss: 0.4684480
	speed: 0.2392s/iter; left time: 7341.4654s
Epoch: 17 cost time: 90.52267551422119
Epoch: 17, Steps: 369 | Train Loss: 0.121 Vali Loss: 2.243 Vali Acc: 0.660 Test Loss: 2.243 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0067964
	speed: 0.7482s/iter; left time: 22840.6079s
	iters: 200, epoch: 18 | loss: 0.0776062
	speed: 0.2576s/iter; left time: 7838.8224s
	iters: 300, epoch: 18 | loss: 0.0824220
	speed: 0.2379s/iter; left time: 7214.4244s
Epoch: 18 cost time: 90.52777767181396
Epoch: 18, Steps: 369 | Train Loss: 0.102 Vali Loss: 2.295 Vali Acc: 0.649 Test Loss: 2.295 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6685584562996595
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6604559
	speed: 0.2523s/iter; left time: 9286.1739s
	iters: 200, epoch: 1 | loss: 0.6166252
	speed: 0.2452s/iter; left time: 8999.5603s
	iters: 300, epoch: 1 | loss: 0.6482894
	speed: 0.2395s/iter; left time: 8766.5958s
Epoch: 1 cost time: 91.94862365722656
Epoch: 1, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.779 Vali Acc: 0.638 Test Loss: 0.779 Test Acc: 0.638
Validation loss decreased (inf --> -0.637620).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3189422
	speed: 0.7696s/iter; left time: 28039.5538s
	iters: 200, epoch: 2 | loss: 1.0654825
	speed: 0.2598s/iter; left time: 9437.7730s
	iters: 300, epoch: 2 | loss: 0.5988874
	speed: 0.2458s/iter; left time: 8904.9126s
Epoch: 2 cost time: 95.28605508804321
Epoch: 2, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.937 Vali Acc: 0.627 Test Loss: 0.937 Test Acc: 0.627
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5091870
	speed: 0.7155s/iter; left time: 25801.9445s
	iters: 200, epoch: 3 | loss: 0.2548434
	speed: 0.2591s/iter; left time: 9316.8168s
	iters: 300, epoch: 3 | loss: 0.6818354
	speed: 0.2353s/iter; left time: 8439.1994s
Epoch: 3 cost time: 90.53042554855347
Epoch: 3, Steps: 369 | Train Loss: 0.503 Vali Loss: 0.987 Vali Acc: 0.656 Test Loss: 0.987 Test Acc: 0.656
Validation loss decreased (-0.637620 --> -0.655495).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2688271
	speed: 0.7514s/iter; left time: 26821.6797s
	iters: 200, epoch: 4 | loss: 0.8209714
	speed: 0.2684s/iter; left time: 9552.5856s
	iters: 300, epoch: 4 | loss: 0.6309227
	speed: 0.2492s/iter; left time: 8846.6398s
Epoch: 4 cost time: 96.484858751297
Epoch: 4, Steps: 369 | Train Loss: 0.479 Vali Loss: 1.115 Vali Acc: 0.646 Test Loss: 1.115 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0752896
	speed: 0.8006s/iter; left time: 28279.6413s
	iters: 200, epoch: 5 | loss: 0.3406594
	speed: 0.2800s/iter; left time: 9861.3158s
	iters: 300, epoch: 5 | loss: 0.1810679
	speed: 0.2652s/iter; left time: 9316.2514s
Epoch: 5 cost time: 100.181147813797
Epoch: 5, Steps: 369 | Train Loss: 0.416 Vali Loss: 1.299 Vali Acc: 0.646 Test Loss: 1.299 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8332595
	speed: 0.8347s/iter; left time: 29178.0490s
	iters: 200, epoch: 6 | loss: 0.0767462
	speed: 0.2825s/iter; left time: 9847.4724s
	iters: 300, epoch: 6 | loss: 0.2617540
	speed: 0.2760s/iter; left time: 9590.9983s
Epoch: 6 cost time: 104.07820558547974
Epoch: 6, Steps: 369 | Train Loss: 0.401 Vali Loss: 1.340 Vali Acc: 0.629 Test Loss: 1.340 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1438778
	speed: 0.7874s/iter; left time: 27232.4921s
	iters: 200, epoch: 7 | loss: 0.9007997
	speed: 0.2537s/iter; left time: 8747.7615s
	iters: 300, epoch: 7 | loss: 0.3245947
	speed: 0.2522s/iter; left time: 8673.7538s
Epoch: 7 cost time: 94.19411730766296
Epoch: 7, Steps: 369 | Train Loss: 0.349 Vali Loss: 1.364 Vali Acc: 0.647 Test Loss: 1.364 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2938991
	speed: 0.7305s/iter; left time: 24995.3163s
	iters: 200, epoch: 8 | loss: 0.5433307
	speed: 0.2420s/iter; left time: 8256.0626s
	iters: 300, epoch: 8 | loss: 0.5100094
	speed: 0.2445s/iter; left time: 8318.6066s
Epoch: 8 cost time: 90.7023868560791
Epoch: 8, Steps: 369 | Train Loss: 0.335 Vali Loss: 1.495 Vali Acc: 0.648 Test Loss: 1.495 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5151455
	speed: 0.7256s/iter; left time: 24560.0876s
	iters: 200, epoch: 9 | loss: 0.2863890
	speed: 0.2479s/iter; left time: 8365.6705s
	iters: 300, epoch: 9 | loss: 0.3447264
	speed: 0.2376s/iter; left time: 7993.6974s
Epoch: 9 cost time: 89.32345271110535
Epoch: 9, Steps: 369 | Train Loss: 0.289 Vali Loss: 1.793 Vali Acc: 0.646 Test Loss: 1.793 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0810017
	speed: 0.7037s/iter; left time: 23560.2819s
	iters: 200, epoch: 10 | loss: 0.1547920
	speed: 0.2332s/iter; left time: 7783.3183s
	iters: 300, epoch: 10 | loss: 0.9832656
	speed: 0.2315s/iter; left time: 7704.7884s
Epoch: 10 cost time: 87.09778904914856
Epoch: 10, Steps: 369 | Train Loss: 0.270 Vali Loss: 1.735 Vali Acc: 0.654 Test Loss: 1.735 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1428423
	speed: 0.7181s/iter; left time: 23776.0353s
	iters: 200, epoch: 11 | loss: 0.1143459
	speed: 0.2418s/iter; left time: 7981.2330s
	iters: 300, epoch: 11 | loss: 0.0175295
	speed: 0.2304s/iter; left time: 7582.2601s
Epoch: 11 cost time: 88.39586901664734
Epoch: 11, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.822 Vali Acc: 0.658 Test Loss: 1.822 Test Acc: 0.658
Validation loss decreased (-0.655495 --> -0.658041).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1514133
	speed: 0.7296s/iter; left time: 23889.2771s
	iters: 200, epoch: 12 | loss: 0.5833743
	speed: 0.2454s/iter; left time: 8008.9301s
	iters: 300, epoch: 12 | loss: 0.0655749
	speed: 0.2352s/iter; left time: 7654.8455s
Epoch: 12 cost time: 88.44667029380798
Epoch: 12, Steps: 369 | Train Loss: 0.207 Vali Loss: 2.049 Vali Acc: 0.652 Test Loss: 2.049 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0254390
	speed: 0.7169s/iter; left time: 23208.9969s
	iters: 200, epoch: 13 | loss: 0.1526671
	speed: 0.2479s/iter; left time: 7999.0751s
	iters: 300, epoch: 13 | loss: 0.3568468
	speed: 0.2524s/iter; left time: 8120.7772s
Epoch: 13 cost time: 91.6243417263031
Epoch: 13, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.876 Vali Acc: 0.664 Test Loss: 1.876 Test Acc: 0.664
Validation loss decreased (-0.658041 --> -0.663716).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2119276
	speed: 0.7249s/iter; left time: 23198.8377s
	iters: 200, epoch: 14 | loss: 0.1395301
	speed: 0.2458s/iter; left time: 7842.6493s
	iters: 300, epoch: 14 | loss: 0.0511910
	speed: 0.2357s/iter; left time: 7497.0147s
Epoch: 14 cost time: 88.71216154098511
Epoch: 14, Steps: 369 | Train Loss: 0.171 Vali Loss: 2.135 Vali Acc: 0.641 Test Loss: 2.135 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0312791
	speed: 0.7026s/iter; left time: 22226.8590s
	iters: 200, epoch: 15 | loss: 0.4046555
	speed: 0.2320s/iter; left time: 7317.2716s
	iters: 300, epoch: 15 | loss: 0.0828516
	speed: 0.2590s/iter; left time: 8142.6596s
Epoch: 15 cost time: 91.38091325759888
Epoch: 15, Steps: 369 | Train Loss: 0.154 Vali Loss: 2.193 Vali Acc: 0.663 Test Loss: 2.193 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0567822
	speed: 0.7525s/iter; left time: 23527.7971s
	iters: 200, epoch: 16 | loss: 0.2515658
	speed: 0.2394s/iter; left time: 7459.7751s
	iters: 300, epoch: 16 | loss: 0.0258741
	speed: 0.2145s/iter; left time: 6664.0251s
Epoch: 16 cost time: 86.73595881462097
Epoch: 16, Steps: 369 | Train Loss: 0.148 Vali Loss: 2.271 Vali Acc: 0.667 Test Loss: 2.271 Test Acc: 0.667
Validation loss decreased (-0.663716 --> -0.666833).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.2622393
	speed: 0.6803s/iter; left time: 21018.3509s
	iters: 200, epoch: 17 | loss: 0.2783991
	speed: 0.2496s/iter; left time: 7687.0610s
	iters: 300, epoch: 17 | loss: 0.0015998
	speed: 0.2331s/iter; left time: 7154.3205s
Epoch: 17 cost time: 90.99067091941833
Epoch: 17, Steps: 369 | Train Loss: 0.116 Vali Loss: 2.407 Vali Acc: 0.661 Test Loss: 2.407 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1465194
	speed: 0.7585s/iter; left time: 23154.8457s
	iters: 200, epoch: 18 | loss: 0.3847748
	speed: 0.2487s/iter; left time: 7566.2017s
	iters: 300, epoch: 18 | loss: 0.4624763
	speed: 0.2362s/iter; left time: 7163.1479s
Epoch: 18 cost time: 90.76766324043274
Epoch: 18, Steps: 369 | Train Loss: 0.153 Vali Loss: 2.403 Vali Acc: 0.651 Test Loss: 2.403 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0008437
	speed: 0.6926s/iter; left time: 20888.1786s
	iters: 200, epoch: 19 | loss: 0.0539873
	speed: 0.2265s/iter; left time: 6807.7811s
	iters: 300, epoch: 19 | loss: 0.0096754
	speed: 0.2425s/iter; left time: 7266.1803s
Epoch: 19 cost time: 88.5957760810852
Epoch: 19, Steps: 369 | Train Loss: 0.129 Vali Loss: 2.207 Vali Acc: 0.656 Test Loss: 2.207 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.1097325
	speed: 0.7678s/iter; left time: 22871.9623s
	iters: 200, epoch: 20 | loss: 0.0547070
	speed: 0.2527s/iter; left time: 7501.8225s
	iters: 300, epoch: 20 | loss: 0.4235596
	speed: 0.2463s/iter; left time: 7286.7369s
Epoch: 20 cost time: 92.89466881752014
Epoch: 20, Steps: 369 | Train Loss: 0.103 Vali Loss: 2.344 Vali Acc: 0.635 Test Loss: 2.344 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0010080
	speed: 0.7085s/iter; left time: 20844.5921s
	iters: 200, epoch: 21 | loss: 0.0621919
	speed: 0.2273s/iter; left time: 6665.1051s
	iters: 300, epoch: 21 | loss: 0.8062022
	speed: 0.2259s/iter; left time: 6601.0793s
Epoch: 21 cost time: 84.31404829025269
Epoch: 21, Steps: 369 | Train Loss: 0.097 Vali Loss: 2.564 Vali Acc: 0.663 Test Loss: 2.564 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0032279
	speed: 0.7156s/iter; left time: 20789.0544s
	iters: 200, epoch: 22 | loss: 0.0688977
	speed: 0.2630s/iter; left time: 7613.6942s
	iters: 300, epoch: 22 | loss: 0.0249984
	speed: 0.2615s/iter; left time: 7544.9635s
Epoch: 22 cost time: 96.52561616897583
Epoch: 22, Steps: 369 | Train Loss: 0.111 Vali Loss: 2.809 Vali Acc: 0.651 Test Loss: 2.809 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0286226
	speed: 0.7177s/iter; left time: 20586.3181s
	iters: 200, epoch: 23 | loss: 0.0003944
	speed: 0.2512s/iter; left time: 7181.4599s
	iters: 300, epoch: 23 | loss: 0.1376509
	speed: 0.2471s/iter; left time: 7037.4799s
Epoch: 23 cost time: 91.33577847480774
Epoch: 23, Steps: 369 | Train Loss: 0.125 Vali Loss: 2.554 Vali Acc: 0.653 Test Loss: 2.554 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0640150
	speed: 0.7967s/iter; left time: 22556.6086s
	iters: 200, epoch: 24 | loss: 0.3208328
	speed: 0.2605s/iter; left time: 7349.5391s
	iters: 300, epoch: 24 | loss: 0.0107097
	speed: 0.2640s/iter; left time: 7421.4757s
Epoch: 24 cost time: 98.12607765197754
Epoch: 24, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.618 Vali Acc: 0.675 Test Loss: 2.618 Test Acc: 0.675
Validation loss decreased (-0.666833 --> -0.675343).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000331
	speed: 0.7369s/iter; left time: 20593.7590s
	iters: 200, epoch: 25 | loss: 0.0018306
	speed: 0.2605s/iter; left time: 7253.9445s
	iters: 300, epoch: 25 | loss: 0.0030483
	speed: 0.2498s/iter; left time: 6930.9659s
Epoch: 25 cost time: 92.55041742324829
Epoch: 25, Steps: 369 | Train Loss: 0.101 Vali Loss: 2.604 Vali Acc: 0.667 Test Loss: 2.604 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.1734084
	speed: 0.7407s/iter; left time: 20424.4141s
	iters: 200, epoch: 26 | loss: 0.1697323
	speed: 0.2600s/iter; left time: 7142.8521s
	iters: 300, epoch: 26 | loss: 0.0008647
	speed: 0.2652s/iter; left time: 7261.0534s
Epoch: 26 cost time: 97.68413805961609
Epoch: 26, Steps: 369 | Train Loss: 0.090 Vali Loss: 2.875 Vali Acc: 0.650 Test Loss: 2.875 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0828938
	speed: 0.7926s/iter; left time: 21563.0325s
	iters: 200, epoch: 27 | loss: 0.0133834
	speed: 0.2457s/iter; left time: 6661.0705s
	iters: 300, epoch: 27 | loss: 0.0070927
	speed: 0.2530s/iter; left time: 6832.7629s
Epoch: 27 cost time: 93.357830286026
Epoch: 27, Steps: 369 | Train Loss: 0.090 Vali Loss: 3.129 Vali Acc: 0.655 Test Loss: 3.129 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1400508
	speed: 0.7679s/iter; left time: 20610.0290s
	iters: 200, epoch: 28 | loss: 0.0000365
	speed: 0.2738s/iter; left time: 7319.5821s
	iters: 300, epoch: 28 | loss: 0.3353437
	speed: 0.2683s/iter; left time: 7146.9840s
Epoch: 28 cost time: 99.47009229660034
Epoch: 28, Steps: 369 | Train Loss: 0.099 Vali Loss: 2.705 Vali Acc: 0.648 Test Loss: 2.705 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0117128
	speed: 0.7670s/iter; left time: 20302.7847s
	iters: 200, epoch: 29 | loss: 0.0075514
	speed: 0.2600s/iter; left time: 6855.9538s
	iters: 300, epoch: 29 | loss: 0.0159172
	speed: 0.2898s/iter; left time: 7613.2153s
Epoch: 29 cost time: 101.17048192024231
Epoch: 29, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.993 Vali Acc: 0.659 Test Loss: 2.993 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.4344239
	speed: 0.8685s/iter; left time: 22668.2044s
	iters: 200, epoch: 30 | loss: 0.0309817
	speed: 0.2548s/iter; left time: 6624.6696s
	iters: 300, epoch: 30 | loss: 0.7729460
	speed: 0.2530s/iter; left time: 6552.4229s
Epoch: 30 cost time: 96.7827844619751
Epoch: 30, Steps: 369 | Train Loss: 0.069 Vali Loss: 2.900 Vali Acc: 0.637 Test Loss: 2.900 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.2513784
	speed: 0.7491s/iter; left time: 19274.7033s
	iters: 200, epoch: 31 | loss: 0.0774655
	speed: 0.2824s/iter; left time: 7237.2498s
	iters: 300, epoch: 31 | loss: 0.0010258
	speed: 0.2740s/iter; left time: 6996.7537s
Epoch: 31 cost time: 100.791264295578
Epoch: 31, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.827 Vali Acc: 0.659 Test Loss: 2.827 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0364299
	speed: 0.7900s/iter; left time: 20036.9409s
	iters: 200, epoch: 32 | loss: 0.3306463
	speed: 0.2441s/iter; left time: 6167.5848s
	iters: 300, epoch: 32 | loss: 0.1872938
	speed: 0.2562s/iter; left time: 6445.3047s
Epoch: 32 cost time: 93.4668447971344
Epoch: 32, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.977 Vali Acc: 0.656 Test Loss: 2.977 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0392501
	speed: 0.8142s/iter; left time: 20350.1826s
	iters: 200, epoch: 33 | loss: 0.1003093
	speed: 0.2739s/iter; left time: 6819.3894s
	iters: 300, epoch: 33 | loss: 0.0562065
	speed: 0.2682s/iter; left time: 6650.0639s
Epoch: 33 cost time: 101.91954135894775
Epoch: 33, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.913 Vali Acc: 0.656 Test Loss: 2.913 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.3145620
	speed: 0.7790s/iter; left time: 19180.9311s
	iters: 200, epoch: 34 | loss: 0.0279491
	speed: 0.2535s/iter; left time: 6216.7707s
	iters: 300, epoch: 34 | loss: 0.0432802
	speed: 0.2560s/iter; left time: 6251.4281s
Epoch: 34 cost time: 94.77313709259033
Epoch: 34, Steps: 369 | Train Loss: 0.085 Vali Loss: 2.906 Vali Acc: 0.646 Test Loss: 2.906 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7711185
	speed: 0.2875s/iter; left time: 10581.5748s
	iters: 200, epoch: 1 | loss: 0.5217252
	speed: 0.2487s/iter; left time: 9126.9171s
	iters: 300, epoch: 1 | loss: 0.8357051
	speed: 0.2363s/iter; left time: 8650.4184s
Epoch: 1 cost time: 94.67207765579224
Epoch: 1, Steps: 369 | Train Loss: 0.686 Vali Loss: 0.750 Vali Acc: 0.656 Test Loss: 0.750 Test Acc: 0.656
Validation loss decreased (inf --> -0.656349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3665659
	speed: 0.7326s/iter; left time: 26688.9053s
	iters: 200, epoch: 2 | loss: 1.0675502
	speed: 0.2468s/iter; left time: 8968.4076s
	iters: 300, epoch: 2 | loss: 0.5036514
	speed: 0.2587s/iter; left time: 9372.7803s
Epoch: 2 cost time: 91.86528062820435
Epoch: 2, Steps: 369 | Train Loss: 0.576 Vali Loss: 0.936 Vali Acc: 0.632 Test Loss: 0.936 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2642605
	speed: 0.7745s/iter; left time: 27932.2229s
	iters: 200, epoch: 3 | loss: 0.1910460
	speed: 0.2572s/iter; left time: 9248.5702s
	iters: 300, epoch: 3 | loss: 1.0687529
	speed: 0.2613s/iter; left time: 9370.6525s
Epoch: 3 cost time: 96.73089933395386
Epoch: 3, Steps: 369 | Train Loss: 0.537 Vali Loss: 0.925 Vali Acc: 0.667 Test Loss: 0.925 Test Acc: 0.667
Validation loss decreased (-0.656349 --> -0.666847).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1862152
	speed: 0.7559s/iter; left time: 26979.3203s
	iters: 200, epoch: 4 | loss: 0.5552951
	speed: 0.2641s/iter; left time: 9400.3477s
	iters: 300, epoch: 4 | loss: 0.3756692
	speed: 0.2676s/iter; left time: 9496.8259s
Epoch: 4 cost time: 98.749183177948
Epoch: 4, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.948 Vali Acc: 0.664 Test Loss: 0.948 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2495260
	speed: 0.7960s/iter; left time: 28119.8450s
	iters: 200, epoch: 5 | loss: 0.3046682
	speed: 0.2698s/iter; left time: 9503.4394s
	iters: 300, epoch: 5 | loss: 0.5533882
	speed: 0.2475s/iter; left time: 8694.2057s
Epoch: 5 cost time: 95.20383715629578
Epoch: 5, Steps: 369 | Train Loss: 0.449 Vali Loss: 1.283 Vali Acc: 0.642 Test Loss: 1.283 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4547543
	speed: 0.7433s/iter; left time: 25983.2133s
	iters: 200, epoch: 6 | loss: 0.4568930
	speed: 0.2713s/iter; left time: 9454.9168s
	iters: 300, epoch: 6 | loss: 0.7313341
	speed: 0.2748s/iter; left time: 9551.9344s
Epoch: 6 cost time: 97.35875749588013
Epoch: 6, Steps: 369 | Train Loss: 0.427 Vali Loss: 1.177 Vali Acc: 0.650 Test Loss: 1.177 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3019014
	speed: 0.7629s/iter; left time: 26385.1455s
	iters: 200, epoch: 7 | loss: 1.1301204
	speed: 0.2645s/iter; left time: 9120.3164s
	iters: 300, epoch: 7 | loss: 0.0973183
	speed: 0.2474s/iter; left time: 8506.5663s
Epoch: 7 cost time: 96.22809076309204
Epoch: 7, Steps: 369 | Train Loss: 0.396 Vali Loss: 1.154 Vali Acc: 0.639 Test Loss: 1.154 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8110510
	speed: 0.8055s/iter; left time: 27560.9005s
	iters: 200, epoch: 8 | loss: 0.1950480
	speed: 0.2498s/iter; left time: 8523.5569s
	iters: 300, epoch: 8 | loss: 0.3526581
	speed: 0.2319s/iter; left time: 7890.3416s
Epoch: 8 cost time: 89.88509964942932
Epoch: 8, Steps: 369 | Train Loss: 0.340 Vali Loss: 1.460 Vali Acc: 0.652 Test Loss: 1.460 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6008206
	speed: 0.7160s/iter; left time: 24236.8350s
	iters: 200, epoch: 9 | loss: 0.0814837
	speed: 0.2544s/iter; left time: 8587.0032s
	iters: 300, epoch: 9 | loss: 0.6387052
	speed: 0.2700s/iter; left time: 9085.2099s
Epoch: 9 cost time: 94.59023904800415
Epoch: 9, Steps: 369 | Train Loss: 0.284 Vali Loss: 1.805 Vali Acc: 0.652 Test Loss: 1.805 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0351611
	speed: 0.6850s/iter; left time: 22933.8882s
	iters: 200, epoch: 10 | loss: 0.2789536
	speed: 0.2301s/iter; left time: 7679.4615s
	iters: 300, epoch: 10 | loss: 0.3468921
	speed: 0.2506s/iter; left time: 8340.6895s
Epoch: 10 cost time: 87.85101652145386
Epoch: 10, Steps: 369 | Train Loss: 0.262 Vali Loss: 1.836 Vali Acc: 0.615 Test Loss: 1.836 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3413076
	speed: 0.7770s/iter; left time: 25726.7429s
	iters: 200, epoch: 11 | loss: 0.0011432
	speed: 0.2468s/iter; left time: 8147.4351s
	iters: 300, epoch: 11 | loss: 0.2249644
	speed: 0.2553s/iter; left time: 8402.7483s
Epoch: 11 cost time: 95.23154902458191
Epoch: 11, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.621 Vali Acc: 0.624 Test Loss: 1.621 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1047093
	speed: 0.7610s/iter; left time: 24917.3989s
	iters: 200, epoch: 12 | loss: 0.0460191
	speed: 0.2859s/iter; left time: 9332.3576s
	iters: 300, epoch: 12 | loss: 0.1731619
	speed: 0.2719s/iter; left time: 8846.9204s
Epoch: 12 cost time: 98.81718325614929
Epoch: 12, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.646 Vali Acc: 0.654 Test Loss: 1.646 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2278835
	speed: 0.7218s/iter; left time: 23366.6734s
	iters: 200, epoch: 13 | loss: 0.2480927
	speed: 0.2738s/iter; left time: 8835.4033s
	iters: 300, epoch: 13 | loss: 0.5673336
	speed: 0.2671s/iter; left time: 8592.1505s
Epoch: 13 cost time: 97.03621673583984
Epoch: 13, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.906 Vali Acc: 0.660 Test Loss: 1.906 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6668558456299659
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7629913
	speed: 0.2576s/iter; left time: 9480.5629s
	iters: 200, epoch: 1 | loss: 0.5614523
	speed: 0.2421s/iter; left time: 8886.9797s
	iters: 300, epoch: 1 | loss: 0.8027470
	speed: 0.2533s/iter; left time: 9272.3219s
Epoch: 1 cost time: 93.35940074920654
Epoch: 1, Steps: 369 | Train Loss: 0.692 Vali Loss: 0.743 Vali Acc: 0.652 Test Loss: 0.743 Test Acc: 0.652
Validation loss decreased (inf --> -0.651525).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3274305
	speed: 0.7620s/iter; left time: 27761.1342s
	iters: 200, epoch: 2 | loss: 1.2018383
	speed: 0.2503s/iter; left time: 9094.0555s
	iters: 300, epoch: 2 | loss: 0.4899937
	speed: 0.2416s/iter; left time: 8753.8002s
Epoch: 2 cost time: 91.85067677497864
Epoch: 2, Steps: 369 | Train Loss: 0.575 Vali Loss: 0.907 Vali Acc: 0.640 Test Loss: 0.907 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3907745
	speed: 0.7156s/iter; left time: 25807.0278s
	iters: 200, epoch: 3 | loss: 0.1242497
	speed: 0.2401s/iter; left time: 8634.3019s
	iters: 300, epoch: 3 | loss: 0.6351854
	speed: 0.2282s/iter; left time: 8184.0716s
Epoch: 3 cost time: 87.84389996528625
Epoch: 3, Steps: 369 | Train Loss: 0.536 Vali Loss: 0.902 Vali Acc: 0.672 Test Loss: 0.902 Test Acc: 0.672
Validation loss decreased (-0.651525 --> -0.671955).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2006818
	speed: 0.7449s/iter; left time: 26590.1839s
	iters: 200, epoch: 4 | loss: 0.4526454
	speed: 0.2351s/iter; left time: 8368.4720s
	iters: 300, epoch: 4 | loss: 0.4594036
	speed: 0.2439s/iter; left time: 8656.9006s
Epoch: 4 cost time: 89.56008672714233
Epoch: 4, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.942 Vali Acc: 0.655 Test Loss: 0.942 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4615096
	speed: 0.7141s/iter; left time: 25224.9034s
	iters: 200, epoch: 5 | loss: 0.3281386
	speed: 0.2476s/iter; left time: 8721.3475s
	iters: 300, epoch: 5 | loss: 0.6524329
	speed: 0.2539s/iter; left time: 8918.3916s
Epoch: 5 cost time: 91.29130482673645
Epoch: 5, Steps: 369 | Train Loss: 0.452 Vali Loss: 1.278 Vali Acc: 0.645 Test Loss: 1.278 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6015013
	speed: 0.7067s/iter; left time: 24704.1247s
	iters: 200, epoch: 6 | loss: 0.5491109
	speed: 0.2512s/iter; left time: 8757.1950s
	iters: 300, epoch: 6 | loss: 0.3337216
	speed: 0.2491s/iter; left time: 8658.6732s
Epoch: 6 cost time: 92.75846934318542
Epoch: 6, Steps: 369 | Train Loss: 0.435 Vali Loss: 1.089 Vali Acc: 0.661 Test Loss: 1.089 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4113485
	speed: 0.7600s/iter; left time: 26285.1916s
	iters: 200, epoch: 7 | loss: 0.6776278
	speed: 0.2518s/iter; left time: 8682.3131s
	iters: 300, epoch: 7 | loss: 0.2951880
	speed: 0.2530s/iter; left time: 8701.1066s
Epoch: 7 cost time: 95.57278060913086
Epoch: 7, Steps: 369 | Train Loss: 0.383 Vali Loss: 1.265 Vali Acc: 0.653 Test Loss: 1.265 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1461307
	speed: 0.8383s/iter; left time: 28683.5945s
	iters: 200, epoch: 8 | loss: 0.8984691
	speed: 0.2778s/iter; left time: 9478.2630s
	iters: 300, epoch: 8 | loss: 0.4819126
	speed: 0.2728s/iter; left time: 9281.3396s
Epoch: 8 cost time: 100.76675605773926
Epoch: 8, Steps: 369 | Train Loss: 0.356 Vali Loss: 1.223 Vali Acc: 0.647 Test Loss: 1.223 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1666965
	speed: 0.7611s/iter; left time: 25764.0627s
	iters: 200, epoch: 9 | loss: 0.4336882
	speed: 0.2540s/iter; left time: 8572.5348s
	iters: 300, epoch: 9 | loss: 0.2843697
	speed: 0.2524s/iter; left time: 8494.0981s
Epoch: 9 cost time: 94.17234325408936
Epoch: 9, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.356 Vali Acc: 0.654 Test Loss: 1.356 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1327987
	speed: 0.8178s/iter; left time: 27378.9129s
	iters: 200, epoch: 10 | loss: 0.1694729
	speed: 0.2519s/iter; left time: 8407.9965s
	iters: 300, epoch: 10 | loss: 0.1630769
	speed: 0.2553s/iter; left time: 8495.2160s
Epoch: 10 cost time: 96.62666773796082
Epoch: 10, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.536 Vali Acc: 0.645 Test Loss: 1.536 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.3112715
	speed: 0.8437s/iter; left time: 27934.7449s
	iters: 200, epoch: 11 | loss: 0.4928156
	speed: 0.2748s/iter; left time: 9070.1851s
	iters: 300, epoch: 11 | loss: 0.0971026
	speed: 0.2630s/iter; left time: 8654.0926s
Epoch: 11 cost time: 99.70771598815918
Epoch: 11, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.517 Vali Acc: 0.654 Test Loss: 1.517 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0187841
	speed: 0.8519s/iter; left time: 27892.6483s
	iters: 200, epoch: 12 | loss: 0.1475862
	speed: 0.2910s/iter; left time: 9499.0621s
	iters: 300, epoch: 12 | loss: 0.0385004
	speed: 0.2891s/iter; left time: 9406.5732s
Epoch: 12 cost time: 107.80131268501282
Epoch: 12, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.446 Vali Acc: 0.665 Test Loss: 1.446 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2544042
	speed: 0.8870s/iter; left time: 28713.5132s
	iters: 200, epoch: 13 | loss: 0.1006716
	speed: 0.2787s/iter; left time: 8993.7244s
	iters: 300, epoch: 13 | loss: 0.2820970
	speed: 0.2761s/iter; left time: 8882.0177s
Epoch: 13 cost time: 103.1806070804596
Epoch: 13, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.677 Vali Acc: 0.671 Test Loss: 1.677 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6719636776390465
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6952168
	speed: 0.2814s/iter; left time: 10354.9294s
	iters: 200, epoch: 1 | loss: 0.6975565
	speed: 0.2539s/iter; left time: 9317.3994s
	iters: 300, epoch: 1 | loss: 0.6932616
	speed: 0.2628s/iter; left time: 9619.5898s
Epoch: 1 cost time: 98.18858242034912
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6921998
	speed: 0.8053s/iter; left time: 29337.1524s
	iters: 200, epoch: 2 | loss: 0.6931501
	speed: 0.2631s/iter; left time: 9559.8109s
	iters: 300, epoch: 2 | loss: 0.6931515
	speed: 0.2646s/iter; left time: 9586.1383s
Epoch: 2 cost time: 94.60582661628723
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6932334
	speed: 0.7641s/iter; left time: 27556.7381s
	iters: 200, epoch: 3 | loss: 0.6943601
	speed: 0.2436s/iter; left time: 8762.2148s
	iters: 300, epoch: 3 | loss: 0.6931629
	speed: 0.2478s/iter; left time: 8888.3037s
Epoch: 3 cost time: 91.64945864677429
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6925318
	speed: 0.8443s/iter; left time: 30135.8300s
	iters: 200, epoch: 4 | loss: 0.6931481
	speed: 0.2465s/iter; left time: 8775.5928s
	iters: 300, epoch: 4 | loss: 0.6928168
	speed: 0.2618s/iter; left time: 9292.9323s
Epoch: 4 cost time: 96.7921531200409
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6931543
	speed: 0.8037s/iter; left time: 28391.5587s
	iters: 200, epoch: 5 | loss: 0.6931515
	speed: 0.2647s/iter; left time: 9322.3642s
	iters: 300, epoch: 5 | loss: 0.6931694
	speed: 0.2689s/iter; left time: 9445.2778s
Epoch: 5 cost time: 95.66894149780273
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6931844
	speed: 0.7748s/iter; left time: 27083.5434s
	iters: 200, epoch: 6 | loss: 0.6923106
	speed: 0.2597s/iter; left time: 9051.4525s
	iters: 300, epoch: 6 | loss: 0.6931517
	speed: 0.2568s/iter; left time: 8926.3443s
Epoch: 6 cost time: 94.97751045227051
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6929868
	speed: 0.8329s/iter; left time: 28808.6413s
	iters: 200, epoch: 7 | loss: 0.6938955
	speed: 0.2297s/iter; left time: 7922.7379s
	iters: 300, epoch: 7 | loss: 0.6946828
	speed: 0.2423s/iter; left time: 8331.1780s
Epoch: 7 cost time: 90.3355348110199
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6931612
	speed: 0.7393s/iter; left time: 25296.8297s
	iters: 200, epoch: 8 | loss: 0.6937048
	speed: 0.2563s/iter; left time: 8743.1955s
	iters: 300, epoch: 8 | loss: 0.6914181
	speed: 0.2628s/iter; left time: 8940.2831s
Epoch: 8 cost time: 94.07559776306152
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6913828
	speed: 0.8226s/iter; left time: 27845.0470s
	iters: 200, epoch: 9 | loss: 0.6924470
	speed: 0.2635s/iter; left time: 8891.2116s
	iters: 300, epoch: 9 | loss: 0.6920964
	speed: 0.2650s/iter; left time: 8918.6591s
Epoch: 9 cost time: 96.46344375610352
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6907452
	speed: 0.7748s/iter; left time: 25938.9234s
	iters: 200, epoch: 10 | loss: 0.6950166
	speed: 0.2517s/iter; left time: 8402.7110s
	iters: 300, epoch: 10 | loss: 0.6932043
	speed: 0.2600s/iter; left time: 8653.2197s
Epoch: 10 cost time: 92.94792628288269
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6949757
	speed: 0.8107s/iter; left time: 26841.4477s
	iters: 200, epoch: 11 | loss: 0.6931763
	speed: 0.2486s/iter; left time: 8207.9224s
	iters: 300, epoch: 11 | loss: 0.6925790
	speed: 0.2563s/iter; left time: 8433.6625s
Epoch: 11 cost time: 94.22561693191528
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6918428
	speed: 0.7996s/iter; left time: 26179.6210s
	iters: 200, epoch: 12 | loss: 0.6884772
	speed: 0.2544s/iter; left time: 8303.2508s
	iters: 300, epoch: 12 | loss: 0.6935285
	speed: 0.2572s/iter; left time: 8368.4059s
Epoch: 12 cost time: 94.21614146232605
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 1375874
model size : 10.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5496017
	speed: 0.2867s/iter; left time: 10551.9833s
	iters: 200, epoch: 1 | loss: 0.6533884
	speed: 0.2608s/iter; left time: 9571.8267s
	iters: 300, epoch: 1 | loss: 0.7675629
	speed: 0.2597s/iter; left time: 9505.7296s
Epoch: 1 cost time: 98.98369431495667
Epoch: 1, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.756 Vali Acc: 0.640 Test Loss: 0.756 Test Acc: 0.640
Validation loss decreased (inf --> -0.639607).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2429654
	speed: 0.8385s/iter; left time: 30548.7532s
	iters: 200, epoch: 2 | loss: 0.3817371
	speed: 0.2555s/iter; left time: 9282.4115s
	iters: 300, epoch: 2 | loss: 0.2749223
	speed: 0.2609s/iter; left time: 9454.4696s
Epoch: 2 cost time: 95.37906169891357
Epoch: 2, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.899 Vali Acc: 0.654 Test Loss: 0.899 Test Acc: 0.654
Validation loss decreased (-0.639607 --> -0.653510).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2056445
	speed: 0.7813s/iter; left time: 28176.4901s
	iters: 200, epoch: 3 | loss: 0.5334386
	speed: 0.2428s/iter; left time: 8732.8048s
	iters: 300, epoch: 3 | loss: 0.4675595
	speed: 0.2572s/iter; left time: 9224.6577s
Epoch: 3 cost time: 93.31816816329956
Epoch: 3, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.999 Vali Acc: 0.651 Test Loss: 0.999 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0768258
	speed: 0.8372s/iter; left time: 29884.0360s
	iters: 200, epoch: 4 | loss: 0.1664278
	speed: 0.2654s/iter; left time: 9445.9644s
	iters: 300, epoch: 4 | loss: 0.1987898
	speed: 0.2466s/iter; left time: 8753.7004s
Epoch: 4 cost time: 95.23325753211975
Epoch: 4, Steps: 369 | Train Loss: 0.398 Vali Loss: 1.248 Vali Acc: 0.640 Test Loss: 1.248 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0249636
	speed: 0.7612s/iter; left time: 26889.4422s
	iters: 200, epoch: 5 | loss: 0.6932173
	speed: 0.2425s/iter; left time: 8543.4208s
	iters: 300, epoch: 5 | loss: 0.5501737
	speed: 0.2421s/iter; left time: 8504.6172s
Epoch: 5 cost time: 90.3416109085083
Epoch: 5, Steps: 369 | Train Loss: 0.369 Vali Loss: 1.268 Vali Acc: 0.642 Test Loss: 1.268 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0060891
	speed: 0.8372s/iter; left time: 29266.3736s
	iters: 200, epoch: 6 | loss: 0.3869958
	speed: 0.2629s/iter; left time: 9163.3169s
	iters: 300, epoch: 6 | loss: 0.2834283
	speed: 0.2514s/iter; left time: 8736.8086s
Epoch: 6 cost time: 96.67951583862305
Epoch: 6, Steps: 369 | Train Loss: 0.321 Vali Loss: 1.301 Vali Acc: 0.680 Test Loss: 1.301 Test Acc: 0.680
Validation loss decreased (-0.653510 --> -0.679896).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0415640
	speed: 0.7905s/iter; left time: 27340.3805s
	iters: 200, epoch: 7 | loss: 0.0281534
	speed: 0.2436s/iter; left time: 8400.3107s
	iters: 300, epoch: 7 | loss: 0.5259219
	speed: 0.2478s/iter; left time: 8521.5883s
Epoch: 7 cost time: 92.10913395881653
Epoch: 7, Steps: 369 | Train Loss: 0.299 Vali Loss: 1.409 Vali Acc: 0.639 Test Loss: 1.409 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1257621
	speed: 0.8664s/iter; left time: 29645.6926s
	iters: 200, epoch: 8 | loss: 0.5116826
	speed: 0.2797s/iter; left time: 9543.6013s
	iters: 300, epoch: 8 | loss: 0.1456861
	speed: 0.2725s/iter; left time: 9269.5125s
Epoch: 8 cost time: 102.856924533844
Epoch: 8, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.578 Vali Acc: 0.667 Test Loss: 1.578 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2211557
	speed: 0.8479s/iter; left time: 28699.5477s
	iters: 200, epoch: 9 | loss: 0.2479308
	speed: 0.2467s/iter; left time: 8325.7775s
	iters: 300, epoch: 9 | loss: 0.6121843
	speed: 0.2523s/iter; left time: 8491.2438s
Epoch: 9 cost time: 93.9296281337738
Epoch: 9, Steps: 369 | Train Loss: 0.243 Vali Loss: 1.684 Vali Acc: 0.636 Test Loss: 1.684 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5172700
	speed: 0.8116s/iter; left time: 27173.2542s
	iters: 200, epoch: 10 | loss: 0.1990810
	speed: 0.2560s/iter; left time: 8544.8813s
	iters: 300, epoch: 10 | loss: 0.0091711
	speed: 0.2636s/iter; left time: 8771.0828s
Epoch: 10 cost time: 96.36322712898254
Epoch: 10, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.837 Vali Acc: 0.651 Test Loss: 1.837 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5874225
	speed: 0.8143s/iter; left time: 26961.5937s
	iters: 200, epoch: 11 | loss: 0.3376278
	speed: 0.2446s/iter; left time: 8074.7542s
	iters: 300, epoch: 11 | loss: 0.0291440
	speed: 0.2576s/iter; left time: 8478.0724s
Epoch: 11 cost time: 93.4781379699707
Epoch: 11, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.993 Vali Acc: 0.655 Test Loss: 1.993 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5556605
	speed: 0.8103s/iter; left time: 26532.1304s
	iters: 200, epoch: 12 | loss: 0.0242169
	speed: 0.2441s/iter; left time: 7967.9309s
	iters: 300, epoch: 12 | loss: 0.1690229
	speed: 0.2492s/iter; left time: 8108.6922s
Epoch: 12 cost time: 92.3246796131134
Epoch: 12, Steps: 369 | Train Loss: 0.198 Vali Loss: 2.139 Vali Acc: 0.653 Test Loss: 2.139 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.5162784
	speed: 0.8027s/iter; left time: 25985.6205s
	iters: 200, epoch: 13 | loss: 0.1417870
	speed: 0.2567s/iter; left time: 8283.0710s
	iters: 300, epoch: 13 | loss: 0.2430320
	speed: 0.2492s/iter; left time: 8015.9568s
Epoch: 13 cost time: 94.52332735061646
Epoch: 13, Steps: 369 | Train Loss: 0.187 Vali Loss: 2.228 Vali Acc: 0.642 Test Loss: 2.228 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0006141
	speed: 0.8162s/iter; left time: 26121.9934s
	iters: 200, epoch: 14 | loss: 0.0061901
	speed: 0.2520s/iter; left time: 8038.4906s
	iters: 300, epoch: 14 | loss: 0.4283316
	speed: 0.2525s/iter; left time: 8030.3069s
Epoch: 14 cost time: 94.6699206829071
Epoch: 14, Steps: 369 | Train Loss: 0.185 Vali Loss: 2.232 Vali Acc: 0.651 Test Loss: 2.232 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0359821
	speed: 0.8199s/iter; left time: 25937.5201s
	iters: 200, epoch: 15 | loss: 0.0043071
	speed: 0.2672s/iter; left time: 8424.9118s
	iters: 300, epoch: 15 | loss: 0.0644176
	speed: 0.2654s/iter; left time: 8341.4218s
Epoch: 15 cost time: 97.99705243110657
Epoch: 15, Steps: 369 | Train Loss: 0.172 Vali Loss: 2.269 Vali Acc: 0.654 Test Loss: 2.269 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2124148
	speed: 0.7906s/iter; left time: 24717.3991s
	iters: 200, epoch: 16 | loss: 0.0366129
	speed: 0.2462s/iter; left time: 7672.5140s
	iters: 300, epoch: 16 | loss: 0.0067258
	speed: 0.2377s/iter; left time: 7383.9734s
Epoch: 16 cost time: 89.75084233283997
Epoch: 16, Steps: 369 | Train Loss: 0.156 Vali Loss: 2.380 Vali Acc: 0.662 Test Loss: 2.380 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6799091940976163
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5800993
	speed: 0.2810s/iter; left time: 10342.5229s
	iters: 200, epoch: 1 | loss: 0.6780994
	speed: 0.2630s/iter; left time: 9652.9591s
	iters: 300, epoch: 1 | loss: 0.7390926
	speed: 0.2564s/iter; left time: 9385.6146s
Epoch: 1 cost time: 97.20401930809021
Epoch: 1, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.764 Vali Acc: 0.640 Test Loss: 0.764 Test Acc: 0.640
Validation loss decreased (inf --> -0.639606).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2858330
	speed: 0.7650s/iter; left time: 27869.7009s
	iters: 200, epoch: 2 | loss: 0.3981054
	speed: 0.2459s/iter; left time: 8932.2667s
	iters: 300, epoch: 2 | loss: 0.2137772
	speed: 0.2481s/iter; left time: 8987.3645s
Epoch: 2 cost time: 91.68592548370361
Epoch: 2, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.873 Vali Acc: 0.657 Test Loss: 0.873 Test Acc: 0.657
Validation loss decreased (-0.639606 --> -0.656915).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2467001
	speed: 0.8421s/iter; left time: 30367.7083s
	iters: 200, epoch: 3 | loss: 0.7004072
	speed: 0.2753s/iter; left time: 9899.8003s
	iters: 300, epoch: 3 | loss: 0.4584140
	speed: 0.2678s/iter; left time: 9604.3547s
Epoch: 3 cost time: 100.13213968276978
Epoch: 3, Steps: 369 | Train Loss: 0.440 Vali Loss: 1.068 Vali Acc: 0.648 Test Loss: 1.068 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0336125
	speed: 0.7796s/iter; left time: 27827.6812s
	iters: 200, epoch: 4 | loss: 0.3693132
	speed: 0.2470s/iter; left time: 8791.0927s
	iters: 300, epoch: 4 | loss: 0.2492276
	speed: 0.2437s/iter; left time: 8649.7329s
Epoch: 4 cost time: 91.97903943061829
Epoch: 4, Steps: 369 | Train Loss: 0.402 Vali Loss: 1.540 Vali Acc: 0.627 Test Loss: 1.540 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8441820
	speed: 0.8323s/iter; left time: 29401.6310s
	iters: 200, epoch: 5 | loss: 0.4483701
	speed: 0.2726s/iter; left time: 9601.1989s
	iters: 300, epoch: 5 | loss: 0.3108350
	speed: 0.2447s/iter; left time: 8594.0255s
Epoch: 5 cost time: 97.87767219543457
Epoch: 5, Steps: 369 | Train Loss: 0.341 Vali Loss: 1.223 Vali Acc: 0.622 Test Loss: 1.223 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0671455
	speed: 0.8194s/iter; left time: 28641.5512s
	iters: 200, epoch: 6 | loss: 0.9364831
	speed: 0.2592s/iter; left time: 9034.4272s
	iters: 300, epoch: 6 | loss: 0.1630518
	speed: 0.2538s/iter; left time: 8820.2450s
Epoch: 6 cost time: 95.52039098739624
Epoch: 6, Steps: 369 | Train Loss: 0.325 Vali Loss: 1.343 Vali Acc: 0.673 Test Loss: 1.343 Test Acc: 0.673
Validation loss decreased (-0.656915 --> -0.672518).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0095848
	speed: 0.8033s/iter; left time: 27782.6562s
	iters: 200, epoch: 7 | loss: 0.1270327
	speed: 0.2717s/iter; left time: 9371.3415s
	iters: 300, epoch: 7 | loss: 0.0495306
	speed: 0.2566s/iter; left time: 8822.7227s
Epoch: 7 cost time: 95.83969759941101
Epoch: 7, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.414 Vali Acc: 0.653 Test Loss: 1.414 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2982545
	speed: 0.8071s/iter; left time: 27617.7017s
	iters: 200, epoch: 8 | loss: 0.5256976
	speed: 0.2535s/iter; left time: 8648.5576s
	iters: 300, epoch: 8 | loss: 0.1152413
	speed: 0.2564s/iter; left time: 8721.4438s
Epoch: 8 cost time: 96.2881531715393
Epoch: 8, Steps: 369 | Train Loss: 0.276 Vali Loss: 1.657 Vali Acc: 0.662 Test Loss: 1.657 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2245835
	speed: 0.8086s/iter; left time: 27371.8895s
	iters: 200, epoch: 9 | loss: 0.3413887
	speed: 0.2512s/iter; left time: 8478.0460s
	iters: 300, epoch: 9 | loss: 0.2173060
	speed: 0.2487s/iter; left time: 8369.1781s
Epoch: 9 cost time: 92.4554455280304
Epoch: 9, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.733 Vali Acc: 0.625 Test Loss: 1.733 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3085762
	speed: 0.7979s/iter; left time: 26714.4115s
	iters: 200, epoch: 10 | loss: 0.3719198
	speed: 0.2581s/iter; left time: 8616.1818s
	iters: 300, epoch: 10 | loss: 0.0183648
	speed: 0.2562s/iter; left time: 8525.7675s
Epoch: 10 cost time: 96.12483334541321
Epoch: 10, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.725 Vali Acc: 0.656 Test Loss: 1.725 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6392523
	speed: 0.8463s/iter; left time: 28020.6936s
	iters: 200, epoch: 11 | loss: 0.7247193
	speed: 0.2612s/iter; left time: 8620.9655s
	iters: 300, epoch: 11 | loss: 0.5837448
	speed: 0.2526s/iter; left time: 8312.5432s
Epoch: 11 cost time: 97.10443902015686
Epoch: 11, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.988 Vali Acc: 0.661 Test Loss: 1.988 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0026411
	speed: 0.8057s/iter; left time: 26381.8271s
	iters: 200, epoch: 12 | loss: 0.0089208
	speed: 0.2562s/iter; left time: 8363.4018s
	iters: 300, epoch: 12 | loss: 0.3231722
	speed: 0.2593s/iter; left time: 8439.4325s
Epoch: 12 cost time: 95.32776069641113
Epoch: 12, Steps: 369 | Train Loss: 0.210 Vali Loss: 2.009 Vali Acc: 0.657 Test Loss: 2.009 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1041251
	speed: 0.8123s/iter; left time: 26296.1965s
	iters: 200, epoch: 13 | loss: 0.2127678
	speed: 0.2480s/iter; left time: 8003.8760s
	iters: 300, epoch: 13 | loss: 0.6354190
	speed: 0.2589s/iter; left time: 8329.1637s
Epoch: 13 cost time: 95.47729396820068
Epoch: 13, Steps: 369 | Train Loss: 0.200 Vali Loss: 2.141 Vali Acc: 0.644 Test Loss: 2.141 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0073504
	speed: 0.8111s/iter; left time: 25958.5294s
	iters: 200, epoch: 14 | loss: 0.0160572
	speed: 0.2648s/iter; left time: 8446.7920s
	iters: 300, epoch: 14 | loss: 0.1195271
	speed: 0.2636s/iter; left time: 8383.5594s
Epoch: 14 cost time: 97.13133430480957
Epoch: 14, Steps: 369 | Train Loss: 0.174 Vali Loss: 2.279 Vali Acc: 0.652 Test Loss: 2.279 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0952261
	speed: 0.8151s/iter; left time: 25786.0475s
	iters: 200, epoch: 15 | loss: 0.2550538
	speed: 0.2710s/iter; left time: 8547.3527s
	iters: 300, epoch: 15 | loss: 0.2079180
	speed: 0.2826s/iter; left time: 8884.7426s
Epoch: 15 cost time: 100.58487367630005
Epoch: 15, Steps: 369 | Train Loss: 0.175 Vali Loss: 2.140 Vali Acc: 0.643 Test Loss: 2.140 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0005849
	speed: 0.8646s/iter; left time: 27032.8157s
	iters: 200, epoch: 16 | loss: 0.1658534
	speed: 0.2757s/iter; left time: 8593.7311s
	iters: 300, epoch: 16 | loss: 0.0049552
	speed: 0.2691s/iter; left time: 8359.7623s
Epoch: 16 cost time: 104.17287826538086
Epoch: 16, Steps: 369 | Train Loss: 0.156 Vali Loss: 2.479 Vali Acc: 0.655 Test Loss: 2.479 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6725312145289444
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5724742
	speed: 0.2842s/iter; left time: 10460.1681s
	iters: 200, epoch: 1 | loss: 0.6033117
	speed: 0.2604s/iter; left time: 9556.8654s
	iters: 300, epoch: 1 | loss: 0.7268468
	speed: 0.2708s/iter; left time: 9911.5564s
Epoch: 1 cost time: 99.91281986236572
Epoch: 1, Steps: 369 | Train Loss: 0.669 Vali Loss: 0.765 Vali Acc: 0.640 Test Loss: 0.765 Test Acc: 0.640
Validation loss decreased (inf --> -0.639606).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2029503
	speed: 0.8047s/iter; left time: 29317.7147s
	iters: 200, epoch: 2 | loss: 0.3379681
	speed: 0.2359s/iter; left time: 8571.9841s
	iters: 300, epoch: 2 | loss: 0.2097561
	speed: 0.2452s/iter; left time: 8884.7483s
Epoch: 2 cost time: 89.88229131698608
Epoch: 2, Steps: 369 | Train Loss: 0.531 Vali Loss: 0.861 Vali Acc: 0.654 Test Loss: 0.861 Test Acc: 0.654
Validation loss decreased (-0.639606 --> -0.654361).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3082301
	speed: 0.7642s/iter; left time: 27558.7734s
	iters: 200, epoch: 3 | loss: 0.6314093
	speed: 0.2524s/iter; left time: 9077.2646s
	iters: 300, epoch: 3 | loss: 0.4082613
	speed: 0.2599s/iter; left time: 9322.2903s
Epoch: 3 cost time: 93.91180610656738
Epoch: 3, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.910 Vali Acc: 0.672 Test Loss: 0.910 Test Acc: 0.672
Validation loss decreased (-0.654361 --> -0.671955).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1203791
	speed: 0.7962s/iter; left time: 28420.0463s
	iters: 200, epoch: 4 | loss: 0.3876466
	speed: 0.2427s/iter; left time: 8638.1895s
	iters: 300, epoch: 4 | loss: 0.4412888
	speed: 0.2613s/iter; left time: 9275.9260s
Epoch: 4 cost time: 94.17797660827637
Epoch: 4, Steps: 369 | Train Loss: 0.412 Vali Loss: 1.158 Vali Acc: 0.645 Test Loss: 1.158 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7741806
	speed: 0.8610s/iter; left time: 30416.3268s
	iters: 200, epoch: 5 | loss: 0.7756490
	speed: 0.2662s/iter; left time: 9377.8885s
	iters: 300, epoch: 5 | loss: 0.1530684
	speed: 0.2610s/iter; left time: 9168.0050s
Epoch: 5 cost time: 98.88101506233215
Epoch: 5, Steps: 369 | Train Loss: 0.360 Vali Loss: 1.032 Vali Acc: 0.659 Test Loss: 1.032 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0282523
	speed: 0.8274s/iter; left time: 28923.5289s
	iters: 200, epoch: 6 | loss: 0.5109680
	speed: 0.2645s/iter; left time: 9220.5969s
	iters: 300, epoch: 6 | loss: 0.8530757
	speed: 0.2589s/iter; left time: 8996.7472s
Epoch: 6 cost time: 95.869544506073
Epoch: 6, Steps: 369 | Train Loss: 0.325 Vali Loss: 1.345 Vali Acc: 0.655 Test Loss: 1.345 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0928527
	speed: 0.8419s/iter; left time: 29117.3677s
	iters: 200, epoch: 7 | loss: 0.1120508
	speed: 0.2631s/iter; left time: 9073.5536s
	iters: 300, epoch: 7 | loss: 0.2262959
	speed: 0.2534s/iter; left time: 8712.1021s
Epoch: 7 cost time: 95.11511492729187
Epoch: 7, Steps: 369 | Train Loss: 0.301 Vali Loss: 1.383 Vali Acc: 0.663 Test Loss: 1.383 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1268682
	speed: 0.8248s/iter; left time: 28222.2149s
	iters: 200, epoch: 8 | loss: 0.3160370
	speed: 0.2542s/iter; left time: 8673.3080s
	iters: 300, epoch: 8 | loss: 0.1410517
	speed: 0.2584s/iter; left time: 8790.3616s
Epoch: 8 cost time: 95.87678217887878
Epoch: 8, Steps: 369 | Train Loss: 0.284 Vali Loss: 1.519 Vali Acc: 0.653 Test Loss: 1.519 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0368140
	speed: 0.8855s/iter; left time: 29973.9580s
	iters: 200, epoch: 9 | loss: 0.4091373
	speed: 0.2638s/iter; left time: 8902.6741s
	iters: 300, epoch: 9 | loss: 0.1648951
	speed: 0.2663s/iter; left time: 8960.6290s
Epoch: 9 cost time: 99.56918334960938
Epoch: 9, Steps: 369 | Train Loss: 0.244 Vali Loss: 1.606 Vali Acc: 0.661 Test Loss: 1.606 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0145198
	speed: 0.8616s/iter; left time: 28847.1415s
	iters: 200, epoch: 10 | loss: 0.2663135
	speed: 0.2729s/iter; left time: 9109.4018s
	iters: 300, epoch: 10 | loss: 0.0704791
	speed: 0.2677s/iter; left time: 8909.3161s
Epoch: 10 cost time: 100.49283146858215
Epoch: 10, Steps: 369 | Train Loss: 0.252 Vali Loss: 1.765 Vali Acc: 0.654 Test Loss: 1.765 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.8299690
	speed: 0.8547s/iter; left time: 28299.1643s
	iters: 200, epoch: 11 | loss: 0.2275987
	speed: 0.2559s/iter; left time: 8446.3567s
	iters: 300, epoch: 11 | loss: 0.1363107
	speed: 0.2568s/iter; left time: 8453.1509s
Epoch: 11 cost time: 95.9631597995758
Epoch: 11, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.969 Vali Acc: 0.657 Test Loss: 1.969 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1387369
	speed: 0.8358s/iter; left time: 27366.6572s
	iters: 200, epoch: 12 | loss: 0.0536556
	speed: 0.2615s/iter; left time: 8536.3690s
	iters: 300, epoch: 12 | loss: 0.1001738
	speed: 0.2576s/iter; left time: 8381.4209s
Epoch: 12 cost time: 96.34381675720215
Epoch: 12, Steps: 369 | Train Loss: 0.220 Vali Loss: 2.186 Vali Acc: 0.664 Test Loss: 2.186 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1527312
	speed: 0.8535s/iter; left time: 27630.9386s
	iters: 200, epoch: 13 | loss: 0.0223342
	speed: 0.2762s/iter; left time: 8912.9679s
	iters: 300, epoch: 13 | loss: 0.0355192
	speed: 0.2768s/iter; left time: 8905.9710s
Epoch: 13 cost time: 100.43764662742615
Epoch: 13, Steps: 369 | Train Loss: 0.192 Vali Loss: 2.067 Vali Acc: 0.660 Test Loss: 2.067 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6719636776390465
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5154602
	speed: 0.2957s/iter; left time: 10883.0798s
	iters: 200, epoch: 1 | loss: 0.6074041
	speed: 0.2770s/iter; left time: 10166.7842s
	iters: 300, epoch: 1 | loss: 0.7663337
	speed: 0.2658s/iter; left time: 9729.8099s
Epoch: 1 cost time: 102.17613172531128
Epoch: 1, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.783 Vali Acc: 0.625 Test Loss: 0.783 Test Acc: 0.625
Validation loss decreased (inf --> -0.625418).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2374099
	speed: 0.8347s/iter; left time: 30410.1942s
	iters: 200, epoch: 2 | loss: 0.2983761
	speed: 0.2639s/iter; left time: 9587.0293s
	iters: 300, epoch: 2 | loss: 0.2549739
	speed: 0.2682s/iter; left time: 9717.7816s
Epoch: 2 cost time: 97.75349736213684
Epoch: 2, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.843 Vali Acc: 0.663 Test Loss: 0.843 Test Acc: 0.663
Validation loss decreased (-0.625418 --> -0.662591).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1585096
	speed: 0.8663s/iter; left time: 31240.5351s
	iters: 200, epoch: 3 | loss: 0.7453449
	speed: 0.2744s/iter; left time: 9868.8989s
	iters: 300, epoch: 3 | loss: 0.5954913
	speed: 0.2690s/iter; left time: 9647.4691s
Epoch: 3 cost time: 98.52589893341064
Epoch: 3, Steps: 369 | Train Loss: 0.470 Vali Loss: 1.041 Vali Acc: 0.647 Test Loss: 1.041 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2021505
	speed: 0.8632s/iter; left time: 30809.8703s
	iters: 200, epoch: 4 | loss: 0.3655785
	speed: 0.2672s/iter; left time: 9510.9987s
	iters: 300, epoch: 4 | loss: 0.1617415
	speed: 0.2753s/iter; left time: 9772.8358s
Epoch: 4 cost time: 100.92863607406616
Epoch: 4, Steps: 369 | Train Loss: 0.406 Vali Loss: 1.179 Vali Acc: 0.658 Test Loss: 1.179 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6142951
	speed: 0.8679s/iter; left time: 30656.8648s
	iters: 200, epoch: 5 | loss: 0.5690122
	speed: 0.2610s/iter; left time: 9192.9980s
	iters: 300, epoch: 5 | loss: 0.2407137
	speed: 0.2597s/iter; left time: 9121.5495s
Epoch: 5 cost time: 98.26591515541077
Epoch: 5, Steps: 369 | Train Loss: 0.379 Vali Loss: 1.155 Vali Acc: 0.642 Test Loss: 1.155 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0875279
	speed: 0.8804s/iter; left time: 30776.7845s
	iters: 200, epoch: 6 | loss: 0.6341295
	speed: 0.2701s/iter; left time: 9412.9356s
	iters: 300, epoch: 6 | loss: 0.1040619
	speed: 0.2686s/iter; left time: 9336.6607s
Epoch: 6 cost time: 101.67627573013306
Epoch: 6, Steps: 369 | Train Loss: 0.321 Vali Loss: 1.297 Vali Acc: 0.665 Test Loss: 1.297 Test Acc: 0.665
Validation loss decreased (-0.662591 --> -0.665140).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0616816
	speed: 0.9117s/iter; left time: 31534.4633s
	iters: 200, epoch: 7 | loss: 0.0539534
	speed: 0.2837s/iter; left time: 9783.9886s
	iters: 300, epoch: 7 | loss: 0.3628549
	speed: 0.2631s/iter; left time: 9046.3685s
Epoch: 7 cost time: 101.42790484428406
Epoch: 7, Steps: 369 | Train Loss: 0.292 Vali Loss: 1.642 Vali Acc: 0.658 Test Loss: 1.642 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6769063
	speed: 0.8937s/iter; left time: 30581.2113s
	iters: 200, epoch: 8 | loss: 0.2055633
	speed: 0.2788s/iter; left time: 9510.4302s
	iters: 300, epoch: 8 | loss: 0.2969407
	speed: 0.2720s/iter; left time: 9252.3509s
Epoch: 8 cost time: 104.26095223426819
Epoch: 8, Steps: 369 | Train Loss: 0.300 Vali Loss: 1.583 Vali Acc: 0.659 Test Loss: 1.583 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5071227
	speed: 0.9133s/iter; left time: 30913.7749s
	iters: 200, epoch: 9 | loss: 0.2228465
	speed: 0.2767s/iter; left time: 9339.2597s
	iters: 300, epoch: 9 | loss: 0.3701286
	speed: 0.2533s/iter; left time: 8523.6400s
Epoch: 9 cost time: 98.98324966430664
Epoch: 9, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.592 Vali Acc: 0.654 Test Loss: 1.592 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1841169
	speed: 0.8164s/iter; left time: 27331.5830s
	iters: 200, epoch: 10 | loss: 0.2973132
	speed: 0.2661s/iter; left time: 8881.5736s
	iters: 300, epoch: 10 | loss: 0.6617860
	speed: 0.2603s/iter; left time: 8662.4838s
Epoch: 10 cost time: 97.49528884887695
Epoch: 10, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.695 Vali Acc: 0.663 Test Loss: 1.695 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3453465
	speed: 0.8282s/iter; left time: 27421.0188s
	iters: 200, epoch: 11 | loss: 0.3134899
	speed: 0.2715s/iter; left time: 8961.3796s
	iters: 300, epoch: 11 | loss: 0.0065903
	speed: 0.2657s/iter; left time: 8745.2662s
Epoch: 11 cost time: 99.34703707695007
Epoch: 11, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.997 Vali Acc: 0.665 Test Loss: 1.997 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0562145
	speed: 0.8147s/iter; left time: 26676.4991s
	iters: 200, epoch: 12 | loss: 0.1849316
	speed: 0.2588s/iter; left time: 8448.0867s
	iters: 300, epoch: 12 | loss: 0.2764509
	speed: 0.2776s/iter; left time: 9034.2385s
Epoch: 12 cost time: 98.01775670051575
Epoch: 12, Steps: 369 | Train Loss: 0.210 Vali Loss: 2.026 Vali Acc: 0.637 Test Loss: 2.026 Test Acc: 0.637
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2676990
	speed: 0.8741s/iter; left time: 28295.9799s
	iters: 200, epoch: 13 | loss: 0.0210977
	speed: 0.2513s/iter; left time: 8111.4121s
	iters: 300, epoch: 13 | loss: 0.2587871
	speed: 0.2582s/iter; left time: 8305.7446s
Epoch: 13 cost time: 95.16746520996094
Epoch: 13, Steps: 369 | Train Loss: 0.184 Vali Loss: 2.147 Vali Acc: 0.646 Test Loss: 2.147 Test Acc: 0.646
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0307258
	speed: 0.8627s/iter; left time: 27608.7593s
	iters: 200, epoch: 14 | loss: 0.2819125
	speed: 0.2750s/iter; left time: 8773.0852s
	iters: 300, epoch: 14 | loss: 0.2792531
	speed: 0.2751s/iter; left time: 8749.4907s
Epoch: 14 cost time: 101.1829035282135
Epoch: 14, Steps: 369 | Train Loss: 0.168 Vali Loss: 2.184 Vali Acc: 0.652 Test Loss: 2.184 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0112428
	speed: 0.8499s/iter; left time: 26885.8121s
	iters: 200, epoch: 15 | loss: 0.3163371
	speed: 0.2696s/iter; left time: 8503.3900s
	iters: 300, epoch: 15 | loss: 0.3569506
	speed: 0.2518s/iter; left time: 7916.0599s
Epoch: 15 cost time: 97.01146173477173
Epoch: 15, Steps: 369 | Train Loss: 0.176 Vali Loss: 2.084 Vali Acc: 0.657 Test Loss: 2.084 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.3558375
	speed: 0.8870s/iter; left time: 27734.4308s
	iters: 200, epoch: 16 | loss: 0.0043076
	speed: 0.2923s/iter; left time: 9110.0744s
	iters: 300, epoch: 16 | loss: 0.0023471
	speed: 0.2914s/iter; left time: 9053.9145s
Epoch: 16 cost time: 107.46249485015869
Epoch: 16, Steps: 369 | Train Loss: 0.131 Vali Loss: 2.271 Vali Acc: 0.657 Test Loss: 2.271 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6651532349602725
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6091966
	speed: 0.3006s/iter; left time: 11062.7527s
	iters: 200, epoch: 1 | loss: 0.6503391
	speed: 0.2800s/iter; left time: 10276.2164s
	iters: 300, epoch: 1 | loss: 0.6290721
	speed: 0.2691s/iter; left time: 9850.2779s
Epoch: 1 cost time: 103.26367545127869
Epoch: 1, Steps: 369 | Train Loss: 0.694 Vali Loss: 0.746 Vali Acc: 0.638 Test Loss: 0.746 Test Acc: 0.638
Validation loss decreased (inf --> -0.637904).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3290679
	speed: 0.8121s/iter; left time: 29584.8183s
	iters: 200, epoch: 2 | loss: 0.4671211
	speed: 0.2749s/iter; left time: 9986.6026s
	iters: 300, epoch: 2 | loss: 0.2119802
	speed: 0.2629s/iter; left time: 9524.7366s
Epoch: 2 cost time: 98.10208201408386
Epoch: 2, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.835 Vali Acc: 0.663 Test Loss: 0.835 Test Acc: 0.663
Validation loss decreased (-0.637904 --> -0.662591).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0967746
	speed: 0.8594s/iter; left time: 30991.0096s
	iters: 200, epoch: 3 | loss: 0.3892061
	speed: 0.2861s/iter; left time: 10290.5029s
	iters: 300, epoch: 3 | loss: 0.6693263
	speed: 0.2710s/iter; left time: 9720.2827s
Epoch: 3 cost time: 103.15239906311035
Epoch: 3, Steps: 369 | Train Loss: 0.470 Vali Loss: 1.036 Vali Acc: 0.657 Test Loss: 1.036 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2524318
	speed: 0.8466s/iter; left time: 30219.3808s
	iters: 200, epoch: 4 | loss: 0.2695074
	speed: 0.2615s/iter; left time: 9309.5045s
	iters: 300, epoch: 4 | loss: 0.3396665
	speed: 0.2871s/iter; left time: 10189.8427s
Epoch: 4 cost time: 100.36137557029724
Epoch: 4, Steps: 369 | Train Loss: 0.415 Vali Loss: 1.292 Vali Acc: 0.627 Test Loss: 1.292 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2440769
	speed: 0.9260s/iter; left time: 32709.3185s
	iters: 200, epoch: 5 | loss: 0.5262698
	speed: 0.2829s/iter; left time: 9965.6306s
	iters: 300, epoch: 5 | loss: 0.2077449
	speed: 0.2744s/iter; left time: 9636.5817s
Epoch: 5 cost time: 105.10851812362671
Epoch: 5, Steps: 369 | Train Loss: 0.362 Vali Loss: 1.133 Vali Acc: 0.631 Test Loss: 1.133 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2047306
	speed: 0.8973s/iter; left time: 31365.5801s
	iters: 200, epoch: 6 | loss: 0.4167283
	speed: 0.2836s/iter; left time: 9886.0572s
	iters: 300, epoch: 6 | loss: 0.5449691
	speed: 0.2823s/iter; left time: 9812.9542s
Epoch: 6 cost time: 105.3280725479126
Epoch: 6, Steps: 369 | Train Loss: 0.329 Vali Loss: 1.310 Vali Acc: 0.673 Test Loss: 1.310 Test Acc: 0.673
Validation loss decreased (-0.662591 --> -0.672802).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8995874
	speed: 0.9141s/iter; left time: 31614.5384s
	iters: 200, epoch: 7 | loss: 0.0077203
	speed: 0.2753s/iter; left time: 9495.9154s
	iters: 300, epoch: 7 | loss: 0.1815185
	speed: 0.2605s/iter; left time: 8957.7850s
Epoch: 7 cost time: 101.00536370277405
Epoch: 7, Steps: 369 | Train Loss: 0.298 Vali Loss: 1.491 Vali Acc: 0.645 Test Loss: 1.491 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0879384
	speed: 0.8455s/iter; left time: 28931.9735s
	iters: 200, epoch: 8 | loss: 0.6085030
	speed: 0.2894s/iter; left time: 9872.0550s
	iters: 300, epoch: 8 | loss: 0.2249261
	speed: 0.2641s/iter; left time: 8983.9705s
Epoch: 8 cost time: 100.32828092575073
Epoch: 8, Steps: 369 | Train Loss: 0.277 Vali Loss: 1.593 Vali Acc: 0.662 Test Loss: 1.593 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5779307
	speed: 0.8250s/iter; left time: 27924.3848s
	iters: 200, epoch: 9 | loss: 0.1335006
	speed: 0.2752s/iter; left time: 9288.0489s
	iters: 300, epoch: 9 | loss: 0.0279296
	speed: 0.2657s/iter; left time: 8940.6558s
Epoch: 9 cost time: 100.23769164085388
Epoch: 9, Steps: 369 | Train Loss: 0.255 Vali Loss: 1.922 Vali Acc: 0.633 Test Loss: 1.922 Test Acc: 0.633
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0298986
	speed: 0.9187s/iter; left time: 30756.5528s
	iters: 200, epoch: 10 | loss: 0.3088042
	speed: 0.2831s/iter; left time: 9451.0791s
	iters: 300, epoch: 10 | loss: 0.5989603
	speed: 0.2683s/iter; left time: 8928.8404s
Epoch: 10 cost time: 103.28275537490845
Epoch: 10, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.704 Vali Acc: 0.658 Test Loss: 1.704 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2063237
	speed: 0.8915s/iter; left time: 29518.2207s
	iters: 200, epoch: 11 | loss: 0.0740654
	speed: 0.2874s/iter; left time: 9488.7054s
	iters: 300, epoch: 11 | loss: 0.2741708
	speed: 0.2846s/iter; left time: 9368.0348s
Epoch: 11 cost time: 105.1248939037323
Epoch: 11, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.943 Vali Acc: 0.634 Test Loss: 1.943 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4051872
	speed: 0.8974s/iter; left time: 29384.0228s
	iters: 200, epoch: 12 | loss: 0.1027170
	speed: 0.2790s/iter; left time: 9107.8133s
	iters: 300, epoch: 12 | loss: 0.0386301
	speed: 0.2692s/iter; left time: 8759.4995s
Epoch: 12 cost time: 101.59723234176636
Epoch: 12, Steps: 369 | Train Loss: 0.211 Vali Loss: 2.036 Vali Acc: 0.669 Test Loss: 2.036 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2910435
	speed: 0.8890s/iter; left time: 28779.6061s
	iters: 200, epoch: 13 | loss: 0.4225796
	speed: 0.2598s/iter; left time: 8384.9319s
	iters: 300, epoch: 13 | loss: 0.4269783
	speed: 0.2658s/iter; left time: 8550.7688s
Epoch: 13 cost time: 98.39294910430908
Epoch: 13, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.957 Vali Acc: 0.635 Test Loss: 1.957 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0082423
	speed: 0.8862s/iter; left time: 28362.2494s
	iters: 200, epoch: 14 | loss: 0.0213425
	speed: 0.2898s/iter; left time: 9246.7228s
	iters: 300, epoch: 14 | loss: 0.6821148
	speed: 0.2741s/iter; left time: 8717.9399s
Epoch: 14 cost time: 104.29779386520386
Epoch: 14, Steps: 369 | Train Loss: 0.184 Vali Loss: 2.240 Vali Acc: 0.661 Test Loss: 2.240 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0895855
	speed: 0.9153s/iter; left time: 28955.9757s
	iters: 200, epoch: 15 | loss: 0.5813630
	speed: 0.2741s/iter; left time: 8644.2355s
	iters: 300, epoch: 15 | loss: 0.5261808
	speed: 0.2558s/iter; left time: 8042.5965s
Epoch: 15 cost time: 99.14496231079102
Epoch: 15, Steps: 369 | Train Loss: 0.186 Vali Loss: 2.139 Vali Acc: 0.646 Test Loss: 2.139 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0230548
	speed: 0.9260s/iter; left time: 28951.1646s
	iters: 200, epoch: 16 | loss: 0.1103106
	speed: 0.2786s/iter; left time: 8681.8957s
	iters: 300, epoch: 16 | loss: 0.3168283
	speed: 0.2776s/iter; left time: 8624.4609s
Epoch: 16 cost time: 104.99450397491455
Epoch: 16, Steps: 369 | Train Loss: 0.183 Vali Loss: 2.278 Vali Acc: 0.675 Test Loss: 2.278 Test Acc: 0.675
Validation loss decreased (-0.672802 --> -0.675346).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1149252
	speed: 0.9043s/iter; left time: 27940.2882s
	iters: 200, epoch: 17 | loss: 0.5847850
	speed: 0.2912s/iter; left time: 8968.2914s
	iters: 300, epoch: 17 | loss: 0.0103391
	speed: 0.2979s/iter; left time: 9143.6087s
Epoch: 17 cost time: 107.78991174697876
Epoch: 17, Steps: 369 | Train Loss: 0.167 Vali Loss: 2.274 Vali Acc: 0.674 Test Loss: 2.274 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9633582
	speed: 0.8851s/iter; left time: 27018.8677s
	iters: 200, epoch: 18 | loss: 0.0457018
	speed: 0.2648s/iter; left time: 8058.3027s
	iters: 300, epoch: 18 | loss: 0.0624065
	speed: 0.2763s/iter; left time: 8380.2447s
Epoch: 18 cost time: 101.90911722183228
Epoch: 18, Steps: 369 | Train Loss: 0.163 Vali Loss: 2.507 Vali Acc: 0.664 Test Loss: 2.507 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0307538
	speed: 1.0185s/iter; left time: 30718.2583s
	iters: 200, epoch: 19 | loss: 0.0070812
	speed: 0.2827s/iter; left time: 8496.9250s
	iters: 300, epoch: 19 | loss: 0.0483959
	speed: 0.2763s/iter; left time: 8279.0536s
Epoch: 19 cost time: 106.11394500732422
Epoch: 19, Steps: 369 | Train Loss: 0.150 Vali Loss: 2.629 Vali Acc: 0.652 Test Loss: 2.629 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0369833
	speed: 0.9677s/iter; left time: 28828.6676s
	iters: 200, epoch: 20 | loss: 0.0005184
	speed: 0.2735s/iter; left time: 8119.9652s
	iters: 300, epoch: 20 | loss: 0.1175026
	speed: 0.2944s/iter; left time: 8710.7520s
Epoch: 20 cost time: 105.05092263221741
Epoch: 20, Steps: 369 | Train Loss: 0.134 Vali Loss: 2.575 Vali Acc: 0.640 Test Loss: 2.575 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0274594
	speed: 0.9356s/iter; left time: 27525.0305s
	iters: 200, epoch: 21 | loss: 0.0010460
	speed: 0.2912s/iter; left time: 8538.7650s
	iters: 300, epoch: 21 | loss: 0.0178113
	speed: 0.2794s/iter; left time: 8164.7841s
Epoch: 21 cost time: 107.33729481697083
Epoch: 21, Steps: 369 | Train Loss: 0.154 Vali Loss: 2.674 Vali Acc: 0.652 Test Loss: 2.674 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0679199
	speed: 0.9793s/iter; left time: 28450.4728s
	iters: 200, epoch: 22 | loss: 0.0635550
	speed: 0.2916s/iter; left time: 8441.6688s
	iters: 300, epoch: 22 | loss: 0.1642012
	speed: 0.2983s/iter; left time: 8607.6012s
Epoch: 22 cost time: 107.87222409248352
Epoch: 22, Steps: 369 | Train Loss: 0.141 Vali Loss: 2.469 Vali Acc: 0.652 Test Loss: 2.469 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0472801
	speed: 0.9335s/iter; left time: 26776.1971s
	iters: 200, epoch: 23 | loss: 0.1311401
	speed: 0.3027s/iter; left time: 8653.4866s
	iters: 300, epoch: 23 | loss: 0.0180792
	speed: 0.2726s/iter; left time: 7764.0300s
Epoch: 23 cost time: 106.39730620384216
Epoch: 23, Steps: 369 | Train Loss: 0.124 Vali Loss: 2.447 Vali Acc: 0.654 Test Loss: 2.447 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0056401
	speed: 0.8678s/iter; left time: 24571.1015s
	iters: 200, epoch: 24 | loss: 0.0022425
	speed: 0.2611s/iter; left time: 7365.6119s
	iters: 300, epoch: 24 | loss: 0.0709666
	speed: 0.2776s/iter; left time: 7804.7238s
Epoch: 24 cost time: 99.7725281715393
Epoch: 24, Steps: 369 | Train Loss: 0.142 Vali Loss: 2.923 Vali Acc: 0.653 Test Loss: 2.923 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0201789
	speed: 0.8899s/iter; left time: 24869.2667s
	iters: 200, epoch: 25 | loss: 0.0263145
	speed: 0.2594s/iter; left time: 7222.1877s
	iters: 300, epoch: 25 | loss: 0.4040971
	speed: 0.2485s/iter; left time: 6895.8517s
Epoch: 25 cost time: 94.40199661254883
Epoch: 25, Steps: 369 | Train Loss: 0.116 Vali Loss: 2.697 Vali Acc: 0.656 Test Loss: 2.697 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2682115
	speed: 0.8897s/iter; left time: 24534.5074s
	iters: 200, epoch: 26 | loss: 0.5119765
	speed: 0.2782s/iter; left time: 7645.1247s
	iters: 300, epoch: 26 | loss: 0.0506144
	speed: 0.2601s/iter; left time: 7121.5614s
Epoch: 26 cost time: 100.30352306365967
Epoch: 26, Steps: 369 | Train Loss: 0.112 Vali Loss: 3.221 Vali Acc: 0.634 Test Loss: 3.221 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5879000
	speed: 0.3127s/iter; left time: 11509.2447s
	iters: 200, epoch: 1 | loss: 0.6164773
	speed: 0.2830s/iter; left time: 10385.3114s
	iters: 300, epoch: 1 | loss: 0.7934471
	speed: 0.2897s/iter; left time: 10602.1276s
Epoch: 1 cost time: 107.61948084831238
Epoch: 1, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.763 Vali Acc: 0.632 Test Loss: 0.763 Test Acc: 0.632
Validation loss decreased (inf --> -0.631661).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3801844
	speed: 0.9026s/iter; left time: 32885.0590s
	iters: 200, epoch: 2 | loss: 0.3957496
	speed: 0.2721s/iter; left time: 9884.2415s
	iters: 300, epoch: 2 | loss: 0.3774980
	speed: 0.2821s/iter; left time: 10220.6352s
Epoch: 2 cost time: 102.33669972419739
Epoch: 2, Steps: 369 | Train Loss: 0.564 Vali Loss: 0.868 Vali Acc: 0.656 Test Loss: 0.868 Test Acc: 0.656
Validation loss decreased (-0.631661 --> -0.656348).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0752323
	speed: 0.9236s/iter; left time: 33306.7724s
	iters: 200, epoch: 3 | loss: 0.3997335
	speed: 0.2749s/iter; left time: 9887.6772s
	iters: 300, epoch: 3 | loss: 0.3249692
	speed: 0.2587s/iter; left time: 9279.2080s
Epoch: 3 cost time: 99.67816066741943
Epoch: 3, Steps: 369 | Train Loss: 0.492 Vali Loss: 1.038 Vali Acc: 0.654 Test Loss: 1.038 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1602265
	speed: 0.9266s/iter; left time: 33075.6150s
	iters: 200, epoch: 4 | loss: 0.3797562
	speed: 0.2898s/iter; left time: 10315.5479s
	iters: 300, epoch: 4 | loss: 0.2604681
	speed: 0.2765s/iter; left time: 9814.5334s
Epoch: 4 cost time: 105.31236267089844
Epoch: 4, Steps: 369 | Train Loss: 0.444 Vali Loss: 1.452 Vali Acc: 0.620 Test Loss: 1.452 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6707131
	speed: 0.9086s/iter; left time: 32096.3179s
	iters: 200, epoch: 5 | loss: 0.3077054
	speed: 0.2710s/iter; left time: 9547.5322s
	iters: 300, epoch: 5 | loss: 0.2808290
	speed: 0.2866s/iter; left time: 10066.0953s
Epoch: 5 cost time: 102.76300120353699
Epoch: 5, Steps: 369 | Train Loss: 0.416 Vali Loss: 1.189 Vali Acc: 0.628 Test Loss: 1.189 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1630799
	speed: 0.9641s/iter; left time: 33700.4492s
	iters: 200, epoch: 6 | loss: 0.4140510
	speed: 0.2882s/iter; left time: 10045.2364s
	iters: 300, epoch: 6 | loss: 0.7920395
	speed: 0.2804s/iter; left time: 9743.9902s
Epoch: 6 cost time: 104.73420429229736
Epoch: 6, Steps: 369 | Train Loss: 0.341 Vali Loss: 1.247 Vali Acc: 0.673 Test Loss: 1.247 Test Acc: 0.673
Validation loss decreased (-0.656348 --> -0.673370).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4216631
	speed: 0.9506s/iter; left time: 32877.1141s
	iters: 200, epoch: 7 | loss: 0.0055466
	speed: 0.2826s/iter; left time: 9744.3441s
	iters: 300, epoch: 7 | loss: 0.1715826
	speed: 0.2990s/iter; left time: 10282.8645s
Epoch: 7 cost time: 108.84913182258606
Epoch: 7, Steps: 369 | Train Loss: 0.349 Vali Loss: 1.319 Vali Acc: 0.662 Test Loss: 1.319 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3696441
	speed: 0.9535s/iter; left time: 32625.7281s
	iters: 200, epoch: 8 | loss: 0.8080221
	speed: 0.2890s/iter; left time: 9858.4932s
	iters: 300, epoch: 8 | loss: 0.2103295
	speed: 0.3075s/iter; left time: 10460.7556s
Epoch: 8 cost time: 109.9086275100708
Epoch: 8, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.432 Vali Acc: 0.660 Test Loss: 1.432 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0175453
	speed: 0.9339s/iter; left time: 31610.4935s
	iters: 200, epoch: 9 | loss: 0.4942248
	speed: 0.2749s/iter; left time: 9278.5101s
	iters: 300, epoch: 9 | loss: 0.2396208
	speed: 0.2824s/iter; left time: 9502.9018s
Epoch: 9 cost time: 104.82999801635742
Epoch: 9, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.539 Vali Acc: 0.638 Test Loss: 1.539 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0705389
	speed: 0.9349s/iter; left time: 31301.0500s
	iters: 200, epoch: 10 | loss: 0.2958142
	speed: 0.2736s/iter; left time: 9131.7666s
	iters: 300, epoch: 10 | loss: 0.5797095
	speed: 0.2673s/iter; left time: 8895.4395s
Epoch: 10 cost time: 101.03884696960449
Epoch: 10, Steps: 369 | Train Loss: 0.248 Vali Loss: 1.634 Vali Acc: 0.676 Test Loss: 1.634 Test Acc: 0.676
Validation loss decreased (-0.673370 --> -0.675920).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1970417
	speed: 0.9183s/iter; left time: 30404.5651s
	iters: 200, epoch: 11 | loss: 0.5495415
	speed: 0.2838s/iter; left time: 9370.1543s
	iters: 300, epoch: 11 | loss: 0.4723827
	speed: 0.2914s/iter; left time: 9588.7296s
Epoch: 11 cost time: 105.64421391487122
Epoch: 11, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.764 Vali Acc: 0.665 Test Loss: 1.764 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1239579
	speed: 0.9146s/iter; left time: 29946.2499s
	iters: 200, epoch: 12 | loss: 0.0438901
	speed: 0.2696s/iter; left time: 8799.2028s
	iters: 300, epoch: 12 | loss: 0.2921567
	speed: 0.2706s/iter; left time: 8805.3232s
Epoch: 12 cost time: 99.9953043460846
Epoch: 12, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.958 Vali Acc: 0.665 Test Loss: 1.958 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0295024
	speed: 0.9419s/iter; left time: 30493.2020s
	iters: 200, epoch: 13 | loss: 0.1351887
	speed: 0.2711s/iter; left time: 8750.0699s
	iters: 300, epoch: 13 | loss: 0.0315366
	speed: 0.2729s/iter; left time: 8778.8535s
Epoch: 13 cost time: 101.02676177024841
Epoch: 13, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.907 Vali Acc: 0.663 Test Loss: 1.907 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0168472
	speed: 0.8911s/iter; left time: 28517.7343s
	iters: 200, epoch: 14 | loss: 0.0368362
	speed: 0.2789s/iter; left time: 8897.6454s
	iters: 300, epoch: 14 | loss: 0.6727566
	speed: 0.2872s/iter; left time: 9133.5346s
Epoch: 14 cost time: 104.30639934539795
Epoch: 14, Steps: 369 | Train Loss: 0.192 Vali Loss: 2.213 Vali Acc: 0.632 Test Loss: 2.213 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0196725
	speed: 0.9136s/iter; left time: 28900.9283s
	iters: 200, epoch: 15 | loss: 0.0048604
	speed: 0.2644s/iter; left time: 8338.4850s
	iters: 300, epoch: 15 | loss: 0.2245157
	speed: 0.2717s/iter; left time: 8541.6791s
Epoch: 15 cost time: 101.75895619392395
Epoch: 15, Steps: 369 | Train Loss: 0.170 Vali Loss: 2.255 Vali Acc: 0.659 Test Loss: 2.255 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.7009771
	speed: 0.9298s/iter; left time: 29072.6011s
	iters: 200, epoch: 16 | loss: 0.0155655
	speed: 0.2673s/iter; left time: 8332.2078s
	iters: 300, epoch: 16 | loss: 0.0914052
	speed: 0.2693s/iter; left time: 8365.0174s
Epoch: 16 cost time: 99.9571042060852
Epoch: 16, Steps: 369 | Train Loss: 0.168 Vali Loss: 2.201 Vali Acc: 0.661 Test Loss: 2.201 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0647912
	speed: 0.9213s/iter; left time: 28466.0791s
	iters: 200, epoch: 17 | loss: 0.1013619
	speed: 0.2979s/iter; left time: 9173.5112s
	iters: 300, epoch: 17 | loss: 0.3286138
	speed: 0.2957s/iter; left time: 9077.5468s
Epoch: 17 cost time: 109.58500814437866
Epoch: 17, Steps: 369 | Train Loss: 0.163 Vali Loss: 2.452 Vali Acc: 0.631 Test Loss: 2.452 Test Acc: 0.631
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.4101518
	speed: 0.9573s/iter; left time: 29224.1784s
	iters: 200, epoch: 18 | loss: 0.1975440
	speed: 0.2696s/iter; left time: 8203.2828s
	iters: 300, epoch: 18 | loss: 0.3968017
	speed: 0.2681s/iter; left time: 8132.3672s
Epoch: 18 cost time: 102.20317602157593
Epoch: 18, Steps: 369 | Train Loss: 0.161 Vali Loss: 2.263 Vali Acc: 0.655 Test Loss: 2.263 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1828513
	speed: 0.9321s/iter; left time: 28110.2738s
	iters: 200, epoch: 19 | loss: 0.0596112
	speed: 0.2922s/iter; left time: 8781.9621s
	iters: 300, epoch: 19 | loss: 0.1887156
	speed: 0.2895s/iter; left time: 8673.9742s
Epoch: 19 cost time: 107.15476989746094
Epoch: 19, Steps: 369 | Train Loss: 0.128 Vali Loss: 2.531 Vali Acc: 0.658 Test Loss: 2.531 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.3049621
	speed: 0.8921s/iter; left time: 26575.6434s
	iters: 200, epoch: 20 | loss: 0.0044204
	speed: 0.2743s/iter; left time: 8144.3052s
	iters: 300, epoch: 20 | loss: 0.2929854
	speed: 0.2805s/iter; left time: 8298.7718s
Epoch: 20 cost time: 103.0869152545929
Epoch: 20, Steps: 369 | Train Loss: 0.165 Vali Loss: 2.690 Vali Acc: 0.660 Test Loss: 2.690 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6759364358683314
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7415450
	speed: 0.2827s/iter; left time: 10402.5270s
	iters: 200, epoch: 1 | loss: 0.5547447
	speed: 0.2740s/iter; left time: 10055.6111s
	iters: 300, epoch: 1 | loss: 0.5412803
	speed: 0.2735s/iter; left time: 10009.1592s
Epoch: 1 cost time: 103.13729238510132
Epoch: 1, Steps: 369 | Train Loss: 0.694 Vali Loss: 0.758 Vali Acc: 0.637 Test Loss: 0.758 Test Acc: 0.637
Validation loss decreased (inf --> -0.637336).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3395623
	speed: 0.9664s/iter; left time: 35208.1938s
	iters: 200, epoch: 2 | loss: 0.3269156
	speed: 0.2880s/iter; left time: 10462.3688s
	iters: 300, epoch: 2 | loss: 0.3241006
	speed: 0.2730s/iter; left time: 9892.9427s
Epoch: 2 cost time: 104.72036623954773
Epoch: 2, Steps: 369 | Train Loss: 0.569 Vali Loss: 0.853 Vali Acc: 0.664 Test Loss: 0.853 Test Acc: 0.664
Validation loss decreased (-0.637336 --> -0.664010).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1600234
	speed: 0.9148s/iter; left time: 32990.7002s
	iters: 200, epoch: 3 | loss: 0.4173349
	speed: 0.2956s/iter; left time: 10629.1276s
	iters: 300, epoch: 3 | loss: 0.4484168
	speed: 0.2982s/iter; left time: 10694.0753s
Epoch: 3 cost time: 108.53596830368042
Epoch: 3, Steps: 369 | Train Loss: 0.494 Vali Loss: 1.058 Vali Acc: 0.655 Test Loss: 1.058 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2536249
	speed: 0.9477s/iter; left time: 33827.4174s
	iters: 200, epoch: 4 | loss: 0.2256650
	speed: 0.2700s/iter; left time: 9610.4961s
	iters: 300, epoch: 4 | loss: 0.3609469
	speed: 0.2784s/iter; left time: 9881.3486s
Epoch: 4 cost time: 104.24116611480713
Epoch: 4, Steps: 369 | Train Loss: 0.452 Vali Loss: 1.140 Vali Acc: 0.641 Test Loss: 1.140 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6957784
	speed: 0.9677s/iter; left time: 34185.3781s
	iters: 200, epoch: 5 | loss: 0.4168200
	speed: 0.2861s/iter; left time: 10079.2583s
	iters: 300, epoch: 5 | loss: 0.3117687
	speed: 0.2676s/iter; left time: 9398.1364s
Epoch: 5 cost time: 104.41098475456238
Epoch: 5, Steps: 369 | Train Loss: 0.429 Vali Loss: 1.194 Vali Acc: 0.645 Test Loss: 1.194 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2359470
	speed: 0.9170s/iter; left time: 32055.7461s
	iters: 200, epoch: 6 | loss: 0.7038983
	speed: 0.2942s/iter; left time: 10255.8303s
	iters: 300, epoch: 6 | loss: 0.6475513
	speed: 0.2842s/iter; left time: 9879.1654s
Epoch: 6 cost time: 107.21949338912964
Epoch: 6, Steps: 369 | Train Loss: 0.367 Vali Loss: 1.326 Vali Acc: 0.663 Test Loss: 1.326 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1194333
	speed: 0.9033s/iter; left time: 31243.1351s
	iters: 200, epoch: 7 | loss: 0.0060192
	speed: 0.2745s/iter; left time: 9467.5613s
	iters: 300, epoch: 7 | loss: 0.4618911
	speed: 0.2802s/iter; left time: 9634.2485s
Epoch: 7 cost time: 103.52768015861511
Epoch: 7, Steps: 369 | Train Loss: 0.328 Vali Loss: 1.385 Vali Acc: 0.651 Test Loss: 1.385 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0952363
	speed: 0.9250s/iter; left time: 31651.0264s
	iters: 200, epoch: 8 | loss: 0.9586409
	speed: 0.2757s/iter; left time: 9407.3240s
	iters: 300, epoch: 8 | loss: 0.2467164
	speed: 0.2614s/iter; left time: 8891.2736s
Epoch: 8 cost time: 101.05575299263
Epoch: 8, Steps: 369 | Train Loss: 0.307 Vali Loss: 1.649 Vali Acc: 0.654 Test Loss: 1.649 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7175968
	speed: 0.9099s/iter; left time: 30797.7818s
	iters: 200, epoch: 9 | loss: 0.3255319
	speed: 0.2879s/iter; left time: 9715.5625s
	iters: 300, epoch: 9 | loss: 0.8605387
	speed: 0.2761s/iter; left time: 9291.3851s
Epoch: 9 cost time: 104.51768183708191
Epoch: 9, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.699 Vali Acc: 0.620 Test Loss: 1.699 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1633588
	speed: 0.8848s/iter; left time: 29622.9302s
	iters: 200, epoch: 10 | loss: 0.5037531
	speed: 0.2773s/iter; left time: 9256.7659s
	iters: 300, epoch: 10 | loss: 0.4955455
	speed: 0.2843s/iter; left time: 9461.7883s
Epoch: 10 cost time: 102.69676232337952
Epoch: 10, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.622 Vali Acc: 0.656 Test Loss: 1.622 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.5204585
	speed: 0.9152s/iter; left time: 30303.5007s
	iters: 200, epoch: 11 | loss: 0.4751287
	speed: 0.2797s/iter; left time: 9234.5344s
	iters: 300, epoch: 11 | loss: 0.0724145
	speed: 0.2782s/iter; left time: 9156.9914s
Epoch: 11 cost time: 102.7561137676239
Epoch: 11, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.691 Vali Acc: 0.668 Test Loss: 1.691 Test Acc: 0.668
Validation loss decreased (-0.664010 --> -0.667690).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0868440
	speed: 0.9110s/iter; left time: 29829.2422s
	iters: 200, epoch: 12 | loss: 0.3077122
	speed: 0.2818s/iter; left time: 9197.7765s
	iters: 300, epoch: 12 | loss: 0.1792156
	speed: 0.2845s/iter; left time: 9256.8873s
Epoch: 12 cost time: 105.47430515289307
Epoch: 12, Steps: 369 | Train Loss: 0.199 Vali Loss: 2.089 Vali Acc: 0.646 Test Loss: 2.089 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4851281
	speed: 0.9053s/iter; left time: 29307.3410s
	iters: 200, epoch: 13 | loss: 0.0290384
	speed: 0.2897s/iter; left time: 9350.5725s
	iters: 300, epoch: 13 | loss: 0.2077170
	speed: 0.2824s/iter; left time: 9087.0817s
Epoch: 13 cost time: 104.33595728874207
Epoch: 13, Steps: 369 | Train Loss: 0.214 Vali Loss: 1.977 Vali Acc: 0.645 Test Loss: 1.977 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0525758
	speed: 0.8861s/iter; left time: 28359.5168s
	iters: 200, epoch: 14 | loss: 0.0280427
	speed: 0.2742s/iter; left time: 8747.0690s
	iters: 300, epoch: 14 | loss: 0.2098220
	speed: 0.2809s/iter; left time: 8933.7455s
Epoch: 14 cost time: 102.70355749130249
Epoch: 14, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.897 Vali Acc: 0.642 Test Loss: 1.897 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0078496
	speed: 0.9033s/iter; left time: 28574.6212s
	iters: 200, epoch: 15 | loss: 0.1220556
	speed: 0.2765s/iter; left time: 8717.8919s
	iters: 300, epoch: 15 | loss: 0.0016523
	speed: 0.2778s/iter; left time: 8732.5220s
Epoch: 15 cost time: 104.13129496574402
Epoch: 15, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.967 Vali Acc: 0.644 Test Loss: 1.967 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.4416302
	speed: 0.9277s/iter; left time: 29006.4391s
	iters: 200, epoch: 16 | loss: 0.0066251
	speed: 0.2844s/iter; left time: 8863.0511s
	iters: 300, epoch: 16 | loss: 0.1222006
	speed: 0.2808s/iter; left time: 8722.1701s
Epoch: 16 cost time: 104.93565559387207
Epoch: 16, Steps: 369 | Train Loss: 0.168 Vali Loss: 2.111 Vali Acc: 0.644 Test Loss: 2.111 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1535699
	speed: 0.9303s/iter; left time: 28743.0727s
	iters: 200, epoch: 17 | loss: 0.3152510
	speed: 0.2751s/iter; left time: 8472.4025s
	iters: 300, epoch: 17 | loss: 0.0026410
	speed: 0.2783s/iter; left time: 8542.5868s
Epoch: 17 cost time: 104.0798397064209
Epoch: 17, Steps: 369 | Train Loss: 0.152 Vali Loss: 2.042 Vali Acc: 0.633 Test Loss: 2.042 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.4773871
	speed: 0.9345s/iter; left time: 28529.3869s
	iters: 200, epoch: 18 | loss: 0.5382344
	speed: 0.2774s/iter; left time: 8439.9463s
	iters: 300, epoch: 18 | loss: 0.3914100
	speed: 0.2840s/iter; left time: 8614.6657s
Epoch: 18 cost time: 104.91235756874084
Epoch: 18, Steps: 369 | Train Loss: 0.150 Vali Loss: 2.140 Vali Acc: 0.652 Test Loss: 2.140 Test Acc: 0.652
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2900158
	speed: 0.9260s/iter; left time: 27927.6790s
	iters: 200, epoch: 19 | loss: 0.0125093
	speed: 0.2862s/iter; left time: 8601.7209s
	iters: 300, epoch: 19 | loss: 0.1944716
	speed: 0.2904s/iter; left time: 8700.9419s
Epoch: 19 cost time: 106.84943866729736
Epoch: 19, Steps: 369 | Train Loss: 0.134 Vali Loss: 2.315 Vali Acc: 0.638 Test Loss: 2.315 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.4304826
	speed: 0.9206s/iter; left time: 27424.8021s
	iters: 200, epoch: 20 | loss: 0.0869984
	speed: 0.2729s/iter; left time: 8101.8916s
	iters: 300, epoch: 20 | loss: 0.0177165
	speed: 0.2796s/iter; left time: 8273.4252s
Epoch: 20 cost time: 102.74851179122925
Epoch: 20, Steps: 369 | Train Loss: 0.117 Vali Loss: 2.688 Vali Acc: 0.650 Test Loss: 2.688 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0287123
	speed: 0.9392s/iter; left time: 27632.8457s
	iters: 200, epoch: 21 | loss: 0.1671131
	speed: 0.2800s/iter; left time: 8210.7912s
	iters: 300, epoch: 21 | loss: 0.2998723
	speed: 0.2770s/iter; left time: 8093.5600s
Epoch: 21 cost time: 104.19403409957886
Epoch: 21, Steps: 369 | Train Loss: 0.134 Vali Loss: 2.515 Vali Acc: 0.655 Test Loss: 2.515 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6677071509648127
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6910753
	speed: 0.2955s/iter; left time: 10873.5811s
	iters: 200, epoch: 1 | loss: 0.6931502
	speed: 0.2666s/iter; left time: 9784.7402s
	iters: 300, epoch: 1 | loss: 0.6946087
	speed: 0.2582s/iter; left time: 9449.4327s
Epoch: 1 cost time: 100.26555347442627
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6922693
	speed: 0.8908s/iter; left time: 32454.5034s
	iters: 200, epoch: 2 | loss: 0.6909966
	speed: 0.2818s/iter; left time: 10236.7036s
	iters: 300, epoch: 2 | loss: 0.6931484
	speed: 0.2855s/iter; left time: 10343.1238s
Epoch: 2 cost time: 104.29667115211487
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6949289
	speed: 0.8811s/iter; left time: 31774.2687s
	iters: 200, epoch: 3 | loss: 0.6934838
	speed: 0.2672s/iter; left time: 9609.2346s
	iters: 300, epoch: 3 | loss: 0.6927704
	speed: 0.2908s/iter; left time: 10427.6923s
Epoch: 3 cost time: 103.05356478691101
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6931981
	speed: 0.9280s/iter; left time: 33123.5758s
	iters: 200, epoch: 4 | loss: 0.6970234
	speed: 0.2716s/iter; left time: 9666.0168s
	iters: 300, epoch: 4 | loss: 0.6953833
	speed: 0.2697s/iter; left time: 9572.9550s
Epoch: 4 cost time: 100.82764673233032
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6926696
	speed: 0.9474s/iter; left time: 33465.8253s
	iters: 200, epoch: 5 | loss: 0.6932527
	speed: 0.2865s/iter; left time: 10090.3794s
	iters: 300, epoch: 5 | loss: 0.6922424
	speed: 0.2788s/iter; left time: 9793.4489s
Epoch: 5 cost time: 105.3239312171936
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6931516
	speed: 0.8683s/iter; left time: 30351.9248s
	iters: 200, epoch: 6 | loss: 0.6939760
	speed: 0.2748s/iter; left time: 9578.4820s
	iters: 300, epoch: 6 | loss: 0.6929005
	speed: 0.2684s/iter; left time: 9327.6930s
Epoch: 6 cost time: 101.07577252388
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6931600
	speed: 0.8377s/iter; left time: 28972.0809s
	iters: 200, epoch: 7 | loss: 0.6938665
	speed: 0.2572s/iter; left time: 8870.6785s
	iters: 300, epoch: 7 | loss: 0.6931783
	speed: 0.2685s/iter; left time: 9234.1480s
Epoch: 7 cost time: 96.7491443157196
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6913065
	speed: 0.8958s/iter; left time: 30653.9311s
	iters: 200, epoch: 8 | loss: 0.6931647
	speed: 0.2628s/iter; left time: 8967.0470s
	iters: 300, epoch: 8 | loss: 0.6932135
	speed: 0.2647s/iter; left time: 9005.0887s
Epoch: 8 cost time: 97.84451651573181
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6931511
	speed: 0.8933s/iter; left time: 30236.3314s
	iters: 200, epoch: 9 | loss: 0.6941433
	speed: 0.2759s/iter; left time: 9312.2815s
	iters: 300, epoch: 9 | loss: 0.6924500
	speed: 0.2729s/iter; left time: 9181.2028s
Epoch: 9 cost time: 101.76983428001404
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6929834
	speed: 0.8546s/iter; left time: 28611.0304s
	iters: 200, epoch: 10 | loss: 0.6914135
	speed: 0.2580s/iter; left time: 8612.8501s
	iters: 300, epoch: 10 | loss: 0.6926225
	speed: 0.2552s/iter; left time: 8492.1714s
Epoch: 10 cost time: 95.09689569473267
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6925299
	speed: 0.8438s/iter; left time: 27937.7496s
	iters: 200, epoch: 11 | loss: 0.6925125
	speed: 0.2627s/iter; left time: 8671.9603s
	iters: 300, epoch: 11 | loss: 0.6942044
	speed: 0.2544s/iter; left time: 8373.2047s
Epoch: 11 cost time: 95.77963352203369
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6931784
	speed: 0.8495s/iter; left time: 27813.4014s
	iters: 200, epoch: 12 | loss: 0.6956162
	speed: 0.2658s/iter; left time: 8677.3803s
	iters: 300, epoch: 12 | loss: 0.6899263
	speed: 0.2603s/iter; left time: 8471.4615s
Epoch: 12 cost time: 98.0724835395813
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6962846
	speed: 0.8614s/iter; left time: 27886.2512s
	iters: 200, epoch: 13 | loss: 0.6926346
	speed: 0.2579s/iter; left time: 8324.3572s
	iters: 300, epoch: 13 | loss: 0.6931659
	speed: 0.2718s/iter; left time: 8744.1115s
Epoch: 13 cost time: 97.95509219169617
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6931643
	speed: 0.8688s/iter; left time: 27803.6684s
	iters: 200, epoch: 14 | loss: 0.6947568
	speed: 0.2646s/iter; left time: 8440.2042s
	iters: 300, epoch: 14 | loss: 0.6921676
	speed: 0.2581s/iter; left time: 8207.9938s
Epoch: 14 cost time: 96.9978597164154
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6931774
	speed: 0.8353s/iter; left time: 26425.6881s
	iters: 200, epoch: 15 | loss: 0.6899989
	speed: 0.2700s/iter; left time: 8514.1166s
	iters: 300, epoch: 15 | loss: 0.6918771
	speed: 0.2588s/iter; left time: 8134.2688s
Epoch: 15 cost time: 97.00092005729675
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6971747
	speed: 0.8670s/iter; left time: 27109.0459s
	iters: 200, epoch: 16 | loss: 0.6932436
	speed: 0.2584s/iter; left time: 8053.7682s
	iters: 300, epoch: 16 | loss: 0.6927288
	speed: 0.2538s/iter; left time: 7885.7631s
Epoch: 16 cost time: 97.0750572681427
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6929337
	speed: 0.8633s/iter; left time: 26674.0412s
	iters: 200, epoch: 17 | loss: 0.6953342
	speed: 0.2586s/iter; left time: 7963.9307s
	iters: 300, epoch: 17 | loss: 0.6926973
	speed: 0.2651s/iter; left time: 8139.2284s
Epoch: 17 cost time: 98.37894034385681
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6948024
	speed: 0.8661s/iter; left time: 26441.2292s
	iters: 200, epoch: 18 | loss: 0.6931939
	speed: 0.2634s/iter; left time: 8015.2873s
	iters: 300, epoch: 18 | loss: 0.6885380
	speed: 0.2698s/iter; left time: 8183.0927s
Epoch: 18 cost time: 99.8469409942627
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6928006
	speed: 0.8995s/iter; left time: 27129.1391s
	iters: 200, epoch: 19 | loss: 0.6948899
	speed: 0.2753s/iter; left time: 8276.1407s
	iters: 300, epoch: 19 | loss: 0.6946133
	speed: 0.2640s/iter; left time: 7909.0596s
Epoch: 19 cost time: 102.55489683151245
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6928138
	speed: 0.9086s/iter; left time: 27068.2729s
	iters: 200, epoch: 20 | loss: 0.6921618
	speed: 0.2644s/iter; left time: 7848.8947s
	iters: 300, epoch: 20 | loss: 0.6954450
	speed: 0.2694s/iter; left time: 7972.5889s
Epoch: 20 cost time: 99.15161681175232
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6915767
	speed: 0.8874s/iter; left time: 26108.2575s
	iters: 200, epoch: 21 | loss: 0.6917141
	speed: 0.2632s/iter; left time: 7715.9611s
	iters: 300, epoch: 21 | loss: 0.6917295
	speed: 0.2763s/iter; left time: 8074.4275s
Epoch: 21 cost time: 98.80830097198486
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6935526
	speed: 0.8909s/iter; left time: 25881.4632s
	iters: 200, epoch: 22 | loss: 0.6928964
	speed: 0.2717s/iter; left time: 7865.3356s
	iters: 300, epoch: 22 | loss: 0.6923453
	speed: 0.2553s/iter; left time: 7365.3277s
Epoch: 22 cost time: 98.63565802574158
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.6932295
	speed: 0.8607s/iter; left time: 24688.6210s
	iters: 200, epoch: 23 | loss: 0.6928030
	speed: 0.2704s/iter; left time: 7729.7288s
	iters: 300, epoch: 23 | loss: 0.6939371
	speed: 0.2823s/iter; left time: 8040.7523s
Epoch: 23 cost time: 102.14864468574524
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 982658
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8601083
	speed: 0.2973s/iter; left time: 10941.6284s
	iters: 200, epoch: 1 | loss: 0.5002742
	speed: 0.2830s/iter; left time: 10387.4520s
	iters: 300, epoch: 1 | loss: 0.7045932
	speed: 0.2697s/iter; left time: 9870.2486s
Epoch: 1 cost time: 104.72965693473816
Epoch: 1, Steps: 369 | Train Loss: 0.649 Vali Loss: 0.727 Vali Acc: 0.662 Test Loss: 0.727 Test Acc: 0.662
Validation loss decreased (inf --> -0.662308).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3119255
	speed: 0.9209s/iter; left time: 33551.0855s
	iters: 200, epoch: 2 | loss: 0.3556049
	speed: 0.2699s/iter; left time: 9807.4087s
	iters: 300, epoch: 2 | loss: 0.4773923
	speed: 0.2728s/iter; left time: 9883.1336s
Epoch: 2 cost time: 100.93486022949219
Epoch: 2, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.934 Vali Acc: 0.642 Test Loss: 0.934 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2242156
	speed: 0.8930s/iter; left time: 32205.0338s
	iters: 200, epoch: 3 | loss: 0.5669929
	speed: 0.2734s/iter; left time: 9832.1237s
	iters: 300, epoch: 3 | loss: 0.4249739
	speed: 0.2730s/iter; left time: 9792.1333s
Epoch: 3 cost time: 100.23544645309448
Epoch: 3, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.994 Vali Acc: 0.627 Test Loss: 0.994 Test Acc: 0.627
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0254782
	speed: 0.9067s/iter; left time: 32365.0916s
	iters: 200, epoch: 4 | loss: 0.5871304
	speed: 0.2747s/iter; left time: 9776.4493s
	iters: 300, epoch: 4 | loss: 0.2442527
	speed: 0.2640s/iter; left time: 9372.0741s
Epoch: 4 cost time: 100.01642727851868
Epoch: 4, Steps: 369 | Train Loss: 0.338 Vali Loss: 1.120 Vali Acc: 0.654 Test Loss: 1.120 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1621666
	speed: 0.8708s/iter; left time: 30759.4708s
	iters: 200, epoch: 5 | loss: 0.5671936
	speed: 0.2582s/iter; left time: 9093.9322s
	iters: 300, epoch: 5 | loss: 0.3123083
	speed: 0.2567s/iter; left time: 9016.8238s
Epoch: 5 cost time: 94.91528630256653
Epoch: 5, Steps: 369 | Train Loss: 0.297 Vali Loss: 1.262 Vali Acc: 0.670 Test Loss: 1.262 Test Acc: 0.670
Validation loss decreased (-0.662308 --> -0.669681).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2511042
	speed: 0.8458s/iter; left time: 29564.8018s
	iters: 200, epoch: 6 | loss: 0.4339549
	speed: 0.2555s/iter; left time: 8905.1646s
	iters: 300, epoch: 6 | loss: 0.0988337
	speed: 0.2658s/iter; left time: 9236.7315s
Epoch: 6 cost time: 96.96417760848999
Epoch: 6, Steps: 369 | Train Loss: 0.269 Vali Loss: 1.458 Vali Acc: 0.646 Test Loss: 1.458 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3219959
	speed: 0.9023s/iter; left time: 31208.2316s
	iters: 200, epoch: 7 | loss: 0.0729628
	speed: 0.2694s/iter; left time: 9290.1868s
	iters: 300, epoch: 7 | loss: 0.0947753
	speed: 0.2652s/iter; left time: 9120.7649s
Epoch: 7 cost time: 100.65789246559143
Epoch: 7, Steps: 369 | Train Loss: 0.247 Vali Loss: 1.549 Vali Acc: 0.671 Test Loss: 1.549 Test Acc: 0.671
Validation loss decreased (-0.669681 --> -0.670529).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1623340
	speed: 0.9076s/iter; left time: 31057.9231s
	iters: 200, epoch: 8 | loss: 0.1136269
	speed: 0.2644s/iter; left time: 9021.7698s
	iters: 300, epoch: 8 | loss: 0.4740176
	speed: 0.2690s/iter; left time: 9150.7801s
Epoch: 8 cost time: 98.93760347366333
Epoch: 8, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.846 Vali Acc: 0.642 Test Loss: 1.846 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1024103
	speed: 0.8578s/iter; left time: 29036.3193s
	iters: 200, epoch: 9 | loss: 0.0027408
	speed: 0.2460s/iter; left time: 8302.7380s
	iters: 300, epoch: 9 | loss: 0.0961684
	speed: 0.2472s/iter; left time: 8318.4614s
Epoch: 9 cost time: 92.61233282089233
Epoch: 9, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.843 Vali Acc: 0.672 Test Loss: 1.843 Test Acc: 0.672
Validation loss decreased (-0.670529 --> -0.671661).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0263192
	speed: 0.8490s/iter; left time: 28423.0095s
	iters: 200, epoch: 10 | loss: 0.0168584
	speed: 0.2524s/iter; left time: 8426.0044s
	iters: 300, epoch: 10 | loss: 0.0183128
	speed: 0.2559s/iter; left time: 8517.6787s
Epoch: 10 cost time: 95.5622911453247
Epoch: 10, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.940 Vali Acc: 0.665 Test Loss: 1.940 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0922297
	speed: 0.8640s/iter; left time: 28609.0684s
	iters: 200, epoch: 11 | loss: 0.4406007
	speed: 0.2642s/iter; left time: 8720.7153s
	iters: 300, epoch: 11 | loss: 0.0349032
	speed: 0.2646s/iter; left time: 8709.4795s
Epoch: 11 cost time: 98.37208080291748
Epoch: 11, Steps: 369 | Train Loss: 0.193 Vali Loss: 2.020 Vali Acc: 0.658 Test Loss: 2.020 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7511446
	speed: 0.8760s/iter; left time: 28681.9041s
	iters: 200, epoch: 12 | loss: 0.0743717
	speed: 0.2577s/iter; left time: 8410.9016s
	iters: 300, epoch: 12 | loss: 0.0156547
	speed: 0.2697s/iter; left time: 8775.3909s
Epoch: 12 cost time: 97.53260207176208
Epoch: 12, Steps: 369 | Train Loss: 0.176 Vali Loss: 2.325 Vali Acc: 0.656 Test Loss: 2.325 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2979410
	speed: 0.8707s/iter; left time: 28186.6758s
	iters: 200, epoch: 13 | loss: 0.1254487
	speed: 0.2731s/iter; left time: 8813.0998s
	iters: 300, epoch: 13 | loss: 0.0215886
	speed: 0.2727s/iter; left time: 8775.1638s
Epoch: 13 cost time: 100.4980959892273
Epoch: 13, Steps: 369 | Train Loss: 0.166 Vali Loss: 2.378 Vali Acc: 0.646 Test Loss: 2.378 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0069861
	speed: 0.8761s/iter; left time: 28038.7616s
	iters: 200, epoch: 14 | loss: 0.0012906
	speed: 0.2619s/iter; left time: 8354.4846s
	iters: 300, epoch: 14 | loss: 0.2224416
	speed: 0.2603s/iter; left time: 8278.1763s
Epoch: 14 cost time: 97.43190670013428
Epoch: 14, Steps: 369 | Train Loss: 0.200 Vali Loss: 2.254 Vali Acc: 0.669 Test Loss: 2.254 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4270798
	speed: 0.8840s/iter; left time: 27964.8529s
	iters: 200, epoch: 15 | loss: 0.0430906
	speed: 0.2650s/iter; left time: 8358.0999s
	iters: 300, epoch: 15 | loss: 0.0043995
	speed: 0.2628s/iter; left time: 8261.9209s
Epoch: 15 cost time: 98.63624691963196
Epoch: 15, Steps: 369 | Train Loss: 0.155 Vali Loss: 2.321 Vali Acc: 0.656 Test Loss: 2.321 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4943976
	speed: 0.8692s/iter; left time: 27176.5033s
	iters: 200, epoch: 16 | loss: 0.0439775
	speed: 0.2639s/iter; left time: 8224.6489s
	iters: 300, epoch: 16 | loss: 0.0092699
	speed: 0.2654s/iter; left time: 8244.4998s
Epoch: 16 cost time: 96.87949848175049
Epoch: 16, Steps: 369 | Train Loss: 0.155 Vali Loss: 2.534 Vali Acc: 0.632 Test Loss: 2.534 Test Acc: 0.632
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0005527
	speed: 0.8595s/iter; left time: 26555.1664s
	iters: 200, epoch: 17 | loss: 0.0301588
	speed: 0.2582s/iter; left time: 7952.0480s
	iters: 300, epoch: 17 | loss: 0.0016047
	speed: 0.2453s/iter; left time: 7530.5108s
Epoch: 17 cost time: 93.91850471496582
Epoch: 17, Steps: 369 | Train Loss: 0.151 Vali Loss: 2.312 Vali Acc: 0.655 Test Loss: 2.312 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0589235
	speed: 0.8512s/iter; left time: 25985.0320s
	iters: 200, epoch: 18 | loss: 0.3036256
	speed: 0.2546s/iter; left time: 7747.6769s
	iters: 300, epoch: 18 | loss: 0.1100850
	speed: 0.2552s/iter; left time: 7738.5909s
Epoch: 18 cost time: 95.32557773590088
Epoch: 18, Steps: 369 | Train Loss: 0.165 Vali Loss: 2.530 Vali Acc: 0.670 Test Loss: 2.530 Test Acc: 0.670
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.4010547
	speed: 0.8336s/iter; left time: 25141.2250s
	iters: 200, epoch: 19 | loss: 0.0138110
	speed: 0.2507s/iter; left time: 7536.5813s
	iters: 300, epoch: 19 | loss: 0.0025551
	speed: 0.2580s/iter; left time: 7729.4398s
Epoch: 19 cost time: 94.06992959976196
Epoch: 19, Steps: 369 | Train Loss: 0.139 Vali Loss: 2.692 Vali Acc: 0.652 Test Loss: 2.692 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8295655
	speed: 0.2876s/iter; left time: 10584.4321s
	iters: 200, epoch: 1 | loss: 0.5678070
	speed: 0.2558s/iter; left time: 9389.5829s
	iters: 300, epoch: 1 | loss: 0.6306697
	speed: 0.2657s/iter; left time: 9723.2096s
Epoch: 1 cost time: 99.61010336875916
Epoch: 1, Steps: 369 | Train Loss: 0.657 Vali Loss: 0.792 Vali Acc: 0.638 Test Loss: 0.792 Test Acc: 0.638
Validation loss decreased (inf --> -0.638471).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3581507
	speed: 0.8777s/iter; left time: 31977.3669s
	iters: 200, epoch: 2 | loss: 0.3895968
	speed: 0.2588s/iter; left time: 9403.6670s
	iters: 300, epoch: 2 | loss: 0.5053949
	speed: 0.2596s/iter; left time: 9406.7355s
Epoch: 2 cost time: 96.27030539512634
Epoch: 2, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.816 Vali Acc: 0.661 Test Loss: 0.816 Test Acc: 0.661
Validation loss decreased (-0.638471 --> -0.660889).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1501139
	speed: 0.8505s/iter; left time: 30672.4125s
	iters: 200, epoch: 3 | loss: 0.4637080
	speed: 0.2563s/iter; left time: 9218.2039s
	iters: 300, epoch: 3 | loss: 0.2516010
	speed: 0.2545s/iter; left time: 9126.1194s
Epoch: 3 cost time: 94.76773571968079
Epoch: 3, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.992 Vali Acc: 0.638 Test Loss: 0.992 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0796347
	speed: 0.8305s/iter; left time: 29643.3514s
	iters: 200, epoch: 4 | loss: 0.3960150
	speed: 0.2469s/iter; left time: 8786.8235s
	iters: 300, epoch: 4 | loss: 0.3910821
	speed: 0.2547s/iter; left time: 9041.7663s
Epoch: 4 cost time: 94.19798278808594
Epoch: 4, Steps: 369 | Train Loss: 0.339 Vali Loss: 1.133 Vali Acc: 0.646 Test Loss: 1.133 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3434571
	speed: 0.8574s/iter; left time: 30287.1452s
	iters: 200, epoch: 5 | loss: 0.4340602
	speed: 0.2642s/iter; left time: 9306.3332s
	iters: 300, epoch: 5 | loss: 0.0934049
	speed: 0.2589s/iter; left time: 9095.1900s
Epoch: 5 cost time: 96.48474502563477
Epoch: 5, Steps: 369 | Train Loss: 0.301 Vali Loss: 1.400 Vali Acc: 0.649 Test Loss: 1.400 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3878382
	speed: 0.8412s/iter; left time: 29404.3531s
	iters: 200, epoch: 6 | loss: 0.5989826
	speed: 0.2636s/iter; left time: 9189.5499s
	iters: 300, epoch: 6 | loss: 0.2325578
	speed: 0.2575s/iter; left time: 8950.5074s
Epoch: 6 cost time: 96.96143341064453
Epoch: 6, Steps: 369 | Train Loss: 0.278 Vali Loss: 1.556 Vali Acc: 0.636 Test Loss: 1.556 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.4787207
	speed: 0.8685s/iter; left time: 30040.3767s
	iters: 200, epoch: 7 | loss: 0.0089330
	speed: 0.2587s/iter; left time: 8920.2572s
	iters: 300, epoch: 7 | loss: 0.2664087
	speed: 0.2565s/iter; left time: 8819.6132s
Epoch: 7 cost time: 95.55687212944031
Epoch: 7, Steps: 369 | Train Loss: 0.251 Vali Loss: 1.526 Vali Acc: 0.655 Test Loss: 1.526 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0230237
	speed: 0.8653s/iter; left time: 29607.5541s
	iters: 200, epoch: 8 | loss: 0.3135460
	speed: 0.2557s/iter; left time: 8723.1959s
	iters: 300, epoch: 8 | loss: 0.3150709
	speed: 0.2619s/iter; left time: 8909.9935s
Epoch: 8 cost time: 96.17708134651184
Epoch: 8, Steps: 369 | Train Loss: 0.236 Vali Loss: 1.791 Vali Acc: 0.649 Test Loss: 1.791 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1035137
	speed: 0.8502s/iter; left time: 28779.3723s
	iters: 200, epoch: 9 | loss: 0.3053570
	speed: 0.2597s/iter; left time: 8766.1793s
	iters: 300, epoch: 9 | loss: 0.5425524
	speed: 0.2548s/iter; left time: 8572.3684s
Epoch: 9 cost time: 95.47873663902283
Epoch: 9, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.845 Vali Acc: 0.651 Test Loss: 1.845 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1158889
	speed: 0.8549s/iter; left time: 28621.7429s
	iters: 200, epoch: 10 | loss: 0.0164937
	speed: 0.2620s/iter; left time: 8746.4268s
	iters: 300, epoch: 10 | loss: 0.0217856
	speed: 0.2620s/iter; left time: 8718.6133s
Epoch: 10 cost time: 97.55180764198303
Epoch: 10, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.916 Vali Acc: 0.645 Test Loss: 1.916 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0035629
	speed: 0.8673s/iter; left time: 28718.0309s
	iters: 200, epoch: 11 | loss: 0.1643506
	speed: 0.2659s/iter; left time: 8778.4305s
	iters: 300, epoch: 11 | loss: 0.1351889
	speed: 0.2653s/iter; left time: 8730.7104s
Epoch: 11 cost time: 99.57677054405212
Epoch: 11, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.979 Vali Acc: 0.646 Test Loss: 1.979 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0646441
	speed: 0.8744s/iter; left time: 28630.7084s
	iters: 200, epoch: 12 | loss: 0.0979344
	speed: 0.2705s/iter; left time: 8830.5010s
	iters: 300, epoch: 12 | loss: 0.0263505
	speed: 0.2679s/iter; left time: 8717.8309s
Epoch: 12 cost time: 100.33062148094177
Epoch: 12, Steps: 369 | Train Loss: 0.185 Vali Loss: 2.183 Vali Acc: 0.648 Test Loss: 2.183 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6608967082860386
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8468736
	speed: 0.2981s/iter; left time: 10969.5727s
	iters: 200, epoch: 1 | loss: 0.5948727
	speed: 0.2718s/iter; left time: 9974.7373s
	iters: 300, epoch: 1 | loss: 0.7431177
	speed: 0.2902s/iter; left time: 10621.5839s
Epoch: 1 cost time: 105.33950114250183
Epoch: 1, Steps: 369 | Train Loss: 0.664 Vali Loss: 0.779 Vali Acc: 0.636 Test Loss: 0.779 Test Acc: 0.636
Validation loss decreased (inf --> -0.635917).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3852662
	speed: 0.8928s/iter; left time: 32527.8253s
	iters: 200, epoch: 2 | loss: 0.5278447
	speed: 0.2699s/iter; left time: 9807.5607s
	iters: 300, epoch: 2 | loss: 0.7632515
	speed: 0.2740s/iter; left time: 9928.2291s
Epoch: 2 cost time: 101.59326004981995
Epoch: 2, Steps: 369 | Train Loss: 0.538 Vali Loss: 0.813 Vali Acc: 0.659 Test Loss: 0.813 Test Acc: 0.659
Validation loss decreased (-0.635917 --> -0.659186).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2701219
	speed: 0.9101s/iter; left time: 32821.6264s
	iters: 200, epoch: 3 | loss: 0.3719134
	speed: 0.2944s/iter; left time: 10587.3188s
	iters: 300, epoch: 3 | loss: 0.4343528
	speed: 0.2827s/iter; left time: 10137.1644s
Epoch: 3 cost time: 105.38561415672302
Epoch: 3, Steps: 369 | Train Loss: 0.426 Vali Loss: 1.022 Vali Acc: 0.621 Test Loss: 1.022 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1608070
	speed: 0.9063s/iter; left time: 32348.6552s
	iters: 200, epoch: 4 | loss: 0.4404328
	speed: 0.2799s/iter; left time: 9961.5238s
	iters: 300, epoch: 4 | loss: 0.4015920
	speed: 0.2804s/iter; left time: 9954.2149s
Epoch: 4 cost time: 104.2208034992218
Epoch: 4, Steps: 369 | Train Loss: 0.349 Vali Loss: 1.295 Vali Acc: 0.643 Test Loss: 1.295 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0947793
	speed: 0.9288s/iter; left time: 32809.3553s
	iters: 200, epoch: 5 | loss: 0.0821334
	speed: 0.2865s/iter; left time: 10091.1999s
	iters: 300, epoch: 5 | loss: 0.3723246
	speed: 0.2899s/iter; left time: 10181.5094s
Epoch: 5 cost time: 106.43732118606567
Epoch: 5, Steps: 369 | Train Loss: 0.303 Vali Loss: 1.247 Vali Acc: 0.654 Test Loss: 1.247 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2182587
	speed: 0.9714s/iter; left time: 33955.3022s
	iters: 200, epoch: 6 | loss: 0.3539238
	speed: 0.2913s/iter; left time: 10155.0489s
	iters: 300, epoch: 6 | loss: 0.3120493
	speed: 0.2961s/iter; left time: 10290.6788s
Epoch: 6 cost time: 110.4002275466919
Epoch: 6, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.386 Vali Acc: 0.631 Test Loss: 1.386 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0687580
	speed: 0.9218s/iter; left time: 31883.7807s
	iters: 200, epoch: 7 | loss: 0.5395816
	speed: 0.2840s/iter; left time: 9793.6048s
	iters: 300, epoch: 7 | loss: 0.2510736
	speed: 0.2907s/iter; left time: 9997.7935s
Epoch: 7 cost time: 106.47189116477966
Epoch: 7, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.375 Vali Acc: 0.674 Test Loss: 1.375 Test Acc: 0.674
Validation loss decreased (-0.659186 --> -0.673653).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0351634
	speed: 0.9641s/iter; left time: 32989.4049s
	iters: 200, epoch: 8 | loss: 0.0155200
	speed: 0.3029s/iter; left time: 10334.8948s
	iters: 300, epoch: 8 | loss: 0.2688659
	speed: 0.3105s/iter; left time: 10564.0294s
Epoch: 8 cost time: 113.13773846626282
Epoch: 8, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.880 Vali Acc: 0.633 Test Loss: 1.880 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1898076
	speed: 0.9376s/iter; left time: 31737.6727s
	iters: 200, epoch: 9 | loss: 0.0159072
	speed: 0.2830s/iter; left time: 9550.9377s
	iters: 300, epoch: 9 | loss: 0.1091724
	speed: 0.2794s/iter; left time: 9400.0653s
Epoch: 9 cost time: 104.1983847618103
Epoch: 9, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.870 Vali Acc: 0.642 Test Loss: 1.870 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0333494
	speed: 0.8941s/iter; left time: 29934.2182s
	iters: 200, epoch: 10 | loss: 0.1413774
	speed: 0.2835s/iter; left time: 9463.4099s
	iters: 300, epoch: 10 | loss: 0.0044390
	speed: 0.2749s/iter; left time: 9149.0829s
Epoch: 10 cost time: 104.17196750640869
Epoch: 10, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.890 Vali Acc: 0.646 Test Loss: 1.890 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0532180
	speed: 0.8995s/iter; left time: 29784.5774s
	iters: 200, epoch: 11 | loss: 0.0349487
	speed: 0.2785s/iter; left time: 9193.0111s
	iters: 300, epoch: 11 | loss: 0.0429933
	speed: 0.2744s/iter; left time: 9030.8173s
Epoch: 11 cost time: 103.37613320350647
Epoch: 11, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.857 Vali Acc: 0.650 Test Loss: 1.857 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1449181
	speed: 0.8816s/iter; left time: 28866.4752s
	iters: 200, epoch: 12 | loss: 0.1752428
	speed: 0.2793s/iter; left time: 9116.5728s
	iters: 300, epoch: 12 | loss: 0.0060318
	speed: 0.2759s/iter; left time: 8978.8259s
Epoch: 12 cost time: 101.77041745185852
Epoch: 12, Steps: 369 | Train Loss: 0.188 Vali Loss: 2.071 Vali Acc: 0.650 Test Loss: 2.071 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0028779
	speed: 0.8917s/iter; left time: 28867.5679s
	iters: 200, epoch: 13 | loss: 0.4836289
	speed: 0.2712s/iter; left time: 8751.7373s
	iters: 300, epoch: 13 | loss: 0.3907097
	speed: 0.2689s/iter; left time: 8652.2867s
Epoch: 13 cost time: 102.3096673488617
Epoch: 13, Steps: 369 | Train Loss: 0.189 Vali Loss: 2.083 Vali Acc: 0.635 Test Loss: 2.083 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0008973
	speed: 0.8895s/iter; left time: 28466.8547s
	iters: 200, epoch: 14 | loss: 0.3216101
	speed: 0.2784s/iter; left time: 8881.8113s
	iters: 300, epoch: 14 | loss: 0.1191283
	speed: 0.2690s/iter; left time: 8553.8294s
Epoch: 14 cost time: 101.74030804634094
Epoch: 14, Steps: 369 | Train Loss: 0.169 Vali Loss: 2.451 Vali Acc: 0.655 Test Loss: 2.451 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.2457035
	speed: 0.8729s/iter; left time: 27613.6890s
	iters: 200, epoch: 15 | loss: 0.0035961
	speed: 0.2772s/iter; left time: 8741.1419s
	iters: 300, epoch: 15 | loss: 0.2155777
	speed: 0.2749s/iter; left time: 8642.3679s
Epoch: 15 cost time: 100.40850496292114
Epoch: 15, Steps: 369 | Train Loss: 0.165 Vali Loss: 2.429 Vali Acc: 0.637 Test Loss: 2.429 Test Acc: 0.637
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2629645
	speed: 0.9115s/iter; left time: 28497.4268s
	iters: 200, epoch: 16 | loss: 0.2358293
	speed: 0.2828s/iter; left time: 8814.5121s
	iters: 300, epoch: 16 | loss: 0.0367798
	speed: 0.2997s/iter; left time: 9310.7706s
Epoch: 16 cost time: 106.76952505111694
Epoch: 16, Steps: 369 | Train Loss: 0.178 Vali Loss: 2.344 Vali Acc: 0.656 Test Loss: 2.344 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5396382
	speed: 0.9022s/iter; left time: 27875.5260s
	iters: 200, epoch: 17 | loss: 0.1075093
	speed: 0.2779s/iter; left time: 8560.0084s
	iters: 300, epoch: 17 | loss: 0.1409273
	speed: 0.2821s/iter; left time: 8660.4804s
Epoch: 17 cost time: 103.9098436832428
Epoch: 17, Steps: 369 | Train Loss: 0.155 Vali Loss: 2.625 Vali Acc: 0.652 Test Loss: 2.625 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6736662883087401
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8129364
	speed: 0.2912s/iter; left time: 10715.1801s
	iters: 200, epoch: 1 | loss: 0.6618531
	speed: 0.2612s/iter; left time: 9587.9866s
	iters: 300, epoch: 1 | loss: 0.7336734
	speed: 0.2592s/iter; left time: 9488.3867s
Epoch: 1 cost time: 99.58107542991638
Epoch: 1, Steps: 369 | Train Loss: 0.683 Vali Loss: 0.766 Vali Acc: 0.643 Test Loss: 0.766 Test Acc: 0.643
Validation loss decreased (inf --> -0.642728).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3528986
	speed: 0.8236s/iter; left time: 30006.9951s
	iters: 200, epoch: 2 | loss: 0.4906591
	speed: 0.2611s/iter; left time: 9486.5588s
	iters: 300, epoch: 2 | loss: 0.5765983
	speed: 0.2571s/iter; left time: 9315.0117s
Epoch: 2 cost time: 95.70107078552246
Epoch: 2, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.884 Vali Acc: 0.664 Test Loss: 0.884 Test Acc: 0.664
Validation loss decreased (-0.642728 --> -0.663726).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2992077
	speed: 0.8593s/iter; left time: 30989.5449s
	iters: 200, epoch: 3 | loss: 0.7043111
	speed: 0.2682s/iter; left time: 9646.0474s
	iters: 300, epoch: 3 | loss: 0.2845384
	speed: 0.2637s/iter; left time: 9457.7874s
Epoch: 3 cost time: 99.21593379974365
Epoch: 3, Steps: 369 | Train Loss: 0.443 Vali Loss: 1.157 Vali Acc: 0.622 Test Loss: 1.157 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1003080
	speed: 0.8305s/iter; left time: 29644.7614s
	iters: 200, epoch: 4 | loss: 0.8061821
	speed: 0.2727s/iter; left time: 9705.6983s
	iters: 300, epoch: 4 | loss: 0.5669185
	speed: 0.2738s/iter; left time: 9716.6941s
Epoch: 4 cost time: 99.80309915542603
Epoch: 4, Steps: 369 | Train Loss: 0.373 Vali Loss: 1.148 Vali Acc: 0.663 Test Loss: 1.148 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0618608
	speed: 0.8664s/iter; left time: 30607.1732s
	iters: 200, epoch: 5 | loss: 0.2759317
	speed: 0.2605s/iter; left time: 9177.7252s
	iters: 300, epoch: 5 | loss: 0.1897580
	speed: 0.2686s/iter; left time: 9432.9775s
Epoch: 5 cost time: 99.49499249458313
Epoch: 5, Steps: 369 | Train Loss: 0.306 Vali Loss: 1.159 Vali Acc: 0.668 Test Loss: 1.159 Test Acc: 0.668
Validation loss decreased (-0.663726 --> -0.667979).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2867224
	speed: 0.8665s/iter; left time: 30288.9037s
	iters: 200, epoch: 6 | loss: 0.6815862
	speed: 0.2748s/iter; left time: 9579.5498s
	iters: 300, epoch: 6 | loss: 0.1351487
	speed: 0.2687s/iter; left time: 9339.5915s
Epoch: 6 cost time: 101.83754849433899
Epoch: 6, Steps: 369 | Train Loss: 0.295 Vali Loss: 1.378 Vali Acc: 0.661 Test Loss: 1.378 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4503285
	speed: 0.8771s/iter; left time: 30335.7195s
	iters: 200, epoch: 7 | loss: 0.1686935
	speed: 0.2766s/iter; left time: 9539.3249s
	iters: 300, epoch: 7 | loss: 1.0104146
	speed: 0.2892s/iter; left time: 9945.1918s
Epoch: 7 cost time: 104.46528792381287
Epoch: 7, Steps: 369 | Train Loss: 0.252 Vali Loss: 1.490 Vali Acc: 0.667 Test Loss: 1.490 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0428301
	speed: 0.8955s/iter; left time: 30641.2822s
	iters: 200, epoch: 8 | loss: 0.0284021
	speed: 0.2733s/iter; left time: 9324.6178s
	iters: 300, epoch: 8 | loss: 0.2479663
	speed: 0.2657s/iter; left time: 9038.5280s
Epoch: 8 cost time: 100.60981512069702
Epoch: 8, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.778 Vali Acc: 0.655 Test Loss: 1.778 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0686455
	speed: 0.8603s/iter; left time: 29121.9652s
	iters: 200, epoch: 9 | loss: 0.0163648
	speed: 0.2621s/iter; left time: 8846.6471s
	iters: 300, epoch: 9 | loss: 0.2758156
	speed: 0.2698s/iter; left time: 9078.7478s
Epoch: 9 cost time: 98.93355584144592
Epoch: 9, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.890 Vali Acc: 0.665 Test Loss: 1.890 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0104500
	speed: 0.8440s/iter; left time: 28255.9664s
	iters: 200, epoch: 10 | loss: 0.0155259
	speed: 0.2583s/iter; left time: 8623.5683s
	iters: 300, epoch: 10 | loss: 0.0250811
	speed: 0.2564s/iter; left time: 8534.5353s
Epoch: 10 cost time: 95.78700065612793
Epoch: 10, Steps: 369 | Train Loss: 0.194 Vali Loss: 2.003 Vali Acc: 0.661 Test Loss: 2.003 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1402805
	speed: 0.8256s/iter; left time: 27335.4016s
	iters: 200, epoch: 11 | loss: 0.2813743
	speed: 0.2600s/iter; left time: 8582.2715s
	iters: 300, epoch: 11 | loss: 0.3269765
	speed: 0.2623s/iter; left time: 8632.9300s
Epoch: 11 cost time: 96.16398048400879
Epoch: 11, Steps: 369 | Train Loss: 0.189 Vali Loss: 2.007 Vali Acc: 0.647 Test Loss: 2.007 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0482819
	speed: 0.8386s/iter; left time: 27456.5085s
	iters: 200, epoch: 12 | loss: 0.0466810
	speed: 0.2585s/iter; left time: 8437.0211s
	iters: 300, epoch: 12 | loss: 0.0599695
	speed: 0.2594s/iter; left time: 8441.9451s
Epoch: 12 cost time: 97.24264526367188
Epoch: 12, Steps: 369 | Train Loss: 0.175 Vali Loss: 2.249 Vali Acc: 0.650 Test Loss: 2.249 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0269763
	speed: 0.8481s/iter; left time: 27454.4007s
	iters: 200, epoch: 13 | loss: 0.1101064
	speed: 0.2653s/iter; left time: 8563.6339s
	iters: 300, epoch: 13 | loss: 0.0500832
	speed: 0.2701s/iter; left time: 8690.8537s
Epoch: 13 cost time: 99.5281937122345
Epoch: 13, Steps: 369 | Train Loss: 0.170 Vali Loss: 2.230 Vali Acc: 0.625 Test Loss: 2.230 Test Acc: 0.625
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0064338
	speed: 0.8558s/iter; left time: 27387.9953s
	iters: 200, epoch: 14 | loss: 0.7492692
	speed: 0.2680s/iter; left time: 8549.1884s
	iters: 300, epoch: 14 | loss: 0.2232865
	speed: 0.2626s/iter; left time: 8352.9125s
Epoch: 14 cost time: 98.48522806167603
Epoch: 14, Steps: 369 | Train Loss: 0.168 Vali Loss: 2.412 Vali Acc: 0.633 Test Loss: 2.412 Test Acc: 0.633
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0362450
	speed: 0.8264s/iter; left time: 26142.4924s
	iters: 200, epoch: 15 | loss: 0.0143306
	speed: 0.2616s/iter; left time: 8248.7994s
	iters: 300, epoch: 15 | loss: 0.5371828
	speed: 0.2629s/iter; left time: 8264.5065s
Epoch: 15 cost time: 97.1105489730835
Epoch: 15, Steps: 369 | Train Loss: 0.146 Vali Loss: 2.466 Vali Acc: 0.654 Test Loss: 2.466 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6679909194097616
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7218754
	speed: 0.2844s/iter; left time: 10466.7481s
	iters: 200, epoch: 1 | loss: 0.8196546
	speed: 0.2671s/iter; left time: 9801.7286s
	iters: 300, epoch: 1 | loss: 0.6445585
	speed: 0.2524s/iter; left time: 9238.1688s
Epoch: 1 cost time: 98.15995478630066
Epoch: 1, Steps: 369 | Train Loss: 0.692 Vali Loss: 0.786 Vali Acc: 0.638 Test Loss: 0.786 Test Acc: 0.638
Validation loss decreased (inf --> -0.638471).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3654378
	speed: 0.8339s/iter; left time: 30380.7411s
	iters: 200, epoch: 2 | loss: 0.4880014
	speed: 0.2660s/iter; left time: 9664.7430s
	iters: 300, epoch: 2 | loss: 0.6408433
	speed: 0.2558s/iter; left time: 9268.5651s
Epoch: 2 cost time: 96.35597562789917
Epoch: 2, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.860 Vali Acc: 0.650 Test Loss: 0.860 Test Acc: 0.650
Validation loss decreased (-0.638471 --> -0.649821).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2873087
	speed: 0.8495s/iter; left time: 30636.7319s
	iters: 200, epoch: 3 | loss: 0.4778524
	speed: 0.2532s/iter; left time: 9107.1477s
	iters: 300, epoch: 3 | loss: 0.6092328
	speed: 0.2554s/iter; left time: 9160.6635s
Epoch: 3 cost time: 95.33437299728394
Epoch: 3, Steps: 369 | Train Loss: 0.440 Vali Loss: 1.043 Vali Acc: 0.632 Test Loss: 1.043 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1546231
	speed: 0.8208s/iter; left time: 29296.6580s
	iters: 200, epoch: 4 | loss: 0.2908113
	speed: 0.2523s/iter; left time: 8978.7615s
	iters: 300, epoch: 4 | loss: 0.2008144
	speed: 0.2505s/iter; left time: 8890.8010s
Epoch: 4 cost time: 93.78096437454224
Epoch: 4, Steps: 369 | Train Loss: 0.360 Vali Loss: 1.254 Vali Acc: 0.647 Test Loss: 1.254 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3892604
	speed: 0.8226s/iter; left time: 29058.8503s
	iters: 200, epoch: 5 | loss: 0.4643618
	speed: 0.2445s/iter; left time: 8612.3632s
	iters: 300, epoch: 5 | loss: 0.2179895
	speed: 0.2457s/iter; left time: 8630.0910s
Epoch: 5 cost time: 92.23681592941284
Epoch: 5, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.364 Vali Acc: 0.654 Test Loss: 1.364 Test Acc: 0.654
Validation loss decreased (-0.649821 --> -0.653505).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2707149
	speed: 0.8226s/iter; left time: 28754.5232s
	iters: 200, epoch: 6 | loss: 0.8035827
	speed: 0.2619s/iter; left time: 9127.5776s
	iters: 300, epoch: 6 | loss: 0.0947341
	speed: 0.2552s/iter; left time: 8871.1613s
Epoch: 6 cost time: 96.23299670219421
Epoch: 6, Steps: 369 | Train Loss: 0.258 Vali Loss: 1.520 Vali Acc: 0.650 Test Loss: 1.520 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4049041
	speed: 0.8361s/iter; left time: 28916.9579s
	iters: 200, epoch: 7 | loss: 0.5145450
	speed: 0.2541s/iter; left time: 8764.6818s
	iters: 300, epoch: 7 | loss: 0.3897251
	speed: 0.2585s/iter; left time: 8887.3926s
Epoch: 7 cost time: 94.7523763179779
Epoch: 7, Steps: 369 | Train Loss: 0.254 Vali Loss: 1.441 Vali Acc: 0.663 Test Loss: 1.441 Test Acc: 0.663
Validation loss decreased (-0.653505 --> -0.663436).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3536851
	speed: 0.8477s/iter; left time: 29007.1201s
	iters: 200, epoch: 8 | loss: 0.0455453
	speed: 0.2613s/iter; left time: 8913.6159s
	iters: 300, epoch: 8 | loss: 0.4972051
	speed: 0.2570s/iter; left time: 8744.1303s
Epoch: 8 cost time: 96.41060447692871
Epoch: 8, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.715 Vali Acc: 0.648 Test Loss: 1.715 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2070110
	speed: 0.8212s/iter; left time: 27796.3906s
	iters: 200, epoch: 9 | loss: 0.0357979
	speed: 0.2623s/iter; left time: 8853.1926s
	iters: 300, epoch: 9 | loss: 0.4183529
	speed: 0.2561s/iter; left time: 8617.6031s
Epoch: 9 cost time: 95.2245466709137
Epoch: 9, Steps: 369 | Train Loss: 0.225 Vali Loss: 2.011 Vali Acc: 0.635 Test Loss: 2.011 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0161345
	speed: 0.8476s/iter; left time: 28377.2068s
	iters: 200, epoch: 10 | loss: 0.1221119
	speed: 0.2520s/iter; left time: 8410.1218s
	iters: 300, epoch: 10 | loss: 0.0226552
	speed: 0.2555s/iter; left time: 8501.8143s
Epoch: 10 cost time: 96.45627546310425
Epoch: 10, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.857 Vali Acc: 0.641 Test Loss: 1.857 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0247073
	speed: 0.8518s/iter; left time: 28203.0223s
	iters: 200, epoch: 11 | loss: 0.1738325
	speed: 0.2594s/iter; left time: 8564.5131s
	iters: 300, epoch: 11 | loss: 0.0198946
	speed: 0.2526s/iter; left time: 8313.1166s
Epoch: 11 cost time: 96.81051111221313
Epoch: 11, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.901 Vali Acc: 0.648 Test Loss: 1.901 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2894564
	speed: 0.8594s/iter; left time: 28138.8896s
	iters: 200, epoch: 12 | loss: 0.0493280
	speed: 0.2644s/iter; left time: 8631.1005s
	iters: 300, epoch: 12 | loss: 0.0875745
	speed: 0.2506s/iter; left time: 8154.1503s
Epoch: 12 cost time: 97.1931140422821
Epoch: 12, Steps: 369 | Train Loss: 0.188 Vali Loss: 2.072 Vali Acc: 0.650 Test Loss: 2.072 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0120076
	speed: 0.8333s/iter; left time: 26976.9138s
	iters: 200, epoch: 13 | loss: 0.1852693
	speed: 0.2551s/iter; left time: 8232.6255s
	iters: 300, epoch: 13 | loss: 0.0477192
	speed: 0.2478s/iter; left time: 7973.5542s
Epoch: 13 cost time: 94.72814679145813
Epoch: 13, Steps: 369 | Train Loss: 0.156 Vali Loss: 2.423 Vali Acc: 0.642 Test Loss: 2.423 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.2877347
	speed: 0.8184s/iter; left time: 26191.4301s
	iters: 200, epoch: 14 | loss: 0.0719469
	speed: 0.2523s/iter; left time: 8048.0971s
	iters: 300, epoch: 14 | loss: 0.5198622
	speed: 0.2723s/iter; left time: 8659.3431s
Epoch: 14 cost time: 94.478595495224
Epoch: 14, Steps: 369 | Train Loss: 0.197 Vali Loss: 2.351 Vali Acc: 0.662 Test Loss: 2.351 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0510917
	speed: 0.8390s/iter; left time: 26540.8796s
	iters: 200, epoch: 15 | loss: 0.0367780
	speed: 0.2493s/iter; left time: 7862.0384s
	iters: 300, epoch: 15 | loss: 0.5866331
	speed: 0.2708s/iter; left time: 8512.0893s
Epoch: 15 cost time: 97.49278950691223
Epoch: 15, Steps: 369 | Train Loss: 0.201 Vali Loss: 2.274 Vali Acc: 0.656 Test Loss: 2.274 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0836692
	speed: 0.8704s/iter; left time: 27212.3659s
	iters: 200, epoch: 16 | loss: 0.2869183
	speed: 0.2787s/iter; left time: 8686.6343s
	iters: 300, epoch: 16 | loss: 0.0044363
	speed: 0.2614s/iter; left time: 8120.6689s
Epoch: 16 cost time: 98.29167151451111
Epoch: 16, Steps: 369 | Train Loss: 0.177 Vali Loss: 2.338 Vali Acc: 0.668 Test Loss: 2.338 Test Acc: 0.668
Validation loss decreased (-0.663436 --> -0.667684).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0788114
	speed: 0.8403s/iter; left time: 25962.2248s
	iters: 200, epoch: 17 | loss: 0.0381150
	speed: 0.2439s/iter; left time: 7509.9200s
	iters: 300, epoch: 17 | loss: 0.0009929
	speed: 0.2575s/iter; left time: 7904.5593s
Epoch: 17 cost time: 94.90656995773315
Epoch: 17, Steps: 369 | Train Loss: 0.150 Vali Loss: 2.313 Vali Acc: 0.650 Test Loss: 2.313 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0144158
	speed: 0.8061s/iter; left time: 24608.3555s
	iters: 200, epoch: 18 | loss: 0.0270512
	speed: 0.2715s/iter; left time: 8260.8897s
	iters: 300, epoch: 18 | loss: 0.3641972
	speed: 0.2649s/iter; left time: 8034.7814s
Epoch: 18 cost time: 96.49184560775757
Epoch: 18, Steps: 369 | Train Loss: 0.142 Vali Loss: 2.269 Vali Acc: 0.656 Test Loss: 2.269 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0033523
	speed: 0.8184s/iter; left time: 24681.9005s
	iters: 200, epoch: 19 | loss: 0.0024984
	speed: 0.2549s/iter; left time: 7661.7063s
	iters: 300, epoch: 19 | loss: 0.2871967
	speed: 0.2575s/iter; left time: 7715.5034s
Epoch: 19 cost time: 94.68876528739929
Epoch: 19, Steps: 369 | Train Loss: 0.158 Vali Loss: 2.512 Vali Acc: 0.642 Test Loss: 2.512 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0333154
	speed: 0.8395s/iter; left time: 25009.4292s
	iters: 200, epoch: 20 | loss: 0.1208416
	speed: 0.2701s/iter; left time: 8019.5831s
	iters: 300, epoch: 20 | loss: 0.2977413
	speed: 0.2601s/iter; left time: 7697.5489s
Epoch: 20 cost time: 99.23800921440125
Epoch: 20, Steps: 369 | Train Loss: 0.140 Vali Loss: 3.034 Vali Acc: 0.651 Test Loss: 3.034 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0109465
	speed: 0.8911s/iter; left time: 26217.8593s
	iters: 200, epoch: 21 | loss: 0.6210574
	speed: 0.2580s/iter; left time: 7565.5254s
	iters: 300, epoch: 21 | loss: 0.0078844
	speed: 0.2806s/iter; left time: 8199.9862s
Epoch: 21 cost time: 100.52263045310974
Epoch: 21, Steps: 369 | Train Loss: 0.174 Vali Loss: 2.800 Vali Acc: 0.638 Test Loss: 2.800 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0468856
	speed: 0.8611s/iter; left time: 25015.2618s
	iters: 200, epoch: 22 | loss: 0.2586968
	speed: 0.2675s/iter; left time: 7743.8019s
	iters: 300, epoch: 22 | loss: 0.0016824
	speed: 0.2551s/iter; left time: 7361.1606s
Epoch: 22 cost time: 97.69141030311584
Epoch: 22, Steps: 369 | Train Loss: 0.138 Vali Loss: 3.156 Vali Acc: 0.657 Test Loss: 3.156 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0414985
	speed: 0.8653s/iter; left time: 24820.6591s
	iters: 200, epoch: 23 | loss: 0.9284849
	speed: 0.2646s/iter; left time: 7562.9515s
	iters: 300, epoch: 23 | loss: 0.0285381
	speed: 0.2599s/iter; left time: 7402.9394s
Epoch: 23 cost time: 96.65748286247253
Epoch: 23, Steps: 369 | Train Loss: 0.133 Vali Loss: 2.841 Vali Acc: 0.657 Test Loss: 2.841 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0346159
	speed: 0.8285s/iter; left time: 23458.5927s
	iters: 200, epoch: 24 | loss: 0.0995307
	speed: 0.2397s/iter; left time: 6761.6376s
	iters: 300, epoch: 24 | loss: 0.0001128
	speed: 0.2357s/iter; left time: 6626.9087s
Epoch: 24 cost time: 91.31706953048706
Epoch: 24, Steps: 369 | Train Loss: 0.140 Vali Loss: 2.989 Vali Acc: 0.644 Test Loss: 2.989 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0003213
	speed: 0.8127s/iter; left time: 22712.2885s
	iters: 200, epoch: 25 | loss: 0.0005650
	speed: 0.2482s/iter; left time: 6910.9341s
	iters: 300, epoch: 25 | loss: 0.2544516
	speed: 0.2450s/iter; left time: 6798.1430s
Epoch: 25 cost time: 92.00831055641174
Epoch: 25, Steps: 369 | Train Loss: 0.165 Vali Loss: 2.783 Vali Acc: 0.656 Test Loss: 2.783 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0491806
	speed: 0.7982s/iter; left time: 22010.5061s
	iters: 200, epoch: 26 | loss: 0.4602646
	speed: 0.2413s/iter; left time: 6630.5726s
	iters: 300, epoch: 26 | loss: 0.0087160
	speed: 0.2424s/iter; left time: 6636.9749s
Epoch: 26 cost time: 89.4044942855835
Epoch: 26, Steps: 369 | Train Loss: 0.138 Vali Loss: 3.048 Vali Acc: 0.645 Test Loss: 3.048 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6677071509648127
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6673109
	speed: 0.2933s/iter; left time: 10794.5021s
	iters: 200, epoch: 1 | loss: 0.6915927
	speed: 0.2762s/iter; left time: 10138.1227s
	iters: 300, epoch: 1 | loss: 1.1061568
	speed: 0.2690s/iter; left time: 9845.8152s
Epoch: 1 cost time: 102.51046848297119
Epoch: 1, Steps: 369 | Train Loss: 0.690 Vali Loss: 0.767 Vali Acc: 0.655 Test Loss: 0.767 Test Acc: 0.655
Validation loss decreased (inf --> -0.654646).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4031271
	speed: 0.8812s/iter; left time: 32104.0990s
	iters: 200, epoch: 2 | loss: 0.6896237
	speed: 0.2859s/iter; left time: 10388.4841s
	iters: 300, epoch: 2 | loss: 0.8833312
	speed: 0.2789s/iter; left time: 10105.9404s
Epoch: 2 cost time: 102.91684627532959
Epoch: 2, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.894 Vali Acc: 0.644 Test Loss: 0.894 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1854457
	speed: 0.8600s/iter; left time: 31014.3963s
	iters: 200, epoch: 3 | loss: 0.5399042
	speed: 0.2518s/iter; left time: 9055.9439s
	iters: 300, epoch: 3 | loss: 0.3914939
	speed: 0.2755s/iter; left time: 9880.7863s
Epoch: 3 cost time: 98.60760521888733
Epoch: 3, Steps: 369 | Train Loss: 0.466 Vali Loss: 0.925 Vali Acc: 0.655 Test Loss: 0.925 Test Acc: 0.655
Validation loss decreased (-0.654646 --> -0.655212).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1077975
	speed: 0.8546s/iter; left time: 30502.5144s
	iters: 200, epoch: 4 | loss: 0.7121372
	speed: 0.2641s/iter; left time: 9400.4130s
	iters: 300, epoch: 4 | loss: 0.5003242
	speed: 0.2465s/iter; left time: 8749.0462s
Epoch: 4 cost time: 96.41520833969116
Epoch: 4, Steps: 369 | Train Loss: 0.382 Vali Loss: 1.208 Vali Acc: 0.661 Test Loss: 1.208 Test Acc: 0.661
Validation loss decreased (-0.655212 --> -0.660601).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2595395
	speed: 0.8007s/iter; left time: 28284.9377s
	iters: 200, epoch: 5 | loss: 0.1816431
	speed: 0.2507s/iter; left time: 8832.5799s
	iters: 300, epoch: 5 | loss: 0.1675668
	speed: 0.2507s/iter; left time: 8804.6329s
Epoch: 5 cost time: 92.0803599357605
Epoch: 5, Steps: 369 | Train Loss: 0.332 Vali Loss: 1.307 Vali Acc: 0.654 Test Loss: 1.307 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6017492
	speed: 0.8276s/iter; left time: 28929.9544s
	iters: 200, epoch: 6 | loss: 0.2992451
	speed: 0.2605s/iter; left time: 9080.1483s
	iters: 300, epoch: 6 | loss: 0.0625532
	speed: 0.2510s/iter; left time: 8725.3447s
Epoch: 6 cost time: 94.94928979873657
Epoch: 6, Steps: 369 | Train Loss: 0.288 Vali Loss: 1.391 Vali Acc: 0.656 Test Loss: 1.391 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0322495
	speed: 0.8590s/iter; left time: 29708.5882s
	iters: 200, epoch: 7 | loss: 0.3070696
	speed: 0.2595s/iter; left time: 8948.8154s
	iters: 300, epoch: 7 | loss: 0.1710434
	speed: 0.2551s/iter; left time: 8772.6691s
Epoch: 7 cost time: 96.57490229606628
Epoch: 7, Steps: 369 | Train Loss: 0.251 Vali Loss: 1.712 Vali Acc: 0.618 Test Loss: 1.712 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1340343
	speed: 0.8250s/iter; left time: 28229.4730s
	iters: 200, epoch: 8 | loss: 0.0088432
	speed: 0.2512s/iter; left time: 8569.3414s
	iters: 300, epoch: 8 | loss: 0.2318420
	speed: 0.2522s/iter; left time: 8580.3075s
Epoch: 8 cost time: 94.40936493873596
Epoch: 8, Steps: 369 | Train Loss: 0.234 Vali Loss: 1.663 Vali Acc: 0.656 Test Loss: 1.663 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0614381
	speed: 0.8234s/iter; left time: 27871.3382s
	iters: 200, epoch: 9 | loss: 0.0065482
	speed: 0.2569s/iter; left time: 8670.3342s
	iters: 300, epoch: 9 | loss: 0.1642715
	speed: 0.2507s/iter; left time: 8436.5495s
Epoch: 9 cost time: 95.2919933795929
Epoch: 9, Steps: 369 | Train Loss: 0.211 Vali Loss: 1.840 Vali Acc: 0.631 Test Loss: 1.840 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0368400
	speed: 0.8153s/iter; left time: 27297.5458s
	iters: 200, epoch: 10 | loss: 0.4045740
	speed: 0.2532s/iter; left time: 8452.1317s
	iters: 300, epoch: 10 | loss: 0.2012201
	speed: 0.2480s/iter; left time: 8252.9527s
Epoch: 10 cost time: 92.79124426841736
Epoch: 10, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.745 Vali Acc: 0.665 Test Loss: 1.745 Test Acc: 0.665
Validation loss decreased (-0.660601 --> -0.665136).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0980103
	speed: 0.8127s/iter; left time: 26907.9834s
	iters: 200, epoch: 11 | loss: 0.5430909
	speed: 0.2455s/iter; left time: 8103.3608s
	iters: 300, epoch: 11 | loss: 0.0663041
	speed: 0.2423s/iter; left time: 7973.2794s
Epoch: 11 cost time: 91.61536359786987
Epoch: 11, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.932 Vali Acc: 0.642 Test Loss: 1.932 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0020343
	speed: 0.8022s/iter; left time: 26265.0892s
	iters: 200, epoch: 12 | loss: 0.0434916
	speed: 0.2450s/iter; left time: 7997.4856s
	iters: 300, epoch: 12 | loss: 0.0424901
	speed: 0.2458s/iter; left time: 7997.8237s
Epoch: 12 cost time: 92.76266264915466
Epoch: 12, Steps: 369 | Train Loss: 0.152 Vali Loss: 2.052 Vali Acc: 0.668 Test Loss: 2.052 Test Acc: 0.668
Validation loss decreased (-0.665136 --> -0.667970).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0132327
	speed: 0.8167s/iter; left time: 26439.5152s
	iters: 200, epoch: 13 | loss: 0.0022857
	speed: 0.2559s/iter; left time: 8257.1847s
	iters: 300, epoch: 13 | loss: 0.0268186
	speed: 0.2452s/iter; left time: 7889.2737s
Epoch: 13 cost time: 91.93592643737793
Epoch: 13, Steps: 369 | Train Loss: 0.178 Vali Loss: 2.187 Vali Acc: 0.642 Test Loss: 2.187 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3609230
	speed: 0.8085s/iter; left time: 25876.4703s
	iters: 200, epoch: 14 | loss: 0.0073894
	speed: 0.2513s/iter; left time: 8018.3374s
	iters: 300, epoch: 14 | loss: 0.1476412
	speed: 0.2538s/iter; left time: 8070.8241s
Epoch: 14 cost time: 93.91558742523193
Epoch: 14, Steps: 369 | Train Loss: 0.177 Vali Loss: 2.441 Vali Acc: 0.650 Test Loss: 2.441 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0234931
	speed: 0.8036s/iter; left time: 25421.0779s
	iters: 200, epoch: 15 | loss: 0.0514041
	speed: 0.2557s/iter; left time: 8062.7790s
	iters: 300, epoch: 15 | loss: 0.0747182
	speed: 0.2545s/iter; left time: 8000.1063s
Epoch: 15 cost time: 93.5282142162323
Epoch: 15, Steps: 369 | Train Loss: 0.178 Vali Loss: 2.308 Vali Acc: 0.664 Test Loss: 2.308 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1049186
	speed: 0.8215s/iter; left time: 25684.7416s
	iters: 200, epoch: 16 | loss: 0.0847052
	speed: 0.2538s/iter; left time: 7910.0601s
	iters: 300, epoch: 16 | loss: 0.1636302
	speed: 0.2535s/iter; left time: 7876.6735s
Epoch: 16 cost time: 94.4950304031372
Epoch: 16, Steps: 369 | Train Loss: 0.166 Vali Loss: 2.424 Vali Acc: 0.663 Test Loss: 2.424 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0097124
	speed: 0.8187s/iter; left time: 25296.4927s
	iters: 200, epoch: 17 | loss: 0.6029018
	speed: 0.2481s/iter; left time: 7639.4379s
	iters: 300, epoch: 17 | loss: 0.0117957
	speed: 0.2494s/iter; left time: 7655.5829s
Epoch: 17 cost time: 92.55080223083496
Epoch: 17, Steps: 369 | Train Loss: 0.161 Vali Loss: 2.304 Vali Acc: 0.654 Test Loss: 2.304 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1299487
	speed: 0.8170s/iter; left time: 24940.1917s
	iters: 200, epoch: 18 | loss: 0.4307292
	speed: 0.2503s/iter; left time: 7616.0083s
	iters: 300, epoch: 18 | loss: 0.2045877
	speed: 0.2556s/iter; left time: 7752.6265s
Epoch: 18 cost time: 93.19194602966309
Epoch: 18, Steps: 369 | Train Loss: 0.155 Vali Loss: 2.446 Vali Acc: 0.657 Test Loss: 2.446 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1862630
	speed: 0.8077s/iter; left time: 24358.2320s
	iters: 200, epoch: 19 | loss: 0.1209780
	speed: 0.2515s/iter; left time: 7561.0825s
	iters: 300, epoch: 19 | loss: 0.0930924
	speed: 0.2517s/iter; left time: 7539.6968s
Epoch: 19 cost time: 91.98465061187744
Epoch: 19, Steps: 369 | Train Loss: 0.154 Vali Loss: 2.528 Vali Acc: 0.658 Test Loss: 2.528 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.7426150
	speed: 0.8048s/iter; left time: 23975.8470s
	iters: 200, epoch: 20 | loss: 0.0282653
	speed: 0.2517s/iter; left time: 7471.9516s
	iters: 300, epoch: 20 | loss: 0.5339230
	speed: 0.2511s/iter; left time: 7429.7549s
Epoch: 20 cost time: 93.0534257888794
Epoch: 20, Steps: 369 | Train Loss: 0.132 Vali Loss: 2.734 Vali Acc: 0.635 Test Loss: 2.734 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0561781
	speed: 0.8002s/iter; left time: 23541.9622s
	iters: 200, epoch: 21 | loss: 0.3540551
	speed: 0.2567s/iter; left time: 7526.9556s
	iters: 300, epoch: 21 | loss: 0.0835609
	speed: 0.2487s/iter; left time: 7266.0729s
Epoch: 21 cost time: 92.97649717330933
Epoch: 21, Steps: 369 | Train Loss: 0.153 Vali Loss: 2.729 Vali Acc: 0.653 Test Loss: 2.729 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0877170
	speed: 0.8072s/iter; left time: 23450.4269s
	iters: 200, epoch: 22 | loss: 0.2367167
	speed: 0.2485s/iter; left time: 7195.2651s
	iters: 300, epoch: 22 | loss: 0.4603989
	speed: 0.2565s/iter; left time: 7401.8858s
Epoch: 22 cost time: 93.54967999458313
Epoch: 22, Steps: 369 | Train Loss: 0.149 Vali Loss: 2.651 Vali Acc: 0.669 Test Loss: 2.651 Test Acc: 0.669
Validation loss decreased (-0.667970 --> -0.668532).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.1933482
	speed: 0.8243s/iter; left time: 23643.4611s
	iters: 200, epoch: 23 | loss: 0.3668965
	speed: 0.2645s/iter; left time: 7560.2954s
	iters: 300, epoch: 23 | loss: 0.1238583
	speed: 0.2673s/iter; left time: 7614.3959s
Epoch: 23 cost time: 98.27342510223389
Epoch: 23, Steps: 369 | Train Loss: 0.131 Vali Loss: 2.589 Vali Acc: 0.661 Test Loss: 2.589 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0634762
	speed: 0.8508s/iter; left time: 24088.6490s
	iters: 200, epoch: 24 | loss: 0.0257378
	speed: 0.2637s/iter; left time: 7440.6798s
	iters: 300, epoch: 24 | loss: 0.0010954
	speed: 0.2558s/iter; left time: 7191.8621s
Epoch: 24 cost time: 96.97388076782227
Epoch: 24, Steps: 369 | Train Loss: 0.137 Vali Loss: 2.913 Vali Acc: 0.657 Test Loss: 2.913 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0513704
	speed: 0.8262s/iter; left time: 23087.5992s
	iters: 200, epoch: 25 | loss: 0.0007866
	speed: 0.2562s/iter; left time: 7133.3194s
	iters: 300, epoch: 25 | loss: 0.1000417
	speed: 0.2779s/iter; left time: 7709.1510s
Epoch: 25 cost time: 96.98492813110352
Epoch: 25, Steps: 369 | Train Loss: 0.153 Vali Loss: 2.900 Vali Acc: 0.646 Test Loss: 2.900 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0006850
	speed: 0.8278s/iter; left time: 22826.4164s
	iters: 200, epoch: 26 | loss: 0.0273961
	speed: 0.2514s/iter; left time: 6906.4436s
	iters: 300, epoch: 26 | loss: 0.0244017
	speed: 0.2462s/iter; left time: 6739.6384s
Epoch: 26 cost time: 94.19087934494019
Epoch: 26, Steps: 369 | Train Loss: 0.128 Vali Loss: 3.001 Vali Acc: 0.658 Test Loss: 3.001 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0094014
	speed: 0.8278s/iter; left time: 22521.1974s
	iters: 200, epoch: 27 | loss: 0.0013370
	speed: 0.2542s/iter; left time: 6891.2293s
	iters: 300, epoch: 27 | loss: 0.0519362
	speed: 0.2554s/iter; left time: 6896.7813s
Epoch: 27 cost time: 95.44275450706482
Epoch: 27, Steps: 369 | Train Loss: 0.135 Vali Loss: 3.179 Vali Acc: 0.665 Test Loss: 3.179 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.6337422
	speed: 0.8574s/iter; left time: 23012.0090s
	iters: 200, epoch: 28 | loss: 0.0291687
	speed: 0.2613s/iter; left time: 6987.6613s
	iters: 300, epoch: 28 | loss: 0.0048075
	speed: 0.2686s/iter; left time: 7155.8617s
Epoch: 28 cost time: 99.65094518661499
Epoch: 28, Steps: 369 | Train Loss: 0.141 Vali Loss: 3.261 Vali Acc: 0.643 Test Loss: 3.261 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000526
	speed: 0.8524s/iter; left time: 22561.5154s
	iters: 200, epoch: 29 | loss: 0.0507869
	speed: 0.2769s/iter; left time: 7300.7520s
	iters: 300, epoch: 29 | loss: 0.0693596
	speed: 0.2791s/iter; left time: 7331.6390s
Epoch: 29 cost time: 101.00092363357544
Epoch: 29, Steps: 369 | Train Loss: 0.171 Vali Loss: 3.139 Vali Acc: 0.649 Test Loss: 3.139 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0357744
	speed: 0.8295s/iter; left time: 21649.9434s
	iters: 200, epoch: 30 | loss: 0.1608607
	speed: 0.2616s/iter; left time: 6800.4212s
	iters: 300, epoch: 30 | loss: 0.7707802
	speed: 0.2615s/iter; left time: 6773.2649s
Epoch: 30 cost time: 98.10171794891357
Epoch: 30, Steps: 369 | Train Loss: 0.136 Vali Loss: 2.865 Vali Acc: 0.661 Test Loss: 2.865 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0026508
	speed: 0.8927s/iter; left time: 22971.1173s
	iters: 200, epoch: 31 | loss: 0.0255873
	speed: 0.2648s/iter; left time: 6788.3619s
	iters: 300, epoch: 31 | loss: 0.0073488
	speed: 0.2666s/iter; left time: 6805.3840s
Epoch: 31 cost time: 102.15412640571594
Epoch: 31, Steps: 369 | Train Loss: 0.132 Vali Loss: 2.970 Vali Acc: 0.640 Test Loss: 2.970 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0585939
	speed: 0.8902s/iter; left time: 22577.6671s
	iters: 200, epoch: 32 | loss: 0.0042626
	speed: 0.2718s/iter; left time: 6866.7692s
	iters: 300, epoch: 32 | loss: 0.0014861
	speed: 0.2738s/iter; left time: 6889.8888s
Epoch: 32 cost time: 101.95672631263733
Epoch: 32, Steps: 369 | Train Loss: 0.105 Vali Loss: 3.026 Vali Acc: 0.662 Test Loss: 3.026 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6685584562996595
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7363199
	speed: 0.2787s/iter; left time: 10255.3857s
	iters: 200, epoch: 1 | loss: 0.7269499
	speed: 0.2663s/iter; left time: 9774.4971s
	iters: 300, epoch: 1 | loss: 0.7589473
	speed: 0.2644s/iter; left time: 9677.8269s
Epoch: 1 cost time: 99.83642745018005
Epoch: 1, Steps: 369 | Train Loss: 0.698 Vali Loss: 0.757 Vali Acc: 0.663 Test Loss: 0.757 Test Acc: 0.663
Validation loss decreased (inf --> -0.662876).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5097215
	speed: 0.8482s/iter; left time: 30901.4518s
	iters: 200, epoch: 2 | loss: 0.6322654
	speed: 0.2659s/iter; left time: 9661.8894s
	iters: 300, epoch: 2 | loss: 0.8376377
	speed: 0.2576s/iter; left time: 9332.0433s
Epoch: 2 cost time: 96.90303421020508
Epoch: 2, Steps: 369 | Train Loss: 0.570 Vali Loss: 0.863 Vali Acc: 0.656 Test Loss: 0.863 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3156437
	speed: 0.8387s/iter; left time: 30245.1814s
	iters: 200, epoch: 3 | loss: 0.9381185
	speed: 0.2543s/iter; left time: 9146.7913s
	iters: 300, epoch: 3 | loss: 0.1913656
	speed: 0.2615s/iter; left time: 9379.2279s
Epoch: 3 cost time: 95.82617044448853
Epoch: 3, Steps: 369 | Train Loss: 0.475 Vali Loss: 0.932 Vali Acc: 0.645 Test Loss: 0.932 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0910690
	speed: 0.8339s/iter; left time: 29766.1331s
	iters: 200, epoch: 4 | loss: 0.8522558
	speed: 0.2674s/iter; left time: 9517.3824s
	iters: 300, epoch: 4 | loss: 0.9136147
	speed: 0.2649s/iter; left time: 9402.5205s
Epoch: 4 cost time: 98.0516881942749
Epoch: 4, Steps: 369 | Train Loss: 0.398 Vali Loss: 1.183 Vali Acc: 0.653 Test Loss: 1.183 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2163626
	speed: 0.8673s/iter; left time: 30636.3743s
	iters: 200, epoch: 5 | loss: 0.1418379
	speed: 0.2659s/iter; left time: 9365.9196s
	iters: 300, epoch: 5 | loss: 0.2815805
	speed: 0.2760s/iter; left time: 9692.9018s
Epoch: 5 cost time: 99.90701794624329
Epoch: 5, Steps: 369 | Train Loss: 0.336 Vali Loss: 1.210 Vali Acc: 0.648 Test Loss: 1.210 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2371836
	speed: 0.8426s/iter; left time: 29452.4276s
	iters: 200, epoch: 6 | loss: 0.0973747
	speed: 0.2706s/iter; left time: 9433.7679s
	iters: 300, epoch: 6 | loss: 0.3404338
	speed: 0.2687s/iter; left time: 9340.4042s
Epoch: 6 cost time: 99.6577696800232
Epoch: 6, Steps: 369 | Train Loss: 0.294 Vali Loss: 1.285 Vali Acc: 0.664 Test Loss: 1.285 Test Acc: 0.664
Validation loss decreased (-0.662876 --> -0.664005).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2344109
	speed: 0.8668s/iter; left time: 29979.4050s
	iters: 200, epoch: 7 | loss: 0.9091687
	speed: 0.2788s/iter; left time: 9615.0920s
	iters: 300, epoch: 7 | loss: 0.5136290
	speed: 0.2573s/iter; left time: 8846.8315s
Epoch: 7 cost time: 99.01018238067627
Epoch: 7, Steps: 369 | Train Loss: 0.267 Vali Loss: 1.407 Vali Acc: 0.663 Test Loss: 1.407 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2740905
	speed: 0.8362s/iter; left time: 28612.7652s
	iters: 200, epoch: 8 | loss: 0.0327997
	speed: 0.2539s/iter; left time: 8663.4470s
	iters: 300, epoch: 8 | loss: 0.0820090
	speed: 0.2705s/iter; left time: 9200.6464s
Epoch: 8 cost time: 99.21385192871094
Epoch: 8, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.628 Vali Acc: 0.650 Test Loss: 1.628 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0959160
	speed: 0.8667s/iter; left time: 29335.7489s
	iters: 200, epoch: 9 | loss: 0.1753789
	speed: 0.2682s/iter; left time: 9050.6502s
	iters: 300, epoch: 9 | loss: 0.1577215
	speed: 0.2697s/iter; left time: 9076.0382s
Epoch: 9 cost time: 99.59605431556702
Epoch: 9, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.767 Vali Acc: 0.643 Test Loss: 1.767 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0144991
	speed: 0.8902s/iter; left time: 29803.5860s
	iters: 200, epoch: 10 | loss: 0.0333922
	speed: 0.2640s/iter; left time: 8812.8810s
	iters: 300, epoch: 10 | loss: 0.0054041
	speed: 0.2788s/iter; left time: 9279.8919s
Epoch: 10 cost time: 101.51299571990967
Epoch: 10, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.743 Vali Acc: 0.662 Test Loss: 1.743 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0544361
	speed: 0.9009s/iter; left time: 29828.4326s
	iters: 200, epoch: 11 | loss: 0.2192193
	speed: 0.2896s/iter; left time: 9561.5636s
	iters: 300, epoch: 11 | loss: 0.6340026
	speed: 0.2766s/iter; left time: 9104.1652s
Epoch: 11 cost time: 105.42839050292969
Epoch: 11, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.818 Vali Acc: 0.661 Test Loss: 1.818 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0546442
	speed: 0.8936s/iter; left time: 29256.9071s
	iters: 200, epoch: 12 | loss: 0.1987801
	speed: 0.2708s/iter; left time: 8838.6598s
	iters: 300, epoch: 12 | loss: 0.0976815
	speed: 0.2757s/iter; left time: 8972.9703s
Epoch: 12 cost time: 102.67830681800842
Epoch: 12, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.880 Vali Acc: 0.656 Test Loss: 1.880 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0091734
	speed: 0.8899s/iter; left time: 28808.4907s
	iters: 200, epoch: 13 | loss: 0.0969102
	speed: 0.2756s/iter; left time: 8895.4545s
	iters: 300, epoch: 13 | loss: 0.0216155
	speed: 0.2776s/iter; left time: 8931.2397s
Epoch: 13 cost time: 102.84020805358887
Epoch: 13, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.859 Vali Acc: 0.659 Test Loss: 1.859 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0298972
	speed: 0.8539s/iter; left time: 27328.9188s
	iters: 200, epoch: 14 | loss: 0.0217186
	speed: 0.2607s/iter; left time: 8316.5223s
	iters: 300, epoch: 14 | loss: 0.1904940
	speed: 0.2706s/iter; left time: 8606.8898s
Epoch: 14 cost time: 98.86107039451599
Epoch: 14, Steps: 369 | Train Loss: 0.179 Vali Loss: 2.200 Vali Acc: 0.654 Test Loss: 2.200 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1921638
	speed: 0.8519s/iter; left time: 26950.8737s
	iters: 200, epoch: 15 | loss: 0.0228276
	speed: 0.2787s/iter; left time: 8787.8771s
	iters: 300, epoch: 15 | loss: 0.0665891
	speed: 0.2681s/iter; left time: 8426.9741s
Epoch: 15 cost time: 99.72900581359863
Epoch: 15, Steps: 369 | Train Loss: 0.173 Vali Loss: 2.067 Vali Acc: 0.650 Test Loss: 2.067 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0659975
	speed: 0.8616s/iter; left time: 26938.9021s
	iters: 200, epoch: 16 | loss: 0.0500427
	speed: 0.2642s/iter; left time: 8234.3967s
	iters: 300, epoch: 16 | loss: 0.1990692
	speed: 0.2568s/iter; left time: 7977.2575s
Epoch: 16 cost time: 98.15240979194641
Epoch: 16, Steps: 369 | Train Loss: 0.165 Vali Loss: 2.219 Vali Acc: 0.648 Test Loss: 2.219 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6640181611804767
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6943030
	speed: 0.2701s/iter; left time: 9939.5887s
	iters: 200, epoch: 1 | loss: 0.6935098
	speed: 0.2501s/iter; left time: 9177.2147s
	iters: 300, epoch: 1 | loss: 0.6931592
	speed: 0.2415s/iter; left time: 8838.1938s
Epoch: 1 cost time: 93.88672494888306
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6936164
	speed: 0.8465s/iter; left time: 30837.8969s
	iters: 200, epoch: 2 | loss: 0.6931488
	speed: 0.2657s/iter; left time: 9654.7542s
	iters: 300, epoch: 2 | loss: 0.6931520
	speed: 0.2649s/iter; left time: 9596.1045s
Epoch: 2 cost time: 98.68319702148438
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6931487
	speed: 0.8873s/iter; left time: 32000.1831s
	iters: 200, epoch: 3 | loss: 0.6941500
	speed: 0.2614s/iter; left time: 9399.5951s
	iters: 300, epoch: 3 | loss: 0.6933793
	speed: 0.2698s/iter; left time: 9675.5764s
Epoch: 3 cost time: 99.08376908302307
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6929383
	speed: 0.8214s/iter; left time: 29319.8903s
	iters: 200, epoch: 4 | loss: 0.6931516
	speed: 0.2575s/iter; left time: 9166.6325s
	iters: 300, epoch: 4 | loss: 0.6930987
	speed: 0.2487s/iter; left time: 8826.2184s
Epoch: 4 cost time: 94.84321713447571
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6925122
	speed: 0.8587s/iter; left time: 30334.2127s
	iters: 200, epoch: 5 | loss: 0.6924756
	speed: 0.2622s/iter; left time: 9236.4909s
	iters: 300, epoch: 5 | loss: 0.6931623
	speed: 0.2644s/iter; left time: 9287.3675s
Epoch: 5 cost time: 98.21600461006165
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6929058
	speed: 0.8610s/iter; left time: 30098.0370s
	iters: 200, epoch: 6 | loss: 0.6931475
	speed: 0.2805s/iter; left time: 9778.4951s
	iters: 300, epoch: 6 | loss: 0.6931582
	speed: 0.2649s/iter; left time: 9207.0795s
Epoch: 6 cost time: 101.20862317085266
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6931956
	speed: 0.8547s/iter; left time: 29562.8151s
	iters: 200, epoch: 7 | loss: 0.6935846
	speed: 0.2645s/iter; left time: 9123.4825s
	iters: 300, epoch: 7 | loss: 0.6927053
	speed: 0.2693s/iter; left time: 9259.7414s
Epoch: 7 cost time: 98.56741166114807
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6931012
	speed: 0.8508s/iter; left time: 29112.2223s
	iters: 200, epoch: 8 | loss: 0.6972543
	speed: 0.2622s/iter; left time: 8946.1669s
	iters: 300, epoch: 8 | loss: 0.6931518
	speed: 0.2571s/iter; left time: 8746.1527s
Epoch: 8 cost time: 97.90713167190552
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6934147
	speed: 0.8649s/iter; left time: 29274.4258s
	iters: 200, epoch: 9 | loss: 0.6932435
	speed: 0.2568s/iter; left time: 8667.0450s
	iters: 300, epoch: 9 | loss: 0.6920039
	speed: 0.2647s/iter; left time: 8908.3328s
Epoch: 9 cost time: 99.37920212745667
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6932313
	speed: 0.8501s/iter; left time: 28459.9814s
	iters: 200, epoch: 10 | loss: 0.6937304
	speed: 0.2620s/iter; left time: 8746.3445s
	iters: 300, epoch: 10 | loss: 0.6923370
	speed: 0.2679s/iter; left time: 8917.0272s
Epoch: 10 cost time: 97.40521097183228
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6930352
	speed: 0.8410s/iter; left time: 27844.7184s
	iters: 200, epoch: 11 | loss: 0.6937161
	speed: 0.2678s/iter; left time: 8839.8239s
	iters: 300, epoch: 11 | loss: 0.6931483
	speed: 0.2735s/iter; left time: 9000.9244s
Epoch: 11 cost time: 100.25771856307983
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6912667
	speed: 0.8568s/iter; left time: 28053.8059s
	iters: 200, epoch: 12 | loss: 0.6931473
	speed: 0.2577s/iter; left time: 8411.7781s
	iters: 300, epoch: 12 | loss: 0.6937267
	speed: 0.2620s/iter; left time: 8527.0119s
Epoch: 12 cost time: 98.09700441360474
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6931665
	speed: 0.8422s/iter; left time: 27265.1798s
	iters: 200, epoch: 13 | loss: 0.6923026
	speed: 0.2765s/iter; left time: 8924.6436s
	iters: 300, epoch: 13 | loss: 0.6944318
	speed: 0.2590s/iter; left time: 8332.7519s
Epoch: 13 cost time: 98.66234517097473
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6955687
	speed: 0.8842s/iter; left time: 28298.7810s
	iters: 200, epoch: 14 | loss: 0.6918232
	speed: 0.2719s/iter; left time: 8674.9940s
	iters: 300, epoch: 14 | loss: 0.6930422
	speed: 0.2714s/iter; left time: 8630.5213s
Epoch: 14 cost time: 100.4672646522522
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6899594
	speed: 0.8671s/iter; left time: 27430.4402s
	iters: 200, epoch: 15 | loss: 0.6951481
	speed: 0.2822s/iter; left time: 8897.8841s
	iters: 300, epoch: 15 | loss: 0.6938207
	speed: 0.2638s/iter; left time: 8292.9628s
Epoch: 15 cost time: 101.7394106388092
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6935046
	speed: 0.8716s/iter; left time: 27250.0204s
	iters: 200, epoch: 16 | loss: 0.6910027
	speed: 0.2615s/iter; left time: 8149.5663s
	iters: 300, epoch: 16 | loss: 0.6925797
	speed: 0.2658s/iter; left time: 8256.6523s
Epoch: 16 cost time: 98.34464526176453
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6910875
	speed: 0.8736s/iter; left time: 26990.1421s
	iters: 200, epoch: 17 | loss: 0.6873935
	speed: 0.2680s/iter; left time: 8252.3802s
	iters: 300, epoch: 17 | loss: 0.6921557
	speed: 0.2700s/iter; left time: 8289.6971s
Epoch: 17 cost time: 99.52251815795898
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.6944907
	speed: 0.8525s/iter; left time: 26024.8927s
	iters: 200, epoch: 18 | loss: 0.6931472
	speed: 0.2645s/iter; left time: 8049.0347s
	iters: 300, epoch: 18 | loss: 0.6940033
	speed: 0.2646s/iter; left time: 8024.9373s
Epoch: 18 cost time: 98.39902853965759
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.6927264
	speed: 0.8415s/iter; left time: 25378.7266s
	iters: 200, epoch: 19 | loss: 0.6899369
	speed: 0.2643s/iter; left time: 7944.0653s
	iters: 300, epoch: 19 | loss: 0.6941581
	speed: 0.2635s/iter; left time: 7893.5998s
Epoch: 19 cost time: 96.65250515937805
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.6930609
	speed: 0.8266s/iter; left time: 24625.3211s
	iters: 200, epoch: 20 | loss: 0.6929382
	speed: 0.2732s/iter; left time: 8110.6478s
	iters: 300, epoch: 20 | loss: 0.6931591
	speed: 0.2675s/iter; left time: 7916.8028s
Epoch: 20 cost time: 99.76943564414978
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.6929102
	speed: 0.8683s/iter; left time: 25545.2607s
	iters: 200, epoch: 21 | loss: 0.6926713
	speed: 0.2619s/iter; left time: 7680.4561s
	iters: 300, epoch: 21 | loss: 0.6915956
	speed: 0.2739s/iter; left time: 8002.7578s
Epoch: 21 cost time: 100.00960326194763
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.6931793
	speed: 0.8695s/iter; left time: 25260.9880s
	iters: 200, epoch: 22 | loss: 0.6948870
	speed: 0.2590s/iter; left time: 7499.3393s
	iters: 300, epoch: 22 | loss: 0.6928464
	speed: 0.2593s/iter; left time: 7482.6900s
Epoch: 22 cost time: 97.94812107086182
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.6931689
	speed: 0.8441s/iter; left time: 24211.5896s
	iters: 200, epoch: 23 | loss: 0.6944039
	speed: 0.2663s/iter; left time: 7612.4375s
	iters: 300, epoch: 23 | loss: 0.6952603
	speed: 0.2614s/iter; left time: 7444.0360s
Epoch: 23 cost time: 97.52002453804016
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.6932549
	speed: 0.8360s/iter; left time: 23670.9656s
	iters: 200, epoch: 24 | loss: 0.6916407
	speed: 0.2523s/iter; left time: 7119.4690s
	iters: 300, epoch: 24 | loss: 0.6913375
	speed: 0.2702s/iter; left time: 7595.2638s
Epoch: 24 cost time: 97.84949398040771
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6941488
	speed: 0.8711s/iter; left time: 24342.6390s
	iters: 200, epoch: 25 | loss: 0.6930290
	speed: 0.2702s/iter; left time: 7524.7407s
	iters: 300, epoch: 25 | loss: 0.6931474
	speed: 0.2695s/iter; left time: 7476.7028s
Epoch: 25 cost time: 101.38642168045044
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.6911318
	speed: 0.8860s/iter; left time: 24432.4177s
	iters: 200, epoch: 26 | loss: 0.6942211
	speed: 0.2753s/iter; left time: 7562.9943s
	iters: 300, epoch: 26 | loss: 0.6931533
	speed: 0.2794s/iter; left time: 7648.9068s
Epoch: 26 cost time: 102.70358896255493
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.6929477
	speed: 0.8543s/iter; left time: 23243.3679s
	iters: 200, epoch: 27 | loss: 0.6939319
	speed: 0.2732s/iter; left time: 7406.6469s
	iters: 300, epoch: 27 | loss: 0.6929007
	speed: 0.2778s/iter; left time: 7501.3179s
Epoch: 27 cost time: 100.98183274269104
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.6941200
	speed: 0.8593s/iter; left time: 23062.1375s
	iters: 200, epoch: 28 | loss: 0.6937149
	speed: 0.2648s/iter; left time: 7079.8536s
	iters: 300, epoch: 28 | loss: 0.6931472
	speed: 0.2776s/iter; left time: 7394.4497s
Epoch: 28 cost time: 100.49638843536377
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 786050
model size : 7.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7278751
	speed: 0.2911s/iter; left time: 10711.9587s
	iters: 200, epoch: 1 | loss: 0.5874938
	speed: 0.2647s/iter; left time: 9714.4940s
	iters: 300, epoch: 1 | loss: 0.4743876
	speed: 0.2665s/iter; left time: 9753.2306s
Epoch: 1 cost time: 100.50773739814758
Epoch: 1, Steps: 369 | Train Loss: 0.662 Vali Loss: 0.754 Vali Acc: 0.645 Test Loss: 0.754 Test Acc: 0.645
Validation loss decreased (inf --> -0.645282).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3093811
	speed: 0.8707s/iter; left time: 31719.8682s
	iters: 200, epoch: 2 | loss: 0.7790547
	speed: 0.2712s/iter; left time: 9852.2166s
	iters: 300, epoch: 2 | loss: 0.4612472
	speed: 0.2663s/iter; left time: 9646.7745s
Epoch: 2 cost time: 101.12844371795654
Epoch: 2, Steps: 369 | Train Loss: 0.509 Vali Loss: 0.750 Vali Acc: 0.685 Test Loss: 0.750 Test Acc: 0.685
Validation loss decreased (-0.645282 --> -0.684726).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3854395
	speed: 0.8548s/iter; left time: 30825.4160s
	iters: 200, epoch: 3 | loss: 1.0574037
	speed: 0.2587s/iter; left time: 9302.1701s
	iters: 300, epoch: 3 | loss: 0.9889206
	speed: 0.2623s/iter; left time: 9405.1084s
Epoch: 3 cost time: 97.08920526504517
Epoch: 3, Steps: 369 | Train Loss: 0.408 Vali Loss: 0.957 Vali Acc: 0.659 Test Loss: 0.957 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3516622
	speed: 0.7988s/iter; left time: 28513.2046s
	iters: 200, epoch: 4 | loss: 0.3208716
	speed: 0.2484s/iter; left time: 8840.5334s
	iters: 300, epoch: 4 | loss: 0.2244606
	speed: 0.2560s/iter; left time: 9087.3917s
Epoch: 4 cost time: 93.06190395355225
Epoch: 4, Steps: 369 | Train Loss: 0.321 Vali Loss: 1.117 Vali Acc: 0.648 Test Loss: 1.117 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1800497
	speed: 0.7989s/iter; left time: 28220.4791s
	iters: 200, epoch: 5 | loss: 1.1088145
	speed: 0.2566s/iter; left time: 9037.0705s
	iters: 300, epoch: 5 | loss: 0.3949797
	speed: 0.2636s/iter; left time: 9257.2835s
Epoch: 5 cost time: 95.60505056381226
Epoch: 5, Steps: 369 | Train Loss: 0.279 Vali Loss: 1.375 Vali Acc: 0.671 Test Loss: 1.375 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2232194
	speed: 0.8312s/iter; left time: 29056.8699s
	iters: 200, epoch: 6 | loss: 0.1570035
	speed: 0.2614s/iter; left time: 9111.3688s
	iters: 300, epoch: 6 | loss: 0.2426155
	speed: 0.2646s/iter; left time: 9194.7414s
Epoch: 6 cost time: 98.77741837501526
Epoch: 6, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.430 Vali Acc: 0.648 Test Loss: 1.430 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2179433
	speed: 0.8322s/iter; left time: 28781.8737s
	iters: 200, epoch: 7 | loss: 0.0729830
	speed: 0.2626s/iter; left time: 9056.7775s
	iters: 300, epoch: 7 | loss: 0.1353374
	speed: 0.2597s/iter; left time: 8930.7426s
Epoch: 7 cost time: 96.22001004219055
Epoch: 7, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.643 Vali Acc: 0.663 Test Loss: 1.643 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0076071
	speed: 0.8439s/iter; left time: 28877.3991s
	iters: 200, epoch: 8 | loss: 0.3701142
	speed: 0.2512s/iter; left time: 8571.2312s
	iters: 300, epoch: 8 | loss: 0.3098275
	speed: 0.2562s/iter; left time: 8715.2571s
Epoch: 8 cost time: 96.9542670249939
Epoch: 8, Steps: 369 | Train Loss: 0.191 Vali Loss: 2.066 Vali Acc: 0.627 Test Loss: 2.066 Test Acc: 0.627
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0126358
	speed: 0.8435s/iter; left time: 28551.9507s
	iters: 200, epoch: 9 | loss: 0.3519534
	speed: 0.2703s/iter; left time: 9123.2918s
	iters: 300, epoch: 9 | loss: 0.3090970
	speed: 0.2677s/iter; left time: 9006.4293s
Epoch: 9 cost time: 101.39718198776245
Epoch: 9, Steps: 369 | Train Loss: 0.200 Vali Loss: 2.136 Vali Acc: 0.650 Test Loss: 2.136 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0689526
	speed: 0.8728s/iter; left time: 29222.5686s
	iters: 200, epoch: 10 | loss: 0.2898701
	speed: 0.2708s/iter; left time: 9039.7023s
	iters: 300, epoch: 10 | loss: 0.0129302
	speed: 0.2760s/iter; left time: 9186.4253s
Epoch: 10 cost time: 103.51858496665955
Epoch: 10, Steps: 369 | Train Loss: 0.180 Vali Loss: 2.022 Vali Acc: 0.651 Test Loss: 2.022 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2523737
	speed: 0.8666s/iter; left time: 28693.7435s
	iters: 200, epoch: 11 | loss: 0.2095471
	speed: 0.2898s/iter; left time: 9565.4804s
	iters: 300, epoch: 11 | loss: 0.0930120
	speed: 0.2690s/iter; left time: 8853.2481s
Epoch: 11 cost time: 103.23267984390259
Epoch: 11, Steps: 369 | Train Loss: 0.174 Vali Loss: 2.243 Vali Acc: 0.652 Test Loss: 2.243 Test Acc: 0.652
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0016534
	speed: 0.8455s/iter; left time: 27681.9605s
	iters: 200, epoch: 12 | loss: 0.1679315
	speed: 0.2727s/iter; left time: 8900.3330s
	iters: 300, epoch: 12 | loss: 0.0161857
	speed: 0.2616s/iter; left time: 8512.3609s
Epoch: 12 cost time: 99.22375988960266
Epoch: 12, Steps: 369 | Train Loss: 0.163 Vali Loss: 2.237 Vali Acc: 0.666 Test Loss: 2.237 Test Acc: 0.666
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.684733257661748
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7582566
	speed: 0.2648s/iter; left time: 9744.7618s
	iters: 200, epoch: 1 | loss: 0.5545824
	speed: 0.2567s/iter; left time: 9421.7690s
	iters: 300, epoch: 1 | loss: 0.5124778
	speed: 0.2551s/iter; left time: 9336.5578s
Epoch: 1 cost time: 94.84908437728882
Epoch: 1, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.766 Vali Acc: 0.646 Test Loss: 0.766 Test Acc: 0.646
Validation loss decreased (inf --> -0.646133).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3781084
	speed: 0.7878s/iter; left time: 28700.8069s
	iters: 200, epoch: 2 | loss: 0.6563748
	speed: 0.2519s/iter; left time: 9151.6088s
	iters: 300, epoch: 2 | loss: 0.5337898
	speed: 0.2538s/iter; left time: 9194.2815s
Epoch: 2 cost time: 94.84166836738586
Epoch: 2, Steps: 369 | Train Loss: 0.511 Vali Loss: 0.778 Vali Acc: 0.682 Test Loss: 0.778 Test Acc: 0.682
Validation loss decreased (-0.646133 --> -0.681888).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4873134
	speed: 0.8267s/iter; left time: 29814.2823s
	iters: 200, epoch: 3 | loss: 1.2170924
	speed: 0.2546s/iter; left time: 9154.5085s
	iters: 300, epoch: 3 | loss: 0.8845376
	speed: 0.2589s/iter; left time: 9284.1700s
Epoch: 3 cost time: 96.57615518569946
Epoch: 3, Steps: 369 | Train Loss: 0.404 Vali Loss: 0.943 Vali Acc: 0.646 Test Loss: 0.943 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3345497
	speed: 0.8078s/iter; left time: 28832.6875s
	iters: 200, epoch: 4 | loss: 0.2405472
	speed: 0.2506s/iter; left time: 8920.6292s
	iters: 300, epoch: 4 | loss: 0.0945969
	speed: 0.2517s/iter; left time: 8934.5737s
Epoch: 4 cost time: 94.93397951126099
Epoch: 4, Steps: 369 | Train Loss: 0.322 Vali Loss: 1.154 Vali Acc: 0.629 Test Loss: 1.154 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1104997
	speed: 0.8051s/iter; left time: 28441.8104s
	iters: 200, epoch: 5 | loss: 0.7206508
	speed: 0.2550s/iter; left time: 8980.9763s
	iters: 300, epoch: 5 | loss: 0.1048963
	speed: 0.2584s/iter; left time: 9075.5133s
Epoch: 5 cost time: 94.56438326835632
Epoch: 5, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.450 Vali Acc: 0.667 Test Loss: 1.450 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3263213
	speed: 0.7796s/iter; left time: 27252.6890s
	iters: 200, epoch: 6 | loss: 0.2480683
	speed: 0.2433s/iter; left time: 8481.3182s
	iters: 300, epoch: 6 | loss: 0.4393896
	speed: 0.2526s/iter; left time: 8780.3727s
Epoch: 6 cost time: 92.10165977478027
Epoch: 6, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.419 Vali Acc: 0.650 Test Loss: 1.419 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5004773
	speed: 0.8073s/iter; left time: 27920.4638s
	iters: 200, epoch: 7 | loss: 0.0802966
	speed: 0.2600s/iter; left time: 8967.7865s
	iters: 300, epoch: 7 | loss: 0.0561122
	speed: 0.2596s/iter; left time: 8927.5331s
Epoch: 7 cost time: 96.56789827346802
Epoch: 7, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.542 Vali Acc: 0.666 Test Loss: 1.542 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0123548
	speed: 0.8156s/iter; left time: 27908.0809s
	iters: 200, epoch: 8 | loss: 0.1508369
	speed: 0.2525s/iter; left time: 8616.0533s
	iters: 300, epoch: 8 | loss: 0.7345927
	speed: 0.2540s/iter; left time: 8638.9935s
Epoch: 8 cost time: 93.87630105018616
Epoch: 8, Steps: 369 | Train Loss: 0.208 Vali Loss: 1.793 Vali Acc: 0.648 Test Loss: 1.793 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1704720
	speed: 0.8208s/iter; left time: 27784.1676s
	iters: 200, epoch: 9 | loss: 0.0530010
	speed: 0.2529s/iter; left time: 8536.5418s
	iters: 300, epoch: 9 | loss: 0.2218567
	speed: 0.2566s/iter; left time: 8634.0700s
Epoch: 9 cost time: 96.33808445930481
Epoch: 9, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.909 Vali Acc: 0.650 Test Loss: 1.909 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0611989
	speed: 0.7807s/iter; left time: 26137.7150s
	iters: 200, epoch: 10 | loss: 0.0309968
	speed: 0.2467s/iter; left time: 8235.4384s
	iters: 300, epoch: 10 | loss: 0.0210664
	speed: 0.2448s/iter; left time: 8146.2503s
Epoch: 10 cost time: 91.82253670692444
Epoch: 10, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.880 Vali Acc: 0.656 Test Loss: 1.880 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.4824145
	speed: 0.8156s/iter; left time: 27006.9312s
	iters: 200, epoch: 11 | loss: 0.3572195
	speed: 0.2560s/iter; left time: 8449.7753s
	iters: 300, epoch: 11 | loss: 0.2282497
	speed: 0.2533s/iter; left time: 8336.7300s
Epoch: 11 cost time: 95.45697808265686
Epoch: 11, Steps: 369 | Train Loss: 0.169 Vali Loss: 2.016 Vali Acc: 0.666 Test Loss: 2.016 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0015523
	speed: 0.8010s/iter; left time: 26226.9039s
	iters: 200, epoch: 12 | loss: 0.1802578
	speed: 0.2501s/iter; left time: 8164.1774s
	iters: 300, epoch: 12 | loss: 0.4282067
	speed: 0.2483s/iter; left time: 8081.3968s
Epoch: 12 cost time: 92.6024432182312
Epoch: 12, Steps: 369 | Train Loss: 0.148 Vali Loss: 2.392 Vali Acc: 0.646 Test Loss: 2.392 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6818955732122588
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6708444
	speed: 0.2741s/iter; left time: 10086.2809s
	iters: 200, epoch: 1 | loss: 0.6102979
	speed: 0.2555s/iter; left time: 9377.2361s
	iters: 300, epoch: 1 | loss: 0.5495849
	speed: 0.2498s/iter; left time: 9143.9441s
Epoch: 1 cost time: 95.88893032073975
Epoch: 1, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.744 Vali Acc: 0.649 Test Loss: 0.744 Test Acc: 0.649
Validation loss decreased (inf --> -0.648687).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3822521
	speed: 0.8136s/iter; left time: 29641.9562s
	iters: 200, epoch: 2 | loss: 0.7480556
	speed: 0.2571s/iter; left time: 9342.5344s
	iters: 300, epoch: 2 | loss: 0.5408823
	speed: 0.2475s/iter; left time: 8966.9437s
Epoch: 2 cost time: 93.78364133834839
Epoch: 2, Steps: 369 | Train Loss: 0.518 Vali Loss: 0.816 Vali Acc: 0.665 Test Loss: 0.816 Test Acc: 0.665
Validation loss decreased (-0.648687 --> -0.664861).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5933696
	speed: 0.8061s/iter; left time: 29069.7109s
	iters: 200, epoch: 3 | loss: 0.8536823
	speed: 0.2451s/iter; left time: 8815.7313s
	iters: 300, epoch: 3 | loss: 0.9028465
	speed: 0.2477s/iter; left time: 8882.1706s
Epoch: 3 cost time: 92.68019986152649
Epoch: 3, Steps: 369 | Train Loss: 0.416 Vali Loss: 0.997 Vali Acc: 0.645 Test Loss: 0.997 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3841437
	speed: 0.7903s/iter; left time: 28207.8883s
	iters: 200, epoch: 4 | loss: 0.2287180
	speed: 0.2382s/iter; left time: 8478.7817s
	iters: 300, epoch: 4 | loss: 0.2430289
	speed: 0.2365s/iter; left time: 8395.8841s
Epoch: 4 cost time: 89.4644103050232
Epoch: 4, Steps: 369 | Train Loss: 0.336 Vali Loss: 1.281 Vali Acc: 0.618 Test Loss: 1.281 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3308063
	speed: 0.7684s/iter; left time: 27143.2630s
	iters: 200, epoch: 5 | loss: 1.0583158
	speed: 0.2367s/iter; left time: 8338.1387s
	iters: 300, epoch: 5 | loss: 0.3932638
	speed: 0.2313s/iter; left time: 8124.1194s
Epoch: 5 cost time: 87.26328301429749
Epoch: 5, Steps: 369 | Train Loss: 0.299 Vali Loss: 1.379 Vali Acc: 0.656 Test Loss: 1.379 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3052600
	speed: 0.7765s/iter; left time: 27144.2463s
	iters: 200, epoch: 6 | loss: 0.0535390
	speed: 0.2371s/iter; left time: 8264.1094s
	iters: 300, epoch: 6 | loss: 0.1976784
	speed: 0.2401s/iter; left time: 8344.9840s
Epoch: 6 cost time: 88.85560417175293
Epoch: 6, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.448 Vali Acc: 0.638 Test Loss: 1.448 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1682823
	speed: 0.7883s/iter; left time: 27263.6092s
	iters: 200, epoch: 7 | loss: 0.0531026
	speed: 0.2405s/iter; left time: 8294.7719s
	iters: 300, epoch: 7 | loss: 0.0163878
	speed: 0.2486s/iter; left time: 8546.9767s
Epoch: 7 cost time: 91.54570603370667
Epoch: 7, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.738 Vali Acc: 0.647 Test Loss: 1.738 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2694586
	speed: 0.8130s/iter; left time: 27820.4107s
	iters: 200, epoch: 8 | loss: 0.0366218
	speed: 0.2375s/iter; left time: 8103.2689s
	iters: 300, epoch: 8 | loss: 0.2386824
	speed: 0.2475s/iter; left time: 8419.5289s
Epoch: 8 cost time: 92.3149995803833
Epoch: 8, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.814 Vali Acc: 0.635 Test Loss: 1.814 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0954838
	speed: 0.7980s/iter; left time: 27010.8745s
	iters: 200, epoch: 9 | loss: 0.3017938
	speed: 0.2647s/iter; left time: 8932.6972s
	iters: 300, epoch: 9 | loss: 0.2104108
	speed: 0.2523s/iter; left time: 8489.2243s
Epoch: 9 cost time: 95.53899264335632
Epoch: 9, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.770 Vali Acc: 0.650 Test Loss: 1.770 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.2639031
	speed: 0.8171s/iter; left time: 27356.8458s
	iters: 200, epoch: 10 | loss: 0.5491300
	speed: 0.2717s/iter; left time: 9068.7316s
	iters: 300, epoch: 10 | loss: 0.1184218
	speed: 0.2616s/iter; left time: 8707.0146s
Epoch: 10 cost time: 96.78642654418945
Epoch: 10, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.933 Vali Acc: 0.641 Test Loss: 1.933 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1282489
	speed: 0.8312s/iter; left time: 27522.5479s
	iters: 200, epoch: 11 | loss: 0.4811678
	speed: 0.2513s/iter; left time: 8294.2460s
	iters: 300, epoch: 11 | loss: 0.1603750
	speed: 0.2551s/iter; left time: 8395.9812s
Epoch: 11 cost time: 95.63173699378967
Epoch: 11, Steps: 369 | Train Loss: 0.163 Vali Loss: 2.204 Vali Acc: 0.657 Test Loss: 2.204 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.4005128
	speed: 0.8263s/iter; left time: 27055.1655s
	iters: 200, epoch: 12 | loss: 0.0659097
	speed: 0.2491s/iter; left time: 8129.9111s
	iters: 300, epoch: 12 | loss: 0.3345495
	speed: 0.2727s/iter; left time: 8873.5040s
Epoch: 12 cost time: 94.71789789199829
Epoch: 12, Steps: 369 | Train Loss: 0.147 Vali Loss: 2.169 Vali Acc: 0.661 Test Loss: 2.169 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6648694665153235
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6757706
	speed: 0.2608s/iter; left time: 9599.2584s
	iters: 200, epoch: 1 | loss: 0.6459185
	speed: 0.2591s/iter; left time: 9509.2387s
	iters: 300, epoch: 1 | loss: 0.6015332
	speed: 0.2463s/iter; left time: 9013.7684s
Epoch: 1 cost time: 93.86704421043396
Epoch: 1, Steps: 369 | Train Loss: 0.692 Vali Loss: 0.754 Vali Acc: 0.644 Test Loss: 0.754 Test Acc: 0.644
Validation loss decreased (inf --> -0.643863).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3795156
	speed: 0.7659s/iter; left time: 27903.9189s
	iters: 200, epoch: 2 | loss: 0.8666564
	speed: 0.2485s/iter; left time: 9029.8260s
	iters: 300, epoch: 2 | loss: 0.5249118
	speed: 0.2394s/iter; left time: 8673.4686s
Epoch: 2 cost time: 88.51979947090149
Epoch: 2, Steps: 369 | Train Loss: 0.532 Vali Loss: 0.784 Vali Acc: 0.667 Test Loss: 0.784 Test Acc: 0.667
Validation loss decreased (-0.643863 --> -0.667416).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6691705
	speed: 0.7865s/iter; left time: 28363.1624s
	iters: 200, epoch: 3 | loss: 0.6192845
	speed: 0.2581s/iter; left time: 9280.7006s
	iters: 300, epoch: 3 | loss: 0.9359913
	speed: 0.2421s/iter; left time: 8682.7195s
Epoch: 3 cost time: 91.80948257446289
Epoch: 3, Steps: 369 | Train Loss: 0.449 Vali Loss: 1.005 Vali Acc: 0.645 Test Loss: 1.005 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5507760
	speed: 0.7915s/iter; left time: 28250.7220s
	iters: 200, epoch: 4 | loss: 0.1979402
	speed: 0.2407s/iter; left time: 8567.1975s
	iters: 300, epoch: 4 | loss: 0.0995161
	speed: 0.2537s/iter; left time: 9005.1994s
Epoch: 4 cost time: 91.9819643497467
Epoch: 4, Steps: 369 | Train Loss: 0.353 Vali Loss: 1.129 Vali Acc: 0.650 Test Loss: 1.129 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3832311
	speed: 0.8012s/iter; left time: 28301.1445s
	iters: 200, epoch: 5 | loss: 1.0091386
	speed: 0.2448s/iter; left time: 8624.3705s
	iters: 300, epoch: 5 | loss: 0.3078622
	speed: 0.2484s/iter; left time: 8725.2634s
Epoch: 5 cost time: 92.01494216918945
Epoch: 5, Steps: 369 | Train Loss: 0.295 Vali Loss: 1.368 Vali Acc: 0.655 Test Loss: 1.368 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1659203
	speed: 0.8205s/iter; left time: 28681.7460s
	iters: 200, epoch: 6 | loss: 0.0378807
	speed: 0.2500s/iter; left time: 8713.3228s
	iters: 300, epoch: 6 | loss: 0.7041025
	speed: 0.2528s/iter; left time: 8786.6845s
Epoch: 6 cost time: 94.51127505302429
Epoch: 6, Steps: 369 | Train Loss: 0.240 Vali Loss: 1.520 Vali Acc: 0.644 Test Loss: 1.520 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3561782
	speed: 0.8075s/iter; left time: 27929.5794s
	iters: 200, epoch: 7 | loss: 0.0964775
	speed: 0.2560s/iter; left time: 8828.0997s
	iters: 300, epoch: 7 | loss: 0.0295589
	speed: 0.2391s/iter; left time: 8223.3979s
Epoch: 7 cost time: 91.55388593673706
Epoch: 7, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.509 Vali Acc: 0.665 Test Loss: 1.509 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0162390
	speed: 0.7956s/iter; left time: 27223.2510s
	iters: 200, epoch: 8 | loss: 0.4243791
	speed: 0.2517s/iter; left time: 8585.8302s
	iters: 300, epoch: 8 | loss: 0.4609522
	speed: 0.2621s/iter; left time: 8915.8163s
Epoch: 8 cost time: 93.25453972816467
Epoch: 8, Steps: 369 | Train Loss: 0.225 Vali Loss: 1.690 Vali Acc: 0.650 Test Loss: 1.690 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1075620
	speed: 0.8088s/iter; left time: 27375.7044s
	iters: 200, epoch: 9 | loss: 0.6206278
	speed: 0.2701s/iter; left time: 9116.6064s
	iters: 300, epoch: 9 | loss: 0.7623915
	speed: 0.2499s/iter; left time: 8410.3157s
Epoch: 9 cost time: 96.11772346496582
Epoch: 9, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.725 Vali Acc: 0.655 Test Loss: 1.725 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0349821
	speed: 0.8282s/iter; left time: 27728.1954s
	iters: 200, epoch: 10 | loss: 0.0062872
	speed: 0.2759s/iter; left time: 9209.4380s
	iters: 300, epoch: 10 | loss: 0.0117044
	speed: 0.2755s/iter; left time: 9169.3992s
Epoch: 10 cost time: 100.27148747444153
Epoch: 10, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.954 Vali Acc: 0.659 Test Loss: 1.954 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0339818
	speed: 0.8145s/iter; left time: 26969.7672s
	iters: 200, epoch: 11 | loss: 0.5808301
	speed: 0.2604s/iter; left time: 8596.5910s
	iters: 300, epoch: 11 | loss: 0.2928368
	speed: 0.2613s/iter; left time: 8598.6006s
Epoch: 11 cost time: 94.98474550247192
Epoch: 11, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.989 Vali Acc: 0.672 Test Loss: 1.989 Test Acc: 0.672
Validation loss decreased (-0.667416 --> -0.671944).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3688379
	speed: 0.8052s/iter; left time: 26362.9235s
	iters: 200, epoch: 12 | loss: 0.3186131
	speed: 0.2461s/iter; left time: 8034.7543s
	iters: 300, epoch: 12 | loss: 0.1437021
	speed: 0.2720s/iter; left time: 8849.8171s
Epoch: 12 cost time: 94.44480657577515
Epoch: 12, Steps: 369 | Train Loss: 0.143 Vali Loss: 2.332 Vali Acc: 0.647 Test Loss: 2.332 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0345424
	speed: 0.8043s/iter; left time: 26038.2584s
	iters: 200, epoch: 13 | loss: 0.2398451
	speed: 0.2680s/iter; left time: 8650.4170s
	iters: 300, epoch: 13 | loss: 0.0089313
	speed: 0.2798s/iter; left time: 9003.2550s
Epoch: 13 cost time: 98.19041776657104
Epoch: 13, Steps: 369 | Train Loss: 0.162 Vali Loss: 2.197 Vali Acc: 0.663 Test Loss: 2.197 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1945209
	speed: 0.8076s/iter; left time: 25845.4586s
	iters: 200, epoch: 14 | loss: 0.0738881
	speed: 0.2424s/iter; left time: 7734.5598s
	iters: 300, epoch: 14 | loss: 0.1841076
	speed: 0.2450s/iter; left time: 7791.0069s
Epoch: 14 cost time: 91.7575933933258
Epoch: 14, Steps: 369 | Train Loss: 0.156 Vali Loss: 2.211 Vali Acc: 0.651 Test Loss: 2.211 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0087785
	speed: 0.8306s/iter; left time: 26277.2248s
	iters: 200, epoch: 15 | loss: 0.0512361
	speed: 0.2424s/iter; left time: 7644.6476s
	iters: 300, epoch: 15 | loss: 0.0279786
	speed: 0.2613s/iter; left time: 8213.3537s
Epoch: 15 cost time: 95.2603051662445
Epoch: 15, Steps: 369 | Train Loss: 0.137 Vali Loss: 2.370 Vali Acc: 0.652 Test Loss: 2.370 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1697160
	speed: 0.8229s/iter; left time: 25727.9755s
	iters: 200, epoch: 16 | loss: 0.0004691
	speed: 0.2604s/iter; left time: 8114.2114s
	iters: 300, epoch: 16 | loss: 0.0893918
	speed: 0.2654s/iter; left time: 8245.9527s
Epoch: 16 cost time: 97.1318747997284
Epoch: 16, Steps: 369 | Train Loss: 0.160 Vali Loss: 2.456 Vali Acc: 0.658 Test Loss: 2.456 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0123435
	speed: 0.8070s/iter; left time: 24932.4812s
	iters: 200, epoch: 17 | loss: 0.0750749
	speed: 0.2377s/iter; left time: 7319.3869s
	iters: 300, epoch: 17 | loss: 0.0945225
	speed: 0.2428s/iter; left time: 7453.8277s
Epoch: 17 cost time: 89.48175811767578
Epoch: 17, Steps: 369 | Train Loss: 0.148 Vali Loss: 2.753 Vali Acc: 0.646 Test Loss: 2.753 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.4530448
	speed: 0.7904s/iter; left time: 24128.8294s
	iters: 200, epoch: 18 | loss: 0.3613935
	speed: 0.2539s/iter; left time: 7725.5501s
	iters: 300, epoch: 18 | loss: 0.0005997
	speed: 0.2375s/iter; left time: 7202.5543s
Epoch: 18 cost time: 92.83269095420837
Epoch: 18, Steps: 369 | Train Loss: 0.147 Vali Loss: 2.448 Vali Acc: 0.653 Test Loss: 2.448 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0091077
	speed: 0.8152s/iter; left time: 24584.1559s
	iters: 200, epoch: 19 | loss: 0.0000849
	speed: 0.2644s/iter; left time: 7948.9839s
	iters: 300, epoch: 19 | loss: 0.5496038
	speed: 0.2468s/iter; left time: 7393.4843s
Epoch: 19 cost time: 95.57981634140015
Epoch: 19, Steps: 369 | Train Loss: 0.133 Vali Loss: 2.678 Vali Acc: 0.661 Test Loss: 2.678 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0774681
	speed: 0.8218s/iter; left time: 24480.5653s
	iters: 200, epoch: 20 | loss: 0.0862688
	speed: 0.2671s/iter; left time: 7930.9114s
	iters: 300, epoch: 20 | loss: 0.0004917
	speed: 0.2638s/iter; left time: 7805.3142s
Epoch: 20 cost time: 98.08985161781311
Epoch: 20, Steps: 369 | Train Loss: 0.110 Vali Loss: 3.088 Vali Acc: 0.656 Test Loss: 3.088 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0022815
	speed: 0.8404s/iter; left time: 24724.1986s
	iters: 200, epoch: 21 | loss: 0.0993271
	speed: 0.2684s/iter; left time: 7868.6781s
	iters: 300, epoch: 21 | loss: 0.1390584
	speed: 0.2823s/iter; left time: 8249.2325s
Epoch: 21 cost time: 100.49602222442627
Epoch: 21, Steps: 369 | Train Loss: 0.138 Vali Loss: 2.737 Vali Acc: 0.644 Test Loss: 2.737 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6719636776390465
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6070482
	speed: 0.2968s/iter; left time: 10923.6528s
	iters: 200, epoch: 1 | loss: 0.7998961
	speed: 0.2560s/iter; left time: 9393.6399s
	iters: 300, epoch: 1 | loss: 0.4206845
	speed: 0.2739s/iter; left time: 10023.2259s
Epoch: 1 cost time: 102.99433016777039
Epoch: 1, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.816 Vali Acc: 0.646 Test Loss: 0.816 Test Acc: 0.646
Validation loss decreased (inf --> -0.645849).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4139324
	speed: 0.8559s/iter; left time: 31181.3993s
	iters: 200, epoch: 2 | loss: 0.7970675
	speed: 0.2653s/iter; left time: 9639.4602s
	iters: 300, epoch: 2 | loss: 0.5722166
	speed: 0.2557s/iter; left time: 9265.7464s
Epoch: 2 cost time: 96.73032474517822
Epoch: 2, Steps: 369 | Train Loss: 0.547 Vali Loss: 0.818 Vali Acc: 0.674 Test Loss: 0.818 Test Acc: 0.674
Validation loss decreased (-0.645849 --> -0.673942).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5821695
	speed: 0.8229s/iter; left time: 29675.6467s
	iters: 200, epoch: 3 | loss: 1.0175183
	speed: 0.2675s/iter; left time: 9618.4254s
	iters: 300, epoch: 3 | loss: 0.8374739
	speed: 0.2592s/iter; left time: 9295.2396s
Epoch: 3 cost time: 96.99798488616943
Epoch: 3, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.987 Vali Acc: 0.657 Test Loss: 0.987 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2216674
	speed: 0.8378s/iter; left time: 29906.1127s
	iters: 200, epoch: 4 | loss: 0.4851436
	speed: 0.2669s/iter; left time: 9500.1519s
	iters: 300, epoch: 4 | loss: 0.2751264
	speed: 0.2687s/iter; left time: 9537.8926s
Epoch: 4 cost time: 99.54452347755432
Epoch: 4, Steps: 369 | Train Loss: 0.346 Vali Loss: 1.123 Vali Acc: 0.633 Test Loss: 1.123 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2361977
	speed: 0.8548s/iter; left time: 30196.7938s
	iters: 200, epoch: 5 | loss: 1.8669734
	speed: 0.2511s/iter; left time: 8843.3509s
	iters: 300, epoch: 5 | loss: 0.2202647
	speed: 0.2569s/iter; left time: 9022.6196s
Epoch: 5 cost time: 94.54463195800781
Epoch: 5, Steps: 369 | Train Loss: 0.309 Vali Loss: 1.427 Vali Acc: 0.661 Test Loss: 1.427 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3450157
	speed: 0.7962s/iter; left time: 27832.0828s
	iters: 200, epoch: 6 | loss: 0.2884555
	speed: 0.2453s/iter; left time: 8551.8916s
	iters: 300, epoch: 6 | loss: 0.0305962
	speed: 0.2425s/iter; left time: 8428.8050s
Epoch: 6 cost time: 91.59737133979797
Epoch: 6, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.500 Vali Acc: 0.634 Test Loss: 1.500 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0712421
	speed: 0.8058s/iter; left time: 27870.2564s
	iters: 200, epoch: 7 | loss: 0.3530027
	speed: 0.2497s/iter; left time: 8612.8658s
	iters: 300, epoch: 7 | loss: 0.0672165
	speed: 0.2508s/iter; left time: 8625.0371s
Epoch: 7 cost time: 93.34854865074158
Epoch: 7, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.577 Vali Acc: 0.657 Test Loss: 1.577 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2569932
	speed: 0.7825s/iter; left time: 26775.5443s
	iters: 200, epoch: 8 | loss: 0.2100430
	speed: 0.2522s/iter; left time: 8604.5523s
	iters: 300, epoch: 8 | loss: 0.3669260
	speed: 0.2433s/iter; left time: 8276.6316s
Epoch: 8 cost time: 91.40837812423706
Epoch: 8, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.852 Vali Acc: 0.633 Test Loss: 1.852 Test Acc: 0.633
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7146037
	speed: 0.8025s/iter; left time: 27165.0694s
	iters: 200, epoch: 9 | loss: 0.0363082
	speed: 0.2699s/iter; left time: 9109.5830s
	iters: 300, epoch: 9 | loss: 0.4364359
	speed: 0.2545s/iter; left time: 8562.8783s
Epoch: 9 cost time: 95.90074515342712
Epoch: 9, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.878 Vali Acc: 0.648 Test Loss: 1.878 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.3278779
	speed: 0.8039s/iter; left time: 26913.3383s
	iters: 200, epoch: 10 | loss: 0.1745241
	speed: 0.2519s/iter; left time: 8407.0425s
	iters: 300, epoch: 10 | loss: 0.0375136
	speed: 0.2567s/iter; left time: 8542.9496s
Epoch: 10 cost time: 93.8452730178833
Epoch: 10, Steps: 369 | Train Loss: 0.174 Vali Loss: 2.134 Vali Acc: 0.654 Test Loss: 2.134 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.5296395
	speed: 0.8204s/iter; left time: 27163.0715s
	iters: 200, epoch: 11 | loss: 0.1169186
	speed: 0.2499s/iter; left time: 8247.8647s
	iters: 300, epoch: 11 | loss: 0.0263446
	speed: 0.2503s/iter; left time: 8237.5529s
Epoch: 11 cost time: 93.74359273910522
Epoch: 11, Steps: 369 | Train Loss: 0.182 Vali Loss: 2.053 Vali Acc: 0.654 Test Loss: 2.053 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0029131
	speed: 0.8104s/iter; left time: 26533.1458s
	iters: 200, epoch: 12 | loss: 0.2472403
	speed: 0.2486s/iter; left time: 8114.2541s
	iters: 300, epoch: 12 | loss: 0.2501617
	speed: 0.2531s/iter; left time: 8236.6080s
Epoch: 12 cost time: 93.01384925842285
Epoch: 12, Steps: 369 | Train Loss: 0.142 Vali Loss: 2.269 Vali Acc: 0.651 Test Loss: 2.269 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.673950056753689
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7247826
	speed: 0.2615s/iter; left time: 9621.6790s
	iters: 200, epoch: 1 | loss: 0.7605563
	speed: 0.2352s/iter; left time: 8631.2954s
	iters: 300, epoch: 1 | loss: 0.4566030
	speed: 0.2424s/iter; left time: 8872.8559s
Epoch: 1 cost time: 91.62242841720581
Epoch: 1, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.779 Vali Acc: 0.639 Test Loss: 0.779 Test Acc: 0.639
Validation loss decreased (inf --> -0.639323).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4940689
	speed: 0.8100s/iter; left time: 29510.4081s
	iters: 200, epoch: 2 | loss: 0.8850197
	speed: 0.2559s/iter; left time: 9297.9259s
	iters: 300, epoch: 2 | loss: 0.4039812
	speed: 0.2582s/iter; left time: 9356.1820s
Epoch: 2 cost time: 94.66128754615784
Epoch: 2, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.847 Vali Acc: 0.670 Test Loss: 0.847 Test Acc: 0.670
Validation loss decreased (-0.639323 --> -0.669969).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6293885
	speed: 0.8067s/iter; left time: 29093.7157s
	iters: 200, epoch: 3 | loss: 1.0482345
	speed: 0.2576s/iter; left time: 9263.6934s
	iters: 300, epoch: 3 | loss: 0.6054096
	speed: 0.2501s/iter; left time: 8969.4500s
Epoch: 3 cost time: 94.67785668373108
Epoch: 3, Steps: 369 | Train Loss: 0.463 Vali Loss: 0.942 Vali Acc: 0.660 Test Loss: 0.942 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4895069
	speed: 0.7955s/iter; left time: 28394.5903s
	iters: 200, epoch: 4 | loss: 0.3756608
	speed: 0.2484s/iter; left time: 8842.6056s
	iters: 300, epoch: 4 | loss: 0.2998623
	speed: 0.2440s/iter; left time: 8659.5665s
Epoch: 4 cost time: 91.45997643470764
Epoch: 4, Steps: 369 | Train Loss: 0.379 Vali Loss: 1.222 Vali Acc: 0.635 Test Loss: 1.222 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3115028
	speed: 0.7854s/iter; left time: 27743.0862s
	iters: 200, epoch: 5 | loss: 0.7929940
	speed: 0.2467s/iter; left time: 8691.5453s
	iters: 300, epoch: 5 | loss: 0.3306077
	speed: 0.2417s/iter; left time: 8491.2618s
Epoch: 5 cost time: 91.02422785758972
Epoch: 5, Steps: 369 | Train Loss: 0.323 Vali Loss: 1.348 Vali Acc: 0.648 Test Loss: 1.348 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3719289
	speed: 0.7864s/iter; left time: 27490.9901s
	iters: 200, epoch: 6 | loss: 0.0649131
	speed: 0.2457s/iter; left time: 8564.2189s
	iters: 300, epoch: 6 | loss: 0.2843733
	speed: 0.2424s/iter; left time: 8425.5482s
Epoch: 6 cost time: 91.0350661277771
Epoch: 6, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.448 Vali Acc: 0.631 Test Loss: 1.448 Test Acc: 0.631
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1911480
	speed: 0.8027s/iter; left time: 27763.3729s
	iters: 200, epoch: 7 | loss: 0.0911737
	speed: 0.2498s/iter; left time: 8616.1642s
	iters: 300, epoch: 7 | loss: 0.0057841
	speed: 0.2473s/iter; left time: 8503.4751s
Epoch: 7 cost time: 92.68762969970703
Epoch: 7, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.758 Vali Acc: 0.657 Test Loss: 1.758 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0849933
	speed: 0.8105s/iter; left time: 27734.1980s
	iters: 200, epoch: 8 | loss: 0.5048752
	speed: 0.2445s/iter; left time: 8341.2153s
	iters: 300, epoch: 8 | loss: 0.3799548
	speed: 0.2457s/iter; left time: 8357.2513s
Epoch: 8 cost time: 91.36512875556946
Epoch: 8, Steps: 369 | Train Loss: 0.204 Vali Loss: 1.657 Vali Acc: 0.634 Test Loss: 1.657 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0179830
	speed: 0.7813s/iter; left time: 26446.7481s
	iters: 200, epoch: 9 | loss: 0.4495349
	speed: 0.2478s/iter; left time: 8363.0015s
	iters: 300, epoch: 9 | loss: 0.0396590
	speed: 0.2468s/iter; left time: 8303.8678s
Epoch: 9 cost time: 91.4109263420105
Epoch: 9, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.790 Vali Acc: 0.647 Test Loss: 1.790 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0783332
	speed: 0.7948s/iter; left time: 26609.6903s
	iters: 200, epoch: 10 | loss: 0.5587612
	speed: 0.2444s/iter; left time: 8158.6399s
	iters: 300, epoch: 10 | loss: 0.1320853
	speed: 0.2501s/iter; left time: 8323.9917s
Epoch: 10 cost time: 92.12287616729736
Epoch: 10, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.792 Vali Acc: 0.667 Test Loss: 1.792 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0005620
	speed: 0.8015s/iter; left time: 26538.9642s
	iters: 200, epoch: 11 | loss: 0.5589510
	speed: 0.2505s/iter; left time: 8267.8912s
	iters: 300, epoch: 11 | loss: 0.0103819
	speed: 0.2498s/iter; left time: 8220.2763s
Epoch: 11 cost time: 92.542560338974
Epoch: 11, Steps: 369 | Train Loss: 0.194 Vali Loss: 2.164 Vali Acc: 0.655 Test Loss: 2.164 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2167015
	speed: 0.7926s/iter; left time: 25950.3863s
	iters: 200, epoch: 12 | loss: 0.3598332
	speed: 0.2519s/iter; left time: 8222.0061s
	iters: 300, epoch: 12 | loss: 0.8294835
	speed: 0.2524s/iter; left time: 8213.8132s
Epoch: 12 cost time: 92.09666442871094
Epoch: 12, Steps: 369 | Train Loss: 0.154 Vali Loss: 2.075 Vali Acc: 0.655 Test Loss: 2.075 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6699772985244041
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6981445
	speed: 0.2841s/iter; left time: 10456.8454s
	iters: 200, epoch: 1 | loss: 0.7008356
	speed: 0.2654s/iter; left time: 9740.3576s
	iters: 300, epoch: 1 | loss: 0.4941373
	speed: 0.2571s/iter; left time: 9410.4667s
Epoch: 1 cost time: 99.12187266349792
Epoch: 1, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.751 Vali Acc: 0.650 Test Loss: 0.751 Test Acc: 0.650
Validation loss decreased (inf --> -0.650390).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4511618
	speed: 0.8456s/iter; left time: 30805.1184s
	iters: 200, epoch: 2 | loss: 0.9198435
	speed: 0.2674s/iter; left time: 9715.8494s
	iters: 300, epoch: 2 | loss: 0.3884848
	speed: 0.2734s/iter; left time: 9906.2244s
Epoch: 2 cost time: 99.15214157104492
Epoch: 2, Steps: 369 | Train Loss: 0.550 Vali Loss: 0.820 Vali Acc: 0.672 Test Loss: 0.820 Test Acc: 0.672
Validation loss decreased (-0.650390 --> -0.671955).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5255586
	speed: 0.8239s/iter; left time: 29711.4017s
	iters: 200, epoch: 3 | loss: 1.0778903
	speed: 0.2505s/iter; left time: 9007.3140s
	iters: 300, epoch: 3 | loss: 0.8642522
	speed: 0.2631s/iter; left time: 9436.2761s
Epoch: 3 cost time: 96.03993892669678
Epoch: 3, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.848 Vali Acc: 0.660 Test Loss: 0.848 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2141751
	speed: 0.8002s/iter; left time: 28561.1742s
	iters: 200, epoch: 4 | loss: 0.5856001
	speed: 0.2553s/iter; left time: 9085.9498s
	iters: 300, epoch: 4 | loss: 0.2091753
	speed: 0.2494s/iter; left time: 8852.7032s
Epoch: 4 cost time: 92.59465217590332
Epoch: 4, Steps: 369 | Train Loss: 0.378 Vali Loss: 1.203 Vali Acc: 0.626 Test Loss: 1.203 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2616614
	speed: 0.7870s/iter; left time: 27802.1133s
	iters: 200, epoch: 5 | loss: 0.9640476
	speed: 0.2686s/iter; left time: 9462.6815s
	iters: 300, epoch: 5 | loss: 0.3254467
	speed: 0.2478s/iter; left time: 8704.9127s
Epoch: 5 cost time: 94.60594367980957
Epoch: 5, Steps: 369 | Train Loss: 0.315 Vali Loss: 1.276 Vali Acc: 0.660 Test Loss: 1.276 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1743661
	speed: 0.8037s/iter; left time: 28094.5403s
	iters: 200, epoch: 6 | loss: 0.3836360
	speed: 0.2512s/iter; left time: 8756.1034s
	iters: 300, epoch: 6 | loss: 0.1318398
	speed: 0.2513s/iter; left time: 8733.7526s
Epoch: 6 cost time: 95.6947546005249
Epoch: 6, Steps: 369 | Train Loss: 0.247 Vali Loss: 1.396 Vali Acc: 0.653 Test Loss: 1.396 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2202378
	speed: 0.8045s/iter; left time: 27824.7794s
	iters: 200, epoch: 7 | loss: 0.2468673
	speed: 0.2437s/iter; left time: 8404.7021s
	iters: 300, epoch: 7 | loss: 0.1358861
	speed: 0.2529s/iter; left time: 8695.3090s
Epoch: 7 cost time: 94.14870643615723
Epoch: 7, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.532 Vali Acc: 0.667 Test Loss: 1.532 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.3082328
	speed: 0.7964s/iter; left time: 27251.7835s
	iters: 200, epoch: 8 | loss: 0.4115234
	speed: 0.2504s/iter; left time: 8541.5668s
	iters: 300, epoch: 8 | loss: 0.2687964
	speed: 0.2420s/iter; left time: 8231.8460s
Epoch: 8 cost time: 92.72416019439697
Epoch: 8, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.646 Vali Acc: 0.643 Test Loss: 1.646 Test Acc: 0.643
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0492592
	speed: 0.7980s/iter; left time: 27010.0050s
	iters: 200, epoch: 9 | loss: 0.1660437
	speed: 0.2440s/iter; left time: 8233.7475s
	iters: 300, epoch: 9 | loss: 0.0737717
	speed: 0.2479s/iter; left time: 8340.5134s
Epoch: 9 cost time: 91.45315861701965
Epoch: 9, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.785 Vali Acc: 0.667 Test Loss: 1.785 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.3623438
	speed: 0.8009s/iter; left time: 26812.6361s
	iters: 200, epoch: 10 | loss: 0.2100977
	speed: 0.2456s/iter; left time: 8198.0018s
	iters: 300, epoch: 10 | loss: 0.0044732
	speed: 0.2529s/iter; left time: 8417.1395s
Epoch: 10 cost time: 93.65724205970764
Epoch: 10, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.704 Vali Acc: 0.665 Test Loss: 1.704 Test Acc: 0.665
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0310841
	speed: 0.7808s/iter; left time: 25854.3785s
	iters: 200, epoch: 11 | loss: 0.4673875
	speed: 0.2487s/iter; left time: 8211.0571s
	iters: 300, epoch: 11 | loss: 0.3155022
	speed: 0.2547s/iter; left time: 8382.9016s
Epoch: 11 cost time: 92.60473680496216
Epoch: 11, Steps: 369 | Train Loss: 0.140 Vali Loss: 2.047 Vali Acc: 0.667 Test Loss: 2.047 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0459302
	speed: 0.7900s/iter; left time: 25865.9546s
	iters: 200, epoch: 12 | loss: 0.1909195
	speed: 0.2468s/iter; left time: 8055.6956s
	iters: 300, epoch: 12 | loss: 0.0131074
	speed: 0.2582s/iter; left time: 8403.5577s
Epoch: 12 cost time: 93.85143232345581
Epoch: 12, Steps: 369 | Train Loss: 0.169 Vali Loss: 2.061 Vali Acc: 0.673 Test Loss: 2.061 Test Acc: 0.673
Validation loss decreased (-0.671955 --> -0.673362).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0008941
	speed: 0.8292s/iter; left time: 26842.8045s
	iters: 200, epoch: 13 | loss: 0.0391528
	speed: 0.2697s/iter; left time: 8703.1044s
	iters: 300, epoch: 13 | loss: 0.2569321
	speed: 0.2653s/iter; left time: 8535.7216s
Epoch: 13 cost time: 99.443932056427
Epoch: 13, Steps: 369 | Train Loss: 0.126 Vali Loss: 2.167 Vali Acc: 0.639 Test Loss: 2.167 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3087658
	speed: 0.8104s/iter; left time: 25936.1238s
	iters: 200, epoch: 14 | loss: 0.4640235
	speed: 0.2483s/iter; left time: 7921.5599s
	iters: 300, epoch: 14 | loss: 0.0370174
	speed: 0.2526s/iter; left time: 8035.2428s
Epoch: 14 cost time: 94.4261679649353
Epoch: 14, Steps: 369 | Train Loss: 0.131 Vali Loss: 2.588 Vali Acc: 0.642 Test Loss: 2.588 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1734972
	speed: 0.8029s/iter; left time: 25398.2647s
	iters: 200, epoch: 15 | loss: 0.0204294
	speed: 0.2492s/iter; left time: 7856.9544s
	iters: 300, epoch: 15 | loss: 0.0948105
	speed: 0.2589s/iter; left time: 8140.0243s
Epoch: 15 cost time: 94.0523247718811
Epoch: 15, Steps: 369 | Train Loss: 0.144 Vali Loss: 2.270 Vali Acc: 0.662 Test Loss: 2.270 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0374841
	speed: 0.8008s/iter; left time: 25037.0535s
	iters: 200, epoch: 16 | loss: 0.2012287
	speed: 0.2553s/iter; left time: 7956.1074s
	iters: 300, epoch: 16 | loss: 0.0083525
	speed: 0.2601s/iter; left time: 8078.8826s
Epoch: 16 cost time: 96.55042219161987
Epoch: 16, Steps: 369 | Train Loss: 0.154 Vali Loss: 2.377 Vali Acc: 0.660 Test Loss: 2.377 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4244046
	speed: 0.8303s/iter; left time: 25655.0575s
	iters: 200, epoch: 17 | loss: 0.0162423
	speed: 0.2547s/iter; left time: 7843.0912s
	iters: 300, epoch: 17 | loss: 0.3740635
	speed: 0.2511s/iter; left time: 7706.9266s
Epoch: 17 cost time: 95.62886476516724
Epoch: 17, Steps: 369 | Train Loss: 0.143 Vali Loss: 2.637 Vali Acc: 0.637 Test Loss: 2.637 Test Acc: 0.637
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2720378
	speed: 0.8336s/iter; left time: 25446.7926s
	iters: 200, epoch: 18 | loss: 0.0107077
	speed: 0.2540s/iter; left time: 7727.8754s
	iters: 300, epoch: 18 | loss: 0.4310861
	speed: 0.2469s/iter; left time: 7487.7515s
Epoch: 18 cost time: 94.03194284439087
Epoch: 18, Steps: 369 | Train Loss: 0.128 Vali Loss: 2.504 Vali Acc: 0.654 Test Loss: 2.504 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0031253
	speed: 0.7752s/iter; left time: 23379.0604s
	iters: 200, epoch: 19 | loss: 0.1836096
	speed: 0.2432s/iter; left time: 7310.5488s
	iters: 300, epoch: 19 | loss: 0.0082478
	speed: 0.2486s/iter; left time: 7447.5443s
Epoch: 19 cost time: 90.3261022567749
Epoch: 19, Steps: 369 | Train Loss: 0.137 Vali Loss: 2.762 Vali Acc: 0.649 Test Loss: 2.762 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0004759
	speed: 0.7795s/iter; left time: 23222.0819s
	iters: 200, epoch: 20 | loss: 0.0021722
	speed: 0.2513s/iter; left time: 7461.0678s
	iters: 300, epoch: 20 | loss: 0.2320815
	speed: 0.2426s/iter; left time: 7178.8756s
Epoch: 20 cost time: 92.8516297340393
Epoch: 20, Steps: 369 | Train Loss: 0.121 Vali Loss: 2.846 Vali Acc: 0.644 Test Loss: 2.846 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0151423
	speed: 0.7960s/iter; left time: 23418.5094s
	iters: 200, epoch: 21 | loss: 0.0968258
	speed: 0.2573s/iter; left time: 7543.5085s
	iters: 300, epoch: 21 | loss: 0.0595649
	speed: 0.2459s/iter; left time: 7184.0096s
Epoch: 21 cost time: 92.73190641403198
Epoch: 21, Steps: 369 | Train Loss: 0.114 Vali Loss: 2.865 Vali Acc: 0.664 Test Loss: 2.865 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0026879
	speed: 0.8344s/iter; left time: 24242.2402s
	iters: 200, epoch: 22 | loss: 0.1402442
	speed: 0.2580s/iter; left time: 7470.5688s
	iters: 300, epoch: 22 | loss: 0.0602412
	speed: 0.2475s/iter; left time: 7139.8585s
Epoch: 22 cost time: 95.31336784362793
Epoch: 22, Steps: 369 | Train Loss: 0.123 Vali Loss: 2.672 Vali Acc: 0.654 Test Loss: 2.672 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6733825198637912
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6940027
	speed: 0.2737s/iter; left time: 10073.9548s
	iters: 200, epoch: 1 | loss: 0.6930709
	speed: 0.2636s/iter; left time: 9675.5271s
	iters: 300, epoch: 1 | loss: 0.6913144
	speed: 0.2461s/iter; left time: 9006.1773s
Epoch: 1 cost time: 96.00078392028809
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6938202
	speed: 0.8125s/iter; left time: 29602.0713s
	iters: 200, epoch: 2 | loss: 0.6937737
	speed: 0.2426s/iter; left time: 8815.3345s
	iters: 300, epoch: 2 | loss: 0.6925316
	speed: 0.2530s/iter; left time: 9167.8481s
Epoch: 2 cost time: 92.81045985221863
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6942590
	speed: 0.7905s/iter; left time: 28508.1083s
	iters: 200, epoch: 3 | loss: 0.6931332
	speed: 0.2375s/iter; left time: 8542.7060s
	iters: 300, epoch: 3 | loss: 0.6933467
	speed: 0.2403s/iter; left time: 8618.8252s
Epoch: 3 cost time: 90.59988713264465
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6940181
	speed: 0.7837s/iter; left time: 27973.6198s
	iters: 200, epoch: 4 | loss: 0.6928815
	speed: 0.2451s/iter; left time: 8723.6139s
	iters: 300, epoch: 4 | loss: 0.6923266
	speed: 0.2445s/iter; left time: 8676.8407s
Epoch: 4 cost time: 91.98686099052429
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6926217
	speed: 0.7792s/iter; left time: 27525.4875s
	iters: 200, epoch: 5 | loss: 0.6931713
	speed: 0.2498s/iter; left time: 8800.7322s
	iters: 300, epoch: 5 | loss: 0.6917945
	speed: 0.2464s/iter; left time: 8655.9740s
Epoch: 5 cost time: 91.71528768539429
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6894052
	speed: 0.7853s/iter; left time: 27450.0242s
	iters: 200, epoch: 6 | loss: 0.6936181
	speed: 0.2479s/iter; left time: 8639.1629s
	iters: 300, epoch: 6 | loss: 0.6957676
	speed: 0.2440s/iter; left time: 8479.9252s
Epoch: 6 cost time: 92.1888267993927
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6931574
	speed: 0.8034s/iter; left time: 27788.6105s
	iters: 200, epoch: 7 | loss: 0.6924913
	speed: 0.2569s/iter; left time: 8857.9960s
	iters: 300, epoch: 7 | loss: 0.6901960
	speed: 0.2677s/iter; left time: 9203.7830s
Epoch: 7 cost time: 96.49991154670715
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6926382
	speed: 0.7953s/iter; left time: 27212.7299s
	iters: 200, epoch: 8 | loss: 0.6919468
	speed: 0.2661s/iter; left time: 9079.4141s
	iters: 300, epoch: 8 | loss: 0.6931500
	speed: 0.2648s/iter; left time: 9007.6190s
Epoch: 8 cost time: 99.14897155761719
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6875246
	speed: 0.8305s/iter; left time: 28110.7984s
	iters: 200, epoch: 9 | loss: 0.6931724
	speed: 0.2468s/iter; left time: 8329.7773s
	iters: 300, epoch: 9 | loss: 0.6931687
	speed: 0.2439s/iter; left time: 8208.4833s
Epoch: 9 cost time: 93.39317870140076
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6932044
	speed: 0.8013s/iter; left time: 26829.0756s
	iters: 200, epoch: 10 | loss: 0.6932252
	speed: 0.2630s/iter; left time: 8778.7587s
	iters: 300, epoch: 10 | loss: 0.6932115
	speed: 0.2596s/iter; left time: 8639.1425s
Epoch: 10 cost time: 97.24345111846924
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6917928
	speed: 0.8004s/iter; left time: 26501.4008s
	iters: 200, epoch: 11 | loss: 0.6931474
	speed: 0.2524s/iter; left time: 8331.4913s
	iters: 300, epoch: 11 | loss: 0.6925790
	speed: 0.2550s/iter; left time: 8390.9118s
Epoch: 11 cost time: 93.21076917648315
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6926444
	speed: 0.7989s/iter; left time: 26156.2069s
	iters: 200, epoch: 12 | loss: 0.6934834
	speed: 0.2524s/iter; left time: 8240.2826s
	iters: 300, epoch: 12 | loss: 0.6919025
	speed: 0.2501s/iter; left time: 8139.3581s
Epoch: 12 cost time: 93.89899444580078
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6931892
	speed: 0.8030s/iter; left time: 25994.9390s
	iters: 200, epoch: 13 | loss: 0.6931763
	speed: 0.2520s/iter; left time: 8133.7307s
	iters: 300, epoch: 13 | loss: 0.6918914
	speed: 0.2461s/iter; left time: 7918.2639s
Epoch: 13 cost time: 93.28477931022644
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6926868
	speed: 0.7958s/iter; left time: 25468.3051s
	iters: 200, epoch: 14 | loss: 0.6929554
	speed: 0.2589s/iter; left time: 8259.6897s
	iters: 300, epoch: 14 | loss: 0.6923862
	speed: 0.2498s/iter; left time: 7944.8321s
Epoch: 14 cost time: 94.26578116416931
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.6896201
	speed: 0.8156s/iter; left time: 25801.1612s
	iters: 200, epoch: 15 | loss: 0.6919656
	speed: 0.2636s/iter; left time: 8312.8510s
	iters: 300, epoch: 15 | loss: 0.6958277
	speed: 0.2522s/iter; left time: 7927.7884s
Epoch: 15 cost time: 96.01455307006836
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.6911432
	speed: 0.7841s/iter; left time: 24514.7042s
	iters: 200, epoch: 16 | loss: 0.6910200
	speed: 0.2483s/iter; left time: 7737.4329s
	iters: 300, epoch: 16 | loss: 0.6937462
	speed: 0.2497s/iter; left time: 7756.5043s
Epoch: 16 cost time: 91.71744012832642
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 687746
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5845031
	speed: 0.2822s/iter; left time: 10385.7885s
	iters: 200, epoch: 1 | loss: 0.7526067
	speed: 0.2539s/iter; left time: 9319.4894s
	iters: 300, epoch: 1 | loss: 0.4559966
	speed: 0.2584s/iter; left time: 9458.4032s
Epoch: 1 cost time: 97.14937019348145
Epoch: 1, Steps: 369 | Train Loss: 0.652 Vali Loss: 0.716 Vali Acc: 0.631 Test Loss: 0.716 Test Acc: 0.631
Validation loss decreased (inf --> -0.630526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5241158
	speed: 0.7663s/iter; left time: 27916.8675s
	iters: 200, epoch: 2 | loss: 0.8579211
	speed: 0.2577s/iter; left time: 9361.9981s
	iters: 300, epoch: 2 | loss: 0.5507327
	speed: 0.2443s/iter; left time: 8849.7129s
Epoch: 2 cost time: 91.74137926101685
Epoch: 2, Steps: 369 | Train Loss: 0.541 Vali Loss: 0.668 Vali Acc: 0.669 Test Loss: 0.668 Test Acc: 0.669
Validation loss decreased (-0.630526 --> -0.669403).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1969204
	speed: 0.7796s/iter; left time: 28115.9573s
	iters: 200, epoch: 3 | loss: 0.2931767
	speed: 0.2585s/iter; left time: 9296.9672s
	iters: 300, epoch: 3 | loss: 0.5091904
	speed: 0.2494s/iter; left time: 8944.0678s
Epoch: 3 cost time: 93.53619265556335
Epoch: 3, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.774 Vali Acc: 0.642 Test Loss: 0.774 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6380687
	speed: 0.7885s/iter; left time: 28144.5374s
	iters: 200, epoch: 4 | loss: 0.5400648
	speed: 0.2728s/iter; left time: 9711.5066s
	iters: 300, epoch: 4 | loss: 0.2369547
	speed: 0.2583s/iter; left time: 9168.6266s
Epoch: 4 cost time: 97.8162579536438
Epoch: 4, Steps: 369 | Train Loss: 0.444 Vali Loss: 0.857 Vali Acc: 0.656 Test Loss: 0.857 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2322293
	speed: 0.8030s/iter; left time: 28366.8579s
	iters: 200, epoch: 5 | loss: 0.2045909
	speed: 0.2606s/iter; left time: 9180.5558s
	iters: 300, epoch: 5 | loss: 0.3364408
	speed: 0.2587s/iter; left time: 9088.5814s
Epoch: 5 cost time: 96.76667189598083
Epoch: 5, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.900 Vali Acc: 0.659 Test Loss: 0.900 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2031322
	speed: 0.7756s/iter; left time: 27110.2746s
	iters: 200, epoch: 6 | loss: 0.4507881
	speed: 0.2508s/iter; left time: 8740.8844s
	iters: 300, epoch: 6 | loss: 0.1899566
	speed: 0.2514s/iter; left time: 8736.5809s
Epoch: 6 cost time: 92.27596950531006
Epoch: 6, Steps: 369 | Train Loss: 0.353 Vali Loss: 1.033 Vali Acc: 0.666 Test Loss: 1.033 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1537661
	speed: 0.7746s/iter; left time: 26789.6115s
	iters: 200, epoch: 7 | loss: 0.2846449
	speed: 0.2356s/iter; left time: 8125.3343s
	iters: 300, epoch: 7 | loss: 0.3435523
	speed: 0.2464s/iter; left time: 8474.1464s
Epoch: 7 cost time: 90.67001104354858
Epoch: 7, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.059 Vali Acc: 0.675 Test Loss: 1.059 Test Acc: 0.675
Validation loss decreased (-0.669403 --> -0.674507).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3462541
	speed: 0.7828s/iter; left time: 26784.8734s
	iters: 200, epoch: 8 | loss: 0.2307710
	speed: 0.2483s/iter; left time: 8471.9364s
	iters: 300, epoch: 8 | loss: 0.3791980
	speed: 0.2596s/iter; left time: 8831.1909s
Epoch: 8 cost time: 95.74090790748596
Epoch: 8, Steps: 369 | Train Loss: 0.250 Vali Loss: 1.201 Vali Acc: 0.653 Test Loss: 1.201 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0353675
	speed: 0.7901s/iter; left time: 26743.9590s
	iters: 200, epoch: 9 | loss: 0.0336237
	speed: 0.2585s/iter; left time: 8725.4727s
	iters: 300, epoch: 9 | loss: 0.4056163
	speed: 0.2662s/iter; left time: 8956.3667s
Epoch: 9 cost time: 95.92243766784668
Epoch: 9, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.311 Vali Acc: 0.662 Test Loss: 1.311 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1068480
	speed: 0.8215s/iter; left time: 27502.1947s
	iters: 200, epoch: 10 | loss: 0.0604342
	speed: 0.2587s/iter; left time: 8634.0970s
	iters: 300, epoch: 10 | loss: 0.0428493
	speed: 0.2601s/iter; left time: 8657.3402s
Epoch: 10 cost time: 97.0606701374054
Epoch: 10, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.431 Vali Acc: 0.658 Test Loss: 1.431 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0197307
	speed: 0.7968s/iter; left time: 26381.6976s
	iters: 200, epoch: 11 | loss: 0.1643563
	speed: 0.2589s/iter; left time: 8546.4521s
	iters: 300, epoch: 11 | loss: 0.1901909
	speed: 0.2478s/iter; left time: 8156.3264s
Epoch: 11 cost time: 94.14046001434326
Epoch: 11, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.619 Vali Acc: 0.665 Test Loss: 1.619 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1636425
	speed: 0.7660s/iter; left time: 25079.5811s
	iters: 200, epoch: 12 | loss: 0.1931021
	speed: 0.2705s/iter; left time: 8829.3582s
	iters: 300, epoch: 12 | loss: 0.5185226
	speed: 0.2465s/iter; left time: 8021.2759s
Epoch: 12 cost time: 94.12900876998901
Epoch: 12, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.629 Vali Acc: 0.654 Test Loss: 1.629 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0412925
	speed: 0.7843s/iter; left time: 25389.0147s
	iters: 200, epoch: 13 | loss: 0.0647425
	speed: 0.2560s/iter; left time: 8261.4992s
	iters: 300, epoch: 13 | loss: 0.1884606
	speed: 0.2439s/iter; left time: 7848.0534s
Epoch: 13 cost time: 95.54521346092224
Epoch: 13, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.732 Vali Acc: 0.647 Test Loss: 1.732 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1140266
	speed: 0.7882s/iter; left time: 25226.9249s
	iters: 200, epoch: 14 | loss: 0.1017755
	speed: 0.2471s/iter; left time: 7883.5414s
	iters: 300, epoch: 14 | loss: 0.1379176
	speed: 0.2576s/iter; left time: 8192.2734s
Epoch: 14 cost time: 93.70054054260254
Epoch: 14, Steps: 369 | Train Loss: 0.094 Vali Loss: 1.935 Vali Acc: 0.667 Test Loss: 1.935 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0353919
	speed: 0.8002s/iter; left time: 25315.7683s
	iters: 200, epoch: 15 | loss: 0.2066758
	speed: 0.2587s/iter; left time: 8158.8300s
	iters: 300, epoch: 15 | loss: 0.0116454
	speed: 0.2672s/iter; left time: 8397.9803s
Epoch: 15 cost time: 97.85680150985718
Epoch: 15, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.957 Vali Acc: 0.657 Test Loss: 1.957 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0646622
	speed: 0.7910s/iter; left time: 24731.2272s
	iters: 200, epoch: 16 | loss: 0.0095355
	speed: 0.2560s/iter; left time: 7979.0115s
	iters: 300, epoch: 16 | loss: 0.0093117
	speed: 0.2600s/iter; left time: 8075.8340s
Epoch: 16 cost time: 94.5942895412445
Epoch: 16, Steps: 369 | Train Loss: 0.086 Vali Loss: 1.991 Vali Acc: 0.647 Test Loss: 1.991 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1509462
	speed: 0.7814s/iter; left time: 24143.9130s
	iters: 200, epoch: 17 | loss: 0.0031181
	speed: 0.2513s/iter; left time: 7738.2177s
	iters: 300, epoch: 17 | loss: 0.0218620
	speed: 0.2379s/iter; left time: 7301.6651s
Epoch: 17 cost time: 89.85552644729614
Epoch: 17, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.143 Vali Acc: 0.649 Test Loss: 2.143 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5997613
	speed: 0.2405s/iter; left time: 8851.3411s
	iters: 200, epoch: 1 | loss: 0.6811210
	speed: 0.2319s/iter; left time: 8511.6649s
	iters: 300, epoch: 1 | loss: 0.3983821
	speed: 0.2251s/iter; left time: 8239.2306s
Epoch: 1 cost time: 85.871737241745
Epoch: 1, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.714 Vali Acc: 0.619 Test Loss: 0.714 Test Acc: 0.619
Validation loss decreased (inf --> -0.619459).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5850014
	speed: 0.7340s/iter; left time: 26741.8331s
	iters: 200, epoch: 2 | loss: 0.6864629
	speed: 0.2192s/iter; left time: 7965.4515s
	iters: 300, epoch: 2 | loss: 0.5018914
	speed: 0.2314s/iter; left time: 8383.0455s
Epoch: 2 cost time: 84.07639598846436
Epoch: 2, Steps: 369 | Train Loss: 0.544 Vali Loss: 0.670 Vali Acc: 0.662 Test Loss: 0.670 Test Acc: 0.662
Validation loss decreased (-0.619459 --> -0.662309).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2635275
	speed: 0.7422s/iter; left time: 26764.4618s
	iters: 200, epoch: 3 | loss: 0.2380750
	speed: 0.2340s/iter; left time: 8414.5024s
	iters: 300, epoch: 3 | loss: 0.3320378
	speed: 0.2413s/iter; left time: 8654.2645s
Epoch: 3 cost time: 87.61124014854431
Epoch: 3, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.716 Vali Acc: 0.671 Test Loss: 0.716 Test Acc: 0.671
Validation loss decreased (-0.662309 --> -0.671389).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7008572
	speed: 0.7662s/iter; left time: 27350.4433s
	iters: 200, epoch: 4 | loss: 0.5473169
	speed: 0.2372s/iter; left time: 8444.2862s
	iters: 300, epoch: 4 | loss: 0.2726803
	speed: 0.2400s/iter; left time: 8518.9976s
Epoch: 4 cost time: 88.88401007652283
Epoch: 4, Steps: 369 | Train Loss: 0.433 Vali Loss: 0.796 Vali Acc: 0.669 Test Loss: 0.796 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3769267
	speed: 0.7676s/iter; left time: 27116.2706s
	iters: 200, epoch: 5 | loss: 0.2858359
	speed: 0.2369s/iter; left time: 8345.6076s
	iters: 300, epoch: 5 | loss: 0.4605846
	speed: 0.2296s/iter; left time: 8065.3991s
Epoch: 5 cost time: 86.85487532615662
Epoch: 5, Steps: 369 | Train Loss: 0.397 Vali Loss: 0.967 Vali Acc: 0.651 Test Loss: 0.967 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1681466
	speed: 0.7449s/iter; left time: 26037.1017s
	iters: 200, epoch: 6 | loss: 0.5799416
	speed: 0.2345s/iter; left time: 8174.1245s
	iters: 300, epoch: 6 | loss: 0.4902514
	speed: 0.2399s/iter; left time: 8338.4690s
Epoch: 6 cost time: 87.3544864654541
Epoch: 6, Steps: 369 | Train Loss: 0.347 Vali Loss: 0.955 Vali Acc: 0.666 Test Loss: 0.955 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1512680
	speed: 0.7469s/iter; left time: 25833.9444s
	iters: 200, epoch: 7 | loss: 0.4487524
	speed: 0.2324s/iter; left time: 8014.3637s
	iters: 300, epoch: 7 | loss: 0.2922714
	speed: 0.2274s/iter; left time: 7819.6968s
Epoch: 7 cost time: 86.28297281265259
Epoch: 7, Steps: 369 | Train Loss: 0.308 Vali Loss: 1.044 Vali Acc: 0.654 Test Loss: 1.044 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2874134
	speed: 0.7668s/iter; left time: 26237.9912s
	iters: 200, epoch: 8 | loss: 0.1448967
	speed: 0.2348s/iter; left time: 8009.3041s
	iters: 300, epoch: 8 | loss: 0.2847537
	speed: 0.2425s/iter; left time: 8248.7413s
Epoch: 8 cost time: 88.3703100681305
Epoch: 8, Steps: 369 | Train Loss: 0.265 Vali Loss: 1.098 Vali Acc: 0.670 Test Loss: 1.098 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0551713
	speed: 0.7804s/iter; left time: 26414.1355s
	iters: 200, epoch: 9 | loss: 0.0516406
	speed: 0.2367s/iter; left time: 7988.4056s
	iters: 300, epoch: 9 | loss: 0.4845392
	speed: 0.2421s/iter; left time: 8147.8898s
Epoch: 9 cost time: 89.83087658882141
Epoch: 9, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.275 Vali Acc: 0.668 Test Loss: 1.275 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0305574
	speed: 0.8005s/iter; left time: 26801.8184s
	iters: 200, epoch: 10 | loss: 0.0431143
	speed: 0.2422s/iter; left time: 8085.6786s
	iters: 300, epoch: 10 | loss: 0.1696332
	speed: 0.2407s/iter; left time: 8010.4014s
Epoch: 10 cost time: 91.37752413749695
Epoch: 10, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.280 Vali Acc: 0.663 Test Loss: 1.280 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0169948
	speed: 0.7713s/iter; left time: 25539.9198s
	iters: 200, epoch: 11 | loss: 0.1377943
	speed: 0.2379s/iter; left time: 7852.2223s
	iters: 300, epoch: 11 | loss: 0.1946784
	speed: 0.2313s/iter; left time: 7611.6269s
Epoch: 11 cost time: 87.23879337310791
Epoch: 11, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.509 Vali Acc: 0.672 Test Loss: 1.509 Test Acc: 0.672
Validation loss decreased (-0.671389 --> -0.672232).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2736956
	speed: 0.7334s/iter; left time: 24014.2924s
	iters: 200, epoch: 12 | loss: 0.2356412
	speed: 0.2302s/iter; left time: 7514.8065s
	iters: 300, epoch: 12 | loss: 0.2518438
	speed: 0.2235s/iter; left time: 7271.8241s
Epoch: 12 cost time: 83.80113935470581
Epoch: 12, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.542 Vali Acc: 0.657 Test Loss: 1.542 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0358053
	speed: 0.7436s/iter; left time: 24071.3011s
	iters: 200, epoch: 13 | loss: 0.0250715
	speed: 0.2357s/iter; left time: 7607.1995s
	iters: 300, epoch: 13 | loss: 0.6591545
	speed: 0.2335s/iter; left time: 7512.6254s
Epoch: 13 cost time: 86.6323709487915
Epoch: 13, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.761 Vali Acc: 0.659 Test Loss: 1.761 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0781879
	speed: 0.7519s/iter; left time: 24064.1643s
	iters: 200, epoch: 14 | loss: 0.0651125
	speed: 0.2353s/iter; left time: 7507.9031s
	iters: 300, epoch: 14 | loss: 0.0143918
	speed: 0.2416s/iter; left time: 7684.2005s
Epoch: 14 cost time: 88.49419260025024
Epoch: 14, Steps: 369 | Train Loss: 0.104 Vali Loss: 1.768 Vali Acc: 0.656 Test Loss: 1.768 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0143380
	speed: 0.7615s/iter; left time: 24089.3014s
	iters: 200, epoch: 15 | loss: 0.0072779
	speed: 0.2377s/iter; left time: 7495.8439s
	iters: 300, epoch: 15 | loss: 0.0138675
	speed: 0.2342s/iter; left time: 7360.7836s
Epoch: 15 cost time: 87.48105192184448
Epoch: 15, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.903 Vali Acc: 0.670 Test Loss: 1.903 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0206305
	speed: 0.7750s/iter; left time: 24230.1703s
	iters: 200, epoch: 16 | loss: 0.0371610
	speed: 0.2402s/iter; left time: 7486.6421s
	iters: 300, epoch: 16 | loss: 0.4726595
	speed: 0.2337s/iter; left time: 7260.8853s
Epoch: 16 cost time: 88.5066249370575
Epoch: 16, Steps: 369 | Train Loss: 0.088 Vali Loss: 1.982 Vali Acc: 0.670 Test Loss: 1.982 Test Acc: 0.670
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0014779
	speed: 0.7636s/iter; left time: 23591.4269s
	iters: 200, epoch: 17 | loss: 0.1166465
	speed: 0.2317s/iter; left time: 7135.5643s
	iters: 300, epoch: 17 | loss: 0.0895098
	speed: 0.2382s/iter; left time: 7310.9347s
Epoch: 17 cost time: 87.69044876098633
Epoch: 17, Steps: 369 | Train Loss: 0.084 Vali Loss: 2.067 Vali Acc: 0.669 Test Loss: 2.067 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1582757
	speed: 0.7615s/iter; left time: 23247.7070s
	iters: 200, epoch: 18 | loss: 0.0303217
	speed: 0.2405s/iter; left time: 7316.5192s
	iters: 300, epoch: 18 | loss: 0.0086935
	speed: 0.2305s/iter; left time: 6989.8825s
Epoch: 18 cost time: 87.13054013252258
Epoch: 18, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.157 Vali Acc: 0.674 Test Loss: 2.157 Test Acc: 0.674
Validation loss decreased (-0.672232 --> -0.674212).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0187294
	speed: 0.7402s/iter; left time: 22323.9125s
	iters: 200, epoch: 19 | loss: 0.0002017
	speed: 0.2293s/iter; left time: 6892.6974s
	iters: 300, epoch: 19 | loss: 0.0052398
	speed: 0.2333s/iter; left time: 6989.2740s
Epoch: 19 cost time: 86.5248532295227
Epoch: 19, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.209 Vali Acc: 0.656 Test Loss: 2.209 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0010455
	speed: 0.7644s/iter; left time: 22770.5692s
	iters: 200, epoch: 20 | loss: 0.0039903
	speed: 0.2313s/iter; left time: 6866.6474s
	iters: 300, epoch: 20 | loss: 0.0189573
	speed: 0.2318s/iter; left time: 6857.4912s
Epoch: 20 cost time: 87.12507319450378
Epoch: 20, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.266 Vali Acc: 0.661 Test Loss: 2.266 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0849517
	speed: 0.7653s/iter; left time: 22515.8782s
	iters: 200, epoch: 21 | loss: 0.3174304
	speed: 0.2421s/iter; left time: 7099.4127s
	iters: 300, epoch: 21 | loss: 0.0405580
	speed: 0.2340s/iter; left time: 6838.1501s
Epoch: 21 cost time: 88.24254941940308
Epoch: 21, Steps: 369 | Train Loss: 0.079 Vali Loss: 2.424 Vali Acc: 0.646 Test Loss: 2.424 Test Acc: 0.646
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.4297855
	speed: 0.7540s/iter; left time: 21906.2204s
	iters: 200, epoch: 22 | loss: 0.0010698
	speed: 0.2389s/iter; left time: 6916.6040s
	iters: 300, epoch: 22 | loss: 0.0775110
	speed: 0.2378s/iter; left time: 6861.9629s
Epoch: 22 cost time: 88.18735146522522
Epoch: 22, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.171 Vali Acc: 0.669 Test Loss: 2.171 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1690634
	speed: 0.7726s/iter; left time: 22159.7545s
	iters: 200, epoch: 23 | loss: 0.0045380
	speed: 0.2451s/iter; left time: 7005.3373s
	iters: 300, epoch: 23 | loss: 0.0082483
	speed: 0.2389s/iter; left time: 6804.7898s
Epoch: 23 cost time: 88.8754312992096
Epoch: 23, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.202 Vali Acc: 0.654 Test Loss: 2.202 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0042237
	speed: 0.7444s/iter; left time: 21077.6697s
	iters: 200, epoch: 24 | loss: 0.2126788
	speed: 0.2378s/iter; left time: 6708.4557s
	iters: 300, epoch: 24 | loss: 0.0000432
	speed: 0.2393s/iter; left time: 6727.2711s
Epoch: 24 cost time: 87.27221703529358
Epoch: 24, Steps: 369 | Train Loss: 0.067 Vali Loss: 2.422 Vali Acc: 0.648 Test Loss: 2.422 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0104403
	speed: 0.7552s/iter; left time: 21104.4059s
	iters: 200, epoch: 25 | loss: 0.0034061
	speed: 0.2423s/iter; left time: 6746.2528s
	iters: 300, epoch: 25 | loss: 0.0336926
	speed: 0.2313s/iter; left time: 6416.4800s
Epoch: 25 cost time: 88.53800749778748
Epoch: 25, Steps: 369 | Train Loss: 0.053 Vali Loss: 2.626 Vali Acc: 0.657 Test Loss: 2.626 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0053226
	speed: 0.7391s/iter; left time: 20380.3840s
	iters: 200, epoch: 26 | loss: 0.0019273
	speed: 0.2330s/iter; left time: 6401.5028s
	iters: 300, epoch: 26 | loss: 0.0023940
	speed: 0.2241s/iter; left time: 6135.1488s
Epoch: 26 cost time: 86.640545129776
Epoch: 26, Steps: 369 | Train Loss: 0.065 Vali Loss: 2.554 Vali Acc: 0.652 Test Loss: 2.554 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0051953
	speed: 0.7511s/iter; left time: 20434.7222s
	iters: 200, epoch: 27 | loss: 0.0078495
	speed: 0.2313s/iter; left time: 6268.5391s
	iters: 300, epoch: 27 | loss: 0.0047243
	speed: 0.2339s/iter; left time: 6317.7348s
Epoch: 27 cost time: 86.52936506271362
Epoch: 27, Steps: 369 | Train Loss: 0.059 Vali Loss: 2.672 Vali Acc: 0.671 Test Loss: 2.672 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0869759
	speed: 0.7505s/iter; left time: 20142.6168s
	iters: 200, epoch: 28 | loss: 0.0001078
	speed: 0.2327s/iter; left time: 6221.6306s
	iters: 300, epoch: 28 | loss: 0.0474940
	speed: 0.2475s/iter; left time: 6592.6954s
Epoch: 28 cost time: 88.85194802284241
Epoch: 28, Steps: 369 | Train Loss: 0.051 Vali Loss: 2.587 Vali Acc: 0.665 Test Loss: 2.587 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.674233825198638
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5694317
	speed: 0.2753s/iter; left time: 10132.7073s
	iters: 200, epoch: 1 | loss: 0.7034439
	speed: 0.2562s/iter; left time: 9403.2644s
	iters: 300, epoch: 1 | loss: 0.4911334
	speed: 0.2561s/iter; left time: 9373.8803s
Epoch: 1 cost time: 96.67193388938904
Epoch: 1, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.740 Vali Acc: 0.605 Test Loss: 0.740 Test Acc: 0.605
Validation loss decreased (inf --> -0.604987).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5881054
	speed: 0.8096s/iter; left time: 29494.2049s
	iters: 200, epoch: 2 | loss: 0.9273472
	speed: 0.2709s/iter; left time: 9843.1580s
	iters: 300, epoch: 2 | loss: 0.3813191
	speed: 0.2717s/iter; left time: 9843.5047s
Epoch: 2 cost time: 98.99131464958191
Epoch: 2, Steps: 369 | Train Loss: 0.549 Vali Loss: 0.716 Vali Acc: 0.650 Test Loss: 0.716 Test Acc: 0.650
Validation loss decreased (-0.604987 --> -0.649539).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2071436
	speed: 0.8454s/iter; left time: 30487.8045s
	iters: 200, epoch: 3 | loss: 0.4025082
	speed: 0.2739s/iter; left time: 9850.4309s
	iters: 300, epoch: 3 | loss: 0.4950678
	speed: 0.2771s/iter; left time: 9937.9255s
Epoch: 3 cost time: 101.76169490814209
Epoch: 3, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.714 Vali Acc: 0.659 Test Loss: 0.714 Test Acc: 0.659
Validation loss decreased (-0.649539 --> -0.659471).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7135066
	speed: 0.8547s/iter; left time: 30509.3078s
	iters: 200, epoch: 4 | loss: 0.5767489
	speed: 0.2698s/iter; left time: 9602.9893s
	iters: 300, epoch: 4 | loss: 0.2730077
	speed: 0.2668s/iter; left time: 9469.1061s
Epoch: 4 cost time: 100.57126903533936
Epoch: 4, Steps: 369 | Train Loss: 0.437 Vali Loss: 0.822 Vali Acc: 0.673 Test Loss: 0.822 Test Acc: 0.673
Validation loss decreased (-0.659471 --> -0.672807).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2655625
	speed: 0.8626s/iter; left time: 30471.5403s
	iters: 200, epoch: 5 | loss: 0.4235786
	speed: 0.2716s/iter; left time: 9568.8366s
	iters: 300, epoch: 5 | loss: 0.2134857
	speed: 0.2683s/iter; left time: 9422.4588s
Epoch: 5 cost time: 100.3268723487854
Epoch: 5, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.913 Vali Acc: 0.651 Test Loss: 0.913 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1719594
	speed: 0.8432s/iter; left time: 29474.6805s
	iters: 200, epoch: 6 | loss: 0.3896482
	speed: 0.2711s/iter; left time: 9451.1080s
	iters: 300, epoch: 6 | loss: 0.2725631
	speed: 0.2562s/iter; left time: 8905.8641s
Epoch: 6 cost time: 98.49031448364258
Epoch: 6, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.972 Vali Acc: 0.669 Test Loss: 0.972 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2141441
	speed: 0.8181s/iter; left time: 28297.1941s
	iters: 200, epoch: 7 | loss: 0.2952236
	speed: 0.2653s/iter; left time: 9149.4933s
	iters: 300, epoch: 7 | loss: 0.1486056
	speed: 0.2699s/iter; left time: 9280.1804s
Epoch: 7 cost time: 97.39769554138184
Epoch: 7, Steps: 369 | Train Loss: 0.309 Vali Loss: 1.003 Vali Acc: 0.663 Test Loss: 1.003 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0815123
	speed: 0.8307s/iter; left time: 28425.5657s
	iters: 200, epoch: 8 | loss: 0.0291318
	speed: 0.2574s/iter; left time: 8781.2667s
	iters: 300, epoch: 8 | loss: 0.5733985
	speed: 0.2650s/iter; left time: 9014.9551s
Epoch: 8 cost time: 96.5186722278595
Epoch: 8, Steps: 369 | Train Loss: 0.253 Vali Loss: 1.207 Vali Acc: 0.654 Test Loss: 1.207 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0568699
	speed: 0.8268s/iter; left time: 27985.7380s
	iters: 200, epoch: 9 | loss: 0.0539372
	speed: 0.2497s/iter; left time: 8426.2875s
	iters: 300, epoch: 9 | loss: 0.2304699
	speed: 0.2511s/iter; left time: 8450.5048s
Epoch: 9 cost time: 95.50775623321533
Epoch: 9, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.215 Vali Acc: 0.655 Test Loss: 1.215 Test Acc: 0.655
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0542774
	speed: 0.8272s/iter; left time: 27695.2222s
	iters: 200, epoch: 10 | loss: 0.1571373
	speed: 0.2562s/iter; left time: 8551.8410s
	iters: 300, epoch: 10 | loss: 0.0927606
	speed: 0.2560s/iter; left time: 8519.4590s
Epoch: 10 cost time: 95.9682297706604
Epoch: 10, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.305 Vali Acc: 0.659 Test Loss: 1.305 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1246629
	speed: 0.8464s/iter; left time: 28024.0103s
	iters: 200, epoch: 11 | loss: 0.0394759
	speed: 0.2647s/iter; left time: 8738.7509s
	iters: 300, epoch: 11 | loss: 0.0558466
	speed: 0.2445s/iter; left time: 8045.9472s
Epoch: 11 cost time: 96.92914390563965
Epoch: 11, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.605 Vali Acc: 0.651 Test Loss: 1.605 Test Acc: 0.651
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1845013
	speed: 0.8077s/iter; left time: 26444.3111s
	iters: 200, epoch: 12 | loss: 0.1545357
	speed: 0.2558s/iter; left time: 8348.2406s
	iters: 300, epoch: 12 | loss: 0.0475682
	speed: 0.2567s/iter; left time: 8353.9980s
Epoch: 12 cost time: 94.33508467674255
Epoch: 12, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.501 Vali Acc: 0.658 Test Loss: 1.501 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0672550
	speed: 0.8146s/iter; left time: 26370.4703s
	iters: 200, epoch: 13 | loss: 0.0592192
	speed: 0.2584s/iter; left time: 8340.8786s
	iters: 300, epoch: 13 | loss: 0.6142839
	speed: 0.2559s/iter; left time: 8233.2375s
Epoch: 13 cost time: 95.80710649490356
Epoch: 13, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.621 Vali Acc: 0.642 Test Loss: 1.621 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0075684
	speed: 0.8103s/iter; left time: 25932.3811s
	iters: 200, epoch: 14 | loss: 0.3184042
	speed: 0.2510s/iter; left time: 8009.2678s
	iters: 300, epoch: 14 | loss: 0.0164135
	speed: 0.2501s/iter; left time: 7955.3703s
Epoch: 14 cost time: 92.46762943267822
Epoch: 14, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.820 Vali Acc: 0.651 Test Loss: 1.820 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6466110
	speed: 0.2602s/iter; left time: 9576.4364s
	iters: 200, epoch: 1 | loss: 0.6913156
	speed: 0.2419s/iter; left time: 8879.4919s
	iters: 300, epoch: 1 | loss: 0.5062287
	speed: 0.2511s/iter; left time: 9191.0004s
Epoch: 1 cost time: 92.81005644798279
Epoch: 1, Steps: 369 | Train Loss: 0.694 Vali Loss: 0.712 Vali Acc: 0.618 Test Loss: 0.712 Test Acc: 0.618
Validation loss decreased (inf --> -0.618041).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5014483
	speed: 0.7900s/iter; left time: 28781.8239s
	iters: 200, epoch: 2 | loss: 1.0404894
	speed: 0.2413s/iter; left time: 8768.6431s
	iters: 300, epoch: 2 | loss: 0.5456628
	speed: 0.2479s/iter; left time: 8980.5795s
Epoch: 2 cost time: 90.70698642730713
Epoch: 2, Steps: 369 | Train Loss: 0.564 Vali Loss: 0.712 Vali Acc: 0.659 Test Loss: 0.712 Test Acc: 0.659
Validation loss decreased (-0.618041 --> -0.658619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3556548
	speed: 0.7825s/iter; left time: 28220.0510s
	iters: 200, epoch: 3 | loss: 0.3139032
	speed: 0.2446s/iter; left time: 8798.2491s
	iters: 300, epoch: 3 | loss: 0.3602398
	speed: 0.2532s/iter; left time: 9080.6473s
Epoch: 3 cost time: 93.15032649040222
Epoch: 3, Steps: 369 | Train Loss: 0.505 Vali Loss: 0.731 Vali Acc: 0.648 Test Loss: 0.731 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7420709
	speed: 0.8048s/iter; left time: 28727.5481s
	iters: 200, epoch: 4 | loss: 0.4227592
	speed: 0.2433s/iter; left time: 8661.3763s
	iters: 300, epoch: 4 | loss: 0.4590145
	speed: 0.2478s/iter; left time: 8795.9680s
Epoch: 4 cost time: 91.12607192993164
Epoch: 4, Steps: 369 | Train Loss: 0.456 Vali Loss: 0.854 Vali Acc: 0.646 Test Loss: 0.854 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.3398620
	speed: 0.7735s/iter; left time: 27323.9232s
	iters: 200, epoch: 5 | loss: 0.4234856
	speed: 0.2406s/iter; left time: 8474.7633s
	iters: 300, epoch: 5 | loss: 0.2108127
	speed: 0.2400s/iter; left time: 8431.4305s
Epoch: 5 cost time: 89.80127096176147
Epoch: 5, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.927 Vali Acc: 0.649 Test Loss: 0.927 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4942567
	speed: 0.7720s/iter; left time: 26987.1880s
	iters: 200, epoch: 6 | loss: 0.2304469
	speed: 0.2524s/iter; left time: 8799.3402s
	iters: 300, epoch: 6 | loss: 0.4732216
	speed: 0.2396s/iter; left time: 8326.1959s
Epoch: 6 cost time: 91.59309363365173
Epoch: 6, Steps: 369 | Train Loss: 0.360 Vali Loss: 0.991 Vali Acc: 0.685 Test Loss: 0.991 Test Acc: 0.685
Validation loss decreased (-0.658619 --> -0.684723).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0679425
	speed: 0.8017s/iter; left time: 27727.8513s
	iters: 200, epoch: 7 | loss: 0.5205752
	speed: 0.2487s/iter; left time: 8578.4262s
	iters: 300, epoch: 7 | loss: 0.2068939
	speed: 0.2411s/iter; left time: 8291.8535s
Epoch: 7 cost time: 91.0448842048645
Epoch: 7, Steps: 369 | Train Loss: 0.317 Vali Loss: 1.029 Vali Acc: 0.653 Test Loss: 1.029 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3049697
	speed: 0.7804s/iter; left time: 26703.0849s
	iters: 200, epoch: 8 | loss: 0.3056448
	speed: 0.2508s/iter; left time: 8557.2724s
	iters: 300, epoch: 8 | loss: 0.3940556
	speed: 0.2467s/iter; left time: 8393.7064s
Epoch: 8 cost time: 91.87945866584778
Epoch: 8, Steps: 369 | Train Loss: 0.263 Vali Loss: 1.196 Vali Acc: 0.645 Test Loss: 1.196 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0427173
	speed: 0.7946s/iter; left time: 26895.2799s
	iters: 200, epoch: 9 | loss: 0.0239772
	speed: 0.2516s/iter; left time: 8492.7599s
	iters: 300, epoch: 9 | loss: 0.2678447
	speed: 0.2548s/iter; left time: 8573.3843s
Epoch: 9 cost time: 93.51036310195923
Epoch: 9, Steps: 369 | Train Loss: 0.222 Vali Loss: 1.221 Vali Acc: 0.661 Test Loss: 1.221 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0892728
	speed: 0.8100s/iter; left time: 27118.1405s
	iters: 200, epoch: 10 | loss: 0.3975348
	speed: 0.2513s/iter; left time: 8389.5279s
	iters: 300, epoch: 10 | loss: 0.0553840
	speed: 0.2530s/iter; left time: 8419.8044s
Epoch: 10 cost time: 94.01422810554504
Epoch: 10, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.375 Vali Acc: 0.662 Test Loss: 1.375 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1778332
	speed: 0.8092s/iter; left time: 26793.8016s
	iters: 200, epoch: 11 | loss: 0.0163129
	speed: 0.2635s/iter; left time: 8697.1284s
	iters: 300, epoch: 11 | loss: 0.1412731
	speed: 0.2506s/iter; left time: 8247.0933s
Epoch: 11 cost time: 98.04364728927612
Epoch: 11, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.576 Vali Acc: 0.677 Test Loss: 1.576 Test Acc: 0.677
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0458804
	speed: 0.8439s/iter; left time: 27632.0126s
	iters: 200, epoch: 12 | loss: 0.0260850
	speed: 0.2749s/iter; left time: 8971.7883s
	iters: 300, epoch: 12 | loss: 0.4640357
	speed: 0.2589s/iter; left time: 8423.8624s
Epoch: 12 cost time: 98.52793049812317
Epoch: 12, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.629 Vali Acc: 0.641 Test Loss: 1.629 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0154272
	speed: 0.8396s/iter; left time: 27179.9350s
	iters: 200, epoch: 13 | loss: 0.0076931
	speed: 0.2681s/iter; left time: 8653.2067s
	iters: 300, epoch: 13 | loss: 0.1050560
	speed: 0.2666s/iter; left time: 8578.5830s
Epoch: 13 cost time: 99.45621919631958
Epoch: 13, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.778 Vali Acc: 0.656 Test Loss: 1.778 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3272099
	speed: 0.8379s/iter; left time: 26815.5843s
	iters: 200, epoch: 14 | loss: 0.2941883
	speed: 0.2646s/iter; left time: 8440.8009s
	iters: 300, epoch: 14 | loss: 0.0032175
	speed: 0.2710s/iter; left time: 8618.1253s
Epoch: 14 cost time: 98.1012179851532
Epoch: 14, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.900 Vali Acc: 0.661 Test Loss: 1.900 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0276513
	speed: 0.8559s/iter; left time: 27075.5750s
	iters: 200, epoch: 15 | loss: 0.0883537
	speed: 0.2635s/iter; left time: 8309.5416s
	iters: 300, epoch: 15 | loss: 0.0047447
	speed: 0.2536s/iter; left time: 7971.1063s
Epoch: 15 cost time: 97.95734286308289
Epoch: 15, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.962 Vali Acc: 0.654 Test Loss: 1.962 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0218683
	speed: 0.8359s/iter; left time: 26134.7672s
	iters: 200, epoch: 16 | loss: 0.0078110
	speed: 0.2603s/iter; left time: 8114.0160s
	iters: 300, epoch: 16 | loss: 0.1564842
	speed: 0.2771s/iter; left time: 8609.1361s
Epoch: 16 cost time: 100.03924942016602
Epoch: 16, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.108 Vali Acc: 0.677 Test Loss: 2.108 Test Acc: 0.677
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.684733257661748
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7825025
	speed: 0.2882s/iter; left time: 10605.2247s
	iters: 200, epoch: 1 | loss: 0.6201729
	speed: 0.2598s/iter; left time: 9536.4781s
	iters: 300, epoch: 1 | loss: 0.6433408
	speed: 0.2582s/iter; left time: 9449.4979s
Epoch: 1 cost time: 98.6933331489563
Epoch: 1, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.728 Vali Acc: 0.610 Test Loss: 0.728 Test Acc: 0.610
Validation loss decreased (inf --> -0.609527).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5285705
	speed: 0.8197s/iter; left time: 29864.4045s
	iters: 200, epoch: 2 | loss: 1.2641076
	speed: 0.2466s/iter; left time: 8958.3511s
	iters: 300, epoch: 2 | loss: 0.4881731
	speed: 0.2550s/iter; left time: 9240.7062s
Epoch: 2 cost time: 94.55120754241943
Epoch: 2, Steps: 369 | Train Loss: 0.566 Vali Loss: 0.727 Vali Acc: 0.657 Test Loss: 0.727 Test Acc: 0.657
Validation loss decreased (-0.609527 --> -0.657200).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3895056
	speed: 0.8061s/iter; left time: 29072.0176s
	iters: 200, epoch: 3 | loss: 0.1881766
	speed: 0.2548s/iter; left time: 9161.5768s
	iters: 300, epoch: 3 | loss: 0.3066764
	speed: 0.2506s/iter; left time: 8985.5822s
Epoch: 3 cost time: 94.12078976631165
Epoch: 3, Steps: 369 | Train Loss: 0.499 Vali Loss: 0.717 Vali Acc: 0.671 Test Loss: 0.717 Test Acc: 0.671
Validation loss decreased (-0.657200 --> -0.670538).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5419007
	speed: 0.8202s/iter; left time: 29276.4145s
	iters: 200, epoch: 4 | loss: 0.4109655
	speed: 0.2574s/iter; left time: 9163.0898s
	iters: 300, epoch: 4 | loss: 0.4949884
	speed: 0.2507s/iter; left time: 8899.3587s
Epoch: 4 cost time: 94.92249631881714
Epoch: 4, Steps: 369 | Train Loss: 0.448 Vali Loss: 0.801 Vali Acc: 0.673 Test Loss: 0.801 Test Acc: 0.673
Validation loss decreased (-0.670538 --> -0.673091).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4273006
	speed: 0.8188s/iter; left time: 28924.4166s
	iters: 200, epoch: 5 | loss: 0.2319998
	speed: 0.2525s/iter; left time: 8893.1595s
	iters: 300, epoch: 5 | loss: 0.3006696
	speed: 0.2609s/iter; left time: 9165.0986s
Epoch: 5 cost time: 95.14723086357117
Epoch: 5, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.891 Vali Acc: 0.675 Test Loss: 0.891 Test Acc: 0.675
Validation loss decreased (-0.673091 --> -0.675360).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3544784
	speed: 0.8122s/iter; left time: 28390.2449s
	iters: 200, epoch: 6 | loss: 0.2832711
	speed: 0.2649s/iter; left time: 9233.4926s
	iters: 300, epoch: 6 | loss: 0.3124935
	speed: 0.2532s/iter; left time: 8800.1332s
Epoch: 6 cost time: 95.73159003257751
Epoch: 6, Steps: 369 | Train Loss: 0.367 Vali Loss: 1.016 Vali Acc: 0.657 Test Loss: 1.016 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2495487
	speed: 0.7939s/iter; left time: 27460.2840s
	iters: 200, epoch: 7 | loss: 0.6357707
	speed: 0.2529s/iter; left time: 8721.1897s
	iters: 300, epoch: 7 | loss: 0.2208095
	speed: 0.2453s/iter; left time: 8434.6204s
Epoch: 7 cost time: 92.36886596679688
Epoch: 7, Steps: 369 | Train Loss: 0.331 Vali Loss: 1.066 Vali Acc: 0.680 Test Loss: 1.066 Test Acc: 0.680
Validation loss decreased (-0.675360 --> -0.680466).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2553523
	speed: 0.7821s/iter; left time: 26761.5291s
	iters: 200, epoch: 8 | loss: 0.2269724
	speed: 0.2332s/iter; left time: 7955.8779s
	iters: 300, epoch: 8 | loss: 0.5132149
	speed: 0.2452s/iter; left time: 8342.1019s
Epoch: 8 cost time: 89.65214157104492
Epoch: 8, Steps: 369 | Train Loss: 0.281 Vali Loss: 1.106 Vali Acc: 0.655 Test Loss: 1.106 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2582246
	speed: 0.7753s/iter; left time: 26242.2183s
	iters: 200, epoch: 9 | loss: 0.0404405
	speed: 0.2451s/iter; left time: 8272.9337s
	iters: 300, epoch: 9 | loss: 0.6263287
	speed: 0.2407s/iter; left time: 8097.7950s
Epoch: 9 cost time: 90.41713452339172
Epoch: 9, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.172 Vali Acc: 0.664 Test Loss: 1.172 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0477250
	speed: 0.7668s/iter; left time: 25672.6181s
	iters: 200, epoch: 10 | loss: 0.1772889
	speed: 0.2397s/iter; left time: 8002.4248s
	iters: 300, epoch: 10 | loss: 0.0483346
	speed: 0.2444s/iter; left time: 8134.5892s
Epoch: 10 cost time: 90.61662793159485
Epoch: 10, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.368 Vali Acc: 0.671 Test Loss: 1.368 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1879384
	speed: 0.7800s/iter; left time: 25827.7824s
	iters: 200, epoch: 11 | loss: 0.0184734
	speed: 0.2309s/iter; left time: 7622.2892s
	iters: 300, epoch: 11 | loss: 0.4408371
	speed: 0.2477s/iter; left time: 8151.6244s
Epoch: 11 cost time: 88.91158771514893
Epoch: 11, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.575 Vali Acc: 0.652 Test Loss: 1.575 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4182124
	speed: 0.7640s/iter; left time: 25016.4902s
	iters: 200, epoch: 12 | loss: 0.5202705
	speed: 0.2427s/iter; left time: 7923.5383s
	iters: 300, epoch: 12 | loss: 0.1927882
	speed: 0.2388s/iter; left time: 7772.1838s
Epoch: 12 cost time: 89.28005647659302
Epoch: 12, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.561 Vali Acc: 0.656 Test Loss: 1.561 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1170157
	speed: 0.7887s/iter; left time: 25533.9528s
	iters: 200, epoch: 13 | loss: 0.0551390
	speed: 0.2502s/iter; left time: 8075.1843s
	iters: 300, epoch: 13 | loss: 0.4805928
	speed: 0.2456s/iter; left time: 7901.8135s
Epoch: 13 cost time: 92.3262574672699
Epoch: 13, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.634 Vali Acc: 0.657 Test Loss: 1.634 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0138939
	speed: 0.8063s/iter; left time: 25805.2020s
	iters: 200, epoch: 14 | loss: 0.0070874
	speed: 0.2469s/iter; left time: 7876.5122s
	iters: 300, epoch: 14 | loss: 0.0081879
	speed: 0.2507s/iter; left time: 7974.6196s
Epoch: 14 cost time: 92.7102906703949
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.805 Vali Acc: 0.670 Test Loss: 1.805 Test Acc: 0.670
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1028421
	speed: 0.8087s/iter; left time: 25584.2096s
	iters: 200, epoch: 15 | loss: 0.0412230
	speed: 0.2530s/iter; left time: 7977.3078s
	iters: 300, epoch: 15 | loss: 0.0064507
	speed: 0.2473s/iter; left time: 7774.8817s
Epoch: 15 cost time: 93.34838342666626
Epoch: 15, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.827 Vali Acc: 0.673 Test Loss: 1.827 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0031246
	speed: 0.7886s/iter; left time: 24655.3893s
	iters: 200, epoch: 16 | loss: 0.0089820
	speed: 0.2379s/iter; left time: 7413.8266s
	iters: 300, epoch: 16 | loss: 0.0538384
	speed: 0.2402s/iter; left time: 7463.5595s
Epoch: 16 cost time: 88.4385154247284
Epoch: 16, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.994 Vali Acc: 0.646 Test Loss: 1.994 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0917259
	speed: 0.7526s/iter; left time: 23253.6771s
	iters: 200, epoch: 17 | loss: 0.0160443
	speed: 0.2344s/iter; left time: 7219.3649s
	iters: 300, epoch: 17 | loss: 0.0077551
	speed: 0.2287s/iter; left time: 7021.7041s
Epoch: 17 cost time: 86.27373099327087
Epoch: 17, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.982 Vali Acc: 0.656 Test Loss: 1.982 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6804767309875142
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8051515
	speed: 0.2630s/iter; left time: 9679.3636s
	iters: 200, epoch: 1 | loss: 0.6901032
	speed: 0.2477s/iter; left time: 9090.8420s
	iters: 300, epoch: 1 | loss: 0.6744481
	speed: 0.2473s/iter; left time: 9051.0127s
Epoch: 1 cost time: 93.42344069480896
Epoch: 1, Steps: 369 | Train Loss: 0.709 Vali Loss: 0.740 Vali Acc: 0.603 Test Loss: 0.740 Test Acc: 0.603
Validation loss decreased (inf --> -0.603001).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4183494
	speed: 0.7797s/iter; left time: 28404.6481s
	iters: 200, epoch: 2 | loss: 0.9800640
	speed: 0.2364s/iter; left time: 8587.8886s
	iters: 300, epoch: 2 | loss: 0.4709561
	speed: 0.2477s/iter; left time: 8973.0419s
Epoch: 2 cost time: 91.60471391677856
Epoch: 2, Steps: 369 | Train Loss: 0.581 Vali Loss: 0.713 Vali Acc: 0.663 Test Loss: 0.713 Test Acc: 0.663
Validation loss decreased (-0.603001 --> -0.663443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3161038
	speed: 0.7769s/iter; left time: 28015.6636s
	iters: 200, epoch: 3 | loss: 0.2475130
	speed: 0.2508s/iter; left time: 9019.1669s
	iters: 300, epoch: 3 | loss: 0.3184362
	speed: 0.2442s/iter; left time: 8756.6627s
Epoch: 3 cost time: 93.03845977783203
Epoch: 3, Steps: 369 | Train Loss: 0.520 Vali Loss: 0.719 Vali Acc: 0.667 Test Loss: 0.719 Test Acc: 0.667
Validation loss decreased (-0.663443 --> -0.667132).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5846911
	speed: 0.7841s/iter; left time: 27986.0292s
	iters: 200, epoch: 4 | loss: 0.7386000
	speed: 0.2500s/iter; left time: 8898.3640s
	iters: 300, epoch: 4 | loss: 0.1624932
	speed: 0.2500s/iter; left time: 8874.8333s
Epoch: 4 cost time: 93.91576504707336
Epoch: 4, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.790 Vali Acc: 0.676 Test Loss: 0.790 Test Acc: 0.676
Validation loss decreased (-0.667132 --> -0.675645).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5738724
	speed: 0.7906s/iter; left time: 27927.7254s
	iters: 200, epoch: 5 | loss: 0.2308293
	speed: 0.2593s/iter; left time: 9134.5235s
	iters: 300, epoch: 5 | loss: 0.3071477
	speed: 0.2582s/iter; left time: 9069.8835s
Epoch: 5 cost time: 95.02961540222168
Epoch: 5, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.832 Vali Acc: 0.670 Test Loss: 0.832 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3145315
	speed: 0.7983s/iter; left time: 27905.0366s
	iters: 200, epoch: 6 | loss: 0.2523710
	speed: 0.2563s/iter; left time: 8934.5405s
	iters: 300, epoch: 6 | loss: 0.3262091
	speed: 0.2683s/iter; left time: 9325.1008s
Epoch: 6 cost time: 97.39183235168457
Epoch: 6, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.900 Vali Acc: 0.677 Test Loss: 0.900 Test Acc: 0.677
Validation loss decreased (-0.675645 --> -0.677063).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2162813
	speed: 0.8199s/iter; left time: 28356.7833s
	iters: 200, epoch: 7 | loss: 0.4213595
	speed: 0.2606s/iter; left time: 8988.3686s
	iters: 300, epoch: 7 | loss: 0.2587403
	speed: 0.2586s/iter; left time: 8892.6428s
Epoch: 7 cost time: 96.35565376281738
Epoch: 7, Steps: 369 | Train Loss: 0.339 Vali Loss: 0.967 Vali Acc: 0.663 Test Loss: 0.967 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3480159
	speed: 0.8070s/iter; left time: 27614.2342s
	iters: 200, epoch: 8 | loss: 0.1203515
	speed: 0.2577s/iter; left time: 8793.1525s
	iters: 300, epoch: 8 | loss: 0.3294529
	speed: 0.2585s/iter; left time: 8795.0063s
Epoch: 8 cost time: 96.1466965675354
Epoch: 8, Steps: 369 | Train Loss: 0.287 Vali Loss: 1.193 Vali Acc: 0.657 Test Loss: 1.193 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0563212
	speed: 0.8018s/iter; left time: 27140.4187s
	iters: 200, epoch: 9 | loss: 0.0677793
	speed: 0.2553s/iter; left time: 8614.9014s
	iters: 300, epoch: 9 | loss: 0.7749866
	speed: 0.2501s/iter; left time: 8416.0189s
Epoch: 9 cost time: 94.83423066139221
Epoch: 9, Steps: 369 | Train Loss: 0.248 Vali Loss: 1.164 Vali Acc: 0.643 Test Loss: 1.164 Test Acc: 0.643
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0570571
	speed: 0.8050s/iter; left time: 26951.8670s
	iters: 200, epoch: 10 | loss: 0.1544263
	speed: 0.2492s/iter; left time: 8317.1057s
	iters: 300, epoch: 10 | loss: 0.2974484
	speed: 0.2522s/iter; left time: 8391.7239s
Epoch: 10 cost time: 95.93582916259766
Epoch: 10, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.282 Vali Acc: 0.648 Test Loss: 1.282 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1570037
	speed: 0.7811s/iter; left time: 25861.4338s
	iters: 200, epoch: 11 | loss: 0.1794909
	speed: 0.2505s/iter; left time: 8270.6875s
	iters: 300, epoch: 11 | loss: 0.1297534
	speed: 0.2613s/iter; left time: 8600.5786s
Epoch: 11 cost time: 94.33437085151672
Epoch: 11, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.411 Vali Acc: 0.658 Test Loss: 1.411 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1086261
	speed: 0.7629s/iter; left time: 24980.1660s
	iters: 200, epoch: 12 | loss: 0.0785429
	speed: 0.2412s/iter; left time: 7874.6472s
	iters: 300, epoch: 12 | loss: 0.0835411
	speed: 0.2453s/iter; left time: 7981.4896s
Epoch: 12 cost time: 90.89698600769043
Epoch: 12, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.463 Vali Acc: 0.661 Test Loss: 1.463 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1975286
	speed: 0.7631s/iter; left time: 24704.9185s
	iters: 200, epoch: 13 | loss: 0.0517991
	speed: 0.2509s/iter; left time: 8097.1606s
	iters: 300, epoch: 13 | loss: 0.0793028
	speed: 0.2515s/iter; left time: 8092.4856s
Epoch: 13 cost time: 92.6721248626709
Epoch: 13, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.522 Vali Acc: 0.660 Test Loss: 1.522 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0156471
	speed: 0.8026s/iter; left time: 25685.8367s
	iters: 200, epoch: 14 | loss: 0.1201260
	speed: 0.2616s/iter; left time: 8347.3110s
	iters: 300, epoch: 14 | loss: 0.1728001
	speed: 0.2749s/iter; left time: 8741.5078s
Epoch: 14 cost time: 97.73210740089417
Epoch: 14, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.651 Vali Acc: 0.656 Test Loss: 1.651 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0187482
	speed: 0.8163s/iter; left time: 25823.3732s
	iters: 200, epoch: 15 | loss: 0.0453786
	speed: 0.2561s/iter; left time: 8074.7245s
	iters: 300, epoch: 15 | loss: 0.1604558
	speed: 0.2584s/iter; left time: 8122.7838s
Epoch: 15 cost time: 96.77983140945435
Epoch: 15, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.795 Vali Acc: 0.661 Test Loss: 1.795 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0043923
	speed: 0.8181s/iter; left time: 25577.4779s
	iters: 200, epoch: 16 | loss: 0.0371259
	speed: 0.2670s/iter; left time: 8321.6024s
	iters: 300, epoch: 16 | loss: 0.0512264
	speed: 0.2838s/iter; left time: 8815.9202s
Epoch: 16 cost time: 101.45519423484802
Epoch: 16, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.857 Vali Acc: 0.667 Test Loss: 1.857 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6770715096481271
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6745924
	speed: 0.2575s/iter; left time: 9474.6533s
	iters: 200, epoch: 1 | loss: 0.6823341
	speed: 0.2391s/iter; left time: 8776.0030s
	iters: 300, epoch: 1 | loss: 0.5729685
	speed: 0.2486s/iter; left time: 9100.2033s
Epoch: 1 cost time: 92.94913029670715
Epoch: 1, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.720 Vali Acc: 0.609 Test Loss: 0.720 Test Acc: 0.609
Validation loss decreased (inf --> -0.609244).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5308614
	speed: 0.8190s/iter; left time: 29837.0095s
	iters: 200, epoch: 2 | loss: 0.8949124
	speed: 0.2491s/iter; left time: 9051.2793s
	iters: 300, epoch: 2 | loss: 0.4302192
	speed: 0.2586s/iter; left time: 9367.9438s
Epoch: 2 cost time: 95.61852049827576
Epoch: 2, Steps: 369 | Train Loss: 0.588 Vali Loss: 0.733 Vali Acc: 0.650 Test Loss: 0.733 Test Acc: 0.650
Validation loss decreased (-0.609244 --> -0.650390).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3006730
	speed: 0.7997s/iter; left time: 28841.2601s
	iters: 200, epoch: 3 | loss: 0.3438754
	speed: 0.2505s/iter; left time: 9007.4515s
	iters: 300, epoch: 3 | loss: 0.4037433
	speed: 0.2434s/iter; left time: 8727.5653s
Epoch: 3 cost time: 91.25049567222595
Epoch: 3, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.719 Vali Acc: 0.669 Test Loss: 0.719 Test Acc: 0.669
Validation loss decreased (-0.650390 --> -0.668835).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6192291
	speed: 0.7665s/iter; left time: 27360.4053s
	iters: 200, epoch: 4 | loss: 0.4405866
	speed: 0.2489s/iter; left time: 8859.9144s
	iters: 300, epoch: 4 | loss: 0.2501890
	speed: 0.2491s/iter; left time: 8842.1734s
Epoch: 4 cost time: 90.91402792930603
Epoch: 4, Steps: 369 | Train Loss: 0.472 Vali Loss: 0.773 Vali Acc: 0.671 Test Loss: 0.773 Test Acc: 0.671
Validation loss decreased (-0.668835 --> -0.671388).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5655927
	speed: 0.7816s/iter; left time: 27609.1534s
	iters: 200, epoch: 5 | loss: 0.2077188
	speed: 0.2522s/iter; left time: 8884.9778s
	iters: 300, epoch: 5 | loss: 0.3400311
	speed: 0.2402s/iter; left time: 8437.1849s
Epoch: 5 cost time: 90.78427457809448
Epoch: 5, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.909 Vali Acc: 0.660 Test Loss: 0.909 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2879087
	speed: 0.7634s/iter; left time: 26683.9149s
	iters: 200, epoch: 6 | loss: 0.6009965
	speed: 0.2431s/iter; left time: 8474.3157s
	iters: 300, epoch: 6 | loss: 0.2283485
	speed: 0.2561s/iter; left time: 8901.5402s
Epoch: 6 cost time: 92.8871955871582
Epoch: 6, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.931 Vali Acc: 0.661 Test Loss: 0.931 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1023807
	speed: 0.7942s/iter; left time: 27470.4356s
	iters: 200, epoch: 7 | loss: 0.2960527
	speed: 0.2578s/iter; left time: 8889.3871s
	iters: 300, epoch: 7 | loss: 0.2375595
	speed: 0.2371s/iter; left time: 8154.7222s
Epoch: 7 cost time: 91.17608594894409
Epoch: 7, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.936 Vali Acc: 0.665 Test Loss: 0.936 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3627458
	speed: 0.7614s/iter; left time: 26054.9989s
	iters: 200, epoch: 8 | loss: 0.3607908
	speed: 0.2363s/iter; left time: 8061.3176s
	iters: 300, epoch: 8 | loss: 0.3060984
	speed: 0.2340s/iter; left time: 7959.1482s
Epoch: 8 cost time: 87.2204978466034
Epoch: 8, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.982 Vali Acc: 0.670 Test Loss: 0.982 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1125366
	speed: 0.7459s/iter; left time: 25249.5520s
	iters: 200, epoch: 9 | loss: 0.0635993
	speed: 0.2300s/iter; left time: 7761.0589s
	iters: 300, epoch: 9 | loss: 0.4890874
	speed: 0.2359s/iter; left time: 7938.7502s
Epoch: 9 cost time: 86.35599541664124
Epoch: 9, Steps: 369 | Train Loss: 0.251 Vali Loss: 1.053 Vali Acc: 0.666 Test Loss: 1.053 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1342586
	speed: 0.7483s/iter; left time: 25052.0701s
	iters: 200, epoch: 10 | loss: 0.0943716
	speed: 0.2329s/iter; left time: 7775.7987s
	iters: 300, epoch: 10 | loss: 0.3101324
	speed: 0.2385s/iter; left time: 7938.8935s
Epoch: 10 cost time: 87.50299978256226
Epoch: 10, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.104 Vali Acc: 0.678 Test Loss: 1.104 Test Acc: 0.678
Validation loss decreased (-0.671388 --> -0.677912).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1248818
	speed: 0.7636s/iter; left time: 25283.2852s
	iters: 200, epoch: 11 | loss: 0.2213945
	speed: 0.2429s/iter; left time: 8017.0101s
	iters: 300, epoch: 11 | loss: 0.1614886
	speed: 0.2402s/iter; left time: 7905.2841s
Epoch: 11 cost time: 89.31990909576416
Epoch: 11, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.188 Vali Acc: 0.667 Test Loss: 1.188 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0574862
	speed: 0.7602s/iter; left time: 24891.0929s
	iters: 200, epoch: 12 | loss: 0.0236675
	speed: 0.2439s/iter; left time: 7960.0660s
	iters: 300, epoch: 12 | loss: 0.3100742
	speed: 0.2394s/iter; left time: 7790.4207s
Epoch: 12 cost time: 89.36506009101868
Epoch: 12, Steps: 369 | Train Loss: 0.181 Vali Loss: 1.273 Vali Acc: 0.646 Test Loss: 1.273 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0791892
	speed: 0.7669s/iter; left time: 24827.6359s
	iters: 200, epoch: 13 | loss: 0.0600001
	speed: 0.2389s/iter; left time: 7710.0479s
	iters: 300, epoch: 13 | loss: 0.3183986
	speed: 0.2336s/iter; left time: 7514.4669s
Epoch: 13 cost time: 88.71221923828125
Epoch: 13, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.498 Vali Acc: 0.650 Test Loss: 1.498 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1653716
	speed: 0.7617s/iter; left time: 24378.3187s
	iters: 200, epoch: 14 | loss: 0.0863239
	speed: 0.2415s/iter; left time: 7705.3084s
	iters: 300, epoch: 14 | loss: 0.1940714
	speed: 0.2360s/iter; left time: 7505.9931s
Epoch: 14 cost time: 89.08127093315125
Epoch: 14, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.606 Vali Acc: 0.654 Test Loss: 1.606 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0833133
	speed: 0.7515s/iter; left time: 23775.2196s
	iters: 200, epoch: 15 | loss: 0.2194203
	speed: 0.2483s/iter; left time: 7830.3676s
	iters: 300, epoch: 15 | loss: 0.1099177
	speed: 0.2669s/iter; left time: 8390.5327s
Epoch: 15 cost time: 94.09300088882446
Epoch: 15, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.621 Vali Acc: 0.654 Test Loss: 1.621 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0637984
	speed: 0.7729s/iter; left time: 24165.0429s
	iters: 200, epoch: 16 | loss: 0.0465268
	speed: 0.2443s/iter; left time: 7613.3550s
	iters: 300, epoch: 16 | loss: 0.1268953
	speed: 0.2669s/iter; left time: 8290.7259s
Epoch: 16 cost time: 91.83495354652405
Epoch: 16, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.815 Vali Acc: 0.654 Test Loss: 1.815 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0159993
	speed: 0.7944s/iter; left time: 24544.9804s
	iters: 200, epoch: 17 | loss: 0.2056601
	speed: 0.2486s/iter; left time: 7655.3745s
	iters: 300, epoch: 17 | loss: 0.0403713
	speed: 0.2523s/iter; left time: 7745.7794s
Epoch: 17 cost time: 93.4590232372284
Epoch: 17, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.874 Vali Acc: 0.662 Test Loss: 1.874 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3722020
	speed: 0.7955s/iter; left time: 24285.2503s
	iters: 200, epoch: 18 | loss: 0.1049661
	speed: 0.2633s/iter; left time: 8012.8999s
	iters: 300, epoch: 18 | loss: 0.1441599
	speed: 0.2495s/iter; left time: 7566.1213s
Epoch: 18 cost time: 95.06484460830688
Epoch: 18, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.829 Vali Acc: 0.658 Test Loss: 1.829 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0044575
	speed: 0.7974s/iter; left time: 24049.7192s
	iters: 200, epoch: 19 | loss: 0.0014305
	speed: 0.2631s/iter; left time: 7907.4828s
	iters: 300, epoch: 19 | loss: 0.0637036
	speed: 0.2594s/iter; left time: 7771.7427s
Epoch: 19 cost time: 94.60038185119629
Epoch: 19, Steps: 369 | Train Loss: 0.092 Vali Loss: 2.013 Vali Acc: 0.674 Test Loss: 2.013 Test Acc: 0.674
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0010990
	speed: 0.7753s/iter; left time: 23096.2093s
	iters: 200, epoch: 20 | loss: 0.0585729
	speed: 0.2407s/iter; left time: 7146.4587s
	iters: 300, epoch: 20 | loss: 0.0158520
	speed: 0.2520s/iter; left time: 7455.6429s
Epoch: 20 cost time: 92.87233233451843
Epoch: 20, Steps: 369 | Train Loss: 0.086 Vali Loss: 2.228 Vali Acc: 0.655 Test Loss: 2.228 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6779228149829739
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6924824
	speed: 0.2486s/iter; left time: 9147.1255s
	iters: 200, epoch: 1 | loss: 0.6934350
	speed: 0.2331s/iter; left time: 8555.8308s
	iters: 300, epoch: 1 | loss: 0.6936372
	speed: 0.2334s/iter; left time: 8543.2463s
Epoch: 1 cost time: 87.56069874763489
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6924980
	speed: 0.7283s/iter; left time: 26533.6001s
	iters: 200, epoch: 2 | loss: 0.6941589
	speed: 0.2290s/iter; left time: 8318.5689s
	iters: 300, epoch: 2 | loss: 0.6928085
	speed: 0.2301s/iter; left time: 8336.5637s
Epoch: 2 cost time: 85.59003591537476
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6909890
	speed: 0.7203s/iter; left time: 25976.1109s
	iters: 200, epoch: 3 | loss: 0.6932186
	speed: 0.2365s/iter; left time: 8505.0785s
	iters: 300, epoch: 3 | loss: 0.6936501
	speed: 0.2241s/iter; left time: 8038.0563s
Epoch: 3 cost time: 84.3050787448883
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6954623
	speed: 0.7317s/iter; left time: 26115.7689s
	iters: 200, epoch: 4 | loss: 0.6936629
	speed: 0.2359s/iter; left time: 8397.6980s
	iters: 300, epoch: 4 | loss: 0.6932236
	speed: 0.2315s/iter; left time: 8216.7267s
Epoch: 4 cost time: 86.31934595108032
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6944689
	speed: 0.7421s/iter; left time: 26214.3440s
	iters: 200, epoch: 5 | loss: 0.6932941
	speed: 0.2329s/iter; left time: 8203.2983s
	iters: 300, epoch: 5 | loss: 0.6930770
	speed: 0.2336s/iter; left time: 8206.2362s
Epoch: 5 cost time: 87.10228967666626
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6929340
	speed: 0.7392s/iter; left time: 25840.7053s
	iters: 200, epoch: 6 | loss: 0.6917818
	speed: 0.2239s/iter; left time: 7804.6071s
	iters: 300, epoch: 6 | loss: 0.6934907
	speed: 0.2312s/iter; left time: 8037.0171s
Epoch: 6 cost time: 85.82090377807617
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6919449
	speed: 0.7388s/iter; left time: 25551.8826s
	iters: 200, epoch: 7 | loss: 0.6931509
	speed: 0.2227s/iter; left time: 7681.2654s
	iters: 300, epoch: 7 | loss: 0.6929361
	speed: 0.2378s/iter; left time: 8178.7794s
Epoch: 7 cost time: 86.79541158676147
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6962272
	speed: 0.7461s/iter; left time: 25531.6150s
	iters: 200, epoch: 8 | loss: 0.6940676
	speed: 0.2353s/iter; left time: 8029.2256s
	iters: 300, epoch: 8 | loss: 0.6933244
	speed: 0.2395s/iter; left time: 8148.2144s
Epoch: 8 cost time: 89.42364358901978
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6927347
	speed: 0.7338s/iter; left time: 24837.8375s
	iters: 200, epoch: 9 | loss: 0.6934046
	speed: 0.2309s/iter; left time: 7792.6581s
	iters: 300, epoch: 9 | loss: 0.6924422
	speed: 0.2366s/iter; left time: 7962.4339s
Epoch: 9 cost time: 85.65310072898865
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6931607
	speed: 0.7451s/iter; left time: 24945.0026s
	iters: 200, epoch: 10 | loss: 0.6934990
	speed: 0.2356s/iter; left time: 7863.7008s
	iters: 300, epoch: 10 | loss: 0.6940952
	speed: 0.2366s/iter; left time: 7874.1449s
Epoch: 10 cost time: 88.99543642997742
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6933851
	speed: 0.7575s/iter; left time: 25082.3790s
	iters: 200, epoch: 11 | loss: 0.6938616
	speed: 0.2460s/iter; left time: 8122.0191s
	iters: 300, epoch: 11 | loss: 0.6928290
	speed: 0.2394s/iter; left time: 7880.5013s
Epoch: 11 cost time: 90.0611457824707
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6922845
	speed: 0.7269s/iter; left time: 23798.8550s
	iters: 200, epoch: 12 | loss: 0.6957982
	speed: 0.2355s/iter; left time: 7687.9188s
	iters: 300, epoch: 12 | loss: 0.6920032
	speed: 0.2340s/iter; left time: 7614.2722s
Epoch: 12 cost time: 86.9967315196991
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6880939
	speed: 0.7522s/iter; left time: 24351.7130s
	iters: 200, epoch: 13 | loss: 0.6951182
	speed: 0.2335s/iter; left time: 7535.7672s
	iters: 300, epoch: 13 | loss: 0.6904188
	speed: 0.2381s/iter; left time: 7661.7232s
Epoch: 13 cost time: 87.84833884239197
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6931187
	speed: 0.7540s/iter; left time: 24132.3662s
	iters: 200, epoch: 14 | loss: 0.6929182
	speed: 0.2309s/iter; left time: 7366.1311s
	iters: 300, epoch: 14 | loss: 0.6931472
	speed: 0.2277s/iter; left time: 7242.5479s
Epoch: 14 cost time: 86.12820148468018
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6923173
	speed: 0.7277s/iter; left time: 23022.3312s
	iters: 200, epoch: 15 | loss: 0.6906812
	speed: 0.2276s/iter; left time: 7176.0738s
	iters: 300, epoch: 15 | loss: 0.6929015
	speed: 0.2265s/iter; left time: 7121.1652s
Epoch: 15 cost time: 85.37213110923767
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6931490
	speed: 0.7200s/iter; left time: 22512.4216s
	iters: 200, epoch: 16 | loss: 0.6917869
	speed: 0.2157s/iter; left time: 6721.0104s
	iters: 300, epoch: 16 | loss: 0.6932082
	speed: 0.2304s/iter; left time: 7157.4486s
Epoch: 16 cost time: 83.64194297790527
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6882741
	speed: 0.7164s/iter; left time: 22133.3541s
	iters: 200, epoch: 17 | loss: 0.6932651
	speed: 0.2237s/iter; left time: 6889.6719s
	iters: 300, epoch: 17 | loss: 0.6931595
	speed: 0.2319s/iter; left time: 7118.7568s
Epoch: 17 cost time: 84.40939259529114
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6931950
	speed: 0.6953s/iter; left time: 21225.9291s
	iters: 200, epoch: 18 | loss: 0.6940799
	speed: 0.2237s/iter; left time: 6806.5231s
	iters: 300, epoch: 18 | loss: 0.6931478
	speed: 0.2279s/iter; left time: 6912.8161s
Epoch: 18 cost time: 82.27749586105347
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6951611
	speed: 0.6946s/iter; left time: 20947.2262s
	iters: 200, epoch: 19 | loss: 0.6931473
	speed: 0.2215s/iter; left time: 6659.0334s
	iters: 300, epoch: 19 | loss: 0.6932629
	speed: 0.2281s/iter; left time: 6832.1601s
Epoch: 19 cost time: 83.47480511665344
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6943189
	speed: 0.7174s/iter; left time: 21371.8255s
	iters: 200, epoch: 20 | loss: 0.7009916
	speed: 0.2472s/iter; left time: 7339.2781s
	iters: 300, epoch: 20 | loss: 0.6931615
	speed: 0.2486s/iter; left time: 7355.0313s
Epoch: 20 cost time: 90.10309386253357
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.6934922
	speed: 0.7771s/iter; left time: 22863.3360s
	iters: 200, epoch: 21 | loss: 0.6933835
	speed: 0.2582s/iter; left time: 7569.2215s
	iters: 300, epoch: 21 | loss: 0.6943846
	speed: 0.2680s/iter; left time: 7832.2433s
Epoch: 21 cost time: 95.15594911575317
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6943088
	speed: 0.7584s/iter; left time: 22032.3080s
	iters: 200, epoch: 22 | loss: 0.6919845
	speed: 0.2470s/iter; left time: 7150.4884s
	iters: 300, epoch: 22 | loss: 0.6928148
	speed: 0.2468s/iter; left time: 7120.1640s
Epoch: 22 cost time: 92.90076899528503
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.6938073
	speed: 0.7943s/iter; left time: 22783.4799s
	iters: 200, epoch: 23 | loss: 0.6923746
	speed: 0.2455s/iter; left time: 7015.7552s
	iters: 300, epoch: 23 | loss: 0.6932371
	speed: 0.2639s/iter; left time: 7516.7713s
Epoch: 23 cost time: 94.7990300655365
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.6941800
	speed: 0.7893s/iter; left time: 22348.7876s
	iters: 200, epoch: 24 | loss: 0.6931749
	speed: 0.2716s/iter; left time: 7663.2931s
	iters: 300, epoch: 24 | loss: 0.6913506
	speed: 0.2579s/iter; left time: 7251.1941s
Epoch: 24 cost time: 96.6712076663971
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.6931673
	speed: 0.7540s/iter; left time: 21071.1194s
	iters: 200, epoch: 25 | loss: 0.6919426
	speed: 0.2386s/iter; left time: 6642.8022s
	iters: 300, epoch: 25 | loss: 0.6936047
	speed: 0.2451s/iter; left time: 6799.2002s
Epoch: 25 cost time: 89.37951397895813
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.6933534
	speed: 0.7528s/iter; left time: 20760.5066s
	iters: 200, epoch: 26 | loss: 0.6913022
	speed: 0.2345s/iter; left time: 6443.7172s
	iters: 300, epoch: 26 | loss: 0.6894296
	speed: 0.2417s/iter; left time: 6616.1126s
Epoch: 26 cost time: 89.72167444229126
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.6926348
	speed: 0.7607s/iter; left time: 20696.8789s
	iters: 200, epoch: 27 | loss: 0.6914599
	speed: 0.2409s/iter; left time: 6528.8544s
	iters: 300, epoch: 27 | loss: 0.6941286
	speed: 0.2345s/iter; left time: 6333.5624s
Epoch: 27 cost time: 87.91158294677734
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.6928535
	speed: 0.7380s/iter; left time: 19807.7120s
	iters: 200, epoch: 28 | loss: 0.6923106
	speed: 0.2337s/iter; left time: 6248.9119s
	iters: 300, epoch: 28 | loss: 0.6931475
	speed: 0.2463s/iter; left time: 6561.7197s
Epoch: 28 cost time: 87.8136625289917
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.6957396
	speed: 0.7491s/iter; left time: 19827.6560s
	iters: 200, epoch: 29 | loss: 0.6951661
	speed: 0.2416s/iter; left time: 6370.5262s
	iters: 300, epoch: 29 | loss: 0.6937483
	speed: 0.2381s/iter; left time: 6253.9719s
Epoch: 29 cost time: 90.1297492980957
Epoch: 29, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.6963019
	speed: 0.7455s/iter; left time: 19456.7164s
	iters: 200, epoch: 30 | loss: 0.6944391
	speed: 0.2428s/iter; left time: 6312.3805s
	iters: 300, epoch: 30 | loss: 0.6924030
	speed: 0.2489s/iter; left time: 6445.5909s
Epoch: 30 cost time: 89.88977360725403
Epoch: 30, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.6964086
	speed: 0.7558s/iter; left time: 19448.7617s
	iters: 200, epoch: 31 | loss: 0.6907700
	speed: 0.2365s/iter; left time: 6062.0288s
	iters: 300, epoch: 31 | loss: 0.6935140
	speed: 0.2409s/iter; left time: 6151.2721s
Epoch: 31 cost time: 89.18635368347168
Epoch: 31, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 953154
model size : 6.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6725681
	speed: 0.2669s/iter; left time: 9822.0439s
	iters: 200, epoch: 1 | loss: 0.5990956
	speed: 0.2596s/iter; left time: 9527.4614s
	iters: 300, epoch: 1 | loss: 0.7283885
	speed: 0.2502s/iter; left time: 9159.0042s
Epoch: 1 cost time: 95.2187147140503
Epoch: 1, Steps: 369 | Train Loss: 0.653 Vali Loss: 0.695 Vali Acc: 0.650 Test Loss: 0.695 Test Acc: 0.650
Validation loss decreased (inf --> -0.650107).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4896858
	speed: 0.7763s/iter; left time: 28280.4187s
	iters: 200, epoch: 2 | loss: 0.5774707
	speed: 0.2438s/iter; left time: 8856.2103s
	iters: 300, epoch: 2 | loss: 0.5472925
	speed: 0.2539s/iter; left time: 9198.6666s
Epoch: 2 cost time: 92.65405988693237
Epoch: 2, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.675 Vali Acc: 0.668 Test Loss: 0.675 Test Acc: 0.668
Validation loss decreased (-0.650107 --> -0.668268).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4423809
	speed: 0.7771s/iter; left time: 28023.4493s
	iters: 200, epoch: 3 | loss: 0.8423656
	speed: 0.2584s/iter; left time: 9293.7349s
	iters: 300, epoch: 3 | loss: 0.1199127
	speed: 0.2443s/iter; left time: 8762.4552s
Epoch: 3 cost time: 93.39805698394775
Epoch: 3, Steps: 369 | Train Loss: 0.449 Vali Loss: 0.803 Vali Acc: 0.652 Test Loss: 0.803 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5056124
	speed: 0.7592s/iter; left time: 27098.4402s
	iters: 200, epoch: 4 | loss: 0.3408525
	speed: 0.2551s/iter; left time: 9079.2212s
	iters: 300, epoch: 4 | loss: 0.2223918
	speed: 0.2364s/iter; left time: 8391.1101s
Epoch: 4 cost time: 90.14419674873352
Epoch: 4, Steps: 369 | Train Loss: 0.398 Vali Loss: 0.819 Vali Acc: 0.659 Test Loss: 0.819 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4247584
	speed: 0.7730s/iter; left time: 27306.7797s
	iters: 200, epoch: 5 | loss: 0.1975638
	speed: 0.2531s/iter; left time: 8914.5992s
	iters: 300, epoch: 5 | loss: 0.3089869
	speed: 0.2439s/iter; left time: 8565.2679s
Epoch: 5 cost time: 94.35206985473633
Epoch: 5, Steps: 369 | Train Loss: 0.343 Vali Loss: 1.010 Vali Acc: 0.682 Test Loss: 1.010 Test Acc: 0.682
Validation loss decreased (-0.668268 --> -0.682453).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2989751
	speed: 0.7996s/iter; left time: 27952.4709s
	iters: 200, epoch: 6 | loss: 0.2374819
	speed: 0.2548s/iter; left time: 8882.0444s
	iters: 300, epoch: 6 | loss: 0.0737538
	speed: 0.2469s/iter; left time: 8580.5130s
Epoch: 6 cost time: 92.83932757377625
Epoch: 6, Steps: 369 | Train Loss: 0.299 Vali Loss: 1.013 Vali Acc: 0.666 Test Loss: 1.013 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2177734
	speed: 0.7965s/iter; left time: 27549.9278s
	iters: 200, epoch: 7 | loss: 0.4598864
	speed: 0.2496s/iter; left time: 8606.8018s
	iters: 300, epoch: 7 | loss: 0.5428811
	speed: 0.2461s/iter; left time: 8462.7333s
Epoch: 7 cost time: 94.84049868583679
Epoch: 7, Steps: 369 | Train Loss: 0.287 Vali Loss: 1.123 Vali Acc: 0.662 Test Loss: 1.123 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1618626
	speed: 0.8107s/iter; left time: 27741.0160s
	iters: 200, epoch: 8 | loss: 0.1683433
	speed: 0.2539s/iter; left time: 8661.5155s
	iters: 300, epoch: 8 | loss: 0.2241655
	speed: 0.2684s/iter; left time: 9130.4490s
Epoch: 8 cost time: 97.33981370925903
Epoch: 8, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.325 Vali Acc: 0.634 Test Loss: 1.325 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1096389
	speed: 0.7962s/iter; left time: 26951.5939s
	iters: 200, epoch: 9 | loss: 0.1785406
	speed: 0.2432s/iter; left time: 8207.0815s
	iters: 300, epoch: 9 | loss: 0.2206458
	speed: 0.2491s/iter; left time: 8383.0350s
Epoch: 9 cost time: 92.96558737754822
Epoch: 9, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.353 Vali Acc: 0.654 Test Loss: 1.353 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0217999
	speed: 0.8136s/iter; left time: 27238.8089s
	iters: 200, epoch: 10 | loss: 0.6568230
	speed: 0.2472s/iter; left time: 8250.2986s
	iters: 300, epoch: 10 | loss: 0.0168720
	speed: 0.2576s/iter; left time: 8571.7042s
Epoch: 10 cost time: 94.81959629058838
Epoch: 10, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.499 Vali Acc: 0.652 Test Loss: 1.499 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1607821
	speed: 0.7714s/iter; left time: 25540.1781s
	iters: 200, epoch: 11 | loss: 0.3080121
	speed: 0.2484s/iter; left time: 8201.1946s
	iters: 300, epoch: 11 | loss: 0.1936685
	speed: 0.2471s/iter; left time: 8131.1737s
Epoch: 11 cost time: 91.64942622184753
Epoch: 11, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.548 Vali Acc: 0.659 Test Loss: 1.548 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1907603
	speed: 0.7654s/iter; left time: 25060.8783s
	iters: 200, epoch: 12 | loss: 0.0084303
	speed: 0.2434s/iter; left time: 7945.2397s
	iters: 300, epoch: 12 | loss: 0.0582558
	speed: 0.2547s/iter; left time: 8288.9059s
Epoch: 12 cost time: 92.7457628250122
Epoch: 12, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.591 Vali Acc: 0.669 Test Loss: 1.591 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.5084222
	speed: 0.7713s/iter; left time: 24969.0851s
	iters: 200, epoch: 13 | loss: 0.0987670
	speed: 0.2455s/iter; left time: 7922.6931s
	iters: 300, epoch: 13 | loss: 0.1110118
	speed: 0.2372s/iter; left time: 7631.1769s
Epoch: 13 cost time: 90.32572221755981
Epoch: 13, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.693 Vali Acc: 0.662 Test Loss: 1.693 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1207975
	speed: 0.7777s/iter; left time: 24888.7291s
	iters: 200, epoch: 14 | loss: 0.1918564
	speed: 0.2524s/iter; left time: 8054.1643s
	iters: 300, epoch: 14 | loss: 0.0263389
	speed: 0.2547s/iter; left time: 8101.7532s
Epoch: 14 cost time: 94.05943846702576
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.872 Vali Acc: 0.664 Test Loss: 1.872 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0033227
	speed: 0.7492s/iter; left time: 23701.6392s
	iters: 200, epoch: 15 | loss: 0.2927423
	speed: 0.2592s/iter; left time: 8174.9300s
	iters: 300, epoch: 15 | loss: 0.1279390
	speed: 0.2442s/iter; left time: 7675.6908s
Epoch: 15 cost time: 93.38565850257874
Epoch: 15, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.832 Vali Acc: 0.655 Test Loss: 1.832 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6824631101021567
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6606502
	speed: 0.2485s/iter; left time: 9144.2166s
	iters: 200, epoch: 1 | loss: 0.6299007
	speed: 0.2449s/iter; left time: 8988.1712s
	iters: 300, epoch: 1 | loss: 0.7913967
	speed: 0.2382s/iter; left time: 8717.9281s
Epoch: 1 cost time: 90.58852696418762
Epoch: 1, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.709 Vali Acc: 0.646 Test Loss: 0.709 Test Acc: 0.646
Validation loss decreased (inf --> -0.646134).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5186749
	speed: 0.7482s/iter; left time: 27259.5669s
	iters: 200, epoch: 2 | loss: 0.4666609
	speed: 0.2405s/iter; left time: 8738.6346s
	iters: 300, epoch: 2 | loss: 0.4655881
	speed: 0.2396s/iter; left time: 8681.2990s
Epoch: 2 cost time: 89.68644070625305
Epoch: 2, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.688 Vali Acc: 0.667 Test Loss: 0.688 Test Acc: 0.667
Validation loss decreased (-0.646134 --> -0.667417).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3235726
	speed: 0.7560s/iter; left time: 27261.8943s
	iters: 200, epoch: 3 | loss: 0.7954965
	speed: 0.2393s/iter; left time: 8607.0371s
	iters: 300, epoch: 3 | loss: 0.1672506
	speed: 0.2382s/iter; left time: 8540.9736s
Epoch: 3 cost time: 88.4650981426239
Epoch: 3, Steps: 369 | Train Loss: 0.455 Vali Loss: 0.824 Vali Acc: 0.654 Test Loss: 0.824 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4004582
	speed: 0.7525s/iter; left time: 26860.9237s
	iters: 200, epoch: 4 | loss: 0.2704920
	speed: 0.2395s/iter; left time: 8523.5872s
	iters: 300, epoch: 4 | loss: 0.2426389
	speed: 0.2410s/iter; left time: 8553.5275s
Epoch: 4 cost time: 89.87822914123535
Epoch: 4, Steps: 369 | Train Loss: 0.411 Vali Loss: 0.784 Vali Acc: 0.657 Test Loss: 0.784 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.4518152
	speed: 0.7490s/iter; left time: 26459.8687s
	iters: 200, epoch: 5 | loss: 0.4860365
	speed: 0.2538s/iter; left time: 8941.5518s
	iters: 300, epoch: 5 | loss: 0.5244666
	speed: 0.2437s/iter; left time: 8560.1074s
Epoch: 5 cost time: 91.06792092323303
Epoch: 5, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.945 Vali Acc: 0.665 Test Loss: 0.945 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3988326
	speed: 0.7477s/iter; left time: 26134.9820s
	iters: 200, epoch: 6 | loss: 0.2615912
	speed: 0.2399s/iter; left time: 8363.1583s
	iters: 300, epoch: 6 | loss: 0.0612810
	speed: 0.2465s/iter; left time: 8566.2137s
Epoch: 6 cost time: 88.88088035583496
Epoch: 6, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.999 Vali Acc: 0.656 Test Loss: 0.999 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2223163
	speed: 0.7330s/iter; left time: 25352.2854s
	iters: 200, epoch: 7 | loss: 0.3475941
	speed: 0.2301s/iter; left time: 7934.3225s
	iters: 300, epoch: 7 | loss: 0.5878157
	speed: 0.2215s/iter; left time: 7616.7264s
Epoch: 7 cost time: 86.11978936195374
Epoch: 7, Steps: 369 | Train Loss: 0.277 Vali Loss: 1.092 Vali Acc: 0.660 Test Loss: 1.092 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1327695
	speed: 0.7315s/iter; left time: 25031.6789s
	iters: 200, epoch: 8 | loss: 0.1336543
	speed: 0.2380s/iter; left time: 8120.2446s
	iters: 300, epoch: 8 | loss: 0.2772743
	speed: 0.2358s/iter; left time: 8020.5659s
Epoch: 8 cost time: 87.36057567596436
Epoch: 8, Steps: 369 | Train Loss: 0.246 Vali Loss: 1.239 Vali Acc: 0.647 Test Loss: 1.239 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.1556696
	speed: 0.7449s/iter; left time: 25214.7100s
	iters: 200, epoch: 9 | loss: 0.2872990
	speed: 0.2347s/iter; left time: 7920.1990s
	iters: 300, epoch: 9 | loss: 0.3341351
	speed: 0.2483s/iter; left time: 8355.5456s
Epoch: 9 cost time: 89.06733751296997
Epoch: 9, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.515 Vali Acc: 0.644 Test Loss: 1.515 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1485227
	speed: 0.7477s/iter; left time: 25031.3414s
	iters: 200, epoch: 10 | loss: 0.5312290
	speed: 0.2408s/iter; left time: 8037.9290s
	iters: 300, epoch: 10 | loss: 0.0406016
	speed: 0.2460s/iter; left time: 8185.6077s
Epoch: 10 cost time: 91.11048817634583
Epoch: 10, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.488 Vali Acc: 0.663 Test Loss: 1.488 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.5302687
	speed: 0.7763s/iter; left time: 25705.6265s
	iters: 200, epoch: 11 | loss: 0.0920579
	speed: 0.2446s/iter; left time: 8073.2675s
	iters: 300, epoch: 11 | loss: 0.3107694
	speed: 0.2507s/iter; left time: 8250.2549s
Epoch: 11 cost time: 92.79538702964783
Epoch: 11, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.549 Vali Acc: 0.657 Test Loss: 1.549 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1016035
	speed: 0.7563s/iter; left time: 24762.1166s
	iters: 200, epoch: 12 | loss: 0.0035147
	speed: 0.2493s/iter; left time: 8136.2475s
	iters: 300, epoch: 12 | loss: 0.1942790
	speed: 0.2336s/iter; left time: 7601.2892s
Epoch: 12 cost time: 89.7694022655487
Epoch: 12, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.695 Vali Acc: 0.657 Test Loss: 1.695 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6674233825198638
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7248784
	speed: 0.2545s/iter; left time: 9366.6245s
	iters: 200, epoch: 1 | loss: 0.6518911
	speed: 0.2428s/iter; left time: 8912.0999s
	iters: 300, epoch: 1 | loss: 0.7960029
	speed: 0.2402s/iter; left time: 8791.7883s
Epoch: 1 cost time: 90.49519777297974
Epoch: 1, Steps: 369 | Train Loss: 0.671 Vali Loss: 0.700 Vali Acc: 0.633 Test Loss: 0.700 Test Acc: 0.633
Validation loss decreased (inf --> -0.632513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5810914
	speed: 0.7303s/iter; left time: 26604.5709s
	iters: 200, epoch: 2 | loss: 0.6167748
	speed: 0.2437s/iter; left time: 8853.2757s
	iters: 300, epoch: 2 | loss: 0.6131479
	speed: 0.2432s/iter; left time: 8813.2331s
Epoch: 2 cost time: 89.64154314994812
Epoch: 2, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.675 Vali Acc: 0.657 Test Loss: 0.675 Test Acc: 0.657
Validation loss decreased (-0.632513 --> -0.656917).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2488493
	speed: 0.7546s/iter; left time: 27214.2806s
	iters: 200, epoch: 3 | loss: 0.6844531
	speed: 0.2393s/iter; left time: 8604.7374s
	iters: 300, epoch: 3 | loss: 0.1414715
	speed: 0.2370s/iter; left time: 8498.6412s
Epoch: 3 cost time: 89.29367756843567
Epoch: 3, Steps: 369 | Train Loss: 0.468 Vali Loss: 0.763 Vali Acc: 0.662 Test Loss: 0.763 Test Acc: 0.662
Validation loss decreased (-0.656917 --> -0.662024).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3197191
	speed: 0.7453s/iter; left time: 26604.2863s
	iters: 200, epoch: 4 | loss: 0.3402948
	speed: 0.2450s/iter; left time: 8721.0802s
	iters: 300, epoch: 4 | loss: 0.1217735
	speed: 0.2281s/iter; left time: 8096.9000s
Epoch: 4 cost time: 89.26193857192993
Epoch: 4, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.780 Vali Acc: 0.647 Test Loss: 0.780 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2930225
	speed: 0.7483s/iter; left time: 26432.0162s
	iters: 200, epoch: 5 | loss: 0.5598565
	speed: 0.2513s/iter; left time: 8852.9156s
	iters: 300, epoch: 5 | loss: 0.4120662
	speed: 0.2470s/iter; left time: 8677.3753s
Epoch: 5 cost time: 91.14907956123352
Epoch: 5, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.927 Vali Acc: 0.671 Test Loss: 0.927 Test Acc: 0.671
Validation loss decreased (-0.662024 --> -0.670819).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2848004
	speed: 0.7460s/iter; left time: 26076.9286s
	iters: 200, epoch: 6 | loss: 0.3514732
	speed: 0.2406s/iter; left time: 8385.6233s
	iters: 300, epoch: 6 | loss: 0.0554831
	speed: 0.2488s/iter; left time: 8647.2640s
Epoch: 6 cost time: 90.74756526947021
Epoch: 6, Steps: 369 | Train Loss: 0.314 Vali Loss: 1.008 Vali Acc: 0.648 Test Loss: 1.008 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3972432
	speed: 0.7553s/iter; left time: 26123.8109s
	iters: 200, epoch: 7 | loss: 0.4817844
	speed: 0.2468s/iter; left time: 8511.6622s
	iters: 300, epoch: 7 | loss: 0.3482086
	speed: 0.2478s/iter; left time: 8519.7967s
Epoch: 7 cost time: 92.29910731315613
Epoch: 7, Steps: 369 | Train Loss: 0.277 Vali Loss: 1.074 Vali Acc: 0.660 Test Loss: 1.074 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2300128
	speed: 0.7752s/iter; left time: 26526.5090s
	iters: 200, epoch: 8 | loss: 0.4168831
	speed: 0.2492s/iter; left time: 8502.1019s
	iters: 300, epoch: 8 | loss: 0.3904104
	speed: 0.2528s/iter; left time: 8598.5178s
Epoch: 8 cost time: 92.73714470863342
Epoch: 8, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.224 Vali Acc: 0.648 Test Loss: 1.224 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0404007
	speed: 0.7404s/iter; left time: 25063.3317s
	iters: 200, epoch: 9 | loss: 0.0512200
	speed: 0.2504s/iter; left time: 8452.3207s
	iters: 300, epoch: 9 | loss: 0.0789887
	speed: 0.2394s/iter; left time: 8056.8574s
Epoch: 9 cost time: 89.93569612503052
Epoch: 9, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.343 Vali Acc: 0.659 Test Loss: 1.343 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1888813
	speed: 0.7486s/iter; left time: 25062.7183s
	iters: 200, epoch: 10 | loss: 0.2264151
	speed: 0.2416s/iter; left time: 8066.1515s
	iters: 300, epoch: 10 | loss: 0.1409125
	speed: 0.2423s/iter; left time: 8063.3620s
Epoch: 10 cost time: 89.3046772480011
Epoch: 10, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.361 Vali Acc: 0.665 Test Loss: 1.361 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3112944
	speed: 0.7406s/iter; left time: 24522.5918s
	iters: 200, epoch: 11 | loss: 0.3225999
	speed: 0.2425s/iter; left time: 8005.1469s
	iters: 300, epoch: 11 | loss: 0.2964817
	speed: 0.2542s/iter; left time: 8366.1549s
Epoch: 11 cost time: 90.88281559944153
Epoch: 11, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.364 Vali Acc: 0.674 Test Loss: 1.364 Test Acc: 0.674
Validation loss decreased (-0.670819 --> -0.673936).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0008066
	speed: 0.7552s/iter; left time: 24728.1826s
	iters: 200, epoch: 12 | loss: 0.0519993
	speed: 0.2409s/iter; left time: 7863.8991s
	iters: 300, epoch: 12 | loss: 0.5155414
	speed: 0.2355s/iter; left time: 7662.6289s
Epoch: 12 cost time: 89.41623973846436
Epoch: 12, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.588 Vali Acc: 0.665 Test Loss: 1.588 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2356093
	speed: 0.7445s/iter; left time: 24101.0948s
	iters: 200, epoch: 13 | loss: 0.0236766
	speed: 0.2369s/iter; left time: 7646.8308s
	iters: 300, epoch: 13 | loss: 0.0217192
	speed: 0.2407s/iter; left time: 7742.9620s
Epoch: 13 cost time: 89.30121326446533
Epoch: 13, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.762 Vali Acc: 0.645 Test Loss: 1.762 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1127673
	speed: 0.7617s/iter; left time: 24376.6216s
	iters: 200, epoch: 14 | loss: 0.2676687
	speed: 0.2510s/iter; left time: 8007.6847s
	iters: 300, epoch: 14 | loss: 0.1181170
	speed: 0.2428s/iter; left time: 7722.7472s
Epoch: 14 cost time: 91.35559582710266
Epoch: 14, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.637 Vali Acc: 0.644 Test Loss: 1.637 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0262498
	speed: 0.7774s/iter; left time: 24593.3351s
	iters: 200, epoch: 15 | loss: 0.2692617
	speed: 0.2610s/iter; left time: 8230.4829s
	iters: 300, epoch: 15 | loss: 0.0181035
	speed: 0.2584s/iter; left time: 8123.4308s
Epoch: 15 cost time: 95.92955541610718
Epoch: 15, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.760 Vali Acc: 0.653 Test Loss: 1.760 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0129800
	speed: 0.7903s/iter; left time: 24709.9972s
	iters: 200, epoch: 16 | loss: 0.1267880
	speed: 0.2452s/iter; left time: 7642.6784s
	iters: 300, epoch: 16 | loss: 0.0637026
	speed: 0.2476s/iter; left time: 7693.3683s
Epoch: 16 cost time: 91.28713202476501
Epoch: 16, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.842 Vali Acc: 0.647 Test Loss: 1.842 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1485556
	speed: 0.7771s/iter; left time: 24010.3811s
	iters: 200, epoch: 17 | loss: 0.0663778
	speed: 0.2583s/iter; left time: 7954.6216s
	iters: 300, epoch: 17 | loss: 0.0557038
	speed: 0.2470s/iter; left time: 7580.9445s
Epoch: 17 cost time: 93.90898180007935
Epoch: 17, Steps: 369 | Train Loss: 0.104 Vali Loss: 2.031 Vali Acc: 0.649 Test Loss: 2.031 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0139325
	speed: 0.7588s/iter; left time: 23163.6834s
	iters: 200, epoch: 18 | loss: 0.0008299
	speed: 0.2491s/iter; left time: 7581.0781s
	iters: 300, epoch: 18 | loss: 0.2074284
	speed: 0.2335s/iter; left time: 7081.4332s
Epoch: 18 cost time: 91.69186329841614
Epoch: 18, Steps: 369 | Train Loss: 0.104 Vali Loss: 2.045 Vali Acc: 0.659 Test Loss: 2.045 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0048384
	speed: 0.7635s/iter; left time: 23025.4886s
	iters: 200, epoch: 19 | loss: 0.0253578
	speed: 0.2404s/iter; left time: 7224.7029s
	iters: 300, epoch: 19 | loss: 0.3049868
	speed: 0.2446s/iter; left time: 7329.1668s
Epoch: 19 cost time: 89.81089520454407
Epoch: 19, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.145 Vali Acc: 0.640 Test Loss: 2.145 Test Acc: 0.640
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1934624
	speed: 0.7468s/iter; left time: 22246.3302s
	iters: 200, epoch: 20 | loss: 0.2466690
	speed: 0.2443s/iter; left time: 7254.1081s
	iters: 300, epoch: 20 | loss: 0.0133734
	speed: 0.2754s/iter; left time: 8148.1418s
Epoch: 20 cost time: 94.866370677948
Epoch: 20, Steps: 369 | Train Loss: 0.073 Vali Loss: 2.344 Vali Acc: 0.643 Test Loss: 2.344 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0739478
	speed: 0.7804s/iter; left time: 22959.7214s
	iters: 200, epoch: 21 | loss: 0.0059704
	speed: 0.2621s/iter; left time: 7686.2819s
	iters: 300, epoch: 21 | loss: 0.0261017
	speed: 0.2721s/iter; left time: 7951.3584s
Epoch: 21 cost time: 97.80425238609314
Epoch: 21, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.219 Vali Acc: 0.655 Test Loss: 2.219 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.673950056753689
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6967111
	speed: 0.2801s/iter; left time: 10308.7638s
	iters: 200, epoch: 1 | loss: 0.7685518
	speed: 0.2486s/iter; left time: 9123.4105s
	iters: 300, epoch: 1 | loss: 0.6399196
	speed: 0.2517s/iter; left time: 9212.8058s
Epoch: 1 cost time: 96.42422294616699
Epoch: 1, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.704 Vali Acc: 0.631 Test Loss: 0.704 Test Acc: 0.631
Validation loss decreased (inf --> -0.630810).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7523275
	speed: 0.7967s/iter; left time: 29025.0155s
	iters: 200, epoch: 2 | loss: 0.6487462
	speed: 0.2458s/iter; left time: 8930.2203s
	iters: 300, epoch: 2 | loss: 0.6604219
	speed: 0.2488s/iter; left time: 9014.4122s
Epoch: 2 cost time: 93.32947492599487
Epoch: 2, Steps: 369 | Train Loss: 0.545 Vali Loss: 0.736 Vali Acc: 0.655 Test Loss: 0.736 Test Acc: 0.655
Validation loss decreased (-0.630810 --> -0.655214).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4947630
	speed: 0.7762s/iter; left time: 27993.1884s
	iters: 200, epoch: 3 | loss: 0.8991221
	speed: 0.2443s/iter; left time: 8784.2969s
	iters: 300, epoch: 3 | loss: 0.1574186
	speed: 0.2595s/iter; left time: 9306.9431s
Epoch: 3 cost time: 93.36436033248901
Epoch: 3, Steps: 369 | Train Loss: 0.475 Vali Loss: 0.821 Vali Acc: 0.658 Test Loss: 0.821 Test Acc: 0.658
Validation loss decreased (-0.655214 --> -0.658335).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3085465
	speed: 0.7821s/iter; left time: 27915.9910s
	iters: 200, epoch: 4 | loss: 0.3177564
	speed: 0.2542s/iter; left time: 9048.2606s
	iters: 300, epoch: 4 | loss: 0.1699000
	speed: 0.2483s/iter; left time: 8812.7611s
Epoch: 4 cost time: 92.68094825744629
Epoch: 4, Steps: 369 | Train Loss: 0.426 Vali Loss: 0.768 Vali Acc: 0.658 Test Loss: 0.768 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4430360
	speed: 0.7960s/iter; left time: 28118.5607s
	iters: 200, epoch: 5 | loss: 0.2241884
	speed: 0.2563s/iter; left time: 9028.2340s
	iters: 300, epoch: 5 | loss: 0.5957409
	speed: 0.2541s/iter; left time: 8926.0761s
Epoch: 5 cost time: 95.899893283844
Epoch: 5, Steps: 369 | Train Loss: 0.363 Vali Loss: 0.951 Vali Acc: 0.671 Test Loss: 0.951 Test Acc: 0.671
Validation loss decreased (-0.658335 --> -0.671387).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2286211
	speed: 0.7965s/iter; left time: 27841.5033s
	iters: 200, epoch: 6 | loss: 0.3364939
	speed: 0.2517s/iter; left time: 8774.6946s
	iters: 300, epoch: 6 | loss: 0.1410594
	speed: 0.2543s/iter; left time: 8836.9860s
Epoch: 6 cost time: 93.70300531387329
Epoch: 6, Steps: 369 | Train Loss: 0.326 Vali Loss: 1.021 Vali Acc: 0.661 Test Loss: 1.021 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0822335
	speed: 0.7899s/iter; left time: 27318.7886s
	iters: 200, epoch: 7 | loss: 0.3385800
	speed: 0.2414s/iter; left time: 8324.7439s
	iters: 300, epoch: 7 | loss: 0.4809806
	speed: 0.2559s/iter; left time: 8798.8451s
Epoch: 7 cost time: 93.65202689170837
Epoch: 7, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.164 Vali Acc: 0.665 Test Loss: 1.164 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1601810
	speed: 0.7915s/iter; left time: 27083.7976s
	iters: 200, epoch: 8 | loss: 0.4700735
	speed: 0.2514s/iter; left time: 8578.7781s
	iters: 300, epoch: 8 | loss: 0.4361356
	speed: 0.2399s/iter; left time: 8161.3593s
Epoch: 8 cost time: 93.54267740249634
Epoch: 8, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.172 Vali Acc: 0.655 Test Loss: 1.172 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2097314
	speed: 0.7942s/iter; left time: 26882.5923s
	iters: 200, epoch: 9 | loss: 0.1682189
	speed: 0.2544s/iter; left time: 8585.1142s
	iters: 300, epoch: 9 | loss: 0.4111672
	speed: 0.2626s/iter; left time: 8837.6504s
Epoch: 9 cost time: 95.95065474510193
Epoch: 9, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.284 Vali Acc: 0.665 Test Loss: 1.284 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1714246
	speed: 0.7858s/iter; left time: 26308.4073s
	iters: 200, epoch: 10 | loss: 0.6938694
	speed: 0.2441s/iter; left time: 8149.2211s
	iters: 300, epoch: 10 | loss: 0.0290646
	speed: 0.2488s/iter; left time: 8281.3746s
Epoch: 10 cost time: 93.4216616153717
Epoch: 10, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.416 Vali Acc: 0.658 Test Loss: 1.416 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2592398
	speed: 0.7697s/iter; left time: 25484.9622s
	iters: 200, epoch: 11 | loss: 0.1894224
	speed: 0.2507s/iter; left time: 8274.3591s
	iters: 300, epoch: 11 | loss: 0.1189217
	speed: 0.2436s/iter; left time: 8016.7075s
Epoch: 11 cost time: 92.0127305984497
Epoch: 11, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.495 Vali Acc: 0.663 Test Loss: 1.495 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0172933
	speed: 0.7768s/iter; left time: 25435.0107s
	iters: 200, epoch: 12 | loss: 0.0794461
	speed: 0.2594s/iter; left time: 8467.7698s
	iters: 300, epoch: 12 | loss: 0.1368812
	speed: 0.2422s/iter; left time: 7883.2146s
Epoch: 12 cost time: 94.11156964302063
Epoch: 12, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.572 Vali Acc: 0.671 Test Loss: 1.572 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0275424
	speed: 0.7786s/iter; left time: 25206.8664s
	iters: 200, epoch: 13 | loss: 0.0526285
	speed: 0.2460s/iter; left time: 7938.7165s
	iters: 300, epoch: 13 | loss: 0.0409279
	speed: 0.2662s/iter; left time: 8562.9033s
Epoch: 13 cost time: 92.88347601890564
Epoch: 13, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.674 Vali Acc: 0.668 Test Loss: 1.674 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0459599
	speed: 0.7618s/iter; left time: 24380.0860s
	iters: 200, epoch: 14 | loss: 0.1165868
	speed: 0.2634s/iter; left time: 8402.7537s
	iters: 300, epoch: 14 | loss: 0.0232331
	speed: 0.2665s/iter; left time: 8475.2413s
Epoch: 14 cost time: 96.332923412323
Epoch: 14, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.900 Vali Acc: 0.648 Test Loss: 1.900 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1725366
	speed: 0.7670s/iter; left time: 24264.0084s
	iters: 200, epoch: 15 | loss: 0.3850738
	speed: 0.2426s/iter; left time: 7650.0598s
	iters: 300, epoch: 15 | loss: 0.0054246
	speed: 0.2452s/iter; left time: 7706.7247s
Epoch: 15 cost time: 92.50287079811096
Epoch: 15, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.859 Vali Acc: 0.655 Test Loss: 1.859 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6713961407491487
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7141037
	speed: 0.2747s/iter; left time: 10109.7393s
	iters: 200, epoch: 1 | loss: 0.5659376
	speed: 0.2605s/iter; left time: 9562.3761s
	iters: 300, epoch: 1 | loss: 0.6975152
	speed: 0.2735s/iter; left time: 10011.7832s
Epoch: 1 cost time: 98.51188802719116
Epoch: 1, Steps: 369 | Train Loss: 0.695 Vali Loss: 0.742 Vali Acc: 0.607 Test Loss: 0.742 Test Acc: 0.607
Validation loss decreased (inf --> -0.606690).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4421556
	speed: 0.7939s/iter; left time: 28922.3012s
	iters: 200, epoch: 2 | loss: 0.4822669
	speed: 0.2648s/iter; left time: 9621.0621s
	iters: 300, epoch: 2 | loss: 0.6711195
	speed: 0.2636s/iter; left time: 9550.5618s
Epoch: 2 cost time: 98.1924774646759
Epoch: 2, Steps: 369 | Train Loss: 0.552 Vali Loss: 0.720 Vali Acc: 0.650 Test Loss: 0.720 Test Acc: 0.650
Validation loss decreased (-0.606690 --> -0.650106).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2383935
	speed: 0.7970s/iter; left time: 28741.1435s
	iters: 200, epoch: 3 | loss: 0.7558163
	speed: 0.2648s/iter; left time: 9523.3749s
	iters: 300, epoch: 3 | loss: 0.2185755
	speed: 0.2816s/iter; left time: 10100.5802s
Epoch: 3 cost time: 99.79705357551575
Epoch: 3, Steps: 369 | Train Loss: 0.473 Vali Loss: 0.779 Vali Acc: 0.671 Test Loss: 0.779 Test Acc: 0.671
Validation loss decreased (-0.650106 --> -0.670821).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5101297
	speed: 0.8338s/iter; left time: 29762.9841s
	iters: 200, epoch: 4 | loss: 0.4308558
	speed: 0.2712s/iter; left time: 9654.7031s
	iters: 300, epoch: 4 | loss: 0.3007374
	speed: 0.2632s/iter; left time: 9340.3786s
Epoch: 4 cost time: 98.42703628540039
Epoch: 4, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.808 Vali Acc: 0.660 Test Loss: 0.808 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2758296
	speed: 0.8065s/iter; left time: 28490.6099s
	iters: 200, epoch: 5 | loss: 0.3738341
	speed: 0.2524s/iter; left time: 8889.2742s
	iters: 300, epoch: 5 | loss: 0.4073654
	speed: 0.2484s/iter; left time: 8725.7581s
Epoch: 5 cost time: 92.02496695518494
Epoch: 5, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.990 Vali Acc: 0.678 Test Loss: 0.990 Test Acc: 0.678
Validation loss decreased (-0.670821 --> -0.677913).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2761707
	speed: 0.7695s/iter; left time: 26897.0701s
	iters: 200, epoch: 6 | loss: 0.3461540
	speed: 0.2448s/iter; left time: 8531.8049s
	iters: 300, epoch: 6 | loss: 0.3150445
	speed: 0.2465s/iter; left time: 8565.7430s
Epoch: 6 cost time: 91.5006194114685
Epoch: 6, Steps: 369 | Train Loss: 0.339 Vali Loss: 1.046 Vali Acc: 0.664 Test Loss: 1.046 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1274262
	speed: 0.7856s/iter; left time: 27172.9690s
	iters: 200, epoch: 7 | loss: 0.2612990
	speed: 0.2469s/iter; left time: 8515.8975s
	iters: 300, epoch: 7 | loss: 0.3332115
	speed: 0.2489s/iter; left time: 8557.2266s
Epoch: 7 cost time: 92.42708110809326
Epoch: 7, Steps: 369 | Train Loss: 0.293 Vali Loss: 1.042 Vali Acc: 0.658 Test Loss: 1.042 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0970289
	speed: 0.7685s/iter; left time: 26297.1894s
	iters: 200, epoch: 8 | loss: 0.2283799
	speed: 0.2424s/iter; left time: 8269.4739s
	iters: 300, epoch: 8 | loss: 0.1928710
	speed: 0.2444s/iter; left time: 8315.2664s
Epoch: 8 cost time: 90.10971784591675
Epoch: 8, Steps: 369 | Train Loss: 0.251 Vali Loss: 1.246 Vali Acc: 0.664 Test Loss: 1.246 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1934224
	speed: 0.7782s/iter; left time: 26342.6548s
	iters: 200, epoch: 9 | loss: 0.2004793
	speed: 0.2456s/iter; left time: 8287.1333s
	iters: 300, epoch: 9 | loss: 0.2484669
	speed: 0.2459s/iter; left time: 8272.7394s
Epoch: 9 cost time: 91.44577670097351
Epoch: 9, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.380 Vali Acc: 0.656 Test Loss: 1.380 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0810713
	speed: 0.7849s/iter; left time: 26278.5466s
	iters: 200, epoch: 10 | loss: 0.1843119
	speed: 0.2519s/iter; left time: 8409.4174s
	iters: 300, epoch: 10 | loss: 0.2037196
	speed: 0.2528s/iter; left time: 8411.8300s
Epoch: 10 cost time: 94.17646145820618
Epoch: 10, Steps: 369 | Train Loss: 0.181 Vali Loss: 1.494 Vali Acc: 0.653 Test Loss: 1.494 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1951924
	speed: 0.7881s/iter; left time: 26094.2403s
	iters: 200, epoch: 11 | loss: 0.1406115
	speed: 0.2619s/iter; left time: 8646.5999s
	iters: 300, epoch: 11 | loss: 0.1385433
	speed: 0.2696s/iter; left time: 8874.1496s
Epoch: 11 cost time: 97.36019539833069
Epoch: 11, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.437 Vali Acc: 0.656 Test Loss: 1.437 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6251011
	speed: 0.8167s/iter; left time: 26740.5859s
	iters: 200, epoch: 12 | loss: 0.1695593
	speed: 0.2565s/iter; left time: 8371.6840s
	iters: 300, epoch: 12 | loss: 0.4936445
	speed: 0.2555s/iter; left time: 8314.0540s
Epoch: 12 cost time: 95.82849168777466
Epoch: 12, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.748 Vali Acc: 0.647 Test Loss: 1.748 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1034433
	speed: 0.7892s/iter; left time: 25549.5359s
	iters: 200, epoch: 13 | loss: 0.0768329
	speed: 0.2501s/iter; left time: 8071.8294s
	iters: 300, epoch: 13 | loss: 0.0355689
	speed: 0.2471s/iter; left time: 7949.0899s
Epoch: 13 cost time: 92.41705417633057
Epoch: 13, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.772 Vali Acc: 0.650 Test Loss: 1.772 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1279857
	speed: 0.7768s/iter; left time: 24860.7569s
	iters: 200, epoch: 14 | loss: 0.0775445
	speed: 0.2531s/iter; left time: 8074.5650s
	iters: 300, epoch: 14 | loss: 0.0794135
	speed: 0.2374s/iter; left time: 7549.8535s
Epoch: 14 cost time: 91.62729287147522
Epoch: 14, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.843 Vali Acc: 0.646 Test Loss: 1.843 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.2921187
	speed: 0.7784s/iter; left time: 24624.0664s
	iters: 200, epoch: 15 | loss: 0.4694631
	speed: 0.2550s/iter; left time: 8041.9842s
	iters: 300, epoch: 15 | loss: 0.2369729
	speed: 0.2412s/iter; left time: 7582.0514s
Epoch: 15 cost time: 91.59099531173706
Epoch: 15, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.900 Vali Acc: 0.654 Test Loss: 1.900 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6779228149829739
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6632389
	speed: 0.2861s/iter; left time: 10528.7116s
	iters: 200, epoch: 1 | loss: 0.8054858
	speed: 0.2418s/iter; left time: 8874.1742s
	iters: 300, epoch: 1 | loss: 0.7736194
	speed: 0.2373s/iter; left time: 8686.5940s
Epoch: 1 cost time: 93.71262454986572
Epoch: 1, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.777 Vali Acc: 0.593 Test Loss: 0.777 Test Acc: 0.593
Validation loss decreased (inf --> -0.592785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5942837
	speed: 0.7639s/iter; left time: 27829.7281s
	iters: 200, epoch: 2 | loss: 0.6651080
	speed: 0.2431s/iter; left time: 8832.7563s
	iters: 300, epoch: 2 | loss: 0.7116705
	speed: 0.2477s/iter; left time: 8974.6848s
Epoch: 2 cost time: 90.04598474502563
Epoch: 2, Steps: 369 | Train Loss: 0.563 Vali Loss: 0.716 Vali Acc: 0.663 Test Loss: 0.716 Test Acc: 0.663
Validation loss decreased (-0.592785 --> -0.662876).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4043534
	speed: 0.7751s/iter; left time: 27953.4231s
	iters: 200, epoch: 3 | loss: 0.9209588
	speed: 0.2544s/iter; left time: 9147.5792s
	iters: 300, epoch: 3 | loss: 0.0877955
	speed: 0.2539s/iter; left time: 9104.5614s
Epoch: 3 cost time: 92.99674654006958
Epoch: 3, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.776 Vali Acc: 0.665 Test Loss: 0.776 Test Acc: 0.665
Validation loss decreased (-0.662876 --> -0.664578).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3232588
	speed: 0.8049s/iter; left time: 28729.2532s
	iters: 200, epoch: 4 | loss: 0.3215572
	speed: 0.2482s/iter; left time: 8834.1619s
	iters: 300, epoch: 4 | loss: 0.2773980
	speed: 0.2565s/iter; left time: 9104.5852s
Epoch: 4 cost time: 95.62299466133118
Epoch: 4, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.782 Vali Acc: 0.671 Test Loss: 0.782 Test Acc: 0.671
Validation loss decreased (-0.664578 --> -0.671105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4421627
	speed: 0.8121s/iter; left time: 28688.0966s
	iters: 200, epoch: 5 | loss: 0.3058037
	speed: 0.2617s/iter; left time: 9219.5951s
	iters: 300, epoch: 5 | loss: 0.4427167
	speed: 0.2431s/iter; left time: 8540.3065s
Epoch: 5 cost time: 93.8383367061615
Epoch: 5, Steps: 369 | Train Loss: 0.391 Vali Loss: 0.899 Vali Acc: 0.678 Test Loss: 0.899 Test Acc: 0.678
Validation loss decreased (-0.671105 --> -0.678481).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4477203
	speed: 0.8051s/iter; left time: 28142.9537s
	iters: 200, epoch: 6 | loss: 0.1499303
	speed: 0.2534s/iter; left time: 8833.0675s
	iters: 300, epoch: 6 | loss: 0.3318485
	speed: 0.2485s/iter; left time: 8637.3437s
Epoch: 6 cost time: 94.24315357208252
Epoch: 6, Steps: 369 | Train Loss: 0.345 Vali Loss: 0.927 Vali Acc: 0.667 Test Loss: 0.927 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1057383
	speed: 0.7885s/iter; left time: 27272.4101s
	iters: 200, epoch: 7 | loss: 0.5317885
	speed: 0.2416s/iter; left time: 8331.3077s
	iters: 300, epoch: 7 | loss: 0.6955370
	speed: 0.2423s/iter; left time: 8330.4139s
Epoch: 7 cost time: 89.8042562007904
Epoch: 7, Steps: 369 | Train Loss: 0.308 Vali Loss: 1.110 Vali Acc: 0.663 Test Loss: 1.110 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0748800
	speed: 0.7604s/iter; left time: 26020.1443s
	iters: 200, epoch: 8 | loss: 0.0354250
	speed: 0.2554s/iter; left time: 8713.2185s
	iters: 300, epoch: 8 | loss: 0.5022008
	speed: 0.2498s/iter; left time: 8497.0269s
Epoch: 8 cost time: 93.8442051410675
Epoch: 8, Steps: 369 | Train Loss: 0.272 Vali Loss: 1.165 Vali Acc: 0.637 Test Loss: 1.165 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0571970
	speed: 0.8038s/iter; left time: 27206.6108s
	iters: 200, epoch: 9 | loss: 0.4501074
	speed: 0.2602s/iter; left time: 8782.0808s
	iters: 300, epoch: 9 | loss: 0.1555429
	speed: 0.2482s/iter; left time: 8352.1607s
Epoch: 9 cost time: 93.15870189666748
Epoch: 9, Steps: 369 | Train Loss: 0.240 Vali Loss: 1.299 Vali Acc: 0.650 Test Loss: 1.299 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2364166
	speed: 0.7787s/iter; left time: 26071.8795s
	iters: 200, epoch: 10 | loss: 0.2367832
	speed: 0.2439s/iter; left time: 8140.9641s
	iters: 300, epoch: 10 | loss: 0.0537848
	speed: 0.2456s/iter; left time: 8174.0921s
Epoch: 10 cost time: 90.73683476448059
Epoch: 10, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.358 Vali Acc: 0.660 Test Loss: 1.358 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.3085599
	speed: 0.7842s/iter; left time: 25965.2425s
	iters: 200, epoch: 11 | loss: 0.1371490
	speed: 0.2451s/iter; left time: 8090.3236s
	iters: 300, epoch: 11 | loss: 0.2075823
	speed: 0.2498s/iter; left time: 8220.0702s
Epoch: 11 cost time: 92.97848320007324
Epoch: 11, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.456 Vali Acc: 0.671 Test Loss: 1.456 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0465277
	speed: 0.8093s/iter; left time: 26499.4782s
	iters: 200, epoch: 12 | loss: 0.0738950
	speed: 0.2529s/iter; left time: 8254.1614s
	iters: 300, epoch: 12 | loss: 0.1611706
	speed: 0.2617s/iter; left time: 8515.5293s
Epoch: 12 cost time: 95.36667919158936
Epoch: 12, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.579 Vali Acc: 0.663 Test Loss: 1.579 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2332995
	speed: 0.7896s/iter; left time: 25562.3999s
	iters: 200, epoch: 13 | loss: 0.1036686
	speed: 0.2524s/iter; left time: 8145.7851s
	iters: 300, epoch: 13 | loss: 0.0628946
	speed: 0.2534s/iter; left time: 8154.2083s
Epoch: 13 cost time: 92.26453995704651
Epoch: 13, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.666 Vali Acc: 0.650 Test Loss: 1.666 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0970645
	speed: 0.7929s/iter; left time: 25375.6095s
	iters: 200, epoch: 14 | loss: 0.0097311
	speed: 0.2624s/iter; left time: 8370.4640s
	iters: 300, epoch: 14 | loss: 0.1119394
	speed: 0.2527s/iter; left time: 8036.5344s
Epoch: 14 cost time: 96.84031438827515
Epoch: 14, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.712 Vali Acc: 0.654 Test Loss: 1.712 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.8603061
	speed: 0.8289s/iter; left time: 26223.4957s
	iters: 200, epoch: 15 | loss: 0.0112397
	speed: 0.2713s/iter; left time: 8554.0045s
	iters: 300, epoch: 15 | loss: 0.3143014
	speed: 0.2603s/iter; left time: 8181.9643s
Epoch: 15 cost time: 99.56004357337952
Epoch: 15, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.714 Vali Acc: 0.650 Test Loss: 1.714 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6784903518728718
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7105387
	speed: 0.2660s/iter; left time: 9789.7529s
	iters: 200, epoch: 1 | loss: 0.7193363
	speed: 0.2414s/iter; left time: 8857.8256s
	iters: 300, epoch: 1 | loss: 0.5944492
	speed: 0.2561s/iter; left time: 9372.3677s
Epoch: 1 cost time: 94.2463686466217
Epoch: 1, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.752 Vali Acc: 0.612 Test Loss: 0.752 Test Acc: 0.612
Validation loss decreased (inf --> -0.611797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6544763
	speed: 0.8017s/iter; left time: 29206.8219s
	iters: 200, epoch: 2 | loss: 0.6156362
	speed: 0.2524s/iter; left time: 9171.0554s
	iters: 300, epoch: 2 | loss: 0.7014385
	speed: 0.2510s/iter; left time: 9094.6038s
Epoch: 2 cost time: 94.73670244216919
Epoch: 2, Steps: 369 | Train Loss: 0.568 Vali Loss: 0.727 Vali Acc: 0.671 Test Loss: 0.727 Test Acc: 0.671
Validation loss decreased (-0.611797 --> -0.670538).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3477526
	speed: 0.8173s/iter; left time: 29473.5636s
	iters: 200, epoch: 3 | loss: 0.7056079
	speed: 0.2546s/iter; left time: 9155.6059s
	iters: 300, epoch: 3 | loss: 0.1169239
	speed: 0.2548s/iter; left time: 9138.0487s
Epoch: 3 cost time: 96.33234190940857
Epoch: 3, Steps: 369 | Train Loss: 0.495 Vali Loss: 0.807 Vali Acc: 0.663 Test Loss: 0.807 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5179452
	speed: 0.8067s/iter; left time: 28794.4189s
	iters: 200, epoch: 4 | loss: 0.3690352
	speed: 0.2664s/iter; left time: 9481.1943s
	iters: 300, epoch: 4 | loss: 0.2031448
	speed: 0.2732s/iter; left time: 9696.9730s
Epoch: 4 cost time: 99.34851622581482
Epoch: 4, Steps: 369 | Train Loss: 0.457 Vali Loss: 0.748 Vali Acc: 0.671 Test Loss: 0.748 Test Acc: 0.671
Validation loss decreased (-0.670538 --> -0.671105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6419325
	speed: 0.8219s/iter; left time: 29032.4639s
	iters: 200, epoch: 5 | loss: 0.5176938
	speed: 0.2577s/iter; left time: 9077.2573s
	iters: 300, epoch: 5 | loss: 0.4573125
	speed: 0.2699s/iter; left time: 9481.5897s
Epoch: 5 cost time: 98.47668242454529
Epoch: 5, Steps: 369 | Train Loss: 0.404 Vali Loss: 0.902 Vali Acc: 0.675 Test Loss: 0.902 Test Acc: 0.675
Validation loss decreased (-0.671105 --> -0.674792).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5947962
	speed: 0.8345s/iter; left time: 29170.2232s
	iters: 200, epoch: 6 | loss: 0.4592946
	speed: 0.2673s/iter; left time: 9317.6219s
	iters: 300, epoch: 6 | loss: 0.2611153
	speed: 0.2563s/iter; left time: 8908.6668s
Epoch: 6 cost time: 98.24490404129028
Epoch: 6, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.999 Vali Acc: 0.648 Test Loss: 0.999 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4162068
	speed: 0.8127s/iter; left time: 28107.5612s
	iters: 200, epoch: 7 | loss: 0.5405291
	speed: 0.2428s/iter; left time: 8372.1729s
	iters: 300, epoch: 7 | loss: 0.4596788
	speed: 0.2533s/iter; left time: 8708.8359s
Epoch: 7 cost time: 92.47773766517639
Epoch: 7, Steps: 369 | Train Loss: 0.323 Vali Loss: 1.024 Vali Acc: 0.676 Test Loss: 1.024 Test Acc: 0.676
Validation loss decreased (-0.674792 --> -0.675926).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2176697
	speed: 0.7555s/iter; left time: 25852.2590s
	iters: 200, epoch: 8 | loss: 0.3141895
	speed: 0.2388s/iter; left time: 8147.8972s
	iters: 300, epoch: 8 | loss: 0.3722196
	speed: 0.2414s/iter; left time: 8210.4702s
Epoch: 8 cost time: 90.24338603019714
Epoch: 8, Steps: 369 | Train Loss: 0.304 Vali Loss: 1.090 Vali Acc: 0.646 Test Loss: 1.090 Test Acc: 0.646
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0774670
	speed: 0.7973s/iter; left time: 26989.1786s
	iters: 200, epoch: 9 | loss: 0.2041891
	speed: 0.2647s/iter; left time: 8933.7331s
	iters: 300, epoch: 9 | loss: 0.6110768
	speed: 0.2585s/iter; left time: 8699.3364s
Epoch: 9 cost time: 95.86368083953857
Epoch: 9, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.253 Vali Acc: 0.637 Test Loss: 1.253 Test Acc: 0.637
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1756349
	speed: 0.7931s/iter; left time: 26553.0999s
	iters: 200, epoch: 10 | loss: 0.3335909
	speed: 0.2529s/iter; left time: 8440.4920s
	iters: 300, epoch: 10 | loss: 0.2639075
	speed: 0.2520s/iter; left time: 8388.1378s
Epoch: 10 cost time: 94.47911381721497
Epoch: 10, Steps: 369 | Train Loss: 0.211 Vali Loss: 1.308 Vali Acc: 0.663 Test Loss: 1.308 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.4039192
	speed: 0.8030s/iter; left time: 26587.6278s
	iters: 200, epoch: 11 | loss: 0.1377016
	speed: 0.2546s/iter; left time: 8404.6886s
	iters: 300, epoch: 11 | loss: 0.1766255
	speed: 0.2567s/iter; left time: 8447.1233s
Epoch: 11 cost time: 93.18722581863403
Epoch: 11, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.330 Vali Acc: 0.673 Test Loss: 1.330 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2056308
	speed: 0.7856s/iter; left time: 25721.9036s
	iters: 200, epoch: 12 | loss: 0.2911900
	speed: 0.2470s/iter; left time: 8062.1304s
	iters: 300, epoch: 12 | loss: 0.3106546
	speed: 0.2527s/iter; left time: 8223.5681s
Epoch: 12 cost time: 93.37415146827698
Epoch: 12, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.444 Vali Acc: 0.638 Test Loss: 1.444 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0774202
	speed: 0.8021s/iter; left time: 25964.7798s
	iters: 200, epoch: 13 | loss: 0.0956145
	speed: 0.2571s/iter; left time: 8296.6504s
	iters: 300, epoch: 13 | loss: 0.0536316
	speed: 0.2610s/iter; left time: 8398.3454s
Epoch: 13 cost time: 96.86764621734619
Epoch: 13, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.593 Vali Acc: 0.647 Test Loss: 1.593 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0680960
	speed: 0.8264s/iter; left time: 26448.9280s
	iters: 200, epoch: 14 | loss: 0.2085769
	speed: 0.2549s/iter; left time: 8133.0181s
	iters: 300, epoch: 14 | loss: 0.2647452
	speed: 0.2634s/iter; left time: 8377.3466s
Epoch: 14 cost time: 97.53631639480591
Epoch: 14, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.646 Vali Acc: 0.649 Test Loss: 1.646 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0854287
	speed: 0.8138s/iter; left time: 25745.9222s
	iters: 200, epoch: 15 | loss: 0.0646178
	speed: 0.2555s/iter; left time: 8056.1479s
	iters: 300, epoch: 15 | loss: 0.0171865
	speed: 0.2488s/iter; left time: 7821.6033s
Epoch: 15 cost time: 95.24895691871643
Epoch: 15, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.755 Vali Acc: 0.643 Test Loss: 1.755 Test Acc: 0.643
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0070641
	speed: 0.7917s/iter; left time: 24752.5694s
	iters: 200, epoch: 16 | loss: 0.2392491
	speed: 0.2736s/iter; left time: 8526.0566s
	iters: 300, epoch: 16 | loss: 0.0142387
	speed: 0.2682s/iter; left time: 8331.0935s
Epoch: 16 cost time: 98.02745318412781
Epoch: 16, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.921 Vali Acc: 0.658 Test Loss: 1.921 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0819586
	speed: 0.8049s/iter; left time: 24869.0299s
	iters: 200, epoch: 17 | loss: 0.0838696
	speed: 0.2613s/iter; left time: 8046.7393s
	iters: 300, epoch: 17 | loss: 0.0031237
	speed: 0.2476s/iter; left time: 7599.7344s
Epoch: 17 cost time: 95.61716032028198
Epoch: 17, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.943 Vali Acc: 0.649 Test Loss: 1.943 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6759364358683314
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6931697
	speed: 0.2624s/iter; left time: 9657.3557s
	iters: 200, epoch: 1 | loss: 0.6931619
	speed: 0.2501s/iter; left time: 9179.5377s
	iters: 300, epoch: 1 | loss: 0.6954901
	speed: 0.2535s/iter; left time: 9279.8502s
Epoch: 1 cost time: 94.07592058181763
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6947324
	speed: 0.7728s/iter; left time: 28154.5470s
	iters: 200, epoch: 2 | loss: 0.6922184
	speed: 0.2440s/iter; left time: 8865.3195s
	iters: 300, epoch: 2 | loss: 0.6933597
	speed: 0.2454s/iter; left time: 8890.3198s
Epoch: 2 cost time: 91.02099657058716
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6936964
	speed: 0.7593s/iter; left time: 27381.1723s
	iters: 200, epoch: 3 | loss: 0.6941640
	speed: 0.2446s/iter; left time: 8795.2737s
	iters: 300, epoch: 3 | loss: 0.6928975
	speed: 0.2463s/iter; left time: 8834.3465s
Epoch: 3 cost time: 91.28516554832458
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6945309
	speed: 0.7724s/iter; left time: 27568.9041s
	iters: 200, epoch: 4 | loss: 0.6925744
	speed: 0.2586s/iter; left time: 9204.7762s
	iters: 300, epoch: 4 | loss: 0.6931870
	speed: 0.2518s/iter; left time: 8938.8725s
Epoch: 4 cost time: 93.57403612136841
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6931472
	speed: 0.7928s/iter; left time: 28004.8530s
	iters: 200, epoch: 5 | loss: 0.6934742
	speed: 0.2636s/iter; left time: 9285.3084s
	iters: 300, epoch: 5 | loss: 0.6933588
	speed: 0.2446s/iter; left time: 8590.5522s
Epoch: 5 cost time: 94.03908324241638
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6931486
	speed: 0.7910s/iter; left time: 27651.1024s
	iters: 200, epoch: 6 | loss: 0.6934160
	speed: 0.2558s/iter; left time: 8917.1293s
	iters: 300, epoch: 6 | loss: 0.6932654
	speed: 0.2518s/iter; left time: 8752.4141s
Epoch: 6 cost time: 94.51376724243164
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6903721
	speed: 0.8060s/iter; left time: 27875.9471s
	iters: 200, epoch: 7 | loss: 0.6973203
	speed: 0.2558s/iter; left time: 8822.1370s
	iters: 300, epoch: 7 | loss: 0.6930603
	speed: 0.2591s/iter; left time: 8910.1329s
Epoch: 7 cost time: 95.17101979255676
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6943605
	speed: 0.7996s/iter; left time: 27360.7999s
	iters: 200, epoch: 8 | loss: 0.6889367
	speed: 0.2537s/iter; left time: 8655.1576s
	iters: 300, epoch: 8 | loss: 0.6924520
	speed: 0.2568s/iter; left time: 8735.7523s
Epoch: 8 cost time: 94.05332708358765
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6925254
	speed: 0.7656s/iter; left time: 25916.1131s
	iters: 200, epoch: 9 | loss: 0.6931474
	speed: 0.2443s/iter; left time: 8244.4601s
	iters: 300, epoch: 9 | loss: 0.6933591
	speed: 0.2437s/iter; left time: 8200.8212s
Epoch: 9 cost time: 91.60414862632751
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6933388
	speed: 0.7447s/iter; left time: 24933.9106s
	iters: 200, epoch: 10 | loss: 0.6891584
	speed: 0.2424s/iter; left time: 8092.8919s
	iters: 300, epoch: 10 | loss: 0.6902008
	speed: 0.2426s/iter; left time: 8072.6908s
Epoch: 10 cost time: 87.82646679878235
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6909389
	speed: 0.7336s/iter; left time: 24291.4507s
	iters: 200, epoch: 11 | loss: 0.6893018
	speed: 0.2350s/iter; left time: 7756.5665s
	iters: 300, epoch: 11 | loss: 0.6917695
	speed: 0.2401s/iter; left time: 7902.5838s
Epoch: 11 cost time: 88.88162589073181
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6974627
	speed: 0.7462s/iter; left time: 24432.7383s
	iters: 200, epoch: 12 | loss: 0.6932304
	speed: 0.2477s/iter; left time: 8085.9337s
	iters: 300, epoch: 12 | loss: 0.6928815
	speed: 0.2325s/iter; left time: 7567.2613s
Epoch: 12 cost time: 89.27867531776428
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6942711
	speed: 0.7390s/iter; left time: 23924.6885s
	iters: 200, epoch: 13 | loss: 0.6939596
	speed: 0.2490s/iter; left time: 8034.8313s
	iters: 300, epoch: 13 | loss: 0.6931475
	speed: 0.2460s/iter; left time: 7914.0637s
Epoch: 13 cost time: 90.34194755554199
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.6931600
	speed: 0.7757s/iter; left time: 24826.4804s
	iters: 200, epoch: 14 | loss: 0.6889283
	speed: 0.2530s/iter; left time: 8071.9455s
	iters: 300, epoch: 14 | loss: 0.6949016
	speed: 0.2519s/iter; left time: 8012.0053s
Epoch: 14 cost time: 92.87882900238037
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 559938
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5601958
	speed: 0.2517s/iter; left time: 9261.4883s
	iters: 200, epoch: 1 | loss: 0.6688197
	speed: 0.2382s/iter; left time: 8742.0016s
	iters: 300, epoch: 1 | loss: 0.4894513
	speed: 0.2480s/iter; left time: 9076.1548s
Epoch: 1 cost time: 90.61343336105347
Epoch: 1, Steps: 369 | Train Loss: 0.656 Vali Loss: 0.653 Vali Acc: 0.656 Test Loss: 0.653 Test Acc: 0.656
Validation loss decreased (inf --> -0.655782).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4655509
	speed: 0.7693s/iter; left time: 28027.3292s
	iters: 200, epoch: 2 | loss: 0.8349736
	speed: 0.2415s/iter; left time: 8774.5632s
	iters: 300, epoch: 2 | loss: 0.3177288
	speed: 0.2391s/iter; left time: 8663.0293s
Epoch: 2 cost time: 89.91058301925659
Epoch: 2, Steps: 369 | Train Loss: 0.530 Vali Loss: 0.676 Vali Acc: 0.676 Test Loss: 0.676 Test Acc: 0.676
Validation loss decreased (-0.655782 --> -0.676213).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1237438
	speed: 0.7558s/iter; left time: 27255.2555s
	iters: 200, epoch: 3 | loss: 0.3615144
	speed: 0.2385s/iter; left time: 8575.9940s
	iters: 300, epoch: 3 | loss: 0.3174680
	speed: 0.2374s/iter; left time: 8512.9820s
Epoch: 3 cost time: 89.75192308425903
Epoch: 3, Steps: 369 | Train Loss: 0.443 Vali Loss: 0.775 Vali Acc: 0.647 Test Loss: 0.775 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1389828
	speed: 0.7591s/iter; left time: 27096.5763s
	iters: 200, epoch: 4 | loss: 0.6028162
	speed: 0.2499s/iter; left time: 8893.5140s
	iters: 300, epoch: 4 | loss: 0.4348807
	speed: 0.2480s/iter; left time: 8803.4923s
Epoch: 4 cost time: 91.78044819831848
Epoch: 4, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.893 Vali Acc: 0.666 Test Loss: 0.893 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0947704
	speed: 0.7474s/iter; left time: 26401.4998s
	iters: 200, epoch: 5 | loss: 0.5772942
	speed: 0.2398s/iter; left time: 8446.0865s
	iters: 300, epoch: 5 | loss: 0.1947145
	speed: 0.2352s/iter; left time: 8260.5374s
Epoch: 5 cost time: 88.88979077339172
Epoch: 5, Steps: 369 | Train Loss: 0.321 Vali Loss: 0.995 Vali Acc: 0.660 Test Loss: 0.995 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3324753
	speed: 0.7593s/iter; left time: 26542.0298s
	iters: 200, epoch: 6 | loss: 0.1782137
	speed: 0.2501s/iter; left time: 8717.9749s
	iters: 300, epoch: 6 | loss: 0.3735714
	speed: 0.2488s/iter; left time: 8648.9386s
Epoch: 6 cost time: 91.53473973274231
Epoch: 6, Steps: 369 | Train Loss: 0.276 Vali Loss: 1.069 Vali Acc: 0.656 Test Loss: 1.069 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1970357
	speed: 0.7711s/iter; left time: 26669.5617s
	iters: 200, epoch: 7 | loss: 0.0484693
	speed: 0.2524s/iter; left time: 8704.0903s
	iters: 300, epoch: 7 | loss: 0.2226044
	speed: 0.2493s/iter; left time: 8572.1527s
Epoch: 7 cost time: 93.10340452194214
Epoch: 7, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.139 Vali Acc: 0.672 Test Loss: 1.139 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.2014342
	speed: 0.7654s/iter; left time: 26190.4622s
	iters: 200, epoch: 8 | loss: 0.5843987
	speed: 0.2501s/iter; left time: 8534.1627s
	iters: 300, epoch: 8 | loss: 0.0895014
	speed: 0.2597s/iter; left time: 8834.3316s
Epoch: 8 cost time: 93.67807149887085
Epoch: 8, Steps: 369 | Train Loss: 0.214 Vali Loss: 1.460 Vali Acc: 0.631 Test Loss: 1.460 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0688678
	speed: 0.7680s/iter; left time: 25995.8522s
	iters: 200, epoch: 9 | loss: 0.0979724
	speed: 0.2362s/iter; left time: 7971.9052s
	iters: 300, epoch: 9 | loss: 0.0864170
	speed: 0.2375s/iter; left time: 7993.1021s
Epoch: 9 cost time: 89.74077033996582
Epoch: 9, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.293 Vali Acc: 0.659 Test Loss: 1.293 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0670905
	speed: 0.7434s/iter; left time: 24888.4901s
	iters: 200, epoch: 10 | loss: 0.1442367
	speed: 0.2425s/iter; left time: 8096.2313s
	iters: 300, epoch: 10 | loss: 0.0885606
	speed: 0.2445s/iter; left time: 8138.3202s
Epoch: 10 cost time: 89.85235071182251
Epoch: 10, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.560 Vali Acc: 0.647 Test Loss: 1.560 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0176529
	speed: 0.7448s/iter; left time: 24662.6014s
	iters: 200, epoch: 11 | loss: 0.0314230
	speed: 0.2384s/iter; left time: 7868.5016s
	iters: 300, epoch: 11 | loss: 0.0422508
	speed: 0.2480s/iter; left time: 8162.4065s
Epoch: 11 cost time: 90.24359488487244
Epoch: 11, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.659 Vali Acc: 0.664 Test Loss: 1.659 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0293835
	speed: 0.7467s/iter; left time: 24447.4827s
	iters: 200, epoch: 12 | loss: 0.0099192
	speed: 0.2290s/iter; left time: 7476.5358s
	iters: 300, epoch: 12 | loss: 0.0484269
	speed: 0.2433s/iter; left time: 7917.5253s
Epoch: 12 cost time: 88.44115972518921
Epoch: 12, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.710 Vali Acc: 0.657 Test Loss: 1.710 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6762202043132803
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6008407
	speed: 0.2818s/iter; left time: 10369.7331s
	iters: 200, epoch: 1 | loss: 0.8349829
	speed: 0.2506s/iter; left time: 9196.5093s
	iters: 300, epoch: 1 | loss: 0.4955715
	speed: 0.2655s/iter; left time: 9717.3323s
Epoch: 1 cost time: 98.95846605300903
Epoch: 1, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.683 Vali Acc: 0.642 Test Loss: 0.683 Test Acc: 0.642
Validation loss decreased (inf --> -0.641877).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4393563
	speed: 0.8129s/iter; left time: 29615.2848s
	iters: 200, epoch: 2 | loss: 0.8163321
	speed: 0.2826s/iter; left time: 10267.6241s
	iters: 300, epoch: 2 | loss: 0.3030088
	speed: 0.2639s/iter; left time: 9563.0111s
Epoch: 2 cost time: 100.51698231697083
Epoch: 2, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.661 Vali Acc: 0.668 Test Loss: 0.661 Test Acc: 0.668
Validation loss decreased (-0.641877 --> -0.668268).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2366715
	speed: 0.8112s/iter; left time: 29255.7204s
	iters: 200, epoch: 3 | loss: 0.2897180
	speed: 0.2625s/iter; left time: 9438.7314s
	iters: 300, epoch: 3 | loss: 0.2717707
	speed: 0.2663s/iter; left time: 9551.0298s
Epoch: 3 cost time: 100.01394963264465
Epoch: 3, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.765 Vali Acc: 0.639 Test Loss: 0.765 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1437794
	speed: 0.8883s/iter; left time: 31707.1185s
	iters: 200, epoch: 4 | loss: 0.5165682
	speed: 0.2605s/iter; left time: 9272.5505s
	iters: 300, epoch: 4 | loss: 0.3980242
	speed: 0.2490s/iter; left time: 8839.4119s
Epoch: 4 cost time: 95.19296622276306
Epoch: 4, Steps: 369 | Train Loss: 0.372 Vali Loss: 0.915 Vali Acc: 0.653 Test Loss: 0.915 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2244303
	speed: 0.7808s/iter; left time: 27582.3480s
	iters: 200, epoch: 5 | loss: 0.2848301
	speed: 0.2573s/iter; left time: 9062.5761s
	iters: 300, epoch: 5 | loss: 0.2529015
	speed: 0.2714s/iter; left time: 9534.1581s
Epoch: 5 cost time: 97.65955781936646
Epoch: 5, Steps: 369 | Train Loss: 0.326 Vali Loss: 1.011 Vali Acc: 0.657 Test Loss: 1.011 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1759807
	speed: 0.8142s/iter; left time: 28461.6858s
	iters: 200, epoch: 6 | loss: 0.3538414
	speed: 0.2652s/iter; left time: 9242.8165s
	iters: 300, epoch: 6 | loss: 0.4866018
	speed: 0.2688s/iter; left time: 9342.1596s
Epoch: 6 cost time: 99.80629563331604
Epoch: 6, Steps: 369 | Train Loss: 0.273 Vali Loss: 1.009 Vali Acc: 0.650 Test Loss: 1.009 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1640445
	speed: 0.8006s/iter; left time: 27690.6451s
	iters: 200, epoch: 7 | loss: 0.1390880
	speed: 0.2626s/iter; left time: 9057.3073s
	iters: 300, epoch: 7 | loss: 0.2176274
	speed: 0.2713s/iter; left time: 9329.3810s
Epoch: 7 cost time: 97.56143116950989
Epoch: 7, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.206 Vali Acc: 0.657 Test Loss: 1.206 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.3350920
	speed: 0.8003s/iter; left time: 27383.3544s
	iters: 200, epoch: 8 | loss: 0.5064512
	speed: 0.2760s/iter; left time: 9417.4133s
	iters: 300, epoch: 8 | loss: 0.1274918
	speed: 0.2765s/iter; left time: 9406.2457s
Epoch: 8 cost time: 101.05657172203064
Epoch: 8, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.362 Vali Acc: 0.645 Test Loss: 1.362 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0177537
	speed: 0.7970s/iter; left time: 26978.1108s
	iters: 200, epoch: 9 | loss: 0.0871695
	speed: 0.2583s/iter; left time: 8718.9856s
	iters: 300, epoch: 9 | loss: 0.1475260
	speed: 0.2591s/iter; left time: 8717.0908s
Epoch: 9 cost time: 96.54405570030212
Epoch: 9, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.375 Vali Acc: 0.654 Test Loss: 1.375 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.1764720
	speed: 0.7886s/iter; left time: 26403.2317s
	iters: 200, epoch: 10 | loss: 0.0768430
	speed: 0.2650s/iter; left time: 8847.1558s
	iters: 300, epoch: 10 | loss: 0.0666227
	speed: 0.2682s/iter; left time: 8924.5976s
Epoch: 10 cost time: 98.85114359855652
Epoch: 10, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.471 Vali Acc: 0.658 Test Loss: 1.471 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2299734
	speed: 0.8050s/iter; left time: 26654.3298s
	iters: 200, epoch: 11 | loss: 0.0434048
	speed: 0.2388s/iter; left time: 7882.2055s
	iters: 300, epoch: 11 | loss: 0.0537298
	speed: 0.2456s/iter; left time: 8084.5682s
Epoch: 11 cost time: 93.33150362968445
Epoch: 11, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.486 Vali Acc: 0.664 Test Loss: 1.486 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.2259983
	speed: 0.7713s/iter; left time: 25252.7783s
	iters: 200, epoch: 12 | loss: 0.3662012
	speed: 0.2519s/iter; left time: 8221.8810s
	iters: 300, epoch: 12 | loss: 0.5320657
	speed: 0.2537s/iter; left time: 8256.9283s
Epoch: 12 cost time: 93.95257568359375
Epoch: 12, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.735 Vali Acc: 0.657 Test Loss: 1.735 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6682746878547106
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5693074
	speed: 0.2595s/iter; left time: 9549.1329s
	iters: 200, epoch: 1 | loss: 0.8742852
	speed: 0.2389s/iter; left time: 8767.8894s
	iters: 300, epoch: 1 | loss: 0.5464210
	speed: 0.2315s/iter; left time: 8471.9042s
Epoch: 1 cost time: 89.14130234718323
Epoch: 1, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.706 Vali Acc: 0.633 Test Loss: 0.706 Test Acc: 0.633
Validation loss decreased (inf --> -0.632797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4581679
	speed: 0.7259s/iter; left time: 26446.3168s
	iters: 200, epoch: 2 | loss: 0.7922520
	speed: 0.2368s/iter; left time: 8602.4940s
	iters: 300, epoch: 2 | loss: 0.3231341
	speed: 0.2444s/iter; left time: 8853.3806s
Epoch: 2 cost time: 89.4119484424591
Epoch: 2, Steps: 369 | Train Loss: 0.529 Vali Loss: 0.667 Vali Acc: 0.660 Test Loss: 0.667 Test Acc: 0.660
Validation loss decreased (-0.632797 --> -0.659755).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3169484
	speed: 0.7344s/iter; left time: 26485.1479s
	iters: 200, epoch: 3 | loss: 0.2747543
	speed: 0.2304s/iter; left time: 8287.0563s
	iters: 300, epoch: 3 | loss: 0.3806698
	speed: 0.2431s/iter; left time: 8718.8934s
Epoch: 3 cost time: 88.9369568824768
Epoch: 3, Steps: 369 | Train Loss: 0.449 Vali Loss: 0.794 Vali Acc: 0.644 Test Loss: 0.794 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1762249
	speed: 0.7606s/iter; left time: 27148.2951s
	iters: 200, epoch: 4 | loss: 0.4615092
	speed: 0.2349s/iter; left time: 8360.5798s
	iters: 300, epoch: 4 | loss: 0.6825154
	speed: 0.2376s/iter; left time: 8434.5528s
Epoch: 4 cost time: 88.01779437065125
Epoch: 4, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.877 Vali Acc: 0.657 Test Loss: 0.877 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1382603
	speed: 0.7551s/iter; left time: 26673.3541s
	iters: 200, epoch: 5 | loss: 0.4794770
	speed: 0.2467s/iter; left time: 8689.1580s
	iters: 300, epoch: 5 | loss: 0.1724898
	speed: 0.2393s/iter; left time: 8407.0476s
Epoch: 5 cost time: 90.5963397026062
Epoch: 5, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.952 Vali Acc: 0.658 Test Loss: 0.952 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0399476
	speed: 0.7330s/iter; left time: 25622.8511s
	iters: 200, epoch: 6 | loss: 0.3495051
	speed: 0.2415s/iter; left time: 8417.9359s
	iters: 300, epoch: 6 | loss: 0.8920633
	speed: 0.2462s/iter; left time: 8556.3857s
Epoch: 6 cost time: 88.97682929039001
Epoch: 6, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.020 Vali Acc: 0.663 Test Loss: 1.020 Test Acc: 0.663
Validation loss decreased (-0.659755 --> -0.662873).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3148478
	speed: 0.7200s/iter; left time: 24901.6787s
	iters: 200, epoch: 7 | loss: 0.1789016
	speed: 0.2431s/iter; left time: 8384.6202s
	iters: 300, epoch: 7 | loss: 0.1125560
	speed: 0.2357s/iter; left time: 8104.5124s
Epoch: 7 cost time: 88.22211694717407
Epoch: 7, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.176 Vali Acc: 0.661 Test Loss: 1.176 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4377134
	speed: 0.7481s/iter; left time: 25597.9490s
	iters: 200, epoch: 8 | loss: 0.3245956
	speed: 0.2315s/iter; left time: 7897.1487s
	iters: 300, epoch: 8 | loss: 0.0864090
	speed: 0.2282s/iter; left time: 7761.8585s
Epoch: 8 cost time: 87.07628512382507
Epoch: 8, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.437 Vali Acc: 0.641 Test Loss: 1.437 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0253008
	speed: 0.7356s/iter; left time: 24899.1376s
	iters: 200, epoch: 9 | loss: 0.0675569
	speed: 0.2237s/iter; left time: 7551.0606s
	iters: 300, epoch: 9 | loss: 0.3655210
	speed: 0.2350s/iter; left time: 7905.8353s
Epoch: 9 cost time: 85.91406655311584
Epoch: 9, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.264 Vali Acc: 0.669 Test Loss: 1.264 Test Acc: 0.669
Validation loss decreased (-0.662873 --> -0.669397).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1463608
	speed: 0.7212s/iter; left time: 24145.2559s
	iters: 200, epoch: 10 | loss: 0.1714944
	speed: 0.2352s/iter; left time: 7851.2178s
	iters: 300, epoch: 10 | loss: 0.0628624
	speed: 0.2372s/iter; left time: 7894.9237s
Epoch: 10 cost time: 88.13526725769043
Epoch: 10, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.491 Vali Acc: 0.647 Test Loss: 1.491 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0483701
	speed: 0.7406s/iter; left time: 24522.2762s
	iters: 200, epoch: 11 | loss: 0.0569383
	speed: 0.2372s/iter; left time: 7828.6869s
	iters: 300, epoch: 11 | loss: 0.1740452
	speed: 0.2298s/iter; left time: 7561.5944s
Epoch: 11 cost time: 87.96864652633667
Epoch: 11, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.567 Vali Acc: 0.657 Test Loss: 1.567 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1551425
	speed: 0.7213s/iter; left time: 23617.2401s
	iters: 200, epoch: 12 | loss: 0.0804313
	speed: 0.2295s/iter; left time: 7491.8043s
	iters: 300, epoch: 12 | loss: 0.2330839
	speed: 0.2419s/iter; left time: 7870.3977s
Epoch: 12 cost time: 87.10385251045227
Epoch: 12, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.533 Vali Acc: 0.662 Test Loss: 1.533 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0870847
	speed: 0.7472s/iter; left time: 24187.6303s
	iters: 200, epoch: 13 | loss: 0.0040993
	speed: 0.2567s/iter; left time: 8284.9186s
	iters: 300, epoch: 13 | loss: 0.1209812
	speed: 0.2485s/iter; left time: 7996.0486s
Epoch: 13 cost time: 93.99086809158325
Epoch: 13, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.774 Vali Acc: 0.646 Test Loss: 1.774 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0673662
	speed: 0.7767s/iter; left time: 24856.6077s
	iters: 200, epoch: 14 | loss: 0.0307459
	speed: 0.2592s/iter; left time: 8268.1575s
	iters: 300, epoch: 14 | loss: 0.4297725
	speed: 0.2521s/iter; left time: 8016.9963s
Epoch: 14 cost time: 94.97144532203674
Epoch: 14, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.759 Vali Acc: 0.653 Test Loss: 1.759 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0195662
	speed: 0.7732s/iter; left time: 24458.7449s
	iters: 200, epoch: 15 | loss: 0.1141817
	speed: 0.2563s/iter; left time: 8083.8802s
	iters: 300, epoch: 15 | loss: 0.0049509
	speed: 0.2564s/iter; left time: 8058.7658s
Epoch: 15 cost time: 95.161691904068
Epoch: 15, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.794 Vali Acc: 0.669 Test Loss: 1.794 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.3273917
	speed: 0.7911s/iter; left time: 24735.3538s
	iters: 200, epoch: 16 | loss: 0.0219705
	speed: 0.2497s/iter; left time: 7783.6012s
	iters: 300, epoch: 16 | loss: 0.0202359
	speed: 0.2426s/iter; left time: 7536.5257s
Epoch: 16 cost time: 92.3511574268341
Epoch: 16, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.982 Vali Acc: 0.669 Test Loss: 1.982 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2807406
	speed: 0.7986s/iter; left time: 24672.9162s
	iters: 200, epoch: 17 | loss: 0.0245129
	speed: 0.2728s/iter; left time: 8401.9448s
	iters: 300, epoch: 17 | loss: 0.0027884
	speed: 0.2520s/iter; left time: 7735.9125s
Epoch: 17 cost time: 97.05948543548584
Epoch: 17, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.976 Vali Acc: 0.661 Test Loss: 1.976 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2076159
	speed: 0.7870s/iter; left time: 24025.7053s
	iters: 200, epoch: 18 | loss: 0.0152240
	speed: 0.2445s/iter; left time: 7440.1781s
	iters: 300, epoch: 18 | loss: 0.0096805
	speed: 0.2369s/iter; left time: 7184.1791s
Epoch: 18 cost time: 89.8934395313263
Epoch: 18, Steps: 369 | Train Loss: 0.096 Vali Loss: 2.093 Vali Acc: 0.657 Test Loss: 2.093 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1758157
	speed: 0.7325s/iter; left time: 22090.5734s
	iters: 200, epoch: 19 | loss: 0.3426352
	speed: 0.2478s/iter; left time: 7447.4206s
	iters: 300, epoch: 19 | loss: 0.0645256
	speed: 0.2498s/iter; left time: 7482.6945s
Epoch: 19 cost time: 92.0425169467926
Epoch: 19, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.290 Vali Acc: 0.646 Test Loss: 2.290 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6694097616345063
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.5616513
	speed: 0.2521s/iter; left time: 9276.6822s
	iters: 200, epoch: 1 | loss: 0.8293359
	speed: 0.2291s/iter; left time: 8409.5940s
	iters: 300, epoch: 1 | loss: 0.5843369
	speed: 0.2361s/iter; left time: 8642.8801s
Epoch: 1 cost time: 88.79634809494019
Epoch: 1, Steps: 369 | Train Loss: 0.688 Vali Loss: 0.688 Vali Acc: 0.634 Test Loss: 0.688 Test Acc: 0.634
Validation loss decreased (inf --> -0.633932).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4056997
	speed: 0.7387s/iter; left time: 26911.7862s
	iters: 200, epoch: 2 | loss: 0.7212759
	speed: 0.2398s/iter; left time: 8713.5974s
	iters: 300, epoch: 2 | loss: 0.2767524
	speed: 0.2405s/iter; left time: 8714.2477s
Epoch: 2 cost time: 89.8796956539154
Epoch: 2, Steps: 369 | Train Loss: 0.543 Vali Loss: 0.692 Vali Acc: 0.666 Test Loss: 0.692 Test Acc: 0.666
Validation loss decreased (-0.633932 --> -0.666281).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2933896
	speed: 0.7677s/iter; left time: 27685.2706s
	iters: 200, epoch: 3 | loss: 0.3772855
	speed: 0.2479s/iter; left time: 8916.8732s
	iters: 300, epoch: 3 | loss: 0.4192234
	speed: 0.2414s/iter; left time: 8657.0486s
Epoch: 3 cost time: 91.9285728931427
Epoch: 3, Steps: 369 | Train Loss: 0.464 Vali Loss: 0.763 Vali Acc: 0.644 Test Loss: 0.763 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2135430
	speed: 0.7646s/iter; left time: 27291.0715s
	iters: 200, epoch: 4 | loss: 0.6430048
	speed: 0.2493s/iter; left time: 8875.0096s
	iters: 300, epoch: 4 | loss: 0.5969239
	speed: 0.2522s/iter; left time: 8950.9316s
Epoch: 4 cost time: 92.97853088378906
Epoch: 4, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.923 Vali Acc: 0.654 Test Loss: 0.923 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1653651
	speed: 0.7543s/iter; left time: 26646.9376s
	iters: 200, epoch: 5 | loss: 0.3767978
	speed: 0.2448s/iter; left time: 8624.6257s
	iters: 300, epoch: 5 | loss: 0.5089561
	speed: 0.2500s/iter; left time: 8781.2199s
Epoch: 5 cost time: 91.327077627182
Epoch: 5, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.956 Vali Acc: 0.659 Test Loss: 0.956 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.1600586
	speed: 0.7388s/iter; left time: 25824.3656s
	iters: 200, epoch: 6 | loss: 0.2402545
	speed: 0.2379s/iter; left time: 8293.4082s
	iters: 300, epoch: 6 | loss: 0.3755558
	speed: 0.2460s/iter; left time: 8551.4219s
Epoch: 6 cost time: 90.56774520874023
Epoch: 6, Steps: 369 | Train Loss: 0.282 Vali Loss: 1.018 Vali Acc: 0.650 Test Loss: 1.018 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2091685
	speed: 0.7483s/iter; left time: 25881.2718s
	iters: 200, epoch: 7 | loss: 0.0762013
	speed: 0.2481s/iter; left time: 8557.3136s
	iters: 300, epoch: 7 | loss: 0.2297266
	speed: 0.2435s/iter; left time: 8374.1650s
Epoch: 7 cost time: 90.9202721118927
Epoch: 7, Steps: 369 | Train Loss: 0.245 Vali Loss: 1.170 Vali Acc: 0.653 Test Loss: 1.170 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1100497
	speed: 0.7250s/iter; left time: 24807.3951s
	iters: 200, epoch: 8 | loss: 0.6806007
	speed: 0.2308s/iter; left time: 7874.0669s
	iters: 300, epoch: 8 | loss: 0.2783774
	speed: 0.2331s/iter; left time: 7927.9631s
Epoch: 8 cost time: 87.27495169639587
Epoch: 8, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.315 Vali Acc: 0.651 Test Loss: 1.315 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0510034
	speed: 0.7678s/iter; left time: 25990.3997s
	iters: 200, epoch: 9 | loss: 0.1680851
	speed: 0.2521s/iter; left time: 8506.8018s
	iters: 300, epoch: 9 | loss: 0.5835466
	speed: 0.2467s/iter; left time: 8302.7499s
Epoch: 9 cost time: 94.15791773796082
Epoch: 9, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.320 Vali Acc: 0.655 Test Loss: 1.320 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0949584
	speed: 0.7662s/iter; left time: 25651.8068s
	iters: 200, epoch: 10 | loss: 0.0407413
	speed: 0.2447s/iter; left time: 8167.2760s
	iters: 300, epoch: 10 | loss: 0.2027399
	speed: 0.2556s/iter; left time: 8504.9559s
Epoch: 10 cost time: 93.29517269134521
Epoch: 10, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.598 Vali Acc: 0.657 Test Loss: 1.598 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1201268
	speed: 0.7774s/iter; left time: 25739.1663s
	iters: 200, epoch: 11 | loss: 0.1427065
	speed: 0.2479s/iter; left time: 8184.3159s
	iters: 300, epoch: 11 | loss: 0.0514998
	speed: 0.2569s/iter; left time: 8455.4687s
Epoch: 11 cost time: 93.8632435798645
Epoch: 11, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.757 Vali Acc: 0.663 Test Loss: 1.757 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.3160594
	speed: 0.7555s/iter; left time: 24737.8778s
	iters: 200, epoch: 12 | loss: 0.3552848
	speed: 0.2638s/iter; left time: 8612.0419s
	iters: 300, epoch: 12 | loss: 0.5384693
	speed: 0.2410s/iter; left time: 7844.0295s
Epoch: 12 cost time: 92.57004356384277
Epoch: 12, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.713 Vali Acc: 0.657 Test Loss: 1.713 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6662883087400681
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6938144
	speed: 0.2685s/iter; left time: 9881.6112s
	iters: 200, epoch: 1 | loss: 0.8475373
	speed: 0.2621s/iter; left time: 9620.3961s
	iters: 300, epoch: 1 | loss: 0.5824957
	speed: 0.2493s/iter; left time: 9124.0571s
Epoch: 1 cost time: 95.57838463783264
Epoch: 1, Steps: 369 | Train Loss: 0.700 Vali Loss: 0.684 Vali Acc: 0.623 Test Loss: 0.684 Test Acc: 0.623
Validation loss decreased (inf --> -0.623432).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4809251
	speed: 0.7545s/iter; left time: 27487.2749s
	iters: 200, epoch: 2 | loss: 0.8485043
	speed: 0.2504s/iter; left time: 9097.8717s
	iters: 300, epoch: 2 | loss: 0.3391488
	speed: 0.2647s/iter; left time: 9589.1624s
Epoch: 2 cost time: 94.35760474205017
Epoch: 2, Steps: 369 | Train Loss: 0.552 Vali Loss: 0.669 Vali Acc: 0.673 Test Loss: 0.669 Test Acc: 0.673
Validation loss decreased (-0.623432 --> -0.672808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4502086
	speed: 0.7612s/iter; left time: 27449.8628s
	iters: 200, epoch: 3 | loss: 0.2526316
	speed: 0.2243s/iter; left time: 8067.1235s
	iters: 300, epoch: 3 | loss: 0.5156001
	speed: 0.2274s/iter; left time: 8154.7496s
Epoch: 3 cost time: 84.48919296264648
Epoch: 3, Steps: 369 | Train Loss: 0.460 Vali Loss: 0.834 Vali Acc: 0.648 Test Loss: 0.834 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0850152
	speed: 0.6938s/iter; left time: 24763.1055s
	iters: 200, epoch: 4 | loss: 0.3283318
	speed: 0.2180s/iter; left time: 7760.5738s
	iters: 300, epoch: 4 | loss: 0.3510650
	speed: 0.2332s/iter; left time: 8276.0826s
Epoch: 4 cost time: 84.74500918388367
Epoch: 4, Steps: 369 | Train Loss: 0.395 Vali Loss: 0.884 Vali Acc: 0.677 Test Loss: 0.884 Test Acc: 0.677
Validation loss decreased (-0.672808 --> -0.677346).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1178594
	speed: 0.6880s/iter; left time: 24303.6921s
	iters: 200, epoch: 5 | loss: 0.3207435
	speed: 0.2343s/iter; left time: 8251.6399s
	iters: 300, epoch: 5 | loss: 0.3577393
	speed: 0.2339s/iter; left time: 8214.5538s
Epoch: 5 cost time: 86.59786105155945
Epoch: 5, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.957 Vali Acc: 0.661 Test Loss: 0.957 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0608107
	speed: 0.7021s/iter; left time: 24543.3996s
	iters: 200, epoch: 6 | loss: 0.1097969
	speed: 0.2393s/iter; left time: 8342.4872s
	iters: 300, epoch: 6 | loss: 0.5912794
	speed: 0.2259s/iter; left time: 7850.4914s
Epoch: 6 cost time: 85.51714897155762
Epoch: 6, Steps: 369 | Train Loss: 0.301 Vali Loss: 1.010 Vali Acc: 0.674 Test Loss: 1.010 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0533109
	speed: 0.6646s/iter; left time: 22986.2572s
	iters: 200, epoch: 7 | loss: 0.2954027
	speed: 0.2245s/iter; left time: 7742.5638s
	iters: 300, epoch: 7 | loss: 0.1266285
	speed: 0.2234s/iter; left time: 7680.7586s
Epoch: 7 cost time: 83.01035380363464
Epoch: 7, Steps: 369 | Train Loss: 0.255 Vali Loss: 1.102 Vali Acc: 0.663 Test Loss: 1.102 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3657078
	speed: 0.6666s/iter; left time: 22810.3774s
	iters: 200, epoch: 8 | loss: 0.5175073
	speed: 0.2241s/iter; left time: 7647.3109s
	iters: 300, epoch: 8 | loss: 0.0899430
	speed: 0.2191s/iter; left time: 7452.5528s
Epoch: 8 cost time: 83.21646976470947
Epoch: 8, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.287 Vali Acc: 0.673 Test Loss: 1.287 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0240926
	speed: 0.6972s/iter; left time: 23599.4235s
	iters: 200, epoch: 9 | loss: 0.1249200
	speed: 0.2324s/iter; left time: 7844.7545s
	iters: 300, epoch: 9 | loss: 0.0629903
	speed: 0.2230s/iter; left time: 7502.4577s
Epoch: 9 cost time: 85.11182069778442
Epoch: 9, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.296 Vali Acc: 0.657 Test Loss: 1.296 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0199124
	speed: 0.6764s/iter; left time: 22645.7554s
	iters: 200, epoch: 10 | loss: 0.6616488
	speed: 0.2282s/iter; left time: 7616.9864s
	iters: 300, epoch: 10 | loss: 0.0375602
	speed: 0.2264s/iter; left time: 7533.6267s
Epoch: 10 cost time: 82.64606595039368
Epoch: 10, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.474 Vali Acc: 0.667 Test Loss: 1.474 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1361832
	speed: 0.6676s/iter; left time: 22104.6718s
	iters: 200, epoch: 11 | loss: 0.0389544
	speed: 0.2376s/iter; left time: 7845.0276s
	iters: 300, epoch: 11 | loss: 0.2218543
	speed: 0.2296s/iter; left time: 7557.8997s
Epoch: 11 cost time: 85.47212314605713
Epoch: 11, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.551 Vali Acc: 0.672 Test Loss: 1.551 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.9174046
	speed: 0.6878s/iter; left time: 22518.6116s
	iters: 200, epoch: 12 | loss: 0.0132378
	speed: 0.2266s/iter; left time: 7396.5452s
	iters: 300, epoch: 12 | loss: 0.1063867
	speed: 0.2226s/iter; left time: 7243.1681s
Epoch: 12 cost time: 82.28690838813782
Epoch: 12, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.631 Vali Acc: 0.669 Test Loss: 1.631 Test Acc: 0.669
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0181626
	speed: 0.6713s/iter; left time: 21731.6884s
	iters: 200, epoch: 13 | loss: 0.0977447
	speed: 0.2244s/iter; left time: 7241.5296s
	iters: 300, epoch: 13 | loss: 0.0561210
	speed: 0.2185s/iter; left time: 7028.8032s
Epoch: 13 cost time: 82.90762639045715
Epoch: 13, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.666 Vali Acc: 0.661 Test Loss: 1.666 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.3585575
	speed: 0.6643s/iter; left time: 21260.6261s
	iters: 200, epoch: 14 | loss: 0.0628180
	speed: 0.2185s/iter; left time: 6971.3728s
	iters: 300, epoch: 14 | loss: 0.1404237
	speed: 0.2147s/iter; left time: 6828.2365s
Epoch: 14 cost time: 82.2808690071106
Epoch: 14, Steps: 369 | Train Loss: 0.125 Vali Loss: 2.025 Vali Acc: 0.646 Test Loss: 2.025 Test Acc: 0.646
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677355278093076
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6870452
	speed: 0.2297s/iter; left time: 8453.0619s
	iters: 200, epoch: 1 | loss: 0.8292452
	speed: 0.2176s/iter; left time: 7986.5573s
	iters: 300, epoch: 1 | loss: 0.4966028
	speed: 0.2251s/iter; left time: 8239.7089s
Epoch: 1 cost time: 82.72374486923218
Epoch: 1, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.692 Vali Acc: 0.629 Test Loss: 0.692 Test Acc: 0.629
Validation loss decreased (inf --> -0.628824).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5296845
	speed: 0.6767s/iter; left time: 24654.5986s
	iters: 200, epoch: 2 | loss: 0.8336347
	speed: 0.2333s/iter; left time: 8477.7177s
	iters: 300, epoch: 2 | loss: 0.2960054
	speed: 0.2253s/iter; left time: 8163.7109s
Epoch: 2 cost time: 84.1384756565094
Epoch: 2, Steps: 369 | Train Loss: 0.555 Vali Loss: 0.658 Vali Acc: 0.680 Test Loss: 0.658 Test Acc: 0.680
Validation loss decreased (-0.628824 --> -0.679619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4262405
	speed: 0.6582s/iter; left time: 23735.6563s
	iters: 200, epoch: 3 | loss: 0.2030072
	speed: 0.2323s/iter; left time: 8352.6502s
	iters: 300, epoch: 3 | loss: 0.3676405
	speed: 0.2245s/iter; left time: 8052.6932s
Epoch: 3 cost time: 83.12199354171753
Epoch: 3, Steps: 369 | Train Loss: 0.467 Vali Loss: 0.817 Vali Acc: 0.651 Test Loss: 0.817 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2228843
	speed: 0.6983s/iter; left time: 24924.9359s
	iters: 200, epoch: 4 | loss: 0.4141562
	speed: 0.2332s/iter; left time: 8301.7998s
	iters: 300, epoch: 4 | loss: 0.5494541
	speed: 0.2383s/iter; left time: 8456.8888s
Epoch: 4 cost time: 87.75603032112122
Epoch: 4, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.919 Vali Acc: 0.656 Test Loss: 0.919 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1209059
	speed: 0.6918s/iter; left time: 24438.9569s
	iters: 200, epoch: 5 | loss: 0.1986332
	speed: 0.2293s/iter; left time: 8076.4462s
	iters: 300, epoch: 5 | loss: 0.1957226
	speed: 0.2216s/iter; left time: 7782.0730s
Epoch: 5 cost time: 83.42573642730713
Epoch: 5, Steps: 369 | Train Loss: 0.366 Vali Loss: 0.995 Vali Acc: 0.668 Test Loss: 0.995 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2686576
	speed: 0.6866s/iter; left time: 24000.8700s
	iters: 200, epoch: 6 | loss: 0.1141166
	speed: 0.2325s/iter; left time: 8102.4192s
	iters: 300, epoch: 6 | loss: 0.7265855
	speed: 0.2301s/iter; left time: 7997.1900s
Epoch: 6 cost time: 86.46553468704224
Epoch: 6, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.984 Vali Acc: 0.650 Test Loss: 0.984 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3511960
	speed: 0.6854s/iter; left time: 23705.8241s
	iters: 200, epoch: 7 | loss: 0.1627219
	speed: 0.2297s/iter; left time: 7921.7447s
	iters: 300, epoch: 7 | loss: 0.3346573
	speed: 0.2228s/iter; left time: 7660.4535s
Epoch: 7 cost time: 83.9615228176117
Epoch: 7, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.143 Vali Acc: 0.660 Test Loss: 1.143 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1798562
	speed: 0.6517s/iter; left time: 22298.8050s
	iters: 200, epoch: 8 | loss: 0.3576755
	speed: 0.2238s/iter; left time: 7635.3378s
	iters: 300, epoch: 8 | loss: 0.1250931
	speed: 0.2158s/iter; left time: 7339.3884s
Epoch: 8 cost time: 79.75654673576355
Epoch: 8, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.307 Vali Acc: 0.662 Test Loss: 1.307 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0205684
	speed: 0.6422s/iter; left time: 21738.9241s
	iters: 200, epoch: 9 | loss: 0.0636396
	speed: 0.2187s/iter; left time: 7380.9151s
	iters: 300, epoch: 9 | loss: 0.2783656
	speed: 0.2219s/iter; left time: 7466.6578s
Epoch: 9 cost time: 80.66678047180176
Epoch: 9, Steps: 369 | Train Loss: 0.202 Vali Loss: 1.344 Vali Acc: 0.667 Test Loss: 1.344 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0585162
	speed: 0.6663s/iter; left time: 22306.9170s
	iters: 200, epoch: 10 | loss: 0.2909341
	speed: 0.2439s/iter; left time: 8139.9708s
	iters: 300, epoch: 10 | loss: 0.1088776
	speed: 0.2378s/iter; left time: 7912.9448s
Epoch: 10 cost time: 87.36010813713074
Epoch: 10, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.411 Vali Acc: 0.662 Test Loss: 1.411 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0460993
	speed: 0.6812s/iter; left time: 22555.7194s
	iters: 200, epoch: 11 | loss: 0.1280342
	speed: 0.2521s/iter; left time: 8321.5012s
	iters: 300, epoch: 11 | loss: 0.0064311
	speed: 0.2147s/iter; left time: 7064.8407s
Epoch: 11 cost time: 86.28615951538086
Epoch: 11, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.487 Vali Acc: 0.666 Test Loss: 1.487 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.1208974
	speed: 0.6791s/iter; left time: 22235.9422s
	iters: 200, epoch: 12 | loss: 0.1906787
	speed: 0.2252s/iter; left time: 7352.0983s
	iters: 300, epoch: 12 | loss: 0.1611846
	speed: 0.2382s/iter; left time: 7750.5979s
Epoch: 12 cost time: 86.61706781387329
Epoch: 12, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.532 Vali Acc: 0.654 Test Loss: 1.532 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6796254256526674
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7330618
	speed: 0.2490s/iter; left time: 9162.7903s
	iters: 200, epoch: 1 | loss: 0.8335081
	speed: 0.2257s/iter; left time: 8283.0915s
	iters: 300, epoch: 1 | loss: 0.5495020
	speed: 0.2279s/iter; left time: 8342.5929s
Epoch: 1 cost time: 87.44672203063965
Epoch: 1, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.682 Vali Acc: 0.633 Test Loss: 0.682 Test Acc: 0.633
Validation loss decreased (inf --> -0.632797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4989593
	speed: 0.7323s/iter; left time: 26677.6716s
	iters: 200, epoch: 2 | loss: 0.9466651
	speed: 0.2397s/iter; left time: 8709.7188s
	iters: 300, epoch: 2 | loss: 0.2275734
	speed: 0.2397s/iter; left time: 8686.5329s
Epoch: 2 cost time: 88.08995079994202
Epoch: 2, Steps: 369 | Train Loss: 0.561 Vali Loss: 0.670 Vali Acc: 0.682 Test Loss: 0.670 Test Acc: 0.682
Validation loss decreased (-0.632797 --> -0.681605).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5254515
	speed: 0.7212s/iter; left time: 26007.3064s
	iters: 200, epoch: 3 | loss: 0.4393500
	speed: 0.2237s/iter; left time: 8045.2473s
	iters: 300, epoch: 3 | loss: 0.5544600
	speed: 0.2342s/iter; left time: 8399.4209s
Epoch: 3 cost time: 86.6589982509613
Epoch: 3, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.826 Vali Acc: 0.638 Test Loss: 0.826 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0882042
	speed: 0.6922s/iter; left time: 24706.9567s
	iters: 200, epoch: 4 | loss: 0.4142579
	speed: 0.2357s/iter; left time: 8390.5718s
	iters: 300, epoch: 4 | loss: 0.5752724
	speed: 0.2426s/iter; left time: 8610.0303s
Epoch: 4 cost time: 87.71816301345825
Epoch: 4, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.820 Vali Acc: 0.691 Test Loss: 0.820 Test Acc: 0.691
Validation loss decreased (-0.681605 --> -0.691252).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2360136
	speed: 0.7423s/iter; left time: 26222.7444s
	iters: 200, epoch: 5 | loss: 0.2497778
	speed: 0.2376s/iter; left time: 8369.4639s
	iters: 300, epoch: 5 | loss: 0.2336716
	speed: 0.2563s/iter; left time: 9004.0692s
Epoch: 5 cost time: 92.98521590232849
Epoch: 5, Steps: 369 | Train Loss: 0.382 Vali Loss: 0.962 Vali Acc: 0.664 Test Loss: 0.962 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1363989
	speed: 0.7049s/iter; left time: 24640.3544s
	iters: 200, epoch: 6 | loss: 0.4939594
	speed: 0.2245s/iter; left time: 7824.8932s
	iters: 300, epoch: 6 | loss: 0.6176990
	speed: 0.2447s/iter; left time: 8503.7603s
Epoch: 6 cost time: 87.69964241981506
Epoch: 6, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.945 Vali Acc: 0.663 Test Loss: 0.945 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1913829
	speed: 0.7214s/iter; left time: 24949.9856s
	iters: 200, epoch: 7 | loss: 0.1289719
	speed: 0.2465s/iter; left time: 8501.6246s
	iters: 300, epoch: 7 | loss: 0.3083621
	speed: 0.2570s/iter; left time: 8838.3071s
Epoch: 7 cost time: 94.54449391365051
Epoch: 7, Steps: 369 | Train Loss: 0.296 Vali Loss: 1.051 Vali Acc: 0.669 Test Loss: 1.051 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4449169
	speed: 0.7212s/iter; left time: 24679.7281s
	iters: 200, epoch: 8 | loss: 0.3709912
	speed: 0.2205s/iter; left time: 7522.0019s
	iters: 300, epoch: 8 | loss: 0.1477910
	speed: 0.2616s/iter; left time: 8897.7975s
Epoch: 8 cost time: 89.06604242324829
Epoch: 8, Steps: 369 | Train Loss: 0.255 Vali Loss: 1.193 Vali Acc: 0.665 Test Loss: 1.193 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0263375
	speed: 0.6979s/iter; left time: 23622.2692s
	iters: 200, epoch: 9 | loss: 0.1620830
	speed: 0.2377s/iter; left time: 8023.1771s
	iters: 300, epoch: 9 | loss: 0.0869435
	speed: 0.2437s/iter; left time: 8200.1866s
Epoch: 9 cost time: 88.42712807655334
Epoch: 9, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.179 Vali Acc: 0.657 Test Loss: 1.179 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1408330
	speed: 0.7010s/iter; left time: 23468.2356s
	iters: 200, epoch: 10 | loss: 0.1901553
	speed: 0.2351s/iter; left time: 7846.4249s
	iters: 300, epoch: 10 | loss: 0.1573734
	speed: 0.2373s/iter; left time: 7896.2401s
Epoch: 10 cost time: 88.61215090751648
Epoch: 10, Steps: 369 | Train Loss: 0.182 Vali Loss: 1.251 Vali Acc: 0.663 Test Loss: 1.251 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0437284
	speed: 0.7103s/iter; left time: 23518.7953s
	iters: 200, epoch: 11 | loss: 0.0473157
	speed: 0.2259s/iter; left time: 7458.6511s
	iters: 300, epoch: 11 | loss: 0.0733996
	speed: 0.2202s/iter; left time: 7245.5614s
Epoch: 11 cost time: 83.59608340263367
Epoch: 11, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.531 Vali Acc: 0.660 Test Loss: 1.531 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.2144731
	speed: 0.6920s/iter; left time: 22658.4233s
	iters: 200, epoch: 12 | loss: 0.0483663
	speed: 0.2326s/iter; left time: 7594.0311s
	iters: 300, epoch: 12 | loss: 0.0546208
	speed: 0.2452s/iter; left time: 7980.6197s
Epoch: 12 cost time: 88.14212441444397
Epoch: 12, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.492 Vali Acc: 0.664 Test Loss: 1.492 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0365874
	speed: 0.7087s/iter; left time: 22943.8745s
	iters: 200, epoch: 13 | loss: 0.0345323
	speed: 0.2392s/iter; left time: 7719.9675s
	iters: 300, epoch: 13 | loss: 0.0800623
	speed: 0.2355s/iter; left time: 7577.0182s
Epoch: 13 cost time: 88.29271411895752
Epoch: 13, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.556 Vali Acc: 0.663 Test Loss: 1.556 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.4961911
	speed: 0.6861s/iter; left time: 21956.6126s
	iters: 200, epoch: 14 | loss: 0.0376297
	speed: 0.2327s/iter; left time: 7422.5094s
	iters: 300, epoch: 14 | loss: 0.1441850
	speed: 0.2293s/iter; left time: 7292.6273s
Epoch: 14 cost time: 86.64917993545532
Epoch: 14, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.686 Vali Acc: 0.648 Test Loss: 1.686 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6912599318955732
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6920758
	speed: 0.2588s/iter; left time: 9524.7007s
	iters: 200, epoch: 1 | loss: 0.6900047
	speed: 0.2483s/iter; left time: 9114.1771s
	iters: 300, epoch: 1 | loss: 0.6904903
	speed: 0.2341s/iter; left time: 8567.1412s
Epoch: 1 cost time: 90.29979586601257
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6965806
	speed: 0.6783s/iter; left time: 24711.2736s
	iters: 200, epoch: 2 | loss: 0.6931509
	speed: 0.2230s/iter; left time: 8102.5766s
	iters: 300, epoch: 2 | loss: 0.6939582
	speed: 0.2302s/iter; left time: 8341.2903s
Epoch: 2 cost time: 82.34914231300354
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6935567
	speed: 0.6544s/iter; left time: 23601.3127s
	iters: 200, epoch: 3 | loss: 0.6937898
	speed: 0.2240s/iter; left time: 8057.3194s
	iters: 300, epoch: 3 | loss: 0.6937471
	speed: 0.2230s/iter; left time: 7996.4364s
Epoch: 3 cost time: 83.20186233520508
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6942481
	speed: 0.6594s/iter; left time: 23538.3077s
	iters: 200, epoch: 4 | loss: 0.6936703
	speed: 0.2275s/iter; left time: 8097.1832s
	iters: 300, epoch: 4 | loss: 0.6939253
	speed: 0.2262s/iter; left time: 8029.9217s
Epoch: 4 cost time: 84.99235320091248
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6931472
	speed: 0.6947s/iter; left time: 24541.9800s
	iters: 200, epoch: 5 | loss: 0.6932260
	speed: 0.2282s/iter; left time: 8039.1468s
	iters: 300, epoch: 5 | loss: 0.6910750
	speed: 0.2255s/iter; left time: 7922.0127s
Epoch: 5 cost time: 84.60399556159973
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6931472
	speed: 0.6604s/iter; left time: 23084.4971s
	iters: 200, epoch: 6 | loss: 0.6931480
	speed: 0.2218s/iter; left time: 7732.7878s
	iters: 300, epoch: 6 | loss: 0.6934694
	speed: 0.2077s/iter; left time: 7218.1812s
Epoch: 6 cost time: 80.98893713951111
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6936715
	speed: 0.6670s/iter; left time: 23069.4182s
	iters: 200, epoch: 7 | loss: 0.6931646
	speed: 0.2216s/iter; left time: 7641.5841s
	iters: 300, epoch: 7 | loss: 0.6938413
	speed: 0.2288s/iter; left time: 7866.1039s
Epoch: 7 cost time: 83.16509366035461
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6924384
	speed: 0.6746s/iter; left time: 23083.7950s
	iters: 200, epoch: 8 | loss: 0.6912974
	speed: 0.2264s/iter; left time: 7724.2292s
	iters: 300, epoch: 8 | loss: 0.6931123
	speed: 0.2229s/iter; left time: 7581.1018s
Epoch: 8 cost time: 83.87262964248657
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6927279
	speed: 0.6744s/iter; left time: 22827.1378s
	iters: 200, epoch: 9 | loss: 0.6916043
	speed: 0.2205s/iter; left time: 7442.6379s
	iters: 300, epoch: 9 | loss: 0.6970985
	speed: 0.2222s/iter; left time: 7478.0447s
Epoch: 9 cost time: 82.27847719192505
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6943091
	speed: 0.6656s/iter; left time: 22285.1841s
	iters: 200, epoch: 10 | loss: 0.6975673
	speed: 0.2233s/iter; left time: 7453.8494s
	iters: 300, epoch: 10 | loss: 0.6940200
	speed: 0.2145s/iter; left time: 7137.6921s
Epoch: 10 cost time: 81.48462581634521
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6934985
	speed: 0.6568s/iter; left time: 21748.1366s
	iters: 200, epoch: 11 | loss: 0.6927095
	speed: 0.2218s/iter; left time: 7320.9304s
	iters: 300, epoch: 11 | loss: 0.6952920
	speed: 0.2264s/iter; left time: 7451.8859s
Epoch: 11 cost time: 82.42219305038452
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6931475
	speed: 0.6638s/iter; left time: 21733.4989s
	iters: 200, epoch: 12 | loss: 0.6941578
	speed: 0.2228s/iter; left time: 7272.7479s
	iters: 300, epoch: 12 | loss: 0.6932690
	speed: 0.2243s/iter; left time: 7298.3852s
Epoch: 12 cost time: 82.36733770370483
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6936970
	speed: 0.6688s/iter; left time: 21649.8472s
	iters: 200, epoch: 13 | loss: 0.6901385
	speed: 0.2294s/iter; left time: 7403.1883s
	iters: 300, epoch: 13 | loss: 0.6931476
	speed: 0.2173s/iter; left time: 6991.8001s
Epoch: 13 cost time: 81.53705978393555
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6930120
	speed: 0.6496s/iter; left time: 20789.4421s
	iters: 200, epoch: 14 | loss: 0.6917292
	speed: 0.2209s/iter; left time: 7049.1782s
	iters: 300, epoch: 14 | loss: 0.6939411
	speed: 0.2184s/iter; left time: 6945.1875s
Epoch: 14 cost time: 81.0795533657074
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6920432
	speed: 0.6628s/iter; left time: 20966.3634s
	iters: 200, epoch: 15 | loss: 0.6950736
	speed: 0.2236s/iter; left time: 7051.3419s
	iters: 300, epoch: 15 | loss: 0.6927472
	speed: 0.2295s/iter; left time: 7215.6372s
Epoch: 15 cost time: 83.0991861820221
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6983559
	speed: 0.6806s/iter; left time: 21281.0222s
	iters: 200, epoch: 16 | loss: 0.6939247
	speed: 0.2185s/iter; left time: 6809.8926s
	iters: 300, epoch: 16 | loss: 0.6929339
	speed: 0.2300s/iter; left time: 7146.4420s
Epoch: 16 cost time: 83.82277131080627
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6931757
	speed: 0.6813s/iter; left time: 21049.1641s
	iters: 200, epoch: 17 | loss: 0.6934897
	speed: 0.2139s/iter; left time: 6586.5602s
	iters: 300, epoch: 17 | loss: 0.7005811
	speed: 0.2251s/iter; left time: 6911.3348s
Epoch: 17 cost time: 83.14890956878662
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6931360
	speed: 0.6588s/iter; left time: 20112.0141s
	iters: 200, epoch: 18 | loss: 0.6917670
	speed: 0.2263s/iter; left time: 6885.5781s
	iters: 300, epoch: 18 | loss: 0.6943558
	speed: 0.2076s/iter; left time: 6295.3403s
Epoch: 18 cost time: 81.19922876358032
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6900502
	speed: 0.6468s/iter; left time: 19507.7119s
	iters: 200, epoch: 19 | loss: 0.6909271
	speed: 0.2206s/iter; left time: 6631.5978s
	iters: 300, epoch: 19 | loss: 0.6917257
	speed: 0.2134s/iter; left time: 6394.5896s
Epoch: 19 cost time: 81.30961537361145
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6895488
	speed: 0.6600s/iter; left time: 19660.3027s
	iters: 200, epoch: 20 | loss: 0.6932673
	speed: 0.2213s/iter; left time: 6570.5246s
	iters: 300, epoch: 20 | loss: 0.6938140
	speed: 0.2238s/iter; left time: 6622.0724s
Epoch: 20 cost time: 81.5418746471405
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6932082
	speed: 0.6675s/iter; left time: 19639.7037s
	iters: 200, epoch: 21 | loss: 0.6921507
	speed: 0.2247s/iter; left time: 6589.8401s
	iters: 300, epoch: 21 | loss: 0.6909560
	speed: 0.2195s/iter; left time: 6415.0143s
Epoch: 21 cost time: 82.47642397880554
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6912285
	speed: 0.6682s/iter; left time: 19412.7355s
	iters: 200, epoch: 22 | loss: 0.6934406
	speed: 0.2303s/iter; left time: 6668.7961s
	iters: 300, epoch: 22 | loss: 0.6893450
	speed: 0.2193s/iter; left time: 6328.1856s
Epoch: 22 cost time: 84.08367848396301
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.6927732
	speed: 0.6888s/iter; left time: 19757.6502s
	iters: 200, epoch: 23 | loss: 0.6944892
	speed: 0.2315s/iter; left time: 6617.8926s
	iters: 300, epoch: 23 | loss: 0.6927764
	speed: 0.2243s/iter; left time: 6389.6000s
Epoch: 23 cost time: 84.78998303413391
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.6974216
	speed: 0.6937s/iter; left time: 19640.2754s
	iters: 200, epoch: 24 | loss: 0.6931817
	speed: 0.2356s/iter; left time: 6646.9361s
	iters: 300, epoch: 24 | loss: 0.6932504
	speed: 0.2182s/iter; left time: 6134.1203s
Epoch: 24 cost time: 85.70517492294312
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.6931642
	speed: 0.6790s/iter; left time: 18974.0520s
	iters: 200, epoch: 25 | loss: 0.6931706
	speed: 0.2183s/iter; left time: 6077.8675s
	iters: 300, epoch: 25 | loss: 0.6926548
	speed: 0.2193s/iter; left time: 6085.6819s
Epoch: 25 cost time: 81.88222026824951
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.6959330
	speed: 0.6540s/iter; left time: 18034.4528s
	iters: 200, epoch: 26 | loss: 0.6889449
	speed: 0.2258s/iter; left time: 6204.7473s
	iters: 300, epoch: 26 | loss: 0.6951343
	speed: 0.2254s/iter; left time: 6170.1582s
Epoch: 26 cost time: 82.23116731643677
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.6941904
	speed: 0.6461s/iter; left time: 17577.3647s
	iters: 200, epoch: 27 | loss: 0.6961795
	speed: 0.2150s/iter; left time: 5827.2153s
	iters: 300, epoch: 27 | loss: 0.6931718
	speed: 0.2104s/iter; left time: 5683.4310s
Epoch: 27 cost time: 79.51070189476013
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.6944761
	speed: 0.6269s/iter; left time: 16823.6134s
	iters: 200, epoch: 28 | loss: 0.6934813
	speed: 0.2191s/iter; left time: 5859.5765s
	iters: 300, epoch: 28 | loss: 0.6973732
	speed: 0.2164s/iter; left time: 5763.9819s
Epoch: 28 cost time: 79.40493869781494
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.6911394
	speed: 0.6489s/iter; left time: 17176.3193s
	iters: 200, epoch: 29 | loss: 0.6938809
	speed: 0.2156s/iter; left time: 5684.3180s
	iters: 300, epoch: 29 | loss: 0.6931526
	speed: 0.2151s/iter; left time: 5651.3449s
Epoch: 29 cost time: 80.06432390213013
Epoch: 29, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.6939526
	speed: 0.6519s/iter; left time: 17014.0871s
	iters: 200, epoch: 30 | loss: 0.6926050
	speed: 0.2141s/iter; left time: 5565.4015s
	iters: 300, epoch: 30 | loss: 0.6929966
	speed: 0.2102s/iter; left time: 5444.6429s
Epoch: 30 cost time: 79.18319201469421
Epoch: 30, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.6914993
	speed: 0.6504s/iter; left time: 16734.8505s
	iters: 200, epoch: 31 | loss: 0.6931154
	speed: 0.2189s/iter; left time: 5610.1889s
	iters: 300, epoch: 31 | loss: 0.6933112
	speed: 0.2207s/iter; left time: 5635.5534s
Epoch: 31 cost time: 81.6178138256073
Epoch: 31, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.6952710
	speed: 0.6593s/iter; left time: 16721.3073s
	iters: 200, epoch: 32 | loss: 0.6927749
	speed: 0.2136s/iter; left time: 5395.6191s
	iters: 300, epoch: 32 | loss: 0.6921443
	speed: 0.2279s/iter; left time: 5734.6091s
Epoch: 32 cost time: 82.50849938392639
Epoch: 32, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.6938087
	speed: 0.6690s/iter; left time: 16719.3838s
	iters: 200, epoch: 33 | loss: 0.6931568
	speed: 0.2233s/iter; left time: 5559.3520s
	iters: 300, epoch: 33 | loss: 0.7005119
	speed: 0.2205s/iter; left time: 5467.6859s
Epoch: 33 cost time: 81.5795431137085
Epoch: 33, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.6945621
	speed: 0.6569s/iter; left time: 16174.7563s
	iters: 200, epoch: 34 | loss: 0.6931493
	speed: 0.2244s/iter; left time: 5503.3410s
	iters: 300, epoch: 34 | loss: 0.6920895
	speed: 0.2297s/iter; left time: 5609.1780s
Epoch: 34 cost time: 82.71380376815796
Epoch: 34, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.6915179
	speed: 0.6641s/iter; left time: 16108.2134s
	iters: 200, epoch: 35 | loss: 0.6924694
	speed: 0.2363s/iter; left time: 5706.9504s
	iters: 300, epoch: 35 | loss: 0.6924047
	speed: 0.2301s/iter; left time: 5534.2675s
Epoch: 35 cost time: 84.57013773918152
Epoch: 35, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.6940103
	speed: 0.6626s/iter; left time: 15827.9888s
	iters: 200, epoch: 36 | loss: 0.6949962
	speed: 0.2172s/iter; left time: 5167.2442s
	iters: 300, epoch: 36 | loss: 0.6922983
	speed: 0.2159s/iter; left time: 5114.5778s
Epoch: 36 cost time: 80.76042127609253
Epoch: 36, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 363330
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6904271
	speed: 0.2508s/iter; left time: 9230.3932s
	iters: 200, epoch: 1 | loss: 0.6888640
	speed: 0.2228s/iter; left time: 8176.4566s
	iters: 300, epoch: 1 | loss: 0.5549183
	speed: 0.2441s/iter; left time: 8932.9052s
Epoch: 1 cost time: 90.21135640144348
Epoch: 1, Steps: 369 | Train Loss: 0.660 Vali Loss: 0.672 Vali Acc: 0.653 Test Loss: 0.672 Test Acc: 0.653
Validation loss decreased (inf --> -0.652661).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3125460
	speed: 0.7227s/iter; left time: 26328.4417s
	iters: 200, epoch: 2 | loss: 0.4797921
	speed: 0.2208s/iter; left time: 8022.4307s
	iters: 300, epoch: 2 | loss: 0.5718797
	speed: 0.2264s/iter; left time: 8203.7388s
Epoch: 2 cost time: 83.95942330360413
Epoch: 2, Steps: 369 | Train Loss: 0.523 Vali Loss: 0.705 Vali Acc: 0.655 Test Loss: 0.705 Test Acc: 0.655
Validation loss decreased (-0.652661 --> -0.654931).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3506265
	speed: 0.6649s/iter; left time: 23977.1959s
	iters: 200, epoch: 3 | loss: 0.4963220
	speed: 0.2468s/iter; left time: 8873.9603s
	iters: 300, epoch: 3 | loss: 0.2733165
	speed: 0.2357s/iter; left time: 8453.8075s
Epoch: 3 cost time: 86.69285559654236
Epoch: 3, Steps: 369 | Train Loss: 0.433 Vali Loss: 0.792 Vali Acc: 0.672 Test Loss: 0.792 Test Acc: 0.672
Validation loss decreased (-0.654931 --> -0.671672).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2607988
	speed: 0.6657s/iter; left time: 23762.1653s
	iters: 200, epoch: 4 | loss: 0.3603695
	speed: 0.2324s/iter; left time: 8273.5400s
	iters: 300, epoch: 4 | loss: 0.8315756
	speed: 0.2144s/iter; left time: 7609.1479s
Epoch: 4 cost time: 81.98050594329834
Epoch: 4, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.894 Vali Acc: 0.648 Test Loss: 0.894 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1830591
	speed: 0.6278s/iter; left time: 22178.7854s
	iters: 200, epoch: 5 | loss: 0.2055594
	speed: 0.2207s/iter; left time: 7774.2461s
	iters: 300, epoch: 5 | loss: 0.2274246
	speed: 0.2251s/iter; left time: 7906.1552s
Epoch: 5 cost time: 81.40666770935059
Epoch: 5, Steps: 369 | Train Loss: 0.292 Vali Loss: 1.101 Vali Acc: 0.641 Test Loss: 1.101 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3471300
	speed: 0.6813s/iter; left time: 23817.0017s
	iters: 200, epoch: 6 | loss: 0.5288765
	speed: 0.2157s/iter; left time: 7518.6256s
	iters: 300, epoch: 6 | loss: 0.3068590
	speed: 0.2441s/iter; left time: 8485.0520s
Epoch: 6 cost time: 83.46981763839722
Epoch: 6, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.109 Vali Acc: 0.660 Test Loss: 1.109 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1687720
	speed: 0.6691s/iter; left time: 23142.9196s
	iters: 200, epoch: 7 | loss: 0.3284935
	speed: 0.2150s/iter; left time: 7414.8868s
	iters: 300, epoch: 7 | loss: 0.3235333
	speed: 0.2210s/iter; left time: 7600.6068s
Epoch: 7 cost time: 84.03078389167786
Epoch: 7, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.158 Vali Acc: 0.647 Test Loss: 1.158 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0295176
	speed: 0.7021s/iter; left time: 24024.8985s
	iters: 200, epoch: 8 | loss: 0.0432788
	speed: 0.2320s/iter; left time: 7916.2355s
	iters: 300, epoch: 8 | loss: 0.1200829
	speed: 0.2407s/iter; left time: 8188.9829s
Epoch: 8 cost time: 87.70245790481567
Epoch: 8, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.317 Vali Acc: 0.663 Test Loss: 1.317 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0449605
	speed: 0.7068s/iter; left time: 23925.2868s
	iters: 200, epoch: 9 | loss: 0.0232776
	speed: 0.2290s/iter; left time: 7729.6835s
	iters: 300, epoch: 9 | loss: 0.0346192
	speed: 0.2315s/iter; left time: 7790.7614s
Epoch: 9 cost time: 87.1819920539856
Epoch: 9, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.497 Vali Acc: 0.669 Test Loss: 1.497 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0088849
	speed: 0.7194s/iter; left time: 24085.0869s
	iters: 200, epoch: 10 | loss: 0.0558074
	speed: 0.2708s/iter; left time: 9037.9491s
	iters: 300, epoch: 10 | loss: 0.4818095
	speed: 0.2435s/iter; left time: 8102.8995s
Epoch: 10 cost time: 91.29243564605713
Epoch: 10, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.534 Vali Acc: 0.660 Test Loss: 1.534 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1328635
	speed: 0.6706s/iter; left time: 22204.9900s
	iters: 200, epoch: 11 | loss: 0.0049455
	speed: 0.2366s/iter; left time: 7809.3980s
	iters: 300, epoch: 11 | loss: 0.0334428
	speed: 0.2350s/iter; left time: 7734.0554s
Epoch: 11 cost time: 87.24874973297119
Epoch: 11, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.814 Vali Acc: 0.618 Test Loss: 1.814 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2507869
	speed: 0.7040s/iter; left time: 23051.9795s
	iters: 200, epoch: 12 | loss: 0.1536741
	speed: 0.2386s/iter; left time: 7788.1891s
	iters: 300, epoch: 12 | loss: 0.2273888
	speed: 0.2174s/iter; left time: 7075.3690s
Epoch: 12 cost time: 84.81574845314026
Epoch: 12, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.713 Vali Acc: 0.649 Test Loss: 1.713 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2044456
	speed: 0.6730s/iter; left time: 21787.8873s
	iters: 200, epoch: 13 | loss: 0.0860727
	speed: 0.2455s/iter; left time: 7924.3105s
	iters: 300, epoch: 13 | loss: 0.0044090
	speed: 0.2252s/iter; left time: 7246.6245s
Epoch: 13 cost time: 86.16028308868408
Epoch: 13, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.785 Vali Acc: 0.650 Test Loss: 1.785 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6750855
	speed: 0.2245s/iter; left time: 8260.5228s
	iters: 200, epoch: 1 | loss: 0.6835537
	speed: 0.2206s/iter; left time: 8097.0582s
	iters: 300, epoch: 1 | loss: 0.5639554
	speed: 0.2135s/iter; left time: 7813.3855s
Epoch: 1 cost time: 80.35604166984558
Epoch: 1, Steps: 369 | Train Loss: 0.669 Vali Loss: 0.680 Vali Acc: 0.640 Test Loss: 0.680 Test Acc: 0.640
Validation loss decreased (inf --> -0.640459).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4037527
	speed: 0.6463s/iter; left time: 23544.7118s
	iters: 200, epoch: 2 | loss: 0.6757548
	speed: 0.2206s/iter; left time: 8016.2063s
	iters: 300, epoch: 2 | loss: 0.5915089
	speed: 0.2378s/iter; left time: 8616.6544s
Epoch: 2 cost time: 84.7011170387268
Epoch: 2, Steps: 369 | Train Loss: 0.526 Vali Loss: 0.689 Vali Acc: 0.657 Test Loss: 0.689 Test Acc: 0.657
Validation loss decreased (-0.640459 --> -0.656633).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3688782
	speed: 0.6653s/iter; left time: 23992.0812s
	iters: 200, epoch: 3 | loss: 0.3761523
	speed: 0.2279s/iter; left time: 8194.6741s
	iters: 300, epoch: 3 | loss: 0.6221321
	speed: 0.2326s/iter; left time: 8342.8966s
Epoch: 3 cost time: 85.2707769870758
Epoch: 3, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.762 Vali Acc: 0.672 Test Loss: 0.762 Test Acc: 0.672
Validation loss decreased (-0.656633 --> -0.671672).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3647614
	speed: 0.6829s/iter; left time: 24374.4861s
	iters: 200, epoch: 4 | loss: 0.3561623
	speed: 0.2177s/iter; left time: 7749.0945s
	iters: 300, epoch: 4 | loss: 0.8762382
	speed: 0.2184s/iter; left time: 7751.7886s
Epoch: 4 cost time: 82.5987195968628
Epoch: 4, Steps: 369 | Train Loss: 0.352 Vali Loss: 0.902 Vali Acc: 0.653 Test Loss: 0.902 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2918650
	speed: 0.6810s/iter; left time: 24054.6066s
	iters: 200, epoch: 5 | loss: 0.1912589
	speed: 0.2271s/iter; left time: 7998.8739s
	iters: 300, epoch: 5 | loss: 0.1393940
	speed: 0.2305s/iter; left time: 8096.3321s
Epoch: 5 cost time: 84.77043151855469
Epoch: 5, Steps: 369 | Train Loss: 0.290 Vali Loss: 1.001 Vali Acc: 0.652 Test Loss: 1.001 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3717745
	speed: 0.6776s/iter; left time: 23687.2462s
	iters: 200, epoch: 6 | loss: 0.4805549
	speed: 0.2219s/iter; left time: 7735.8007s
	iters: 300, epoch: 6 | loss: 0.3920736
	speed: 0.2387s/iter; left time: 8294.7991s
Epoch: 6 cost time: 83.41140699386597
Epoch: 6, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.087 Vali Acc: 0.645 Test Loss: 1.087 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1556226
	speed: 0.6550s/iter; left time: 22654.1207s
	iters: 200, epoch: 7 | loss: 0.2255365
	speed: 0.2229s/iter; left time: 7686.3791s
	iters: 300, epoch: 7 | loss: 0.2699852
	speed: 0.2258s/iter; left time: 7765.0136s
Epoch: 7 cost time: 82.96018242835999
Epoch: 7, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.147 Vali Acc: 0.651 Test Loss: 1.147 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1513861
	speed: 0.6654s/iter; left time: 22768.5423s
	iters: 200, epoch: 8 | loss: 0.0439277
	speed: 0.2008s/iter; left time: 6851.9072s
	iters: 300, epoch: 8 | loss: 0.2934710
	speed: 0.2518s/iter; left time: 8564.6154s
Epoch: 8 cost time: 84.622389793396
Epoch: 8, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.299 Vali Acc: 0.661 Test Loss: 1.299 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0566423
	speed: 0.7113s/iter; left time: 24075.3508s
	iters: 200, epoch: 9 | loss: 0.0481725
	speed: 0.2464s/iter; left time: 8316.6226s
	iters: 300, epoch: 9 | loss: 0.0272876
	speed: 0.2271s/iter; left time: 7641.5785s
Epoch: 9 cost time: 88.34959411621094
Epoch: 9, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.515 Vali Acc: 0.658 Test Loss: 1.515 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0185955
	speed: 0.6703s/iter; left time: 22442.4461s
	iters: 200, epoch: 10 | loss: 0.0091824
	speed: 0.2262s/iter; left time: 7549.6556s
	iters: 300, epoch: 10 | loss: 0.3067725
	speed: 0.2296s/iter; left time: 7641.8362s
Epoch: 10 cost time: 83.83905291557312
Epoch: 10, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.440 Vali Acc: 0.657 Test Loss: 1.440 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2510466
	speed: 0.6952s/iter; left time: 23020.3992s
	iters: 200, epoch: 11 | loss: 0.0336508
	speed: 0.2224s/iter; left time: 7343.0696s
	iters: 300, epoch: 11 | loss: 0.2208466
	speed: 0.2170s/iter; left time: 7140.8984s
Epoch: 11 cost time: 85.0699622631073
Epoch: 11, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.662 Vali Acc: 0.650 Test Loss: 1.662 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0485886
	speed: 0.6628s/iter; left time: 21700.8387s
	iters: 200, epoch: 12 | loss: 0.0179108
	speed: 0.2272s/iter; left time: 7417.1011s
	iters: 300, epoch: 12 | loss: 0.1705684
	speed: 0.2272s/iter; left time: 7392.9931s
Epoch: 12 cost time: 82.79452729225159
Epoch: 12, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.546 Vali Acc: 0.665 Test Loss: 1.546 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2422025
	speed: 0.6639s/iter; left time: 21493.9825s
	iters: 200, epoch: 13 | loss: 0.1440392
	speed: 0.2176s/iter; left time: 7023.5355s
	iters: 300, epoch: 13 | loss: 0.0380662
	speed: 0.2245s/iter; left time: 7223.1785s
Epoch: 13 cost time: 81.80563306808472
Epoch: 13, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.669 Vali Acc: 0.643 Test Loss: 1.669 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6899387
	speed: 0.2433s/iter; left time: 8952.3537s
	iters: 200, epoch: 1 | loss: 0.6307967
	speed: 0.2362s/iter; left time: 8668.7994s
	iters: 300, epoch: 1 | loss: 0.7235382
	speed: 0.2368s/iter; left time: 8667.2401s
Epoch: 1 cost time: 88.10061144828796
Epoch: 1, Steps: 369 | Train Loss: 0.674 Vali Loss: 0.705 Vali Acc: 0.631 Test Loss: 0.705 Test Acc: 0.631
Validation loss decreased (inf --> -0.630810).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2906480
	speed: 0.7324s/iter; left time: 26681.1941s
	iters: 200, epoch: 2 | loss: 0.6817040
	speed: 0.2235s/iter; left time: 8119.0822s
	iters: 300, epoch: 2 | loss: 0.6498173
	speed: 0.2200s/iter; left time: 7970.1507s
Epoch: 2 cost time: 85.53626585006714
Epoch: 2, Steps: 369 | Train Loss: 0.527 Vali Loss: 0.669 Vali Acc: 0.660 Test Loss: 0.669 Test Acc: 0.660
Validation loss decreased (-0.630810 --> -0.660322).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2682322
	speed: 0.6899s/iter; left time: 24879.4210s
	iters: 200, epoch: 3 | loss: 0.4251052
	speed: 0.2420s/iter; left time: 8704.6884s
	iters: 300, epoch: 3 | loss: 0.6150758
	speed: 0.2344s/iter; left time: 8406.3648s
Epoch: 3 cost time: 87.34326362609863
Epoch: 3, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.751 Vali Acc: 0.673 Test Loss: 0.751 Test Acc: 0.673
Validation loss decreased (-0.660322 --> -0.673091).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4554158
	speed: 0.6940s/iter; left time: 24773.3515s
	iters: 200, epoch: 4 | loss: 0.4980378
	speed: 0.2362s/iter; left time: 8406.8995s
	iters: 300, epoch: 4 | loss: 1.1226428
	speed: 0.2201s/iter; left time: 7812.6014s
Epoch: 4 cost time: 85.52828860282898
Epoch: 4, Steps: 369 | Train Loss: 0.356 Vali Loss: 0.893 Vali Acc: 0.658 Test Loss: 0.893 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2334643
	speed: 0.6760s/iter; left time: 23879.7972s
	iters: 200, epoch: 5 | loss: 0.0778407
	speed: 0.2260s/iter; left time: 7962.4106s
	iters: 300, epoch: 5 | loss: 0.1850462
	speed: 0.2265s/iter; left time: 7956.1553s
Epoch: 5 cost time: 84.56049275398254
Epoch: 5, Steps: 369 | Train Loss: 0.296 Vali Loss: 0.995 Vali Acc: 0.659 Test Loss: 0.995 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2178782
	speed: 0.6677s/iter; left time: 23341.5287s
	iters: 200, epoch: 6 | loss: 0.4539233
	speed: 0.2219s/iter; left time: 7732.9225s
	iters: 300, epoch: 6 | loss: 0.1890398
	speed: 0.2226s/iter; left time: 7737.5344s
Epoch: 6 cost time: 83.3482415676117
Epoch: 6, Steps: 369 | Train Loss: 0.244 Vali Loss: 1.070 Vali Acc: 0.654 Test Loss: 1.070 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1328781
	speed: 0.6518s/iter; left time: 22543.4996s
	iters: 200, epoch: 7 | loss: 0.2636619
	speed: 0.2230s/iter; left time: 7689.1756s
	iters: 300, epoch: 7 | loss: 0.2950938
	speed: 0.2080s/iter; left time: 7153.4149s
Epoch: 7 cost time: 79.86945652961731
Epoch: 7, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.196 Vali Acc: 0.650 Test Loss: 1.196 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1434760
	speed: 0.6400s/iter; left time: 21901.1620s
	iters: 200, epoch: 8 | loss: 0.4205613
	speed: 0.2187s/iter; left time: 7462.0399s
	iters: 300, epoch: 8 | loss: 0.0272662
	speed: 0.2213s/iter; left time: 7528.3544s
Epoch: 8 cost time: 81.3231110572815
Epoch: 8, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.227 Vali Acc: 0.650 Test Loss: 1.227 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0569435
	speed: 0.6212s/iter; left time: 21027.5199s
	iters: 200, epoch: 9 | loss: 0.0227292
	speed: 0.2149s/iter; left time: 7253.5982s
	iters: 300, epoch: 9 | loss: 0.2120722
	speed: 0.2241s/iter; left time: 7541.1247s
Epoch: 9 cost time: 80.35097122192383
Epoch: 9, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.422 Vali Acc: 0.669 Test Loss: 1.422 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0443561
	speed: 0.6468s/iter; left time: 21654.9992s
	iters: 200, epoch: 10 | loss: 0.0179630
	speed: 0.2158s/iter; left time: 7202.2344s
	iters: 300, epoch: 10 | loss: 0.3613354
	speed: 0.2213s/iter; left time: 7365.1360s
Epoch: 10 cost time: 83.3162670135498
Epoch: 10, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.478 Vali Acc: 0.662 Test Loss: 1.478 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1424795
	speed: 0.7112s/iter; left time: 23549.6697s
	iters: 200, epoch: 11 | loss: 0.0070661
	speed: 0.2362s/iter; left time: 7796.8426s
	iters: 300, epoch: 11 | loss: 0.0715220
	speed: 0.2369s/iter; left time: 7795.5514s
Epoch: 11 cost time: 86.95435309410095
Epoch: 11, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.505 Vali Acc: 0.647 Test Loss: 1.505 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1905426
	speed: 0.7132s/iter; left time: 23353.2165s
	iters: 200, epoch: 12 | loss: 0.0199610
	speed: 0.2415s/iter; left time: 7883.7253s
	iters: 300, epoch: 12 | loss: 0.0083622
	speed: 0.2368s/iter; left time: 7705.1870s
Epoch: 12 cost time: 89.71896290779114
Epoch: 12, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.660 Vali Acc: 0.656 Test Loss: 1.660 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0544170
	speed: 0.6874s/iter; left time: 22254.3984s
	iters: 200, epoch: 13 | loss: 0.1826470
	speed: 0.2199s/iter; left time: 7097.0975s
	iters: 300, epoch: 13 | loss: 0.2329513
	speed: 0.2057s/iter; left time: 6618.3791s
Epoch: 13 cost time: 80.61539602279663
Epoch: 13, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.722 Vali Acc: 0.652 Test Loss: 1.722 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6730987514188422
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7168746
	speed: 0.2611s/iter; left time: 9607.5359s
	iters: 200, epoch: 1 | loss: 0.7326947
	speed: 0.2659s/iter; left time: 9757.8412s
	iters: 300, epoch: 1 | loss: 0.6374885
	speed: 0.2270s/iter; left time: 8306.7868s
Epoch: 1 cost time: 94.46748495101929
Epoch: 1, Steps: 369 | Train Loss: 0.689 Vali Loss: 0.696 Vali Acc: 0.640 Test Loss: 0.696 Test Acc: 0.640
Validation loss decreased (inf --> -0.639607).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2689512
	speed: 0.7246s/iter; left time: 26399.2937s
	iters: 200, epoch: 2 | loss: 0.5226458
	speed: 0.2109s/iter; left time: 7662.0418s
	iters: 300, epoch: 2 | loss: 0.6866091
	speed: 0.2265s/iter; left time: 8205.7414s
Epoch: 2 cost time: 81.90719604492188
Epoch: 2, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.685 Vali Acc: 0.674 Test Loss: 0.685 Test Acc: 0.674
Validation loss decreased (-0.639607 --> -0.673943).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3310736
	speed: 0.6742s/iter; left time: 24313.4944s
	iters: 200, epoch: 3 | loss: 0.4017937
	speed: 0.2407s/iter; left time: 8654.8975s
	iters: 300, epoch: 3 | loss: 0.5267602
	speed: 0.2268s/iter; left time: 8134.5228s
Epoch: 3 cost time: 87.20444512367249
Epoch: 3, Steps: 369 | Train Loss: 0.455 Vali Loss: 0.794 Vali Acc: 0.675 Test Loss: 0.794 Test Acc: 0.675
Validation loss decreased (-0.673943 --> -0.674793).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3822669
	speed: 0.6801s/iter; left time: 24276.4643s
	iters: 200, epoch: 4 | loss: 0.3940741
	speed: 0.2299s/iter; left time: 8183.4241s
	iters: 300, epoch: 4 | loss: 0.7028506
	speed: 0.2315s/iter; left time: 8216.0727s
Epoch: 4 cost time: 85.12561702728271
Epoch: 4, Steps: 369 | Train Loss: 0.370 Vali Loss: 0.913 Vali Acc: 0.665 Test Loss: 0.913 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2023890
	speed: 0.7150s/iter; left time: 25256.7706s
	iters: 200, epoch: 5 | loss: 0.2056196
	speed: 0.2462s/iter; left time: 8673.7699s
	iters: 300, epoch: 5 | loss: 0.1569001
	speed: 0.2392s/iter; left time: 8403.3919s
Epoch: 5 cost time: 90.71124148368835
Epoch: 5, Steps: 369 | Train Loss: 0.310 Vali Loss: 1.082 Vali Acc: 0.646 Test Loss: 1.082 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1786228
	speed: 0.7088s/iter; left time: 24777.0378s
	iters: 200, epoch: 6 | loss: 0.3045511
	speed: 0.2192s/iter; left time: 7638.9697s
	iters: 300, epoch: 6 | loss: 0.3302858
	speed: 0.2112s/iter; left time: 7340.5685s
Epoch: 6 cost time: 82.18290519714355
Epoch: 6, Steps: 369 | Train Loss: 0.251 Vali Loss: 1.154 Vali Acc: 0.653 Test Loss: 1.154 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1003244
	speed: 0.6945s/iter; left time: 24020.9756s
	iters: 200, epoch: 7 | loss: 0.1603912
	speed: 0.2283s/iter; left time: 7872.5558s
	iters: 300, epoch: 7 | loss: 0.1488300
	speed: 0.2518s/iter; left time: 8658.3811s
Epoch: 7 cost time: 88.83050346374512
Epoch: 7, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.224 Vali Acc: 0.652 Test Loss: 1.224 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3041176
	speed: 0.7197s/iter; left time: 24626.3652s
	iters: 200, epoch: 8 | loss: 0.1001869
	speed: 0.2525s/iter; left time: 8613.5460s
	iters: 300, epoch: 8 | loss: 0.2373684
	speed: 0.2480s/iter; left time: 8436.2774s
Epoch: 8 cost time: 90.84642362594604
Epoch: 8, Steps: 369 | Train Loss: 0.182 Vali Loss: 1.308 Vali Acc: 0.644 Test Loss: 1.308 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1388122
	speed: 0.6770s/iter; left time: 22916.3874s
	iters: 200, epoch: 9 | loss: 0.1290953
	speed: 0.2369s/iter; left time: 7993.8933s
	iters: 300, epoch: 9 | loss: 0.1047074
	speed: 0.2417s/iter; left time: 8131.4088s
Epoch: 9 cost time: 87.89529848098755
Epoch: 9, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.567 Vali Acc: 0.659 Test Loss: 1.567 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0875954
	speed: 0.7206s/iter; left time: 24124.5871s
	iters: 200, epoch: 10 | loss: 0.0487217
	speed: 0.2294s/iter; left time: 7656.3437s
	iters: 300, epoch: 10 | loss: 0.4765184
	speed: 0.2556s/iter; left time: 8506.9420s
Epoch: 10 cost time: 88.6558153629303
Epoch: 10, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.517 Vali Acc: 0.657 Test Loss: 1.517 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0273860
	speed: 0.6920s/iter; left time: 22913.5294s
	iters: 200, epoch: 11 | loss: 0.0436341
	speed: 0.2259s/iter; left time: 7458.0473s
	iters: 300, epoch: 11 | loss: 0.1782669
	speed: 0.2415s/iter; left time: 7947.8134s
Epoch: 11 cost time: 88.11356902122498
Epoch: 11, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.765 Vali Acc: 0.646 Test Loss: 1.765 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.3922941
	speed: 0.7233s/iter; left time: 23682.5656s
	iters: 200, epoch: 12 | loss: 0.1943853
	speed: 0.2485s/iter; left time: 8111.1159s
	iters: 300, epoch: 12 | loss: 0.2219494
	speed: 0.2320s/iter; left time: 7550.2894s
Epoch: 12 cost time: 90.27392649650574
Epoch: 12, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.640 Vali Acc: 0.656 Test Loss: 1.640 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0554799
	speed: 0.7355s/iter; left time: 23811.1333s
	iters: 200, epoch: 13 | loss: 0.1438014
	speed: 0.2418s/iter; left time: 7803.5322s
	iters: 300, epoch: 13 | loss: 0.0021650
	speed: 0.2468s/iter; left time: 7941.2403s
Epoch: 13 cost time: 90.8730251789093
Epoch: 13, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.865 Vali Acc: 0.653 Test Loss: 1.865 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6748013620885358
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7368094
	speed: 0.2649s/iter; left time: 9748.0972s
	iters: 200, epoch: 1 | loss: 0.7474039
	speed: 0.2185s/iter; left time: 8017.8212s
	iters: 300, epoch: 1 | loss: 0.5862169
	speed: 0.2358s/iter; left time: 8631.5012s
Epoch: 1 cost time: 87.85166621208191
Epoch: 1, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.731 Vali Acc: 0.596 Test Loss: 0.731 Test Acc: 0.596
Validation loss decreased (inf --> -0.595906).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4441829
	speed: 0.6942s/iter; left time: 25289.5214s
	iters: 200, epoch: 2 | loss: 0.6824434
	speed: 0.2256s/iter; left time: 8195.3113s
	iters: 300, epoch: 2 | loss: 0.5452739
	speed: 0.2324s/iter; left time: 8420.3562s
Epoch: 2 cost time: 84.36941719055176
Epoch: 2, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.709 Vali Acc: 0.660 Test Loss: 0.709 Test Acc: 0.660
Validation loss decreased (-0.595906 --> -0.660038).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3545117
	speed: 0.6849s/iter; left time: 24701.1486s
	iters: 200, epoch: 3 | loss: 0.4645713
	speed: 0.2282s/iter; left time: 8207.7729s
	iters: 300, epoch: 3 | loss: 0.4609921
	speed: 0.2301s/iter; left time: 8250.2947s
Epoch: 3 cost time: 84.79017162322998
Epoch: 3, Steps: 369 | Train Loss: 0.450 Vali Loss: 0.792 Vali Acc: 0.677 Test Loss: 0.792 Test Acc: 0.677
Validation loss decreased (-0.660038 --> -0.677347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3860250
	speed: 0.7032s/iter; left time: 25099.7044s
	iters: 200, epoch: 4 | loss: 0.5276802
	speed: 0.2334s/iter; left time: 8307.6454s
	iters: 300, epoch: 4 | loss: 0.8197089
	speed: 0.2323s/iter; left time: 8243.8265s
Epoch: 4 cost time: 87.3198721408844
Epoch: 4, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.935 Vali Acc: 0.658 Test Loss: 0.935 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3478789
	speed: 0.7355s/iter; left time: 25981.3540s
	iters: 200, epoch: 5 | loss: 0.1970592
	speed: 0.2245s/iter; left time: 7906.8089s
	iters: 300, epoch: 5 | loss: 0.3493533
	speed: 0.2346s/iter; left time: 8239.8344s
Epoch: 5 cost time: 87.01371717453003
Epoch: 5, Steps: 369 | Train Loss: 0.307 Vali Loss: 1.145 Vali Acc: 0.655 Test Loss: 1.145 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2470098
	speed: 0.7183s/iter; left time: 25109.8440s
	iters: 200, epoch: 6 | loss: 0.4280231
	speed: 0.2167s/iter; left time: 7553.8397s
	iters: 300, epoch: 6 | loss: 0.3067896
	speed: 0.2213s/iter; left time: 7692.0090s
Epoch: 6 cost time: 83.66739559173584
Epoch: 6, Steps: 369 | Train Loss: 0.259 Vali Loss: 1.172 Vali Acc: 0.654 Test Loss: 1.172 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0923547
	speed: 0.6780s/iter; left time: 23450.2719s
	iters: 200, epoch: 7 | loss: 0.0561206
	speed: 0.2179s/iter; left time: 7515.2615s
	iters: 300, epoch: 7 | loss: 0.2138043
	speed: 0.2188s/iter; left time: 7524.0562s
Epoch: 7 cost time: 79.8715169429779
Epoch: 7, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.199 Vali Acc: 0.655 Test Loss: 1.199 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.2731869
	speed: 0.6694s/iter; left time: 22904.8520s
	iters: 200, epoch: 8 | loss: 0.0713064
	speed: 0.2172s/iter; left time: 7410.0916s
	iters: 300, epoch: 8 | loss: 0.3371583
	speed: 0.2228s/iter; left time: 7579.8546s
Epoch: 8 cost time: 82.75811624526978
Epoch: 8, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.256 Vali Acc: 0.662 Test Loss: 1.256 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1749360
	speed: 0.7028s/iter; left time: 23789.0356s
	iters: 200, epoch: 9 | loss: 0.1000115
	speed: 0.2172s/iter; left time: 7330.3326s
	iters: 300, epoch: 9 | loss: 0.1396368
	speed: 0.2164s/iter; left time: 7282.0770s
Epoch: 9 cost time: 80.98573446273804
Epoch: 9, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.608 Vali Acc: 0.668 Test Loss: 1.608 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5041754
	speed: 0.6913s/iter; left time: 23143.1614s
	iters: 200, epoch: 10 | loss: 0.2271597
	speed: 0.2171s/iter; left time: 7248.2959s
	iters: 300, epoch: 10 | loss: 0.2224034
	speed: 0.2195s/iter; left time: 7303.8811s
Epoch: 10 cost time: 82.4572536945343
Epoch: 10, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.492 Vali Acc: 0.665 Test Loss: 1.492 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1581376
	speed: 0.7106s/iter; left time: 23528.1492s
	iters: 200, epoch: 11 | loss: 0.0148953
	speed: 0.2226s/iter; left time: 7347.7986s
	iters: 300, epoch: 11 | loss: 0.3656673
	speed: 0.2160s/iter; left time: 7108.5463s
Epoch: 11 cost time: 81.1396381855011
Epoch: 11, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.655 Vali Acc: 0.672 Test Loss: 1.655 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1004964
	speed: 0.6749s/iter; left time: 22096.8598s
	iters: 200, epoch: 12 | loss: 0.0274710
	speed: 0.2383s/iter; left time: 7778.8516s
	iters: 300, epoch: 12 | loss: 0.3139456
	speed: 0.2329s/iter; left time: 7579.9816s
Epoch: 12 cost time: 87.1173665523529
Epoch: 12, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.600 Vali Acc: 0.664 Test Loss: 1.600 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0907692
	speed: 0.7407s/iter; left time: 23978.9714s
	iters: 200, epoch: 13 | loss: 0.0735101
	speed: 0.2517s/iter; left time: 8123.3784s
	iters: 300, epoch: 13 | loss: 0.0273700
	speed: 0.2243s/iter; left time: 7215.4072s
Epoch: 13 cost time: 89.4125669002533
Epoch: 13, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.795 Vali Acc: 0.657 Test Loss: 1.795 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677355278093076
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7139896
	speed: 0.2359s/iter; left time: 8682.6748s
	iters: 200, epoch: 1 | loss: 0.7499557
	speed: 0.2304s/iter; left time: 8454.4671s
	iters: 300, epoch: 1 | loss: 0.5267465
	speed: 0.2334s/iter; left time: 8541.6106s
Epoch: 1 cost time: 86.52233505249023
Epoch: 1, Steps: 369 | Train Loss: 0.697 Vali Loss: 0.708 Vali Acc: 0.622 Test Loss: 0.708 Test Acc: 0.622
Validation loss decreased (inf --> -0.622297).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4377512
	speed: 0.7305s/iter; left time: 26613.6904s
	iters: 200, epoch: 2 | loss: 0.6356170
	speed: 0.2434s/iter; left time: 8841.5621s
	iters: 300, epoch: 2 | loss: 0.4742791
	speed: 0.2391s/iter; left time: 8662.3810s
Epoch: 2 cost time: 88.85595059394836
Epoch: 2, Steps: 369 | Train Loss: 0.566 Vali Loss: 0.704 Vali Acc: 0.665 Test Loss: 0.704 Test Acc: 0.665
Validation loss decreased (-0.622297 --> -0.665430).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2812693
	speed: 0.7132s/iter; left time: 25721.0143s
	iters: 200, epoch: 3 | loss: 0.1946718
	speed: 0.2285s/iter; left time: 8219.0295s
	iters: 300, epoch: 3 | loss: 0.4592347
	speed: 0.2268s/iter; left time: 8132.0153s
Epoch: 3 cost time: 84.8266658782959
Epoch: 3, Steps: 369 | Train Loss: 0.468 Vali Loss: 0.786 Vali Acc: 0.672 Test Loss: 0.786 Test Acc: 0.672
Validation loss decreased (-0.665430 --> -0.671956).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4252966
	speed: 0.6978s/iter; left time: 24907.3580s
	iters: 200, epoch: 4 | loss: 0.3836682
	speed: 0.2238s/iter; left time: 7965.5725s
	iters: 300, epoch: 4 | loss: 0.6660125
	speed: 0.2224s/iter; left time: 7895.6078s
Epoch: 4 cost time: 82.53560733795166
Epoch: 4, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.961 Vali Acc: 0.656 Test Loss: 0.961 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3212397
	speed: 0.6657s/iter; left time: 23516.9354s
	iters: 200, epoch: 5 | loss: 0.1749993
	speed: 0.2234s/iter; left time: 7869.7536s
	iters: 300, epoch: 5 | loss: 0.2571771
	speed: 0.2237s/iter; left time: 7857.2546s
Epoch: 5 cost time: 82.53767490386963
Epoch: 5, Steps: 369 | Train Loss: 0.325 Vali Loss: 1.111 Vali Acc: 0.643 Test Loss: 1.111 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2587318
	speed: 0.6798s/iter; left time: 23763.3976s
	iters: 200, epoch: 6 | loss: 0.3941570
	speed: 0.2263s/iter; left time: 7887.5812s
	iters: 300, epoch: 6 | loss: 0.4669856
	speed: 0.2285s/iter; left time: 7941.2561s
Epoch: 6 cost time: 84.02781939506531
Epoch: 6, Steps: 369 | Train Loss: 0.284 Vali Loss: 1.090 Vali Acc: 0.654 Test Loss: 1.090 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1528131
	speed: 0.6783s/iter; left time: 23460.1556s
	iters: 200, epoch: 7 | loss: 0.1400219
	speed: 0.2185s/iter; left time: 7535.6007s
	iters: 300, epoch: 7 | loss: 0.0685763
	speed: 0.2271s/iter; left time: 7809.6552s
Epoch: 7 cost time: 82.33101534843445
Epoch: 7, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.103 Vali Acc: 0.666 Test Loss: 1.103 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1812360
	speed: 0.7034s/iter; left time: 24069.3259s
	iters: 200, epoch: 8 | loss: 0.0232931
	speed: 0.2258s/iter; left time: 7705.5140s
	iters: 300, epoch: 8 | loss: 0.2381365
	speed: 0.2145s/iter; left time: 7298.0031s
Epoch: 8 cost time: 82.89872741699219
Epoch: 8, Steps: 369 | Train Loss: 0.207 Vali Loss: 1.286 Vali Acc: 0.659 Test Loss: 1.286 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1463562
	speed: 0.6807s/iter; left time: 23041.3289s
	iters: 200, epoch: 9 | loss: 0.0510738
	speed: 0.2079s/iter; left time: 7017.3040s
	iters: 300, epoch: 9 | loss: 0.1144588
	speed: 0.2244s/iter; left time: 7549.5331s
Epoch: 9 cost time: 81.40452694892883
Epoch: 9, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.495 Vali Acc: 0.665 Test Loss: 1.495 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1151377
	speed: 0.7103s/iter; left time: 23779.6121s
	iters: 200, epoch: 10 | loss: 0.0965739
	speed: 0.2294s/iter; left time: 7657.3033s
	iters: 300, epoch: 10 | loss: 0.3520775
	speed: 0.2335s/iter; left time: 7770.2755s
Epoch: 10 cost time: 86.14047002792358
Epoch: 10, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.552 Vali Acc: 0.653 Test Loss: 1.552 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1438863
	speed: 0.6983s/iter; left time: 23122.8233s
	iters: 200, epoch: 11 | loss: 0.0195621
	speed: 0.2356s/iter; left time: 7778.7798s
	iters: 300, epoch: 11 | loss: 0.0243720
	speed: 0.2426s/iter; left time: 7984.2796s
Epoch: 11 cost time: 87.93638491630554
Epoch: 11, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.544 Vali Acc: 0.664 Test Loss: 1.544 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5359408
	speed: 0.7453s/iter; left time: 24404.1628s
	iters: 200, epoch: 12 | loss: 0.0456435
	speed: 0.2251s/iter; left time: 7347.0710s
	iters: 300, epoch: 12 | loss: 0.0326328
	speed: 0.2317s/iter; left time: 7539.5432s
Epoch: 12 cost time: 85.09965181350708
Epoch: 12, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.581 Vali Acc: 0.656 Test Loss: 1.581 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0642000
	speed: 0.6741s/iter; left time: 21821.5765s
	iters: 200, epoch: 13 | loss: 0.1443737
	speed: 0.2352s/iter; left time: 7589.0135s
	iters: 300, epoch: 13 | loss: 0.0648186
	speed: 0.2310s/iter; left time: 7431.7081s
Epoch: 13 cost time: 84.74444055557251
Epoch: 13, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.762 Vali Acc: 0.643 Test Loss: 1.762 Test Acc: 0.643
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6719636776390465
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7043588
	speed: 0.2309s/iter; left time: 8497.0312s
	iters: 200, epoch: 1 | loss: 0.7881477
	speed: 0.1969s/iter; left time: 7227.2989s
	iters: 300, epoch: 1 | loss: 0.5085105
	speed: 0.2106s/iter; left time: 7708.2357s
Epoch: 1 cost time: 78.23425483703613
Epoch: 1, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.698 Vali Acc: 0.628 Test Loss: 0.698 Test Acc: 0.628
Validation loss decreased (inf --> -0.627689).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3139051
	speed: 0.6702s/iter; left time: 24416.5913s
	iters: 200, epoch: 2 | loss: 0.6719302
	speed: 0.2312s/iter; left time: 8401.4863s
	iters: 300, epoch: 2 | loss: 0.4973516
	speed: 0.2263s/iter; left time: 8198.7244s
Epoch: 2 cost time: 85.12559795379639
Epoch: 2, Steps: 369 | Train Loss: 0.562 Vali Loss: 0.666 Vali Acc: 0.682 Test Loss: 0.666 Test Acc: 0.682
Validation loss decreased (-0.627689 --> -0.682456).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5315230
	speed: 0.6957s/iter; left time: 25090.3579s
	iters: 200, epoch: 3 | loss: 0.4263546
	speed: 0.2328s/iter; left time: 8373.3401s
	iters: 300, epoch: 3 | loss: 0.4807517
	speed: 0.2436s/iter; left time: 8735.3802s
Epoch: 3 cost time: 86.62133932113647
Epoch: 3, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.737 Vali Acc: 0.684 Test Loss: 0.737 Test Acc: 0.684
Validation loss decreased (-0.682456 --> -0.684442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3615198
	speed: 0.6936s/iter; left time: 24757.7364s
	iters: 200, epoch: 4 | loss: 0.6191664
	speed: 0.2325s/iter; left time: 8276.0415s
	iters: 300, epoch: 4 | loss: 0.8286883
	speed: 0.2226s/iter; left time: 7902.6464s
Epoch: 4 cost time: 84.4008321762085
Epoch: 4, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.863 Vali Acc: 0.659 Test Loss: 0.863 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4877200
	speed: 0.6866s/iter; left time: 24253.1905s
	iters: 200, epoch: 5 | loss: 0.3786254
	speed: 0.2220s/iter; left time: 7821.2378s
	iters: 300, epoch: 5 | loss: 0.4333238
	speed: 0.2217s/iter; left time: 7787.9811s
Epoch: 5 cost time: 82.07387924194336
Epoch: 5, Steps: 369 | Train Loss: 0.346 Vali Loss: 1.029 Vali Acc: 0.653 Test Loss: 1.029 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3737579
	speed: 0.6767s/iter; left time: 23653.4155s
	iters: 200, epoch: 6 | loss: 0.4449385
	speed: 0.2259s/iter; left time: 7872.6035s
	iters: 300, epoch: 6 | loss: 0.3865841
	speed: 0.2250s/iter; left time: 7819.2114s
Epoch: 6 cost time: 83.15304780006409
Epoch: 6, Steps: 369 | Train Loss: 0.288 Vali Loss: 1.114 Vali Acc: 0.650 Test Loss: 1.114 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1011712
	speed: 0.6932s/iter; left time: 23976.1842s
	iters: 200, epoch: 7 | loss: 0.3320307
	speed: 0.2235s/iter; left time: 7706.8325s
	iters: 300, epoch: 7 | loss: 0.1789638
	speed: 0.2219s/iter; left time: 7629.2275s
Epoch: 7 cost time: 82.2091269493103
Epoch: 7, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.086 Vali Acc: 0.662 Test Loss: 1.086 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.5042339
	speed: 0.6593s/iter; left time: 22559.7572s
	iters: 200, epoch: 8 | loss: 0.1151118
	speed: 0.2134s/iter; left time: 7281.6516s
	iters: 300, epoch: 8 | loss: 0.0925944
	speed: 0.2142s/iter; left time: 7288.0411s
Epoch: 8 cost time: 80.2915563583374
Epoch: 8, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.202 Vali Acc: 0.657 Test Loss: 1.202 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.3490579
	speed: 0.6852s/iter; left time: 23192.6530s
	iters: 200, epoch: 9 | loss: 0.5721070
	speed: 0.2222s/iter; left time: 7499.5124s
	iters: 300, epoch: 9 | loss: 0.1793709
	speed: 0.2168s/iter; left time: 7293.8371s
Epoch: 9 cost time: 82.25027513504028
Epoch: 9, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.301 Vali Acc: 0.657 Test Loss: 1.301 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1443127
	speed: 0.6751s/iter; left time: 22601.7872s
	iters: 200, epoch: 10 | loss: 0.0832821
	speed: 0.2154s/iter; left time: 7191.0045s
	iters: 300, epoch: 10 | loss: 0.5316085
	speed: 0.2069s/iter; left time: 6884.0264s
Epoch: 10 cost time: 78.89519500732422
Epoch: 10, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.509 Vali Acc: 0.644 Test Loss: 1.509 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2069547
	speed: 0.6466s/iter; left time: 21410.5776s
	iters: 200, epoch: 11 | loss: 0.0242535
	speed: 0.2153s/iter; left time: 7106.6110s
	iters: 300, epoch: 11 | loss: 0.5499610
	speed: 0.2175s/iter; left time: 7157.8029s
Epoch: 11 cost time: 80.01045322418213
Epoch: 11, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.501 Vali Acc: 0.656 Test Loss: 1.501 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1149253
	speed: 0.6480s/iter; left time: 21217.1501s
	iters: 200, epoch: 12 | loss: 0.0400164
	speed: 0.2162s/iter; left time: 7058.4554s
	iters: 300, epoch: 12 | loss: 0.1078350
	speed: 0.2124s/iter; left time: 6910.9425s
Epoch: 12 cost time: 80.23352646827698
Epoch: 12, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.642 Vali Acc: 0.648 Test Loss: 1.642 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0842000
	speed: 0.6697s/iter; left time: 21679.6172s
	iters: 200, epoch: 13 | loss: 0.0597310
	speed: 0.2214s/iter; left time: 7144.2599s
	iters: 300, epoch: 13 | loss: 0.0439648
	speed: 0.2214s/iter; left time: 7123.6762s
Epoch: 13 cost time: 82.08920216560364
Epoch: 13, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.633 Vali Acc: 0.655 Test Loss: 1.633 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.684449489216799
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6931533
	speed: 0.2378s/iter; left time: 8751.5070s
	iters: 200, epoch: 1 | loss: 0.6931534
	speed: 0.2192s/iter; left time: 8043.5393s
	iters: 300, epoch: 1 | loss: 0.6921746
	speed: 0.2157s/iter; left time: 7896.2366s
Epoch: 1 cost time: 81.89559841156006
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6922385
	speed: 0.6667s/iter; left time: 24289.4874s
	iters: 200, epoch: 2 | loss: 0.6912741
	speed: 0.2161s/iter; left time: 7849.7116s
	iters: 300, epoch: 2 | loss: 0.6963348
	speed: 0.2197s/iter; left time: 7959.9761s
Epoch: 2 cost time: 80.62316703796387
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6942077
	speed: 0.6727s/iter; left time: 24260.4369s
	iters: 200, epoch: 3 | loss: 0.6937610
	speed: 0.2163s/iter; left time: 7777.5942s
	iters: 300, epoch: 3 | loss: 0.6936304
	speed: 0.2086s/iter; left time: 7481.2041s
Epoch: 3 cost time: 79.7189781665802
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6922668
	speed: 0.6691s/iter; left time: 23884.3434s
	iters: 200, epoch: 4 | loss: 0.6932023
	speed: 0.2198s/iter; left time: 7821.8393s
	iters: 300, epoch: 4 | loss: 0.6928303
	speed: 0.2192s/iter; left time: 7780.1680s
Epoch: 4 cost time: 80.70580196380615
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6934423
	speed: 0.6693s/iter; left time: 23642.5125s
	iters: 200, epoch: 5 | loss: 0.6927173
	speed: 0.2210s/iter; left time: 7783.6044s
	iters: 300, epoch: 5 | loss: 0.6931478
	speed: 0.2249s/iter; left time: 7900.8090s
Epoch: 5 cost time: 82.50811815261841
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6931598
	speed: 0.6785s/iter; left time: 23717.1658s
	iters: 200, epoch: 6 | loss: 0.6957384
	speed: 0.2086s/iter; left time: 7270.5048s
	iters: 300, epoch: 6 | loss: 0.6929168
	speed: 0.2053s/iter; left time: 7135.3453s
Epoch: 6 cost time: 77.44105100631714
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6938338
	speed: 0.6783s/iter; left time: 23461.7157s
	iters: 200, epoch: 7 | loss: 0.6924228
	speed: 0.2203s/iter; left time: 7599.1770s
	iters: 300, epoch: 7 | loss: 0.6889555
	speed: 0.2237s/iter; left time: 7692.3523s
Epoch: 7 cost time: 83.67183208465576
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6931525
	speed: 0.6884s/iter; left time: 23557.1181s
	iters: 200, epoch: 8 | loss: 0.6937788
	speed: 0.2170s/iter; left time: 7402.2744s
	iters: 300, epoch: 8 | loss: 0.6933285
	speed: 0.2112s/iter; left time: 7185.3521s
Epoch: 8 cost time: 80.13001227378845
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6929639
	speed: 0.6715s/iter; left time: 22728.6681s
	iters: 200, epoch: 9 | loss: 0.6923801
	speed: 0.2145s/iter; left time: 7239.8755s
	iters: 300, epoch: 9 | loss: 0.6935833
	speed: 0.2159s/iter; left time: 7266.0778s
Epoch: 9 cost time: 80.71242833137512
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6907609
	speed: 0.6804s/iter; left time: 22778.7624s
	iters: 200, epoch: 10 | loss: 0.6921887
	speed: 0.2236s/iter; left time: 7463.9337s
	iters: 300, epoch: 10 | loss: 0.6931522
	speed: 0.2155s/iter; left time: 7170.7025s
Epoch: 10 cost time: 81.85346794128418
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6946399
	speed: 0.6542s/iter; left time: 21660.4051s
	iters: 200, epoch: 11 | loss: 0.6927087
	speed: 0.2158s/iter; left time: 7124.1842s
	iters: 300, epoch: 11 | loss: 0.6934088
	speed: 0.2200s/iter; left time: 7239.4994s
Epoch: 11 cost time: 79.94111108779907
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6946082
	speed: 0.6770s/iter; left time: 22167.7947s
	iters: 200, epoch: 12 | loss: 0.6936851
	speed: 0.2292s/iter; left time: 7480.4245s
	iters: 300, epoch: 12 | loss: 0.6915032
	speed: 0.2157s/iter; left time: 7020.0775s
Epoch: 12 cost time: 82.30428671836853
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6939197
	speed: 0.6692s/iter; left time: 21665.3324s
	iters: 200, epoch: 13 | loss: 0.6930776
	speed: 0.2201s/iter; left time: 7104.7477s
	iters: 300, epoch: 13 | loss: 0.6942739
	speed: 0.2144s/iter; left time: 6897.0951s
Epoch: 13 cost time: 80.95532155036926
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 265026
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7139257
	speed: 0.2321s/iter; left time: 8543.2201s
	iters: 200, epoch: 1 | loss: 0.6471070
	speed: 0.2220s/iter; left time: 8147.3249s
	iters: 300, epoch: 1 | loss: 0.5687335
	speed: 0.2231s/iter; left time: 8164.2130s
Epoch: 1 cost time: 83.15425181388855
Epoch: 1, Steps: 369 | Train Loss: 0.662 Vali Loss: 0.660 Vali Acc: 0.662 Test Loss: 0.660 Test Acc: 0.662
Validation loss decreased (inf --> -0.662309).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5962158
	speed: 0.7037s/iter; left time: 25635.8941s
	iters: 200, epoch: 2 | loss: 0.7257151
	speed: 0.2140s/iter; left time: 7774.0839s
	iters: 300, epoch: 2 | loss: 0.3471474
	speed: 0.2074s/iter; left time: 7516.0247s
Epoch: 2 cost time: 82.71363067626953
Epoch: 2, Steps: 369 | Train Loss: 0.518 Vali Loss: 0.716 Vali Acc: 0.649 Test Loss: 0.716 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3545659
	speed: 0.7062s/iter; left time: 25467.5761s
	iters: 200, epoch: 3 | loss: 0.6138552
	speed: 0.2263s/iter; left time: 8139.5990s
	iters: 300, epoch: 3 | loss: 0.1486310
	speed: 0.2379s/iter; left time: 8533.4612s
Epoch: 3 cost time: 86.3763358592987
Epoch: 3, Steps: 369 | Train Loss: 0.420 Vali Loss: 0.780 Vali Acc: 0.657 Test Loss: 0.780 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4047450
	speed: 0.7181s/iter; left time: 25630.3055s
	iters: 200, epoch: 4 | loss: 0.1274351
	speed: 0.2361s/iter; left time: 8403.8393s
	iters: 300, epoch: 4 | loss: 0.6491410
	speed: 0.2321s/iter; left time: 8236.5856s
Epoch: 4 cost time: 86.08178234100342
Epoch: 4, Steps: 369 | Train Loss: 0.351 Vali Loss: 0.829 Vali Acc: 0.661 Test Loss: 0.829 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1110536
	speed: 0.7367s/iter; left time: 26023.3983s
	iters: 200, epoch: 5 | loss: 0.4569893
	speed: 0.2109s/iter; left time: 7429.2366s
	iters: 300, epoch: 5 | loss: 0.1088952
	speed: 0.2015s/iter; left time: 7078.8283s
Epoch: 5 cost time: 82.57322120666504
Epoch: 5, Steps: 369 | Train Loss: 0.281 Vali Loss: 0.967 Vali Acc: 0.655 Test Loss: 0.967 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3522219
	speed: 0.6986s/iter; left time: 24421.1390s
	iters: 200, epoch: 6 | loss: 0.2685608
	speed: 0.2205s/iter; left time: 7684.0666s
	iters: 300, epoch: 6 | loss: 0.3695703
	speed: 0.2182s/iter; left time: 7585.3791s
Epoch: 6 cost time: 80.965491771698
Epoch: 6, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.080 Vali Acc: 0.670 Test Loss: 1.080 Test Acc: 0.670
Validation loss decreased (-0.662309 --> -0.669967).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0857820
	speed: 0.6762s/iter; left time: 23387.2418s
	iters: 200, epoch: 7 | loss: 0.2335816
	speed: 0.2222s/iter; left time: 7662.2411s
	iters: 300, epoch: 7 | loss: 0.0710360
	speed: 0.2196s/iter; left time: 7551.7787s
Epoch: 7 cost time: 82.36193680763245
Epoch: 7, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.135 Vali Acc: 0.661 Test Loss: 1.135 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0851535
	speed: 0.6829s/iter; left time: 23366.1054s
	iters: 200, epoch: 8 | loss: 0.3947391
	speed: 0.2210s/iter; left time: 7541.1897s
	iters: 300, epoch: 8 | loss: 0.0244227
	speed: 0.2228s/iter; left time: 7578.7806s
Epoch: 8 cost time: 84.81478881835938
Epoch: 8, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.333 Vali Acc: 0.650 Test Loss: 1.333 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1774259
	speed: 0.7196s/iter; left time: 24359.3755s
	iters: 200, epoch: 9 | loss: 0.0359226
	speed: 0.2334s/iter; left time: 7876.8375s
	iters: 300, epoch: 9 | loss: 0.3296260
	speed: 0.2306s/iter; left time: 7758.2661s
Epoch: 9 cost time: 85.7699043750763
Epoch: 9, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.416 Vali Acc: 0.658 Test Loss: 1.416 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0791312
	speed: 0.7237s/iter; left time: 24230.3814s
	iters: 200, epoch: 10 | loss: 0.2851159
	speed: 0.2295s/iter; left time: 7661.1036s
	iters: 300, epoch: 10 | loss: 0.0237658
	speed: 0.2407s/iter; left time: 8011.2656s
Epoch: 10 cost time: 88.48583722114563
Epoch: 10, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.494 Vali Acc: 0.655 Test Loss: 1.494 Test Acc: 0.655
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4538218
	speed: 0.7379s/iter; left time: 24431.3214s
	iters: 200, epoch: 11 | loss: 0.4251743
	speed: 0.2362s/iter; left time: 7798.4136s
	iters: 300, epoch: 11 | loss: 0.0977685
	speed: 0.2464s/iter; left time: 8109.9917s
Epoch: 11 cost time: 91.32600736618042
Epoch: 11, Steps: 369 | Train Loss: 0.109 Vali Loss: 1.628 Vali Acc: 0.646 Test Loss: 1.628 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0053515
	speed: 0.7778s/iter; left time: 25465.7946s
	iters: 200, epoch: 12 | loss: 0.0574967
	speed: 0.2296s/iter; left time: 7493.6150s
	iters: 300, epoch: 12 | loss: 0.0126929
	speed: 0.2496s/iter; left time: 8121.6188s
Epoch: 12 cost time: 89.68522381782532
Epoch: 12, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.785 Vali Acc: 0.663 Test Loss: 1.785 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0057164
	speed: 0.7092s/iter; left time: 22958.2726s
	iters: 200, epoch: 13 | loss: 0.0022749
	speed: 0.2342s/iter; left time: 7559.0050s
	iters: 300, epoch: 13 | loss: 0.0073441
	speed: 0.2194s/iter; left time: 7057.5350s
Epoch: 13 cost time: 84.47217869758606
Epoch: 13, Steps: 369 | Train Loss: 0.091 Vali Loss: 1.874 Vali Acc: 0.650 Test Loss: 1.874 Test Acc: 0.650
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0037961
	speed: 0.6830s/iter; left time: 21858.9955s
	iters: 200, epoch: 14 | loss: 0.0126091
	speed: 0.2288s/iter; left time: 7300.2167s
	iters: 300, epoch: 14 | loss: 0.0138172
	speed: 0.2031s/iter; left time: 6459.0772s
Epoch: 14 cost time: 81.93068647384644
Epoch: 14, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.857 Vali Acc: 0.649 Test Loss: 1.857 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0740288
	speed: 0.7168s/iter; left time: 22677.1441s
	iters: 200, epoch: 15 | loss: 0.1627374
	speed: 0.2231s/iter; left time: 7035.4331s
	iters: 300, epoch: 15 | loss: 0.1504916
	speed: 0.2251s/iter; left time: 7074.5586s
Epoch: 15 cost time: 85.4081780910492
Epoch: 15, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.960 Vali Acc: 0.647 Test Loss: 1.960 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0552456
	speed: 0.6785s/iter; left time: 21213.5938s
	iters: 200, epoch: 16 | loss: 0.0235537
	speed: 0.2233s/iter; left time: 6959.5424s
	iters: 300, epoch: 16 | loss: 0.0277099
	speed: 0.2211s/iter; left time: 6869.8890s
Epoch: 16 cost time: 80.58881068229675
Epoch: 16, Steps: 369 | Train Loss: 0.083 Vali Loss: 2.144 Vali Acc: 0.657 Test Loss: 2.144 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6699772985244041
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7261125
	speed: 0.2608s/iter; left time: 9599.2310s
	iters: 200, epoch: 1 | loss: 0.5790506
	speed: 0.2248s/iter; left time: 8251.1156s
	iters: 300, epoch: 1 | loss: 0.6269712
	speed: 0.2307s/iter; left time: 8443.6532s
Epoch: 1 cost time: 88.81004738807678
Epoch: 1, Steps: 369 | Train Loss: 0.670 Vali Loss: 0.683 Vali Acc: 0.651 Test Loss: 0.683 Test Acc: 0.651
Validation loss decreased (inf --> -0.650674).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5688125
	speed: 0.7458s/iter; left time: 27171.3651s
	iters: 200, epoch: 2 | loss: 0.7703274
	speed: 0.2332s/iter; left time: 8471.4693s
	iters: 300, epoch: 2 | loss: 0.3433493
	speed: 0.2394s/iter; left time: 8674.4171s
Epoch: 2 cost time: 88.38036036491394
Epoch: 2, Steps: 369 | Train Loss: 0.521 Vali Loss: 0.723 Vali Acc: 0.647 Test Loss: 0.723 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4012946
	speed: 0.7501s/iter; left time: 27050.4143s
	iters: 200, epoch: 3 | loss: 0.5374618
	speed: 0.2366s/iter; left time: 8507.3645s
	iters: 300, epoch: 3 | loss: 0.1502909
	speed: 0.2406s/iter; left time: 8629.2974s
Epoch: 3 cost time: 92.22043633460999
Epoch: 3, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.823 Vali Acc: 0.651 Test Loss: 0.823 Test Acc: 0.651
Validation loss decreased (-0.650674 --> -0.650957).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3333515
	speed: 0.7274s/iter; left time: 25962.4690s
	iters: 200, epoch: 4 | loss: 0.2343818
	speed: 0.2255s/iter; left time: 8026.3556s
	iters: 300, epoch: 4 | loss: 0.5188689
	speed: 0.2374s/iter; left time: 8427.0564s
Epoch: 4 cost time: 85.11972332000732
Epoch: 4, Steps: 369 | Train Loss: 0.358 Vali Loss: 0.849 Vali Acc: 0.651 Test Loss: 0.849 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2722964
	speed: 0.7242s/iter; left time: 25581.0232s
	iters: 200, epoch: 5 | loss: 0.3910689
	speed: 0.2304s/iter; left time: 8114.9629s
	iters: 300, epoch: 5 | loss: 0.1207993
	speed: 0.2217s/iter; left time: 7788.8125s
Epoch: 5 cost time: 84.59381365776062
Epoch: 5, Steps: 369 | Train Loss: 0.277 Vali Loss: 0.984 Vali Acc: 0.668 Test Loss: 0.984 Test Acc: 0.668
Validation loss decreased (-0.650957 --> -0.667697).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1455098
	speed: 0.7357s/iter; left time: 25716.8249s
	iters: 200, epoch: 6 | loss: 0.4305326
	speed: 0.2351s/iter; left time: 8194.7269s
	iters: 300, epoch: 6 | loss: 0.3081577
	speed: 0.2363s/iter; left time: 8213.6823s
Epoch: 6 cost time: 91.86114120483398
Epoch: 6, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.160 Vali Acc: 0.638 Test Loss: 1.160 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3994980
	speed: 0.7087s/iter; left time: 24512.6898s
	iters: 200, epoch: 7 | loss: 0.3623426
	speed: 0.2263s/iter; left time: 7805.5033s
	iters: 300, epoch: 7 | loss: 0.0904296
	speed: 0.2171s/iter; left time: 7463.8333s
Epoch: 7 cost time: 83.86269402503967
Epoch: 7, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.117 Vali Acc: 0.663 Test Loss: 1.117 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0521742
	speed: 0.6963s/iter; left time: 23824.4489s
	iters: 200, epoch: 8 | loss: 0.1303050
	speed: 0.2304s/iter; left time: 7859.2325s
	iters: 300, epoch: 8 | loss: 0.0192527
	speed: 0.2222s/iter; left time: 7559.4776s
Epoch: 8 cost time: 83.57591128349304
Epoch: 8, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.387 Vali Acc: 0.648 Test Loss: 1.387 Test Acc: 0.648
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0234061
	speed: 0.7298s/iter; left time: 24703.9614s
	iters: 200, epoch: 9 | loss: 0.0634669
	speed: 0.2334s/iter; left time: 7877.1301s
	iters: 300, epoch: 9 | loss: 0.0656514
	speed: 0.2707s/iter; left time: 9110.2205s
Epoch: 9 cost time: 93.25271534919739
Epoch: 9, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.469 Vali Acc: 0.650 Test Loss: 1.469 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0054902
	speed: 0.7093s/iter; left time: 23748.2360s
	iters: 200, epoch: 10 | loss: 0.3290287
	speed: 0.2298s/iter; left time: 7671.6512s
	iters: 300, epoch: 10 | loss: 0.1032947
	speed: 0.2265s/iter; left time: 7538.9292s
Epoch: 10 cost time: 85.23257374763489
Epoch: 10, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.537 Vali Acc: 0.634 Test Loss: 1.537 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1139069
	speed: 0.7106s/iter; left time: 23529.8578s
	iters: 200, epoch: 11 | loss: 0.0994039
	speed: 0.2316s/iter; left time: 7645.0415s
	iters: 300, epoch: 11 | loss: 0.1347858
	speed: 0.2650s/iter; left time: 8719.7835s
Epoch: 11 cost time: 90.052161693573
Epoch: 11, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.572 Vali Acc: 0.649 Test Loss: 1.572 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0210542
	speed: 0.7032s/iter; left time: 23022.6328s
	iters: 200, epoch: 12 | loss: 0.0040590
	speed: 0.2620s/iter; left time: 8553.7723s
	iters: 300, epoch: 12 | loss: 0.0434279
	speed: 0.2418s/iter; left time: 7869.0681s
Epoch: 12 cost time: 90.12741708755493
Epoch: 12, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.923 Vali Acc: 0.653 Test Loss: 1.923 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0215117
	speed: 0.7168s/iter; left time: 23204.0165s
	iters: 200, epoch: 13 | loss: 0.0016405
	speed: 0.2516s/iter; left time: 8120.6450s
	iters: 300, epoch: 13 | loss: 0.0823028
	speed: 0.2481s/iter; left time: 7983.1390s
Epoch: 13 cost time: 89.70847487449646
Epoch: 13, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.843 Vali Acc: 0.642 Test Loss: 1.843 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0080421
	speed: 0.7270s/iter; left time: 23265.7026s
	iters: 200, epoch: 14 | loss: 0.3151745
	speed: 0.2368s/iter; left time: 7554.8843s
	iters: 300, epoch: 14 | loss: 0.0195392
	speed: 0.2242s/iter; left time: 7130.9110s
Epoch: 14 cost time: 87.43197560310364
Epoch: 14, Steps: 369 | Train Loss: 0.096 Vali Loss: 1.817 Vali Acc: 0.650 Test Loss: 1.817 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0044112
	speed: 0.7042s/iter; left time: 22278.8070s
	iters: 200, epoch: 15 | loss: 0.0318508
	speed: 0.2436s/iter; left time: 7681.1879s
	iters: 300, epoch: 15 | loss: 0.1332893
	speed: 0.2369s/iter; left time: 7446.9604s
Epoch: 15 cost time: 87.74698734283447
Epoch: 15, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.843 Vali Acc: 0.647 Test Loss: 1.843 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6677071509648127
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7474605
	speed: 0.2327s/iter; left time: 8563.5269s
	iters: 200, epoch: 1 | loss: 0.5348918
	speed: 0.2159s/iter; left time: 7922.5224s
	iters: 300, epoch: 1 | loss: 0.6112152
	speed: 0.1998s/iter; left time: 7311.9892s
Epoch: 1 cost time: 78.69022965431213
Epoch: 1, Steps: 369 | Train Loss: 0.672 Vali Loss: 0.687 Vali Acc: 0.647 Test Loss: 0.687 Test Acc: 0.647
Validation loss decreased (inf --> -0.647269).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5333111
	speed: 0.6506s/iter; left time: 23703.4540s
	iters: 200, epoch: 2 | loss: 0.7089850
	speed: 0.2201s/iter; left time: 7996.7759s
	iters: 300, epoch: 2 | loss: 0.3328799
	speed: 0.2130s/iter; left time: 7717.2773s
Epoch: 2 cost time: 80.63210439682007
Epoch: 2, Steps: 369 | Train Loss: 0.530 Vali Loss: 0.736 Vali Acc: 0.653 Test Loss: 0.736 Test Acc: 0.653
Validation loss decreased (-0.647269 --> -0.652944).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4277712
	speed: 0.7207s/iter; left time: 25991.9265s
	iters: 200, epoch: 3 | loss: 0.4727775
	speed: 0.2304s/iter; left time: 8284.3494s
	iters: 300, epoch: 3 | loss: 0.2444315
	speed: 0.2236s/iter; left time: 8018.8710s
Epoch: 3 cost time: 85.04904699325562
Epoch: 3, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.827 Vali Acc: 0.640 Test Loss: 0.827 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1578933
	speed: 0.6834s/iter; left time: 24393.1866s
	iters: 200, epoch: 4 | loss: 0.3431331
	speed: 0.2184s/iter; left time: 7774.7792s
	iters: 300, epoch: 4 | loss: 0.6459523
	speed: 0.2180s/iter; left time: 7738.7949s
Epoch: 4 cost time: 81.33960795402527
Epoch: 4, Steps: 369 | Train Loss: 0.368 Vali Loss: 0.810 Vali Acc: 0.663 Test Loss: 0.810 Test Acc: 0.663
Validation loss decreased (-0.652944 --> -0.662591).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0776254
	speed: 0.6760s/iter; left time: 23879.3683s
	iters: 200, epoch: 5 | loss: 0.2583881
	speed: 0.2170s/iter; left time: 7643.3116s
	iters: 300, epoch: 5 | loss: 0.0842252
	speed: 0.2115s/iter; left time: 7427.3284s
Epoch: 5 cost time: 79.29263210296631
Epoch: 5, Steps: 369 | Train Loss: 0.287 Vali Loss: 0.983 Vali Acc: 0.669 Test Loss: 0.983 Test Acc: 0.669
Validation loss decreased (-0.662591 --> -0.668832).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2524134
	speed: 0.6549s/iter; left time: 22892.1067s
	iters: 200, epoch: 6 | loss: 0.1811121
	speed: 0.2106s/iter; left time: 7341.5390s
	iters: 300, epoch: 6 | loss: 0.3324843
	speed: 0.2182s/iter; left time: 7584.1819s
Epoch: 6 cost time: 80.628586769104
Epoch: 6, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.094 Vali Acc: 0.657 Test Loss: 1.094 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1244047
	speed: 0.6801s/iter; left time: 23522.4783s
	iters: 200, epoch: 7 | loss: 0.2951137
	speed: 0.2288s/iter; left time: 7891.4947s
	iters: 300, epoch: 7 | loss: 0.0680545
	speed: 0.2279s/iter; left time: 7838.0385s
Epoch: 7 cost time: 82.88661241531372
Epoch: 7, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.179 Vali Acc: 0.655 Test Loss: 1.179 Test Acc: 0.655
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1511529
	speed: 0.6883s/iter; left time: 23551.7875s
	iters: 200, epoch: 8 | loss: 0.1947109
	speed: 0.2306s/iter; left time: 7865.9968s
	iters: 300, epoch: 8 | loss: 0.1453442
	speed: 0.2233s/iter; left time: 7595.3030s
Epoch: 8 cost time: 83.73307299613953
Epoch: 8, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.319 Vali Acc: 0.658 Test Loss: 1.319 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0222246
	speed: 0.6648s/iter; left time: 22502.7264s
	iters: 200, epoch: 9 | loss: 0.0590874
	speed: 0.2131s/iter; left time: 7193.4417s
	iters: 300, epoch: 9 | loss: 0.0935261
	speed: 0.2209s/iter; left time: 7432.2008s
Epoch: 9 cost time: 81.42816162109375
Epoch: 9, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.409 Vali Acc: 0.656 Test Loss: 1.409 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0086944
	speed: 0.6622s/iter; left time: 22170.4800s
	iters: 200, epoch: 10 | loss: 0.0077310
	speed: 0.2176s/iter; left time: 7263.1916s
	iters: 300, epoch: 10 | loss: 0.1283135
	speed: 0.2198s/iter; left time: 7315.7466s
Epoch: 10 cost time: 80.8763644695282
Epoch: 10, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.548 Vali Acc: 0.634 Test Loss: 1.548 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1076319
	speed: 0.6906s/iter; left time: 22868.0724s
	iters: 200, epoch: 11 | loss: 0.1765431
	speed: 0.2246s/iter; left time: 7414.1300s
	iters: 300, epoch: 11 | loss: 0.0050569
	speed: 0.2214s/iter; left time: 7287.0150s
Epoch: 11 cost time: 81.73257780075073
Epoch: 11, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.618 Vali Acc: 0.663 Test Loss: 1.618 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2812156
	speed: 0.6732s/iter; left time: 22042.6935s
	iters: 200, epoch: 12 | loss: 0.0976105
	speed: 0.2272s/iter; left time: 7417.8149s
	iters: 300, epoch: 12 | loss: 0.0226406
	speed: 0.2350s/iter; left time: 7648.0566s
Epoch: 12 cost time: 84.48950052261353
Epoch: 12, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.767 Vali Acc: 0.661 Test Loss: 1.767 Test Acc: 0.661
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0202635
	speed: 0.6955s/iter; left time: 22516.5078s
	iters: 200, epoch: 13 | loss: 0.0008537
	speed: 0.2297s/iter; left time: 7413.2218s
	iters: 300, epoch: 13 | loss: 0.0233819
	speed: 0.2230s/iter; left time: 7175.0619s
Epoch: 13 cost time: 84.59793901443481
Epoch: 13, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.852 Vali Acc: 0.651 Test Loss: 1.852 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0020859
	speed: 0.6951s/iter; left time: 22244.5228s
	iters: 200, epoch: 14 | loss: 0.0066795
	speed: 0.2213s/iter; left time: 7059.1552s
	iters: 300, epoch: 14 | loss: 0.1698020
	speed: 0.2089s/iter; left time: 6644.6293s
Epoch: 14 cost time: 80.04379916191101
Epoch: 14, Steps: 369 | Train Loss: 0.095 Vali Loss: 1.947 Vali Acc: 0.640 Test Loss: 1.947 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0002552
	speed: 0.6633s/iter; left time: 20982.1068s
	iters: 200, epoch: 15 | loss: 0.3607734
	speed: 0.2253s/iter; left time: 7104.5920s
	iters: 300, epoch: 15 | loss: 0.0394193
	speed: 0.2231s/iter; left time: 7014.2675s
Epoch: 15 cost time: 82.52643179893494
Epoch: 15, Steps: 369 | Train Loss: 0.085 Vali Loss: 1.922 Vali Acc: 0.663 Test Loss: 1.922 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6688422247446084
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8048195
	speed: 0.2236s/iter; left time: 8229.1187s
	iters: 200, epoch: 1 | loss: 0.6960680
	speed: 0.2261s/iter; left time: 8298.7499s
	iters: 300, epoch: 1 | loss: 0.6369576
	speed: 0.2225s/iter; left time: 8143.9229s
Epoch: 1 cost time: 82.20103359222412
Epoch: 1, Steps: 369 | Train Loss: 0.690 Vali Loss: 0.677 Vali Acc: 0.650 Test Loss: 0.677 Test Acc: 0.650
Validation loss decreased (inf --> -0.650391).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5891691
	speed: 0.6712s/iter; left time: 24452.3142s
	iters: 200, epoch: 2 | loss: 0.5578292
	speed: 0.2215s/iter; left time: 8048.8938s
	iters: 300, epoch: 2 | loss: 0.4407215
	speed: 0.2265s/iter; left time: 8207.7164s
Epoch: 2 cost time: 83.17298340797424
Epoch: 2, Steps: 369 | Train Loss: 0.541 Vali Loss: 0.697 Vali Acc: 0.659 Test Loss: 0.697 Test Acc: 0.659
Validation loss decreased (-0.650391 --> -0.658903).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3604752
	speed: 0.7012s/iter; left time: 25285.8035s
	iters: 200, epoch: 3 | loss: 0.3273496
	speed: 0.2189s/iter; left time: 7870.6119s
	iters: 300, epoch: 3 | loss: 0.2633709
	speed: 0.2254s/iter; left time: 8082.9681s
Epoch: 3 cost time: 83.21376204490662
Epoch: 3, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.833 Vali Acc: 0.647 Test Loss: 0.833 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2409219
	speed: 0.6641s/iter; left time: 23702.6403s
	iters: 200, epoch: 4 | loss: 0.3620775
	speed: 0.2250s/iter; left time: 8008.5357s
	iters: 300, epoch: 4 | loss: 0.5924298
	speed: 0.2213s/iter; left time: 7855.2472s
Epoch: 4 cost time: 81.02176356315613
Epoch: 4, Steps: 369 | Train Loss: 0.367 Vali Loss: 0.907 Vali Acc: 0.643 Test Loss: 0.907 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1150091
	speed: 0.6733s/iter; left time: 23784.3305s
	iters: 200, epoch: 5 | loss: 0.3702388
	speed: 0.2141s/iter; left time: 7539.9437s
	iters: 300, epoch: 5 | loss: 0.1712776
	speed: 0.2281s/iter; left time: 8011.8200s
Epoch: 5 cost time: 80.68217730522156
Epoch: 5, Steps: 369 | Train Loss: 0.285 Vali Loss: 1.033 Vali Acc: 0.656 Test Loss: 1.033 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3139653
	speed: 0.6797s/iter; left time: 23761.1786s
	iters: 200, epoch: 6 | loss: 0.1162337
	speed: 0.1962s/iter; left time: 6837.1474s
	iters: 300, epoch: 6 | loss: 0.0672101
	speed: 0.2112s/iter; left time: 7340.8810s
Epoch: 6 cost time: 78.23790383338928
Epoch: 6, Steps: 369 | Train Loss: 0.230 Vali Loss: 1.154 Vali Acc: 0.660 Test Loss: 1.154 Test Acc: 0.660
Validation loss decreased (-0.658903 --> -0.659750).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1650295
	speed: 0.6494s/iter; left time: 22461.3417s
	iters: 200, epoch: 7 | loss: 0.5136181
	speed: 0.2154s/iter; left time: 7427.7077s
	iters: 300, epoch: 7 | loss: 0.0890677
	speed: 0.2214s/iter; left time: 7614.1032s
Epoch: 7 cost time: 80.39795017242432
Epoch: 7, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.232 Vali Acc: 0.648 Test Loss: 1.232 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0832593
	speed: 0.6823s/iter; left time: 23348.0435s
	iters: 200, epoch: 8 | loss: 0.2650337
	speed: 0.2182s/iter; left time: 7445.7170s
	iters: 300, epoch: 8 | loss: 0.1028112
	speed: 0.2218s/iter; left time: 7544.5141s
Epoch: 8 cost time: 81.88065028190613
Epoch: 8, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.364 Vali Acc: 0.646 Test Loss: 1.364 Test Acc: 0.646
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0319036
	speed: 0.6806s/iter; left time: 23038.5742s
	iters: 200, epoch: 9 | loss: 0.1022392
	speed: 0.2117s/iter; left time: 7144.2872s
	iters: 300, epoch: 9 | loss: 0.0219138
	speed: 0.2159s/iter; left time: 7264.7918s
Epoch: 9 cost time: 81.16018152236938
Epoch: 9, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.438 Vali Acc: 0.663 Test Loss: 1.438 Test Acc: 0.663
Validation loss decreased (-0.659750 --> -0.663436).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2343103
	speed: 0.6728s/iter; left time: 22526.8573s
	iters: 200, epoch: 10 | loss: 0.1832034
	speed: 0.2177s/iter; left time: 7265.7799s
	iters: 300, epoch: 10 | loss: 0.2769980
	speed: 0.2175s/iter; left time: 7239.9530s
Epoch: 10 cost time: 80.79073596000671
Epoch: 10, Steps: 369 | Train Loss: 0.121 Vali Loss: 1.566 Vali Acc: 0.658 Test Loss: 1.566 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0721386
	speed: 0.6675s/iter; left time: 22103.0325s
	iters: 200, epoch: 11 | loss: 0.2389993
	speed: 0.2168s/iter; left time: 7156.2712s
	iters: 300, epoch: 11 | loss: 0.1099099
	speed: 0.2087s/iter; left time: 6869.7001s
Epoch: 11 cost time: 78.64753031730652
Epoch: 11, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.626 Vali Acc: 0.643 Test Loss: 1.626 Test Acc: 0.643
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2819074
	speed: 0.6839s/iter; left time: 22391.4853s
	iters: 200, epoch: 12 | loss: 0.0492274
	speed: 0.2207s/iter; left time: 7205.2420s
	iters: 300, epoch: 12 | loss: 0.0967599
	speed: 0.2079s/iter; left time: 6764.3724s
Epoch: 12 cost time: 82.04929757118225
Epoch: 12, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.878 Vali Acc: 0.637 Test Loss: 1.878 Test Acc: 0.637
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0004403
	speed: 0.7053s/iter; left time: 22831.9090s
	iters: 200, epoch: 13 | loss: 0.0023543
	speed: 0.2302s/iter; left time: 7428.4521s
	iters: 300, epoch: 13 | loss: 0.0817602
	speed: 0.2278s/iter; left time: 7327.6120s
Epoch: 13 cost time: 84.7755274772644
Epoch: 13, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.877 Vali Acc: 0.650 Test Loss: 1.877 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0160884
	speed: 0.6913s/iter; left time: 22122.9863s
	iters: 200, epoch: 14 | loss: 0.0028818
	speed: 0.2283s/iter; left time: 7282.6157s
	iters: 300, epoch: 14 | loss: 0.0133538
	speed: 0.2269s/iter; left time: 7217.1009s
Epoch: 14 cost time: 83.41787624359131
Epoch: 14, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.959 Vali Acc: 0.657 Test Loss: 1.959 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1069968
	speed: 0.6523s/iter; left time: 20635.5773s
	iters: 200, epoch: 15 | loss: 0.0095016
	speed: 0.2152s/iter; left time: 6785.9153s
	iters: 300, epoch: 15 | loss: 0.0883758
	speed: 0.2074s/iter; left time: 6520.5139s
Epoch: 15 cost time: 77.1772391796112
Epoch: 15, Steps: 369 | Train Loss: 0.090 Vali Loss: 1.977 Vali Acc: 0.648 Test Loss: 1.977 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0062230
	speed: 0.6457s/iter; left time: 20187.0046s
	iters: 200, epoch: 16 | loss: 0.0492465
	speed: 0.2189s/iter; left time: 6821.0412s
	iters: 300, epoch: 16 | loss: 0.1536734
	speed: 0.2101s/iter; left time: 6527.6399s
Epoch: 16 cost time: 79.63147759437561
Epoch: 16, Steps: 369 | Train Loss: 0.091 Vali Loss: 2.172 Vali Acc: 0.648 Test Loss: 2.172 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0575425
	speed: 0.6510s/iter; left time: 20113.8400s
	iters: 200, epoch: 17 | loss: 0.0041725
	speed: 0.2122s/iter; left time: 6535.2336s
	iters: 300, epoch: 17 | loss: 0.0300950
	speed: 0.2079s/iter; left time: 6383.3331s
Epoch: 17 cost time: 78.2714114189148
Epoch: 17, Steps: 369 | Train Loss: 0.093 Vali Loss: 2.366 Vali Acc: 0.644 Test Loss: 2.366 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0020383
	speed: 0.6662s/iter; left time: 20338.4944s
	iters: 200, epoch: 18 | loss: 0.0583858
	speed: 0.2069s/iter; left time: 6294.7136s
	iters: 300, epoch: 18 | loss: 0.0119964
	speed: 0.2215s/iter; left time: 6718.3236s
Epoch: 18 cost time: 80.86202812194824
Epoch: 18, Steps: 369 | Train Loss: 0.098 Vali Loss: 2.152 Vali Acc: 0.649 Test Loss: 2.152 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.7624305
	speed: 0.6988s/iter; left time: 21075.5094s
	iters: 200, epoch: 19 | loss: 0.1842192
	speed: 0.2253s/iter; left time: 6773.5329s
	iters: 300, epoch: 19 | loss: 0.1119941
	speed: 0.2143s/iter; left time: 6420.6320s
Epoch: 19 cost time: 81.74942064285278
Epoch: 19, Steps: 369 | Train Loss: 0.082 Vali Loss: 2.456 Vali Acc: 0.655 Test Loss: 2.456 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6634506242905789
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7316149
	speed: 0.2449s/iter; left time: 9011.5662s
	iters: 200, epoch: 1 | loss: 0.6321974
	speed: 0.2307s/iter; left time: 8468.3825s
	iters: 300, epoch: 1 | loss: 0.7720908
	speed: 0.2204s/iter; left time: 8067.4813s
Epoch: 1 cost time: 85.51646065711975
Epoch: 1, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.704 Vali Acc: 0.629 Test Loss: 0.704 Test Acc: 0.629
Validation loss decreased (inf --> -0.629108).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4370077
	speed: 0.6929s/iter; left time: 25243.1460s
	iters: 200, epoch: 2 | loss: 0.5436975
	speed: 0.2244s/iter; left time: 8152.0203s
	iters: 300, epoch: 2 | loss: 0.3198680
	speed: 0.2247s/iter; left time: 8139.8301s
Epoch: 2 cost time: 83.5373809337616
Epoch: 2, Steps: 369 | Train Loss: 0.547 Vali Loss: 0.736 Vali Acc: 0.657 Test Loss: 0.736 Test Acc: 0.657
Validation loss decreased (-0.629108 --> -0.657484).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4370632
	speed: 0.6988s/iter; left time: 25200.8527s
	iters: 200, epoch: 3 | loss: 0.6226260
	speed: 0.2275s/iter; left time: 8183.1899s
	iters: 300, epoch: 3 | loss: 0.3853037
	speed: 0.2271s/iter; left time: 8145.7816s
Epoch: 3 cost time: 85.50676584243774
Epoch: 3, Steps: 369 | Train Loss: 0.440 Vali Loss: 0.863 Vali Acc: 0.648 Test Loss: 0.863 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3582040
	speed: 0.7123s/iter; left time: 25424.3480s
	iters: 200, epoch: 4 | loss: 0.3290218
	speed: 0.2351s/iter; left time: 8367.0510s
	iters: 300, epoch: 4 | loss: 0.6671758
	speed: 0.2304s/iter; left time: 8178.0714s
Epoch: 4 cost time: 86.93323564529419
Epoch: 4, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.879 Vali Acc: 0.661 Test Loss: 0.879 Test Acc: 0.661
Validation loss decreased (-0.657484 --> -0.660604).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1125948
	speed: 0.7071s/iter; left time: 24978.1835s
	iters: 200, epoch: 5 | loss: 0.6396621
	speed: 0.2294s/iter; left time: 8081.4061s
	iters: 300, epoch: 5 | loss: 0.2692253
	speed: 0.2256s/iter; left time: 7924.6838s
Epoch: 5 cost time: 85.60896229743958
Epoch: 5, Steps: 369 | Train Loss: 0.303 Vali Loss: 1.100 Vali Acc: 0.665 Test Loss: 1.100 Test Acc: 0.665
Validation loss decreased (-0.660604 --> -0.665142).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3155397
	speed: 0.6909s/iter; left time: 24150.4239s
	iters: 200, epoch: 6 | loss: 0.0896170
	speed: 0.2092s/iter; left time: 7290.4678s
	iters: 300, epoch: 6 | loss: 0.0927472
	speed: 0.2226s/iter; left time: 7736.4933s
Epoch: 6 cost time: 80.53141331672668
Epoch: 6, Steps: 369 | Train Loss: 0.249 Vali Loss: 1.129 Vali Acc: 0.657 Test Loss: 1.129 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1080474
	speed: 0.6731s/iter; left time: 23281.5091s
	iters: 200, epoch: 7 | loss: 0.4741031
	speed: 0.2245s/iter; left time: 7741.8045s
	iters: 300, epoch: 7 | loss: 0.1334492
	speed: 0.2219s/iter; left time: 7631.7982s
Epoch: 7 cost time: 82.16296815872192
Epoch: 7, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.220 Vali Acc: 0.654 Test Loss: 1.220 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0299454
	speed: 0.6409s/iter; left time: 21930.5196s
	iters: 200, epoch: 8 | loss: 0.1033720
	speed: 0.2119s/iter; left time: 7230.5699s
	iters: 300, epoch: 8 | loss: 0.0292058
	speed: 0.2139s/iter; left time: 7276.0700s
Epoch: 8 cost time: 80.15384697914124
Epoch: 8, Steps: 369 | Train Loss: 0.158 Vali Loss: 1.392 Vali Acc: 0.651 Test Loss: 1.392 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0958322
	speed: 0.6852s/iter; left time: 23194.2001s
	iters: 200, epoch: 9 | loss: 0.0302422
	speed: 0.2310s/iter; left time: 7795.8216s
	iters: 300, epoch: 9 | loss: 0.0535630
	speed: 0.2393s/iter; left time: 8052.9650s
Epoch: 9 cost time: 86.88697338104248
Epoch: 9, Steps: 369 | Train Loss: 0.133 Vali Loss: 1.403 Vali Acc: 0.656 Test Loss: 1.403 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0297090
	speed: 0.7207s/iter; left time: 24130.0362s
	iters: 200, epoch: 10 | loss: 0.2510296
	speed: 0.2321s/iter; left time: 7746.6098s
	iters: 300, epoch: 10 | loss: 0.0952019
	speed: 0.2325s/iter; left time: 7739.1504s
Epoch: 10 cost time: 86.68469476699829
Epoch: 10, Steps: 369 | Train Loss: 0.141 Vali Loss: 1.554 Vali Acc: 0.653 Test Loss: 1.554 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4789355
	speed: 0.7353s/iter; left time: 24346.6570s
	iters: 200, epoch: 11 | loss: 0.4926595
	speed: 0.2340s/iter; left time: 7724.1052s
	iters: 300, epoch: 11 | loss: 0.0150620
	speed: 0.2316s/iter; left time: 7622.6315s
Epoch: 11 cost time: 86.36986517906189
Epoch: 11, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.645 Vali Acc: 0.671 Test Loss: 1.645 Test Acc: 0.671
Validation loss decreased (-0.665142 --> -0.670812).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0146553
	speed: 0.6941s/iter; left time: 22725.8869s
	iters: 200, epoch: 12 | loss: 0.0287714
	speed: 0.2252s/iter; left time: 7351.3908s
	iters: 300, epoch: 12 | loss: 0.0619764
	speed: 0.2211s/iter; left time: 7194.5735s
Epoch: 12 cost time: 83.61693668365479
Epoch: 12, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.843 Vali Acc: 0.665 Test Loss: 1.843 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0282206
	speed: 0.6985s/iter; left time: 22611.1004s
	iters: 200, epoch: 13 | loss: 0.0060859
	speed: 0.2270s/iter; left time: 7327.5624s
	iters: 300, epoch: 13 | loss: 0.0043381
	speed: 0.2221s/iter; left time: 7145.4994s
Epoch: 13 cost time: 83.36582446098328
Epoch: 13, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.916 Vali Acc: 0.659 Test Loss: 1.916 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0192751
	speed: 0.6804s/iter; left time: 21775.7166s
	iters: 200, epoch: 14 | loss: 0.0114877
	speed: 0.2252s/iter; left time: 7183.3942s
	iters: 300, epoch: 14 | loss: 0.0828279
	speed: 0.2281s/iter; left time: 7254.1667s
Epoch: 14 cost time: 83.33539652824402
Epoch: 14, Steps: 369 | Train Loss: 0.100 Vali Loss: 1.783 Vali Acc: 0.653 Test Loss: 1.783 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0643753
	speed: 0.7060s/iter; left time: 22332.7706s
	iters: 200, epoch: 15 | loss: 0.1336294
	speed: 0.2362s/iter; left time: 7447.1094s
	iters: 300, epoch: 15 | loss: 0.1784341
	speed: 0.2262s/iter; left time: 7109.6103s
Epoch: 15 cost time: 85.49253487586975
Epoch: 15, Steps: 369 | Train Loss: 0.093 Vali Loss: 1.948 Vali Acc: 0.660 Test Loss: 1.948 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0005265
	speed: 0.7135s/iter; left time: 22308.6357s
	iters: 200, epoch: 16 | loss: 0.0287312
	speed: 0.2289s/iter; left time: 7134.5121s
	iters: 300, epoch: 16 | loss: 0.0603549
	speed: 0.2230s/iter; left time: 6928.7569s
Epoch: 16 cost time: 83.591135263443
Epoch: 16, Steps: 369 | Train Loss: 0.101 Vali Loss: 1.922 Vali Acc: 0.664 Test Loss: 1.922 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0697918
	speed: 0.6876s/iter; left time: 21246.0058s
	iters: 200, epoch: 17 | loss: 0.1922380
	speed: 0.2364s/iter; left time: 7280.0330s
	iters: 300, epoch: 17 | loss: 0.2413909
	speed: 0.2306s/iter; left time: 7077.9402s
Epoch: 17 cost time: 85.45422649383545
Epoch: 17, Steps: 369 | Train Loss: 0.099 Vali Loss: 2.047 Vali Acc: 0.659 Test Loss: 2.047 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0955846
	speed: 0.7013s/iter; left time: 21410.7068s
	iters: 200, epoch: 18 | loss: 0.0906871
	speed: 0.2214s/iter; left time: 6735.7251s
	iters: 300, epoch: 18 | loss: 0.3977343
	speed: 0.2234s/iter; left time: 6774.1331s
Epoch: 18 cost time: 84.3644528388977
Epoch: 18, Steps: 369 | Train Loss: 0.088 Vali Loss: 2.183 Vali Acc: 0.647 Test Loss: 2.183 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6592715
	speed: 0.7022s/iter; left time: 21176.4760s
	iters: 200, epoch: 19 | loss: 0.1736947
	speed: 0.2276s/iter; left time: 6840.8536s
	iters: 300, epoch: 19 | loss: 0.0032766
	speed: 0.2209s/iter; left time: 6617.4743s
Epoch: 19 cost time: 83.95238757133484
Epoch: 19, Steps: 369 | Train Loss: 0.102 Vali Loss: 2.116 Vali Acc: 0.659 Test Loss: 2.116 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0681025
	speed: 0.7187s/iter; left time: 21409.9338s
	iters: 200, epoch: 20 | loss: 0.0019707
	speed: 0.2368s/iter; left time: 7030.7652s
	iters: 300, epoch: 20 | loss: 0.0047090
	speed: 0.2334s/iter; left time: 6907.1408s
Epoch: 20 cost time: 87.0344626903534
Epoch: 20, Steps: 369 | Train Loss: 0.077 Vali Loss: 2.334 Vali Acc: 0.643 Test Loss: 2.334 Test Acc: 0.643
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0687474
	speed: 0.7084s/iter; left time: 20841.0263s
	iters: 200, epoch: 21 | loss: 0.0445740
	speed: 0.2270s/iter; left time: 6656.8716s
	iters: 300, epoch: 21 | loss: 0.0519243
	speed: 0.2152s/iter; left time: 6289.2852s
Epoch: 21 cost time: 83.13228273391724
Epoch: 21, Steps: 369 | Train Loss: 0.078 Vali Loss: 2.315 Vali Acc: 0.652 Test Loss: 2.315 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6708286038592508
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6712180
	speed: 0.2498s/iter; left time: 9193.1089s
	iters: 200, epoch: 1 | loss: 0.6971020
	speed: 0.2313s/iter; left time: 8489.9582s
	iters: 300, epoch: 1 | loss: 0.7730007
	speed: 0.2265s/iter; left time: 8291.6715s
Epoch: 1 cost time: 85.37959957122803
Epoch: 1, Steps: 369 | Train Loss: 0.698 Vali Loss: 0.698 Vali Acc: 0.636 Test Loss: 0.698 Test Acc: 0.636
Validation loss decreased (inf --> -0.636202).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6649393
	speed: 0.6949s/iter; left time: 25317.5496s
	iters: 200, epoch: 2 | loss: 0.6469615
	speed: 0.2372s/iter; left time: 8616.5662s
	iters: 300, epoch: 2 | loss: 0.4696053
	speed: 0.2332s/iter; left time: 8449.5807s
Epoch: 2 cost time: 86.83519148826599
Epoch: 2, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.720 Vali Acc: 0.650 Test Loss: 0.720 Test Acc: 0.650
Validation loss decreased (-0.636202 --> -0.649823).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5090751
	speed: 0.6796s/iter; left time: 24509.6035s
	iters: 200, epoch: 3 | loss: 0.6812780
	speed: 0.2262s/iter; left time: 8134.4153s
	iters: 300, epoch: 3 | loss: 0.2023896
	speed: 0.2382s/iter; left time: 8540.8723s
Epoch: 3 cost time: 85.58611464500427
Epoch: 3, Steps: 369 | Train Loss: 0.458 Vali Loss: 0.820 Vali Acc: 0.653 Test Loss: 0.820 Test Acc: 0.653
Validation loss decreased (-0.649823 --> -0.652943).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2766509
	speed: 0.7259s/iter; left time: 25909.2973s
	iters: 200, epoch: 4 | loss: 0.4661276
	speed: 0.2390s/iter; left time: 8506.6046s
	iters: 300, epoch: 4 | loss: 0.5955389
	speed: 0.2356s/iter; left time: 8363.6329s
Epoch: 4 cost time: 87.85376334190369
Epoch: 4, Steps: 369 | Train Loss: 0.384 Vali Loss: 0.883 Vali Acc: 0.653 Test Loss: 0.883 Test Acc: 0.653
Validation loss decreased (-0.652943 --> -0.653226).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1719011
	speed: 0.7408s/iter; left time: 26167.5354s
	iters: 200, epoch: 5 | loss: 0.6729054
	speed: 0.2297s/iter; left time: 8091.2490s
	iters: 300, epoch: 5 | loss: 0.2800557
	speed: 0.2286s/iter; left time: 8028.3215s
Epoch: 5 cost time: 85.89452791213989
Epoch: 5, Steps: 369 | Train Loss: 0.320 Vali Loss: 1.003 Vali Acc: 0.673 Test Loss: 1.003 Test Acc: 0.673
Validation loss decreased (-0.653226 --> -0.673089).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3602280
	speed: 0.6994s/iter; left time: 24448.4145s
	iters: 200, epoch: 6 | loss: 0.3154707
	speed: 0.2257s/iter; left time: 7865.5115s
	iters: 300, epoch: 6 | loss: 0.0665174
	speed: 0.2274s/iter; left time: 7903.0809s
Epoch: 6 cost time: 83.49686574935913
Epoch: 6, Steps: 369 | Train Loss: 0.266 Vali Loss: 1.106 Vali Acc: 0.655 Test Loss: 1.106 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1402925
	speed: 0.6934s/iter; left time: 23981.2533s
	iters: 200, epoch: 7 | loss: 0.3444445
	speed: 0.2320s/iter; left time: 8002.3526s
	iters: 300, epoch: 7 | loss: 0.1898917
	speed: 0.2223s/iter; left time: 7645.0194s
Epoch: 7 cost time: 83.42418003082275
Epoch: 7, Steps: 369 | Train Loss: 0.208 Vali Loss: 1.232 Vali Acc: 0.656 Test Loss: 1.232 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1980838
	speed: 0.6766s/iter; left time: 23151.5447s
	iters: 200, epoch: 8 | loss: 0.0710330
	speed: 0.2248s/iter; left time: 7669.5429s
	iters: 300, epoch: 8 | loss: 0.2256282
	speed: 0.2358s/iter; left time: 8020.7926s
Epoch: 8 cost time: 85.32759857177734
Epoch: 8, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.298 Vali Acc: 0.660 Test Loss: 1.298 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1355496
	speed: 0.7150s/iter; left time: 24201.1149s
	iters: 200, epoch: 9 | loss: 0.0738668
	speed: 0.2519s/iter; left time: 8500.1349s
	iters: 300, epoch: 9 | loss: 0.2260817
	speed: 0.2477s/iter; left time: 8334.2646s
Epoch: 9 cost time: 90.73912620544434
Epoch: 9, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.488 Vali Acc: 0.653 Test Loss: 1.488 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0087734
	speed: 0.7473s/iter; left time: 25020.7811s
	iters: 200, epoch: 10 | loss: 0.2636477
	speed: 0.2394s/iter; left time: 7992.4160s
	iters: 300, epoch: 10 | loss: 0.0907450
	speed: 0.2321s/iter; left time: 7723.4456s
Epoch: 10 cost time: 88.9385678768158
Epoch: 10, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.567 Vali Acc: 0.654 Test Loss: 1.567 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2053465
	speed: 0.7606s/iter; left time: 25182.9991s
	iters: 200, epoch: 11 | loss: 0.5095978
	speed: 0.2412s/iter; left time: 7961.5452s
	iters: 300, epoch: 11 | loss: 0.0162581
	speed: 0.2394s/iter; left time: 7877.2724s
Epoch: 11 cost time: 90.45257949829102
Epoch: 11, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.666 Vali Acc: 0.656 Test Loss: 1.666 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0487831
	speed: 0.7726s/iter; left time: 25296.5572s
	iters: 200, epoch: 12 | loss: 0.3336369
	speed: 0.2459s/iter; left time: 8026.6562s
	iters: 300, epoch: 12 | loss: 0.0040570
	speed: 0.2567s/iter; left time: 8353.4889s
Epoch: 12 cost time: 94.29360842704773
Epoch: 12, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.748 Vali Acc: 0.657 Test Loss: 1.748 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2951280
	speed: 0.7515s/iter; left time: 24327.8160s
	iters: 200, epoch: 13 | loss: 0.1120802
	speed: 0.2587s/iter; left time: 8348.2057s
	iters: 300, epoch: 13 | loss: 0.0059090
	speed: 0.2388s/iter; left time: 7683.5655s
Epoch: 13 cost time: 91.20198941230774
Epoch: 13, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.927 Vali Acc: 0.650 Test Loss: 1.927 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0762437
	speed: 0.7753s/iter; left time: 24811.8404s
	iters: 200, epoch: 14 | loss: 0.5191437
	speed: 0.2603s/iter; left time: 8304.9715s
	iters: 300, epoch: 14 | loss: 0.0186379
	speed: 0.2429s/iter; left time: 7725.9076s
Epoch: 14 cost time: 95.65670371055603
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.790 Vali Acc: 0.650 Test Loss: 1.790 Test Acc: 0.650
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.3471451
	speed: 0.7722s/iter; left time: 24428.0627s
	iters: 200, epoch: 15 | loss: 0.1980199
	speed: 0.2280s/iter; left time: 7191.0531s
	iters: 300, epoch: 15 | loss: 0.0135237
	speed: 0.2389s/iter; left time: 7509.1792s
Epoch: 15 cost time: 86.8717393875122
Epoch: 15, Steps: 369 | Train Loss: 0.103 Vali Loss: 1.988 Vali Acc: 0.657 Test Loss: 1.988 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6730987514188422
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7957432
	speed: 0.2334s/iter; left time: 8589.1126s
	iters: 200, epoch: 1 | loss: 0.7334665
	speed: 0.2180s/iter; left time: 8001.9333s
	iters: 300, epoch: 1 | loss: 0.7643858
	speed: 0.2135s/iter; left time: 7814.2713s
Epoch: 1 cost time: 83.98280882835388
Epoch: 1, Steps: 369 | Train Loss: 0.702 Vali Loss: 0.689 Vali Acc: 0.645 Test Loss: 0.689 Test Acc: 0.645
Validation loss decreased (inf --> -0.644715).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7260905
	speed: 0.7017s/iter; left time: 25565.6366s
	iters: 200, epoch: 2 | loss: 0.5522202
	speed: 0.2385s/iter; left time: 8666.4590s
	iters: 300, epoch: 2 | loss: 0.5588905
	speed: 0.2240s/iter; left time: 8117.4653s
Epoch: 2 cost time: 84.86882829666138
Epoch: 2, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.689 Vali Acc: 0.665 Test Loss: 0.689 Test Acc: 0.665
Validation loss decreased (-0.644715 --> -0.664863).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5752478
	speed: 0.6627s/iter; left time: 23897.4011s
	iters: 200, epoch: 3 | loss: 0.6028665
	speed: 0.2404s/iter; left time: 8647.2381s
	iters: 300, epoch: 3 | loss: 0.3818862
	speed: 0.2178s/iter; left time: 7812.0150s
Epoch: 3 cost time: 83.2771680355072
Epoch: 3, Steps: 369 | Train Loss: 0.466 Vali Loss: 0.806 Vali Acc: 0.663 Test Loss: 0.806 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2683773
	speed: 0.6820s/iter; left time: 24342.9522s
	iters: 200, epoch: 4 | loss: 0.4613386
	speed: 0.2306s/iter; left time: 8208.6606s
	iters: 300, epoch: 4 | loss: 0.5473959
	speed: 0.2205s/iter; left time: 7824.8167s
Epoch: 4 cost time: 83.62456679344177
Epoch: 4, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.836 Vali Acc: 0.662 Test Loss: 0.836 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1033579
	speed: 0.6618s/iter; left time: 23378.4485s
	iters: 200, epoch: 5 | loss: 0.5922515
	speed: 0.2082s/iter; left time: 7333.3426s
	iters: 300, epoch: 5 | loss: 0.2349480
	speed: 0.2189s/iter; left time: 7687.3871s
Epoch: 5 cost time: 79.62769913673401
Epoch: 5, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.972 Vali Acc: 0.665 Test Loss: 0.972 Test Acc: 0.665
Validation loss decreased (-0.664863 --> -0.665427).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4610637
	speed: 0.6609s/iter; left time: 23101.5810s
	iters: 200, epoch: 6 | loss: 0.2922146
	speed: 0.2205s/iter; left time: 7686.3126s
	iters: 300, epoch: 6 | loss: 0.2970796
	speed: 0.2322s/iter; left time: 8070.4783s
Epoch: 6 cost time: 84.43763542175293
Epoch: 6, Steps: 369 | Train Loss: 0.273 Vali Loss: 1.035 Vali Acc: 0.662 Test Loss: 1.035 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1371967
	speed: 0.7058s/iter; left time: 24413.1746s
	iters: 200, epoch: 7 | loss: 0.2905300
	speed: 0.2339s/iter; left time: 8067.5420s
	iters: 300, epoch: 7 | loss: 0.1442648
	speed: 0.2137s/iter; left time: 7347.2464s
Epoch: 7 cost time: 81.7200608253479
Epoch: 7, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.179 Vali Acc: 0.650 Test Loss: 1.179 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2063795
	speed: 0.6612s/iter; left time: 22625.8594s
	iters: 200, epoch: 8 | loss: 0.2029971
	speed: 0.2356s/iter; left time: 8037.3043s
	iters: 300, epoch: 8 | loss: 0.3071516
	speed: 0.2210s/iter; left time: 7519.5447s
Epoch: 8 cost time: 82.15920996665955
Epoch: 8, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.289 Vali Acc: 0.655 Test Loss: 1.289 Test Acc: 0.655
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2035091
	speed: 0.6758s/iter; left time: 22873.7024s
	iters: 200, epoch: 9 | loss: 0.0383935
	speed: 0.2281s/iter; left time: 7698.3278s
	iters: 300, epoch: 9 | loss: 0.0518338
	speed: 0.2399s/iter; left time: 8072.0452s
Epoch: 9 cost time: 86.27269864082336
Epoch: 9, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.407 Vali Acc: 0.657 Test Loss: 1.407 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0214649
	speed: 0.7085s/iter; left time: 23720.9720s
	iters: 200, epoch: 10 | loss: 0.1277373
	speed: 0.2364s/iter; left time: 7892.2118s
	iters: 300, epoch: 10 | loss: 0.3373322
	speed: 0.2267s/iter; left time: 7543.2333s
Epoch: 10 cost time: 86.25956630706787
Epoch: 10, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.493 Vali Acc: 0.661 Test Loss: 1.493 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2306948
	speed: 0.6815s/iter; left time: 22563.9496s
	iters: 200, epoch: 11 | loss: 0.4800366
	speed: 0.2359s/iter; left time: 7786.3028s
	iters: 300, epoch: 11 | loss: 0.0341553
	speed: 0.2347s/iter; left time: 7723.7811s
Epoch: 11 cost time: 86.36510300636292
Epoch: 11, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.591 Vali Acc: 0.653 Test Loss: 1.591 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0357771
	speed: 0.6858s/iter; left time: 22454.6892s
	iters: 200, epoch: 12 | loss: 0.0460635
	speed: 0.2550s/iter; left time: 8325.1068s
	iters: 300, epoch: 12 | loss: 0.0836211
	speed: 0.2441s/iter; left time: 7944.0030s
Epoch: 12 cost time: 90.3456449508667
Epoch: 12, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.909 Vali Acc: 0.633 Test Loss: 1.909 Test Acc: 0.633
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0860234
	speed: 0.7078s/iter; left time: 22915.2131s
	iters: 200, epoch: 13 | loss: 0.0417412
	speed: 0.2129s/iter; left time: 6872.5168s
	iters: 300, epoch: 13 | loss: 0.0156524
	speed: 0.2207s/iter; left time: 7100.5825s
Epoch: 13 cost time: 80.38731050491333
Epoch: 13, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.725 Vali Acc: 0.654 Test Loss: 1.725 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0120452
	speed: 0.6656s/iter; left time: 21302.5452s
	iters: 200, epoch: 14 | loss: 0.0072727
	speed: 0.2241s/iter; left time: 7150.0050s
	iters: 300, epoch: 14 | loss: 0.0698547
	speed: 0.2316s/iter; left time: 7366.1072s
Epoch: 14 cost time: 83.08083939552307
Epoch: 14, Steps: 369 | Train Loss: 0.092 Vali Loss: 1.843 Vali Acc: 0.653 Test Loss: 1.843 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0028648
	speed: 0.6597s/iter; left time: 20870.3834s
	iters: 200, epoch: 15 | loss: 0.0392976
	speed: 0.2285s/iter; left time: 7207.0940s
	iters: 300, epoch: 15 | loss: 0.0164445
	speed: 0.2213s/iter; left time: 6955.7239s
Epoch: 15 cost time: 81.95162725448608
Epoch: 15, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.798 Vali Acc: 0.663 Test Loss: 1.798 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6654370034052214
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6925546
	speed: 0.2562s/iter; left time: 9427.6456s
	iters: 200, epoch: 1 | loss: 0.6937997
	speed: 0.2246s/iter; left time: 8243.0345s
	iters: 300, epoch: 1 | loss: 0.6935479
	speed: 0.2342s/iter; left time: 8570.6700s
Epoch: 1 cost time: 87.88375687599182
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6931226
	speed: 0.6914s/iter; left time: 25188.4402s
	iters: 200, epoch: 2 | loss: 0.6931556
	speed: 0.2146s/iter; left time: 7795.0841s
	iters: 300, epoch: 2 | loss: 0.6919036
	speed: 0.2226s/iter; left time: 8064.5314s
Epoch: 2 cost time: 80.91329598426819
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6937302
	speed: 0.6559s/iter; left time: 23653.6248s
	iters: 200, epoch: 3 | loss: 0.6910095
	speed: 0.2332s/iter; left time: 8387.6109s
	iters: 300, epoch: 3 | loss: 0.6891753
	speed: 0.2397s/iter; left time: 8596.1512s
Epoch: 3 cost time: 86.32818508148193
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6914327
	speed: 0.7311s/iter; left time: 26097.0918s
	iters: 200, epoch: 4 | loss: 0.6926993
	speed: 0.2634s/iter; left time: 9375.2278s
	iters: 300, epoch: 4 | loss: 0.6940273
	speed: 0.2361s/iter; left time: 8381.3239s
Epoch: 4 cost time: 91.84008049964905
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6950921
	speed: 0.7242s/iter; left time: 25582.2169s
	iters: 200, epoch: 5 | loss: 0.6931624
	speed: 0.2296s/iter; left time: 8089.0889s
	iters: 300, epoch: 5 | loss: 0.6928732
	speed: 0.2324s/iter; left time: 8164.3676s
Epoch: 5 cost time: 87.77650475502014
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6932117
	speed: 0.7417s/iter; left time: 25927.4795s
	iters: 200, epoch: 6 | loss: 0.6928590
	speed: 0.2573s/iter; left time: 8967.4493s
	iters: 300, epoch: 6 | loss: 0.6919667
	speed: 0.2634s/iter; left time: 9153.6074s
Epoch: 6 cost time: 93.22629451751709
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6935292
	speed: 0.7368s/iter; left time: 25482.8367s
	iters: 200, epoch: 7 | loss: 0.6941380
	speed: 0.2444s/iter; left time: 8427.7000s
	iters: 300, epoch: 7 | loss: 0.6905990
	speed: 0.2408s/iter; left time: 8280.4326s
Epoch: 7 cost time: 91.39146137237549
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6931790
	speed: 0.7267s/iter; left time: 24867.0976s
	iters: 200, epoch: 8 | loss: 0.6935326
	speed: 0.2511s/iter; left time: 8566.9672s
	iters: 300, epoch: 8 | loss: 0.6965802
	speed: 0.2563s/iter; left time: 8717.2482s
Epoch: 8 cost time: 92.41767382621765
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6952807
	speed: 0.7344s/iter; left time: 24858.2727s
	iters: 200, epoch: 9 | loss: 0.6931552
	speed: 0.2238s/iter; left time: 7554.0321s
	iters: 300, epoch: 9 | loss: 0.6931632
	speed: 0.2231s/iter; left time: 7506.9559s
Epoch: 9 cost time: 83.1008710861206
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.6947495
	speed: 0.6860s/iter; left time: 22968.0521s
	iters: 200, epoch: 10 | loss: 0.6927093
	speed: 0.2200s/iter; left time: 7345.1316s
	iters: 300, epoch: 10 | loss: 0.6927221
	speed: 0.2097s/iter; left time: 6977.5306s
Epoch: 10 cost time: 80.97006106376648
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6912238
	speed: 0.6811s/iter; left time: 22552.2521s
	iters: 200, epoch: 11 | loss: 0.6945734
	speed: 0.2207s/iter; left time: 7285.8011s
	iters: 300, epoch: 11 | loss: 0.6931816
	speed: 0.2368s/iter; left time: 7794.4381s
Epoch: 11 cost time: 84.8894567489624
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6914970
	speed: 0.7006s/iter; left time: 22938.7311s
	iters: 200, epoch: 12 | loss: 0.6922394
	speed: 0.2279s/iter; left time: 7438.7362s
	iters: 300, epoch: 12 | loss: 0.6931525
	speed: 0.2561s/iter; left time: 8333.9495s
Epoch: 12 cost time: 88.48574018478394
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6919455
	speed: 0.7002s/iter; left time: 22668.3852s
	iters: 200, epoch: 13 | loss: 0.6909697
	speed: 0.2209s/iter; left time: 7127.7336s
	iters: 300, epoch: 13 | loss: 0.6931508
	speed: 0.2316s/iter; left time: 7450.4139s
Epoch: 13 cost time: 83.9360659122467
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6909915
	speed: 0.7080s/iter; left time: 22660.3899s
	iters: 200, epoch: 14 | loss: 0.6931690
	speed: 0.2556s/iter; left time: 8154.2151s
	iters: 300, epoch: 14 | loss: 0.6928724
	speed: 0.2440s/iter; left time: 7758.8080s
Epoch: 14 cost time: 91.24675512313843
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6919438
	speed: 0.7258s/iter; left time: 22959.5928s
	iters: 200, epoch: 15 | loss: 0.6920146
	speed: 0.2416s/iter; left time: 7619.4687s
	iters: 300, epoch: 15 | loss: 0.6923326
	speed: 0.2447s/iter; left time: 7692.5833s
Epoch: 15 cost time: 90.52068400382996
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6931741
	speed: 0.7447s/iter; left time: 23282.8688s
	iters: 200, epoch: 16 | loss: 0.6940985
	speed: 0.2445s/iter; left time: 7621.0696s
	iters: 300, epoch: 16 | loss: 0.6932109
	speed: 0.2512s/iter; left time: 7803.1400s
Epoch: 16 cost time: 90.72897911071777
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6922431
	speed: 0.7182s/iter; left time: 22190.7429s
	iters: 200, epoch: 17 | loss: 0.6930769
	speed: 0.2298s/iter; left time: 7077.2182s
	iters: 300, epoch: 17 | loss: 0.6888706
	speed: 0.2378s/iter; left time: 7299.4267s
Epoch: 17 cost time: 87.95600461959839
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.6930544
	speed: 0.7123s/iter; left time: 21743.8856s
	iters: 200, epoch: 18 | loss: 0.6921259
	speed: 0.2384s/iter; left time: 7252.5138s
	iters: 300, epoch: 18 | loss: 0.6937302
	speed: 0.2415s/iter; left time: 7322.7624s
Epoch: 18 cost time: 89.31394219398499
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.7016424
	speed: 0.7316s/iter; left time: 22064.9799s
	iters: 200, epoch: 19 | loss: 0.6984470
	speed: 0.2395s/iter; left time: 7200.2244s
	iters: 300, epoch: 19 | loss: 0.6926449
	speed: 0.2437s/iter; left time: 7301.1536s
Epoch: 19 cost time: 89.78794121742249
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6905119
	speed: 0.7352s/iter; left time: 21900.6528s
	iters: 200, epoch: 20 | loss: 0.6940055
	speed: 0.2667s/iter; left time: 7916.9955s
	iters: 300, epoch: 20 | loss: 0.6927027
	speed: 0.2454s/iter; left time: 7259.9763s
Epoch: 20 cost time: 93.15904808044434
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6897939
	speed: 0.7304s/iter; left time: 21489.4378s
	iters: 200, epoch: 21 | loss: 0.6938534
	speed: 0.2375s/iter; left time: 6964.7549s
	iters: 300, epoch: 21 | loss: 0.6941816
	speed: 0.2351s/iter; left time: 6869.8639s
Epoch: 21 cost time: 87.60719633102417
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6927211
	speed: 0.7013s/iter; left time: 20373.1055s
	iters: 200, epoch: 22 | loss: 0.6933729
	speed: 0.2558s/iter; left time: 7405.9197s
	iters: 300, epoch: 22 | loss: 0.6940187
	speed: 0.2384s/iter; left time: 6879.0717s
Epoch: 22 cost time: 89.8219563961029
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.6923634
	speed: 0.7105s/iter; left time: 20378.0096s
	iters: 200, epoch: 23 | loss: 0.6936089
	speed: 0.2457s/iter; left time: 7023.0903s
	iters: 300, epoch: 23 | loss: 0.6930478
	speed: 0.2378s/iter; left time: 6774.5034s
Epoch: 23 cost time: 90.90396523475647
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.6939359
	speed: 0.7619s/iter; left time: 21571.6344s
	iters: 200, epoch: 24 | loss: 0.6939878
	speed: 0.2346s/iter; left time: 6619.3965s
	iters: 300, epoch: 24 | loss: 0.6933360
	speed: 0.2602s/iter; left time: 7315.6479s
Epoch: 24 cost time: 91.86507153511047
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.6930692
	speed: 0.7170s/iter; left time: 20036.5054s
	iters: 200, epoch: 25 | loss: 0.6927826
	speed: 0.2328s/iter; left time: 6481.1123s
	iters: 300, epoch: 25 | loss: 0.6931472
	speed: 0.2419s/iter; left time: 6711.6821s
Epoch: 25 cost time: 88.06105542182922
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.6942832
	speed: 0.7005s/iter; left time: 19316.6769s
	iters: 200, epoch: 26 | loss: 0.6941373
	speed: 0.2341s/iter; left time: 6433.0647s
	iters: 300, epoch: 26 | loss: 0.6922611
	speed: 0.2416s/iter; left time: 6614.1789s
Epoch: 26 cost time: 87.33489346504211
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.6930335
	speed: 0.7459s/iter; left time: 20294.1199s
	iters: 200, epoch: 27 | loss: 0.6951769
	speed: 0.2552s/iter; left time: 6918.6022s
	iters: 300, epoch: 27 | loss: 0.6957410
	speed: 0.2362s/iter; left time: 6377.8048s
Epoch: 27 cost time: 89.52937078475952
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.6931536
	speed: 0.6915s/iter; left time: 18558.0290s
	iters: 200, epoch: 28 | loss: 0.6930003
	speed: 0.2526s/iter; left time: 6752.8504s
	iters: 300, epoch: 28 | loss: 0.6946205
	speed: 0.2361s/iter; left time: 6289.2778s
Epoch: 28 cost time: 88.4180817604065
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.6937386
	speed: 0.7061s/iter; left time: 18690.7976s
	iters: 200, epoch: 29 | loss: 0.6926522
	speed: 0.2436s/iter; left time: 6423.3272s
	iters: 300, epoch: 29 | loss: 0.6942205
	speed: 0.2361s/iter; left time: 6203.1133s
Epoch: 29 cost time: 88.44423198699951
Epoch: 29, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.6947533
	speed: 0.7518s/iter; left time: 19621.9929s
	iters: 200, epoch: 30 | loss: 0.6898077
	speed: 0.2315s/iter; left time: 6020.2839s
	iters: 300, epoch: 30 | loss: 0.6936194
	speed: 0.2422s/iter; left time: 6273.7846s
Epoch: 30 cost time: 89.50654458999634
Epoch: 30, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.6931472
	speed: 0.7091s/iter; left time: 18246.1344s
	iters: 200, epoch: 31 | loss: 0.6898556
	speed: 0.2213s/iter; left time: 5672.5293s
	iters: 300, epoch: 31 | loss: 0.6931918
	speed: 0.2396s/iter; left time: 6116.3022s
Epoch: 31 cost time: 86.05844783782959
Epoch: 31, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.6909195
	speed: 0.7277s/iter; left time: 18454.6906s
	iters: 200, epoch: 32 | loss: 0.6903860
	speed: 0.2338s/iter; left time: 5905.0433s
	iters: 300, epoch: 32 | loss: 0.6931654
	speed: 0.2225s/iter; left time: 5599.7592s
Epoch: 32 cost time: 86.78177237510681
Epoch: 32, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.6950471
	speed: 0.7115s/iter; left time: 17781.4151s
	iters: 200, epoch: 33 | loss: 0.6922271
	speed: 0.2340s/iter; left time: 5824.7213s
	iters: 300, epoch: 33 | loss: 0.6937392
	speed: 0.2271s/iter; left time: 5629.4836s
Epoch: 33 cost time: 86.52716732025146
Epoch: 33, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.6932368
	speed: 0.7119s/iter; left time: 17529.0417s
	iters: 200, epoch: 34 | loss: 0.6924958
	speed: 0.2382s/iter; left time: 5840.6733s
	iters: 300, epoch: 34 | loss: 0.6918268
	speed: 0.2471s/iter; left time: 6034.2272s
Epoch: 34 cost time: 89.40936017036438
Epoch: 34, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.6884789
	speed: 0.7357s/iter; left time: 17843.6199s
	iters: 200, epoch: 35 | loss: 0.6924785
	speed: 0.2418s/iter; left time: 5840.1429s
	iters: 300, epoch: 35 | loss: 0.6930892
	speed: 0.2305s/iter; left time: 5544.4981s
Epoch: 35 cost time: 87.47920560836792
Epoch: 35, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.6928129
	speed: 0.7184s/iter; left time: 17160.2973s
	iters: 200, epoch: 36 | loss: 0.6932452
	speed: 0.2434s/iter; left time: 5788.9793s
	iters: 300, epoch: 36 | loss: 0.6879190
	speed: 0.2437s/iter; left time: 5772.8974s
Epoch: 36 cost time: 87.52924132347107
Epoch: 36, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.6916167
	speed: 0.7067s/iter; left time: 16620.0732s
	iters: 200, epoch: 37 | loss: 0.6875476
	speed: 0.2359s/iter; left time: 5523.5796s
	iters: 300, epoch: 37 | loss: 0.6931902
	speed: 0.2360s/iter; left time: 5501.6957s
Epoch: 37 cost time: 87.35290694236755
Epoch: 37, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.6926042
	speed: 0.7300s/iter; left time: 16898.5408s
	iters: 200, epoch: 38 | loss: 0.6942102
	speed: 0.2486s/iter; left time: 5730.0619s
	iters: 300, epoch: 38 | loss: 0.6931491
	speed: 0.2373s/iter; left time: 5446.2785s
Epoch: 38 cost time: 90.3820629119873
Epoch: 38, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 215874
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6982789
	speed: 0.2238s/iter; left time: 8237.0944s
	iters: 200, epoch: 1 | loss: 0.6480139
	speed: 0.2205s/iter; left time: 8092.8128s
	iters: 300, epoch: 1 | loss: 0.4707396
	speed: 0.2236s/iter; left time: 8184.7791s
Epoch: 1 cost time: 82.39858889579773
Epoch: 1, Steps: 369 | Train Loss: 0.661 Vali Loss: 0.670 Vali Acc: 0.623 Test Loss: 0.670 Test Acc: 0.623
Validation loss decreased (inf --> -0.622865).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7648661
	speed: 0.6816s/iter; left time: 24832.0899s
	iters: 200, epoch: 2 | loss: 0.4530919
	speed: 0.2357s/iter; left time: 8563.7887s
	iters: 300, epoch: 2 | loss: 0.8980130
	speed: 0.2305s/iter; left time: 8352.5445s
Epoch: 2 cost time: 86.20915007591248
Epoch: 2, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.668 Vali Acc: 0.667 Test Loss: 0.668 Test Acc: 0.667
Validation loss decreased (-0.622865 --> -0.666849).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2427641
	speed: 0.6918s/iter; left time: 24949.0303s
	iters: 200, epoch: 3 | loss: 0.7482520
	speed: 0.2261s/iter; left time: 8132.9423s
	iters: 300, epoch: 3 | loss: 0.2828002
	speed: 0.2356s/iter; left time: 8449.9630s
Epoch: 3 cost time: 82.6321976184845
Epoch: 3, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.658 Vali Acc: 0.678 Test Loss: 0.658 Test Acc: 0.678
Validation loss decreased (-0.666849 --> -0.678484).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5549732
	speed: 0.6796s/iter; left time: 24258.7476s
	iters: 200, epoch: 4 | loss: 0.3627152
	speed: 0.2165s/iter; left time: 7706.1543s
	iters: 300, epoch: 4 | loss: 0.5745918
	speed: 0.2162s/iter; left time: 7673.0549s
Epoch: 4 cost time: 82.48914241790771
Epoch: 4, Steps: 369 | Train Loss: 0.444 Vali Loss: 0.705 Vali Acc: 0.677 Test Loss: 0.705 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2977087
	speed: 0.6947s/iter; left time: 24539.2929s
	iters: 200, epoch: 5 | loss: 0.5119321
	speed: 0.2256s/iter; left time: 7946.7158s
	iters: 300, epoch: 5 | loss: 0.1994531
	speed: 0.2265s/iter; left time: 7957.5425s
Epoch: 5 cost time: 86.28961563110352
Epoch: 5, Steps: 369 | Train Loss: 0.407 Vali Loss: 0.739 Vali Acc: 0.684 Test Loss: 0.739 Test Acc: 0.684
Validation loss decreased (-0.678484 --> -0.683875).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1407920
	speed: 0.7122s/iter; left time: 24896.7773s
	iters: 200, epoch: 6 | loss: 0.3867847
	speed: 0.2060s/iter; left time: 7178.7285s
	iters: 300, epoch: 6 | loss: 0.2142831
	speed: 0.2192s/iter; left time: 7619.8791s
Epoch: 6 cost time: 80.45493459701538
Epoch: 6, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.803 Vali Acc: 0.684 Test Loss: 0.803 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2382034
	speed: 0.6946s/iter; left time: 24024.1392s
	iters: 200, epoch: 7 | loss: 0.4445187
	speed: 0.2293s/iter; left time: 7906.9936s
	iters: 300, epoch: 7 | loss: 0.3586970
	speed: 0.2400s/iter; left time: 8254.0018s
Epoch: 7 cost time: 85.52012991905212
Epoch: 7, Steps: 369 | Train Loss: 0.330 Vali Loss: 0.837 Vali Acc: 0.689 Test Loss: 0.837 Test Acc: 0.689
Validation loss decreased (-0.683875 --> -0.688698).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1297729
	speed: 0.6682s/iter; left time: 22865.6984s
	iters: 200, epoch: 8 | loss: 0.1911981
	speed: 0.2350s/iter; left time: 8019.1229s
	iters: 300, epoch: 8 | loss: 0.2154904
	speed: 0.2376s/iter; left time: 8084.3652s
Epoch: 8 cost time: 83.93875169754028
Epoch: 8, Steps: 369 | Train Loss: 0.288 Vali Loss: 0.927 Vali Acc: 0.676 Test Loss: 0.927 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1244107
	speed: 0.7312s/iter; left time: 24749.2685s
	iters: 200, epoch: 9 | loss: 0.2545330
	speed: 0.2370s/iter; left time: 7999.7006s
	iters: 300, epoch: 9 | loss: 0.3019225
	speed: 0.2281s/iter; left time: 7675.0766s
Epoch: 9 cost time: 88.23934698104858
Epoch: 9, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.969 Vali Acc: 0.676 Test Loss: 0.969 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1930843
	speed: 0.7003s/iter; left time: 23445.4760s
	iters: 200, epoch: 10 | loss: 0.4697239
	speed: 0.2228s/iter; left time: 7436.9989s
	iters: 300, epoch: 10 | loss: 0.0819912
	speed: 0.2288s/iter; left time: 7613.2445s
Epoch: 10 cost time: 83.48664116859436
Epoch: 10, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.061 Vali Acc: 0.659 Test Loss: 1.061 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2361713
	speed: 0.6861s/iter; left time: 22716.8625s
	iters: 200, epoch: 11 | loss: 0.0209015
	speed: 0.2384s/iter; left time: 7870.3587s
	iters: 300, epoch: 11 | loss: 0.2554154
	speed: 0.2288s/iter; left time: 7530.2754s
Epoch: 11 cost time: 86.73439049720764
Epoch: 11, Steps: 369 | Train Loss: 0.203 Vali Loss: 1.147 Vali Acc: 0.663 Test Loss: 1.147 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0802489
	speed: 0.6841s/iter; left time: 22398.5359s
	iters: 200, epoch: 12 | loss: 0.2812144
	speed: 0.2289s/iter; left time: 7470.3126s
	iters: 300, epoch: 12 | loss: 0.1974545
	speed: 0.2265s/iter; left time: 7370.2334s
Epoch: 12 cost time: 83.23004913330078
Epoch: 12, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.235 Vali Acc: 0.659 Test Loss: 1.235 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0636315
	speed: 0.6930s/iter; left time: 22434.8387s
	iters: 200, epoch: 13 | loss: 0.1481122
	speed: 0.2136s/iter; left time: 6893.8028s
	iters: 300, epoch: 13 | loss: 0.1256776
	speed: 0.2396s/iter; left time: 7708.7953s
Epoch: 13 cost time: 83.77488398551941
Epoch: 13, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.349 Vali Acc: 0.659 Test Loss: 1.349 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0662150
	speed: 0.6858s/iter; left time: 21947.3095s
	iters: 200, epoch: 14 | loss: 0.0151128
	speed: 0.2196s/iter; left time: 7006.2300s
	iters: 300, epoch: 14 | loss: 0.0302583
	speed: 0.2293s/iter; left time: 7291.9852s
Epoch: 14 cost time: 80.27547574043274
Epoch: 14, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.425 Vali Acc: 0.669 Test Loss: 1.425 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1377750
	speed: 0.6957s/iter; left time: 22006.9055s
	iters: 200, epoch: 15 | loss: 0.0022533
	speed: 0.2200s/iter; left time: 6939.2308s
	iters: 300, epoch: 15 | loss: 0.0260520
	speed: 0.2347s/iter; left time: 7378.0006s
Epoch: 15 cost time: 83.45545887947083
Epoch: 15, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.450 Vali Acc: 0.646 Test Loss: 1.450 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0839387
	speed: 0.6878s/iter; left time: 21503.3666s
	iters: 200, epoch: 16 | loss: 0.4200792
	speed: 0.2354s/iter; left time: 7337.8698s
	iters: 300, epoch: 16 | loss: 0.2316196
	speed: 0.2276s/iter; left time: 7071.0373s
Epoch: 16 cost time: 85.29455399513245
Epoch: 16, Steps: 369 | Train Loss: 0.134 Vali Loss: 1.484 Vali Acc: 0.661 Test Loss: 1.484 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0129457
	speed: 0.7157s/iter; left time: 22113.9505s
	iters: 200, epoch: 17 | loss: 0.3268404
	speed: 0.2342s/iter; left time: 7212.1835s
	iters: 300, epoch: 17 | loss: 0.0960396
	speed: 0.2280s/iter; left time: 6999.5746s
Epoch: 17 cost time: 88.02652311325073
Epoch: 17, Steps: 369 | Train Loss: 0.125 Vali Loss: 1.589 Vali Acc: 0.657 Test Loss: 1.589 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6887060158910329
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7361842
	speed: 0.2432s/iter; left time: 8948.3071s
	iters: 200, epoch: 1 | loss: 0.7330166
	speed: 0.2343s/iter; left time: 8597.6953s
	iters: 300, epoch: 1 | loss: 0.5001173
	speed: 0.2505s/iter; left time: 9170.0528s
Epoch: 1 cost time: 89.22894239425659
Epoch: 1, Steps: 369 | Train Loss: 0.675 Vali Loss: 0.697 Vali Acc: 0.609 Test Loss: 0.697 Test Acc: 0.609
Validation loss decreased (inf --> -0.609244).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7262015
	speed: 0.6784s/iter; left time: 24715.0817s
	iters: 200, epoch: 2 | loss: 0.4476047
	speed: 0.2273s/iter; left time: 8259.7528s
	iters: 300, epoch: 2 | loss: 0.7415410
	speed: 0.2281s/iter; left time: 8265.0295s
Epoch: 2 cost time: 83.08031439781189
Epoch: 2, Steps: 369 | Train Loss: 0.557 Vali Loss: 0.690 Vali Acc: 0.650 Test Loss: 0.690 Test Acc: 0.650
Validation loss decreased (-0.609244 --> -0.650390).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2519496
	speed: 0.7086s/iter; left time: 25553.3678s
	iters: 200, epoch: 3 | loss: 0.6414363
	speed: 0.2406s/iter; left time: 8653.1725s
	iters: 300, epoch: 3 | loss: 0.3267761
	speed: 0.2284s/iter; left time: 8192.5307s
Epoch: 3 cost time: 85.49246668815613
Epoch: 3, Steps: 369 | Train Loss: 0.488 Vali Loss: 0.682 Vali Acc: 0.671 Test Loss: 0.682 Test Acc: 0.671
Validation loss decreased (-0.650390 --> -0.671106).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6833171
	speed: 0.7284s/iter; left time: 25999.0537s
	iters: 200, epoch: 4 | loss: 0.4285491
	speed: 0.2352s/iter; left time: 8371.8013s
	iters: 300, epoch: 4 | loss: 0.5731269
	speed: 0.2263s/iter; left time: 8032.6856s
Epoch: 4 cost time: 87.22045230865479
Epoch: 4, Steps: 369 | Train Loss: 0.441 Vali Loss: 0.712 Vali Acc: 0.668 Test Loss: 0.712 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2481484
	speed: 0.7182s/iter; left time: 25371.3560s
	iters: 200, epoch: 5 | loss: 0.5598612
	speed: 0.2350s/iter; left time: 8278.2554s
	iters: 300, epoch: 5 | loss: 0.2508791
	speed: 0.2225s/iter; left time: 7813.5665s
Epoch: 5 cost time: 85.30354046821594
Epoch: 5, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.758 Vali Acc: 0.673 Test Loss: 0.758 Test Acc: 0.673
Validation loss decreased (-0.671106 --> -0.673091).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2211562
	speed: 0.6990s/iter; left time: 24434.2962s
	iters: 200, epoch: 6 | loss: 0.3295738
	speed: 0.2368s/iter; left time: 8252.4526s
	iters: 300, epoch: 6 | loss: 0.3594711
	speed: 0.2403s/iter; left time: 8351.6744s
Epoch: 6 cost time: 87.67759680747986
Epoch: 6, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.816 Vali Acc: 0.680 Test Loss: 0.816 Test Acc: 0.680
Validation loss decreased (-0.673091 --> -0.679617).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2788295
	speed: 0.6811s/iter; left time: 23556.8975s
	iters: 200, epoch: 7 | loss: 0.5263553
	speed: 0.2097s/iter; left time: 7230.4244s
	iters: 300, epoch: 7 | loss: 0.2498801
	speed: 0.2307s/iter; left time: 7933.6892s
Epoch: 7 cost time: 83.0221016407013
Epoch: 7, Steps: 369 | Train Loss: 0.342 Vali Loss: 0.818 Vali Acc: 0.674 Test Loss: 0.818 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2518296
	speed: 0.7311s/iter; left time: 25015.3857s
	iters: 200, epoch: 8 | loss: 0.2590309
	speed: 0.2323s/iter; left time: 7926.6053s
	iters: 300, epoch: 8 | loss: 0.4630530
	speed: 0.2166s/iter; left time: 7368.1680s
Epoch: 8 cost time: 84.45096969604492
Epoch: 8, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.884 Vali Acc: 0.668 Test Loss: 0.884 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2533765
	speed: 0.7156s/iter; left time: 24221.8109s
	iters: 200, epoch: 9 | loss: 0.1786668
	speed: 0.2343s/iter; left time: 7908.2172s
	iters: 300, epoch: 9 | loss: 0.2404782
	speed: 0.2350s/iter; left time: 7908.8112s
Epoch: 9 cost time: 87.89909291267395
Epoch: 9, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.915 Vali Acc: 0.666 Test Loss: 0.915 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1605363
	speed: 0.7282s/iter; left time: 24378.4924s
	iters: 200, epoch: 10 | loss: 0.2390000
	speed: 0.2441s/iter; left time: 8148.7425s
	iters: 300, epoch: 10 | loss: 0.1698571
	speed: 0.2327s/iter; left time: 7745.2732s
Epoch: 10 cost time: 88.48186779022217
Epoch: 10, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.007 Vali Acc: 0.643 Test Loss: 1.007 Test Acc: 0.643
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1583621
	speed: 0.7081s/iter; left time: 23445.4546s
	iters: 200, epoch: 11 | loss: 0.2699063
	speed: 0.2275s/iter; left time: 7511.2256s
	iters: 300, epoch: 11 | loss: 0.1796310
	speed: 0.2268s/iter; left time: 7465.5224s
Epoch: 11 cost time: 86.61664915084839
Epoch: 11, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.132 Vali Acc: 0.665 Test Loss: 1.132 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1571824
	speed: 0.7201s/iter; left time: 23576.9258s
	iters: 200, epoch: 12 | loss: 0.0408190
	speed: 0.2212s/iter; left time: 7221.9465s
	iters: 300, epoch: 12 | loss: 0.3279213
	speed: 0.2405s/iter; left time: 7826.9161s
Epoch: 12 cost time: 85.29474711418152
Epoch: 12, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.135 Vali Acc: 0.660 Test Loss: 1.135 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0408444
	speed: 0.7053s/iter; left time: 22831.4088s
	iters: 200, epoch: 13 | loss: 0.1685368
	speed: 0.2522s/iter; left time: 8138.8693s
	iters: 300, epoch: 13 | loss: 0.1583074
	speed: 0.2333s/iter; left time: 7507.3516s
Epoch: 13 cost time: 89.38230586051941
Epoch: 13, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.240 Vali Acc: 0.665 Test Loss: 1.240 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2463250
	speed: 0.7173s/iter; left time: 22958.0347s
	iters: 200, epoch: 14 | loss: 0.0852395
	speed: 0.2350s/iter; left time: 7498.6030s
	iters: 300, epoch: 14 | loss: 0.1716584
	speed: 0.2250s/iter; left time: 7155.5720s
Epoch: 14 cost time: 85.518718957901
Epoch: 14, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.298 Vali Acc: 0.659 Test Loss: 1.298 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1035280
	speed: 0.7281s/iter; left time: 23034.9305s
	iters: 200, epoch: 15 | loss: 0.0356133
	speed: 0.2145s/iter; left time: 6764.5320s
	iters: 300, epoch: 15 | loss: 0.2870140
	speed: 0.2141s/iter; left time: 6729.7349s
Epoch: 15 cost time: 82.91876339912415
Epoch: 15, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.411 Vali Acc: 0.660 Test Loss: 1.411 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0620948
	speed: 0.6857s/iter; left time: 21440.5980s
	iters: 200, epoch: 16 | loss: 0.1857292
	speed: 0.2257s/iter; left time: 7033.6460s
	iters: 300, epoch: 16 | loss: 0.1477080
	speed: 0.2303s/iter; left time: 7153.6539s
Epoch: 16 cost time: 83.85172271728516
Epoch: 16, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.408 Vali Acc: 0.674 Test Loss: 1.408 Test Acc: 0.674
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6796254256526674
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7152537
	speed: 0.2311s/iter; left time: 8506.4586s
	iters: 200, epoch: 1 | loss: 0.7855307
	speed: 0.2200s/iter; left time: 8073.6217s
	iters: 300, epoch: 1 | loss: 0.5328302
	speed: 0.2274s/iter; left time: 8324.7025s
Epoch: 1 cost time: 83.25284123420715
Epoch: 1, Steps: 369 | Train Loss: 0.689 Vali Loss: 0.709 Vali Acc: 0.604 Test Loss: 0.709 Test Acc: 0.604
Validation loss decreased (inf --> -0.604420).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7639616
	speed: 0.7334s/iter; left time: 26719.7531s
	iters: 200, epoch: 2 | loss: 0.4181489
	speed: 0.2165s/iter; left time: 7866.2654s
	iters: 300, epoch: 2 | loss: 1.0290524
	speed: 0.2220s/iter; left time: 8042.3549s
Epoch: 2 cost time: 84.11641526222229
Epoch: 2, Steps: 369 | Train Loss: 0.562 Vali Loss: 0.690 Vali Acc: 0.657 Test Loss: 0.690 Test Acc: 0.657
Validation loss decreased (-0.604420 --> -0.657201).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3438082
	speed: 0.7361s/iter; left time: 26545.6175s
	iters: 200, epoch: 3 | loss: 0.4135762
	speed: 0.2356s/iter; left time: 8473.7894s
	iters: 300, epoch: 3 | loss: 0.4429028
	speed: 0.2288s/iter; left time: 8205.8746s
Epoch: 3 cost time: 88.07034349441528
Epoch: 3, Steps: 369 | Train Loss: 0.487 Vali Loss: 0.689 Vali Acc: 0.662 Test Loss: 0.689 Test Acc: 0.662
Validation loss decreased (-0.657201 --> -0.662025).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5664092
	speed: 0.7210s/iter; left time: 25736.9987s
	iters: 200, epoch: 4 | loss: 0.3463048
	speed: 0.2169s/iter; left time: 7719.8536s
	iters: 300, epoch: 4 | loss: 0.6248904
	speed: 0.2227s/iter; left time: 7902.7933s
Epoch: 4 cost time: 84.43378806114197
Epoch: 4, Steps: 369 | Train Loss: 0.449 Vali Loss: 0.743 Vali Acc: 0.661 Test Loss: 0.743 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2890842
	speed: 0.7327s/iter; left time: 25884.0636s
	iters: 200, epoch: 5 | loss: 0.5707784
	speed: 0.2488s/iter; left time: 8762.2426s
	iters: 300, epoch: 5 | loss: 0.2285873
	speed: 0.2417s/iter; left time: 8488.8176s
Epoch: 5 cost time: 91.53629493713379
Epoch: 5, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.756 Vali Acc: 0.677 Test Loss: 0.756 Test Acc: 0.677
Validation loss decreased (-0.662025 --> -0.676780).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1036036
	speed: 0.7532s/iter; left time: 26330.0106s
	iters: 200, epoch: 6 | loss: 0.3593531
	speed: 0.2587s/iter; left time: 9015.5581s
	iters: 300, epoch: 6 | loss: 0.2560446
	speed: 0.2498s/iter; left time: 8683.3622s
Epoch: 6 cost time: 90.96376037597656
Epoch: 6, Steps: 369 | Train Loss: 0.375 Vali Loss: 0.804 Vali Acc: 0.668 Test Loss: 0.804 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2316732
	speed: 0.7089s/iter; left time: 24519.9431s
	iters: 200, epoch: 7 | loss: 0.3651538
	speed: 0.2608s/iter; left time: 8993.0327s
	iters: 300, epoch: 7 | loss: 0.5125020
	speed: 0.2433s/iter; left time: 8366.7589s
Epoch: 7 cost time: 89.68212842941284
Epoch: 7, Steps: 369 | Train Loss: 0.351 Vali Loss: 0.786 Vali Acc: 0.662 Test Loss: 0.786 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4417744
	speed: 0.7307s/iter; left time: 25004.6629s
	iters: 200, epoch: 8 | loss: 0.2386241
	speed: 0.2394s/iter; left time: 8166.5598s
	iters: 300, epoch: 8 | loss: 0.4348548
	speed: 0.2236s/iter; left time: 7607.7488s
Epoch: 8 cost time: 88.51085901260376
Epoch: 8, Steps: 369 | Train Loss: 0.315 Vali Loss: 0.876 Vali Acc: 0.672 Test Loss: 0.876 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.2717710
	speed: 0.7091s/iter; left time: 24001.0886s
	iters: 200, epoch: 9 | loss: 0.0692239
	speed: 0.2243s/iter; left time: 7570.8126s
	iters: 300, epoch: 9 | loss: 0.2476394
	speed: 0.2222s/iter; left time: 7477.0492s
Epoch: 9 cost time: 84.116952419281
Epoch: 9, Steps: 369 | Train Loss: 0.278 Vali Loss: 0.956 Vali Acc: 0.668 Test Loss: 0.956 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1823334
	speed: 0.6787s/iter; left time: 22721.7226s
	iters: 200, epoch: 10 | loss: 0.2778388
	speed: 0.2295s/iter; left time: 7662.3022s
	iters: 300, epoch: 10 | loss: 0.1535857
	speed: 0.2247s/iter; left time: 7479.4264s
Epoch: 10 cost time: 83.7067563533783
Epoch: 10, Steps: 369 | Train Loss: 0.250 Vali Loss: 0.989 Vali Acc: 0.653 Test Loss: 0.989 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2367887
	speed: 0.6777s/iter; left time: 22440.4121s
	iters: 200, epoch: 11 | loss: 0.2283052
	speed: 0.2315s/iter; left time: 7642.9982s
	iters: 300, epoch: 11 | loss: 0.3620974
	speed: 0.2202s/iter; left time: 7246.8369s
Epoch: 11 cost time: 82.2043251991272
Epoch: 11, Steps: 369 | Train Loss: 0.227 Vali Loss: 1.104 Vali Acc: 0.665 Test Loss: 1.104 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1016098
	speed: 0.7015s/iter; left time: 22969.9610s
	iters: 200, epoch: 12 | loss: 0.0842181
	speed: 0.2283s/iter; left time: 7451.4912s
	iters: 300, epoch: 12 | loss: 0.1085384
	speed: 0.2294s/iter; left time: 7465.0272s
Epoch: 12 cost time: 85.07315707206726
Epoch: 12, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.123 Vali Acc: 0.673 Test Loss: 1.123 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0962077
	speed: 0.7001s/iter; left time: 22665.5099s
	iters: 200, epoch: 13 | loss: 0.0699665
	speed: 0.2272s/iter; left time: 7332.6894s
	iters: 300, epoch: 13 | loss: 0.1171624
	speed: 0.2268s/iter; left time: 7295.6936s
Epoch: 13 cost time: 83.99460816383362
Epoch: 13, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.291 Vali Acc: 0.654 Test Loss: 1.291 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.3282215
	speed: 0.6940s/iter; left time: 22211.6100s
	iters: 200, epoch: 14 | loss: 0.4735067
	speed: 0.2169s/iter; left time: 6918.7514s
	iters: 300, epoch: 14 | loss: 0.1070306
	speed: 0.2115s/iter; left time: 6726.0435s
Epoch: 14 cost time: 81.44705390930176
Epoch: 14, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.299 Vali Acc: 0.665 Test Loss: 1.299 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1911406
	speed: 0.6864s/iter; left time: 21712.8087s
	iters: 200, epoch: 15 | loss: 0.0090028
	speed: 0.2331s/iter; left time: 7349.2361s
	iters: 300, epoch: 15 | loss: 0.0429957
	speed: 0.2403s/iter; left time: 7552.6794s
Epoch: 15 cost time: 87.94530415534973
Epoch: 15, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.306 Vali Acc: 0.660 Test Loss: 1.306 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6767877412031782
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8327773
	speed: 0.2507s/iter; left time: 9224.4625s
	iters: 200, epoch: 1 | loss: 0.7644756
	speed: 0.2336s/iter; left time: 8572.6370s
	iters: 300, epoch: 1 | loss: 0.5181292
	speed: 0.2425s/iter; left time: 8874.8058s
Epoch: 1 cost time: 89.60261464118958
Epoch: 1, Steps: 369 | Train Loss: 0.701 Vali Loss: 0.712 Vali Acc: 0.577 Test Loss: 0.712 Test Acc: 0.577
Validation loss decreased (inf --> -0.576610).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5782986
	speed: 0.7051s/iter; left time: 25688.5736s
	iters: 200, epoch: 2 | loss: 0.4371892
	speed: 0.2365s/iter; left time: 8591.7366s
	iters: 300, epoch: 2 | loss: 1.0120317
	speed: 0.2284s/iter; left time: 8275.6039s
Epoch: 2 cost time: 85.48485279083252
Epoch: 2, Steps: 369 | Train Loss: 0.581 Vali Loss: 0.692 Vali Acc: 0.661 Test Loss: 0.692 Test Acc: 0.661
Validation loss decreased (-0.576610 --> -0.661174).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2746964
	speed: 0.7135s/iter; left time: 25729.5486s
	iters: 200, epoch: 3 | loss: 0.6361480
	speed: 0.2464s/iter; left time: 8861.7582s
	iters: 300, epoch: 3 | loss: 0.3534783
	speed: 0.2359s/iter; left time: 8458.7485s
Epoch: 3 cost time: 89.35050845146179
Epoch: 3, Steps: 369 | Train Loss: 0.517 Vali Loss: 0.688 Vali Acc: 0.661 Test Loss: 0.688 Test Acc: 0.661
Validation loss decreased (-0.661174 --> -0.661174).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5292236
	speed: 0.7198s/iter; left time: 25692.9492s
	iters: 200, epoch: 4 | loss: 0.4004465
	speed: 0.2393s/iter; left time: 8517.6713s
	iters: 300, epoch: 4 | loss: 0.6081511
	speed: 0.2392s/iter; left time: 8488.9383s
Epoch: 4 cost time: 88.41147446632385
Epoch: 4, Steps: 369 | Train Loss: 0.464 Vali Loss: 0.739 Vali Acc: 0.658 Test Loss: 0.739 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3945733
	speed: 0.6913s/iter; left time: 24421.8887s
	iters: 200, epoch: 5 | loss: 0.5726999
	speed: 0.2215s/iter; left time: 7803.9683s
	iters: 300, epoch: 5 | loss: 0.3665558
	speed: 0.2236s/iter; left time: 7853.2371s
Epoch: 5 cost time: 81.77965426445007
Epoch: 5, Steps: 369 | Train Loss: 0.436 Vali Loss: 0.751 Vali Acc: 0.671 Test Loss: 0.751 Test Acc: 0.671
Validation loss decreased (-0.661174 --> -0.670537).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2252318
	speed: 0.6693s/iter; left time: 23395.9570s
	iters: 200, epoch: 6 | loss: 0.4083699
	speed: 0.2291s/iter; left time: 7985.7232s
	iters: 300, epoch: 6 | loss: 0.2429760
	speed: 0.2286s/iter; left time: 7946.3018s
Epoch: 6 cost time: 84.4433205127716
Epoch: 6, Steps: 369 | Train Loss: 0.388 Vali Loss: 0.886 Vali Acc: 0.668 Test Loss: 0.886 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2176668
	speed: 0.6791s/iter; left time: 23488.7645s
	iters: 200, epoch: 7 | loss: 0.2189053
	speed: 0.2225s/iter; left time: 7674.6871s
	iters: 300, epoch: 7 | loss: 0.4461084
	speed: 0.2091s/iter; left time: 7189.6978s
Epoch: 7 cost time: 81.91272401809692
Epoch: 7, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.810 Vali Acc: 0.665 Test Loss: 0.810 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3062680
	speed: 0.6839s/iter; left time: 23402.4930s
	iters: 200, epoch: 8 | loss: 0.3422799
	speed: 0.2159s/iter; left time: 7365.8895s
	iters: 300, epoch: 8 | loss: 0.4620619
	speed: 0.2044s/iter; left time: 6953.5992s
Epoch: 8 cost time: 80.60161781311035
Epoch: 8, Steps: 369 | Train Loss: 0.322 Vali Loss: 0.872 Vali Acc: 0.672 Test Loss: 0.872 Test Acc: 0.672
Validation loss decreased (-0.670537 --> -0.672239).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1953037
	speed: 0.6746s/iter; left time: 22834.7667s
	iters: 200, epoch: 9 | loss: 0.1157697
	speed: 0.2209s/iter; left time: 7456.6899s
	iters: 300, epoch: 9 | loss: 0.2580985
	speed: 0.2204s/iter; left time: 7415.4214s
Epoch: 9 cost time: 81.90963077545166
Epoch: 9, Steps: 369 | Train Loss: 0.288 Vali Loss: 0.930 Vali Acc: 0.670 Test Loss: 0.930 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1404543
	speed: 0.6634s/iter; left time: 22211.8312s
	iters: 200, epoch: 10 | loss: 0.4654789
	speed: 0.2225s/iter; left time: 7428.1043s
	iters: 300, epoch: 10 | loss: 0.2925404
	speed: 0.2254s/iter; left time: 7500.6065s
Epoch: 10 cost time: 82.65387535095215
Epoch: 10, Steps: 369 | Train Loss: 0.259 Vali Loss: 1.040 Vali Acc: 0.650 Test Loss: 1.040 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1126497
	speed: 0.6844s/iter; left time: 22660.1308s
	iters: 200, epoch: 11 | loss: 0.2262184
	speed: 0.2287s/iter; left time: 7550.6783s
	iters: 300, epoch: 11 | loss: 0.2522061
	speed: 0.2254s/iter; left time: 7416.6791s
Epoch: 11 cost time: 83.17017912864685
Epoch: 11, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.113 Vali Acc: 0.651 Test Loss: 1.113 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0622757
	speed: 0.6723s/iter; left time: 22012.5880s
	iters: 200, epoch: 12 | loss: 0.3133428
	speed: 0.2229s/iter; left time: 7276.5148s
	iters: 300, epoch: 12 | loss: 0.1433543
	speed: 0.2189s/iter; left time: 7121.9879s
Epoch: 12 cost time: 82.2834484577179
Epoch: 12, Steps: 369 | Train Loss: 0.206 Vali Loss: 1.160 Vali Acc: 0.662 Test Loss: 1.160 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0541482
	speed: 0.7086s/iter; left time: 22938.2938s
	iters: 200, epoch: 13 | loss: 0.1093307
	speed: 0.2229s/iter; left time: 7194.9762s
	iters: 300, epoch: 13 | loss: 0.0759183
	speed: 0.2234s/iter; left time: 7188.3973s
Epoch: 13 cost time: 84.15632605552673
Epoch: 13, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.244 Vali Acc: 0.661 Test Loss: 1.244 Test Acc: 0.661
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0710765
	speed: 0.7087s/iter; left time: 22681.6876s
	iters: 200, epoch: 14 | loss: 0.2102752
	speed: 0.2250s/iter; left time: 7178.9846s
	iters: 300, epoch: 14 | loss: 0.3756073
	speed: 0.2308s/iter; left time: 7339.0371s
Epoch: 14 cost time: 85.35661578178406
Epoch: 14, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.336 Vali Acc: 0.659 Test Loss: 1.336 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.5115017
	speed: 0.6893s/iter; left time: 21806.2783s
	iters: 200, epoch: 15 | loss: 0.0138751
	speed: 0.2213s/iter; left time: 6978.7445s
	iters: 300, epoch: 15 | loss: 0.0180384
	speed: 0.2271s/iter; left time: 7137.9625s
Epoch: 15 cost time: 82.60277104377747
Epoch: 15, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.340 Vali Acc: 0.648 Test Loss: 1.340 Test Acc: 0.648
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0900718
	speed: 0.6946s/iter; left time: 21716.4427s
	iters: 200, epoch: 16 | loss: 0.2950612
	speed: 0.2239s/iter; left time: 6978.2308s
	iters: 300, epoch: 16 | loss: 0.2095911
	speed: 0.2224s/iter; left time: 6909.6755s
Epoch: 16 cost time: 83.4689428806305
Epoch: 16, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.561 Vali Acc: 0.642 Test Loss: 1.561 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0895836
	speed: 0.6706s/iter; left time: 20720.8634s
	iters: 200, epoch: 17 | loss: 0.0409677
	speed: 0.2066s/iter; left time: 6361.9195s
	iters: 300, epoch: 17 | loss: 0.0896686
	speed: 0.2174s/iter; left time: 6673.1690s
Epoch: 17 cost time: 79.45157408714294
Epoch: 17, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.555 Vali Acc: 0.644 Test Loss: 1.555 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0843121
	speed: 0.6723s/iter; left time: 20524.9076s
	iters: 200, epoch: 18 | loss: 0.0115633
	speed: 0.2222s/iter; left time: 6760.7748s
	iters: 300, epoch: 18 | loss: 0.1255095
	speed: 0.2197s/iter; left time: 6662.9822s
Epoch: 18 cost time: 82.53253674507141
Epoch: 18, Steps: 369 | Train Loss: 0.123 Vali Loss: 1.672 Vali Acc: 0.658 Test Loss: 1.672 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6722474460839954
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7862670
	speed: 0.2457s/iter; left time: 9040.7686s
	iters: 200, epoch: 1 | loss: 0.7324517
	speed: 0.2245s/iter; left time: 8240.6290s
	iters: 300, epoch: 1 | loss: 0.6856737
	speed: 0.2242s/iter; left time: 8205.6193s
Epoch: 1 cost time: 85.07304167747498
Epoch: 1, Steps: 369 | Train Loss: 0.711 Vali Loss: 0.691 Vali Acc: 0.566 Test Loss: 0.691 Test Acc: 0.566
Validation loss decreased (inf --> -0.565544).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6896536
	speed: 0.6759s/iter; left time: 24623.0398s
	iters: 200, epoch: 2 | loss: 0.5231006
	speed: 0.2198s/iter; left time: 7986.4604s
	iters: 300, epoch: 2 | loss: 0.6959897
	speed: 0.2208s/iter; left time: 8000.1257s
Epoch: 2 cost time: 81.33462691307068
Epoch: 2, Steps: 369 | Train Loss: 0.600 Vali Loss: 0.686 Vali Acc: 0.654 Test Loss: 0.686 Test Acc: 0.654
Validation loss decreased (-0.565544 --> -0.654363).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2831762
	speed: 0.6557s/iter; left time: 23647.7793s
	iters: 200, epoch: 3 | loss: 0.6650615
	speed: 0.2149s/iter; left time: 7729.5829s
	iters: 300, epoch: 3 | loss: 0.6284519
	speed: 0.2239s/iter; left time: 8030.4123s
Epoch: 3 cost time: 81.53165984153748
Epoch: 3, Steps: 369 | Train Loss: 0.522 Vali Loss: 0.710 Vali Acc: 0.668 Test Loss: 0.710 Test Acc: 0.668
Validation loss decreased (-0.654363 --> -0.668268).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4704266
	speed: 0.6840s/iter; left time: 24414.3063s
	iters: 200, epoch: 4 | loss: 0.4371403
	speed: 0.2405s/iter; left time: 8561.4203s
	iters: 300, epoch: 4 | loss: 0.7234532
	speed: 0.2177s/iter; left time: 7726.5248s
Epoch: 4 cost time: 84.71836709976196
Epoch: 4, Steps: 369 | Train Loss: 0.472 Vali Loss: 0.739 Vali Acc: 0.663 Test Loss: 0.739 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2536112
	speed: 0.6777s/iter; left time: 23938.7258s
	iters: 200, epoch: 5 | loss: 0.4382338
	speed: 0.2169s/iter; left time: 7639.3171s
	iters: 300, epoch: 5 | loss: 0.2709828
	speed: 0.2200s/iter; left time: 7728.8300s
Epoch: 5 cost time: 82.2648913860321
Epoch: 5, Steps: 369 | Train Loss: 0.430 Vali Loss: 0.759 Vali Acc: 0.671 Test Loss: 0.759 Test Acc: 0.671
Validation loss decreased (-0.668268 --> -0.670821).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1796835
	speed: 0.6816s/iter; left time: 23826.4037s
	iters: 200, epoch: 6 | loss: 0.3166488
	speed: 0.2263s/iter; left time: 7886.2615s
	iters: 300, epoch: 6 | loss: 0.2977513
	speed: 0.2249s/iter; left time: 7817.8225s
Epoch: 6 cost time: 83.54408717155457
Epoch: 6, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.885 Vali Acc: 0.665 Test Loss: 0.885 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3843122
	speed: 0.6834s/iter; left time: 23635.3446s
	iters: 200, epoch: 7 | loss: 0.3668774
	speed: 0.2210s/iter; left time: 7621.9379s
	iters: 300, epoch: 7 | loss: 0.3096431
	speed: 0.2294s/iter; left time: 7889.2478s
Epoch: 7 cost time: 83.3265929222107
Epoch: 7, Steps: 369 | Train Loss: 0.361 Vali Loss: 0.807 Vali Acc: 0.672 Test Loss: 0.807 Test Acc: 0.672
Validation loss decreased (-0.670821 --> -0.671956).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3733488
	speed: 0.7022s/iter; left time: 24026.6078s
	iters: 200, epoch: 8 | loss: 0.2173642
	speed: 0.2224s/iter; left time: 7587.6159s
	iters: 300, epoch: 8 | loss: 0.3373982
	speed: 0.2276s/iter; left time: 7741.8089s
Epoch: 8 cost time: 82.58014869689941
Epoch: 8, Steps: 369 | Train Loss: 0.327 Vali Loss: 0.876 Vali Acc: 0.663 Test Loss: 0.876 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3430840
	speed: 0.6790s/iter; left time: 22982.8111s
	iters: 200, epoch: 9 | loss: 0.2733326
	speed: 0.2200s/iter; left time: 7425.4127s
	iters: 300, epoch: 9 | loss: 0.2331772
	speed: 0.2089s/iter; left time: 7028.2290s
Epoch: 9 cost time: 80.5328643321991
Epoch: 9, Steps: 369 | Train Loss: 0.302 Vali Loss: 0.972 Vali Acc: 0.659 Test Loss: 0.972 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1606470
	speed: 0.6509s/iter; left time: 21791.0667s
	iters: 200, epoch: 10 | loss: 0.4544471
	speed: 0.2177s/iter; left time: 7265.6216s
	iters: 300, epoch: 10 | loss: 0.1873283
	speed: 0.2160s/iter; left time: 7186.8618s
Epoch: 10 cost time: 79.75098276138306
Epoch: 10, Steps: 369 | Train Loss: 0.260 Vali Loss: 1.040 Vali Acc: 0.656 Test Loss: 1.040 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3009259
	speed: 0.6646s/iter; left time: 22004.4834s
	iters: 200, epoch: 11 | loss: 0.5574149
	speed: 0.2200s/iter; left time: 7261.3509s
	iters: 300, epoch: 11 | loss: 0.2066563
	speed: 0.2202s/iter; left time: 7247.4596s
Epoch: 11 cost time: 80.91334581375122
Epoch: 11, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.103 Vali Acc: 0.654 Test Loss: 1.103 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.2739564
	speed: 0.7003s/iter; left time: 22927.7206s
	iters: 200, epoch: 12 | loss: 0.0655700
	speed: 0.2545s/iter; left time: 8307.7995s
	iters: 300, epoch: 12 | loss: 0.2574218
	speed: 0.2659s/iter; left time: 8654.2980s
Epoch: 12 cost time: 94.6235842704773
Epoch: 12, Steps: 369 | Train Loss: 0.217 Vali Loss: 1.210 Vali Acc: 0.657 Test Loss: 1.210 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0428165
	speed: 0.7326s/iter; left time: 23715.9639s
	iters: 200, epoch: 13 | loss: 0.0809230
	speed: 0.2318s/iter; left time: 7481.4389s
	iters: 300, epoch: 13 | loss: 0.2681378
	speed: 0.2349s/iter; left time: 7557.9121s
Epoch: 13 cost time: 87.70474219322205
Epoch: 13, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.254 Vali Acc: 0.658 Test Loss: 1.254 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0465760
	speed: 0.7042s/iter; left time: 22538.3504s
	iters: 200, epoch: 14 | loss: 0.1298009
	speed: 0.2289s/iter; left time: 7301.6694s
	iters: 300, epoch: 14 | loss: 0.1955777
	speed: 0.2454s/iter; left time: 7805.9326s
Epoch: 14 cost time: 89.79975056648254
Epoch: 14, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.315 Vali Acc: 0.653 Test Loss: 1.315 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0564099
	speed: 0.7589s/iter; left time: 24006.4303s
	iters: 200, epoch: 15 | loss: 0.0671943
	speed: 0.2442s/iter; left time: 7699.4979s
	iters: 300, epoch: 15 | loss: 0.0598997
	speed: 0.2447s/iter; left time: 7692.3131s
Epoch: 15 cost time: 90.07634949684143
Epoch: 15, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.353 Vali Acc: 0.653 Test Loss: 1.353 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2043136
	speed: 0.7160s/iter; left time: 22387.1376s
	iters: 200, epoch: 16 | loss: 0.0196624
	speed: 0.2504s/iter; left time: 7802.7327s
	iters: 300, epoch: 16 | loss: 0.0102938
	speed: 0.2362s/iter; left time: 7338.2432s
Epoch: 16 cost time: 88.82758355140686
Epoch: 16, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.506 Vali Acc: 0.657 Test Loss: 1.506 Test Acc: 0.657
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.2291951
	speed: 0.7139s/iter; left time: 22058.5931s
	iters: 200, epoch: 17 | loss: 0.2693231
	speed: 0.2313s/iter; left time: 7122.0711s
	iters: 300, epoch: 17 | loss: 0.1156981
	speed: 0.2353s/iter; left time: 7223.2171s
Epoch: 17 cost time: 84.912522315979
Epoch: 17, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.570 Vali Acc: 0.647 Test Loss: 1.570 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6719636776390465
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7275824
	speed: 0.2526s/iter; left time: 9295.8418s
	iters: 200, epoch: 1 | loss: 0.7857803
	speed: 0.2402s/iter; left time: 8816.8156s
	iters: 300, epoch: 1 | loss: 0.7000590
	speed: 0.2253s/iter; left time: 8245.9015s
Epoch: 1 cost time: 86.54710006713867
Epoch: 1, Steps: 369 | Train Loss: 0.719 Vali Loss: 0.692 Vali Acc: 0.564 Test Loss: 0.692 Test Acc: 0.564
Validation loss decreased (inf --> -0.564409).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5853918
	speed: 0.7229s/iter; left time: 26336.3035s
	iters: 200, epoch: 2 | loss: 0.5580595
	speed: 0.2202s/iter; left time: 8000.2019s
	iters: 300, epoch: 2 | loss: 0.6133068
	speed: 0.2355s/iter; left time: 8530.9632s
Epoch: 2 cost time: 86.30525994300842
Epoch: 2, Steps: 369 | Train Loss: 0.619 Vali Loss: 0.673 Vali Acc: 0.650 Test Loss: 0.673 Test Acc: 0.650
Validation loss decreased (-0.564409 --> -0.650391).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3429223
	speed: 0.7071s/iter; left time: 25498.9657s
	iters: 200, epoch: 3 | loss: 0.7526461
	speed: 0.2146s/iter; left time: 7716.9103s
	iters: 300, epoch: 3 | loss: 0.3626425
	speed: 0.2378s/iter; left time: 8526.7110s
Epoch: 3 cost time: 83.98528385162354
Epoch: 3, Steps: 369 | Train Loss: 0.536 Vali Loss: 0.672 Vali Acc: 0.673 Test Loss: 0.672 Test Acc: 0.673
Validation loss decreased (-0.650391 --> -0.672808).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6283147
	speed: 0.6913s/iter; left time: 24673.7170s
	iters: 200, epoch: 4 | loss: 0.5410485
	speed: 0.2119s/iter; left time: 7543.3719s
	iters: 300, epoch: 4 | loss: 0.6436090
	speed: 0.2264s/iter; left time: 8037.0144s
Epoch: 4 cost time: 82.12840342521667
Epoch: 4, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.714 Vali Acc: 0.670 Test Loss: 0.714 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2803829
	speed: 0.6837s/iter; left time: 24151.3744s
	iters: 200, epoch: 5 | loss: 0.3974575
	speed: 0.2256s/iter; left time: 7946.2626s
	iters: 300, epoch: 5 | loss: 0.2723869
	speed: 0.2183s/iter; left time: 7669.1942s
Epoch: 5 cost time: 81.92261695861816
Epoch: 5, Steps: 369 | Train Loss: 0.439 Vali Loss: 0.742 Vali Acc: 0.685 Test Loss: 0.742 Test Acc: 0.685
Validation loss decreased (-0.672808 --> -0.685293).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3064659
	speed: 0.7039s/iter; left time: 24604.9460s
	iters: 200, epoch: 6 | loss: 0.3030109
	speed: 0.2277s/iter; left time: 7935.5863s
	iters: 300, epoch: 6 | loss: 0.2222655
	speed: 0.2262s/iter; left time: 7861.6746s
Epoch: 6 cost time: 85.73852252960205
Epoch: 6, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.787 Vali Acc: 0.669 Test Loss: 0.787 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3439878
	speed: 0.6581s/iter; left time: 22760.7847s
	iters: 200, epoch: 7 | loss: 0.2258076
	speed: 0.2093s/iter; left time: 7219.0252s
	iters: 300, epoch: 7 | loss: 0.3930805
	speed: 0.2149s/iter; left time: 7390.1406s
Epoch: 7 cost time: 78.69169664382935
Epoch: 7, Steps: 369 | Train Loss: 0.367 Vali Loss: 0.820 Vali Acc: 0.683 Test Loss: 0.820 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5928095
	speed: 0.6433s/iter; left time: 22012.2843s
	iters: 200, epoch: 8 | loss: 0.1079756
	speed: 0.2102s/iter; left time: 7172.3228s
	iters: 300, epoch: 8 | loss: 0.3103652
	speed: 0.2060s/iter; left time: 7007.0614s
Epoch: 8 cost time: 77.86531257629395
Epoch: 8, Steps: 369 | Train Loss: 0.324 Vali Loss: 0.894 Vali Acc: 0.677 Test Loss: 0.894 Test Acc: 0.677
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1737287
	speed: 0.6629s/iter; left time: 22437.5088s
	iters: 200, epoch: 9 | loss: 0.3408903
	speed: 0.2280s/iter; left time: 7693.5461s
	iters: 300, epoch: 9 | loss: 0.1098190
	speed: 0.2170s/iter; left time: 7303.4181s
Epoch: 9 cost time: 81.78339791297913
Epoch: 9, Steps: 369 | Train Loss: 0.301 Vali Loss: 0.874 Vali Acc: 0.673 Test Loss: 0.874 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1451145
	speed: 0.6730s/iter; left time: 22531.5409s
	iters: 200, epoch: 10 | loss: 0.6336662
	speed: 0.2136s/iter; left time: 7129.7877s
	iters: 300, epoch: 10 | loss: 0.2002404
	speed: 0.2350s/iter; left time: 7820.1500s
Epoch: 10 cost time: 81.29937529563904
Epoch: 10, Steps: 369 | Train Loss: 0.280 Vali Loss: 1.024 Vali Acc: 0.666 Test Loss: 1.024 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2385610
	speed: 0.6625s/iter; left time: 21936.0602s
	iters: 200, epoch: 11 | loss: 0.1682147
	speed: 0.2244s/iter; left time: 7406.1386s
	iters: 300, epoch: 11 | loss: 0.1557350
	speed: 0.2266s/iter; left time: 7458.8936s
Epoch: 11 cost time: 83.44381046295166
Epoch: 11, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.085 Vali Acc: 0.660 Test Loss: 1.085 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3667349
	speed: 0.6672s/iter; left time: 21844.8221s
	iters: 200, epoch: 12 | loss: 0.2809760
	speed: 0.2241s/iter; left time: 7314.9858s
	iters: 300, epoch: 12 | loss: 0.4714452
	speed: 0.2101s/iter; left time: 6836.6396s
Epoch: 12 cost time: 79.95358347892761
Epoch: 12, Steps: 369 | Train Loss: 0.215 Vali Loss: 1.102 Vali Acc: 0.671 Test Loss: 1.102 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0694616
	speed: 0.6759s/iter; left time: 21881.5531s
	iters: 200, epoch: 13 | loss: 0.0307802
	speed: 0.2213s/iter; left time: 7140.6355s
	iters: 300, epoch: 13 | loss: 0.0328995
	speed: 0.2253s/iter; left time: 7249.9056s
Epoch: 13 cost time: 83.00369501113892
Epoch: 13, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.202 Vali Acc: 0.664 Test Loss: 1.202 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2499399
	speed: 0.6600s/iter; left time: 21121.5213s
	iters: 200, epoch: 14 | loss: 0.3102821
	speed: 0.2316s/iter; left time: 7388.9076s
	iters: 300, epoch: 14 | loss: 0.0549837
	speed: 0.2298s/iter; left time: 7307.6758s
Epoch: 14 cost time: 82.16906642913818
Epoch: 14, Steps: 369 | Train Loss: 0.179 Vali Loss: 1.345 Vali Acc: 0.656 Test Loss: 1.345 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0637890
	speed: 0.6531s/iter; left time: 20660.1375s
	iters: 200, epoch: 15 | loss: 0.0950086
	speed: 0.2198s/iter; left time: 6930.7438s
	iters: 300, epoch: 15 | loss: 0.0119073
	speed: 0.2124s/iter; left time: 6675.9640s
Epoch: 15 cost time: 80.57327008247375
Epoch: 15, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.336 Vali Acc: 0.650 Test Loss: 1.336 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6853007945516458
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6873344
	speed: 0.2225s/iter; left time: 8188.7171s
	iters: 200, epoch: 1 | loss: 0.7683029
	speed: 0.2283s/iter; left time: 8377.2226s
	iters: 300, epoch: 1 | loss: 0.7764692
	speed: 0.2308s/iter; left time: 8448.9382s
Epoch: 1 cost time: 84.17038369178772
Epoch: 1, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (inf --> -0.570084).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6711941
	speed: 0.6973s/iter; left time: 25405.8386s
	iters: 200, epoch: 2 | loss: 0.4229141
	speed: 0.2374s/iter; left time: 8623.8923s
	iters: 300, epoch: 2 | loss: 0.9076271
	speed: 0.2325s/iter; left time: 8423.2878s
Epoch: 2 cost time: 86.96648716926575
Epoch: 2, Steps: 369 | Train Loss: 0.626 Vali Loss: 0.664 Vali Acc: 0.661 Test Loss: 0.664 Test Acc: 0.661
Validation loss decreased (-0.570084 --> -0.660606).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4919842
	speed: 0.6922s/iter; left time: 24961.7610s
	iters: 200, epoch: 3 | loss: 0.7446677
	speed: 0.2183s/iter; left time: 7850.9503s
	iters: 300, epoch: 3 | loss: 0.5684158
	speed: 0.2342s/iter; left time: 8399.2485s
Epoch: 3 cost time: 84.01163864135742
Epoch: 3, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.673 Vali Acc: 0.676 Test Loss: 0.673 Test Acc: 0.676
Validation loss decreased (-0.660606 --> -0.675646).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7385014
	speed: 0.6802s/iter; left time: 24279.4575s
	iters: 200, epoch: 4 | loss: 0.5315776
	speed: 0.2292s/iter; left time: 8157.8322s
	iters: 300, epoch: 4 | loss: 0.6372753
	speed: 0.2353s/iter; left time: 8351.4258s
Epoch: 4 cost time: 84.84468483924866
Epoch: 4, Steps: 369 | Train Loss: 0.496 Vali Loss: 0.724 Vali Acc: 0.656 Test Loss: 0.724 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4153903
	speed: 0.7120s/iter; left time: 25152.4788s
	iters: 200, epoch: 5 | loss: 0.5642273
	speed: 0.2420s/iter; left time: 8523.0016s
	iters: 300, epoch: 5 | loss: 0.2257052
	speed: 0.2290s/iter; left time: 8043.6009s
Epoch: 5 cost time: 86.1648907661438
Epoch: 5, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.739 Vali Acc: 0.678 Test Loss: 0.739 Test Acc: 0.678
Validation loss decreased (-0.675646 --> -0.677632).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1762907
	speed: 0.7099s/iter; left time: 24815.3016s
	iters: 200, epoch: 6 | loss: 0.2112677
	speed: 0.2242s/iter; left time: 7813.5411s
	iters: 300, epoch: 6 | loss: 0.2862239
	speed: 0.2295s/iter; left time: 7978.1680s
Epoch: 6 cost time: 85.11779570579529
Epoch: 6, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.779 Vali Acc: 0.680 Test Loss: 0.779 Test Acc: 0.680
Validation loss decreased (-0.677632 --> -0.680469).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2143179
	speed: 0.6850s/iter; left time: 23691.5908s
	iters: 200, epoch: 7 | loss: 0.3047446
	speed: 0.2294s/iter; left time: 7910.6539s
	iters: 300, epoch: 7 | loss: 0.2830343
	speed: 0.2170s/iter; left time: 7463.3127s
Epoch: 7 cost time: 82.87052083015442
Epoch: 7, Steps: 369 | Train Loss: 0.377 Vali Loss: 0.738 Vali Acc: 0.685 Test Loss: 0.738 Test Acc: 0.685
Validation loss decreased (-0.680469 --> -0.685293).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3961481
	speed: 0.6982s/iter; left time: 23891.8899s
	iters: 200, epoch: 8 | loss: 0.2090716
	speed: 0.2281s/iter; left time: 7781.1893s
	iters: 300, epoch: 8 | loss: 0.3494624
	speed: 0.2286s/iter; left time: 7775.7924s
Epoch: 8 cost time: 84.93830060958862
Epoch: 8, Steps: 369 | Train Loss: 0.350 Vali Loss: 0.801 Vali Acc: 0.680 Test Loss: 0.801 Test Acc: 0.680
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3497384
	speed: 0.6901s/iter; left time: 23360.6740s
	iters: 200, epoch: 9 | loss: 0.3044962
	speed: 0.2274s/iter; left time: 7674.8721s
	iters: 300, epoch: 9 | loss: 0.3997885
	speed: 0.2221s/iter; left time: 7472.0146s
Epoch: 9 cost time: 83.60709977149963
Epoch: 9, Steps: 369 | Train Loss: 0.337 Vali Loss: 0.845 Vali Acc: 0.684 Test Loss: 0.845 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1851728
	speed: 0.6704s/iter; left time: 22443.4553s
	iters: 200, epoch: 10 | loss: 0.3057618
	speed: 0.2354s/iter; left time: 7858.2348s
	iters: 300, epoch: 10 | loss: 0.7982438
	speed: 0.2316s/iter; left time: 7708.7516s
Epoch: 10 cost time: 86.71228432655334
Epoch: 10, Steps: 369 | Train Loss: 0.290 Vali Loss: 0.891 Vali Acc: 0.674 Test Loss: 0.891 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1185785
	speed: 0.7167s/iter; left time: 23730.2776s
	iters: 200, epoch: 11 | loss: 0.2268220
	speed: 0.2333s/iter; left time: 7700.2906s
	iters: 300, epoch: 11 | loss: 0.1387862
	speed: 0.2380s/iter; left time: 7832.4253s
Epoch: 11 cost time: 86.79637145996094
Epoch: 11, Steps: 369 | Train Loss: 0.259 Vali Loss: 0.974 Vali Acc: 0.672 Test Loss: 0.974 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1092311
	speed: 0.6966s/iter; left time: 22806.9254s
	iters: 200, epoch: 12 | loss: 0.1755551
	speed: 0.2416s/iter; left time: 7884.8148s
	iters: 300, epoch: 12 | loss: 0.3322614
	speed: 0.2273s/iter; left time: 7396.3982s
Epoch: 12 cost time: 86.66999745368958
Epoch: 12, Steps: 369 | Train Loss: 0.241 Vali Loss: 1.021 Vali Acc: 0.675 Test Loss: 1.021 Test Acc: 0.675
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0488931
	speed: 0.6658s/iter; left time: 21555.0572s
	iters: 200, epoch: 13 | loss: 0.1557393
	speed: 0.2294s/iter; left time: 7402.3325s
	iters: 300, epoch: 13 | loss: 0.0565426
	speed: 0.2239s/iter; left time: 7204.4093s
Epoch: 13 cost time: 83.48553395271301
Epoch: 13, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.098 Vali Acc: 0.662 Test Loss: 1.098 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3445725
	speed: 0.6867s/iter; left time: 21975.9750s
	iters: 200, epoch: 14 | loss: 0.1825628
	speed: 0.2193s/iter; left time: 6996.0806s
	iters: 300, epoch: 14 | loss: 0.0594322
	speed: 0.2092s/iter; left time: 6652.7228s
Epoch: 14 cost time: 79.87392139434814
Epoch: 14, Steps: 369 | Train Loss: 0.198 Vali Loss: 1.160 Vali Acc: 0.674 Test Loss: 1.160 Test Acc: 0.674
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1162932
	speed: 0.6595s/iter; left time: 20864.6470s
	iters: 200, epoch: 15 | loss: 0.1050923
	speed: 0.2155s/iter; left time: 6796.4334s
	iters: 300, epoch: 15 | loss: 0.0513991
	speed: 0.2056s/iter; left time: 6464.5405s
Epoch: 15 cost time: 80.12850189208984
Epoch: 15, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.187 Vali Acc: 0.648 Test Loss: 1.187 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.2611175
	speed: 0.6813s/iter; left time: 21301.1702s
	iters: 200, epoch: 16 | loss: 0.1186252
	speed: 0.2265s/iter; left time: 7059.1276s
	iters: 300, epoch: 16 | loss: 0.1194391
	speed: 0.2193s/iter; left time: 6812.6936s
Epoch: 16 cost time: 82.92393970489502
Epoch: 16, Steps: 369 | Train Loss: 0.163 Vali Loss: 1.308 Vali Acc: 0.661 Test Loss: 1.308 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.3636527
	speed: 0.6823s/iter; left time: 21082.2099s
	iters: 200, epoch: 17 | loss: 0.4754525
	speed: 0.2297s/iter; left time: 7073.0263s
	iters: 300, epoch: 17 | loss: 0.1651600
	speed: 0.2346s/iter; left time: 7202.8916s
Epoch: 17 cost time: 85.93186020851135
Epoch: 17, Steps: 369 | Train Loss: 0.157 Vali Loss: 1.431 Vali Acc: 0.647 Test Loss: 1.431 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6853007945516458
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6933414
	speed: 0.2704s/iter; left time: 9951.5789s
	iters: 200, epoch: 1 | loss: 0.6909701
	speed: 0.2520s/iter; left time: 9250.1371s
	iters: 300, epoch: 1 | loss: 0.6932902
	speed: 0.2367s/iter; left time: 8663.5659s
Epoch: 1 cost time: 91.78951644897461
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6905211
	speed: 0.6881s/iter; left time: 25067.7417s
	iters: 200, epoch: 2 | loss: 0.6923417
	speed: 0.2362s/iter; left time: 8582.5327s
	iters: 300, epoch: 2 | loss: 0.6926390
	speed: 0.2476s/iter; left time: 8969.3041s
Epoch: 2 cost time: 88.4408688545227
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6966629
	speed: 0.7188s/iter; left time: 25923.5343s
	iters: 200, epoch: 3 | loss: 0.6931490
	speed: 0.2484s/iter; left time: 8932.6189s
	iters: 300, epoch: 3 | loss: 0.6910168
	speed: 0.2643s/iter; left time: 9477.2471s
Epoch: 3 cost time: 91.70901536941528
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6918711
	speed: 0.7085s/iter; left time: 25288.0404s
	iters: 200, epoch: 4 | loss: 0.6921862
	speed: 0.2230s/iter; left time: 7938.5990s
	iters: 300, epoch: 4 | loss: 0.6939719
	speed: 0.2309s/iter; left time: 8194.4315s
Epoch: 4 cost time: 85.61652207374573
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6935725
	speed: 0.7311s/iter; left time: 25826.1911s
	iters: 200, epoch: 5 | loss: 0.6937198
	speed: 0.2176s/iter; left time: 7664.4060s
	iters: 300, epoch: 5 | loss: 0.6924055
	speed: 0.2364s/iter; left time: 8302.1917s
Epoch: 5 cost time: 86.94965434074402
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6937829
	speed: 0.7105s/iter; left time: 24835.5617s
	iters: 200, epoch: 6 | loss: 0.6929356
	speed: 0.2291s/iter; left time: 7985.0458s
	iters: 300, epoch: 6 | loss: 0.6931474
	speed: 0.2414s/iter; left time: 8391.2135s
Epoch: 6 cost time: 86.29329419136047
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6946931
	speed: 0.7291s/iter; left time: 25217.5970s
	iters: 200, epoch: 7 | loss: 0.6923620
	speed: 0.2525s/iter; left time: 8706.5096s
	iters: 300, epoch: 7 | loss: 0.6963125
	speed: 0.2400s/iter; left time: 8252.0483s
Epoch: 7 cost time: 90.54152035713196
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6933587
	speed: 0.7115s/iter; left time: 24347.7261s
	iters: 200, epoch: 8 | loss: 0.6931477
	speed: 0.2516s/iter; left time: 8582.5950s
	iters: 300, epoch: 8 | loss: 0.6925527
	speed: 0.2535s/iter; left time: 8623.6639s
Epoch: 8 cost time: 92.19253969192505
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6928501
	speed: 0.7416s/iter; left time: 25102.7416s
	iters: 200, epoch: 9 | loss: 0.6933706
	speed: 0.2516s/iter; left time: 8490.3549s
	iters: 300, epoch: 9 | loss: 0.6980818
	speed: 0.2422s/iter; left time: 8149.4568s
Epoch: 9 cost time: 93.52805209159851
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6931556
	speed: 0.7603s/iter; left time: 25455.4029s
	iters: 200, epoch: 10 | loss: 0.6931740
	speed: 0.2539s/iter; left time: 8475.3605s
	iters: 300, epoch: 10 | loss: 0.6943049
	speed: 0.2617s/iter; left time: 8708.8266s
Epoch: 10 cost time: 92.36695384979248
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.7015184
	speed: 0.7722s/iter; left time: 25568.2084s
	iters: 200, epoch: 11 | loss: 0.6960747
	speed: 0.2426s/iter; left time: 8008.5572s
	iters: 300, epoch: 11 | loss: 0.6945658
	speed: 0.2273s/iter; left time: 7479.0301s
Epoch: 11 cost time: 88.48178291320801
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6939530
	speed: 0.7355s/iter; left time: 24082.6215s
	iters: 200, epoch: 12 | loss: 0.6914500
	speed: 0.2341s/iter; left time: 7641.1145s
	iters: 300, epoch: 12 | loss: 0.6951578
	speed: 0.2377s/iter; left time: 7735.4194s
Epoch: 12 cost time: 89.38594961166382
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6936178
	speed: 0.7290s/iter; left time: 23598.6605s
	iters: 200, epoch: 13 | loss: 0.6931578
	speed: 0.2266s/iter; left time: 7314.3079s
	iters: 300, epoch: 13 | loss: 0.6915770
	speed: 0.2320s/iter; left time: 7463.8810s
Epoch: 13 cost time: 85.54984855651855
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6926765
	speed: 0.7063s/iter; left time: 22604.7462s
	iters: 200, epoch: 14 | loss: 0.6932753
	speed: 0.2330s/iter; left time: 7432.0582s
	iters: 300, epoch: 14 | loss: 0.6932960
	speed: 0.2409s/iter; left time: 7662.2497s
Epoch: 14 cost time: 89.51438212394714
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.6943160
	speed: 0.7232s/iter; left time: 22879.2581s
	iters: 200, epoch: 15 | loss: 0.6951097
	speed: 0.2436s/iter; left time: 7681.2541s
	iters: 300, epoch: 15 | loss: 0.6930337
	speed: 0.2357s/iter; left time: 7409.3716s
Epoch: 15 cost time: 90.18465614318848
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.6943595
	speed: 0.7494s/iter; left time: 23429.4031s
	iters: 200, epoch: 16 | loss: 0.6948692
	speed: 0.2506s/iter; left time: 7811.2530s
	iters: 300, epoch: 16 | loss: 0.6925523
	speed: 0.2461s/iter; left time: 7644.9883s
Epoch: 16 cost time: 92.31229162216187
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 444578
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7078093
	speed: 0.2482s/iter; left time: 9134.9903s
	iters: 200, epoch: 1 | loss: 0.6545922
	speed: 0.2291s/iter; left time: 8407.6712s
	iters: 300, epoch: 1 | loss: 0.6623285
	speed: 0.2345s/iter; left time: 8584.3516s
Epoch: 1 cost time: 87.72124934196472
Epoch: 1, Steps: 369 | Train Loss: 0.677 Vali Loss: 0.673 Vali Acc: 0.608 Test Loss: 0.673 Test Acc: 0.608
Validation loss decreased (inf --> -0.608393).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6485570
	speed: 0.7017s/iter; left time: 25563.5357s
	iters: 200, epoch: 2 | loss: 0.5040772
	speed: 0.2193s/iter; left time: 7966.2931s
	iters: 300, epoch: 2 | loss: 0.4329081
	speed: 0.2190s/iter; left time: 7934.0182s
Epoch: 2 cost time: 83.53874349594116
Epoch: 2, Steps: 369 | Train Loss: 0.555 Vali Loss: 0.641 Vali Acc: 0.673 Test Loss: 0.641 Test Acc: 0.673
Validation loss decreased (-0.608393 --> -0.673376).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4111159
	speed: 0.6779s/iter; left time: 24445.9571s
	iters: 200, epoch: 3 | loss: 0.3829767
	speed: 0.2167s/iter; left time: 7794.8641s
	iters: 300, epoch: 3 | loss: 1.2487543
	speed: 0.2244s/iter; left time: 8049.3602s
Epoch: 3 cost time: 82.68643999099731
Epoch: 3, Steps: 369 | Train Loss: 0.480 Vali Loss: 0.720 Vali Acc: 0.652 Test Loss: 0.720 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3362137
	speed: 0.6838s/iter; left time: 24409.1758s
	iters: 200, epoch: 4 | loss: 0.4286655
	speed: 0.2312s/iter; left time: 8228.2361s
	iters: 300, epoch: 4 | loss: 0.2567326
	speed: 0.2367s/iter; left time: 8400.5721s
Epoch: 4 cost time: 87.18886613845825
Epoch: 4, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.683 Vali Acc: 0.685 Test Loss: 0.683 Test Acc: 0.685
Validation loss decreased (-0.673376 --> -0.685294).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3329510
	speed: 0.7104s/iter; left time: 25094.3386s
	iters: 200, epoch: 5 | loss: 0.5783262
	speed: 0.2342s/iter; left time: 8248.2676s
	iters: 300, epoch: 5 | loss: 0.4283756
	speed: 0.2394s/iter; left time: 8407.3129s
Epoch: 5 cost time: 87.132981300354
Epoch: 5, Steps: 369 | Train Loss: 0.381 Vali Loss: 0.779 Vali Acc: 0.676 Test Loss: 0.779 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2718320
	speed: 0.7180s/iter; left time: 25098.2935s
	iters: 200, epoch: 6 | loss: 0.3153300
	speed: 0.2377s/iter; left time: 8284.0231s
	iters: 300, epoch: 6 | loss: 0.7203225
	speed: 0.2334s/iter; left time: 8110.8625s
Epoch: 6 cost time: 86.79670023918152
Epoch: 6, Steps: 369 | Train Loss: 0.340 Vali Loss: 0.917 Vali Acc: 0.648 Test Loss: 0.917 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2527397
	speed: 0.6953s/iter; left time: 24047.2210s
	iters: 200, epoch: 7 | loss: 0.4664539
	speed: 0.2296s/iter; left time: 7917.9569s
	iters: 300, epoch: 7 | loss: 0.3202365
	speed: 0.2230s/iter; left time: 7667.0118s
Epoch: 7 cost time: 86.32405424118042
Epoch: 7, Steps: 369 | Train Loss: 0.317 Vali Loss: 0.882 Vali Acc: 0.670 Test Loss: 0.882 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2991121
	speed: 0.6818s/iter; left time: 23331.1901s
	iters: 200, epoch: 8 | loss: 0.1277390
	speed: 0.2285s/iter; left time: 7796.2792s
	iters: 300, epoch: 8 | loss: 0.4617000
	speed: 0.2397s/iter; left time: 8153.4351s
Epoch: 8 cost time: 86.5490334033966
Epoch: 8, Steps: 369 | Train Loss: 0.283 Vali Loss: 0.953 Vali Acc: 0.677 Test Loss: 0.953 Test Acc: 0.677
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1333296
	speed: 0.6963s/iter; left time: 23567.4909s
	iters: 200, epoch: 9 | loss: 0.4806818
	speed: 0.2357s/iter; left time: 7954.1516s
	iters: 300, epoch: 9 | loss: 0.1985396
	speed: 0.2353s/iter; left time: 7918.6007s
Epoch: 9 cost time: 84.79915523529053
Epoch: 9, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.106 Vali Acc: 0.665 Test Loss: 1.106 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0937281
	speed: 0.6756s/iter; left time: 22619.4385s
	iters: 200, epoch: 10 | loss: 0.4666504
	speed: 0.2401s/iter; left time: 8015.6038s
	iters: 300, epoch: 10 | loss: 0.2104980
	speed: 0.2267s/iter; left time: 7544.0300s
Epoch: 10 cost time: 86.22937870025635
Epoch: 10, Steps: 369 | Train Loss: 0.231 Vali Loss: 1.184 Vali Acc: 0.646 Test Loss: 1.184 Test Acc: 0.646
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1380455
	speed: 0.6916s/iter; left time: 22900.5689s
	iters: 200, epoch: 11 | loss: 0.1249241
	speed: 0.2355s/iter; left time: 7772.5078s
	iters: 300, epoch: 11 | loss: 0.5202795
	speed: 0.2265s/iter; left time: 7455.5172s
Epoch: 11 cost time: 86.06710481643677
Epoch: 11, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.227 Vali Acc: 0.657 Test Loss: 1.227 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0376725
	speed: 0.7095s/iter; left time: 23231.4521s
	iters: 200, epoch: 12 | loss: 0.2477815
	speed: 0.2312s/iter; left time: 7548.1778s
	iters: 300, epoch: 12 | loss: 0.0866879
	speed: 0.2299s/iter; left time: 7480.2415s
Epoch: 12 cost time: 86.34024786949158
Epoch: 12, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.296 Vali Acc: 0.663 Test Loss: 1.296 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0713739
	speed: 0.6921s/iter; left time: 22406.7709s
	iters: 200, epoch: 13 | loss: 0.1118080
	speed: 0.2342s/iter; left time: 7558.3284s
	iters: 300, epoch: 13 | loss: 0.1147660
	speed: 0.2309s/iter; left time: 7429.9811s
Epoch: 13 cost time: 86.62413263320923
Epoch: 13, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.333 Vali Acc: 0.662 Test Loss: 1.333 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.2276156
	speed: 0.6887s/iter; left time: 22040.6018s
	iters: 200, epoch: 14 | loss: 0.0905080
	speed: 0.2255s/iter; left time: 7193.8985s
	iters: 300, epoch: 14 | loss: 0.0054946
	speed: 0.2302s/iter; left time: 7321.6637s
Epoch: 14 cost time: 84.66624593734741
Epoch: 14, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.383 Vali Acc: 0.673 Test Loss: 1.383 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6853007945516458
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6854469
	speed: 0.2389s/iter; left time: 8791.0007s
	iters: 200, epoch: 1 | loss: 0.6796010
	speed: 0.2060s/iter; left time: 7561.6694s
	iters: 300, epoch: 1 | loss: 0.5890725
	speed: 0.2407s/iter; left time: 8809.7336s
Epoch: 1 cost time: 85.9551613330841
Epoch: 1, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.685 Vali Acc: 0.599 Test Loss: 0.685 Test Acc: 0.599
Validation loss decreased (inf --> -0.599028).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5927265
	speed: 0.7139s/iter; left time: 26009.2862s
	iters: 200, epoch: 2 | loss: 0.5001640
	speed: 0.2409s/iter; left time: 8753.2323s
	iters: 300, epoch: 2 | loss: 0.4958686
	speed: 0.2473s/iter; left time: 8961.1019s
Epoch: 2 cost time: 92.03572225570679
Epoch: 2, Steps: 369 | Train Loss: 0.558 Vali Loss: 0.650 Vali Acc: 0.660 Test Loss: 0.650 Test Acc: 0.660
Validation loss decreased (-0.599028 --> -0.660323).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3624970
	speed: 0.7121s/iter; left time: 25680.5755s
	iters: 200, epoch: 3 | loss: 0.4318853
	speed: 0.2338s/iter; left time: 8409.0377s
	iters: 300, epoch: 3 | loss: 1.0621183
	speed: 0.2308s/iter; left time: 8275.5717s
Epoch: 3 cost time: 85.57143473625183
Epoch: 3, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.703 Vali Acc: 0.662 Test Loss: 0.703 Test Acc: 0.662
Validation loss decreased (-0.660323 --> -0.662025).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3896752
	speed: 0.6798s/iter; left time: 24266.0337s
	iters: 200, epoch: 4 | loss: 0.5050219
	speed: 0.2236s/iter; left time: 7958.6965s
	iters: 300, epoch: 4 | loss: 0.2767414
	speed: 0.2301s/iter; left time: 8166.3637s
Epoch: 4 cost time: 86.23101663589478
Epoch: 4, Steps: 369 | Train Loss: 0.431 Vali Loss: 0.709 Vali Acc: 0.671 Test Loss: 0.709 Test Acc: 0.671
Validation loss decreased (-0.662025 --> -0.671105).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3764597
	speed: 0.6920s/iter; left time: 24445.4335s
	iters: 200, epoch: 5 | loss: 0.5389308
	speed: 0.2291s/iter; left time: 8071.2630s
	iters: 300, epoch: 5 | loss: 0.4295440
	speed: 0.2260s/iter; left time: 7937.9915s
Epoch: 5 cost time: 84.04055428504944
Epoch: 5, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.769 Vali Acc: 0.673 Test Loss: 0.769 Test Acc: 0.673
Validation loss decreased (-0.671105 --> -0.672524).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2231045
	speed: 0.6787s/iter; left time: 23723.4730s
	iters: 200, epoch: 6 | loss: 0.3988965
	speed: 0.2221s/iter; left time: 7742.0740s
	iters: 300, epoch: 6 | loss: 0.6780449
	speed: 0.2302s/iter; left time: 8000.8372s
Epoch: 6 cost time: 85.02453231811523
Epoch: 6, Steps: 369 | Train Loss: 0.348 Vali Loss: 0.845 Vali Acc: 0.666 Test Loss: 0.845 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2678480
	speed: 0.6819s/iter; left time: 23586.0215s
	iters: 200, epoch: 7 | loss: 0.2933164
	speed: 0.2293s/iter; left time: 7908.9066s
	iters: 300, epoch: 7 | loss: 0.2352647
	speed: 0.2272s/iter; left time: 7813.2687s
Epoch: 7 cost time: 84.47927260398865
Epoch: 7, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.863 Vali Acc: 0.674 Test Loss: 0.863 Test Acc: 0.674
Validation loss decreased (-0.672524 --> -0.674225).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1748618
	speed: 0.6671s/iter; left time: 22827.6818s
	iters: 200, epoch: 8 | loss: 0.3798921
	speed: 0.2326s/iter; left time: 7936.2708s
	iters: 300, epoch: 8 | loss: 0.3972172
	speed: 0.2344s/iter; left time: 7974.9492s
Epoch: 8 cost time: 87.531090259552
Epoch: 8, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.939 Vali Acc: 0.667 Test Loss: 0.939 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1265103
	speed: 0.7130s/iter; left time: 24133.8037s
	iters: 200, epoch: 9 | loss: 0.5328712
	speed: 0.2366s/iter; left time: 7985.6914s
	iters: 300, epoch: 9 | loss: 0.3618870
	speed: 0.2377s/iter; left time: 7999.4044s
Epoch: 9 cost time: 87.55430603027344
Epoch: 9, Steps: 369 | Train Loss: 0.255 Vali Loss: 1.046 Vali Acc: 0.672 Test Loss: 1.046 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1223878
	speed: 0.6849s/iter; left time: 22931.6323s
	iters: 200, epoch: 10 | loss: 0.2976223
	speed: 0.2273s/iter; left time: 7587.8577s
	iters: 300, epoch: 10 | loss: 0.1010547
	speed: 0.2359s/iter; left time: 7852.0009s
Epoch: 10 cost time: 86.44553971290588
Epoch: 10, Steps: 369 | Train Loss: 0.224 Vali Loss: 1.149 Vali Acc: 0.664 Test Loss: 1.149 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1354407
	speed: 0.6906s/iter; left time: 22866.6554s
	iters: 200, epoch: 11 | loss: 0.1030775
	speed: 0.2244s/iter; left time: 7406.0315s
	iters: 300, epoch: 11 | loss: 0.1707603
	speed: 0.2269s/iter; left time: 7466.1445s
Epoch: 11 cost time: 84.95175385475159
Epoch: 11, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.149 Vali Acc: 0.657 Test Loss: 1.149 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0372883
	speed: 0.6841s/iter; left time: 22399.2000s
	iters: 200, epoch: 12 | loss: 0.1366797
	speed: 0.2229s/iter; left time: 7277.3628s
	iters: 300, epoch: 12 | loss: 0.0558920
	speed: 0.2140s/iter; left time: 6963.7197s
Epoch: 12 cost time: 83.93444275856018
Epoch: 12, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.355 Vali Acc: 0.659 Test Loss: 1.355 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3041600
	speed: 0.6654s/iter; left time: 21541.8151s
	iters: 200, epoch: 13 | loss: 0.3688557
	speed: 0.2176s/iter; left time: 7023.1663s
	iters: 300, epoch: 13 | loss: 0.2246167
	speed: 0.2198s/iter; left time: 7072.4377s
Epoch: 13 cost time: 81.81677746772766
Epoch: 13, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.375 Vali Acc: 0.656 Test Loss: 1.375 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1418976
	speed: 0.6786s/iter; left time: 21717.3561s
	iters: 200, epoch: 14 | loss: 0.1787994
	speed: 0.2448s/iter; left time: 7810.0649s
	iters: 300, epoch: 14 | loss: 0.1038343
	speed: 0.2460s/iter; left time: 7823.6673s
Epoch: 14 cost time: 91.23665356636047
Epoch: 14, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.404 Vali Acc: 0.665 Test Loss: 1.404 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1226005
	speed: 0.7472s/iter; left time: 23637.0762s
	iters: 200, epoch: 15 | loss: 0.1410507
	speed: 0.2442s/iter; left time: 7699.6165s
	iters: 300, epoch: 15 | loss: 0.0589250
	speed: 0.2444s/iter; left time: 7682.6599s
Epoch: 15 cost time: 93.4954206943512
Epoch: 15, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.410 Vali Acc: 0.657 Test Loss: 1.410 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1208339
	speed: 0.7214s/iter; left time: 22555.0504s
	iters: 200, epoch: 16 | loss: 0.1614788
	speed: 0.2372s/iter; left time: 7393.0389s
	iters: 300, epoch: 16 | loss: 0.3093493
	speed: 0.2387s/iter; left time: 7415.8686s
Epoch: 16 cost time: 87.95416235923767
Epoch: 16, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.543 Vali Acc: 0.661 Test Loss: 1.543 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0688999
	speed: 0.7031s/iter; left time: 21724.1397s
	iters: 200, epoch: 17 | loss: 0.2847069
	speed: 0.2253s/iter; left time: 6937.0929s
	iters: 300, epoch: 17 | loss: 0.2072079
	speed: 0.2653s/iter; left time: 8143.6787s
Epoch: 17 cost time: 87.15470576286316
Epoch: 17, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.584 Vali Acc: 0.663 Test Loss: 1.584 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.674233825198638
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6303935
	speed: 0.2560s/iter; left time: 9420.2327s
	iters: 200, epoch: 1 | loss: 0.6793697
	speed: 0.2551s/iter; left time: 9362.4834s
	iters: 300, epoch: 1 | loss: 0.6366044
	speed: 0.2402s/iter; left time: 8792.8641s
Epoch: 1 cost time: 90.46855759620667
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.702 Vali Acc: 0.579 Test Loss: 0.702 Test Acc: 0.579
Validation loss decreased (inf --> -0.579164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7427743
	speed: 0.6921s/iter; left time: 25213.4229s
	iters: 200, epoch: 2 | loss: 0.5498740
	speed: 0.2438s/iter; left time: 8859.5490s
	iters: 300, epoch: 2 | loss: 0.5448303
	speed: 0.2220s/iter; left time: 8042.1031s
Epoch: 2 cost time: 87.42658066749573
Epoch: 2, Steps: 369 | Train Loss: 0.570 Vali Loss: 0.673 Vali Acc: 0.657 Test Loss: 0.673 Test Acc: 0.657
Validation loss decreased (-0.579164 --> -0.657485).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5434152
	speed: 0.6882s/iter; left time: 24817.7261s
	iters: 200, epoch: 3 | loss: 0.4838854
	speed: 0.2248s/iter; left time: 8083.7965s
	iters: 300, epoch: 3 | loss: 0.9855982
	speed: 0.2323s/iter; left time: 8331.5400s
Epoch: 3 cost time: 84.9632830619812
Epoch: 3, Steps: 369 | Train Loss: 0.482 Vali Loss: 0.733 Vali Acc: 0.653 Test Loss: 0.733 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4801443
	speed: 0.6980s/iter; left time: 24912.9464s
	iters: 200, epoch: 4 | loss: 0.3819850
	speed: 0.2452s/iter; left time: 8727.8603s
	iters: 300, epoch: 4 | loss: 0.2086296
	speed: 0.2346s/iter; left time: 8328.3621s
Epoch: 4 cost time: 89.00683617591858
Epoch: 4, Steps: 369 | Train Loss: 0.434 Vali Loss: 0.723 Vali Acc: 0.668 Test Loss: 0.723 Test Acc: 0.668
Validation loss decreased (-0.657485 --> -0.668267).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3307613
	speed: 0.7055s/iter; left time: 24923.0771s
	iters: 200, epoch: 5 | loss: 0.4937542
	speed: 0.2406s/iter; left time: 8476.2245s
	iters: 300, epoch: 5 | loss: 0.3736993
	speed: 0.2452s/iter; left time: 8611.0958s
Epoch: 5 cost time: 90.33919143676758
Epoch: 5, Steps: 369 | Train Loss: 0.389 Vali Loss: 0.768 Vali Acc: 0.671 Test Loss: 0.768 Test Acc: 0.671
Validation loss decreased (-0.668267 --> -0.670821).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2953615
	speed: 0.7291s/iter; left time: 25487.7168s
	iters: 200, epoch: 6 | loss: 0.4502003
	speed: 0.2244s/iter; left time: 7822.7524s
	iters: 300, epoch: 6 | loss: 0.7458423
	speed: 0.2391s/iter; left time: 8309.6121s
Epoch: 6 cost time: 86.07002139091492
Epoch: 6, Steps: 369 | Train Loss: 0.344 Vali Loss: 0.827 Vali Acc: 0.659 Test Loss: 0.827 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3441196
	speed: 0.6895s/iter; left time: 23848.2061s
	iters: 200, epoch: 7 | loss: 0.2898825
	speed: 0.2333s/iter; left time: 8045.3615s
	iters: 300, epoch: 7 | loss: 0.1189792
	speed: 0.2316s/iter; left time: 7965.7203s
Epoch: 7 cost time: 86.45260667800903
Epoch: 7, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.875 Vali Acc: 0.672 Test Loss: 0.875 Test Acc: 0.672
Validation loss decreased (-0.670821 --> -0.671955).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1267909
	speed: 0.6770s/iter; left time: 23165.4875s
	iters: 200, epoch: 8 | loss: 0.4340051
	speed: 0.2351s/iter; left time: 8021.2255s
	iters: 300, epoch: 8 | loss: 0.5496527
	speed: 0.2303s/iter; left time: 7835.1796s
Epoch: 8 cost time: 84.99703931808472
Epoch: 8, Steps: 369 | Train Loss: 0.291 Vali Loss: 0.912 Vali Acc: 0.669 Test Loss: 0.912 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4427815
	speed: 0.6879s/iter; left time: 23283.3921s
	iters: 200, epoch: 9 | loss: 0.2259246
	speed: 0.2440s/iter; left time: 8234.4334s
	iters: 300, epoch: 9 | loss: 0.2832208
	speed: 0.2285s/iter; left time: 7687.4738s
Epoch: 9 cost time: 88.05991315841675
Epoch: 9, Steps: 369 | Train Loss: 0.264 Vali Loss: 0.974 Vali Acc: 0.675 Test Loss: 0.974 Test Acc: 0.675
Validation loss decreased (-0.671955 --> -0.674792).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1863651
	speed: 0.6763s/iter; left time: 22642.3309s
	iters: 200, epoch: 10 | loss: 0.1686666
	speed: 0.2311s/iter; left time: 7712.8551s
	iters: 300, epoch: 10 | loss: 0.0778036
	speed: 0.2294s/iter; left time: 7635.5217s
Epoch: 10 cost time: 84.25739097595215
Epoch: 10, Steps: 369 | Train Loss: 0.233 Vali Loss: 1.176 Vali Acc: 0.657 Test Loss: 1.176 Test Acc: 0.657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0949717
	speed: 0.7007s/iter; left time: 23199.8789s
	iters: 200, epoch: 11 | loss: 0.1710534
	speed: 0.2395s/iter; left time: 7904.9031s
	iters: 300, epoch: 11 | loss: 0.4770011
	speed: 0.2419s/iter; left time: 7961.5768s
Epoch: 11 cost time: 89.55815362930298
Epoch: 11, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.114 Vali Acc: 0.658 Test Loss: 1.114 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1093295
	speed: 0.7014s/iter; left time: 22966.1508s
	iters: 200, epoch: 12 | loss: 0.2587048
	speed: 0.2415s/iter; left time: 7882.9119s
	iters: 300, epoch: 12 | loss: 0.0329527
	speed: 0.2272s/iter; left time: 7394.8469s
Epoch: 12 cost time: 87.0739996433258
Epoch: 12, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.291 Vali Acc: 0.650 Test Loss: 1.291 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0978667
	speed: 0.7008s/iter; left time: 22688.3226s
	iters: 200, epoch: 13 | loss: 0.0680081
	speed: 0.2496s/iter; left time: 8056.3860s
	iters: 300, epoch: 13 | loss: 0.2303540
	speed: 0.2427s/iter; left time: 7808.9059s
Epoch: 13 cost time: 90.24724102020264
Epoch: 13, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.373 Vali Acc: 0.654 Test Loss: 1.373 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1196077
	speed: 0.7060s/iter; left time: 22595.4923s
	iters: 200, epoch: 14 | loss: 0.1885979
	speed: 0.2301s/iter; left time: 7339.8491s
	iters: 300, epoch: 14 | loss: 0.0913539
	speed: 0.2256s/iter; left time: 7176.4897s
Epoch: 14 cost time: 87.03218054771423
Epoch: 14, Steps: 369 | Train Loss: 0.154 Vali Loss: 1.444 Vali Acc: 0.654 Test Loss: 1.444 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0605741
	speed: 0.6975s/iter; left time: 22065.6342s
	iters: 200, epoch: 15 | loss: 0.0189780
	speed: 0.2333s/iter; left time: 7356.1465s
	iters: 300, epoch: 15 | loss: 0.1561619
	speed: 0.2327s/iter; left time: 7316.0825s
Epoch: 15 cost time: 86.29925441741943
Epoch: 15, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.392 Vali Acc: 0.645 Test Loss: 1.392 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0998543
	speed: 0.7162s/iter; left time: 22391.1817s
	iters: 200, epoch: 16 | loss: 0.4285825
	speed: 0.2368s/iter; left time: 7378.6076s
	iters: 300, epoch: 16 | loss: 0.3424988
	speed: 0.2431s/iter; left time: 7551.8940s
Epoch: 16 cost time: 89.18288373947144
Epoch: 16, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.475 Vali Acc: 0.654 Test Loss: 1.475 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0995748
	speed: 0.7040s/iter; left time: 21752.7158s
	iters: 200, epoch: 17 | loss: 0.0143668
	speed: 0.2308s/iter; left time: 7107.9834s
	iters: 300, epoch: 17 | loss: 0.0048102
	speed: 0.2488s/iter; left time: 7638.4656s
Epoch: 17 cost time: 88.21734809875488
Epoch: 17, Steps: 369 | Train Loss: 0.119 Vali Loss: 1.493 Vali Acc: 0.656 Test Loss: 1.493 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0391844
	speed: 0.7294s/iter; left time: 22266.5297s
	iters: 200, epoch: 18 | loss: 0.4348004
	speed: 0.2444s/iter; left time: 7435.9768s
	iters: 300, epoch: 18 | loss: 0.0816152
	speed: 0.2286s/iter; left time: 6932.5443s
Epoch: 18 cost time: 88.08065056800842
Epoch: 18, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.643 Vali Acc: 0.669 Test Loss: 1.643 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0883271
	speed: 0.7248s/iter; left time: 21859.3835s
	iters: 200, epoch: 19 | loss: 0.1460148
	speed: 0.2441s/iter; left time: 7336.1800s
	iters: 300, epoch: 19 | loss: 0.0233413
	speed: 0.2284s/iter; left time: 6842.2793s
Epoch: 19 cost time: 90.72924137115479
Epoch: 19, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.697 Vali Acc: 0.651 Test Loss: 1.697 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6748013620885358
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6934592
	speed: 0.2441s/iter; left time: 8982.9716s
	iters: 200, epoch: 1 | loss: 0.7358546
	speed: 0.2130s/iter; left time: 7817.7195s
	iters: 300, epoch: 1 | loss: 0.6683827
	speed: 0.2279s/iter; left time: 8342.1837s
Epoch: 1 cost time: 84.82164692878723
Epoch: 1, Steps: 369 | Train Loss: 0.706 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
Validation loss decreased (inf --> -0.580016).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6237096
	speed: 0.6770s/iter; left time: 24664.5216s
	iters: 200, epoch: 2 | loss: 0.4415764
	speed: 0.2215s/iter; left time: 8046.7443s
	iters: 300, epoch: 2 | loss: 0.4805774
	speed: 0.2267s/iter; left time: 8213.7801s
Epoch: 2 cost time: 86.38353538513184
Epoch: 2, Steps: 369 | Train Loss: 0.584 Vali Loss: 0.661 Vali Acc: 0.666 Test Loss: 0.661 Test Acc: 0.666
Validation loss decreased (-0.580016 --> -0.666282).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4436963
	speed: 0.7282s/iter; left time: 26261.7680s
	iters: 200, epoch: 3 | loss: 0.3880121
	speed: 0.2553s/iter; left time: 9181.2206s
	iters: 300, epoch: 3 | loss: 0.9813464
	speed: 0.2483s/iter; left time: 8903.5296s
Epoch: 3 cost time: 94.65080499649048
Epoch: 3, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.710 Vali Acc: 0.663 Test Loss: 0.710 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4340438
	speed: 0.7206s/iter; left time: 25722.5235s
	iters: 200, epoch: 4 | loss: 0.3815676
	speed: 0.2383s/iter; left time: 8481.7732s
	iters: 300, epoch: 4 | loss: 0.2515987
	speed: 0.2516s/iter; left time: 8930.3634s
Epoch: 4 cost time: 89.82457971572876
Epoch: 4, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.723 Vali Acc: 0.675 Test Loss: 0.723 Test Acc: 0.675
Validation loss decreased (-0.666282 --> -0.674510).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3493676
	speed: 0.7241s/iter; left time: 25579.6788s
	iters: 200, epoch: 5 | loss: 0.4544025
	speed: 0.2439s/iter; left time: 8591.3825s
	iters: 300, epoch: 5 | loss: 0.3783587
	speed: 0.2233s/iter; left time: 7844.9329s
Epoch: 5 cost time: 88.62385201454163
Epoch: 5, Steps: 369 | Train Loss: 0.405 Vali Loss: 0.790 Vali Acc: 0.669 Test Loss: 0.790 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4338972
	speed: 0.6916s/iter; left time: 24174.4825s
	iters: 200, epoch: 6 | loss: 0.3119726
	speed: 0.2094s/iter; left time: 7298.4648s
	iters: 300, epoch: 6 | loss: 0.7718629
	speed: 0.2297s/iter; left time: 7984.8140s
Epoch: 6 cost time: 83.18503260612488
Epoch: 6, Steps: 369 | Train Loss: 0.361 Vali Loss: 0.833 Vali Acc: 0.666 Test Loss: 0.833 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2814423
	speed: 0.6643s/iter; left time: 22976.7236s
	iters: 200, epoch: 7 | loss: 0.4455217
	speed: 0.2392s/iter; left time: 8249.8223s
	iters: 300, epoch: 7 | loss: 0.1431029
	speed: 0.2424s/iter; left time: 8334.2171s
Epoch: 7 cost time: 87.76721787452698
Epoch: 7, Steps: 369 | Train Loss: 0.327 Vali Loss: 0.894 Vali Acc: 0.670 Test Loss: 0.894 Test Acc: 0.670
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.3198565
	speed: 0.7105s/iter; left time: 24313.0376s
	iters: 200, epoch: 8 | loss: 0.3104505
	speed: 0.2285s/iter; left time: 7795.0867s
	iters: 300, epoch: 8 | loss: 0.5030262
	speed: 0.2260s/iter; left time: 7688.3894s
Epoch: 8 cost time: 85.33496570587158
Epoch: 8, Steps: 369 | Train Loss: 0.297 Vali Loss: 0.956 Vali Acc: 0.665 Test Loss: 0.956 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2130726
	speed: 0.6974s/iter; left time: 23607.1342s
	iters: 200, epoch: 9 | loss: 0.2471060
	speed: 0.2290s/iter; left time: 7727.0965s
	iters: 300, epoch: 9 | loss: 0.3130347
	speed: 0.2558s/iter; left time: 8607.9863s
Epoch: 9 cost time: 90.13554048538208
Epoch: 9, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.085 Vali Acc: 0.668 Test Loss: 1.085 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2652501
	speed: 0.7163s/iter; left time: 23980.2615s
	iters: 200, epoch: 10 | loss: 0.3832271
	speed: 0.2361s/iter; left time: 7879.7591s
	iters: 300, epoch: 10 | loss: 0.0383988
	speed: 0.2305s/iter; left time: 7670.8871s
Epoch: 10 cost time: 88.02345705032349
Epoch: 10, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.187 Vali Acc: 0.659 Test Loss: 1.187 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1926037
	speed: 0.7138s/iter; left time: 23633.6998s
	iters: 200, epoch: 11 | loss: 0.0595873
	speed: 0.2438s/iter; left time: 8049.1277s
	iters: 300, epoch: 11 | loss: 0.3953216
	speed: 0.2256s/iter; left time: 7424.7869s
Epoch: 11 cost time: 88.6836199760437
Epoch: 11, Steps: 369 | Train Loss: 0.214 Vali Loss: 1.160 Vali Acc: 0.671 Test Loss: 1.160 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3496740
	speed: 0.7183s/iter; left time: 23519.1795s
	iters: 200, epoch: 12 | loss: 0.3559927
	speed: 0.2431s/iter; left time: 7934.1917s
	iters: 300, epoch: 12 | loss: 0.0331955
	speed: 0.2293s/iter; left time: 7462.8084s
Epoch: 12 cost time: 87.77772164344788
Epoch: 12, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.261 Vali Acc: 0.667 Test Loss: 1.261 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0796829
	speed: 0.6983s/iter; left time: 22607.4935s
	iters: 200, epoch: 13 | loss: 0.1123335
	speed: 0.2312s/iter; left time: 7460.2870s
	iters: 300, epoch: 13 | loss: 0.2560664
	speed: 0.2394s/iter; left time: 7700.6295s
Epoch: 13 cost time: 88.39033341407776
Epoch: 13, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.360 Vali Acc: 0.661 Test Loss: 1.360 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1863810
	speed: 0.7091s/iter; left time: 22693.6566s
	iters: 200, epoch: 14 | loss: 0.0827027
	speed: 0.2283s/iter; left time: 7283.5631s
	iters: 300, epoch: 14 | loss: 0.0584572
	speed: 0.2280s/iter; left time: 7252.7823s
Epoch: 14 cost time: 86.28638958930969
Epoch: 14, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.454 Vali Acc: 0.660 Test Loss: 1.454 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7045199
	speed: 0.2621s/iter; left time: 9646.7240s
	iters: 200, epoch: 1 | loss: 0.7066630
	speed: 0.2272s/iter; left time: 8340.2650s
	iters: 300, epoch: 1 | loss: 0.6793246
	speed: 0.2410s/iter; left time: 8820.2634s
Epoch: 1 cost time: 89.0021550655365
Epoch: 1, Steps: 369 | Train Loss: 0.713 Vali Loss: 0.699 Vali Acc: 0.551 Test Loss: 0.699 Test Acc: 0.551
Validation loss decreased (inf --> -0.550504).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7162107
	speed: 0.7126s/iter; left time: 25962.4314s
	iters: 200, epoch: 2 | loss: 0.5399080
	speed: 0.2304s/iter; left time: 8371.4288s
	iters: 300, epoch: 2 | loss: 0.4534683
	speed: 0.2337s/iter; left time: 8467.5049s
Epoch: 2 cost time: 85.6448929309845
Epoch: 2, Steps: 369 | Train Loss: 0.597 Vali Loss: 0.680 Vali Acc: 0.658 Test Loss: 0.680 Test Acc: 0.658
Validation loss decreased (-0.550504 --> -0.658336).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3842296
	speed: 0.7122s/iter; left time: 25685.6695s
	iters: 200, epoch: 3 | loss: 0.4955567
	speed: 0.2439s/iter; left time: 8770.4179s
	iters: 300, epoch: 3 | loss: 1.0196264
	speed: 0.2404s/iter; left time: 8620.9349s
Epoch: 3 cost time: 90.02043533325195
Epoch: 3, Steps: 369 | Train Loss: 0.509 Vali Loss: 0.709 Vali Acc: 0.661 Test Loss: 0.709 Test Acc: 0.661
Validation loss decreased (-0.658336 --> -0.660606).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6518516
	speed: 0.7376s/iter; left time: 26327.7247s
	iters: 200, epoch: 4 | loss: 0.3654870
	speed: 0.2379s/iter; left time: 8468.7494s
	iters: 300, epoch: 4 | loss: 0.3509362
	speed: 0.2451s/iter; left time: 8701.0282s
Epoch: 4 cost time: 90.48874568939209
Epoch: 4, Steps: 369 | Train Loss: 0.447 Vali Loss: 0.698 Vali Acc: 0.679 Test Loss: 0.698 Test Acc: 0.679
Validation loss decreased (-0.660606 --> -0.679335).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2953766
	speed: 0.6954s/iter; left time: 24565.4978s
	iters: 200, epoch: 5 | loss: 0.4929948
	speed: 0.2419s/iter; left time: 8521.6219s
	iters: 300, epoch: 5 | loss: 0.4175767
	speed: 0.2460s/iter; left time: 8639.4977s
Epoch: 5 cost time: 89.49162602424622
Epoch: 5, Steps: 369 | Train Loss: 0.409 Vali Loss: 0.767 Vali Acc: 0.660 Test Loss: 0.767 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2875036
	speed: 0.6972s/iter; left time: 24371.4398s
	iters: 200, epoch: 6 | loss: 0.4847991
	speed: 0.2367s/iter; left time: 8249.0937s
	iters: 300, epoch: 6 | loss: 0.6409293
	speed: 0.2234s/iter; left time: 7764.9582s
Epoch: 6 cost time: 84.9794647693634
Epoch: 6, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.864 Vali Acc: 0.666 Test Loss: 0.864 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2394595
	speed: 0.6884s/iter; left time: 23810.7640s
	iters: 200, epoch: 7 | loss: 0.3630979
	speed: 0.2409s/iter; left time: 8306.4378s
	iters: 300, epoch: 7 | loss: 0.1953056
	speed: 0.2338s/iter; left time: 8038.2389s
Epoch: 7 cost time: 86.51531672477722
Epoch: 7, Steps: 369 | Train Loss: 0.325 Vali Loss: 0.859 Vali Acc: 0.673 Test Loss: 0.859 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4344588
	speed: 0.6729s/iter; left time: 23024.0023s
	iters: 200, epoch: 8 | loss: 0.4991752
	speed: 0.2324s/iter; left time: 7928.2442s
	iters: 300, epoch: 8 | loss: 0.3726365
	speed: 0.2312s/iter; left time: 7864.0499s
Epoch: 8 cost time: 85.89610767364502
Epoch: 8, Steps: 369 | Train Loss: 0.299 Vali Loss: 0.948 Vali Acc: 0.664 Test Loss: 0.948 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3061377
	speed: 0.6856s/iter; left time: 23207.0136s
	iters: 200, epoch: 9 | loss: 0.2536423
	speed: 0.2308s/iter; left time: 7790.5515s
	iters: 300, epoch: 9 | loss: 0.3275978
	speed: 0.2381s/iter; left time: 8011.0685s
Epoch: 9 cost time: 86.37415075302124
Epoch: 9, Steps: 369 | Train Loss: 0.268 Vali Loss: 0.963 Vali Acc: 0.682 Test Loss: 0.963 Test Acc: 0.682
Validation loss decreased (-0.679335 --> -0.681602).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3539037
	speed: 0.7187s/iter; left time: 24063.2781s
	iters: 200, epoch: 10 | loss: 0.2150122
	speed: 0.2391s/iter; left time: 7981.2410s
	iters: 300, epoch: 10 | loss: 0.2372747
	speed: 0.2410s/iter; left time: 8021.7946s
Epoch: 10 cost time: 88.314377784729
Epoch: 10, Steps: 369 | Train Loss: 0.253 Vali Loss: 1.069 Vali Acc: 0.670 Test Loss: 1.069 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1933374
	speed: 0.7080s/iter; left time: 23442.6712s
	iters: 200, epoch: 11 | loss: 0.2531786
	speed: 0.2397s/iter; left time: 7911.2894s
	iters: 300, epoch: 11 | loss: 0.3719139
	speed: 0.2318s/iter; left time: 7630.3075s
Epoch: 11 cost time: 87.56470608711243
Epoch: 11, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.129 Vali Acc: 0.661 Test Loss: 1.129 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1228618
	speed: 0.7022s/iter; left time: 22990.5539s
	iters: 200, epoch: 12 | loss: 0.2543277
	speed: 0.2356s/iter; left time: 7689.5345s
	iters: 300, epoch: 12 | loss: 0.0685212
	speed: 0.2266s/iter; left time: 7372.9549s
Epoch: 12 cost time: 86.71387720108032
Epoch: 12, Steps: 369 | Train Loss: 0.201 Vali Loss: 1.190 Vali Acc: 0.666 Test Loss: 1.190 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0719299
	speed: 0.6830s/iter; left time: 22110.2030s
	iters: 200, epoch: 13 | loss: 0.4809497
	speed: 0.2299s/iter; left time: 7419.1112s
	iters: 300, epoch: 13 | loss: 0.3211254
	speed: 0.2260s/iter; left time: 7271.8587s
Epoch: 13 cost time: 84.27448606491089
Epoch: 13, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.294 Vali Acc: 0.659 Test Loss: 1.294 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1806361
	speed: 0.7097s/iter; left time: 22713.8920s
	iters: 200, epoch: 14 | loss: 0.0191610
	speed: 0.2179s/iter; left time: 6951.4117s
	iters: 300, epoch: 14 | loss: 0.1240241
	speed: 0.2358s/iter; left time: 7497.9224s
Epoch: 14 cost time: 85.5869882106781
Epoch: 14, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.401 Vali Acc: 0.666 Test Loss: 1.401 Test Acc: 0.666
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0590299
	speed: 0.7034s/iter; left time: 22252.6078s
	iters: 200, epoch: 15 | loss: 0.1013683
	speed: 0.2332s/iter; left time: 7354.6320s
	iters: 300, epoch: 15 | loss: 0.3253692
	speed: 0.2510s/iter; left time: 7890.4366s
Epoch: 15 cost time: 88.58089709281921
Epoch: 15, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.335 Vali Acc: 0.665 Test Loss: 1.335 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.3273056
	speed: 0.7024s/iter; left time: 21960.8719s
	iters: 200, epoch: 16 | loss: 0.0709775
	speed: 0.2387s/iter; left time: 7439.8820s
	iters: 300, epoch: 16 | loss: 0.0753441
	speed: 0.2385s/iter; left time: 7410.6411s
Epoch: 16 cost time: 87.12672281265259
Epoch: 16, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.439 Vali Acc: 0.658 Test Loss: 1.439 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0315080
	speed: 0.7073s/iter; left time: 21853.9674s
	iters: 200, epoch: 17 | loss: 0.0165402
	speed: 0.2325s/iter; left time: 7161.8327s
	iters: 300, epoch: 17 | loss: 0.3499727
	speed: 0.2436s/iter; left time: 7476.4164s
Epoch: 17 cost time: 86.99829816818237
Epoch: 17, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.569 Vali Acc: 0.660 Test Loss: 1.569 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0352076
	speed: 0.6746s/iter; left time: 20595.3774s
	iters: 200, epoch: 18 | loss: 0.4297342
	speed: 0.2253s/iter; left time: 6856.6767s
	iters: 300, epoch: 18 | loss: 0.0054305
	speed: 0.2301s/iter; left time: 6979.8155s
Epoch: 18 cost time: 83.29055643081665
Epoch: 18, Steps: 369 | Train Loss: 0.127 Vali Loss: 1.578 Vali Acc: 0.668 Test Loss: 1.578 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.2512577
	speed: 0.6703s/iter; left time: 20214.6196s
	iters: 200, epoch: 19 | loss: 0.1210993
	speed: 0.2235s/iter; left time: 6719.3450s
	iters: 300, epoch: 19 | loss: 0.0934669
	speed: 0.2323s/iter; left time: 6959.7568s
Epoch: 19 cost time: 84.1452522277832
Epoch: 19, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.709 Vali Acc: 0.648 Test Loss: 1.709 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6816118047673099
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7201492
	speed: 0.2469s/iter; left time: 9086.6939s
	iters: 200, epoch: 1 | loss: 0.6796407
	speed: 0.2382s/iter; left time: 8741.9668s
	iters: 300, epoch: 1 | loss: 0.6922411
	speed: 0.2462s/iter; left time: 9011.7760s
Epoch: 1 cost time: 89.57154583930969
Epoch: 1, Steps: 369 | Train Loss: 0.724 Vali Loss: 0.710 Vali Acc: 0.537 Test Loss: 0.710 Test Acc: 0.537
Validation loss decreased (inf --> -0.537167).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6367824
	speed: 0.6971s/iter; left time: 25396.8746s
	iters: 200, epoch: 2 | loss: 0.4009804
	speed: 0.2338s/iter; left time: 8494.2565s
	iters: 300, epoch: 2 | loss: 0.4135028
	speed: 0.2320s/iter; left time: 8407.6290s
Epoch: 2 cost time: 85.70805740356445
Epoch: 2, Steps: 369 | Train Loss: 0.615 Vali Loss: 0.674 Vali Acc: 0.661 Test Loss: 0.674 Test Acc: 0.661
Validation loss decreased (-0.537167 --> -0.661174).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4927344
	speed: 0.6897s/iter; left time: 24872.6950s
	iters: 200, epoch: 3 | loss: 0.5348805
	speed: 0.2448s/iter; left time: 8804.2551s
	iters: 300, epoch: 3 | loss: 1.0819875
	speed: 0.2385s/iter; left time: 8554.3415s
Epoch: 3 cost time: 89.09724497795105
Epoch: 3, Steps: 369 | Train Loss: 0.524 Vali Loss: 0.689 Vali Acc: 0.660 Test Loss: 0.689 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4936393
	speed: 0.7210s/iter; left time: 25736.5384s
	iters: 200, epoch: 4 | loss: 0.4972419
	speed: 0.2448s/iter; left time: 8713.5218s
	iters: 300, epoch: 4 | loss: 0.3405355
	speed: 0.2499s/iter; left time: 8870.9449s
Epoch: 4 cost time: 90.00753045082092
Epoch: 4, Steps: 369 | Train Loss: 0.465 Vali Loss: 0.748 Vali Acc: 0.676 Test Loss: 0.748 Test Acc: 0.676
Validation loss decreased (-0.661174 --> -0.676213).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3217423
	speed: 0.7254s/iter; left time: 25624.6727s
	iters: 200, epoch: 5 | loss: 0.5007974
	speed: 0.2320s/iter; left time: 8173.1395s
	iters: 300, epoch: 5 | loss: 0.3943026
	speed: 0.2144s/iter; left time: 7530.3372s
Epoch: 5 cost time: 84.80823397636414
Epoch: 5, Steps: 369 | Train Loss: 0.424 Vali Loss: 0.795 Vali Acc: 0.664 Test Loss: 0.795 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.4389081
	speed: 0.6769s/iter; left time: 23662.4575s
	iters: 200, epoch: 6 | loss: 0.3848229
	speed: 0.2306s/iter; left time: 8036.6217s
	iters: 300, epoch: 6 | loss: 0.6772546
	speed: 0.2369s/iter; left time: 8232.5095s
Epoch: 6 cost time: 85.47797226905823
Epoch: 6, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.836 Vali Acc: 0.650 Test Loss: 0.836 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1787625
	speed: 0.6706s/iter; left time: 23192.7907s
	iters: 200, epoch: 7 | loss: 0.2719525
	speed: 0.2332s/iter; left time: 8040.8096s
	iters: 300, epoch: 7 | loss: 0.2412696
	speed: 0.2232s/iter; left time: 7675.7152s
Epoch: 7 cost time: 84.33969855308533
Epoch: 7, Steps: 369 | Train Loss: 0.341 Vali Loss: 0.898 Vali Acc: 0.671 Test Loss: 0.898 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2636777
	speed: 0.6865s/iter; left time: 23491.1787s
	iters: 200, epoch: 8 | loss: 0.4227992
	speed: 0.2209s/iter; left time: 7534.9780s
	iters: 300, epoch: 8 | loss: 0.3373653
	speed: 0.2186s/iter; left time: 7437.0667s
Epoch: 8 cost time: 81.83435130119324
Epoch: 8, Steps: 369 | Train Loss: 0.316 Vali Loss: 0.914 Vali Acc: 0.680 Test Loss: 0.914 Test Acc: 0.680
Validation loss decreased (-0.676213 --> -0.680468).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5012121
	speed: 0.6566s/iter; left time: 22225.4780s
	iters: 200, epoch: 9 | loss: 0.3121515
	speed: 0.2186s/iter; left time: 7378.6003s
	iters: 300, epoch: 9 | loss: 0.3572604
	speed: 0.2248s/iter; left time: 7564.8898s
Epoch: 9 cost time: 81.30612540245056
Epoch: 9, Steps: 369 | Train Loss: 0.294 Vali Loss: 0.994 Vali Acc: 0.669 Test Loss: 0.994 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2498653
	speed: 0.6720s/iter; left time: 22498.8642s
	iters: 200, epoch: 10 | loss: 0.1370521
	speed: 0.2190s/iter; left time: 7311.3957s
	iters: 300, epoch: 10 | loss: 0.1763852
	speed: 0.2316s/iter; left time: 7707.2242s
Epoch: 10 cost time: 83.77251815795898
Epoch: 10, Steps: 369 | Train Loss: 0.250 Vali Loss: 1.084 Vali Acc: 0.656 Test Loss: 1.084 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1769472
	speed: 0.7083s/iter; left time: 23452.3018s
	iters: 200, epoch: 11 | loss: 0.4754442
	speed: 0.2361s/iter; left time: 7792.3736s
	iters: 300, epoch: 11 | loss: 0.2492147
	speed: 0.2424s/iter; left time: 7977.9967s
Epoch: 11 cost time: 88.15325093269348
Epoch: 11, Steps: 369 | Train Loss: 0.237 Vali Loss: 1.088 Vali Acc: 0.661 Test Loss: 1.088 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1634674
	speed: 0.6846s/iter; left time: 22415.0835s
	iters: 200, epoch: 12 | loss: 0.4225454
	speed: 0.2378s/iter; left time: 7762.4169s
	iters: 300, epoch: 12 | loss: 0.0129587
	speed: 0.2400s/iter; left time: 7809.6253s
Epoch: 12 cost time: 88.54345703125
Epoch: 12, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.258 Vali Acc: 0.646 Test Loss: 1.258 Test Acc: 0.646
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3564200
	speed: 0.7072s/iter; left time: 22895.0711s
	iters: 200, epoch: 13 | loss: 0.0606387
	speed: 0.2180s/iter; left time: 7035.6440s
	iters: 300, epoch: 13 | loss: 0.3118461
	speed: 0.2024s/iter; left time: 6511.8906s
Epoch: 13 cost time: 81.60895323753357
Epoch: 13, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.291 Vali Acc: 0.653 Test Loss: 1.291 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1983427
	speed: 0.6728s/iter; left time: 21533.8502s
	iters: 200, epoch: 14 | loss: 0.1916926
	speed: 0.2324s/iter; left time: 7413.2325s
	iters: 300, epoch: 14 | loss: 0.2551475
	speed: 0.2235s/iter; left time: 7109.1581s
Epoch: 14 cost time: 85.02734756469727
Epoch: 14, Steps: 369 | Train Loss: 0.172 Vali Loss: 1.372 Vali Acc: 0.644 Test Loss: 1.372 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0632891
	speed: 0.6902s/iter; left time: 21834.9959s
	iters: 200, epoch: 15 | loss: 0.0380935
	speed: 0.2101s/iter; left time: 6625.5676s
	iters: 300, epoch: 15 | loss: 0.2962675
	speed: 0.2359s/iter; left time: 7414.5809s
Epoch: 15 cost time: 85.04447913169861
Epoch: 15, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.387 Vali Acc: 0.655 Test Loss: 1.387 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0672638
	speed: 0.6931s/iter; left time: 21671.5782s
	iters: 200, epoch: 16 | loss: 0.1337972
	speed: 0.2303s/iter; left time: 7177.2805s
	iters: 300, epoch: 16 | loss: 0.1162199
	speed: 0.2379s/iter; left time: 7391.3310s
Epoch: 16 cost time: 87.41497683525085
Epoch: 16, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.489 Vali Acc: 0.646 Test Loss: 1.489 Test Acc: 0.646
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1294501
	speed: 0.7133s/iter; left time: 22039.8952s
	iters: 200, epoch: 17 | loss: 0.0994625
	speed: 0.2316s/iter; left time: 7132.7294s
	iters: 300, epoch: 17 | loss: 0.0364385
	speed: 0.2420s/iter; left time: 7427.1762s
Epoch: 17 cost time: 88.59975957870483
Epoch: 17, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.527 Vali Acc: 0.644 Test Loss: 1.527 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1262050
	speed: 0.7089s/iter; left time: 21640.0505s
	iters: 200, epoch: 18 | loss: 0.2859165
	speed: 0.2313s/iter; left time: 7037.5935s
	iters: 300, epoch: 18 | loss: 0.0151227
	speed: 0.2325s/iter; left time: 7051.0099s
Epoch: 18 cost time: 85.29206609725952
Epoch: 18, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.645 Vali Acc: 0.637 Test Loss: 1.645 Test Acc: 0.637
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6804767309875142
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7422582
	speed: 0.2243s/iter; left time: 8252.6507s
	iters: 200, epoch: 1 | loss: 0.7328976
	speed: 0.2265s/iter; left time: 8314.4294s
	iters: 300, epoch: 1 | loss: 0.6703444
	speed: 0.2330s/iter; left time: 8527.3855s
Epoch: 1 cost time: 85.23933362960815
Epoch: 1, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.707 Vali Acc: 0.557 Test Loss: 0.707 Test Acc: 0.557
Validation loss decreased (inf --> -0.557030).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5614695
	speed: 0.6906s/iter; left time: 25161.6110s
	iters: 200, epoch: 2 | loss: 0.4962309
	speed: 0.2259s/iter; left time: 8207.4987s
	iters: 300, epoch: 2 | loss: 0.3919771
	speed: 0.2356s/iter; left time: 8537.9983s
Epoch: 2 cost time: 85.34376192092896
Epoch: 2, Steps: 369 | Train Loss: 0.611 Vali Loss: 0.701 Vali Acc: 0.659 Test Loss: 0.701 Test Acc: 0.659
Validation loss decreased (-0.557030 --> -0.658903).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4380260
	speed: 0.7079s/iter; left time: 25529.9948s
	iters: 200, epoch: 3 | loss: 0.6223857
	speed: 0.2422s/iter; left time: 8708.6851s
	iters: 300, epoch: 3 | loss: 1.0247855
	speed: 0.2567s/iter; left time: 9205.2848s
Epoch: 3 cost time: 91.31072568893433
Epoch: 3, Steps: 369 | Train Loss: 0.528 Vali Loss: 0.693 Vali Acc: 0.658 Test Loss: 0.693 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5987412
	speed: 0.7221s/iter; left time: 25773.4179s
	iters: 200, epoch: 4 | loss: 0.5015615
	speed: 0.2451s/iter; left time: 8725.6916s
	iters: 300, epoch: 4 | loss: 0.3381913
	speed: 0.2368s/iter; left time: 8403.9089s
Epoch: 4 cost time: 92.21347308158875
Epoch: 4, Steps: 369 | Train Loss: 0.472 Vali Loss: 0.776 Vali Acc: 0.669 Test Loss: 0.776 Test Acc: 0.669
Validation loss decreased (-0.658903 --> -0.668834).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3661382
	speed: 0.7379s/iter; left time: 26067.3082s
	iters: 200, epoch: 5 | loss: 0.6077304
	speed: 0.2486s/iter; left time: 8757.4176s
	iters: 300, epoch: 5 | loss: 0.3565655
	speed: 0.2399s/iter; left time: 8426.6399s
Epoch: 5 cost time: 91.10341882705688
Epoch: 5, Steps: 369 | Train Loss: 0.438 Vali Loss: 0.769 Vali Acc: 0.667 Test Loss: 0.769 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2558372
	speed: 0.7228s/iter; left time: 25264.9589s
	iters: 200, epoch: 6 | loss: 0.2428544
	speed: 0.2382s/iter; left time: 8301.4395s
	iters: 300, epoch: 6 | loss: 0.6247391
	speed: 0.2233s/iter; left time: 7761.6966s
Epoch: 6 cost time: 87.64582085609436
Epoch: 6, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.781 Vali Acc: 0.667 Test Loss: 0.781 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2228116
	speed: 0.6892s/iter; left time: 23838.1306s
	iters: 200, epoch: 7 | loss: 0.3639915
	speed: 0.2217s/iter; left time: 7644.2902s
	iters: 300, epoch: 7 | loss: 0.1640972
	speed: 0.2094s/iter; left time: 7199.8676s
Epoch: 7 cost time: 82.50222635269165
Epoch: 7, Steps: 369 | Train Loss: 0.362 Vali Loss: 0.818 Vali Acc: 0.673 Test Loss: 0.818 Test Acc: 0.673
Validation loss decreased (-0.668834 --> -0.673374).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4156872
	speed: 0.6822s/iter; left time: 23344.9879s
	iters: 200, epoch: 8 | loss: 0.3187243
	speed: 0.2379s/iter; left time: 8116.3439s
	iters: 300, epoch: 8 | loss: 0.4235201
	speed: 0.2448s/iter; left time: 8326.2355s
Epoch: 8 cost time: 87.55914878845215
Epoch: 8, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.868 Vali Acc: 0.672 Test Loss: 0.868 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4459923
	speed: 0.7287s/iter; left time: 24664.2741s
	iters: 200, epoch: 9 | loss: 0.3342305
	speed: 0.2424s/iter; left time: 8181.2017s
	iters: 300, epoch: 9 | loss: 0.2330139
	speed: 0.2220s/iter; left time: 7468.4725s
Epoch: 9 cost time: 88.23817443847656
Epoch: 9, Steps: 369 | Train Loss: 0.303 Vali Loss: 0.931 Vali Acc: 0.675 Test Loss: 0.931 Test Acc: 0.675
Validation loss decreased (-0.673374 --> -0.674508).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4515859
	speed: 0.7157s/iter; left time: 23960.5777s
	iters: 200, epoch: 10 | loss: 0.2570217
	speed: 0.2328s/iter; left time: 7770.9624s
	iters: 300, epoch: 10 | loss: 0.1367851
	speed: 0.2325s/iter; left time: 7737.6461s
Epoch: 10 cost time: 85.22963237762451
Epoch: 10, Steps: 369 | Train Loss: 0.275 Vali Loss: 1.004 Vali Acc: 0.675 Test Loss: 1.004 Test Acc: 0.675
Validation loss decreased (-0.674508 --> -0.675075).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1373853
	speed: 0.7253s/iter; left time: 24015.8167s
	iters: 200, epoch: 11 | loss: 0.1634080
	speed: 0.2425s/iter; left time: 8005.9927s
	iters: 300, epoch: 11 | loss: 0.3276127
	speed: 0.2480s/iter; left time: 8163.3030s
Epoch: 11 cost time: 90.04002952575684
Epoch: 11, Steps: 369 | Train Loss: 0.232 Vali Loss: 1.097 Vali Acc: 0.666 Test Loss: 1.097 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2094631
	speed: 0.7491s/iter; left time: 24527.5349s
	iters: 200, epoch: 12 | loss: 0.2232191
	speed: 0.2351s/iter; left time: 7675.3510s
	iters: 300, epoch: 12 | loss: 0.0990011
	speed: 0.2311s/iter; left time: 7518.8795s
Epoch: 12 cost time: 87.06757140159607
Epoch: 12, Steps: 369 | Train Loss: 0.223 Vali Loss: 1.135 Vali Acc: 0.661 Test Loss: 1.135 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3776136
	speed: 0.6862s/iter; left time: 22213.7738s
	iters: 200, epoch: 13 | loss: 0.1143479
	speed: 0.2260s/iter; left time: 7292.7656s
	iters: 300, epoch: 13 | loss: 0.2654757
	speed: 0.2241s/iter; left time: 7211.4542s
Epoch: 13 cost time: 83.09083986282349
Epoch: 13, Steps: 369 | Train Loss: 0.188 Vali Loss: 1.264 Vali Acc: 0.661 Test Loss: 1.264 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.1581759
	speed: 0.6972s/iter; left time: 22313.3422s
	iters: 200, epoch: 14 | loss: 0.0471131
	speed: 0.2238s/iter; left time: 7139.0887s
	iters: 300, epoch: 14 | loss: 0.1203575
	speed: 0.2318s/iter; left time: 7371.7439s
Epoch: 14 cost time: 84.2027575969696
Epoch: 14, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.338 Vali Acc: 0.658 Test Loss: 1.338 Test Acc: 0.658
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0415108
	speed: 0.7258s/iter; left time: 22959.2210s
	iters: 200, epoch: 15 | loss: 0.0348324
	speed: 0.2352s/iter; left time: 7416.7190s
	iters: 300, epoch: 15 | loss: 0.0560105
	speed: 0.2381s/iter; left time: 7484.8747s
Epoch: 15 cost time: 86.5806086063385
Epoch: 15, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.290 Vali Acc: 0.650 Test Loss: 1.290 Test Acc: 0.650
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0757046
	speed: 0.7389s/iter; left time: 23102.4995s
	iters: 200, epoch: 16 | loss: 0.1972534
	speed: 0.2466s/iter; left time: 7686.5923s
	iters: 300, epoch: 16 | loss: 0.1532937
	speed: 0.2391s/iter; left time: 7427.4714s
Epoch: 16 cost time: 88.90588283538818
Epoch: 16, Steps: 369 | Train Loss: 0.162 Vali Loss: 1.498 Vali Acc: 0.644 Test Loss: 1.498 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0172574
	speed: 0.7087s/iter; left time: 21896.1254s
	iters: 200, epoch: 17 | loss: 0.0253389
	speed: 0.2326s/iter; left time: 7163.0356s
	iters: 300, epoch: 17 | loss: 0.0218089
	speed: 0.2367s/iter; left time: 7266.5498s
Epoch: 17 cost time: 86.11828112602234
Epoch: 17, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.457 Vali Acc: 0.667 Test Loss: 1.457 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0711546
	speed: 0.7188s/iter; left time: 21943.2871s
	iters: 200, epoch: 18 | loss: 0.1610381
	speed: 0.2307s/iter; left time: 7020.7884s
	iters: 300, epoch: 18 | loss: 0.0100136
	speed: 0.2321s/iter; left time: 7039.3982s
Epoch: 18 cost time: 85.79105877876282
Epoch: 18, Steps: 369 | Train Loss: 0.132 Vali Loss: 1.499 Vali Acc: 0.654 Test Loss: 1.499 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2533788
	speed: 0.7106s/iter; left time: 21431.1864s
	iters: 200, epoch: 19 | loss: 0.1078575
	speed: 0.2185s/iter; left time: 6567.7856s
	iters: 300, epoch: 19 | loss: 0.1858056
	speed: 0.2280s/iter; left time: 6829.6149s
Epoch: 19 cost time: 84.04859852790833
Epoch: 19, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.620 Vali Acc: 0.646 Test Loss: 1.620 Test Acc: 0.646
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1394719
	speed: 0.6894s/iter; left time: 20538.2904s
	iters: 200, epoch: 20 | loss: 0.0320489
	speed: 0.2239s/iter; left time: 6647.0236s
	iters: 300, epoch: 20 | loss: 0.1889712
	speed: 0.2203s/iter; left time: 6517.4059s
Epoch: 20 cost time: 83.13891959190369
Epoch: 20, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.783 Vali Acc: 0.663 Test Loss: 1.783 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6750851305334846
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6951941
	speed: 0.2507s/iter; left time: 9227.5902s
	iters: 200, epoch: 1 | loss: 0.6931590
	speed: 0.2505s/iter; left time: 9191.9690s
	iters: 300, epoch: 1 | loss: 0.6926597
	speed: 0.2517s/iter; left time: 9211.8463s
Epoch: 1 cost time: 92.38140726089478
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6939313
	speed: 0.7133s/iter; left time: 25988.2910s
	iters: 200, epoch: 2 | loss: 0.6940149
	speed: 0.2374s/iter; left time: 8626.6137s
	iters: 300, epoch: 2 | loss: 0.6926894
	speed: 0.2342s/iter; left time: 8486.8735s
Epoch: 2 cost time: 87.55309796333313
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6931524
	speed: 0.7081s/iter; left time: 25535.3408s
	iters: 200, epoch: 3 | loss: 0.6931472
	speed: 0.2277s/iter; left time: 8188.2272s
	iters: 300, epoch: 3 | loss: 0.6930555
	speed: 0.2217s/iter; left time: 7950.0736s
Epoch: 3 cost time: 83.5644166469574
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6952121
	speed: 0.7126s/iter; left time: 25436.3176s
	iters: 200, epoch: 4 | loss: 0.6941088
	speed: 0.2309s/iter; left time: 8219.4395s
	iters: 300, epoch: 4 | loss: 0.6985441
	speed: 0.2300s/iter; left time: 8162.3304s
Epoch: 4 cost time: 85.26679992675781
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6927867
	speed: 0.7128s/iter; left time: 25177.9188s
	iters: 200, epoch: 5 | loss: 0.6945078
	speed: 0.2272s/iter; left time: 8001.3924s
	iters: 300, epoch: 5 | loss: 0.6931481
	speed: 0.2200s/iter; left time: 7727.5124s
Epoch: 5 cost time: 83.71274971961975
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6923504
	speed: 0.6815s/iter; left time: 23821.7873s
	iters: 200, epoch: 6 | loss: 0.6910850
	speed: 0.2223s/iter; left time: 7749.1668s
	iters: 300, epoch: 6 | loss: 0.6923468
	speed: 0.2154s/iter; left time: 7488.1439s
Epoch: 6 cost time: 80.70695686340332
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6933252
	speed: 0.6832s/iter; left time: 23629.7341s
	iters: 200, epoch: 7 | loss: 0.6923138
	speed: 0.2259s/iter; left time: 7790.9656s
	iters: 300, epoch: 7 | loss: 0.6931604
	speed: 0.2267s/iter; left time: 7794.9375s
Epoch: 7 cost time: 83.19657874107361
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6931558
	speed: 0.6932s/iter; left time: 23720.4697s
	iters: 200, epoch: 8 | loss: 0.6938069
	speed: 0.2275s/iter; left time: 7761.2035s
	iters: 300, epoch: 8 | loss: 0.6928359
	speed: 0.2357s/iter; left time: 8019.6008s
Epoch: 8 cost time: 85.08387470245361
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6916961
	speed: 0.7187s/iter; left time: 24325.9125s
	iters: 200, epoch: 9 | loss: 0.6939732
	speed: 0.2296s/iter; left time: 7749.5582s
	iters: 300, epoch: 9 | loss: 0.6940149
	speed: 0.2370s/iter; left time: 7974.9431s
Epoch: 9 cost time: 86.2176308631897
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6907335
	speed: 0.7110s/iter; left time: 23803.0272s
	iters: 200, epoch: 10 | loss: 0.6947455
	speed: 0.2308s/iter; left time: 7704.4570s
	iters: 300, epoch: 10 | loss: 0.6930765
	speed: 0.2300s/iter; left time: 7654.2263s
Epoch: 10 cost time: 85.97998452186584
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6941418
	speed: 0.7030s/iter; left time: 23276.2619s
	iters: 200, epoch: 11 | loss: 0.6950810
	speed: 0.2286s/iter; left time: 7545.4776s
	iters: 300, epoch: 11 | loss: 0.6948783
	speed: 0.2300s/iter; left time: 7569.0350s
Epoch: 11 cost time: 84.60926723480225
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6949437
	speed: 0.6843s/iter; left time: 22405.0758s
	iters: 200, epoch: 12 | loss: 0.6931594
	speed: 0.2274s/iter; left time: 7423.6659s
	iters: 300, epoch: 12 | loss: 0.6933081
	speed: 0.2211s/iter; left time: 7195.0173s
Epoch: 12 cost time: 81.84329867362976
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6936640
	speed: 0.6863s/iter; left time: 22217.1185s
	iters: 200, epoch: 13 | loss: 0.6945186
	speed: 0.2323s/iter; left time: 7497.9596s
	iters: 300, epoch: 13 | loss: 0.6930938
	speed: 0.2309s/iter; left time: 7427.9294s
Epoch: 13 cost time: 85.94919490814209
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6909590
	speed: 0.7210s/iter; left time: 23073.9358s
	iters: 200, epoch: 14 | loss: 0.6942411
	speed: 0.2479s/iter; left time: 7908.0822s
	iters: 300, epoch: 14 | loss: 0.6934002
	speed: 0.2477s/iter; left time: 7877.6900s
Epoch: 14 cost time: 89.47661542892456
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6925070
	speed: 0.7387s/iter; left time: 23367.3916s
	iters: 200, epoch: 15 | loss: 0.6937559
	speed: 0.2393s/iter; left time: 7545.0253s
	iters: 300, epoch: 15 | loss: 0.6931577
	speed: 0.2373s/iter; left time: 7460.4882s
Epoch: 15 cost time: 89.31228542327881
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.6921635
	speed: 0.7362s/iter; left time: 23017.2268s
	iters: 200, epoch: 16 | loss: 0.6932097
	speed: 0.2381s/iter; left time: 7419.6763s
	iters: 300, epoch: 16 | loss: 0.6939769
	speed: 0.2357s/iter; left time: 7322.7312s
Epoch: 16 cost time: 88.08761811256409
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6931732
	speed: 0.7213s/iter; left time: 22286.3806s
	iters: 200, epoch: 17 | loss: 0.6936555
	speed: 0.2301s/iter; left time: 7086.6838s
	iters: 300, epoch: 17 | loss: 0.6931500
	speed: 0.2346s/iter; left time: 7201.8764s
Epoch: 17 cost time: 86.6301486492157
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.6926783
	speed: 0.7208s/iter; left time: 22003.1244s
	iters: 200, epoch: 18 | loss: 0.6927131
	speed: 0.2335s/iter; left time: 7103.6346s
	iters: 300, epoch: 18 | loss: 0.6936655
	speed: 0.2294s/iter; left time: 6956.4992s
Epoch: 18 cost time: 85.86539578437805
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.6931524
	speed: 0.6855s/iter; left time: 20673.1550s
	iters: 200, epoch: 19 | loss: 0.6927794
	speed: 0.2228s/iter; left time: 6696.0766s
	iters: 300, epoch: 19 | loss: 0.6935877
	speed: 0.2256s/iter; left time: 6758.5153s
Epoch: 19 cost time: 84.51492738723755
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.6928784
	speed: 0.7032s/iter; left time: 20948.9846s
	iters: 200, epoch: 20 | loss: 0.6931479
	speed: 0.2332s/iter; left time: 6924.2096s
	iters: 300, epoch: 20 | loss: 0.6931571
	speed: 0.2406s/iter; left time: 7120.7364s
Epoch: 20 cost time: 87.08084654808044
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 247970
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7168835
	speed: 0.2690s/iter; left time: 9900.1257s
	iters: 200, epoch: 1 | loss: 0.7117786
	speed: 0.2498s/iter; left time: 9167.7054s
	iters: 300, epoch: 1 | loss: 0.5812826
	speed: 0.2459s/iter; left time: 8999.3639s
Epoch: 1 cost time: 92.39800763130188
Epoch: 1, Steps: 369 | Train Loss: 0.674 Vali Loss: 0.669 Vali Acc: 0.613 Test Loss: 0.669 Test Acc: 0.613
Validation loss decreased (inf --> -0.612933).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3451288
	speed: 0.7274s/iter; left time: 26500.3916s
	iters: 200, epoch: 2 | loss: 0.5173942
	speed: 0.2454s/iter; left time: 8916.6195s
	iters: 300, epoch: 2 | loss: 0.3816200
	speed: 0.2362s/iter; left time: 8557.6929s
Epoch: 2 cost time: 88.84409785270691
Epoch: 2, Steps: 369 | Train Loss: 0.555 Vali Loss: 0.692 Vali Acc: 0.649 Test Loss: 0.692 Test Acc: 0.649
Validation loss decreased (-0.612933 --> -0.648972).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6706758
	speed: 0.7323s/iter; left time: 26408.8015s
	iters: 200, epoch: 3 | loss: 0.4604722
	speed: 0.2357s/iter; left time: 8478.0386s
	iters: 300, epoch: 3 | loss: 0.8652839
	speed: 0.2406s/iter; left time: 8629.7224s
Epoch: 3 cost time: 87.62075281143188
Epoch: 3, Steps: 369 | Train Loss: 0.478 Vali Loss: 0.734 Vali Acc: 0.661 Test Loss: 0.734 Test Acc: 0.661
Validation loss decreased (-0.648972 --> -0.660889).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4767140
	speed: 0.7327s/iter; left time: 26153.8597s
	iters: 200, epoch: 4 | loss: 0.3690637
	speed: 0.2442s/iter; left time: 8690.8028s
	iters: 300, epoch: 4 | loss: 0.5809994
	speed: 0.2471s/iter; left time: 8771.5946s
Epoch: 4 cost time: 91.18099212646484
Epoch: 4, Steps: 369 | Train Loss: 0.421 Vali Loss: 0.733 Vali Acc: 0.666 Test Loss: 0.733 Test Acc: 0.666
Validation loss decreased (-0.660889 --> -0.665997).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2510702
	speed: 0.7185s/iter; left time: 25381.3053s
	iters: 200, epoch: 5 | loss: 0.2253950
	speed: 0.2544s/iter; left time: 8961.9715s
	iters: 300, epoch: 5 | loss: 0.3479028
	speed: 0.2401s/iter; left time: 8431.8570s
Epoch: 5 cost time: 90.03040075302124
Epoch: 5, Steps: 369 | Train Loss: 0.366 Vali Loss: 0.786 Vali Acc: 0.667 Test Loss: 0.786 Test Acc: 0.667
Validation loss decreased (-0.665997 --> -0.667416).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3535861
	speed: 0.7350s/iter; left time: 25692.9910s
	iters: 200, epoch: 6 | loss: 0.3749123
	speed: 0.2457s/iter; left time: 8562.7704s
	iters: 300, epoch: 6 | loss: 0.2377743
	speed: 0.2545s/iter; left time: 8844.2542s
Epoch: 6 cost time: 92.47341775894165
Epoch: 6, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.832 Vali Acc: 0.672 Test Loss: 0.832 Test Acc: 0.672
Validation loss decreased (-0.667416 --> -0.671955).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2735022
	speed: 0.7616s/iter; left time: 26342.9576s
	iters: 200, epoch: 7 | loss: 0.3933763
	speed: 0.2414s/iter; left time: 8324.4241s
	iters: 300, epoch: 7 | loss: 0.6385409
	speed: 0.2513s/iter; left time: 8643.0899s
Epoch: 7 cost time: 92.58039426803589
Epoch: 7, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.897 Vali Acc: 0.678 Test Loss: 0.897 Test Acc: 0.678
Validation loss decreased (-0.671955 --> -0.678198).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2729047
	speed: 0.7505s/iter; left time: 25679.8583s
	iters: 200, epoch: 8 | loss: 0.1642887
	speed: 0.2556s/iter; left time: 8719.5033s
	iters: 300, epoch: 8 | loss: 0.2381465
	speed: 0.2352s/iter; left time: 8000.7123s
Epoch: 8 cost time: 91.94693040847778
Epoch: 8, Steps: 369 | Train Loss: 0.257 Vali Loss: 0.973 Vali Acc: 0.670 Test Loss: 0.973 Test Acc: 0.670
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2609170
	speed: 0.7723s/iter; left time: 26142.8172s
	iters: 200, epoch: 9 | loss: 0.0659680
	speed: 0.2367s/iter; left time: 7988.5784s
	iters: 300, epoch: 9 | loss: 0.1357312
	speed: 0.2438s/iter; left time: 8204.4902s
Epoch: 9 cost time: 91.75814652442932
Epoch: 9, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.136 Vali Acc: 0.658 Test Loss: 1.136 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0555279
	speed: 0.7274s/iter; left time: 24353.9336s
	iters: 200, epoch: 10 | loss: 0.2819877
	speed: 0.2431s/iter; left time: 8113.7768s
	iters: 300, epoch: 10 | loss: 0.1506716
	speed: 0.2590s/iter; left time: 8619.6581s
Epoch: 10 cost time: 91.20400762557983
Epoch: 10, Steps: 369 | Train Loss: 0.192 Vali Loss: 1.115 Vali Acc: 0.657 Test Loss: 1.115 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2377535
	speed: 0.7335s/iter; left time: 24288.4474s
	iters: 200, epoch: 11 | loss: 0.0420732
	speed: 0.2392s/iter; left time: 7896.0706s
	iters: 300, epoch: 11 | loss: 0.2168613
	speed: 0.2330s/iter; left time: 7667.7787s
Epoch: 11 cost time: 89.5496518611908
Epoch: 11, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.279 Vali Acc: 0.667 Test Loss: 1.279 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1629820
	speed: 0.7440s/iter; left time: 24361.4465s
	iters: 200, epoch: 12 | loss: 0.1959222
	speed: 0.2445s/iter; left time: 7980.5475s
	iters: 300, epoch: 12 | loss: 0.0918594
	speed: 0.2433s/iter; left time: 7918.5109s
Epoch: 12 cost time: 92.27418327331543
Epoch: 12, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.337 Vali Acc: 0.662 Test Loss: 1.337 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0434429
	speed: 0.7531s/iter; left time: 24381.0082s
	iters: 200, epoch: 13 | loss: 0.0536195
	speed: 0.2470s/iter; left time: 7970.5962s
	iters: 300, epoch: 13 | loss: 0.0625083
	speed: 0.2641s/iter; left time: 8495.9534s
Epoch: 13 cost time: 94.73850846290588
Epoch: 13, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.418 Vali Acc: 0.662 Test Loss: 1.418 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1238651
	speed: 0.7699s/iter; left time: 24640.6318s
	iters: 200, epoch: 14 | loss: 0.2387471
	speed: 0.2406s/iter; left time: 7676.5684s
	iters: 300, epoch: 14 | loss: 0.1324583
	speed: 0.2507s/iter; left time: 7972.0077s
Epoch: 14 cost time: 92.82554650306702
Epoch: 14, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.494 Vali Acc: 0.672 Test Loss: 1.494 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0692764
	speed: 0.7472s/iter; left time: 23637.5417s
	iters: 200, epoch: 15 | loss: 0.0098561
	speed: 0.2513s/iter; left time: 7924.7196s
	iters: 300, epoch: 15 | loss: 0.0253313
	speed: 0.2569s/iter; left time: 8076.1173s
Epoch: 15 cost time: 93.76197648048401
Epoch: 15, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.521 Vali Acc: 0.655 Test Loss: 1.521 Test Acc: 0.655
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.4638884
	speed: 0.7632s/iter; left time: 23862.9177s
	iters: 200, epoch: 16 | loss: 0.1027778
	speed: 0.2668s/iter; left time: 8314.9467s
	iters: 300, epoch: 16 | loss: 0.0565764
	speed: 0.2466s/iter; left time: 7659.7904s
Epoch: 16 cost time: 95.62489342689514
Epoch: 16, Steps: 369 | Train Loss: 0.126 Vali Loss: 1.573 Vali Acc: 0.666 Test Loss: 1.573 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0711047
	speed: 0.7558s/iter; left time: 23351.2886s
	iters: 200, epoch: 17 | loss: 0.0104834
	speed: 0.2297s/iter; left time: 7075.2597s
	iters: 300, epoch: 17 | loss: 0.1267135
	speed: 0.2318s/iter; left time: 7116.8931s
Epoch: 17 cost time: 88.17791604995728
Epoch: 17, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.571 Vali Acc: 0.677 Test Loss: 1.571 Test Acc: 0.677
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7422333
	speed: 0.2649s/iter; left time: 9748.0278s
	iters: 200, epoch: 1 | loss: 0.7018475
	speed: 0.2476s/iter; left time: 9085.9362s
	iters: 300, epoch: 1 | loss: 0.6090543
	speed: 0.2623s/iter; left time: 9600.4538s
Epoch: 1 cost time: 95.60430145263672
Epoch: 1, Steps: 369 | Train Loss: 0.687 Vali Loss: 0.685 Vali Acc: 0.594 Test Loss: 0.685 Test Acc: 0.594
Validation loss decreased (inf --> -0.593637).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3258764
	speed: 0.7800s/iter; left time: 28417.7669s
	iters: 200, epoch: 2 | loss: 0.4896851
	speed: 0.2607s/iter; left time: 9472.0776s
	iters: 300, epoch: 2 | loss: 0.3880779
	speed: 0.2500s/iter; left time: 9059.6345s
Epoch: 2 cost time: 94.61867356300354
Epoch: 2, Steps: 369 | Train Loss: 0.556 Vali Loss: 0.699 Vali Acc: 0.646 Test Loss: 0.699 Test Acc: 0.646
Validation loss decreased (-0.593637 --> -0.645566).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6788510
	speed: 0.7307s/iter; left time: 26352.0658s
	iters: 200, epoch: 3 | loss: 0.4449835
	speed: 0.2670s/iter; left time: 9602.6945s
	iters: 300, epoch: 3 | loss: 0.8737146
	speed: 0.2489s/iter; left time: 8927.3720s
Epoch: 3 cost time: 93.52160429954529
Epoch: 3, Steps: 369 | Train Loss: 0.474 Vali Loss: 0.769 Vali Acc: 0.649 Test Loss: 0.769 Test Acc: 0.649
Validation loss decreased (-0.645566 --> -0.649255).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4584848
	speed: 0.7308s/iter; left time: 26084.6494s
	iters: 200, epoch: 4 | loss: 0.2706475
	speed: 0.2387s/iter; left time: 8495.7310s
	iters: 300, epoch: 4 | loss: 0.5986320
	speed: 0.2352s/iter; left time: 8349.6195s
Epoch: 4 cost time: 88.43712902069092
Epoch: 4, Steps: 369 | Train Loss: 0.414 Vali Loss: 0.737 Vali Acc: 0.667 Test Loss: 0.737 Test Acc: 0.667
Validation loss decreased (-0.649255 --> -0.666565).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2920179
	speed: 0.7552s/iter; left time: 26678.3174s
	iters: 200, epoch: 5 | loss: 0.1492494
	speed: 0.2431s/iter; left time: 8564.6406s
	iters: 300, epoch: 5 | loss: 0.3684022
	speed: 0.2290s/iter; left time: 8043.7120s
Epoch: 5 cost time: 90.01056814193726
Epoch: 5, Steps: 369 | Train Loss: 0.359 Vali Loss: 0.802 Vali Acc: 0.664 Test Loss: 0.802 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3348947
	speed: 0.7318s/iter; left time: 25581.0872s
	iters: 200, epoch: 6 | loss: 0.2263369
	speed: 0.2498s/iter; left time: 8708.5217s
	iters: 300, epoch: 6 | loss: 0.2771177
	speed: 0.2456s/iter; left time: 8536.9027s
Epoch: 6 cost time: 91.5187394618988
Epoch: 6, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.878 Vali Acc: 0.665 Test Loss: 0.878 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3015698
	speed: 0.7240s/iter; left time: 25040.3095s
	iters: 200, epoch: 7 | loss: 0.3797681
	speed: 0.2403s/iter; left time: 8287.0158s
	iters: 300, epoch: 7 | loss: 0.2994470
	speed: 0.2361s/iter; left time: 8118.8374s
Epoch: 7 cost time: 87.88682699203491
Epoch: 7, Steps: 369 | Train Loss: 0.280 Vali Loss: 0.951 Vali Acc: 0.666 Test Loss: 0.951 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2750005
	speed: 0.7477s/iter; left time: 25584.1203s
	iters: 200, epoch: 8 | loss: 0.1683784
	speed: 0.2613s/iter; left time: 8915.4907s
	iters: 300, epoch: 8 | loss: 0.1695464
	speed: 0.2556s/iter; left time: 8696.2071s
Epoch: 8 cost time: 93.07736825942993
Epoch: 8, Steps: 369 | Train Loss: 0.252 Vali Loss: 1.007 Vali Acc: 0.666 Test Loss: 1.007 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1672310
	speed: 0.7459s/iter; left time: 25247.1515s
	iters: 200, epoch: 9 | loss: 0.1234357
	speed: 0.2458s/iter; left time: 8293.8193s
	iters: 300, epoch: 9 | loss: 0.0616406
	speed: 0.2494s/iter; left time: 8390.4662s
Epoch: 9 cost time: 92.34858393669128
Epoch: 9, Steps: 369 | Train Loss: 0.226 Vali Loss: 1.054 Vali Acc: 0.658 Test Loss: 1.054 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1728858
	speed: 0.7698s/iter; left time: 25771.3272s
	iters: 200, epoch: 10 | loss: 0.2500989
	speed: 0.2394s/iter; left time: 7991.9649s
	iters: 300, epoch: 10 | loss: 0.1444385
	speed: 0.2556s/iter; left time: 8504.8615s
Epoch: 10 cost time: 90.61210322380066
Epoch: 10, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.200 Vali Acc: 0.638 Test Loss: 1.200 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1015401
	speed: 0.7175s/iter; left time: 23757.7669s
	iters: 200, epoch: 11 | loss: 0.1074972
	speed: 0.2284s/iter; left time: 7538.2962s
	iters: 300, epoch: 11 | loss: 0.2465142
	speed: 0.2326s/iter; left time: 7655.7474s
Epoch: 11 cost time: 85.97772765159607
Epoch: 11, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.250 Vali Acc: 0.675 Test Loss: 1.250 Test Acc: 0.675
Validation loss decreased (-0.666565 --> -0.674789).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5022314
	speed: 0.7255s/iter; left time: 23755.0945s
	iters: 200, epoch: 12 | loss: 0.4483144
	speed: 0.2494s/iter; left time: 8139.8805s
	iters: 300, epoch: 12 | loss: 0.1923874
	speed: 0.2484s/iter; left time: 8083.0166s
Epoch: 12 cost time: 91.19406604766846
Epoch: 12, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.282 Vali Acc: 0.659 Test Loss: 1.282 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1773707
	speed: 0.7707s/iter; left time: 24951.0007s
	iters: 200, epoch: 13 | loss: 0.0519185
	speed: 0.2603s/iter; left time: 8400.8299s
	iters: 300, epoch: 13 | loss: 0.0208672
	speed: 0.2457s/iter; left time: 7904.2878s
Epoch: 13 cost time: 94.22332811355591
Epoch: 13, Steps: 369 | Train Loss: 0.152 Vali Loss: 1.371 Vali Acc: 0.656 Test Loss: 1.371 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1018032
	speed: 0.7597s/iter; left time: 24314.4673s
	iters: 200, epoch: 14 | loss: 0.2764840
	speed: 0.2357s/iter; left time: 7520.6449s
	iters: 300, epoch: 14 | loss: 0.1011801
	speed: 0.2408s/iter; left time: 7658.7931s
Epoch: 14 cost time: 88.98983311653137
Epoch: 14, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.484 Vali Acc: 0.666 Test Loss: 1.484 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1586332
	speed: 0.7228s/iter; left time: 22865.7128s
	iters: 200, epoch: 15 | loss: 0.0917181
	speed: 0.2381s/iter; left time: 7509.6615s
	iters: 300, epoch: 15 | loss: 0.1957982
	speed: 0.2361s/iter; left time: 7423.3047s
Epoch: 15 cost time: 87.75016117095947
Epoch: 15, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.596 Vali Acc: 0.650 Test Loss: 1.596 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1284445
	speed: 0.7599s/iter; left time: 23758.9031s
	iters: 200, epoch: 16 | loss: 0.0220697
	speed: 0.2566s/iter; left time: 7996.0886s
	iters: 300, epoch: 16 | loss: 0.1685660
	speed: 0.2658s/iter; left time: 8257.3219s
Epoch: 16 cost time: 96.61856245994568
Epoch: 16, Steps: 369 | Train Loss: 0.106 Vali Loss: 1.664 Vali Acc: 0.642 Test Loss: 1.664 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3566375
	speed: 0.8069s/iter; left time: 24931.9367s
	iters: 200, epoch: 17 | loss: 0.2639754
	speed: 0.2433s/iter; left time: 7492.4690s
	iters: 300, epoch: 17 | loss: 0.1577229
	speed: 0.2469s/iter; left time: 7578.7584s
Epoch: 17 cost time: 92.34259104728699
Epoch: 17, Steps: 369 | Train Loss: 0.137 Vali Loss: 1.593 Vali Acc: 0.662 Test Loss: 1.593 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0083711
	speed: 0.7617s/iter; left time: 23251.8056s
	iters: 200, epoch: 18 | loss: 0.2449165
	speed: 0.2516s/iter; left time: 7654.5475s
	iters: 300, epoch: 18 | loss: 0.0669760
	speed: 0.2564s/iter; left time: 7776.6621s
Epoch: 18 cost time: 93.68976712226868
Epoch: 18, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.762 Vali Acc: 0.643 Test Loss: 1.762 Test Acc: 0.643
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0193416
	speed: 0.7576s/iter; left time: 22847.6354s
	iters: 200, epoch: 19 | loss: 0.1794913
	speed: 0.2504s/iter; left time: 7526.4210s
	iters: 300, epoch: 19 | loss: 0.5188832
	speed: 0.2518s/iter; left time: 7544.2427s
Epoch: 19 cost time: 94.82880115509033
Epoch: 19, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.775 Vali Acc: 0.648 Test Loss: 1.775 Test Acc: 0.648
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0176318
	speed: 0.8254s/iter; left time: 24588.4175s
	iters: 200, epoch: 20 | loss: 0.2211546
	speed: 0.2668s/iter; left time: 7921.4764s
	iters: 300, epoch: 20 | loss: 0.0653748
	speed: 0.2548s/iter; left time: 7539.1165s
Epoch: 20 cost time: 96.91839408874512
Epoch: 20, Steps: 369 | Train Loss: 0.097 Vali Loss: 1.894 Vali Acc: 0.660 Test Loss: 1.894 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0691544
	speed: 0.7714s/iter; left time: 22695.5160s
	iters: 200, epoch: 21 | loss: 0.0855589
	speed: 0.2588s/iter; left time: 7588.9130s
	iters: 300, epoch: 21 | loss: 0.1234006
	speed: 0.2408s/iter; left time: 7036.3932s
Epoch: 21 cost time: 92.29452133178711
Epoch: 21, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.920 Vali Acc: 0.652 Test Loss: 1.920 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6748013620885358
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7679924
	speed: 0.2835s/iter; left time: 10431.3607s
	iters: 200, epoch: 1 | loss: 0.7474726
	speed: 0.2681s/iter; left time: 9838.8368s
	iters: 300, epoch: 1 | loss: 0.6043810
	speed: 0.2816s/iter; left time: 10306.5968s
Epoch: 1 cost time: 101.1469132900238
Epoch: 1, Steps: 369 | Train Loss: 0.692 Vali Loss: 0.684 Vali Acc: 0.593 Test Loss: 0.684 Test Acc: 0.593
Validation loss decreased (inf --> -0.592785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4198868
	speed: 0.7639s/iter; left time: 27831.7471s
	iters: 200, epoch: 2 | loss: 0.5787105
	speed: 0.2569s/iter; left time: 9334.2981s
	iters: 300, epoch: 2 | loss: 0.3975962
	speed: 0.2450s/iter; left time: 8877.4936s
Epoch: 2 cost time: 90.6834306716919
Epoch: 2, Steps: 369 | Train Loss: 0.560 Vali Loss: 0.715 Vali Acc: 0.636 Test Loss: 0.715 Test Acc: 0.636
Validation loss decreased (-0.592785 --> -0.635634).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7515259
	speed: 0.7357s/iter; left time: 26532.6826s
	iters: 200, epoch: 3 | loss: 0.4802321
	speed: 0.2398s/iter; left time: 8623.9410s
	iters: 300, epoch: 3 | loss: 0.8323876
	speed: 0.2465s/iter; left time: 8839.1590s
Epoch: 3 cost time: 90.42716908454895
Epoch: 3, Steps: 369 | Train Loss: 0.477 Vali Loss: 0.753 Vali Acc: 0.657 Test Loss: 0.753 Test Acc: 0.657
Validation loss decreased (-0.635634 --> -0.657484).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4038177
	speed: 0.7699s/iter; left time: 27481.2735s
	iters: 200, epoch: 4 | loss: 0.3238016
	speed: 0.2488s/iter; left time: 8856.5829s
	iters: 300, epoch: 4 | loss: 0.5910809
	speed: 0.2392s/iter; left time: 8491.5283s
Epoch: 4 cost time: 94.06593799591064
Epoch: 4, Steps: 369 | Train Loss: 0.418 Vali Loss: 0.725 Vali Acc: 0.661 Test Loss: 0.725 Test Acc: 0.661
Validation loss decreased (-0.657484 --> -0.660889).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1814101
	speed: 0.7737s/iter; left time: 27329.2140s
	iters: 200, epoch: 5 | loss: 0.2406946
	speed: 0.2497s/iter; left time: 8796.3528s
	iters: 300, epoch: 5 | loss: 0.3573140
	speed: 0.2683s/iter; left time: 9423.6125s
Epoch: 5 cost time: 93.29639863967896
Epoch: 5, Steps: 369 | Train Loss: 0.365 Vali Loss: 0.793 Vali Acc: 0.652 Test Loss: 0.793 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2874126
	speed: 0.7452s/iter; left time: 26050.5387s
	iters: 200, epoch: 6 | loss: 0.2675860
	speed: 0.2348s/iter; left time: 8184.6760s
	iters: 300, epoch: 6 | loss: 0.3347794
	speed: 0.2308s/iter; left time: 8022.6235s
Epoch: 6 cost time: 87.88083624839783
Epoch: 6, Steps: 369 | Train Loss: 0.334 Vali Loss: 0.830 Vali Acc: 0.661 Test Loss: 0.830 Test Acc: 0.661
Validation loss decreased (-0.660889 --> -0.661456).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4362058
	speed: 0.7257s/iter; left time: 25101.3507s
	iters: 200, epoch: 7 | loss: 0.4814496
	speed: 0.2377s/iter; left time: 8199.2540s
	iters: 300, epoch: 7 | loss: 0.6619211
	speed: 0.2362s/iter; left time: 8120.5471s
Epoch: 7 cost time: 89.10201215744019
Epoch: 7, Steps: 369 | Train Loss: 0.289 Vali Loss: 0.912 Vali Acc: 0.660 Test Loss: 0.912 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0980198
	speed: 0.7325s/iter; left time: 25064.7206s
	iters: 200, epoch: 8 | loss: 0.3328798
	speed: 0.2465s/iter; left time: 8408.6294s
	iters: 300, epoch: 8 | loss: 0.2148094
	speed: 0.2396s/iter; left time: 8150.3955s
Epoch: 8 cost time: 92.12190675735474
Epoch: 8, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.006 Vali Acc: 0.665 Test Loss: 1.006 Test Acc: 0.665
Validation loss decreased (-0.661456 --> -0.664576).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2898769
	speed: 0.7617s/iter; left time: 25782.4390s
	iters: 200, epoch: 9 | loss: 0.2181837
	speed: 0.2429s/iter; left time: 8199.2192s
	iters: 300, epoch: 9 | loss: 0.0817949
	speed: 0.2442s/iter; left time: 8218.1119s
Epoch: 9 cost time: 91.64513421058655
Epoch: 9, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.045 Vali Acc: 0.656 Test Loss: 1.045 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0844317
	speed: 0.7442s/iter; left time: 24915.3890s
	iters: 200, epoch: 10 | loss: 0.4817645
	speed: 0.2374s/iter; left time: 7925.1644s
	iters: 300, epoch: 10 | loss: 0.3250757
	speed: 0.2364s/iter; left time: 7867.2866s
Epoch: 10 cost time: 88.36989426612854
Epoch: 10, Steps: 369 | Train Loss: 0.194 Vali Loss: 1.135 Vali Acc: 0.642 Test Loss: 1.135 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1460706
	speed: 0.7107s/iter; left time: 23531.0297s
	iters: 200, epoch: 11 | loss: 0.0800139
	speed: 0.2289s/iter; left time: 7554.9179s
	iters: 300, epoch: 11 | loss: 0.4205843
	speed: 0.2288s/iter; left time: 7530.0536s
Epoch: 11 cost time: 85.91021394729614
Epoch: 11, Steps: 369 | Train Loss: 0.186 Vali Loss: 1.203 Vali Acc: 0.652 Test Loss: 1.203 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0646474
	speed: 0.7066s/iter; left time: 23136.2357s
	iters: 200, epoch: 12 | loss: 0.0656759
	speed: 0.2359s/iter; left time: 7698.6845s
	iters: 300, epoch: 12 | loss: 0.3370391
	speed: 0.2304s/iter; left time: 7498.7729s
Epoch: 12 cost time: 87.48260855674744
Epoch: 12, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.287 Vali Acc: 0.661 Test Loss: 1.287 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0693116
	speed: 0.7443s/iter; left time: 24094.1515s
	iters: 200, epoch: 13 | loss: 0.0145436
	speed: 0.2496s/iter; left time: 8055.6450s
	iters: 300, epoch: 13 | loss: 0.0739620
	speed: 0.2521s/iter; left time: 8110.3260s
Epoch: 13 cost time: 93.55224132537842
Epoch: 13, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.325 Vali Acc: 0.659 Test Loss: 1.325 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0735881
	speed: 0.7818s/iter; left time: 25019.6185s
	iters: 200, epoch: 14 | loss: 0.1208702
	speed: 0.2408s/iter; left time: 7683.4077s
	iters: 300, epoch: 14 | loss: 0.1526182
	speed: 0.2369s/iter; left time: 7534.2929s
Epoch: 14 cost time: 90.21647214889526
Epoch: 14, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.483 Vali Acc: 0.658 Test Loss: 1.483 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0545823
	speed: 0.7356s/iter; left time: 23269.9265s
	iters: 200, epoch: 15 | loss: 0.3820269
	speed: 0.2338s/iter; left time: 7374.1531s
	iters: 300, epoch: 15 | loss: 0.3180037
	speed: 0.2370s/iter; left time: 7451.5379s
Epoch: 15 cost time: 87.95856499671936
Epoch: 15, Steps: 369 | Train Loss: 0.143 Vali Loss: 1.496 Vali Acc: 0.672 Test Loss: 1.496 Test Acc: 0.672
Validation loss decreased (-0.664576 --> -0.671665).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0274162
	speed: 0.7341s/iter; left time: 22953.0035s
	iters: 200, epoch: 16 | loss: 0.0456696
	speed: 0.2330s/iter; left time: 7262.1077s
	iters: 300, epoch: 16 | loss: 0.0392876
	speed: 0.2222s/iter; left time: 6904.2332s
Epoch: 16 cost time: 85.2757785320282
Epoch: 16, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.507 Vali Acc: 0.659 Test Loss: 1.507 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0327059
	speed: 0.7376s/iter; left time: 22789.5088s
	iters: 200, epoch: 17 | loss: 0.1482314
	speed: 0.2445s/iter; left time: 7529.9366s
	iters: 300, epoch: 17 | loss: 0.0483745
	speed: 0.2556s/iter; left time: 7844.8239s
Epoch: 17 cost time: 92.4934549331665
Epoch: 17, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.645 Vali Acc: 0.648 Test Loss: 1.645 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0805494
	speed: 0.7846s/iter; left time: 23951.1475s
	iters: 200, epoch: 18 | loss: 0.0395922
	speed: 0.2499s/iter; left time: 7605.0864s
	iters: 300, epoch: 18 | loss: 0.1998974
	speed: 0.2407s/iter; left time: 7298.8619s
Epoch: 18 cost time: 90.70773220062256
Epoch: 18, Steps: 369 | Train Loss: 0.116 Vali Loss: 1.571 Vali Acc: 0.661 Test Loss: 1.571 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2465004
	speed: 0.7288s/iter; left time: 21979.5248s
	iters: 200, epoch: 19 | loss: 0.0399544
	speed: 0.2425s/iter; left time: 7289.2057s
	iters: 300, epoch: 19 | loss: 0.0064404
	speed: 0.2466s/iter; left time: 7388.3720s
Epoch: 19 cost time: 90.59262466430664
Epoch: 19, Steps: 369 | Train Loss: 0.118 Vali Loss: 1.628 Vali Acc: 0.665 Test Loss: 1.628 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1732893
	speed: 0.7561s/iter; left time: 22523.3280s
	iters: 200, epoch: 20 | loss: 0.0686566
	speed: 0.2388s/iter; left time: 7091.0457s
	iters: 300, epoch: 20 | loss: 0.0196196
	speed: 0.2402s/iter; left time: 7106.6358s
Epoch: 20 cost time: 89.66545748710632
Epoch: 20, Steps: 369 | Train Loss: 0.107 Vali Loss: 1.792 Vali Acc: 0.652 Test Loss: 1.792 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.1275409
	speed: 0.7496s/iter; left time: 22054.7102s
	iters: 200, epoch: 21 | loss: 0.0109130
	speed: 0.2467s/iter; left time: 7234.8173s
	iters: 300, epoch: 21 | loss: 0.0456197
	speed: 0.2377s/iter; left time: 6944.4787s
Epoch: 21 cost time: 89.90604090690613
Epoch: 21, Steps: 369 | Train Loss: 0.089 Vali Loss: 1.706 Vali Acc: 0.655 Test Loss: 1.706 Test Acc: 0.655
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0245579
	speed: 0.7537s/iter; left time: 21897.8020s
	iters: 200, epoch: 22 | loss: 0.4933940
	speed: 0.2371s/iter; left time: 6863.2127s
	iters: 300, epoch: 22 | loss: 0.0606802
	speed: 0.2404s/iter; left time: 6937.4257s
Epoch: 22 cost time: 90.3208315372467
Epoch: 22, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.807 Vali Acc: 0.656 Test Loss: 1.807 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0377399
	speed: 0.7472s/iter; left time: 21432.5235s
	iters: 200, epoch: 23 | loss: 0.0118618
	speed: 0.2395s/iter; left time: 6846.4551s
	iters: 300, epoch: 23 | loss: 0.0040778
	speed: 0.2379s/iter; left time: 6777.2162s
Epoch: 23 cost time: 87.649174451828
Epoch: 23, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.854 Vali Acc: 0.651 Test Loss: 1.854 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0455112
	speed: 0.7308s/iter; left time: 20690.4974s
	iters: 200, epoch: 24 | loss: 0.0075760
	speed: 0.2366s/iter; left time: 6675.4932s
	iters: 300, epoch: 24 | loss: 0.0520793
	speed: 0.2362s/iter; left time: 6641.9216s
Epoch: 24 cost time: 88.46505093574524
Epoch: 24, Steps: 369 | Train Loss: 0.105 Vali Loss: 1.865 Vali Acc: 0.659 Test Loss: 1.865 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0156423
	speed: 0.7417s/iter; left time: 20728.1065s
	iters: 200, epoch: 25 | loss: 0.0150610
	speed: 0.2402s/iter; left time: 6688.3777s
	iters: 300, epoch: 25 | loss: 0.0882814
	speed: 0.2408s/iter; left time: 6680.6551s
Epoch: 25 cost time: 88.26737785339355
Epoch: 25, Steps: 369 | Train Loss: 0.089 Vali Loss: 2.073 Vali Acc: 0.644 Test Loss: 2.073 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6716799091940976
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7011145
	speed: 0.2565s/iter; left time: 9440.7145s
	iters: 200, epoch: 1 | loss: 0.7614706
	speed: 0.2336s/iter; left time: 8572.5662s
	iters: 300, epoch: 1 | loss: 0.6237463
	speed: 0.2327s/iter; left time: 8515.2359s
Epoch: 1 cost time: 88.33281803131104
Epoch: 1, Steps: 369 | Train Loss: 0.710 Vali Loss: 0.696 Vali Acc: 0.563 Test Loss: 0.696 Test Acc: 0.563
Validation loss decreased (inf --> -0.563273).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3975886
	speed: 0.7249s/iter; left time: 26409.0903s
	iters: 200, epoch: 2 | loss: 0.5883844
	speed: 0.2434s/iter; left time: 8844.1730s
	iters: 300, epoch: 2 | loss: 0.4438344
	speed: 0.2319s/iter; left time: 8403.4020s
Epoch: 2 cost time: 86.87271904945374
Epoch: 2, Steps: 369 | Train Loss: 0.582 Vali Loss: 0.675 Vali Acc: 0.660 Test Loss: 0.675 Test Acc: 0.660
Validation loss decreased (-0.563273 --> -0.660322).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6648712
	speed: 0.6916s/iter; left time: 24942.3404s
	iters: 200, epoch: 3 | loss: 0.4233412
	speed: 0.2304s/iter; left time: 8284.1939s
	iters: 300, epoch: 3 | loss: 0.8968316
	speed: 0.2284s/iter; left time: 8192.7100s
Epoch: 3 cost time: 84.92681288719177
Epoch: 3, Steps: 369 | Train Loss: 0.493 Vali Loss: 0.749 Vali Acc: 0.656 Test Loss: 0.749 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5307573
	speed: 0.7347s/iter; left time: 26225.3683s
	iters: 200, epoch: 4 | loss: 0.4812858
	speed: 0.2365s/iter; left time: 8416.6427s
	iters: 300, epoch: 4 | loss: 0.4933345
	speed: 0.2335s/iter; left time: 8287.6691s
Epoch: 4 cost time: 87.98590159416199
Epoch: 4, Steps: 369 | Train Loss: 0.427 Vali Loss: 0.724 Vali Acc: 0.672 Test Loss: 0.724 Test Acc: 0.672
Validation loss decreased (-0.660322 --> -0.672240).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3016916
	speed: 0.7324s/iter; left time: 25870.9130s
	iters: 200, epoch: 5 | loss: 0.1394771
	speed: 0.2365s/iter; left time: 8330.1280s
	iters: 300, epoch: 5 | loss: 0.6152503
	speed: 0.2328s/iter; left time: 8176.7701s
Epoch: 5 cost time: 86.06047248840332
Epoch: 5, Steps: 369 | Train Loss: 0.383 Vali Loss: 0.787 Vali Acc: 0.668 Test Loss: 0.787 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2511300
	speed: 0.7158s/iter; left time: 25023.1543s
	iters: 200, epoch: 6 | loss: 0.2127990
	speed: 0.2333s/iter; left time: 8131.2469s
	iters: 300, epoch: 6 | loss: 0.3054168
	speed: 0.2325s/iter; left time: 8079.4684s
Epoch: 6 cost time: 86.47176456451416
Epoch: 6, Steps: 369 | Train Loss: 0.340 Vali Loss: 0.855 Vali Acc: 0.675 Test Loss: 0.855 Test Acc: 0.675
Validation loss decreased (-0.672240 --> -0.674509).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5586849
	speed: 0.7140s/iter; left time: 24693.6320s
	iters: 200, epoch: 7 | loss: 0.6240894
	speed: 0.2271s/iter; left time: 7833.1838s
	iters: 300, epoch: 7 | loss: 0.5775481
	speed: 0.2255s/iter; left time: 7754.1827s
Epoch: 7 cost time: 84.0679521560669
Epoch: 7, Steps: 369 | Train Loss: 0.301 Vali Loss: 0.900 Vali Acc: 0.673 Test Loss: 0.900 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1330049
	speed: 0.6972s/iter; left time: 23856.8818s
	iters: 200, epoch: 8 | loss: 0.2107107
	speed: 0.2327s/iter; left time: 7940.2707s
	iters: 300, epoch: 8 | loss: 0.1620410
	speed: 0.2355s/iter; left time: 8010.0235s
Epoch: 8 cost time: 86.69815969467163
Epoch: 8, Steps: 369 | Train Loss: 0.267 Vali Loss: 0.986 Vali Acc: 0.661 Test Loss: 0.986 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0592240
	speed: 0.7399s/iter; left time: 25043.6133s
	iters: 200, epoch: 9 | loss: 0.1774519
	speed: 0.2317s/iter; left time: 7820.6503s
	iters: 300, epoch: 9 | loss: 0.1591569
	speed: 0.2291s/iter; left time: 7709.5166s
Epoch: 9 cost time: 85.26851272583008
Epoch: 9, Steps: 369 | Train Loss: 0.244 Vali Loss: 1.044 Vali Acc: 0.642 Test Loss: 1.044 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1168663
	speed: 0.7138s/iter; left time: 23896.6746s
	iters: 200, epoch: 10 | loss: 0.4299379
	speed: 0.2302s/iter; left time: 7683.6248s
	iters: 300, epoch: 10 | loss: 0.0858750
	speed: 0.2268s/iter; left time: 7546.9912s
Epoch: 10 cost time: 85.73771095275879
Epoch: 10, Steps: 369 | Train Loss: 0.219 Vali Loss: 1.143 Vali Acc: 0.652 Test Loss: 1.143 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0887545
	speed: 0.7258s/iter; left time: 24031.8640s
	iters: 200, epoch: 11 | loss: 0.2063072
	speed: 0.2318s/iter; left time: 7650.4038s
	iters: 300, epoch: 11 | loss: 0.2562535
	speed: 0.2307s/iter; left time: 7593.1952s
Epoch: 11 cost time: 85.7529239654541
Epoch: 11, Steps: 369 | Train Loss: 0.187 Vali Loss: 1.221 Vali Acc: 0.651 Test Loss: 1.221 Test Acc: 0.651
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1772696
	speed: 0.7223s/iter; left time: 23648.6270s
	iters: 200, epoch: 12 | loss: 0.1626029
	speed: 0.2219s/iter; left time: 7244.6260s
	iters: 300, epoch: 12 | loss: 0.2403207
	speed: 0.2223s/iter; left time: 7235.1533s
Epoch: 12 cost time: 83.28657269477844
Epoch: 12, Steps: 369 | Train Loss: 0.191 Vali Loss: 1.314 Vali Acc: 0.659 Test Loss: 1.314 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2364770
	speed: 0.6994s/iter; left time: 22641.2893s
	iters: 200, epoch: 13 | loss: 0.0717398
	speed: 0.2160s/iter; left time: 6970.4315s
	iters: 300, epoch: 13 | loss: 0.0541375
	speed: 0.2336s/iter; left time: 7515.8882s
Epoch: 13 cost time: 84.79515266418457
Epoch: 13, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.327 Vali Acc: 0.658 Test Loss: 1.327 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0387850
	speed: 0.7628s/iter; left time: 24413.0027s
	iters: 200, epoch: 14 | loss: 0.2403946
	speed: 0.2427s/iter; left time: 7743.7900s
	iters: 300, epoch: 14 | loss: 0.0213925
	speed: 0.2353s/iter; left time: 7483.8826s
Epoch: 14 cost time: 88.51911854743958
Epoch: 14, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.440 Vali Acc: 0.651 Test Loss: 1.440 Test Acc: 0.651
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3814008
	speed: 0.7720s/iter; left time: 24422.6990s
	iters: 200, epoch: 15 | loss: 0.0318914
	speed: 0.2575s/iter; left time: 8119.0640s
	iters: 300, epoch: 15 | loss: 0.1141791
	speed: 0.2482s/iter; left time: 7803.0797s
Epoch: 15 cost time: 92.14047574996948
Epoch: 15, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.576 Vali Acc: 0.655 Test Loss: 1.576 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0635219
	speed: 0.7565s/iter; left time: 23653.7178s
	iters: 200, epoch: 16 | loss: 0.0535092
	speed: 0.2382s/iter; left time: 7422.8119s
	iters: 300, epoch: 16 | loss: 0.1670733
	speed: 0.2342s/iter; left time: 7274.5047s
Epoch: 16 cost time: 87.38600182533264
Epoch: 16, Steps: 369 | Train Loss: 0.129 Vali Loss: 1.593 Vali Acc: 0.650 Test Loss: 1.593 Test Acc: 0.650
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7428309
	speed: 0.2449s/iter; left time: 9014.0995s
	iters: 200, epoch: 1 | loss: 0.9155070
	speed: 0.2466s/iter; left time: 9049.7911s
	iters: 300, epoch: 1 | loss: 0.7145566
	speed: 0.2415s/iter; left time: 8837.6359s
Epoch: 1 cost time: 90.32214784622192
Epoch: 1, Steps: 369 | Train Loss: 0.716 Vali Loss: 0.710 Vali Acc: 0.521 Test Loss: 0.710 Test Acc: 0.521
Validation loss decreased (inf --> -0.520708).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4844245
	speed: 0.7674s/iter; left time: 27958.4938s
	iters: 200, epoch: 2 | loss: 0.5255956
	speed: 0.2289s/iter; left time: 8315.7608s
	iters: 300, epoch: 2 | loss: 0.6135038
	speed: 0.2481s/iter; left time: 8990.0230s
Epoch: 2 cost time: 89.16817140579224
Epoch: 2, Steps: 369 | Train Loss: 0.604 Vali Loss: 0.699 Vali Acc: 0.631 Test Loss: 0.699 Test Acc: 0.631
Validation loss decreased (-0.520708 --> -0.631094).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6290023
	speed: 0.7768s/iter; left time: 28015.2422s
	iters: 200, epoch: 3 | loss: 0.4191169
	speed: 0.2423s/iter; left time: 8712.5141s
	iters: 300, epoch: 3 | loss: 0.9050574
	speed: 0.2549s/iter; left time: 9139.7532s
Epoch: 3 cost time: 93.8598165512085
Epoch: 3, Steps: 369 | Train Loss: 0.502 Vali Loss: 0.747 Vali Acc: 0.668 Test Loss: 0.747 Test Acc: 0.668
Validation loss decreased (-0.631094 --> -0.667700).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5736900
	speed: 0.7928s/iter; left time: 28297.3208s
	iters: 200, epoch: 4 | loss: 0.2409419
	speed: 0.2441s/iter; left time: 8687.9603s
	iters: 300, epoch: 4 | loss: 0.5515382
	speed: 0.2498s/iter; left time: 8867.3685s
Epoch: 4 cost time: 91.43659734725952
Epoch: 4, Steps: 369 | Train Loss: 0.442 Vali Loss: 0.725 Vali Acc: 0.671 Test Loss: 0.725 Test Acc: 0.671
Validation loss decreased (-0.667700 --> -0.670538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2456600
	speed: 0.7543s/iter; left time: 26645.5699s
	iters: 200, epoch: 5 | loss: 0.2945018
	speed: 0.2476s/iter; left time: 8721.3270s
	iters: 300, epoch: 5 | loss: 0.6622202
	speed: 0.2369s/iter; left time: 8321.9903s
Epoch: 5 cost time: 89.61525416374207
Epoch: 5, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.768 Vali Acc: 0.667 Test Loss: 0.768 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3001764
	speed: 0.7907s/iter; left time: 27640.2171s
	iters: 200, epoch: 6 | loss: 0.3795987
	speed: 0.2664s/iter; left time: 9284.0210s
	iters: 300, epoch: 6 | loss: 0.4337048
	speed: 0.2447s/iter; left time: 8503.5402s
Epoch: 6 cost time: 93.87396430969238
Epoch: 6, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.810 Vali Acc: 0.667 Test Loss: 0.810 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3641215
	speed: 0.7410s/iter; left time: 25630.5479s
	iters: 200, epoch: 7 | loss: 0.1876652
	speed: 0.2363s/iter; left time: 8149.2351s
	iters: 300, epoch: 7 | loss: 0.4157530
	speed: 0.2367s/iter; left time: 8140.9692s
Epoch: 7 cost time: 88.11598062515259
Epoch: 7, Steps: 369 | Train Loss: 0.304 Vali Loss: 0.897 Vali Acc: 0.671 Test Loss: 0.897 Test Acc: 0.671
Validation loss decreased (-0.670538 --> -0.671103).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2052179
	speed: 0.7894s/iter; left time: 27011.4064s
	iters: 200, epoch: 8 | loss: 0.5133519
	speed: 0.2532s/iter; left time: 8639.1798s
	iters: 300, epoch: 8 | loss: 0.2317484
	speed: 0.2642s/iter; left time: 8988.3524s
Epoch: 8 cost time: 96.34571504592896
Epoch: 8, Steps: 369 | Train Loss: 0.274 Vali Loss: 1.006 Vali Acc: 0.667 Test Loss: 1.006 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2074397
	speed: 0.7779s/iter; left time: 26331.6302s
	iters: 200, epoch: 9 | loss: 0.2234317
	speed: 0.2454s/iter; left time: 8281.0412s
	iters: 300, epoch: 9 | loss: 0.1273922
	speed: 0.2587s/iter; left time: 8703.7772s
Epoch: 9 cost time: 91.13253879547119
Epoch: 9, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.053 Vali Acc: 0.654 Test Loss: 1.053 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1407449
	speed: 0.7514s/iter; left time: 25157.1696s
	iters: 200, epoch: 10 | loss: 0.2035717
	speed: 0.2696s/iter; left time: 9000.4953s
	iters: 300, epoch: 10 | loss: 0.2545158
	speed: 0.2479s/iter; left time: 8250.0323s
Epoch: 10 cost time: 93.15336298942566
Epoch: 10, Steps: 369 | Train Loss: 0.221 Vali Loss: 1.139 Vali Acc: 0.657 Test Loss: 1.139 Test Acc: 0.657
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0549410
	speed: 0.7384s/iter; left time: 24450.6337s
	iters: 200, epoch: 11 | loss: 0.1357381
	speed: 0.2295s/iter; left time: 7574.3787s
	iters: 300, epoch: 11 | loss: 0.1345754
	speed: 0.2379s/iter; left time: 7829.9939s
Epoch: 11 cost time: 85.79980659484863
Epoch: 11, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.180 Vali Acc: 0.659 Test Loss: 1.180 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4415606
	speed: 0.7400s/iter; left time: 24229.9403s
	iters: 200, epoch: 12 | loss: 0.2704010
	speed: 0.2319s/iter; left time: 7570.3978s
	iters: 300, epoch: 12 | loss: 0.1110373
	speed: 0.2429s/iter; left time: 7906.0164s
Epoch: 12 cost time: 87.60063457489014
Epoch: 12, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.353 Vali Acc: 0.657 Test Loss: 1.353 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1057418
	speed: 0.7523s/iter; left time: 24355.0355s
	iters: 200, epoch: 13 | loss: 0.1632594
	speed: 0.2418s/iter; left time: 7802.4752s
	iters: 300, epoch: 13 | loss: 0.0885099
	speed: 0.2667s/iter; left time: 8580.1314s
Epoch: 13 cost time: 92.35531997680664
Epoch: 13, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.386 Vali Acc: 0.662 Test Loss: 1.386 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1870088
	speed: 0.8038s/iter; left time: 25723.2330s
	iters: 200, epoch: 14 | loss: 0.5097284
	speed: 0.2556s/iter; left time: 8154.4949s
	iters: 300, epoch: 14 | loss: 0.1561667
	speed: 0.2551s/iter; left time: 8114.4048s
Epoch: 14 cost time: 93.72498393058777
Epoch: 14, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.470 Vali Acc: 0.664 Test Loss: 1.470 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1862916
	speed: 0.7629s/iter; left time: 24135.2231s
	iters: 200, epoch: 15 | loss: 0.0789851
	speed: 0.2301s/iter; left time: 7257.7084s
	iters: 300, epoch: 15 | loss: 0.1179450
	speed: 0.2522s/iter; left time: 7927.7082s
Epoch: 15 cost time: 89.8613440990448
Epoch: 15, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.411 Vali Acc: 0.659 Test Loss: 1.411 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1514542
	speed: 0.7954s/iter; left time: 24870.1930s
	iters: 200, epoch: 16 | loss: 0.0239562
	speed: 0.2373s/iter; left time: 7395.9216s
	iters: 300, epoch: 16 | loss: 0.2532150
	speed: 0.2423s/iter; left time: 7526.5881s
Epoch: 16 cost time: 91.8359603881836
Epoch: 16, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.475 Vali Acc: 0.669 Test Loss: 1.475 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.2965347
	speed: 0.7361s/iter; left time: 22743.4374s
	iters: 200, epoch: 17 | loss: 0.0556808
	speed: 0.2417s/iter; left time: 7444.6610s
	iters: 300, epoch: 17 | loss: 0.1141048
	speed: 0.2508s/iter; left time: 7698.5793s
Epoch: 17 cost time: 90.65472388267517
Epoch: 17, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.592 Vali Acc: 0.655 Test Loss: 1.592 Test Acc: 0.655
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6711123723041997
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7267159
	speed: 0.2809s/iter; left time: 10339.1637s
	iters: 200, epoch: 1 | loss: 0.6784047
	speed: 0.2573s/iter; left time: 9443.0589s
	iters: 300, epoch: 1 | loss: 0.7532257
	speed: 0.2711s/iter; left time: 9923.3978s
Epoch: 1 cost time: 96.95957970619202
Epoch: 1, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.693 Vali Acc: 0.554 Test Loss: 0.693 Test Acc: 0.554
Validation loss decreased (inf --> -0.553909).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4958040
	speed: 0.7464s/iter; left time: 27193.5383s
	iters: 200, epoch: 2 | loss: 0.5608864
	speed: 0.2427s/iter; left time: 8817.7593s
	iters: 300, epoch: 2 | loss: 0.4538897
	speed: 0.2370s/iter; left time: 8587.5206s
Epoch: 2 cost time: 88.95869207382202
Epoch: 2, Steps: 369 | Train Loss: 0.595 Vali Loss: 0.710 Vali Acc: 0.645 Test Loss: 0.710 Test Acc: 0.645
Validation loss decreased (-0.553909 --> -0.644715).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6394532
	speed: 0.7354s/iter; left time: 26520.9973s
	iters: 200, epoch: 3 | loss: 0.4337828
	speed: 0.2373s/iter; left time: 8533.1225s
	iters: 300, epoch: 3 | loss: 0.9686347
	speed: 0.2306s/iter; left time: 8271.6603s
Epoch: 3 cost time: 86.47786498069763
Epoch: 3, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.762 Vali Acc: 0.656 Test Loss: 0.762 Test Acc: 0.656
Validation loss decreased (-0.644715 --> -0.655497).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3512697
	speed: 0.7224s/iter; left time: 25785.7082s
	iters: 200, epoch: 4 | loss: 0.3265853
	speed: 0.2576s/iter; left time: 9170.4010s
	iters: 300, epoch: 4 | loss: 0.6487833
	speed: 0.2515s/iter; left time: 8927.4986s
Epoch: 4 cost time: 91.62111926078796
Epoch: 4, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.742 Vali Acc: 0.663 Test Loss: 0.742 Test Acc: 0.663
Validation loss decreased (-0.655497 --> -0.663443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2920048
	speed: 0.7873s/iter; left time: 27812.9670s
	iters: 200, epoch: 5 | loss: 0.1634541
	speed: 0.2632s/iter; left time: 9269.6293s
	iters: 300, epoch: 5 | loss: 0.5903038
	speed: 0.2705s/iter; left time: 9499.6070s
Epoch: 5 cost time: 97.64722752571106
Epoch: 5, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.797 Vali Acc: 0.664 Test Loss: 0.797 Test Acc: 0.664
Validation loss decreased (-0.663443 --> -0.664294).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3014856
	speed: 0.7684s/iter; left time: 26860.1089s
	iters: 200, epoch: 6 | loss: 0.4547235
	speed: 0.2260s/iter; left time: 7877.0629s
	iters: 300, epoch: 6 | loss: 0.5247847
	speed: 0.2244s/iter; left time: 7798.4575s
Epoch: 6 cost time: 85.22156548500061
Epoch: 6, Steps: 369 | Train Loss: 0.354 Vali Loss: 0.881 Vali Acc: 0.656 Test Loss: 0.881 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1922771
	speed: 0.7605s/iter; left time: 26302.9804s
	iters: 200, epoch: 7 | loss: 0.1326867
	speed: 0.2373s/iter; left time: 8185.0563s
	iters: 300, epoch: 7 | loss: 0.5981581
	speed: 0.2307s/iter; left time: 7932.5490s
Epoch: 7 cost time: 88.94806265830994
Epoch: 7, Steps: 369 | Train Loss: 0.320 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
Validation loss decreased (-0.664294 --> -0.675360).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2160674
	speed: 0.7394s/iter; left time: 25300.6097s
	iters: 200, epoch: 8 | loss: 0.1555284
	speed: 0.2479s/iter; left time: 8458.5360s
	iters: 300, epoch: 8 | loss: 0.4097446
	speed: 0.2602s/iter; left time: 8851.4597s
Epoch: 8 cost time: 93.26177525520325
Epoch: 8, Steps: 369 | Train Loss: 0.289 Vali Loss: 0.989 Vali Acc: 0.661 Test Loss: 0.989 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0638190
	speed: 0.7877s/iter; left time: 26662.7702s
	iters: 200, epoch: 9 | loss: 0.3364982
	speed: 0.2508s/iter; left time: 8464.9784s
	iters: 300, epoch: 9 | loss: 0.1218407
	speed: 0.2663s/iter; left time: 8961.2556s
Epoch: 9 cost time: 94.97081184387207
Epoch: 9, Steps: 369 | Train Loss: 0.264 Vali Loss: 1.063 Vali Acc: 0.639 Test Loss: 1.063 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1714228
	speed: 0.7952s/iter; left time: 26622.1891s
	iters: 200, epoch: 10 | loss: 0.2509266
	speed: 0.2598s/iter; left time: 8671.0256s
	iters: 300, epoch: 10 | loss: 0.2544358
	speed: 0.2591s/iter; left time: 8623.2792s
Epoch: 10 cost time: 96.53103017807007
Epoch: 10, Steps: 369 | Train Loss: 0.228 Vali Loss: 1.075 Vali Acc: 0.658 Test Loss: 1.075 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.1306659
	speed: 0.7761s/iter; left time: 25697.1137s
	iters: 200, epoch: 11 | loss: 0.1487710
	speed: 0.2334s/iter; left time: 7703.3599s
	iters: 300, epoch: 11 | loss: 0.3606985
	speed: 0.2424s/iter; left time: 7979.0609s
Epoch: 11 cost time: 89.79240655899048
Epoch: 11, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.135 Vali Acc: 0.663 Test Loss: 1.135 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3759317
	speed: 0.7632s/iter; left time: 24989.7503s
	iters: 200, epoch: 12 | loss: 0.1953465
	speed: 0.2731s/iter; left time: 8915.6265s
	iters: 300, epoch: 12 | loss: 0.4222065
	speed: 0.2496s/iter; left time: 8122.8766s
Epoch: 12 cost time: 94.96955966949463
Epoch: 12, Steps: 369 | Train Loss: 0.200 Vali Loss: 1.316 Vali Acc: 0.657 Test Loss: 1.316 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0985437
	speed: 0.7835s/iter; left time: 25363.1548s
	iters: 200, epoch: 13 | loss: 0.2750627
	speed: 0.2709s/iter; left time: 8741.6871s
	iters: 300, epoch: 13 | loss: 0.1084516
	speed: 0.2527s/iter; left time: 8129.7352s
Epoch: 13 cost time: 95.30036163330078
Epoch: 13, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.253 Vali Acc: 0.659 Test Loss: 1.253 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0633799
	speed: 0.7849s/iter; left time: 25120.5148s
	iters: 200, epoch: 14 | loss: 0.3297192
	speed: 0.2646s/iter; left time: 8441.2648s
	iters: 300, epoch: 14 | loss: 0.0761787
	speed: 0.2436s/iter; left time: 7748.4235s
Epoch: 14 cost time: 93.98198819160461
Epoch: 14, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.358 Vali Acc: 0.663 Test Loss: 1.358 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1232662
	speed: 0.7705s/iter; left time: 24374.4976s
	iters: 200, epoch: 15 | loss: 0.1928514
	speed: 0.2235s/iter; left time: 7048.6993s
	iters: 300, epoch: 15 | loss: 0.1892990
	speed: 0.2561s/iter; left time: 8049.2940s
Epoch: 15 cost time: 90.70122194290161
Epoch: 15, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.443 Vali Acc: 0.657 Test Loss: 1.443 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0359806
	speed: 0.7685s/iter; left time: 24029.0794s
	iters: 200, epoch: 16 | loss: 0.0573945
	speed: 0.2537s/iter; left time: 7907.8562s
	iters: 300, epoch: 16 | loss: 0.1099774
	speed: 0.2573s/iter; left time: 7994.7249s
Epoch: 16 cost time: 93.91291356086731
Epoch: 16, Steps: 369 | Train Loss: 0.145 Vali Loss: 1.461 Vali Acc: 0.659 Test Loss: 1.461 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.1865125
	speed: 0.7733s/iter; left time: 23891.4180s
	iters: 200, epoch: 17 | loss: 0.1025289
	speed: 0.2404s/iter; left time: 7404.7242s
	iters: 300, epoch: 17 | loss: 0.1783329
	speed: 0.2589s/iter; left time: 7948.0822s
Epoch: 17 cost time: 92.10712718963623
Epoch: 17, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.477 Vali Acc: 0.661 Test Loss: 1.477 Test Acc: 0.661
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6966500
	speed: 0.2518s/iter; left time: 9265.3428s
	iters: 200, epoch: 1 | loss: 0.7668588
	speed: 0.2573s/iter; left time: 9443.9333s
	iters: 300, epoch: 1 | loss: 0.7573248
	speed: 0.2576s/iter; left time: 9427.9885s
Epoch: 1 cost time: 94.09951591491699
Epoch: 1, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.690 Vali Acc: 0.561 Test Loss: 0.690 Test Acc: 0.561
Validation loss decreased (inf --> -0.561003).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5936235
	speed: 0.7571s/iter; left time: 27581.0146s
	iters: 200, epoch: 2 | loss: 0.5471219
	speed: 0.2529s/iter; left time: 9187.7496s
	iters: 300, epoch: 2 | loss: 0.4660794
	speed: 0.2369s/iter; left time: 8584.2640s
Epoch: 2 cost time: 89.56895589828491
Epoch: 2, Steps: 369 | Train Loss: 0.615 Vali Loss: 0.686 Vali Acc: 0.648 Test Loss: 0.686 Test Acc: 0.648
Validation loss decreased (-0.561003 --> -0.647553).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5295671
	speed: 0.7807s/iter; left time: 28154.8765s
	iters: 200, epoch: 3 | loss: 0.3641584
	speed: 0.2497s/iter; left time: 8979.9068s
	iters: 300, epoch: 3 | loss: 0.6135553
	speed: 0.2500s/iter; left time: 8967.3447s
Epoch: 3 cost time: 93.68865656852722
Epoch: 3, Steps: 369 | Train Loss: 0.521 Vali Loss: 0.761 Vali Acc: 0.648 Test Loss: 0.761 Test Acc: 0.648
Validation loss decreased (-0.647553 --> -0.648120).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4648650
	speed: 0.7889s/iter; left time: 28160.2658s
	iters: 200, epoch: 4 | loss: 0.4315647
	speed: 0.2413s/iter; left time: 8587.7289s
	iters: 300, epoch: 4 | loss: 0.5040091
	speed: 0.2412s/iter; left time: 8559.8725s
Epoch: 4 cost time: 92.85769891738892
Epoch: 4, Steps: 369 | Train Loss: 0.467 Vali Loss: 0.730 Vali Acc: 0.671 Test Loss: 0.730 Test Acc: 0.671
Validation loss decreased (-0.648120 --> -0.670821).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2390228
	speed: 0.7818s/iter; left time: 27617.8940s
	iters: 200, epoch: 5 | loss: 0.2657523
	speed: 0.2456s/iter; left time: 8652.9100s
	iters: 300, epoch: 5 | loss: 0.5660541
	speed: 0.2408s/iter; left time: 8459.4515s
Epoch: 5 cost time: 91.4152204990387
Epoch: 5, Steps: 369 | Train Loss: 0.423 Vali Loss: 0.733 Vali Acc: 0.668 Test Loss: 0.733 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3918390
	speed: 0.7460s/iter; left time: 26076.4172s
	iters: 200, epoch: 6 | loss: 0.4325287
	speed: 0.2574s/iter; left time: 8972.6241s
	iters: 300, epoch: 6 | loss: 0.3808046
	speed: 0.2343s/iter; left time: 8144.7874s
Epoch: 6 cost time: 90.89870691299438
Epoch: 6, Steps: 369 | Train Loss: 0.387 Vali Loss: 0.766 Vali Acc: 0.675 Test Loss: 0.766 Test Acc: 0.675
Validation loss decreased (-0.670821 --> -0.674510).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1971277
	speed: 0.7542s/iter; left time: 26085.8572s
	iters: 200, epoch: 7 | loss: 0.3175227
	speed: 0.2456s/iter; left time: 8470.5536s
	iters: 300, epoch: 7 | loss: 0.6751668
	speed: 0.2483s/iter; left time: 8538.6549s
Epoch: 7 cost time: 93.0129280090332
Epoch: 7, Steps: 369 | Train Loss: 0.340 Vali Loss: 0.847 Vali Acc: 0.669 Test Loss: 0.847 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1546713
	speed: 0.7646s/iter; left time: 26164.2411s
	iters: 200, epoch: 8 | loss: 0.3025351
	speed: 0.2436s/iter; left time: 8310.9932s
	iters: 300, epoch: 8 | loss: 0.2440501
	speed: 0.2486s/iter; left time: 8457.5912s
Epoch: 8 cost time: 91.1811044216156
Epoch: 8, Steps: 369 | Train Loss: 0.317 Vali Loss: 0.951 Vali Acc: 0.673 Test Loss: 0.951 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0951014
	speed: 0.7503s/iter; left time: 25395.6401s
	iters: 200, epoch: 9 | loss: 0.4489670
	speed: 0.2353s/iter; left time: 7939.9483s
	iters: 300, epoch: 9 | loss: 0.2130094
	speed: 0.2319s/iter; left time: 7803.9210s
Epoch: 9 cost time: 86.88759684562683
Epoch: 9, Steps: 369 | Train Loss: 0.298 Vali Loss: 0.931 Vali Acc: 0.659 Test Loss: 0.931 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1593137
	speed: 0.7429s/iter; left time: 24872.5408s
	iters: 200, epoch: 10 | loss: 0.4626194
	speed: 0.2494s/iter; left time: 8326.3137s
	iters: 300, epoch: 10 | loss: 0.1829527
	speed: 0.2530s/iter; left time: 8419.6334s
Epoch: 10 cost time: 93.38803195953369
Epoch: 10, Steps: 369 | Train Loss: 0.255 Vali Loss: 0.997 Vali Acc: 0.650 Test Loss: 0.997 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4314274
	speed: 0.7561s/iter; left time: 25033.9123s
	iters: 200, epoch: 11 | loss: 0.2047451
	speed: 0.2340s/iter; left time: 7724.8814s
	iters: 300, epoch: 11 | loss: 0.2783965
	speed: 0.2480s/iter; left time: 8160.8145s
Epoch: 11 cost time: 89.40790891647339
Epoch: 11, Steps: 369 | Train Loss: 0.229 Vali Loss: 1.066 Vali Acc: 0.664 Test Loss: 1.066 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2069218
	speed: 0.7500s/iter; left time: 24555.9084s
	iters: 200, epoch: 12 | loss: 0.1609147
	speed: 0.2261s/iter; left time: 7380.8349s
	iters: 300, epoch: 12 | loss: 0.6283808
	speed: 0.2244s/iter; left time: 7303.0675s
Epoch: 12 cost time: 85.58422708511353
Epoch: 12, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.199 Vali Acc: 0.657 Test Loss: 1.199 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1645137
	speed: 0.7041s/iter; left time: 22794.5934s
	iters: 200, epoch: 13 | loss: 0.0980571
	speed: 0.2262s/iter; left time: 7299.1574s
	iters: 300, epoch: 13 | loss: 0.1997121
	speed: 0.2270s/iter; left time: 7302.4214s
Epoch: 13 cost time: 84.03037095069885
Epoch: 13, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.152 Vali Acc: 0.655 Test Loss: 1.152 Test Acc: 0.655
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0291962
	speed: 0.6967s/iter; left time: 22296.3016s
	iters: 200, epoch: 14 | loss: 0.3733479
	speed: 0.2280s/iter; left time: 7274.4670s
	iters: 300, epoch: 14 | loss: 0.0265946
	speed: 0.2389s/iter; left time: 7597.0831s
Epoch: 14 cost time: 85.64956903457642
Epoch: 14, Steps: 369 | Train Loss: 0.171 Vali Loss: 1.347 Vali Acc: 0.654 Test Loss: 1.347 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1673977
	speed: 0.7413s/iter; left time: 23452.1912s
	iters: 200, epoch: 15 | loss: 0.2423545
	speed: 0.2335s/iter; left time: 7364.2650s
	iters: 300, epoch: 15 | loss: 0.0931326
	speed: 0.2262s/iter; left time: 7111.3339s
Epoch: 15 cost time: 85.929128408432
Epoch: 15, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.418 Vali Acc: 0.659 Test Loss: 1.418 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0867233
	speed: 0.6958s/iter; left time: 21755.6059s
	iters: 200, epoch: 16 | loss: 0.0827744
	speed: 0.2115s/iter; left time: 6590.1002s
	iters: 300, epoch: 16 | loss: 0.0839035
	speed: 0.2126s/iter; left time: 6605.0815s
Epoch: 16 cost time: 79.56200695037842
Epoch: 16, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.358 Vali Acc: 0.651 Test Loss: 1.358 Test Acc: 0.651
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6745175936435869
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6938851
	speed: 0.2434s/iter; left time: 8957.2554s
	iters: 200, epoch: 1 | loss: 0.6924455
	speed: 0.2284s/iter; left time: 8380.7974s
	iters: 300, epoch: 1 | loss: 0.6900264
	speed: 0.2211s/iter; left time: 8091.9735s
Epoch: 1 cost time: 84.9077136516571
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6931611
	speed: 0.6810s/iter; left time: 24809.5907s
	iters: 200, epoch: 2 | loss: 0.6931490
	speed: 0.2224s/iter; left time: 8080.6583s
	iters: 300, epoch: 2 | loss: 0.6931634
	speed: 0.2153s/iter; left time: 7800.0785s
Epoch: 2 cost time: 80.20487570762634
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6927211
	speed: 0.6693s/iter; left time: 24137.2773s
	iters: 200, epoch: 3 | loss: 0.6931250
	speed: 0.2255s/iter; left time: 8111.2697s
	iters: 300, epoch: 3 | loss: 0.6928149
	speed: 0.2228s/iter; left time: 7990.2788s
Epoch: 3 cost time: 82.56754612922668
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6952574
	speed: 0.7038s/iter; left time: 25122.6879s
	iters: 200, epoch: 4 | loss: 0.6932714
	speed: 0.2197s/iter; left time: 7820.0846s
	iters: 300, epoch: 4 | loss: 0.6951316
	speed: 0.2114s/iter; left time: 7503.2671s
Epoch: 4 cost time: 81.17396306991577
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6928332
	speed: 0.6717s/iter; left time: 23727.1368s
	iters: 200, epoch: 5 | loss: 0.6964211
	speed: 0.2372s/iter; left time: 8357.1033s
	iters: 300, epoch: 5 | loss: 0.6916997
	speed: 0.2479s/iter; left time: 8706.8900s
Epoch: 5 cost time: 87.16093349456787
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6931548
	speed: 0.7101s/iter; left time: 24822.4550s
	iters: 200, epoch: 6 | loss: 0.6910896
	speed: 0.2333s/iter; left time: 8131.5670s
	iters: 300, epoch: 6 | loss: 0.6927470
	speed: 0.2293s/iter; left time: 7968.0046s
Epoch: 6 cost time: 85.48727607727051
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6931564
	speed: 0.6937s/iter; left time: 23992.7416s
	iters: 200, epoch: 7 | loss: 0.6944392
	speed: 0.2275s/iter; left time: 7846.0914s
	iters: 300, epoch: 7 | loss: 0.6931512
	speed: 0.2215s/iter; left time: 7618.3622s
Epoch: 7 cost time: 83.93101954460144
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6931472
	speed: 0.7694s/iter; left time: 26326.2566s
	iters: 200, epoch: 8 | loss: 0.6925120
	speed: 0.2507s/iter; left time: 8554.1342s
	iters: 300, epoch: 8 | loss: 0.6927395
	speed: 0.2373s/iter; left time: 8072.4911s
Epoch: 8 cost time: 92.74846148490906
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6933112
	speed: 0.7406s/iter; left time: 25070.2030s
	iters: 200, epoch: 9 | loss: 0.6939807
	speed: 0.2391s/iter; left time: 8069.9407s
	iters: 300, epoch: 9 | loss: 0.6940635
	speed: 0.2340s/iter; left time: 7872.2286s
Epoch: 9 cost time: 86.90128636360168
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6970084
	speed: 0.6813s/iter; left time: 22810.4563s
	iters: 200, epoch: 10 | loss: 0.6946557
	speed: 0.2246s/iter; left time: 7497.0204s
	iters: 300, epoch: 10 | loss: 0.6931526
	speed: 0.2345s/iter; left time: 7802.5005s
Epoch: 10 cost time: 84.64248538017273
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6911460
	speed: 0.7167s/iter; left time: 23729.5188s
	iters: 200, epoch: 11 | loss: 0.6943784
	speed: 0.2307s/iter; left time: 7617.0837s
	iters: 300, epoch: 11 | loss: 0.6931073
	speed: 0.2317s/iter; left time: 7626.8367s
Epoch: 11 cost time: 85.7634768486023
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6930081
	speed: 0.6709s/iter; left time: 21965.6736s
	iters: 200, epoch: 12 | loss: 0.6908243
	speed: 0.2310s/iter; left time: 7541.1873s
	iters: 300, epoch: 12 | loss: 0.6940606
	speed: 0.2401s/iter; left time: 7812.5203s
Epoch: 12 cost time: 87.20630979537964
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6914676
	speed: 0.7330s/iter; left time: 23730.8864s
	iters: 200, epoch: 13 | loss: 0.6968271
	speed: 0.2454s/iter; left time: 7919.9830s
	iters: 300, epoch: 13 | loss: 0.6961851
	speed: 0.2333s/iter; left time: 7506.3091s
Epoch: 13 cost time: 89.62179279327393
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6936626
	speed: 0.7433s/iter; left time: 23787.7405s
	iters: 200, epoch: 14 | loss: 0.6926229
	speed: 0.2331s/iter; left time: 7436.4917s
	iters: 300, epoch: 14 | loss: 0.6928000
	speed: 0.2232s/iter; left time: 7099.5333s
Epoch: 14 cost time: 86.16644930839539
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6924466
	speed: 0.6748s/iter; left time: 21346.8262s
	iters: 200, epoch: 15 | loss: 0.6926866
	speed: 0.2218s/iter; left time: 6994.4924s
	iters: 300, epoch: 15 | loss: 0.6919371
	speed: 0.2238s/iter; left time: 7034.0500s
Epoch: 15 cost time: 82.34980416297913
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 149666
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7581446
	speed: 0.2502s/iter; left time: 9209.2080s
	iters: 200, epoch: 1 | loss: 0.7251489
	speed: 0.2288s/iter; left time: 8396.9000s
	iters: 300, epoch: 1 | loss: 0.5886555
	speed: 0.2278s/iter; left time: 8338.8412s
Epoch: 1 cost time: 87.69020104408264
Epoch: 1, Steps: 369 | Train Loss: 0.668 Vali Loss: 0.662 Vali Acc: 0.629 Test Loss: 0.662 Test Acc: 0.629
Validation loss decreased (inf --> -0.629392).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5260906
	speed: 0.7395s/iter; left time: 26940.8457s
	iters: 200, epoch: 2 | loss: 0.3777648
	speed: 0.2477s/iter; left time: 9000.2667s
	iters: 300, epoch: 2 | loss: 0.5516823
	speed: 0.2325s/iter; left time: 8423.7407s
Epoch: 2 cost time: 90.05517721176147
Epoch: 2, Steps: 369 | Train Loss: 0.553 Vali Loss: 0.635 Vali Acc: 0.679 Test Loss: 0.635 Test Acc: 0.679
Validation loss decreased (-0.629392 --> -0.679052).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3535815
	speed: 0.7472s/iter; left time: 26947.3966s
	iters: 200, epoch: 3 | loss: 0.3391444
	speed: 0.2540s/iter; left time: 9133.4213s
	iters: 300, epoch: 3 | loss: 0.4352672
	speed: 0.2286s/iter; left time: 8200.0154s
Epoch: 3 cost time: 89.10115623474121
Epoch: 3, Steps: 369 | Train Loss: 0.454 Vali Loss: 0.716 Vali Acc: 0.680 Test Loss: 0.716 Test Acc: 0.680
Validation loss decreased (-0.679052 --> -0.679618).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5978708
	speed: 0.6789s/iter; left time: 24233.1532s
	iters: 200, epoch: 4 | loss: 0.2546610
	speed: 0.2273s/iter; left time: 8091.6066s
	iters: 300, epoch: 4 | loss: 0.4788388
	speed: 0.2397s/iter; left time: 8509.1349s
Epoch: 4 cost time: 85.98049902915955
Epoch: 4, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.723 Vali Acc: 0.678 Test Loss: 0.723 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2063269
	speed: 0.6953s/iter; left time: 24560.6155s
	iters: 200, epoch: 5 | loss: 0.4216187
	speed: 0.2179s/iter; left time: 7673.9832s
	iters: 300, epoch: 5 | loss: 0.3276379
	speed: 0.2194s/iter; left time: 7706.3762s
Epoch: 5 cost time: 82.58976626396179
Epoch: 5, Steps: 369 | Train Loss: 0.339 Vali Loss: 0.785 Vali Acc: 0.686 Test Loss: 0.785 Test Acc: 0.686
Validation loss decreased (-0.679618 --> -0.686144).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1828887
	speed: 0.7040s/iter; left time: 24610.1433s
	iters: 200, epoch: 6 | loss: 0.2168881
	speed: 0.2326s/iter; left time: 8108.9748s
	iters: 300, epoch: 6 | loss: 0.1789300
	speed: 0.2299s/iter; left time: 7991.6053s
Epoch: 6 cost time: 87.7583556175232
Epoch: 6, Steps: 369 | Train Loss: 0.312 Vali Loss: 0.878 Vali Acc: 0.656 Test Loss: 0.878 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3150270
	speed: 0.7254s/iter; left time: 25090.5620s
	iters: 200, epoch: 7 | loss: 0.2660745
	speed: 0.2395s/iter; left time: 8258.6486s
	iters: 300, epoch: 7 | loss: 0.1220874
	speed: 0.2309s/iter; left time: 7941.5793s
Epoch: 7 cost time: 88.03502249717712
Epoch: 7, Steps: 369 | Train Loss: 0.259 Vali Loss: 0.985 Vali Acc: 0.667 Test Loss: 0.985 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1569119
	speed: 0.7145s/iter; left time: 24448.4495s
	iters: 200, epoch: 8 | loss: 0.2427639
	speed: 0.2438s/iter; left time: 8316.9405s
	iters: 300, epoch: 8 | loss: 0.3780128
	speed: 0.2452s/iter; left time: 8341.7384s
Epoch: 8 cost time: 89.19358658790588
Epoch: 8, Steps: 369 | Train Loss: 0.227 Vali Loss: 0.944 Vali Acc: 0.658 Test Loss: 0.944 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1156229
	speed: 0.7047s/iter; left time: 23852.1555s
	iters: 200, epoch: 9 | loss: 0.1220198
	speed: 0.2120s/iter; left time: 7155.4864s
	iters: 300, epoch: 9 | loss: 0.0934007
	speed: 0.2212s/iter; left time: 7443.6373s
Epoch: 9 cost time: 81.51679587364197
Epoch: 9, Steps: 369 | Train Loss: 0.195 Vali Loss: 1.172 Vali Acc: 0.650 Test Loss: 1.172 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0703472
	speed: 0.6992s/iter; left time: 23408.6783s
	iters: 200, epoch: 10 | loss: 0.1142453
	speed: 0.2231s/iter; left time: 7448.0202s
	iters: 300, epoch: 10 | loss: 0.1033138
	speed: 0.2212s/iter; left time: 7362.3054s
Epoch: 10 cost time: 85.61505961418152
Epoch: 10, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.180 Vali Acc: 0.658 Test Loss: 1.180 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0884076
	speed: 0.6906s/iter; left time: 22867.9717s
	iters: 200, epoch: 11 | loss: 0.0995080
	speed: 0.2518s/iter; left time: 8311.9848s
	iters: 300, epoch: 11 | loss: 0.1063173
	speed: 0.2557s/iter; left time: 8414.5337s
Epoch: 11 cost time: 91.6166422367096
Epoch: 11, Steps: 369 | Train Loss: 0.164 Vali Loss: 1.225 Vali Acc: 0.674 Test Loss: 1.225 Test Acc: 0.674
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0079758
	speed: 0.7305s/iter; left time: 23919.5312s
	iters: 200, epoch: 12 | loss: 0.1351726
	speed: 0.2402s/iter; left time: 7840.2355s
	iters: 300, epoch: 12 | loss: 0.0812787
	speed: 0.2275s/iter; left time: 7403.1883s
Epoch: 12 cost time: 87.78876972198486
Epoch: 12, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.352 Vali Acc: 0.654 Test Loss: 1.352 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0083548
	speed: 0.7027s/iter; left time: 22747.6460s
	iters: 200, epoch: 13 | loss: 0.0502923
	speed: 0.2288s/iter; left time: 7385.0251s
	iters: 300, epoch: 13 | loss: 0.0765422
	speed: 0.2216s/iter; left time: 7128.4257s
Epoch: 13 cost time: 83.84970593452454
Epoch: 13, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.423 Vali Acc: 0.666 Test Loss: 1.423 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.5060861
	speed: 0.6997s/iter; left time: 22393.5940s
	iters: 200, epoch: 14 | loss: 0.2536683
	speed: 0.2211s/iter; left time: 7054.1120s
	iters: 300, epoch: 14 | loss: 0.1964374
	speed: 0.2274s/iter; left time: 7231.4413s
Epoch: 14 cost time: 83.85787963867188
Epoch: 14, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.559 Vali Acc: 0.668 Test Loss: 1.559 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1092775
	speed: 0.6881s/iter; left time: 21769.4694s
	iters: 200, epoch: 15 | loss: 0.0406133
	speed: 0.2175s/iter; left time: 6859.0760s
	iters: 300, epoch: 15 | loss: 0.1476488
	speed: 0.2176s/iter; left time: 6841.7851s
Epoch: 15 cost time: 81.13956952095032
Epoch: 15, Steps: 369 | Train Loss: 0.117 Vali Loss: 1.543 Vali Acc: 0.663 Test Loss: 1.543 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6861520998864926
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7238525
	speed: 0.2478s/iter; left time: 9118.6573s
	iters: 200, epoch: 1 | loss: 0.7932239
	speed: 0.2471s/iter; left time: 9067.2528s
	iters: 300, epoch: 1 | loss: 0.6546542
	speed: 0.2406s/iter; left time: 8805.9609s
Epoch: 1 cost time: 90.1539409160614
Epoch: 1, Steps: 369 | Train Loss: 0.682 Vali Loss: 0.679 Vali Acc: 0.605 Test Loss: 0.679 Test Acc: 0.605
Validation loss decreased (inf --> -0.605271).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4834111
	speed: 0.7206s/iter; left time: 26251.3288s
	iters: 200, epoch: 2 | loss: 0.2776850
	speed: 0.2327s/iter; left time: 8453.0132s
	iters: 300, epoch: 2 | loss: 0.5771108
	speed: 0.2212s/iter; left time: 8016.0660s
Epoch: 2 cost time: 84.77411389350891
Epoch: 2, Steps: 369 | Train Loss: 0.555 Vali Loss: 0.642 Vali Acc: 0.677 Test Loss: 0.642 Test Acc: 0.677
Validation loss decreased (-0.605271 --> -0.676781).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3301504
	speed: 0.6883s/iter; left time: 24820.5226s
	iters: 200, epoch: 3 | loss: 0.3612761
	speed: 0.2282s/iter; left time: 8206.5897s
	iters: 300, epoch: 3 | loss: 0.4909196
	speed: 0.2356s/iter; left time: 8448.5266s
Epoch: 3 cost time: 85.49060463905334
Epoch: 3, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.713 Vali Acc: 0.669 Test Loss: 0.713 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5592971
	speed: 0.6922s/iter; left time: 24708.3207s
	iters: 200, epoch: 4 | loss: 0.2520900
	speed: 0.2278s/iter; left time: 8107.6661s
	iters: 300, epoch: 4 | loss: 0.4054462
	speed: 0.2265s/iter; left time: 8039.6397s
Epoch: 4 cost time: 84.12673020362854
Epoch: 4, Steps: 369 | Train Loss: 0.402 Vali Loss: 0.742 Vali Acc: 0.678 Test Loss: 0.742 Test Acc: 0.678
Validation loss decreased (-0.676781 --> -0.678483).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1803679
	speed: 0.6908s/iter; left time: 24403.2680s
	iters: 200, epoch: 5 | loss: 0.3672806
	speed: 0.2276s/iter; left time: 8015.9591s
	iters: 300, epoch: 5 | loss: 0.3256775
	speed: 0.2417s/iter; left time: 8490.1034s
Epoch: 5 cost time: 86.599604845047
Epoch: 5, Steps: 369 | Train Loss: 0.344 Vali Loss: 0.776 Vali Acc: 0.677 Test Loss: 0.776 Test Acc: 0.677
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2447777
	speed: 0.7085s/iter; left time: 24766.9037s
	iters: 200, epoch: 6 | loss: 0.2498257
	speed: 0.2341s/iter; left time: 8158.4648s
	iters: 300, epoch: 6 | loss: 0.1491304
	speed: 0.2320s/iter; left time: 8062.1314s
Epoch: 6 cost time: 86.21922278404236
Epoch: 6, Steps: 369 | Train Loss: 0.311 Vali Loss: 0.878 Vali Acc: 0.660 Test Loss: 0.878 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3531468
	speed: 0.6854s/iter; left time: 23705.8193s
	iters: 200, epoch: 7 | loss: 0.1029198
	speed: 0.2267s/iter; left time: 7817.1501s
	iters: 300, epoch: 7 | loss: 0.2342931
	speed: 0.2344s/iter; left time: 8060.7692s
Epoch: 7 cost time: 85.53904008865356
Epoch: 7, Steps: 369 | Train Loss: 0.259 Vali Loss: 0.932 Vali Acc: 0.675 Test Loss: 0.932 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1890890
	speed: 0.6936s/iter; left time: 23733.9463s
	iters: 200, epoch: 8 | loss: 0.4069911
	speed: 0.2268s/iter; left time: 7739.4988s
	iters: 300, epoch: 8 | loss: 0.2835016
	speed: 0.2316s/iter; left time: 7878.0453s
Epoch: 8 cost time: 85.2951431274414
Epoch: 8, Steps: 369 | Train Loss: 0.226 Vali Loss: 0.922 Vali Acc: 0.669 Test Loss: 0.922 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0663626
	speed: 0.6892s/iter; left time: 23328.7962s
	iters: 200, epoch: 9 | loss: 0.0398021
	speed: 0.2331s/iter; left time: 7867.7718s
	iters: 300, epoch: 9 | loss: 0.2473387
	speed: 0.2346s/iter; left time: 7892.3762s
Epoch: 9 cost time: 86.10364317893982
Epoch: 9, Steps: 369 | Train Loss: 0.199 Vali Loss: 1.162 Vali Acc: 0.658 Test Loss: 1.162 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0874689
	speed: 0.6873s/iter; left time: 23011.5385s
	iters: 200, epoch: 10 | loss: 0.0564712
	speed: 0.2417s/iter; left time: 8066.6206s
	iters: 300, epoch: 10 | loss: 0.0484583
	speed: 0.2380s/iter; left time: 7920.0458s
Epoch: 10 cost time: 88.34832048416138
Epoch: 10, Steps: 369 | Train Loss: 0.180 Vali Loss: 1.147 Vali Acc: 0.668 Test Loss: 1.147 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0691488
	speed: 0.7232s/iter; left time: 23944.7440s
	iters: 200, epoch: 11 | loss: 0.1005574
	speed: 0.2386s/iter; left time: 7878.0164s
	iters: 300, epoch: 11 | loss: 0.0493854
	speed: 0.2441s/iter; left time: 8033.0427s
Epoch: 11 cost time: 90.27205276489258
Epoch: 11, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.223 Vali Acc: 0.678 Test Loss: 1.223 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0111551
	speed: 0.7345s/iter; left time: 24050.4645s
	iters: 200, epoch: 12 | loss: 0.0244758
	speed: 0.2487s/iter; left time: 8118.7804s
	iters: 300, epoch: 12 | loss: 0.0550950
	speed: 0.2533s/iter; left time: 8242.4044s
Epoch: 12 cost time: 91.87609791755676
Epoch: 12, Steps: 369 | Train Loss: 0.153 Vali Loss: 1.325 Vali Acc: 0.659 Test Loss: 1.325 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0727642
	speed: 0.7337s/iter; left time: 23751.3932s
	iters: 200, epoch: 13 | loss: 0.0708176
	speed: 0.2360s/iter; left time: 7617.1510s
	iters: 300, epoch: 13 | loss: 0.2924308
	speed: 0.2372s/iter; left time: 7630.8251s
Epoch: 13 cost time: 89.67409253120422
Epoch: 13, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.479 Vali Acc: 0.653 Test Loss: 1.479 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0395626
	speed: 0.7253s/iter; left time: 23213.0222s
	iters: 200, epoch: 14 | loss: 0.1439638
	speed: 0.2532s/iter; left time: 8078.0933s
	iters: 300, epoch: 14 | loss: 0.0695098
	speed: 0.2422s/iter; left time: 7701.7790s
Epoch: 14 cost time: 89.89979410171509
Epoch: 14, Steps: 369 | Train Loss: 0.122 Vali Loss: 1.432 Vali Acc: 0.660 Test Loss: 1.432 Test Acc: 0.660
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6784903518728718
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7330452
	speed: 0.2490s/iter; left time: 9165.1331s
	iters: 200, epoch: 1 | loss: 0.8624708
	speed: 0.2426s/iter; left time: 8902.5280s
	iters: 300, epoch: 1 | loss: 0.6428596
	speed: 0.2390s/iter; left time: 8748.5106s
Epoch: 1 cost time: 89.92898678779602
Epoch: 1, Steps: 369 | Train Loss: 0.689 Vali Loss: 0.671 Vali Acc: 0.603 Test Loss: 0.671 Test Acc: 0.603
Validation loss decreased (inf --> -0.603285).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4459133
	speed: 0.7254s/iter; left time: 26428.5494s
	iters: 200, epoch: 2 | loss: 0.2911071
	speed: 0.2328s/iter; left time: 8457.4913s
	iters: 300, epoch: 2 | loss: 0.6446807
	speed: 0.2420s/iter; left time: 8767.7330s
Epoch: 2 cost time: 88.26439166069031
Epoch: 2, Steps: 369 | Train Loss: 0.551 Vali Loss: 0.641 Vali Acc: 0.670 Test Loss: 0.641 Test Acc: 0.670
Validation loss decreased (-0.603285 --> -0.669687).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3715763
	speed: 0.7386s/iter; left time: 26636.6848s
	iters: 200, epoch: 3 | loss: 0.3578265
	speed: 0.2437s/iter; left time: 8763.6635s
	iters: 300, epoch: 3 | loss: 0.4197487
	speed: 0.2397s/iter; left time: 8597.1587s
Epoch: 3 cost time: 90.65526556968689
Epoch: 3, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.703 Vali Acc: 0.663 Test Loss: 0.703 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6128155
	speed: 0.7471s/iter; left time: 26665.5780s
	iters: 200, epoch: 4 | loss: 0.2845681
	speed: 0.2213s/iter; left time: 7878.2388s
	iters: 300, epoch: 4 | loss: 0.3778043
	speed: 0.2272s/iter; left time: 8064.2592s
Epoch: 4 cost time: 84.69195890426636
Epoch: 4, Steps: 369 | Train Loss: 0.406 Vali Loss: 0.719 Vali Acc: 0.673 Test Loss: 0.719 Test Acc: 0.673
Validation loss decreased (-0.669687 --> -0.672808).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1987025
	speed: 0.7053s/iter; left time: 24912.9660s
	iters: 200, epoch: 5 | loss: 0.4680415
	speed: 0.2274s/iter; left time: 8010.1805s
	iters: 300, epoch: 5 | loss: 0.3882150
	speed: 0.2179s/iter; left time: 7655.4113s
Epoch: 5 cost time: 84.44474172592163
Epoch: 5, Steps: 369 | Train Loss: 0.346 Vali Loss: 0.789 Vali Acc: 0.669 Test Loss: 0.789 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1480750
	speed: 0.7002s/iter; left time: 24476.9008s
	iters: 200, epoch: 6 | loss: 0.1745731
	speed: 0.2253s/iter; left time: 7853.4170s
	iters: 300, epoch: 6 | loss: 0.1883525
	speed: 0.2355s/iter; left time: 8184.5937s
Epoch: 6 cost time: 85.07020092010498
Epoch: 6, Steps: 369 | Train Loss: 0.312 Vali Loss: 0.859 Vali Acc: 0.657 Test Loss: 0.859 Test Acc: 0.657
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3373026
	speed: 0.7229s/iter; left time: 25001.9894s
	iters: 200, epoch: 7 | loss: 0.1919177
	speed: 0.2242s/iter; left time: 7731.3219s
	iters: 300, epoch: 7 | loss: 0.2083270
	speed: 0.2257s/iter; left time: 7760.9601s
Epoch: 7 cost time: 86.74607610702515
Epoch: 7, Steps: 369 | Train Loss: 0.265 Vali Loss: 0.939 Vali Acc: 0.665 Test Loss: 0.939 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2040710
	speed: 0.6979s/iter; left time: 23881.7703s
	iters: 200, epoch: 8 | loss: 0.3004630
	speed: 0.2353s/iter; left time: 8027.4009s
	iters: 300, epoch: 8 | loss: 0.1222394
	speed: 0.2257s/iter; left time: 7679.1440s
Epoch: 8 cost time: 84.85568618774414
Epoch: 8, Steps: 369 | Train Loss: 0.234 Vali Loss: 0.959 Vali Acc: 0.653 Test Loss: 0.959 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1134458
	speed: 0.7060s/iter; left time: 23898.3255s
	iters: 200, epoch: 9 | loss: 0.0554815
	speed: 0.2259s/iter; left time: 7625.3702s
	iters: 300, epoch: 9 | loss: 0.4978511
	speed: 0.2250s/iter; left time: 7571.0961s
Epoch: 9 cost time: 83.7375795841217
Epoch: 9, Steps: 369 | Train Loss: 0.193 Vali Loss: 1.170 Vali Acc: 0.654 Test Loss: 1.170 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0563660
	speed: 0.6975s/iter; left time: 23352.7450s
	iters: 200, epoch: 10 | loss: 0.0656593
	speed: 0.2343s/iter; left time: 7819.3646s
	iters: 300, epoch: 10 | loss: 0.1532265
	speed: 0.2410s/iter; left time: 8021.1787s
Epoch: 10 cost time: 88.0491259098053
Epoch: 10, Steps: 369 | Train Loss: 0.169 Vali Loss: 1.172 Vali Acc: 0.668 Test Loss: 1.172 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0237035
	speed: 0.6974s/iter; left time: 23091.2165s
	iters: 200, epoch: 11 | loss: 0.0913466
	speed: 0.2279s/iter; left time: 7523.6368s
	iters: 300, epoch: 11 | loss: 0.0864766
	speed: 0.2148s/iter; left time: 7070.8988s
Epoch: 11 cost time: 82.02518653869629
Epoch: 11, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.296 Vali Acc: 0.663 Test Loss: 1.296 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0155208
	speed: 0.6783s/iter; left time: 22209.8400s
	iters: 200, epoch: 12 | loss: 0.1593127
	speed: 0.2217s/iter; left time: 7236.8592s
	iters: 300, epoch: 12 | loss: 0.1165581
	speed: 0.2136s/iter; left time: 6952.4408s
Epoch: 12 cost time: 82.959641456604
Epoch: 12, Steps: 369 | Train Loss: 0.149 Vali Loss: 1.276 Vali Acc: 0.659 Test Loss: 1.276 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1240408
	speed: 0.6908s/iter; left time: 22361.8560s
	iters: 200, epoch: 13 | loss: 0.0148091
	speed: 0.2042s/iter; left time: 6590.0893s
	iters: 300, epoch: 13 | loss: 0.1752421
	speed: 0.2238s/iter; left time: 7201.9174s
Epoch: 13 cost time: 78.24579501152039
Epoch: 13, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.451 Vali Acc: 0.654 Test Loss: 1.451 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0224877
	speed: 0.6771s/iter; left time: 21670.4922s
	iters: 200, epoch: 14 | loss: 0.1502523
	speed: 0.2265s/iter; left time: 7224.9052s
	iters: 300, epoch: 14 | loss: 0.0444383
	speed: 0.2286s/iter; left time: 7271.1082s
Epoch: 14 cost time: 84.44089889526367
Epoch: 14, Steps: 369 | Train Loss: 0.115 Vali Loss: 1.606 Vali Acc: 0.652 Test Loss: 1.606 Test Acc: 0.652
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7924489
	speed: 0.2435s/iter; left time: 8960.7542s
	iters: 200, epoch: 1 | loss: 0.8080717
	speed: 0.2356s/iter; left time: 8645.9352s
	iters: 300, epoch: 1 | loss: 0.6079965
	speed: 0.2125s/iter; left time: 7775.8951s
Epoch: 1 cost time: 85.59926128387451
Epoch: 1, Steps: 369 | Train Loss: 0.703 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (inf --> -0.569800).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4969376
	speed: 0.6997s/iter; left time: 25490.6913s
	iters: 200, epoch: 2 | loss: 0.4191471
	speed: 0.2239s/iter; left time: 8134.0253s
	iters: 300, epoch: 2 | loss: 0.5784125
	speed: 0.2281s/iter; left time: 8265.4532s
Epoch: 2 cost time: 83.14748001098633
Epoch: 2, Steps: 369 | Train Loss: 0.575 Vali Loss: 0.658 Vali Acc: 0.659 Test Loss: 0.658 Test Acc: 0.659
Validation loss decreased (-0.569800 --> -0.659471).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4361227
	speed: 0.6708s/iter; left time: 24192.8170s
	iters: 200, epoch: 3 | loss: 0.3319764
	speed: 0.2227s/iter; left time: 8009.8768s
	iters: 300, epoch: 3 | loss: 0.5791525
	speed: 0.2234s/iter; left time: 8012.6934s
Epoch: 3 cost time: 83.1957380771637
Epoch: 3, Steps: 369 | Train Loss: 0.476 Vali Loss: 0.680 Vali Acc: 0.677 Test Loss: 0.680 Test Acc: 0.677
Validation loss decreased (-0.659471 --> -0.677065).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4777068
	speed: 0.6710s/iter; left time: 23951.0906s
	iters: 200, epoch: 4 | loss: 0.3469477
	speed: 0.2199s/iter; left time: 7826.3938s
	iters: 300, epoch: 4 | loss: 0.2801190
	speed: 0.2261s/iter; left time: 8025.3866s
Epoch: 4 cost time: 82.8025872707367
Epoch: 4, Steps: 369 | Train Loss: 0.422 Vali Loss: 0.726 Vali Acc: 0.675 Test Loss: 0.726 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1700729
	speed: 0.6810s/iter; left time: 24057.9758s
	iters: 200, epoch: 5 | loss: 0.3423674
	speed: 0.2181s/iter; left time: 7682.9865s
	iters: 300, epoch: 5 | loss: 0.5672189
	speed: 0.2331s/iter; left time: 8186.5074s
Epoch: 5 cost time: 82.54094219207764
Epoch: 5, Steps: 369 | Train Loss: 0.363 Vali Loss: 0.804 Vali Acc: 0.667 Test Loss: 0.804 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2018800
	speed: 0.6826s/iter; left time: 23861.6397s
	iters: 200, epoch: 6 | loss: 0.2957632
	speed: 0.2191s/iter; left time: 7637.5004s
	iters: 300, epoch: 6 | loss: 0.1920421
	speed: 0.2145s/iter; left time: 7456.2179s
Epoch: 6 cost time: 82.90674614906311
Epoch: 6, Steps: 369 | Train Loss: 0.325 Vali Loss: 0.886 Vali Acc: 0.651 Test Loss: 0.886 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.3534062
	speed: 0.6902s/iter; left time: 23871.5931s
	iters: 200, epoch: 7 | loss: 0.1163117
	speed: 0.2129s/iter; left time: 7342.4307s
	iters: 300, epoch: 7 | loss: 0.1453743
	speed: 0.2252s/iter; left time: 7743.8312s
Epoch: 7 cost time: 82.4673228263855
Epoch: 7, Steps: 369 | Train Loss: 0.286 Vali Loss: 0.922 Vali Acc: 0.663 Test Loss: 0.922 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1155603
	speed: 0.6949s/iter; left time: 23779.7439s
	iters: 200, epoch: 8 | loss: 0.2212482
	speed: 0.2277s/iter; left time: 7769.0080s
	iters: 300, epoch: 8 | loss: 0.1987157
	speed: 0.2297s/iter; left time: 7813.5853s
Epoch: 8 cost time: 84.48992872238159
Epoch: 8, Steps: 369 | Train Loss: 0.249 Vali Loss: 0.915 Vali Acc: 0.658 Test Loss: 0.915 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1810972
	speed: 0.6734s/iter; left time: 22794.1141s
	iters: 200, epoch: 9 | loss: 0.0979181
	speed: 0.2231s/iter; left time: 7530.2812s
	iters: 300, epoch: 9 | loss: 0.2505784
	speed: 0.2279s/iter; left time: 7669.4673s
Epoch: 9 cost time: 83.38428473472595
Epoch: 9, Steps: 369 | Train Loss: 0.209 Vali Loss: 1.131 Vali Acc: 0.667 Test Loss: 1.131 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0692504
	speed: 0.6736s/iter; left time: 22551.9631s
	iters: 200, epoch: 10 | loss: 0.0930518
	speed: 0.2206s/iter; left time: 7363.9503s
	iters: 300, epoch: 10 | loss: 0.1768060
	speed: 0.2208s/iter; left time: 7347.5692s
Epoch: 10 cost time: 82.70894646644592
Epoch: 10, Steps: 369 | Train Loss: 0.175 Vali Loss: 1.147 Vali Acc: 0.663 Test Loss: 1.147 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0399032
	speed: 0.6945s/iter; left time: 22996.1694s
	iters: 200, epoch: 11 | loss: 0.0611247
	speed: 0.2244s/iter; left time: 7408.0466s
	iters: 300, epoch: 11 | loss: 0.0530295
	speed: 0.2178s/iter; left time: 7168.4358s
Epoch: 11 cost time: 82.76357197761536
Epoch: 11, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.258 Vali Acc: 0.666 Test Loss: 1.258 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0751434
	speed: 0.6822s/iter; left time: 22336.7814s
	iters: 200, epoch: 12 | loss: 0.1366549
	speed: 0.2336s/iter; left time: 7625.6171s
	iters: 300, epoch: 12 | loss: 0.0537166
	speed: 0.2355s/iter; left time: 7662.1577s
Epoch: 12 cost time: 88.26667976379395
Epoch: 12, Steps: 369 | Train Loss: 0.161 Vali Loss: 1.289 Vali Acc: 0.661 Test Loss: 1.289 Test Acc: 0.661
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0441113
	speed: 0.7281s/iter; left time: 23570.5995s
	iters: 200, epoch: 13 | loss: 0.0389555
	speed: 0.2311s/iter; left time: 7456.9064s
	iters: 300, epoch: 13 | loss: 0.0946204
	speed: 0.2222s/iter; left time: 7147.2384s
Epoch: 13 cost time: 86.17210960388184
Epoch: 13, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.309 Vali Acc: 0.664 Test Loss: 1.309 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6770715096481271
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7592146
	speed: 0.2553s/iter; left time: 9397.0910s
	iters: 200, epoch: 1 | loss: 0.8510096
	speed: 0.2339s/iter; left time: 8584.4643s
	iters: 300, epoch: 1 | loss: 0.6842736
	speed: 0.2402s/iter; left time: 8791.3166s
Epoch: 1 cost time: 90.0516254901886
Epoch: 1, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.696 Vali Acc: 0.553 Test Loss: 0.696 Test Acc: 0.553
Validation loss decreased (inf --> -0.553342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4393252
	speed: 0.7217s/iter; left time: 26292.5574s
	iters: 200, epoch: 2 | loss: 0.3595038
	speed: 0.2529s/iter; left time: 9190.0044s
	iters: 300, epoch: 2 | loss: 0.7396052
	speed: 0.2577s/iter; left time: 9337.7007s
Epoch: 2 cost time: 94.48234724998474
Epoch: 2, Steps: 369 | Train Loss: 0.598 Vali Loss: 0.664 Vali Acc: 0.650 Test Loss: 0.664 Test Acc: 0.650
Validation loss decreased (-0.553342 --> -0.650107).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4894648
	speed: 0.7717s/iter; left time: 27831.1670s
	iters: 200, epoch: 3 | loss: 0.2600762
	speed: 0.2317s/iter; left time: 8332.8279s
	iters: 300, epoch: 3 | loss: 0.5169941
	speed: 0.2497s/iter; left time: 8953.7287s
Epoch: 3 cost time: 91.2225649356842
Epoch: 3, Steps: 369 | Train Loss: 0.483 Vali Loss: 0.713 Vali Acc: 0.666 Test Loss: 0.713 Test Acc: 0.666
Validation loss decreased (-0.650107 --> -0.666281).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7275040
	speed: 0.7092s/iter; left time: 25315.9650s
	iters: 200, epoch: 4 | loss: 0.4142281
	speed: 0.2324s/iter; left time: 8273.3643s
	iters: 300, epoch: 4 | loss: 0.3428020
	speed: 0.2130s/iter; left time: 7561.0844s
Epoch: 4 cost time: 84.17085766792297
Epoch: 4, Steps: 369 | Train Loss: 0.429 Vali Loss: 0.759 Vali Acc: 0.675 Test Loss: 0.759 Test Acc: 0.675
Validation loss decreased (-0.666281 --> -0.674510).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1084822
	speed: 0.6947s/iter; left time: 24540.6851s
	iters: 200, epoch: 5 | loss: 0.8867312
	speed: 0.2428s/iter; left time: 8554.0287s
	iters: 300, epoch: 5 | loss: 0.5730038
	speed: 0.2300s/iter; left time: 8077.0506s
Epoch: 5 cost time: 86.17052793502808
Epoch: 5, Steps: 369 | Train Loss: 0.368 Vali Loss: 0.775 Vali Acc: 0.676 Test Loss: 0.775 Test Acc: 0.676
Validation loss decreased (-0.674510 --> -0.675645).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3288147
	speed: 0.6860s/iter; left time: 23979.0798s
	iters: 200, epoch: 6 | loss: 0.3571056
	speed: 0.2609s/iter; left time: 9094.7346s
	iters: 300, epoch: 6 | loss: 0.3825955
	speed: 0.2362s/iter; left time: 8210.9091s
Epoch: 6 cost time: 87.98937129974365
Epoch: 6, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.916 Vali Acc: 0.652 Test Loss: 0.916 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2465841
	speed: 0.6910s/iter; left time: 23900.1194s
	iters: 200, epoch: 7 | loss: 0.1245703
	speed: 0.2361s/iter; left time: 8140.8666s
	iters: 300, epoch: 7 | loss: 0.2439206
	speed: 0.2383s/iter; left time: 8194.8979s
Epoch: 7 cost time: 85.97028493881226
Epoch: 7, Steps: 369 | Train Loss: 0.284 Vali Loss: 0.943 Vali Acc: 0.661 Test Loss: 0.943 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1085713
	speed: 0.6959s/iter; left time: 23813.2993s
	iters: 200, epoch: 8 | loss: 0.1450559
	speed: 0.2336s/iter; left time: 7969.6406s
	iters: 300, epoch: 8 | loss: 0.3431562
	speed: 0.2243s/iter; left time: 7630.8871s
Epoch: 8 cost time: 85.30487966537476
Epoch: 8, Steps: 369 | Train Loss: 0.255 Vali Loss: 0.997 Vali Acc: 0.656 Test Loss: 0.997 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1527071
	speed: 0.6918s/iter; left time: 23416.2461s
	iters: 200, epoch: 9 | loss: 0.1374121
	speed: 0.2272s/iter; left time: 7668.1812s
	iters: 300, epoch: 9 | loss: 0.0822372
	speed: 0.2155s/iter; left time: 7250.2714s
Epoch: 9 cost time: 82.00518584251404
Epoch: 9, Steps: 369 | Train Loss: 0.212 Vali Loss: 1.140 Vali Acc: 0.666 Test Loss: 1.140 Test Acc: 0.666
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0324589
	speed: 0.6908s/iter; left time: 23127.2177s
	iters: 200, epoch: 10 | loss: 0.1235952
	speed: 0.2228s/iter; left time: 7437.4678s
	iters: 300, epoch: 10 | loss: 0.3532043
	speed: 0.2273s/iter; left time: 7565.6022s
Epoch: 10 cost time: 84.66446828842163
Epoch: 10, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.254 Vali Acc: 0.656 Test Loss: 1.254 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1389984
	speed: 0.7020s/iter; left time: 23244.6713s
	iters: 200, epoch: 11 | loss: 0.0756624
	speed: 0.2327s/iter; left time: 7681.5107s
	iters: 300, epoch: 11 | loss: 0.2044155
	speed: 0.2225s/iter; left time: 7323.8706s
Epoch: 11 cost time: 83.4290509223938
Epoch: 11, Steps: 369 | Train Loss: 0.173 Vali Loss: 1.294 Vali Acc: 0.659 Test Loss: 1.294 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1260358
	speed: 0.6995s/iter; left time: 22904.2370s
	iters: 200, epoch: 12 | loss: 0.1348253
	speed: 0.2214s/iter; left time: 7227.7880s
	iters: 300, epoch: 12 | loss: 0.0557495
	speed: 0.2208s/iter; left time: 7186.1003s
Epoch: 12 cost time: 83.21525454521179
Epoch: 12, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.308 Vali Acc: 0.656 Test Loss: 1.308 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2012198
	speed: 0.7157s/iter; left time: 23167.9115s
	iters: 200, epoch: 13 | loss: 0.7959067
	speed: 0.2231s/iter; left time: 7200.5212s
	iters: 300, epoch: 13 | loss: 0.1349432
	speed: 0.2240s/iter; left time: 7205.9210s
Epoch: 13 cost time: 83.96605277061462
Epoch: 13, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.373 Vali Acc: 0.652 Test Loss: 1.373 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.1340925
	speed: 0.7049s/iter; left time: 22560.9478s
	iters: 200, epoch: 14 | loss: 0.0270907
	speed: 0.2257s/iter; left time: 7201.9343s
	iters: 300, epoch: 14 | loss: 0.0237526
	speed: 0.2252s/iter; left time: 7161.2270s
Epoch: 14 cost time: 83.62623190879822
Epoch: 14, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.484 Vali Acc: 0.655 Test Loss: 1.484 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0381069
	speed: 0.6962s/iter; left time: 22023.2157s
	iters: 200, epoch: 15 | loss: 0.0408091
	speed: 0.2036s/iter; left time: 6419.0760s
	iters: 300, epoch: 15 | loss: 0.0850311
	speed: 0.2167s/iter; left time: 6812.6563s
Epoch: 15 cost time: 80.94795036315918
Epoch: 15, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.588 Vali Acc: 0.653 Test Loss: 1.588 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6756526674233825
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.8742347
	speed: 0.2412s/iter; left time: 8877.6543s
	iters: 200, epoch: 1 | loss: 0.8388706
	speed: 0.2450s/iter; left time: 8990.4007s
	iters: 300, epoch: 1 | loss: 0.6810296
	speed: 0.2417s/iter; left time: 8847.1370s
Epoch: 1 cost time: 89.51048398017883
Epoch: 1, Steps: 369 | Train Loss: 0.721 Vali Loss: 0.694 Vali Acc: 0.549 Test Loss: 0.694 Test Acc: 0.549
Validation loss decreased (inf --> -0.549369).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5676341
	speed: 0.6973s/iter; left time: 25404.1458s
	iters: 200, epoch: 2 | loss: 0.4283368
	speed: 0.2237s/iter; left time: 8127.1991s
	iters: 300, epoch: 2 | loss: 0.6864162
	speed: 0.2401s/iter; left time: 8697.5142s
Epoch: 2 cost time: 84.14279007911682
Epoch: 2, Steps: 369 | Train Loss: 0.612 Vali Loss: 0.656 Vali Acc: 0.650 Test Loss: 0.656 Test Acc: 0.650
Validation loss decreased (-0.549369 --> -0.649539).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5431726
	speed: 0.6815s/iter; left time: 24575.7612s
	iters: 200, epoch: 3 | loss: 0.2289525
	speed: 0.2268s/iter; left time: 8156.5438s
	iters: 300, epoch: 3 | loss: 0.4780551
	speed: 0.2463s/iter; left time: 8831.2812s
Epoch: 3 cost time: 88.9753646850586
Epoch: 3, Steps: 369 | Train Loss: 0.504 Vali Loss: 0.709 Vali Acc: 0.673 Test Loss: 0.709 Test Acc: 0.673
Validation loss decreased (-0.649539 --> -0.673375).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4714748
	speed: 0.7316s/iter; left time: 26115.2761s
	iters: 200, epoch: 4 | loss: 0.5023991
	speed: 0.2412s/iter; left time: 8583.8459s
	iters: 300, epoch: 4 | loss: 0.5153005
	speed: 0.2314s/iter; left time: 8212.3776s
Epoch: 4 cost time: 87.61527228355408
Epoch: 4, Steps: 369 | Train Loss: 0.446 Vali Loss: 0.746 Vali Acc: 0.669 Test Loss: 0.746 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2916651
	speed: 0.6573s/iter; left time: 23218.7860s
	iters: 200, epoch: 5 | loss: 0.4437860
	speed: 0.2226s/iter; left time: 7839.9742s
	iters: 300, epoch: 5 | loss: 0.6670931
	speed: 0.2052s/iter; left time: 7207.5054s
Epoch: 5 cost time: 83.09718132019043
Epoch: 5, Steps: 369 | Train Loss: 0.386 Vali Loss: 0.791 Vali Acc: 0.671 Test Loss: 0.791 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1918649
	speed: 0.7131s/iter; left time: 24928.4730s
	iters: 200, epoch: 6 | loss: 0.3936465
	speed: 0.2307s/iter; left time: 8039.6100s
	iters: 300, epoch: 6 | loss: 0.2837800
	speed: 0.2261s/iter; left time: 7858.6022s
Epoch: 6 cost time: 84.57229232788086
Epoch: 6, Steps: 369 | Train Loss: 0.357 Vali Loss: 0.861 Vali Acc: 0.661 Test Loss: 0.861 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2862523
	speed: 0.6881s/iter; left time: 23798.7379s
	iters: 200, epoch: 7 | loss: 0.0815117
	speed: 0.2369s/iter; left time: 8171.1355s
	iters: 300, epoch: 7 | loss: 0.0933966
	speed: 0.2328s/iter; left time: 8006.0588s
Epoch: 7 cost time: 84.81572341918945
Epoch: 7, Steps: 369 | Train Loss: 0.311 Vali Loss: 0.896 Vali Acc: 0.672 Test Loss: 0.896 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0526140
	speed: 0.7209s/iter; left time: 24667.2077s
	iters: 200, epoch: 8 | loss: 0.3837765
	speed: 0.2357s/iter; left time: 8041.8232s
	iters: 300, epoch: 8 | loss: 0.3581086
	speed: 0.2292s/iter; left time: 7795.3495s
Epoch: 8 cost time: 88.36317563056946
Epoch: 8, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.968 Vali Acc: 0.657 Test Loss: 0.968 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0919597
	speed: 0.7134s/iter; left time: 24146.6604s
	iters: 200, epoch: 9 | loss: 0.1241657
	speed: 0.2407s/iter; left time: 8123.9950s
	iters: 300, epoch: 9 | loss: 0.2113250
	speed: 0.2292s/iter; left time: 7712.7390s
Epoch: 9 cost time: 86.46726036071777
Epoch: 9, Steps: 369 | Train Loss: 0.239 Vali Loss: 1.054 Vali Acc: 0.669 Test Loss: 1.054 Test Acc: 0.669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0695729
	speed: 0.6706s/iter; left time: 22451.1425s
	iters: 200, epoch: 10 | loss: 0.1876511
	speed: 0.2172s/iter; left time: 7248.9731s
	iters: 300, epoch: 10 | loss: 0.3206051
	speed: 0.2189s/iter; left time: 7285.2920s
Epoch: 10 cost time: 81.03865814208984
Epoch: 10, Steps: 369 | Train Loss: 0.220 Vali Loss: 1.104 Vali Acc: 0.658 Test Loss: 1.104 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1087266
	speed: 0.6906s/iter; left time: 22866.8395s
	iters: 200, epoch: 11 | loss: 0.1957346
	speed: 0.2363s/iter; left time: 7801.6705s
	iters: 300, epoch: 11 | loss: 0.2536343
	speed: 0.2402s/iter; left time: 7903.6045s
Epoch: 11 cost time: 88.09236001968384
Epoch: 11, Steps: 369 | Train Loss: 0.189 Vali Loss: 1.182 Vali Acc: 0.675 Test Loss: 1.182 Test Acc: 0.675
Validation loss decreased (-0.673375 --> -0.675357).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0729477
	speed: 0.7135s/iter; left time: 23360.3715s
	iters: 200, epoch: 12 | loss: 0.3437557
	speed: 0.2191s/iter; left time: 7152.2908s
	iters: 300, epoch: 12 | loss: 0.1639023
	speed: 0.2232s/iter; left time: 7262.1404s
Epoch: 12 cost time: 82.74648213386536
Epoch: 12, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.228 Vali Acc: 0.659 Test Loss: 1.228 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0405733
	speed: 0.7019s/iter; left time: 22722.2228s
	iters: 200, epoch: 13 | loss: 0.0647364
	speed: 0.2373s/iter; left time: 7659.2177s
	iters: 300, epoch: 13 | loss: 0.1151755
	speed: 0.2371s/iter; left time: 7628.9216s
Epoch: 13 cost time: 89.77921724319458
Epoch: 13, Steps: 369 | Train Loss: 0.167 Vali Loss: 1.227 Vali Acc: 0.663 Test Loss: 1.227 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.2837158
	speed: 0.7190s/iter; left time: 23009.4953s
	iters: 200, epoch: 14 | loss: 0.2362322
	speed: 0.2254s/iter; left time: 7190.3920s
	iters: 300, epoch: 14 | loss: 0.0179048
	speed: 0.2337s/iter; left time: 7432.7636s
Epoch: 14 cost time: 86.18220090866089
Epoch: 14, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.361 Vali Acc: 0.653 Test Loss: 1.361 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1163597
	speed: 0.7089s/iter; left time: 22424.7324s
	iters: 200, epoch: 15 | loss: 0.1950093
	speed: 0.2461s/iter; left time: 7760.7547s
	iters: 300, epoch: 15 | loss: 0.0140301
	speed: 0.2357s/iter; left time: 7409.3075s
Epoch: 15 cost time: 88.88615560531616
Epoch: 15, Steps: 369 | Train Loss: 0.131 Vali Loss: 1.416 Vali Acc: 0.660 Test Loss: 1.416 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0123908
	speed: 0.6698s/iter; left time: 20941.9002s
	iters: 200, epoch: 16 | loss: 0.2221710
	speed: 0.2236s/iter; left time: 6968.5109s
	iters: 300, epoch: 16 | loss: 0.3885279
	speed: 0.2229s/iter; left time: 6924.8334s
Epoch: 16 cost time: 81.4796736240387
Epoch: 16, Steps: 369 | Train Loss: 0.136 Vali Loss: 1.542 Vali Acc: 0.652 Test Loss: 1.542 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0849268
	speed: 0.7045s/iter; left time: 21765.4428s
	iters: 200, epoch: 17 | loss: 0.1154285
	speed: 0.2391s/iter; left time: 7364.2767s
	iters: 300, epoch: 17 | loss: 0.1005313
	speed: 0.2338s/iter; left time: 7177.4005s
Epoch: 17 cost time: 91.24774503707886
Epoch: 17, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.530 Vali Acc: 0.658 Test Loss: 1.530 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0984255
	speed: 0.7201s/iter; left time: 21983.4329s
	iters: 200, epoch: 18 | loss: 0.5905019
	speed: 0.2306s/iter; left time: 7016.5047s
	iters: 300, epoch: 18 | loss: 0.4131445
	speed: 0.2247s/iter; left time: 6815.9496s
Epoch: 18 cost time: 84.59959316253662
Epoch: 18, Steps: 369 | Train Loss: 0.114 Vali Loss: 1.585 Vali Acc: 0.669 Test Loss: 1.585 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0611559
	speed: 0.6998s/iter; left time: 21104.2059s
	iters: 200, epoch: 19 | loss: 0.0028679
	speed: 0.2505s/iter; left time: 7531.0990s
	iters: 300, epoch: 19 | loss: 0.1023484
	speed: 0.2342s/iter; left time: 7016.4735s
Epoch: 19 cost time: 87.10194778442383
Epoch: 19, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.697 Vali Acc: 0.664 Test Loss: 1.697 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.3123468
	speed: 0.6999s/iter; left time: 20850.8476s
	iters: 200, epoch: 20 | loss: 0.0365749
	speed: 0.2346s/iter; left time: 6966.3991s
	iters: 300, epoch: 20 | loss: 0.0915646
	speed: 0.2432s/iter; left time: 7195.4315s
Epoch: 20 cost time: 87.4554374217987
Epoch: 20, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.797 Vali Acc: 0.656 Test Loss: 1.797 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0122791
	speed: 0.6981s/iter; left time: 20537.9144s
	iters: 200, epoch: 21 | loss: 0.0634243
	speed: 0.2370s/iter; left time: 6948.1124s
	iters: 300, epoch: 21 | loss: 0.0029057
	speed: 0.2532s/iter; left time: 7399.1206s
Epoch: 21 cost time: 87.24694418907166
Epoch: 21, Steps: 369 | Train Loss: 0.098 Vali Loss: 1.765 Vali Acc: 0.665 Test Loss: 1.765 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6895933
	speed: 0.2346s/iter; left time: 8632.6139s
	iters: 200, epoch: 1 | loss: 0.6940416
	speed: 0.2460s/iter; left time: 9028.3649s
	iters: 300, epoch: 1 | loss: 0.7408652
	speed: 0.2263s/iter; left time: 8282.3105s
Epoch: 1 cost time: 86.64713859558105
Epoch: 1, Steps: 369 | Train Loss: 0.726 Vali Loss: 0.699 Vali Acc: 0.533 Test Loss: 0.699 Test Acc: 0.533
Validation loss decreased (inf --> -0.532626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4831934
	speed: 0.7026s/iter; left time: 25596.7942s
	iters: 200, epoch: 2 | loss: 0.3253831
	speed: 0.2286s/iter; left time: 8305.9688s
	iters: 300, epoch: 2 | loss: 0.6960899
	speed: 0.2166s/iter; left time: 7847.7604s
Epoch: 2 cost time: 82.59167671203613
Epoch: 2, Steps: 369 | Train Loss: 0.624 Vali Loss: 0.649 Vali Acc: 0.647 Test Loss: 0.649 Test Acc: 0.647
Validation loss decreased (-0.532626 --> -0.647269).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4036501
	speed: 0.6994s/iter; left time: 25221.6566s
	iters: 200, epoch: 3 | loss: 0.2976809
	speed: 0.2639s/iter; left time: 9488.9779s
	iters: 300, epoch: 3 | loss: 0.5339531
	speed: 0.2422s/iter; left time: 8687.5009s
Epoch: 3 cost time: 92.13929605484009
Epoch: 3, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.717 Vali Acc: 0.676 Test Loss: 0.717 Test Acc: 0.676
Validation loss decreased (-0.647269 --> -0.676213).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6891145
	speed: 0.7131s/iter; left time: 25452.8691s
	iters: 200, epoch: 4 | loss: 0.5186366
	speed: 0.2526s/iter; left time: 8990.7183s
	iters: 300, epoch: 4 | loss: 0.4878243
	speed: 0.2299s/iter; left time: 8160.9812s
Epoch: 4 cost time: 87.79731512069702
Epoch: 4, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.751 Vali Acc: 0.664 Test Loss: 0.751 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2924004
	speed: 0.7102s/iter; left time: 25086.6418s
	iters: 200, epoch: 5 | loss: 0.4356557
	speed: 0.2159s/iter; left time: 7606.8338s
	iters: 300, epoch: 5 | loss: 0.5839124
	speed: 0.2202s/iter; left time: 7734.7556s
Epoch: 5 cost time: 85.94985222816467
Epoch: 5, Steps: 369 | Train Loss: 0.403 Vali Loss: 0.756 Vali Acc: 0.678 Test Loss: 0.756 Test Acc: 0.678
Validation loss decreased (-0.676213 --> -0.678483).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3255072
	speed: 0.7131s/iter; left time: 24926.3438s
	iters: 200, epoch: 6 | loss: 0.2773749
	speed: 0.2283s/iter; left time: 7958.3400s
	iters: 300, epoch: 6 | loss: 0.1731167
	speed: 0.2233s/iter; left time: 7762.1362s
Epoch: 6 cost time: 83.38349676132202
Epoch: 6, Steps: 369 | Train Loss: 0.371 Vali Loss: 0.846 Vali Acc: 0.652 Test Loss: 0.846 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1932350
	speed: 0.7112s/iter; left time: 24597.2160s
	iters: 200, epoch: 7 | loss: 0.1156817
	speed: 0.2227s/iter; left time: 7679.5603s
	iters: 300, epoch: 7 | loss: 0.1578582
	speed: 0.2324s/iter; left time: 7989.9505s
Epoch: 7 cost time: 86.1687502861023
Epoch: 7, Steps: 369 | Train Loss: 0.329 Vali Loss: 0.852 Vali Acc: 0.671 Test Loss: 0.852 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0806786
	speed: 0.6965s/iter; left time: 23834.1514s
	iters: 200, epoch: 8 | loss: 0.1857440
	speed: 0.2446s/iter; left time: 8345.9169s
	iters: 300, epoch: 8 | loss: 0.2836632
	speed: 0.2337s/iter; left time: 7949.9850s
Epoch: 8 cost time: 86.7192771434784
Epoch: 8, Steps: 369 | Train Loss: 0.292 Vali Loss: 0.908 Vali Acc: 0.660 Test Loss: 0.908 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1645312
	speed: 0.7115s/iter; left time: 24082.5202s
	iters: 200, epoch: 9 | loss: 0.0437602
	speed: 0.2302s/iter; left time: 7770.2893s
	iters: 300, epoch: 9 | loss: 0.2068499
	speed: 0.2398s/iter; left time: 8069.4917s
Epoch: 9 cost time: 87.6767852306366
Epoch: 9, Steps: 369 | Train Loss: 0.256 Vali Loss: 1.009 Vali Acc: 0.657 Test Loss: 1.009 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1319569
	speed: 0.7606s/iter; left time: 25465.4735s
	iters: 200, epoch: 10 | loss: 0.0498840
	speed: 0.2321s/iter; left time: 7749.0171s
	iters: 300, epoch: 10 | loss: 0.2611153
	speed: 0.2262s/iter; left time: 7527.4508s
Epoch: 10 cost time: 89.52567601203918
Epoch: 10, Steps: 369 | Train Loss: 0.235 Vali Loss: 1.080 Vali Acc: 0.662 Test Loss: 1.080 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4305827
	speed: 0.7061s/iter; left time: 23379.2942s
	iters: 200, epoch: 11 | loss: 0.2734543
	speed: 0.2404s/iter; left time: 7936.9610s
	iters: 300, epoch: 11 | loss: 0.1183658
	speed: 0.2407s/iter; left time: 7922.4151s
Epoch: 11 cost time: 88.05119395256042
Epoch: 11, Steps: 369 | Train Loss: 0.197 Vali Loss: 1.171 Vali Acc: 0.658 Test Loss: 1.171 Test Acc: 0.658
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1005845
	speed: 0.6807s/iter; left time: 22287.3274s
	iters: 200, epoch: 12 | loss: 0.1616872
	speed: 0.2085s/iter; left time: 6806.0183s
	iters: 300, epoch: 12 | loss: 0.1428556
	speed: 0.2190s/iter; left time: 7125.5951s
Epoch: 12 cost time: 81.29779839515686
Epoch: 12, Steps: 369 | Train Loss: 0.185 Vali Loss: 1.249 Vali Acc: 0.653 Test Loss: 1.249 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0209401
	speed: 0.7083s/iter; left time: 22928.7922s
	iters: 200, epoch: 13 | loss: 0.0674846
	speed: 0.2406s/iter; left time: 7763.3427s
	iters: 300, epoch: 13 | loss: 0.1409408
	speed: 0.2449s/iter; left time: 7878.3129s
Epoch: 13 cost time: 88.20069169998169
Epoch: 13, Steps: 369 | Train Loss: 0.176 Vali Loss: 1.214 Vali Acc: 0.650 Test Loss: 1.214 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.4409200
	speed: 0.7552s/iter; left time: 24167.9112s
	iters: 200, epoch: 14 | loss: 0.1922776
	speed: 0.2488s/iter; left time: 7937.5259s
	iters: 300, epoch: 14 | loss: 0.2346018
	speed: 0.2444s/iter; left time: 7772.3660s
Epoch: 14 cost time: 92.11948418617249
Epoch: 14, Steps: 369 | Train Loss: 0.159 Vali Loss: 1.355 Vali Acc: 0.655 Test Loss: 1.355 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1023143
	speed: 0.7002s/iter; left time: 22149.2974s
	iters: 200, epoch: 15 | loss: 0.2071894
	speed: 0.2536s/iter; left time: 7996.8710s
	iters: 300, epoch: 15 | loss: 0.1024150
	speed: 0.2368s/iter; left time: 7445.0931s
Epoch: 15 cost time: 90.73907613754272
Epoch: 15, Steps: 369 | Train Loss: 0.146 Vali Loss: 1.374 Vali Acc: 0.658 Test Loss: 1.374 Test Acc: 0.658
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6784903518728718
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6938474
	speed: 0.2763s/iter; left time: 10169.6099s
	iters: 200, epoch: 1 | loss: 0.6950377
	speed: 0.2607s/iter; left time: 9567.9130s
	iters: 300, epoch: 1 | loss: 0.6934030
	speed: 0.2460s/iter; left time: 9005.0417s
Epoch: 1 cost time: 95.6922378540039
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6939535
	speed: 0.7572s/iter; left time: 27584.6502s
	iters: 200, epoch: 2 | loss: 0.6931478
	speed: 0.2655s/iter; left time: 9646.5107s
	iters: 300, epoch: 2 | loss: 0.6934066
	speed: 0.2542s/iter; left time: 9210.2539s
Epoch: 2 cost time: 95.9052939414978
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6931767
	speed: 0.7771s/iter; left time: 28025.8382s
	iters: 200, epoch: 3 | loss: 0.6931472
	speed: 0.2553s/iter; left time: 9179.9642s
	iters: 300, epoch: 3 | loss: 0.6922576
	speed: 0.2463s/iter; left time: 8834.5005s
Epoch: 3 cost time: 95.25022959709167
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6926655
	speed: 0.7607s/iter; left time: 27151.3654s
	iters: 200, epoch: 4 | loss: 0.6928895
	speed: 0.2472s/iter; left time: 8798.5196s
	iters: 300, epoch: 4 | loss: 0.6927210
	speed: 0.2376s/iter; left time: 8434.6207s
Epoch: 4 cost time: 91.01740527153015
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6931701
	speed: 0.7248s/iter; left time: 25603.0648s
	iters: 200, epoch: 5 | loss: 0.6927417
	speed: 0.2250s/iter; left time: 7926.8721s
	iters: 300, epoch: 5 | loss: 0.6938713
	speed: 0.2617s/iter; left time: 9192.2655s
Epoch: 5 cost time: 89.53850150108337
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6930951
	speed: 0.7636s/iter; left time: 26693.6920s
	iters: 200, epoch: 6 | loss: 0.6931519
	speed: 0.2568s/iter; left time: 8949.9474s
	iters: 300, epoch: 6 | loss: 0.6900710
	speed: 0.2485s/iter; left time: 8638.1457s
Epoch: 6 cost time: 93.52070355415344
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6931638
	speed: 0.7457s/iter; left time: 25792.3270s
	iters: 200, epoch: 7 | loss: 0.6931500
	speed: 0.2500s/iter; left time: 8621.5263s
	iters: 300, epoch: 7 | loss: 0.6911122
	speed: 0.2551s/iter; left time: 8771.4555s
Epoch: 7 cost time: 91.99884867668152
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6933371
	speed: 0.7236s/iter; left time: 24761.4878s
	iters: 200, epoch: 8 | loss: 0.6936880
	speed: 0.2203s/iter; left time: 7517.3148s
	iters: 300, epoch: 8 | loss: 0.6951765
	speed: 0.2343s/iter; left time: 7971.8961s
Epoch: 8 cost time: 84.85802173614502
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6944922
	speed: 0.7094s/iter; left time: 24010.9139s
	iters: 200, epoch: 9 | loss: 0.6934731
	speed: 0.2470s/iter; left time: 8336.0912s
	iters: 300, epoch: 9 | loss: 0.6928273
	speed: 0.2273s/iter; left time: 7648.5411s
Epoch: 9 cost time: 88.01961016654968
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6940781
	speed: 0.7042s/iter; left time: 23576.2679s
	iters: 200, epoch: 10 | loss: 0.6931320
	speed: 0.2366s/iter; left time: 7897.8716s
	iters: 300, epoch: 10 | loss: 0.6931911
	speed: 0.2249s/iter; left time: 7485.7560s
Epoch: 10 cost time: 87.25513768196106
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6931915
	speed: 0.7551s/iter; left time: 25001.4377s
	iters: 200, epoch: 11 | loss: 0.6932757
	speed: 0.2324s/iter; left time: 7670.7420s
	iters: 300, epoch: 11 | loss: 0.6959359
	speed: 0.2483s/iter; left time: 8171.2034s
Epoch: 11 cost time: 90.00827097892761
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6976891
	speed: 0.7693s/iter; left time: 25187.5960s
	iters: 200, epoch: 12 | loss: 0.6943716
	speed: 0.2635s/iter; left time: 8600.9793s
	iters: 300, epoch: 12 | loss: 0.6922318
	speed: 0.2458s/iter; left time: 7997.9578s
Epoch: 12 cost time: 93.60680270195007
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6908918
	speed: 0.7474s/iter; left time: 24195.9054s
	iters: 200, epoch: 13 | loss: 0.6950086
	speed: 0.2465s/iter; left time: 7956.5052s
	iters: 300, epoch: 13 | loss: 0.6924688
	speed: 0.2411s/iter; left time: 7756.4022s
Epoch: 13 cost time: 88.86301517486572
Epoch: 13, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6930780
	speed: 0.7137s/iter; left time: 22841.5843s
	iters: 200, epoch: 14 | loss: 0.6928754
	speed: 0.2306s/iter; left time: 7357.4343s
	iters: 300, epoch: 14 | loss: 0.6928942
	speed: 0.2198s/iter; left time: 6989.5101s
Epoch: 14 cost time: 86.23224997520447
Epoch: 14, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6920086
	speed: 0.7569s/iter; left time: 23945.9447s
	iters: 200, epoch: 15 | loss: 0.6950828
	speed: 0.2467s/iter; left time: 7780.6837s
	iters: 300, epoch: 15 | loss: 0.6931766
	speed: 0.2300s/iter; left time: 7230.4446s
Epoch: 15 cost time: 89.39457893371582
Epoch: 15, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6931481
	speed: 0.7277s/iter; left time: 22752.0631s
	iters: 200, epoch: 16 | loss: 0.6941898
	speed: 0.2433s/iter; left time: 7581.3791s
	iters: 300, epoch: 16 | loss: 0.6936324
	speed: 0.2325s/iter; left time: 7224.0321s
Epoch: 16 cost time: 88.53820776939392
Epoch: 16, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6959260
	speed: 0.7540s/iter; left time: 23297.5052s
	iters: 200, epoch: 17 | loss: 0.6916866
	speed: 0.2588s/iter; left time: 7969.4262s
	iters: 300, epoch: 17 | loss: 0.6927404
	speed: 0.2230s/iter; left time: 6845.7969s
Epoch: 17 cost time: 92.70910358428955
Epoch: 17, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6929057
	speed: 0.7353s/iter; left time: 22447.5800s
	iters: 200, epoch: 18 | loss: 0.6926736
	speed: 0.2417s/iter; left time: 7354.8601s
	iters: 300, epoch: 18 | loss: 0.6943411
	speed: 0.2427s/iter; left time: 7359.5883s
Epoch: 18 cost time: 90.59064817428589
Epoch: 18, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6936636
	speed: 0.7328s/iter; left time: 22099.0432s
	iters: 200, epoch: 19 | loss: 0.6941424
	speed: 0.2439s/iter; left time: 7330.9255s
	iters: 300, epoch: 19 | loss: 0.6935145
	speed: 0.2407s/iter; left time: 7212.5266s
Epoch: 19 cost time: 89.4228687286377
Epoch: 19, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6957194
	speed: 0.7290s/iter; left time: 21718.0834s
	iters: 200, epoch: 20 | loss: 0.6931485
	speed: 0.2401s/iter; left time: 7128.9349s
	iters: 300, epoch: 20 | loss: 0.6941161
	speed: 0.2486s/iter; left time: 7355.6741s
Epoch: 20 cost time: 91.22990918159485
Epoch: 20, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6918146
	speed: 0.7401s/iter; left time: 21773.9811s
	iters: 200, epoch: 21 | loss: 0.6942471
	speed: 0.2459s/iter; left time: 7210.9264s
	iters: 300, epoch: 21 | loss: 0.6931523
	speed: 0.2525s/iter; left time: 7377.1617s
Epoch: 21 cost time: 92.10991835594177
Epoch: 21, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6922289
	speed: 0.7442s/iter; left time: 21621.6997s
	iters: 200, epoch: 22 | loss: 0.6937395
	speed: 0.2324s/iter; left time: 6728.9535s
	iters: 300, epoch: 22 | loss: 0.6923428
	speed: 0.2401s/iter; left time: 6927.8322s
Epoch: 22 cost time: 88.46912145614624
Epoch: 22, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.6941733
	speed: 0.7082s/iter; left time: 20313.3981s
	iters: 200, epoch: 23 | loss: 0.6918236
	speed: 0.2592s/iter; left time: 7408.0833s
	iters: 300, epoch: 23 | loss: 0.6931551
	speed: 0.2398s/iter; left time: 6830.6220s
Epoch: 23 cost time: 89.05062198638916
Epoch: 23, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.6941586
	speed: 0.7128s/iter; left time: 20181.9355s
	iters: 200, epoch: 24 | loss: 0.6893774
	speed: 0.2289s/iter; left time: 6459.0290s
	iters: 300, epoch: 24 | loss: 0.6931473
	speed: 0.2315s/iter; left time: 6508.8689s
Epoch: 24 cost time: 87.38971877098083
Epoch: 24, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.6931843
	speed: 0.7497s/iter; left time: 20949.4547s
	iters: 200, epoch: 25 | loss: 0.6914113
	speed: 0.2381s/iter; left time: 6630.1778s
	iters: 300, epoch: 25 | loss: 0.6962455
	speed: 0.2235s/iter; left time: 6200.7715s
Epoch: 25 cost time: 86.9631507396698
Epoch: 25, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.6947207
	speed: 0.7206s/iter; left time: 19872.3367s
	iters: 200, epoch: 26 | loss: 0.6925705
	speed: 0.2471s/iter; left time: 6788.7193s
	iters: 300, epoch: 26 | loss: 0.6931543
	speed: 0.2443s/iter; left time: 6689.0778s
Epoch: 26 cost time: 90.16217637062073
Epoch: 26, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.6918313
	speed: 0.7288s/iter; left time: 19827.6386s
	iters: 200, epoch: 27 | loss: 0.6900034
	speed: 0.2281s/iter; left time: 6182.1611s
	iters: 300, epoch: 27 | loss: 0.6920624
	speed: 0.2314s/iter; left time: 6250.5451s
Epoch: 27 cost time: 86.35868430137634
Epoch: 27, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.6853796
	speed: 0.7270s/iter; left time: 19510.9171s
	iters: 200, epoch: 28 | loss: 0.6979104
	speed: 0.2446s/iter; left time: 6539.5428s
	iters: 300, epoch: 28 | loss: 0.6933251
	speed: 0.2273s/iter; left time: 6055.7457s
Epoch: 28 cost time: 87.27961111068726
Epoch: 28, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.6960329
	speed: 0.7138s/iter; left time: 18892.4049s
	iters: 200, epoch: 29 | loss: 0.6939304
	speed: 0.2380s/iter; left time: 6276.8092s
	iters: 300, epoch: 29 | loss: 0.6932094
	speed: 0.2321s/iter; left time: 6097.3672s
Epoch: 29 cost time: 87.39854097366333
Epoch: 29, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.6914049
	speed: 0.6923s/iter; left time: 18069.0494s
	iters: 200, epoch: 30 | loss: 0.6932064
	speed: 0.2260s/iter; left time: 5875.2826s
	iters: 300, epoch: 30 | loss: 0.6928607
	speed: 0.2237s/iter; left time: 5794.2486s
Epoch: 30 cost time: 83.43943190574646
Epoch: 30, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.6922320
	speed: 0.6836s/iter; left time: 17590.8202s
	iters: 200, epoch: 31 | loss: 0.6915417
	speed: 0.2257s/iter; left time: 5785.8270s
	iters: 300, epoch: 31 | loss: 0.6936592
	speed: 0.2197s/iter; left time: 5607.9122s
Epoch: 31 cost time: 83.1211245059967
Epoch: 31, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 100514
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         31                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7084658
	speed: 0.2532s/iter; left time: 9318.8305s
	iters: 200, epoch: 1 | loss: 0.7014664
	speed: 0.2288s/iter; left time: 8395.3622s
	iters: 300, epoch: 1 | loss: 0.7601736
	speed: 0.2175s/iter; left time: 7962.0737s
Epoch: 1 cost time: 86.30598831176758
Epoch: 1, Steps: 369 | Train Loss: 0.676 Vali Loss: 0.661 Vali Acc: 0.620 Test Loss: 0.661 Test Acc: 0.620
Validation loss decreased (inf --> -0.619744).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5321921
	speed: 0.7265s/iter; left time: 26469.5020s
	iters: 200, epoch: 2 | loss: 0.5455716
	speed: 0.2367s/iter; left time: 8599.0891s
	iters: 300, epoch: 2 | loss: 0.4151543
	speed: 0.2448s/iter; left time: 8868.6461s
Epoch: 2 cost time: 90.31335616111755
Epoch: 2, Steps: 369 | Train Loss: 0.548 Vali Loss: 0.642 Vali Acc: 0.675 Test Loss: 0.642 Test Acc: 0.675
Validation loss decreased (-0.619744 --> -0.675079).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4760387
	speed: 0.7379s/iter; left time: 26612.5139s
	iters: 200, epoch: 3 | loss: 0.5504184
	speed: 0.2478s/iter; left time: 8911.9451s
	iters: 300, epoch: 3 | loss: 0.3048134
	speed: 0.2407s/iter; left time: 8631.7220s
Epoch: 3 cost time: 91.21090769767761
Epoch: 3, Steps: 369 | Train Loss: 0.454 Vali Loss: 0.705 Vali Acc: 0.671 Test Loss: 0.705 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2876674
	speed: 0.7446s/iter; left time: 26576.9575s
	iters: 200, epoch: 4 | loss: 0.2553813
	speed: 0.2482s/iter; left time: 8833.8563s
	iters: 300, epoch: 4 | loss: 0.2495587
	speed: 0.2293s/iter; left time: 8138.3980s
Epoch: 4 cost time: 88.67105865478516
Epoch: 4, Steps: 369 | Train Loss: 0.393 Vali Loss: 0.725 Vali Acc: 0.679 Test Loss: 0.725 Test Acc: 0.679
Validation loss decreased (-0.675079 --> -0.679051).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3222425
	speed: 0.6988s/iter; left time: 24686.4913s
	iters: 200, epoch: 5 | loss: 0.1709927
	speed: 0.2264s/iter; left time: 7975.4076s
	iters: 300, epoch: 5 | loss: 0.1568795
	speed: 0.2248s/iter; left time: 7895.5746s
Epoch: 5 cost time: 84.85688853263855
Epoch: 5, Steps: 369 | Train Loss: 0.335 Vali Loss: 0.810 Vali Acc: 0.678 Test Loss: 0.810 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2094827
	speed: 0.7098s/iter; left time: 24810.4233s
	iters: 200, epoch: 6 | loss: 0.2143736
	speed: 0.2304s/iter; left time: 8029.4587s
	iters: 300, epoch: 6 | loss: 0.2421818
	speed: 0.2331s/iter; left time: 8100.9279s
Epoch: 6 cost time: 85.91768336296082
Epoch: 6, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.909 Vali Acc: 0.673 Test Loss: 0.909 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6326934
	speed: 0.7217s/iter; left time: 24962.1313s
	iters: 200, epoch: 7 | loss: 0.1554404
	speed: 0.2338s/iter; left time: 8061.4255s
	iters: 300, epoch: 7 | loss: 0.3523943
	speed: 0.2372s/iter; left time: 8156.9794s
Epoch: 7 cost time: 86.62942695617676
Epoch: 7, Steps: 369 | Train Loss: 0.248 Vali Loss: 0.943 Vali Acc: 0.669 Test Loss: 0.943 Test Acc: 0.669
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0542464
	speed: 0.7489s/iter; left time: 25627.0048s
	iters: 200, epoch: 8 | loss: 0.0569192
	speed: 0.2609s/iter; left time: 8902.7928s
	iters: 300, epoch: 8 | loss: 0.1388292
	speed: 0.2459s/iter; left time: 8366.4840s
Epoch: 8 cost time: 94.03216886520386
Epoch: 8, Steps: 369 | Train Loss: 0.216 Vali Loss: 1.024 Vali Acc: 0.669 Test Loss: 1.024 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1060782
	speed: 0.7252s/iter; left time: 24548.0004s
	iters: 200, epoch: 9 | loss: 0.0436008
	speed: 0.2611s/iter; left time: 8811.4076s
	iters: 300, epoch: 9 | loss: 0.0579480
	speed: 0.2663s/iter; left time: 8959.6018s
Epoch: 9 cost time: 95.92525243759155
Epoch: 9, Steps: 369 | Train Loss: 0.170 Vali Loss: 1.120 Vali Acc: 0.658 Test Loss: 1.120 Test Acc: 0.658
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0609059
	speed: 0.7462s/iter; left time: 24983.2002s
	iters: 200, epoch: 10 | loss: 0.1555899
	speed: 0.2191s/iter; left time: 7311.9445s
	iters: 300, epoch: 10 | loss: 0.1416553
	speed: 0.2327s/iter; left time: 7742.8813s
Epoch: 10 cost time: 86.45127558708191
Epoch: 10, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.235 Vali Acc: 0.661 Test Loss: 1.235 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1140324
	speed: 0.7146s/iter; left time: 23662.5358s
	iters: 200, epoch: 11 | loss: 0.1277659
	speed: 0.2310s/iter; left time: 7624.6570s
	iters: 300, epoch: 11 | loss: 0.1428159
	speed: 0.2408s/iter; left time: 7924.9952s
Epoch: 11 cost time: 88.3119888305664
Epoch: 11, Steps: 369 | Train Loss: 0.140 Vali Loss: 1.267 Vali Acc: 0.669 Test Loss: 1.267 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0917515
	speed: 0.7307s/iter; left time: 23923.3859s
	iters: 200, epoch: 12 | loss: 0.1466288
	speed: 0.2455s/iter; left time: 8012.5056s
	iters: 300, epoch: 12 | loss: 0.1464005
	speed: 0.2317s/iter; left time: 7540.0001s
Epoch: 12 cost time: 88.68138933181763
Epoch: 12, Steps: 369 | Train Loss: 0.144 Vali Loss: 1.352 Vali Acc: 0.657 Test Loss: 1.352 Test Acc: 0.657
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1237663
	speed: 0.7330s/iter; left time: 23729.9623s
	iters: 200, epoch: 13 | loss: 0.2871684
	speed: 0.2320s/iter; left time: 7486.6838s
	iters: 300, epoch: 13 | loss: 0.0573518
	speed: 0.2303s/iter; left time: 7408.2989s
Epoch: 13 cost time: 87.39211249351501
Epoch: 13, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.429 Vali Acc: 0.658 Test Loss: 1.429 Test Acc: 0.658
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0672402
	speed: 0.7033s/iter; left time: 22508.6041s
	iters: 200, epoch: 14 | loss: 0.2827339
	speed: 0.2315s/iter; left time: 7385.2897s
	iters: 300, epoch: 14 | loss: 0.0554961
	speed: 0.2248s/iter; left time: 7148.1731s
Epoch: 14 cost time: 85.75557851791382
Epoch: 14, Steps: 369 | Train Loss: 0.111 Vali Loss: 1.494 Vali Acc: 0.657 Test Loss: 1.494 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6790578887627696
model parameter : 75938
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7024768
	speed: 0.2457s/iter; left time: 9043.5826s
	iters: 200, epoch: 1 | loss: 0.7531787
	speed: 0.2356s/iter; left time: 8646.1109s
	iters: 300, epoch: 1 | loss: 0.7414291
	speed: 0.2487s/iter; left time: 9103.1660s
Epoch: 1 cost time: 89.05141186714172
Epoch: 1, Steps: 369 | Train Loss: 0.690 Vali Loss: 0.666 Vali Acc: 0.615 Test Loss: 0.666 Test Acc: 0.615
Validation loss decreased (inf --> -0.614920).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5063576
	speed: 0.7448s/iter; left time: 27134.1149s
	iters: 200, epoch: 2 | loss: 0.5748875
	speed: 0.2345s/iter; left time: 8520.6079s
	iters: 300, epoch: 2 | loss: 0.4728205
	speed: 0.2448s/iter; left time: 8869.6065s
Epoch: 2 cost time: 89.3262586593628
Epoch: 2, Steps: 369 | Train Loss: 0.554 Vali Loss: 0.647 Vali Acc: 0.669 Test Loss: 0.647 Test Acc: 0.669
Validation loss decreased (-0.614920 --> -0.669120).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4934269
	speed: 0.7318s/iter; left time: 26389.6633s
	iters: 200, epoch: 3 | loss: 0.6612487
	speed: 0.2201s/iter; left time: 7913.7214s
	iters: 300, epoch: 3 | loss: 0.2541820
	speed: 0.2340s/iter; left time: 8391.0594s
Epoch: 3 cost time: 87.11875009536743
Epoch: 3, Steps: 369 | Train Loss: 0.452 Vali Loss: 0.707 Vali Acc: 0.677 Test Loss: 0.707 Test Acc: 0.677
Validation loss decreased (-0.669120 --> -0.677348).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2558774
	speed: 0.6985s/iter; left time: 24931.4649s
	iters: 200, epoch: 4 | loss: 0.2974307
	speed: 0.2146s/iter; left time: 7638.7878s
	iters: 300, epoch: 4 | loss: 0.3798770
	speed: 0.2643s/iter; left time: 9380.2934s
Epoch: 4 cost time: 87.1982581615448
Epoch: 4, Steps: 369 | Train Loss: 0.392 Vali Loss: 0.714 Vali Acc: 0.681 Test Loss: 0.714 Test Acc: 0.681
Validation loss decreased (-0.677348 --> -0.681321).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3250351
	speed: 0.7294s/iter; left time: 25764.6647s
	iters: 200, epoch: 5 | loss: 0.1116623
	speed: 0.2130s/iter; left time: 7503.6953s
	iters: 300, epoch: 5 | loss: 0.1267223
	speed: 0.2363s/iter; left time: 8298.7087s
Epoch: 5 cost time: 87.42483639717102
Epoch: 5, Steps: 369 | Train Loss: 0.333 Vali Loss: 0.803 Vali Acc: 0.673 Test Loss: 0.803 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1687899
	speed: 0.7528s/iter; left time: 26315.4046s
	iters: 200, epoch: 6 | loss: 0.2445672
	speed: 0.2458s/iter; left time: 8566.4379s
	iters: 300, epoch: 6 | loss: 0.1736016
	speed: 0.2470s/iter; left time: 8583.4317s
Epoch: 6 cost time: 92.84991121292114
Epoch: 6, Steps: 369 | Train Loss: 0.293 Vali Loss: 0.914 Vali Acc: 0.661 Test Loss: 0.914 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4762327
	speed: 0.7612s/iter; left time: 26327.5842s
	iters: 200, epoch: 7 | loss: 0.1316233
	speed: 0.2358s/iter; left time: 8131.5390s
	iters: 300, epoch: 7 | loss: 0.2282032
	speed: 0.2418s/iter; left time: 8315.1697s
Epoch: 7 cost time: 89.48141717910767
Epoch: 7, Steps: 369 | Train Loss: 0.240 Vali Loss: 0.924 Vali Acc: 0.673 Test Loss: 0.924 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0870877
	speed: 0.7160s/iter; left time: 24501.6726s
	iters: 200, epoch: 8 | loss: 0.0807998
	speed: 0.2215s/iter; left time: 7558.6743s
	iters: 300, epoch: 8 | loss: 0.2311084
	speed: 0.2290s/iter; left time: 7790.4220s
Epoch: 8 cost time: 83.67708921432495
Epoch: 8, Steps: 369 | Train Loss: 0.210 Vali Loss: 1.066 Vali Acc: 0.664 Test Loss: 1.066 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2379702
	speed: 0.6874s/iter; left time: 23268.7040s
	iters: 200, epoch: 9 | loss: 0.0802002
	speed: 0.2245s/iter; left time: 7576.8905s
	iters: 300, epoch: 9 | loss: 0.0374615
	speed: 0.2204s/iter; left time: 7416.8227s
Epoch: 9 cost time: 82.87965822219849
Epoch: 9, Steps: 369 | Train Loss: 0.177 Vali Loss: 1.126 Vali Acc: 0.660 Test Loss: 1.126 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0297972
	speed: 0.6933s/iter; left time: 23210.6814s
	iters: 200, epoch: 10 | loss: 0.0445142
	speed: 0.2486s/iter; left time: 8297.4530s
	iters: 300, epoch: 10 | loss: 0.1284938
	speed: 0.2340s/iter; left time: 7788.5020s
Epoch: 10 cost time: 86.5461938381195
Epoch: 10, Steps: 369 | Train Loss: 0.156 Vali Loss: 1.235 Vali Acc: 0.666 Test Loss: 1.235 Test Acc: 0.666
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0877733
	speed: 0.6914s/iter; left time: 22893.9574s
	iters: 200, epoch: 11 | loss: 0.1131702
	speed: 0.2376s/iter; left time: 7843.8085s
	iters: 300, epoch: 11 | loss: 0.0462258
	speed: 0.2332s/iter; left time: 7674.2514s
Epoch: 11 cost time: 87.76665329933167
Epoch: 11, Steps: 369 | Train Loss: 0.142 Vali Loss: 1.201 Vali Acc: 0.659 Test Loss: 1.201 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0742275
	speed: 0.7813s/iter; left time: 25582.8236s
	iters: 200, epoch: 12 | loss: 0.3958255
	speed: 0.2569s/iter; left time: 8385.9669s
	iters: 300, epoch: 12 | loss: 0.0425679
	speed: 0.2463s/iter; left time: 8016.6148s
Epoch: 12 cost time: 95.19718813896179
Epoch: 12, Steps: 369 | Train Loss: 0.130 Vali Loss: 1.348 Vali Acc: 0.663 Test Loss: 1.348 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0525207
	speed: 0.7607s/iter; left time: 24627.2284s
	iters: 200, epoch: 13 | loss: 0.1021980
	speed: 0.2591s/iter; left time: 8360.7732s
	iters: 300, epoch: 13 | loss: 0.0185465
	speed: 0.2617s/iter; left time: 8420.2624s
Epoch: 13 cost time: 96.55008602142334
Epoch: 13, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.451 Vali Acc: 0.660 Test Loss: 1.451 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1856694
	speed: 0.7509s/iter; left time: 24031.5010s
	iters: 200, epoch: 14 | loss: 0.4692099
	speed: 0.2415s/iter; left time: 7705.7090s
	iters: 300, epoch: 14 | loss: 0.0107707
	speed: 0.2409s/iter; left time: 7663.1089s
Epoch: 14 cost time: 90.2013909816742
Epoch: 14, Steps: 369 | Train Loss: 0.113 Vali Loss: 1.533 Vali Acc: 0.656 Test Loss: 1.533 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6813280363223609
model parameter : 75938
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6956600
	speed: 0.2600s/iter; left time: 9568.0514s
	iters: 200, epoch: 1 | loss: 0.8170074
	speed: 0.2497s/iter; left time: 9164.6581s
	iters: 300, epoch: 1 | loss: 0.7466678
	speed: 0.2375s/iter; left time: 8691.7098s
Epoch: 1 cost time: 92.26910829544067
Epoch: 1, Steps: 369 | Train Loss: 0.699 Vali Loss: 0.692 Vali Acc: 0.582 Test Loss: 0.692 Test Acc: 0.582
Validation loss decreased (inf --> -0.582002).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5972908
	speed: 0.7397s/iter; left time: 26947.7484s
	iters: 200, epoch: 2 | loss: 0.5608402
	speed: 0.2416s/iter; left time: 8776.1106s
	iters: 300, epoch: 2 | loss: 0.5188569
	speed: 0.2353s/iter; left time: 8525.6090s
Epoch: 2 cost time: 89.53071856498718
Epoch: 2, Steps: 369 | Train Loss: 0.563 Vali Loss: 0.639 Vali Acc: 0.674 Test Loss: 0.639 Test Acc: 0.674
Validation loss decreased (-0.582002 --> -0.673944).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4738310
	speed: 0.7528s/iter; left time: 27148.2609s
	iters: 200, epoch: 3 | loss: 0.6553211
	speed: 0.2500s/iter; left time: 8990.5101s
	iters: 300, epoch: 3 | loss: 0.2596719
	speed: 0.2411s/iter; left time: 8645.8295s
Epoch: 3 cost time: 93.5015001296997
Epoch: 3, Steps: 369 | Train Loss: 0.462 Vali Loss: 0.699 Vali Acc: 0.675 Test Loss: 0.699 Test Acc: 0.675
Validation loss decreased (-0.673944 --> -0.675362).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2801837
	speed: 0.7437s/iter; left time: 26544.7651s
	iters: 200, epoch: 4 | loss: 0.2335985
	speed: 0.2436s/iter; left time: 8670.5953s
	iters: 300, epoch: 4 | loss: 0.4127449
	speed: 0.2585s/iter; left time: 9176.0094s
Epoch: 4 cost time: 93.82973003387451
Epoch: 4, Steps: 369 | Train Loss: 0.401 Vali Loss: 0.719 Vali Acc: 0.669 Test Loss: 0.719 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2857634
	speed: 0.7659s/iter; left time: 27054.3331s
	iters: 200, epoch: 5 | loss: 0.1587089
	speed: 0.2314s/iter; left time: 8149.4033s
	iters: 300, epoch: 5 | loss: 0.1068906
	speed: 0.2338s/iter; left time: 8211.6226s
Epoch: 5 cost time: 90.25985431671143
Epoch: 5, Steps: 369 | Train Loss: 0.349 Vali Loss: 0.795 Vali Acc: 0.671 Test Loss: 0.795 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2453119
	speed: 0.7113s/iter; left time: 24862.7286s
	iters: 200, epoch: 6 | loss: 0.2968376
	speed: 0.2238s/iter; left time: 7800.9492s
	iters: 300, epoch: 6 | loss: 0.1340824
	speed: 0.2369s/iter; left time: 8232.0498s
Epoch: 6 cost time: 83.96365094184875
Epoch: 6, Steps: 369 | Train Loss: 0.302 Vali Loss: 0.891 Vali Acc: 0.671 Test Loss: 0.891 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5548741
	speed: 0.6844s/iter; left time: 23672.7482s
	iters: 200, epoch: 7 | loss: 0.3566440
	speed: 0.2421s/iter; left time: 8348.7399s
	iters: 300, epoch: 7 | loss: 0.3808052
	speed: 0.2034s/iter; left time: 6995.1191s
Epoch: 7 cost time: 84.28654217720032
Epoch: 7, Steps: 369 | Train Loss: 0.250 Vali Loss: 0.939 Vali Acc: 0.667 Test Loss: 0.939 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1013287
	speed: 0.6930s/iter; left time: 23712.6578s
	iters: 200, epoch: 8 | loss: 0.1431816
	speed: 0.2306s/iter; left time: 7867.4962s
	iters: 300, epoch: 8 | loss: 0.3605480
	speed: 0.2297s/iter; left time: 7814.7013s
Epoch: 8 cost time: 85.77233672142029
Epoch: 8, Steps: 369 | Train Loss: 0.221 Vali Loss: 0.981 Vali Acc: 0.671 Test Loss: 0.981 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0949985
	speed: 0.7196s/iter; left time: 24359.1169s
	iters: 200, epoch: 9 | loss: 0.0773762
	speed: 0.2458s/iter; left time: 8295.9021s
	iters: 300, epoch: 9 | loss: 0.1959672
	speed: 0.2410s/iter; left time: 8110.7949s
Epoch: 9 cost time: 90.3331458568573
Epoch: 9, Steps: 369 | Train Loss: 0.178 Vali Loss: 1.091 Vali Acc: 0.657 Test Loss: 1.091 Test Acc: 0.657
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1149114
	speed: 0.7514s/iter; left time: 25156.3089s
	iters: 200, epoch: 10 | loss: 0.0697650
	speed: 0.2578s/iter; left time: 8605.7907s
	iters: 300, epoch: 10 | loss: 0.0612884
	speed: 0.2673s/iter; left time: 8897.3784s
Epoch: 10 cost time: 94.07524394989014
Epoch: 10, Steps: 369 | Train Loss: 0.150 Vali Loss: 1.256 Vali Acc: 0.642 Test Loss: 1.256 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1494375
	speed: 0.7366s/iter; left time: 24390.7547s
	iters: 200, epoch: 11 | loss: 0.2551836
	speed: 0.2547s/iter; left time: 8408.5818s
	iters: 300, epoch: 11 | loss: 0.0363812
	speed: 0.2504s/iter; left time: 8240.5673s
Epoch: 11 cost time: 95.04483771324158
Epoch: 11, Steps: 369 | Train Loss: 0.151 Vali Loss: 1.259 Vali Acc: 0.666 Test Loss: 1.259 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1378946
	speed: 0.7537s/iter; left time: 24677.2372s
	iters: 200, epoch: 12 | loss: 0.3005575
	speed: 0.2392s/iter; left time: 7808.1222s
	iters: 300, epoch: 12 | loss: 0.0162252
	speed: 0.2386s/iter; left time: 7765.6213s
Epoch: 12 cost time: 89.82625269889832
Epoch: 12, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.376 Vali Acc: 0.663 Test Loss: 1.376 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.1344837
	speed: 0.7087s/iter; left time: 22944.1446s
	iters: 200, epoch: 13 | loss: 0.0984187
	speed: 0.2459s/iter; left time: 7935.0168s
	iters: 300, epoch: 13 | loss: 0.0276779
	speed: 0.2406s/iter; left time: 7739.4998s
Epoch: 13 cost time: 90.72418284416199
Epoch: 13, Steps: 369 | Train Loss: 0.128 Vali Loss: 1.464 Vali Acc: 0.657 Test Loss: 1.464 Test Acc: 0.657
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6753688989784336
model parameter : 75938
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6636774
	speed: 0.2346s/iter; left time: 8634.4124s
	iters: 200, epoch: 1 | loss: 0.7780696
	speed: 0.2283s/iter; left time: 8377.7103s
	iters: 300, epoch: 1 | loss: 0.7218803
	speed: 0.2442s/iter; left time: 8936.8312s
Epoch: 1 cost time: 88.10513281822205
Epoch: 1, Steps: 369 | Train Loss: 0.704 Vali Loss: 0.700 Vali Acc: 0.566 Test Loss: 0.700 Test Acc: 0.566
Validation loss decreased (inf --> -0.565544).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5732414
	speed: 0.7221s/iter; left time: 26309.3266s
	iters: 200, epoch: 2 | loss: 0.5911349
	speed: 0.2350s/iter; left time: 8537.6672s
	iters: 300, epoch: 2 | loss: 0.4854349
	speed: 0.2303s/iter; left time: 8343.2356s
Epoch: 2 cost time: 85.94958829879761
Epoch: 2, Steps: 369 | Train Loss: 0.582 Vali Loss: 0.649 Vali Acc: 0.667 Test Loss: 0.649 Test Acc: 0.667
Validation loss decreased (-0.565544 --> -0.667133).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5048907
	speed: 0.7244s/iter; left time: 26124.5594s
	iters: 200, epoch: 3 | loss: 0.6114689
	speed: 0.2378s/iter; left time: 8550.7423s
	iters: 300, epoch: 3 | loss: 0.2408763
	speed: 0.2244s/iter; left time: 8049.2430s
Epoch: 3 cost time: 87.4919044971466
Epoch: 3, Steps: 369 | Train Loss: 0.481 Vali Loss: 0.718 Vali Acc: 0.672 Test Loss: 0.718 Test Acc: 0.672
Validation loss decreased (-0.667133 --> -0.672240).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3229534
	speed: 0.7212s/iter; left time: 25742.9585s
	iters: 200, epoch: 4 | loss: 0.3118190
	speed: 0.2340s/iter; left time: 8328.6296s
	iters: 300, epoch: 4 | loss: 0.4726730
	speed: 0.2355s/iter; left time: 8358.2558s
Epoch: 4 cost time: 88.2324275970459
Epoch: 4, Steps: 369 | Train Loss: 0.426 Vali Loss: 0.737 Vali Acc: 0.659 Test Loss: 0.737 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3030353
	speed: 0.7044s/iter; left time: 24883.3459s
	iters: 200, epoch: 5 | loss: 0.2684509
	speed: 0.2404s/iter; left time: 8467.1451s
	iters: 300, epoch: 5 | loss: 0.1463234
	speed: 0.2405s/iter; left time: 8448.1263s
Epoch: 5 cost time: 90.2949333190918
Epoch: 5, Steps: 369 | Train Loss: 0.364 Vali Loss: 0.779 Vali Acc: 0.666 Test Loss: 0.779 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1653276
	speed: 0.7199s/iter; left time: 25164.4487s
	iters: 200, epoch: 6 | loss: 0.3475731
	speed: 0.2374s/iter; left time: 8275.8355s
	iters: 300, epoch: 6 | loss: 0.1423499
	speed: 0.2162s/iter; left time: 7515.6994s
Epoch: 6 cost time: 87.30747961997986
Epoch: 6, Steps: 369 | Train Loss: 0.305 Vali Loss: 0.904 Vali Acc: 0.659 Test Loss: 0.904 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5379695
	speed: 0.6705s/iter; left time: 23188.9017s
	iters: 200, epoch: 7 | loss: 0.2162878
	speed: 0.2307s/iter; left time: 7956.5220s
	iters: 300, epoch: 7 | loss: 0.2654071
	speed: 0.2236s/iter; left time: 7690.0750s
Epoch: 7 cost time: 82.40793371200562
Epoch: 7, Steps: 369 | Train Loss: 0.269 Vali Loss: 0.944 Vali Acc: 0.657 Test Loss: 0.944 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0805905
	speed: 0.6642s/iter; left time: 22729.1363s
	iters: 200, epoch: 8 | loss: 0.1699937
	speed: 0.2286s/iter; left time: 7800.2607s
	iters: 300, epoch: 8 | loss: 0.2486367
	speed: 0.2557s/iter; left time: 8698.4119s
Epoch: 8 cost time: 87.89009547233582
Epoch: 8, Steps: 369 | Train Loss: 0.236 Vali Loss: 1.021 Vali Acc: 0.669 Test Loss: 1.021 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0576315
	speed: 0.7297s/iter; left time: 24699.9818s
	iters: 200, epoch: 9 | loss: 0.0687010
	speed: 0.2539s/iter; left time: 8567.6107s
	iters: 300, epoch: 9 | loss: 0.1093571
	speed: 0.2441s/iter; left time: 8213.9602s
Epoch: 9 cost time: 90.8576512336731
Epoch: 9, Steps: 369 | Train Loss: 0.196 Vali Loss: 1.131 Vali Acc: 0.654 Test Loss: 1.131 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1113728
	speed: 0.7297s/iter; left time: 24431.6779s
	iters: 200, epoch: 10 | loss: 0.1184608
	speed: 0.2425s/iter; left time: 8095.3144s
	iters: 300, epoch: 10 | loss: 0.0917050
	speed: 0.2470s/iter; left time: 8219.4269s
Epoch: 10 cost time: 89.56274247169495
Epoch: 10, Steps: 369 | Train Loss: 0.166 Vali Loss: 1.201 Vali Acc: 0.649 Test Loss: 1.201 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0376511
	speed: 0.6796s/iter; left time: 22500.8847s
	iters: 200, epoch: 11 | loss: 0.0775650
	speed: 0.2102s/iter; left time: 6940.1480s
	iters: 300, epoch: 11 | loss: 0.0783385
	speed: 0.2319s/iter; left time: 7631.2268s
Epoch: 11 cost time: 82.73877263069153
Epoch: 11, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.275 Vali Acc: 0.658 Test Loss: 1.275 Test Acc: 0.658
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2974826
	speed: 0.6579s/iter; left time: 21539.9327s
	iters: 200, epoch: 12 | loss: 0.0584768
	speed: 0.2187s/iter; left time: 7137.6550s
	iters: 300, epoch: 12 | loss: 0.0142561
	speed: 0.2151s/iter; left time: 6998.8367s
Epoch: 12 cost time: 80.99408912658691
Epoch: 12, Steps: 369 | Train Loss: 0.138 Vali Loss: 1.379 Vali Acc: 0.663 Test Loss: 1.379 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2249509
	speed: 0.6519s/iter; left time: 21102.6022s
	iters: 200, epoch: 13 | loss: 0.0689279
	speed: 0.2150s/iter; left time: 6939.7720s
	iters: 300, epoch: 13 | loss: 0.0172150
	speed: 0.2234s/iter; left time: 7187.5878s
Epoch: 13 cost time: 81.51052641868591
Epoch: 13, Steps: 369 | Train Loss: 0.135 Vali Loss: 1.383 Vali Acc: 0.644 Test Loss: 1.383 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6722474460839954
model parameter : 75938
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6933638
	speed: 0.2391s/iter; left time: 8798.9362s
	iters: 200, epoch: 1 | loss: 0.7681667
	speed: 0.2176s/iter; left time: 7987.0495s
	iters: 300, epoch: 1 | loss: 0.6809519
	speed: 0.2574s/iter; left time: 9420.3018s
Epoch: 1 cost time: 87.9909417629242
Epoch: 1, Steps: 369 | Train Loss: 0.715 Vali Loss: 0.700 Vali Acc: 0.551 Test Loss: 0.700 Test Acc: 0.551
Validation loss decreased (inf --> -0.550788).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5720348
	speed: 0.6976s/iter; left time: 25414.5188s
	iters: 200, epoch: 2 | loss: 0.7176856
	speed: 0.2217s/iter; left time: 8053.6400s
	iters: 300, epoch: 2 | loss: 0.5265539
	speed: 0.2359s/iter; left time: 8547.7507s
Epoch: 2 cost time: 85.12385988235474
Epoch: 2, Steps: 369 | Train Loss: 0.596 Vali Loss: 0.673 Vali Acc: 0.647 Test Loss: 0.673 Test Acc: 0.647
Validation loss decreased (-0.550788 --> -0.646702).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5132685
	speed: 0.7051s/iter; left time: 25426.4840s
	iters: 200, epoch: 3 | loss: 0.6114016
	speed: 0.2166s/iter; left time: 7791.3134s
	iters: 300, epoch: 3 | loss: 0.3279674
	speed: 0.2344s/iter; left time: 8406.6124s
Epoch: 3 cost time: 85.2112762928009
Epoch: 3, Steps: 369 | Train Loss: 0.491 Vali Loss: 0.749 Vali Acc: 0.664 Test Loss: 0.749 Test Acc: 0.664
Validation loss decreased (-0.646702 --> -0.663727).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3638448
	speed: 0.6691s/iter; left time: 23882.6617s
	iters: 200, epoch: 4 | loss: 0.2689669
	speed: 0.2337s/iter; left time: 8317.1812s
	iters: 300, epoch: 4 | loss: 0.4323913
	speed: 0.2278s/iter; left time: 8085.2514s
Epoch: 4 cost time: 84.31900095939636
Epoch: 4, Steps: 369 | Train Loss: 0.421 Vali Loss: 0.748 Vali Acc: 0.658 Test Loss: 0.748 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4364481
	speed: 0.6862s/iter; left time: 24241.1115s
	iters: 200, epoch: 5 | loss: 0.1849606
	speed: 0.2233s/iter; left time: 7865.9604s
	iters: 300, epoch: 5 | loss: 0.2031800
	speed: 0.2343s/iter; left time: 8229.1812s
Epoch: 5 cost time: 86.89124870300293
Epoch: 5, Steps: 369 | Train Loss: 0.369 Vali Loss: 0.805 Vali Acc: 0.671 Test Loss: 0.805 Test Acc: 0.671
Validation loss decreased (-0.663727 --> -0.671104).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1638302
	speed: 0.7506s/iter; left time: 26236.4225s
	iters: 200, epoch: 6 | loss: 0.2661561
	speed: 0.2586s/iter; left time: 9015.0770s
	iters: 300, epoch: 6 | loss: 0.1691227
	speed: 0.2436s/iter; left time: 8465.9080s
Epoch: 6 cost time: 95.02988982200623
Epoch: 6, Steps: 369 | Train Loss: 0.318 Vali Loss: 0.887 Vali Acc: 0.674 Test Loss: 0.887 Test Acc: 0.674
Validation loss decreased (-0.671104 --> -0.673941).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5380069
	speed: 0.7368s/iter; left time: 25483.7337s
	iters: 200, epoch: 7 | loss: 0.4039863
	speed: 0.2342s/iter; left time: 8076.1021s
	iters: 300, epoch: 7 | loss: 0.4242200
	speed: 0.2347s/iter; left time: 8071.7262s
Epoch: 7 cost time: 87.42620420455933
Epoch: 7, Steps: 369 | Train Loss: 0.281 Vali Loss: 0.943 Vali Acc: 0.678 Test Loss: 0.943 Test Acc: 0.678
Validation loss decreased (-0.673941 --> -0.678197).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2852850
	speed: 0.7101s/iter; left time: 24296.5631s
	iters: 200, epoch: 8 | loss: 0.2126140
	speed: 0.2430s/iter; left time: 8291.3758s
	iters: 300, epoch: 8 | loss: 0.3527493
	speed: 0.2216s/iter; left time: 7539.3597s
Epoch: 8 cost time: 86.9361777305603
Epoch: 8, Steps: 369 | Train Loss: 0.238 Vali Loss: 1.058 Vali Acc: 0.660 Test Loss: 1.058 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0863361
	speed: 0.6919s/iter; left time: 23420.6942s
	iters: 200, epoch: 9 | loss: 0.0571412
	speed: 0.2358s/iter; left time: 7959.0890s
	iters: 300, epoch: 9 | loss: 0.0443912
	speed: 0.2288s/iter; left time: 7698.8110s
Epoch: 9 cost time: 86.62533712387085
Epoch: 9, Steps: 369 | Train Loss: 0.205 Vali Loss: 1.197 Vali Acc: 0.659 Test Loss: 1.197 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0663006
	speed: 0.6881s/iter; left time: 23037.0492s
	iters: 200, epoch: 10 | loss: 0.1922690
	speed: 0.2270s/iter; left time: 7576.4411s
	iters: 300, epoch: 10 | loss: 0.1484254
	speed: 0.2345s/iter; left time: 7802.7212s
Epoch: 10 cost time: 86.51192426681519
Epoch: 10, Steps: 369 | Train Loss: 0.190 Vali Loss: 1.244 Vali Acc: 0.651 Test Loss: 1.244 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0777240
	speed: 0.7301s/iter; left time: 24174.9055s
	iters: 200, epoch: 11 | loss: 0.0479426
	speed: 0.2373s/iter; left time: 7832.6324s
	iters: 300, epoch: 11 | loss: 0.1667325
	speed: 0.2371s/iter; left time: 7804.4831s
Epoch: 11 cost time: 87.78748345375061
Epoch: 11, Steps: 369 | Train Loss: 0.165 Vali Loss: 1.276 Vali Acc: 0.670 Test Loss: 1.276 Test Acc: 0.670
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0235000
	speed: 0.6762s/iter; left time: 22139.3535s
	iters: 200, epoch: 12 | loss: 0.2054130
	speed: 0.2288s/iter; left time: 7467.7499s
	iters: 300, epoch: 12 | loss: 0.1220002
	speed: 0.2253s/iter; left time: 7332.3468s
Epoch: 12 cost time: 82.93591928482056
Epoch: 12, Steps: 369 | Train Loss: 0.148 Vali Loss: 1.411 Vali Acc: 0.657 Test Loss: 1.411 Test Acc: 0.657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0904523
	speed: 0.6985s/iter; left time: 22612.0933s
	iters: 200, epoch: 13 | loss: 0.1435291
	speed: 0.2471s/iter; left time: 7974.9426s
	iters: 300, epoch: 13 | loss: 0.0311936
	speed: 0.2470s/iter; left time: 7945.4844s
Epoch: 13 cost time: 90.4309868812561
Epoch: 13, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.394 Vali Acc: 0.650 Test Loss: 1.394 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0339783
	speed: 0.7124s/iter; left time: 22799.1735s
	iters: 200, epoch: 14 | loss: 0.0494119
	speed: 0.2456s/iter; left time: 7835.0093s
	iters: 300, epoch: 14 | loss: 0.0542544
	speed: 0.2453s/iter; left time: 7801.7229s
Epoch: 14 cost time: 91.15568923950195
Epoch: 14, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.526 Vali Acc: 0.657 Test Loss: 1.526 Test Acc: 0.657
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1474250
	speed: 0.7443s/iter; left time: 23544.4148s
	iters: 200, epoch: 15 | loss: 0.0360317
	speed: 0.2346s/iter; left time: 7396.9279s
	iters: 300, epoch: 15 | loss: 0.0240759
	speed: 0.2353s/iter; left time: 7395.1533s
Epoch: 15 cost time: 87.45894694328308
Epoch: 15, Steps: 369 | Train Loss: 0.112 Vali Loss: 1.540 Vali Acc: 0.661 Test Loss: 1.540 Test Acc: 0.661
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0218804
	speed: 0.6808s/iter; left time: 21287.0460s
	iters: 200, epoch: 16 | loss: 0.0728906
	speed: 0.2222s/iter; left time: 6923.7311s
	iters: 300, epoch: 16 | loss: 0.1628718
	speed: 0.2271s/iter; left time: 7055.2047s
Epoch: 16 cost time: 85.2878007888794
Epoch: 16, Steps: 369 | Train Loss: 0.102 Vali Loss: 1.699 Vali Acc: 0.647 Test Loss: 1.699 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0140369
	speed: 0.6885s/iter; left time: 21273.9258s
	iters: 200, epoch: 17 | loss: 0.0922730
	speed: 0.2276s/iter; left time: 7008.3721s
	iters: 300, epoch: 17 | loss: 0.0683402
	speed: 0.2279s/iter; left time: 6995.8241s
Epoch: 17 cost time: 84.25142478942871
Epoch: 17, Steps: 369 | Train Loss: 0.099 Vali Loss: 1.734 Vali Acc: 0.662 Test Loss: 1.734 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6782065834279228
model parameter : 75938
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6760722
	speed: 0.2490s/iter; left time: 9162.5156s
	iters: 200, epoch: 1 | loss: 0.8284492
	speed: 0.2565s/iter; left time: 9413.4415s
	iters: 300, epoch: 1 | loss: 0.7972991
	speed: 0.2616s/iter; left time: 9576.4052s
Epoch: 1 cost time: 93.83607649803162
Epoch: 1, Steps: 369 | Train Loss: 0.717 Vali Loss: 0.692 Vali Acc: 0.552 Test Loss: 0.692 Test Acc: 0.552
Validation loss decreased (inf --> -0.552206).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6095842
	speed: 0.7388s/iter; left time: 26914.7318s
	iters: 200, epoch: 2 | loss: 0.5774135
	speed: 0.2558s/iter; left time: 9292.5474s
	iters: 300, epoch: 2 | loss: 0.4366626
	speed: 0.2443s/iter; left time: 8852.6003s
Epoch: 2 cost time: 92.88239932060242
Epoch: 2, Steps: 369 | Train Loss: 0.603 Vali Loss: 0.654 Vali Acc: 0.664 Test Loss: 0.654 Test Acc: 0.664
Validation loss decreased (-0.552206 --> -0.664012).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6033854
	speed: 0.7315s/iter; left time: 26378.9183s
	iters: 200, epoch: 3 | loss: 0.5589924
	speed: 0.2588s/iter; left time: 9308.4739s
	iters: 300, epoch: 3 | loss: 0.3291924
	speed: 0.2491s/iter; left time: 8932.7823s
Epoch: 3 cost time: 94.96821546554565
Epoch: 3, Steps: 369 | Train Loss: 0.489 Vali Loss: 0.742 Vali Acc: 0.678 Test Loss: 0.742 Test Acc: 0.678
Validation loss decreased (-0.664012 --> -0.677632).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4893076
	speed: 0.7275s/iter; left time: 25966.7136s
	iters: 200, epoch: 4 | loss: 0.2466861
	speed: 0.2312s/iter; left time: 8228.8731s
	iters: 300, epoch: 4 | loss: 0.5347322
	speed: 0.2366s/iter; left time: 8397.8270s
Epoch: 4 cost time: 86.61347365379333
Epoch: 4, Steps: 369 | Train Loss: 0.425 Vali Loss: 0.754 Vali Acc: 0.667 Test Loss: 0.754 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.3286729
	speed: 0.6873s/iter; left time: 24279.2817s
	iters: 200, epoch: 5 | loss: 0.1401562
	speed: 0.2567s/iter; left time: 9040.9976s
	iters: 300, epoch: 5 | loss: 0.2731210
	speed: 0.2404s/iter; left time: 8445.6373s
Epoch: 5 cost time: 89.40469169616699
Epoch: 5, Steps: 369 | Train Loss: 0.373 Vali Loss: 0.793 Vali Acc: 0.674 Test Loss: 0.793 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1966258
	speed: 0.6874s/iter; left time: 24029.0069s
	iters: 200, epoch: 6 | loss: 0.1651812
	speed: 0.2316s/iter; left time: 8074.3208s
	iters: 300, epoch: 6 | loss: 0.2381430
	speed: 0.2399s/iter; left time: 8339.2593s
Epoch: 6 cost time: 86.03602647781372
Epoch: 6, Steps: 369 | Train Loss: 0.326 Vali Loss: 0.915 Vali Acc: 0.673 Test Loss: 0.915 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6506022
	speed: 0.6983s/iter; left time: 24152.7030s
	iters: 200, epoch: 7 | loss: 0.2856257
	speed: 0.2330s/iter; left time: 8034.5543s
	iters: 300, epoch: 7 | loss: 0.2748187
	speed: 0.2393s/iter; left time: 8229.9669s
Epoch: 7 cost time: 86.73526215553284
Epoch: 7, Steps: 369 | Train Loss: 0.283 Vali Loss: 0.962 Vali Acc: 0.661 Test Loss: 0.962 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1037462
	speed: 0.6907s/iter; left time: 23635.3527s
	iters: 200, epoch: 8 | loss: 0.3306724
	speed: 0.2418s/iter; left time: 8250.6026s
	iters: 300, epoch: 8 | loss: 0.2534898
	speed: 0.2575s/iter; left time: 8758.5155s
Epoch: 8 cost time: 89.28241348266602
Epoch: 8, Steps: 369 | Train Loss: 0.257 Vali Loss: 1.056 Vali Acc: 0.660 Test Loss: 1.056 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0751271
	speed: 0.7127s/iter; left time: 24123.0454s
	iters: 200, epoch: 9 | loss: 0.0619334
	speed: 0.2285s/iter; left time: 7713.2027s
	iters: 300, epoch: 9 | loss: 0.2312680
	speed: 0.2355s/iter; left time: 7925.7024s
Epoch: 9 cost time: 87.65009641647339
Epoch: 9, Steps: 369 | Train Loss: 0.218 Vali Loss: 1.100 Vali Acc: 0.660 Test Loss: 1.100 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1239940
	speed: 0.7176s/iter; left time: 24025.5486s
	iters: 200, epoch: 10 | loss: 0.1112688
	speed: 0.2533s/iter; left time: 8455.6037s
	iters: 300, epoch: 10 | loss: 0.1060340
	speed: 0.2428s/iter; left time: 8080.5953s
Epoch: 10 cost time: 92.60611033439636
Epoch: 10, Steps: 369 | Train Loss: 0.183 Vali Loss: 1.211 Vali Acc: 0.660 Test Loss: 1.211 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0640636
	speed: 0.7231s/iter; left time: 23943.2911s
	iters: 200, epoch: 11 | loss: 0.0420325
	speed: 0.2400s/iter; left time: 7923.6892s
	iters: 300, epoch: 11 | loss: 0.0959781
	speed: 0.2366s/iter; left time: 7785.3803s
Epoch: 11 cost time: 91.20671463012695
Epoch: 11, Steps: 369 | Train Loss: 0.168 Vali Loss: 1.270 Vali Acc: 0.666 Test Loss: 1.270 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.2234319
	speed: 0.7230s/iter; left time: 23671.8912s
	iters: 200, epoch: 12 | loss: 0.0694580
	speed: 0.2365s/iter; left time: 7718.5072s
	iters: 300, epoch: 12 | loss: 0.0784496
	speed: 0.2434s/iter; left time: 7920.0244s
Epoch: 12 cost time: 88.4380886554718
Epoch: 12, Steps: 369 | Train Loss: 0.160 Vali Loss: 1.283 Vali Acc: 0.660 Test Loss: 1.283 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0711372
	speed: 0.6966s/iter; left time: 22552.0212s
	iters: 200, epoch: 13 | loss: 0.2080637
	speed: 0.2599s/iter; left time: 8389.2417s
	iters: 300, epoch: 13 | loss: 0.0671408
	speed: 0.2323s/iter; left time: 7474.6989s
Epoch: 13 cost time: 89.34261584281921
Epoch: 13, Steps: 369 | Train Loss: 0.155 Vali Loss: 1.360 Vali Acc: 0.642 Test Loss: 1.360 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.677639046538025
model parameter : 75938
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.7234575
	speed: 0.2562s/iter; left time: 9428.7268s
	iters: 200, epoch: 1 | loss: 0.7776365
	speed: 0.2363s/iter; left time: 8671.4171s
	iters: 300, epoch: 1 | loss: 0.8322369
	speed: 0.2362s/iter; left time: 8644.3111s
Epoch: 1 cost time: 90.37323474884033
Epoch: 1, Steps: 369 | Train Loss: 0.722 Vali Loss: 0.694 Vali Acc: 0.552 Test Loss: 0.694 Test Acc: 0.552
Validation loss decreased (inf --> -0.551923).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7910842
	speed: 0.7295s/iter; left time: 26576.5842s
	iters: 200, epoch: 2 | loss: 0.4784441
	speed: 0.2641s/iter; left time: 9594.2962s
	iters: 300, epoch: 2 | loss: 0.4129308
	speed: 0.2665s/iter; left time: 9656.9703s
Epoch: 2 cost time: 97.28227853775024
Epoch: 2, Steps: 369 | Train Loss: 0.617 Vali Loss: 0.658 Vali Acc: 0.660 Test Loss: 0.658 Test Acc: 0.660
Validation loss decreased (-0.551923 --> -0.659755).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5816337
	speed: 0.7648s/iter; left time: 27579.8557s
	iters: 200, epoch: 3 | loss: 0.4897904
	speed: 0.2428s/iter; left time: 8732.6099s
	iters: 300, epoch: 3 | loss: 0.3816333
	speed: 0.2536s/iter; left time: 9095.5905s
Epoch: 3 cost time: 92.58618187904358
Epoch: 3, Steps: 369 | Train Loss: 0.510 Vali Loss: 0.710 Vali Acc: 0.667 Test Loss: 0.710 Test Acc: 0.667
Validation loss decreased (-0.659755 --> -0.666565).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3919365
	speed: 0.7211s/iter; left time: 25739.4879s
	iters: 200, epoch: 4 | loss: 0.2972256
	speed: 0.2410s/iter; left time: 8579.8132s
	iters: 300, epoch: 4 | loss: 0.6324878
	speed: 0.2347s/iter; left time: 8329.4425s
Epoch: 4 cost time: 88.19104814529419
Epoch: 4, Steps: 369 | Train Loss: 0.453 Vali Loss: 0.707 Vali Acc: 0.672 Test Loss: 0.707 Test Acc: 0.672
Validation loss decreased (-0.666565 --> -0.672240).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3288006
	speed: 0.7308s/iter; left time: 25815.3181s
	iters: 200, epoch: 5 | loss: 0.2379283
	speed: 0.2401s/iter; left time: 8457.1822s
	iters: 300, epoch: 5 | loss: 0.1871945
	speed: 0.2497s/iter; left time: 8770.3880s
Epoch: 5 cost time: 91.85109972953796
Epoch: 5, Steps: 369 | Train Loss: 0.399 Vali Loss: 0.774 Vali Acc: 0.673 Test Loss: 0.774 Test Acc: 0.673
Validation loss decreased (-0.672240 --> -0.672523).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1969013
	speed: 0.7265s/iter; left time: 25395.4089s
	iters: 200, epoch: 6 | loss: 0.1450956
	speed: 0.2362s/iter; left time: 8233.8140s
	iters: 300, epoch: 6 | loss: 0.3006958
	speed: 0.2373s/iter; left time: 8245.8814s
Epoch: 6 cost time: 88.92766666412354
Epoch: 6, Steps: 369 | Train Loss: 0.352 Vali Loss: 0.867 Vali Acc: 0.667 Test Loss: 0.867 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5372290
	speed: 0.7220s/iter; left time: 24972.5768s
	iters: 200, epoch: 7 | loss: 0.6870389
	speed: 0.2391s/iter; left time: 8244.6095s
	iters: 300, epoch: 7 | loss: 0.5036548
	speed: 0.2299s/iter; left time: 7905.7693s
Epoch: 7 cost time: 86.26335763931274
Epoch: 7, Steps: 369 | Train Loss: 0.309 Vali Loss: 0.932 Vali Acc: 0.649 Test Loss: 0.932 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2397113
	speed: 0.7338s/iter; left time: 25109.7629s
	iters: 200, epoch: 8 | loss: 0.3718335
	speed: 0.2470s/iter; left time: 8425.9715s
	iters: 300, epoch: 8 | loss: 0.2932519
	speed: 0.2527s/iter; left time: 8596.1634s
Epoch: 8 cost time: 93.13652801513672
Epoch: 8, Steps: 369 | Train Loss: 0.274 Vali Loss: 0.947 Vali Acc: 0.673 Test Loss: 0.947 Test Acc: 0.673
Validation loss decreased (-0.672523 --> -0.672806).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1887046
	speed: 0.7300s/iter; left time: 24710.9332s
	iters: 200, epoch: 9 | loss: 0.1313653
	speed: 0.2640s/iter; left time: 8908.3673s
	iters: 300, epoch: 9 | loss: 0.2998432
	speed: 0.2644s/iter; left time: 8895.1432s
Epoch: 9 cost time: 95.43792819976807
Epoch: 9, Steps: 369 | Train Loss: 0.242 Vali Loss: 1.054 Vali Acc: 0.649 Test Loss: 1.054 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0461792
	speed: 0.7716s/iter; left time: 25831.7980s
	iters: 200, epoch: 10 | loss: 0.0784493
	speed: 0.2558s/iter; left time: 8539.2056s
	iters: 300, epoch: 10 | loss: 0.3092814
	speed: 0.2443s/iter; left time: 8129.4952s
Epoch: 10 cost time: 92.06985688209534
Epoch: 10, Steps: 369 | Train Loss: 0.213 Vali Loss: 1.076 Vali Acc: 0.664 Test Loss: 1.076 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0569012
	speed: 0.7320s/iter; left time: 24238.0356s
	iters: 200, epoch: 11 | loss: 0.1139949
	speed: 0.2452s/iter; left time: 8095.3532s
	iters: 300, epoch: 11 | loss: 0.0543828
	speed: 0.2517s/iter; left time: 8282.7968s
Epoch: 11 cost time: 93.37157797813416
Epoch: 11, Steps: 369 | Train Loss: 0.184 Vali Loss: 1.163 Vali Acc: 0.661 Test Loss: 1.163 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0469978
	speed: 0.7057s/iter; left time: 23106.8277s
	iters: 200, epoch: 12 | loss: 0.4135065
	speed: 0.2277s/iter; left time: 7433.2610s
	iters: 300, epoch: 12 | loss: 0.4796757
	speed: 0.2280s/iter; left time: 7418.2887s
Epoch: 12 cost time: 85.1941511631012
Epoch: 12, Steps: 369 | Train Loss: 0.174 Vali Loss: 1.297 Vali Acc: 0.657 Test Loss: 1.297 Test Acc: 0.657
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3407711
	speed: 0.7183s/iter; left time: 23254.2239s
	iters: 200, epoch: 13 | loss: 0.0793898
	speed: 0.2535s/iter; left time: 8179.7772s
	iters: 300, epoch: 13 | loss: 0.0163504
	speed: 0.2547s/iter; left time: 8193.6908s
Epoch: 13 cost time: 92.70349144935608
Epoch: 13, Steps: 369 | Train Loss: 0.147 Vali Loss: 1.263 Vali Acc: 0.646 Test Loss: 1.263 Test Acc: 0.646
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1638658
	speed: 0.7474s/iter; left time: 23921.2506s
	iters: 200, epoch: 14 | loss: 0.2138088
	speed: 0.2439s/iter; left time: 7781.9320s
	iters: 300, epoch: 14 | loss: 0.0883169
	speed: 0.2581s/iter; left time: 8207.8685s
Epoch: 14 cost time: 91.32210969924927
Epoch: 14, Steps: 369 | Train Loss: 0.139 Vali Loss: 1.456 Vali Acc: 0.650 Test Loss: 1.456 Test Acc: 0.650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.1421113
	speed: 0.7004s/iter; left time: 22157.7873s
	iters: 200, epoch: 15 | loss: 0.0770509
	speed: 0.2312s/iter; left time: 7290.4303s
	iters: 300, epoch: 15 | loss: 0.0347261
	speed: 0.2273s/iter; left time: 7144.3296s
Epoch: 15 cost time: 85.23354864120483
Epoch: 15, Steps: 369 | Train Loss: 0.124 Vali Loss: 1.480 Vali Acc: 0.653 Test Loss: 1.480 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0343912
	speed: 0.7044s/iter; left time: 22022.4716s
	iters: 200, epoch: 16 | loss: 0.1357712
	speed: 0.2112s/iter; left time: 6581.4037s
	iters: 300, epoch: 16 | loss: 0.1137008
	speed: 0.2039s/iter; left time: 6334.2428s
Epoch: 16 cost time: 80.25692868232727
Epoch: 16, Steps: 369 | Train Loss: 0.110 Vali Loss: 1.559 Vali Acc: 0.650 Test Loss: 1.559 Test Acc: 0.650
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1246467
	speed: 0.6742s/iter; left time: 20831.2641s
	iters: 200, epoch: 17 | loss: 0.0440360
	speed: 0.2260s/iter; left time: 6959.1259s
	iters: 300, epoch: 17 | loss: 0.0546891
	speed: 0.2329s/iter; left time: 7150.8624s
Epoch: 17 cost time: 85.14116764068604
Epoch: 17, Steps: 369 | Train Loss: 0.120 Vali Loss: 1.504 Vali Acc: 0.669 Test Loss: 1.504 Test Acc: 0.669
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0386458
	speed: 0.7120s/iter; left time: 21736.5834s
	iters: 200, epoch: 18 | loss: 0.0863706
	speed: 0.2345s/iter; left time: 7134.4150s
	iters: 300, epoch: 18 | loss: 0.0555795
	speed: 0.2188s/iter; left time: 6635.3753s
Epoch: 18 cost time: 85.69661378860474
Epoch: 18, Steps: 369 | Train Loss: 0.108 Vali Loss: 1.614 Vali Acc: 0.648 Test Loss: 1.614 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.6728149829738933
model parameter : 75938
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FaceDetection   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FaceDetection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             144                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

5890
3524
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
 fourier enhanced cross attention used!
modes_q=15, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
modes_kv=31, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
>>>>>>>start training : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
5890
3524
3524
	iters: 100, epoch: 1 | loss: 0.6925589
	speed: 0.2569s/iter; left time: 9455.1187s
	iters: 200, epoch: 1 | loss: 0.6938927
	speed: 0.2352s/iter; left time: 8632.7978s
	iters: 300, epoch: 1 | loss: 0.6934370
	speed: 0.2324s/iter; left time: 8507.5457s
Epoch: 1 cost time: 88.9048490524292
Epoch: 1, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6911657
	speed: 0.7068s/iter; left time: 25748.4362s
	iters: 200, epoch: 2 | loss: 0.6938906
	speed: 0.2321s/iter; left time: 8433.3666s
	iters: 300, epoch: 2 | loss: 0.6925116
	speed: 0.2351s/iter; left time: 8516.7906s
Epoch: 2 cost time: 88.40741729736328
Epoch: 2, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6931571
	speed: 0.7398s/iter; left time: 26680.3689s
	iters: 200, epoch: 3 | loss: 0.6914301
	speed: 0.2409s/iter; left time: 8664.9650s
	iters: 300, epoch: 3 | loss: 0.6926451
	speed: 0.2409s/iter; left time: 8638.0336s
Epoch: 3 cost time: 90.42606234550476
Epoch: 3, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6925796
	speed: 0.7240s/iter; left time: 25843.7385s
	iters: 200, epoch: 4 | loss: 0.6937067
	speed: 0.2460s/iter; left time: 8757.0593s
	iters: 300, epoch: 4 | loss: 0.6931525
	speed: 0.2526s/iter; left time: 8965.6829s
Epoch: 4 cost time: 90.8627061843872
Epoch: 4, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6939070
	speed: 0.7301s/iter; left time: 25789.5818s
	iters: 200, epoch: 5 | loss: 0.6931682
	speed: 0.2382s/iter; left time: 8389.9885s
	iters: 300, epoch: 5 | loss: 0.6931524
	speed: 0.2479s/iter; left time: 8706.5238s
Epoch: 5 cost time: 93.62014675140381
Epoch: 5, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.6931545
	speed: 0.7232s/iter; left time: 25281.2732s
	iters: 200, epoch: 6 | loss: 0.6929884
	speed: 0.2311s/iter; left time: 8056.4234s
	iters: 300, epoch: 6 | loss: 0.6931576
	speed: 0.2717s/iter; left time: 9442.6955s
Epoch: 6 cost time: 90.99696469306946
Epoch: 6, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.6928030
	speed: 0.7136s/iter; left time: 24680.2758s
	iters: 200, epoch: 7 | loss: 0.6919296
	speed: 0.2537s/iter; left time: 8748.9253s
	iters: 300, epoch: 7 | loss: 0.6936660
	speed: 0.2587s/iter; left time: 8897.0600s
Epoch: 7 cost time: 92.72296500205994
Epoch: 7, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6926804
	speed: 0.7265s/iter; left time: 24858.2093s
	iters: 200, epoch: 8 | loss: 0.6942562
	speed: 0.2506s/iter; left time: 8549.7345s
	iters: 300, epoch: 8 | loss: 0.6931472
	speed: 0.2469s/iter; left time: 8400.3546s
Epoch: 8 cost time: 91.32162308692932
Epoch: 8, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.6995991
	speed: 0.6976s/iter; left time: 23612.8836s
	iters: 200, epoch: 9 | loss: 0.6919874
	speed: 0.2574s/iter; left time: 8687.5261s
	iters: 300, epoch: 9 | loss: 0.6915253
	speed: 0.2500s/iter; left time: 8412.6409s
Epoch: 9 cost time: 89.42301440238953
Epoch: 9, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6935997
	speed: 0.6974s/iter; left time: 23348.6262s
	iters: 200, epoch: 10 | loss: 0.6877713
	speed: 0.2423s/iter; left time: 8086.6606s
	iters: 300, epoch: 10 | loss: 0.6924348
	speed: 0.2514s/iter; left time: 8366.9628s
Epoch: 10 cost time: 90.59587359428406
Epoch: 10, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.6945869
	speed: 0.7207s/iter; left time: 23862.9303s
	iters: 200, epoch: 11 | loss: 0.6932017
	speed: 0.2377s/iter; left time: 7845.4747s
	iters: 300, epoch: 11 | loss: 0.6931739
	speed: 0.2281s/iter; left time: 7507.9827s
Epoch: 11 cost time: 87.35666608810425
Epoch: 11, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.6933040
	speed: 0.6981s/iter; left time: 22857.1565s
	iters: 200, epoch: 12 | loss: 0.6931666
	speed: 0.2324s/iter; left time: 7585.1510s
	iters: 300, epoch: 12 | loss: 0.6923217
	speed: 0.2387s/iter; left time: 7767.1978s
Epoch: 12 cost time: 85.85810565948486
Epoch: 12, Steps: 369 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FaceDetection_FEDformer_UEA_ftM_sl62_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3524
test shape: torch.Size([3524, 2]) torch.Size([3524, 1])
accuracy:0.5
model parameter : 75938
model size : 1.53MB
