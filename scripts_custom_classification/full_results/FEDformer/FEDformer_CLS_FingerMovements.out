Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.089730978012085
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 5.845258474349976
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.860092878341675
Epoch: 3, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.831 Vali Acc: 0.480 Test Loss: 0.831 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.109408617019653
Epoch: 4, Steps: 20 | Train Loss: 0.582 Vali Loss: 1.085 Vali Acc: 0.510 Test Loss: 1.085 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.418359756469727
Epoch: 5, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.952 Vali Acc: 0.530 Test Loss: 0.952 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.622266054153442
Epoch: 6, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.060 Vali Acc: 0.530 Test Loss: 1.060 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.547793388366699
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.509 Vali Acc: 0.530 Test Loss: 1.509 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.586344242095947
Epoch: 8, Steps: 20 | Train Loss: 0.532 Vali Loss: 1.491 Vali Acc: 0.510 Test Loss: 1.491 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.5243916511535645
Epoch: 9, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.455 Vali Acc: 0.530 Test Loss: 1.455 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.665202856063843
Epoch: 10, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.347 Vali Acc: 0.510 Test Loss: 1.347 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.076354503631592
Epoch: 11, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.983 Vali Acc: 0.470 Test Loss: 1.983 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.9615888595581055
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 6.009539604187012
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.471386432647705
Epoch: 3, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.932 Vali Acc: 0.460 Test Loss: 0.932 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.8386406898498535
Epoch: 4, Steps: 20 | Train Loss: 0.573 Vali Loss: 1.067 Vali Acc: 0.500 Test Loss: 1.067 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.086744785308838
Epoch: 5, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.051 Vali Acc: 0.470 Test Loss: 1.051 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.795104503631592
Epoch: 6, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.979 Vali Acc: 0.520 Test Loss: 0.979 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.110670566558838
Epoch: 7, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.434 Vali Acc: 0.470 Test Loss: 1.434 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.337616682052612
Epoch: 8, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.520 Vali Acc: 0.490 Test Loss: 1.520 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.205556869506836
Epoch: 9, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.478 Vali Acc: 0.490 Test Loss: 1.478 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.286818265914917
Epoch: 10, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.398 Vali Acc: 0.480 Test Loss: 1.398 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.496374130249023
Epoch: 11, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.459 Vali Acc: 0.540 Test Loss: 1.459 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539985).  Saving model ...
Epoch: 12 cost time: 5.69103479385376
Epoch: 12, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.809 Vali Acc: 0.500 Test Loss: 1.809 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.308336496353149
Epoch: 13, Steps: 20 | Train Loss: 0.363 Vali Loss: 2.396 Vali Acc: 0.540 Test Loss: 2.396 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.545753240585327
Epoch: 14, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.897 Vali Acc: 0.550 Test Loss: 1.897 Test Acc: 0.550
Validation loss decreased (-0.539985 --> -0.549981).  Saving model ...
Epoch: 15 cost time: 5.372014760971069
Epoch: 15, Steps: 20 | Train Loss: 0.202 Vali Loss: 1.920 Vali Acc: 0.560 Test Loss: 1.920 Test Acc: 0.560
Validation loss decreased (-0.549981 --> -0.559981).  Saving model ...
Epoch: 16 cost time: 5.6101415157318115
Epoch: 16, Steps: 20 | Train Loss: 0.250 Vali Loss: 2.306 Vali Acc: 0.520 Test Loss: 2.306 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.2457287311553955
Epoch: 17, Steps: 20 | Train Loss: 0.177 Vali Loss: 3.315 Vali Acc: 0.530 Test Loss: 3.315 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.346236228942871
Epoch: 18, Steps: 20 | Train Loss: 0.656 Vali Loss: 2.741 Vali Acc: 0.550 Test Loss: 2.741 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.040954828262329
Epoch: 19, Steps: 20 | Train Loss: 0.475 Vali Loss: 3.536 Vali Acc: 0.540 Test Loss: 3.536 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.148191213607788
Epoch: 20, Steps: 20 | Train Loss: 0.336 Vali Loss: 2.914 Vali Acc: 0.550 Test Loss: 2.914 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.696629285812378
Epoch: 21, Steps: 20 | Train Loss: 0.392 Vali Loss: 3.345 Vali Acc: 0.480 Test Loss: 3.345 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.210506916046143
Epoch: 22, Steps: 20 | Train Loss: 0.329 Vali Loss: 2.493 Vali Acc: 0.520 Test Loss: 2.493 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.294627904891968
Epoch: 23, Steps: 20 | Train Loss: 0.202 Vali Loss: 3.237 Vali Acc: 0.550 Test Loss: 3.237 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.499563932418823
Epoch: 24, Steps: 20 | Train Loss: 0.434 Vali Loss: 3.139 Vali Acc: 0.510 Test Loss: 3.139 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.196967363357544
Epoch: 25, Steps: 20 | Train Loss: 0.093 Vali Loss: 3.269 Vali Acc: 0.490 Test Loss: 3.269 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.667652130126953
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.884 Vali Acc: 0.520 Test Loss: 0.884 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 6.9338555335998535
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.813 Vali Acc: 0.450 Test Loss: 0.813 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.679676532745361
Epoch: 3, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.940 Vali Acc: 0.490 Test Loss: 0.940 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.54842209815979
Epoch: 4, Steps: 20 | Train Loss: 0.588 Vali Loss: 1.075 Vali Acc: 0.500 Test Loss: 1.075 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.498386383056641
Epoch: 5, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.967 Vali Acc: 0.480 Test Loss: 0.967 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.8647541999816895
Epoch: 6, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.994 Vali Acc: 0.590 Test Loss: 0.994 Test Acc: 0.590
Validation loss decreased (-0.519991 --> -0.589990).  Saving model ...
Epoch: 7 cost time: 6.642923355102539
Epoch: 7, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.258 Vali Acc: 0.550 Test Loss: 1.258 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.401057481765747
Epoch: 8, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.007 Vali Acc: 0.560 Test Loss: 1.007 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.404969692230225
Epoch: 9, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.308 Vali Acc: 0.510 Test Loss: 1.308 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.935011386871338
Epoch: 10, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.234 Vali Acc: 0.570 Test Loss: 1.234 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.3609535694122314
Epoch: 11, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.154 Vali Acc: 0.590 Test Loss: 1.154 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.871042728424072
Epoch: 12, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.368 Vali Acc: 0.520 Test Loss: 1.368 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.06934666633606
Epoch: 13, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.656 Vali Acc: 0.540 Test Loss: 1.656 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.192739486694336
Epoch: 14, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.845 Vali Acc: 0.510 Test Loss: 1.845 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.0259013175964355
Epoch: 15, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.852 Vali Acc: 0.530 Test Loss: 1.852 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.111543655395508
Epoch: 16, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.925 Vali Acc: 0.550 Test Loss: 1.925 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.184807062149048
Epoch: 1, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.939 Vali Acc: 0.490 Test Loss: 0.939 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 6.0174243450164795
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.823 Vali Acc: 0.490 Test Loss: 0.823 Test Acc: 0.490
Validation loss decreased (-0.489991 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 6.674058437347412
Epoch: 3, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
Validation loss decreased (-0.489992 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 7.104480743408203
Epoch: 4, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.090 Vali Acc: 0.460 Test Loss: 1.090 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.10890531539917
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 1.151 Vali Acc: 0.510 Test Loss: 1.151 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.669488191604614
Epoch: 6, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.138 Vali Acc: 0.540 Test Loss: 1.138 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539989).  Saving model ...
Epoch: 7 cost time: 6.604179859161377
Epoch: 7, Steps: 20 | Train Loss: 0.511 Vali Loss: 1.395 Vali Acc: 0.540 Test Loss: 1.395 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.4225568771362305
Epoch: 8, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.109 Vali Acc: 0.510 Test Loss: 1.109 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.751093864440918
Epoch: 9, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.240 Vali Acc: 0.530 Test Loss: 1.240 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.310205459594727
Epoch: 10, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.707 Vali Acc: 0.540 Test Loss: 1.707 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.855242490768433
Epoch: 11, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.176 Vali Acc: 0.600 Test Loss: 1.176 Test Acc: 0.600
Validation loss decreased (-0.539989 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 7.192432165145874
Epoch: 12, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.560 Vali Acc: 0.490 Test Loss: 1.560 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.1267406940460205
Epoch: 13, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.493 Vali Acc: 0.580 Test Loss: 1.493 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.727065086364746
Epoch: 14, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.794 Vali Acc: 0.540 Test Loss: 1.794 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.33004093170166
Epoch: 15, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.858 Vali Acc: 0.560 Test Loss: 1.858 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.856057167053223
Epoch: 16, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.969 Vali Acc: 0.570 Test Loss: 1.969 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.222841501235962
Epoch: 17, Steps: 20 | Train Loss: 0.320 Vali Loss: 2.425 Vali Acc: 0.540 Test Loss: 2.425 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.117590665817261
Epoch: 18, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.878 Vali Acc: 0.570 Test Loss: 1.878 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.148684978485107
Epoch: 19, Steps: 20 | Train Loss: 0.252 Vali Loss: 2.009 Vali Acc: 0.480 Test Loss: 2.009 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.998493194580078
Epoch: 20, Steps: 20 | Train Loss: 0.366 Vali Loss: 2.985 Vali Acc: 0.520 Test Loss: 2.985 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.171174049377441
Epoch: 21, Steps: 20 | Train Loss: 0.308 Vali Loss: 3.701 Vali Acc: 0.490 Test Loss: 3.701 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.272976160049438
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.875 Vali Acc: 0.440 Test Loss: 0.875 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 6.627186059951782
Epoch: 2, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.981 Vali Acc: 0.450 Test Loss: 0.981 Test Acc: 0.450
Validation loss decreased (-0.439991 --> -0.449990).  Saving model ...
Epoch: 3 cost time: 6.169730186462402
Epoch: 3, Steps: 20 | Train Loss: 0.614 Vali Loss: 1.053 Vali Acc: 0.500 Test Loss: 1.053 Test Acc: 0.500
Validation loss decreased (-0.449990 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 7.098067283630371
Epoch: 4, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.138 Vali Acc: 0.520 Test Loss: 1.138 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519989).  Saving model ...
Epoch: 5 cost time: 6.749436140060425
Epoch: 5, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.745485067367554
Epoch: 6, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.341 Vali Acc: 0.540 Test Loss: 1.341 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539987).  Saving model ...
Epoch: 7 cost time: 6.269505262374878
Epoch: 7, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.407 Vali Acc: 0.500 Test Loss: 1.407 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.20326566696167
Epoch: 8, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.194 Vali Acc: 0.540 Test Loss: 1.194 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 6.525896310806274
Epoch: 9, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.350 Vali Acc: 0.540 Test Loss: 1.350 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.503870487213135
Epoch: 10, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.552 Vali Acc: 0.550 Test Loss: 1.552 Test Acc: 0.550
Validation loss decreased (-0.539988 --> -0.549984).  Saving model ...
Epoch: 11 cost time: 6.931444883346558
Epoch: 11, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.245 Vali Acc: 0.550 Test Loss: 1.245 Test Acc: 0.550
Validation loss decreased (-0.549984 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 7.1434783935546875
Epoch: 12, Steps: 20 | Train Loss: 0.355 Vali Loss: 2.628 Vali Acc: 0.560 Test Loss: 2.628 Test Acc: 0.560
Validation loss decreased (-0.549988 --> -0.559974).  Saving model ...
Epoch: 13 cost time: 6.969573974609375
Epoch: 13, Steps: 20 | Train Loss: 0.446 Vali Loss: 1.940 Vali Acc: 0.540 Test Loss: 1.940 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.718217611312866
Epoch: 14, Steps: 20 | Train Loss: 0.247 Vali Loss: 1.984 Vali Acc: 0.520 Test Loss: 1.984 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.767282009124756
Epoch: 15, Steps: 20 | Train Loss: 0.261 Vali Loss: 2.758 Vali Acc: 0.560 Test Loss: 2.758 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.441049098968506
Epoch: 16, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.748 Vali Acc: 0.560 Test Loss: 1.748 Test Acc: 0.560
Validation loss decreased (-0.559974 --> -0.559983).  Saving model ...
Epoch: 17 cost time: 7.2077555656433105
Epoch: 17, Steps: 20 | Train Loss: 0.311 Vali Loss: 2.405 Vali Acc: 0.530 Test Loss: 2.405 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.104388475418091
Epoch: 18, Steps: 20 | Train Loss: 0.252 Vali Loss: 2.938 Vali Acc: 0.440 Test Loss: 2.938 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.407813787460327
Epoch: 19, Steps: 20 | Train Loss: 0.331 Vali Loss: 2.444 Vali Acc: 0.550 Test Loss: 2.444 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.949849367141724
Epoch: 20, Steps: 20 | Train Loss: 0.204 Vali Loss: 2.888 Vali Acc: 0.500 Test Loss: 2.888 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.728352785110474
Epoch: 21, Steps: 20 | Train Loss: 0.281 Vali Loss: 3.514 Vali Acc: 0.520 Test Loss: 3.514 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.837234020233154
Epoch: 22, Steps: 20 | Train Loss: 0.254 Vali Loss: 4.028 Vali Acc: 0.540 Test Loss: 4.028 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.524463891983032
Epoch: 23, Steps: 20 | Train Loss: 0.237 Vali Loss: 2.625 Vali Acc: 0.550 Test Loss: 2.625 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.009072303771973
Epoch: 24, Steps: 20 | Train Loss: 0.262 Vali Loss: 2.740 Vali Acc: 0.540 Test Loss: 2.740 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.703872442245483
Epoch: 25, Steps: 20 | Train Loss: 0.221 Vali Loss: 2.613 Vali Acc: 0.590 Test Loss: 2.613 Test Acc: 0.590
Validation loss decreased (-0.559983 --> -0.589974).  Saving model ...
Epoch: 26 cost time: 7.104854106903076
Epoch: 26, Steps: 20 | Train Loss: 0.301 Vali Loss: 3.493 Vali Acc: 0.510 Test Loss: 3.493 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.001619338989258
Epoch: 27, Steps: 20 | Train Loss: 0.197 Vali Loss: 2.725 Vali Acc: 0.500 Test Loss: 2.725 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.840458869934082
Epoch: 28, Steps: 20 | Train Loss: 0.331 Vali Loss: 4.420 Vali Acc: 0.530 Test Loss: 4.420 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.314171314239502
Epoch: 29, Steps: 20 | Train Loss: 0.542 Vali Loss: 3.109 Vali Acc: 0.560 Test Loss: 3.109 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.115142107009888
Epoch: 30, Steps: 20 | Train Loss: 0.181 Vali Loss: 3.432 Vali Acc: 0.530 Test Loss: 3.432 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.546725511550903
Epoch: 31, Steps: 20 | Train Loss: 0.189 Vali Loss: 3.652 Vali Acc: 0.540 Test Loss: 3.652 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.61038875579834
Epoch: 32, Steps: 20 | Train Loss: 0.281 Vali Loss: 4.674 Vali Acc: 0.550 Test Loss: 4.674 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 7.379630088806152
Epoch: 33, Steps: 20 | Train Loss: 0.294 Vali Loss: 4.787 Vali Acc: 0.520 Test Loss: 4.787 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 7.3615734577178955
Epoch: 34, Steps: 20 | Train Loss: 0.306 Vali Loss: 3.782 Vali Acc: 0.540 Test Loss: 3.782 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.412065029144287
Epoch: 35, Steps: 20 | Train Loss: 0.178 Vali Loss: 4.122 Vali Acc: 0.510 Test Loss: 4.122 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.754093408584595
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 7.205538034439087
Epoch: 2, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.816 Vali Acc: 0.510 Test Loss: 0.816 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.126709222793579
Epoch: 3, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.853 Vali Acc: 0.510 Test Loss: 0.853 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.130049467086792
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.092 Vali Acc: 0.550 Test Loss: 1.092 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 7.563342571258545
Epoch: 5, Steps: 20 | Train Loss: 0.724 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.482166051864624
Epoch: 6, Steps: 20 | Train Loss: 0.699 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.2813849449157715
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 1.240 Vali Acc: 0.580 Test Loss: 1.240 Test Acc: 0.580
Validation loss decreased (-0.549989 --> -0.579988).  Saving model ...
Epoch: 8 cost time: 6.935141324996948
Epoch: 8, Steps: 20 | Train Loss: 0.701 Vali Loss: 1.166 Vali Acc: 0.530 Test Loss: 1.166 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.733911752700806
Epoch: 9, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.160 Vali Acc: 0.550 Test Loss: 1.160 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.678590774536133
Epoch: 10, Steps: 20 | Train Loss: 0.545 Vali Loss: 1.271 Vali Acc: 0.600 Test Loss: 1.271 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 7.129356861114502
Epoch: 11, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.730 Vali Acc: 0.580 Test Loss: 1.730 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.273116827011108
Epoch: 12, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.250 Vali Acc: 0.570 Test Loss: 1.250 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.067010402679443
Epoch: 13, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.801 Vali Acc: 0.560 Test Loss: 1.801 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.823960781097412
Epoch: 14, Steps: 20 | Train Loss: 0.542 Vali Loss: 1.426 Vali Acc: 0.590 Test Loss: 1.426 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.460068702697754
Epoch: 15, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.706 Vali Acc: 0.520 Test Loss: 1.706 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.886077165603638
Epoch: 16, Steps: 20 | Train Loss: 0.444 Vali Loss: 2.468 Vali Acc: 0.520 Test Loss: 2.468 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.950590133666992
Epoch: 17, Steps: 20 | Train Loss: 0.642 Vali Loss: 2.027 Vali Acc: 0.530 Test Loss: 2.027 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.3508594036102295
Epoch: 18, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.499 Vali Acc: 0.580 Test Loss: 1.499 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.277137279510498
Epoch: 19, Steps: 20 | Train Loss: 0.363 Vali Loss: 2.515 Vali Acc: 0.560 Test Loss: 2.515 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.0768396854400635
Epoch: 20, Steps: 20 | Train Loss: 0.547 Vali Loss: 2.098 Vali Acc: 0.510 Test Loss: 2.098 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.840084552764893
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 7.044074535369873
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.11469030380249
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.869 Vali Acc: 0.490 Test Loss: 0.869 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.0060133934021
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 1.077 Vali Acc: 0.530 Test Loss: 1.077 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529989).  Saving model ...
Epoch: 5 cost time: 7.079061508178711
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.995 Vali Acc: 0.590 Test Loss: 0.995 Test Acc: 0.590
Validation loss decreased (-0.529989 --> -0.589990).  Saving model ...
Epoch: 6 cost time: 7.1051926612854
Epoch: 6, Steps: 20 | Train Loss: 0.710 Vali Loss: 1.143 Vali Acc: 0.590 Test Loss: 1.143 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.105836391448975
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 1.890 Vali Acc: 0.480 Test Loss: 1.890 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.006357908248901
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.990 Vali Acc: 0.520 Test Loss: 0.990 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.5553672313690186
Epoch: 9, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.156 Vali Acc: 0.560 Test Loss: 1.156 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.710552215576172
Epoch: 10, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.159 Vali Acc: 0.590 Test Loss: 1.159 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.245939016342163
Epoch: 11, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.498 Vali Acc: 0.600 Test Loss: 1.498 Test Acc: 0.600
Validation loss decreased (-0.589990 --> -0.599985).  Saving model ...
Epoch: 12 cost time: 6.553130626678467
Epoch: 12, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.294 Vali Acc: 0.560 Test Loss: 1.294 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.879063367843628
Epoch: 13, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.947 Vali Acc: 0.560 Test Loss: 1.947 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.900322914123535
Epoch: 14, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.787 Vali Acc: 0.520 Test Loss: 1.787 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.72377872467041
Epoch: 15, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.667 Vali Acc: 0.560 Test Loss: 1.667 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.710379600524902
Epoch: 16, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.964 Vali Acc: 0.520 Test Loss: 1.964 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.397029161453247
Epoch: 17, Steps: 20 | Train Loss: 0.414 Vali Loss: 2.196 Vali Acc: 0.620 Test Loss: 2.196 Test Acc: 0.620
Validation loss decreased (-0.599985 --> -0.619978).  Saving model ...
Epoch: 18 cost time: 7.117449998855591
Epoch: 18, Steps: 20 | Train Loss: 0.549 Vali Loss: 2.805 Vali Acc: 0.500 Test Loss: 2.805 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.93911075592041
Epoch: 19, Steps: 20 | Train Loss: 0.418 Vali Loss: 2.197 Vali Acc: 0.610 Test Loss: 2.197 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.199773073196411
Epoch: 20, Steps: 20 | Train Loss: 0.299 Vali Loss: 2.215 Vali Acc: 0.560 Test Loss: 2.215 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.196529150009155
Epoch: 21, Steps: 20 | Train Loss: 0.371 Vali Loss: 2.863 Vali Acc: 0.490 Test Loss: 2.863 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.768973350524902
Epoch: 22, Steps: 20 | Train Loss: 0.437 Vali Loss: 3.066 Vali Acc: 0.530 Test Loss: 3.066 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.624092102050781
Epoch: 23, Steps: 20 | Train Loss: 0.491 Vali Loss: 2.106 Vali Acc: 0.610 Test Loss: 2.106 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.841583728790283
Epoch: 24, Steps: 20 | Train Loss: 0.258 Vali Loss: 3.152 Vali Acc: 0.510 Test Loss: 3.152 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.5362327098846436
Epoch: 25, Steps: 20 | Train Loss: 0.206 Vali Loss: 3.433 Vali Acc: 0.450 Test Loss: 3.433 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.5063560009002686
Epoch: 26, Steps: 20 | Train Loss: 0.226 Vali Loss: 3.486 Vali Acc: 0.530 Test Loss: 3.486 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.703542947769165
Epoch: 27, Steps: 20 | Train Loss: 0.282 Vali Loss: 3.210 Vali Acc: 0.530 Test Loss: 3.210 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.83304738998413
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.918579816818237
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.572174787521362
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.647759675979614
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.264236927032471
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.877867221832275
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 7 cost time: 6.803344011306763
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.303131341934204
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.289952516555786
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.841929197311401
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.502324104309082
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.99175238609314
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.146605014801025
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.02420449256897
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.008994817733765
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.332509756088257
Epoch: 16, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 13816322
model size : 72.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.10782527923584
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.849 Vali Acc: 0.530 Test Loss: 0.849 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 6.075201988220215
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.812405347824097
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.873 Vali Acc: 0.490 Test Loss: 0.873 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.507367849349976
Epoch: 4, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.921 Vali Acc: 0.510 Test Loss: 0.921 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.428234815597534
Epoch: 5, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.946 Vali Acc: 0.530 Test Loss: 0.946 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.595083951950073
Epoch: 6, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.955 Vali Acc: 0.460 Test Loss: 0.955 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.199579954147339
Epoch: 7, Steps: 20 | Train Loss: 0.633 Vali Loss: 1.421 Vali Acc: 0.450 Test Loss: 1.421 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.305029392242432
Epoch: 8, Steps: 20 | Train Loss: 0.592 Vali Loss: 1.535 Vali Acc: 0.560 Test Loss: 1.535 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559985).  Saving model ...
Epoch: 9 cost time: 6.105258464813232
Epoch: 9, Steps: 20 | Train Loss: 0.570 Vali Loss: 1.251 Vali Acc: 0.490 Test Loss: 1.251 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.2319276332855225
Epoch: 10, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.181 Vali Acc: 0.540 Test Loss: 1.181 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.042217493057251
Epoch: 11, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.367 Vali Acc: 0.540 Test Loss: 1.367 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.715687274932861
Epoch: 12, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.183 Vali Acc: 0.510 Test Loss: 1.183 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.019375324249268
Epoch: 13, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.443 Vali Acc: 0.500 Test Loss: 1.443 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.667521715164185
Epoch: 14, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.622 Vali Acc: 0.560 Test Loss: 1.622 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.0928053855896
Epoch: 15, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.212 Vali Acc: 0.580 Test Loss: 1.212 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579988).  Saving model ...
Epoch: 16 cost time: 6.084859132766724
Epoch: 16, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.770 Vali Acc: 0.530 Test Loss: 1.770 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.378368139266968
Epoch: 17, Steps: 20 | Train Loss: 0.157 Vali Loss: 2.244 Vali Acc: 0.530 Test Loss: 2.244 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.480997800827026
Epoch: 18, Steps: 20 | Train Loss: 0.155 Vali Loss: 2.645 Vali Acc: 0.530 Test Loss: 2.645 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.624281406402588
Epoch: 19, Steps: 20 | Train Loss: 0.179 Vali Loss: 2.691 Vali Acc: 0.570 Test Loss: 2.691 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.910812139511108
Epoch: 20, Steps: 20 | Train Loss: 0.294 Vali Loss: 2.362 Vali Acc: 0.590 Test Loss: 2.362 Test Acc: 0.590
Validation loss decreased (-0.579988 --> -0.589976).  Saving model ...
Epoch: 21 cost time: 6.068589448928833
Epoch: 21, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.973 Vali Acc: 0.580 Test Loss: 1.973 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.057001113891602
Epoch: 22, Steps: 20 | Train Loss: 0.148 Vali Loss: 2.479 Vali Acc: 0.540 Test Loss: 2.479 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.933443069458008
Epoch: 23, Steps: 20 | Train Loss: 0.128 Vali Loss: 2.666 Vali Acc: 0.570 Test Loss: 2.666 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.1821513175964355
Epoch: 24, Steps: 20 | Train Loss: 0.187 Vali Loss: 2.897 Vali Acc: 0.490 Test Loss: 2.897 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.094614028930664
Epoch: 25, Steps: 20 | Train Loss: 0.183 Vali Loss: 3.005 Vali Acc: 0.560 Test Loss: 3.005 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.502720355987549
Epoch: 26, Steps: 20 | Train Loss: 0.206 Vali Loss: 4.987 Vali Acc: 0.540 Test Loss: 4.987 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.374963045120239
Epoch: 27, Steps: 20 | Train Loss: 0.310 Vali Loss: 3.628 Vali Acc: 0.580 Test Loss: 3.628 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.742483854293823
Epoch: 28, Steps: 20 | Train Loss: 0.153 Vali Loss: 4.433 Vali Acc: 0.530 Test Loss: 4.433 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.675043821334839
Epoch: 29, Steps: 20 | Train Loss: 0.268 Vali Loss: 4.235 Vali Acc: 0.570 Test Loss: 4.235 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.046819686889648
Epoch: 30, Steps: 20 | Train Loss: 0.080 Vali Loss: 5.225 Vali Acc: 0.540 Test Loss: 5.225 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.704448223114014
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.857 Vali Acc: 0.480 Test Loss: 0.857 Test Acc: 0.480
Validation loss decreased (inf --> -0.479991).  Saving model ...
Epoch: 2 cost time: 5.79168701171875
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.944 Vali Acc: 0.500 Test Loss: 0.944 Test Acc: 0.500
Validation loss decreased (-0.479991 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 6.228124141693115
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.903 Vali Acc: 0.470 Test Loss: 0.903 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.508728504180908
Epoch: 4, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.902 Vali Acc: 0.520 Test Loss: 0.902 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519991).  Saving model ...
Epoch: 5 cost time: 6.382209539413452
Epoch: 5, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.934 Vali Acc: 0.560 Test Loss: 0.934 Test Acc: 0.560
Validation loss decreased (-0.519991 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 6.033401250839233
Epoch: 6, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.989 Vali Acc: 0.420 Test Loss: 0.989 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.97776460647583
Epoch: 7, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.220 Vali Acc: 0.510 Test Loss: 1.220 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.219672203063965
Epoch: 8, Steps: 20 | Train Loss: 0.485 Vali Loss: 1.097 Vali Acc: 0.510 Test Loss: 1.097 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.651466131210327
Epoch: 9, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.323 Vali Acc: 0.530 Test Loss: 1.323 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.900207757949829
Epoch: 10, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.174 Vali Acc: 0.570 Test Loss: 1.174 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569988).  Saving model ...
Epoch: 11 cost time: 6.024069786071777
Epoch: 11, Steps: 20 | Train Loss: 0.406 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.745758295059204
Epoch: 12, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.760 Vali Acc: 0.540 Test Loss: 1.760 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.320781707763672
Epoch: 13, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.700 Vali Acc: 0.540 Test Loss: 1.700 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.398757457733154
Epoch: 14, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.495 Vali Acc: 0.510 Test Loss: 1.495 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.309892892837524
Epoch: 15, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.567 Vali Acc: 0.540 Test Loss: 1.567 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.547553062438965
Epoch: 16, Steps: 20 | Train Loss: 0.217 Vali Loss: 2.048 Vali Acc: 0.570 Test Loss: 2.048 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.235198974609375
Epoch: 17, Steps: 20 | Train Loss: 0.250 Vali Loss: 2.262 Vali Acc: 0.530 Test Loss: 2.262 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.290324687957764
Epoch: 18, Steps: 20 | Train Loss: 0.311 Vali Loss: 2.373 Vali Acc: 0.520 Test Loss: 2.373 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.646859407424927
Epoch: 19, Steps: 20 | Train Loss: 0.149 Vali Loss: 2.373 Vali Acc: 0.560 Test Loss: 2.373 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.490484714508057
Epoch: 20, Steps: 20 | Train Loss: 0.133 Vali Loss: 2.287 Vali Acc: 0.540 Test Loss: 2.287 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.69831395149231
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 6.125807046890259
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.939 Vali Acc: 0.520 Test Loss: 0.939 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.825303316116333
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.856 Vali Acc: 0.500 Test Loss: 0.856 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.896450996398926
Epoch: 4, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.189052581787109
Epoch: 5, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.879 Vali Acc: 0.570 Test Loss: 0.879 Test Acc: 0.570
Validation loss decreased (-0.519991 --> -0.569991).  Saving model ...
Epoch: 6 cost time: 5.965365171432495
Epoch: 6, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.884 Vali Acc: 0.580 Test Loss: 0.884 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 7 cost time: 5.58698296546936
Epoch: 7, Steps: 20 | Train Loss: 0.566 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.898293733596802
Epoch: 8, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.294 Vali Acc: 0.560 Test Loss: 1.294 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.958019495010376
Epoch: 9, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.075 Vali Acc: 0.570 Test Loss: 1.075 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.995150327682495
Epoch: 10, Steps: 20 | Train Loss: 0.341 Vali Loss: 1.105 Vali Acc: 0.570 Test Loss: 1.105 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.330618381500244
Epoch: 11, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.272 Vali Acc: 0.540 Test Loss: 1.272 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.261809349060059
Epoch: 12, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.906 Vali Acc: 0.530 Test Loss: 1.906 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.573326587677002
Epoch: 13, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.376 Vali Acc: 0.550 Test Loss: 1.376 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.575057029724121
Epoch: 14, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.682 Vali Acc: 0.580 Test Loss: 1.682 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.319571495056152
Epoch: 15, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.323 Vali Acc: 0.580 Test Loss: 1.323 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.1360182762146
Epoch: 16, Steps: 20 | Train Loss: 0.236 Vali Loss: 2.065 Vali Acc: 0.590 Test Loss: 2.065 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589979).  Saving model ...
Epoch: 17 cost time: 6.303990125656128
Epoch: 17, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.406 Vali Acc: 0.530 Test Loss: 1.406 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.169466257095337
Epoch: 18, Steps: 20 | Train Loss: 0.240 Vali Loss: 1.813 Vali Acc: 0.520 Test Loss: 1.813 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.160321474075317
Epoch: 19, Steps: 20 | Train Loss: 0.205 Vali Loss: 2.687 Vali Acc: 0.550 Test Loss: 2.687 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.25635838508606
Epoch: 20, Steps: 20 | Train Loss: 0.295 Vali Loss: 2.012 Vali Acc: 0.540 Test Loss: 2.012 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.180627346038818
Epoch: 21, Steps: 20 | Train Loss: 0.148 Vali Loss: 2.833 Vali Acc: 0.530 Test Loss: 2.833 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.5339195728302
Epoch: 22, Steps: 20 | Train Loss: 0.412 Vali Loss: 2.661 Vali Acc: 0.540 Test Loss: 2.661 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.591724872589111
Epoch: 23, Steps: 20 | Train Loss: 0.177 Vali Loss: 2.364 Vali Acc: 0.530 Test Loss: 2.364 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.425397872924805
Epoch: 24, Steps: 20 | Train Loss: 0.197 Vali Loss: 2.495 Vali Acc: 0.560 Test Loss: 2.495 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.22074294090271
Epoch: 25, Steps: 20 | Train Loss: 0.143 Vali Loss: 3.395 Vali Acc: 0.520 Test Loss: 3.395 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.192188262939453
Epoch: 26, Steps: 20 | Train Loss: 0.132 Vali Loss: 2.800 Vali Acc: 0.560 Test Loss: 2.800 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.50531005859375
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 6.2568628787994385
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.958 Vali Acc: 0.470 Test Loss: 0.958 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.925055742263794
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 6.208564281463623
Epoch: 4, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.846 Vali Acc: 0.520 Test Loss: 0.846 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 6.139979839324951
Epoch: 5, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.904 Vali Acc: 0.540 Test Loss: 0.904 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539991).  Saving model ...
Epoch: 6 cost time: 5.71448278427124
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 1.019 Vali Acc: 0.470 Test Loss: 1.019 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.69171404838562
Epoch: 7, Steps: 20 | Train Loss: 0.558 Vali Loss: 1.125 Vali Acc: 0.510 Test Loss: 1.125 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.647286415100098
Epoch: 8, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.956 Vali Acc: 0.480 Test Loss: 0.956 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.210713624954224
Epoch: 9, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.201 Vali Acc: 0.560 Test Loss: 1.201 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 5.873271465301514
Epoch: 10, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.177 Vali Acc: 0.570 Test Loss: 1.177 Test Acc: 0.570
Validation loss decreased (-0.559988 --> -0.569988).  Saving model ...
Epoch: 11 cost time: 6.136131286621094
Epoch: 11, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.422 Vali Acc: 0.540 Test Loss: 1.422 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.012925148010254
Epoch: 12, Steps: 20 | Train Loss: 0.290 Vali Loss: 1.552 Vali Acc: 0.510 Test Loss: 1.552 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.537203550338745
Epoch: 13, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.942 Vali Acc: 0.470 Test Loss: 1.942 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.698444604873657
Epoch: 14, Steps: 20 | Train Loss: 0.268 Vali Loss: 1.836 Vali Acc: 0.550 Test Loss: 1.836 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.822114944458008
Epoch: 15, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.902 Vali Acc: 0.530 Test Loss: 1.902 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.751188516616821
Epoch: 16, Steps: 20 | Train Loss: 0.507 Vali Loss: 2.640 Vali Acc: 0.510 Test Loss: 2.640 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.763182640075684
Epoch: 17, Steps: 20 | Train Loss: 0.278 Vali Loss: 2.106 Vali Acc: 0.530 Test Loss: 2.106 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.35710334777832
Epoch: 18, Steps: 20 | Train Loss: 0.258 Vali Loss: 3.408 Vali Acc: 0.510 Test Loss: 3.408 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.989187479019165
Epoch: 19, Steps: 20 | Train Loss: 0.328 Vali Loss: 2.770 Vali Acc: 0.540 Test Loss: 2.770 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.820035219192505
Epoch: 20, Steps: 20 | Train Loss: 0.208 Vali Loss: 2.418 Vali Acc: 0.620 Test Loss: 2.418 Test Acc: 0.620
Validation loss decreased (-0.569988 --> -0.619976).  Saving model ...
Epoch: 21 cost time: 6.28475022315979
Epoch: 21, Steps: 20 | Train Loss: 0.154 Vali Loss: 2.658 Vali Acc: 0.520 Test Loss: 2.658 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.228931903839111
Epoch: 22, Steps: 20 | Train Loss: 0.338 Vali Loss: 3.264 Vali Acc: 0.520 Test Loss: 3.264 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.510668754577637
Epoch: 23, Steps: 20 | Train Loss: 0.324 Vali Loss: 2.507 Vali Acc: 0.570 Test Loss: 2.507 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.579643487930298
Epoch: 24, Steps: 20 | Train Loss: 0.222 Vali Loss: 2.878 Vali Acc: 0.500 Test Loss: 2.878 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.7773590087890625
Epoch: 25, Steps: 20 | Train Loss: 0.152 Vali Loss: 3.676 Vali Acc: 0.560 Test Loss: 3.676 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.554426908493042
Epoch: 26, Steps: 20 | Train Loss: 0.131 Vali Loss: 3.104 Vali Acc: 0.510 Test Loss: 3.104 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.3922951221466064
Epoch: 27, Steps: 20 | Train Loss: 0.231 Vali Loss: 3.126 Vali Acc: 0.490 Test Loss: 3.126 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.11795711517334
Epoch: 28, Steps: 20 | Train Loss: 0.177 Vali Loss: 3.205 Vali Acc: 0.600 Test Loss: 3.205 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.6461546421051025
Epoch: 29, Steps: 20 | Train Loss: 0.075 Vali Loss: 3.765 Vali Acc: 0.540 Test Loss: 3.765 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.006526947021484
Epoch: 30, Steps: 20 | Train Loss: 0.205 Vali Loss: 2.969 Vali Acc: 0.600 Test Loss: 2.969 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.068397760391235
Epoch: 1, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.879 Vali Acc: 0.460 Test Loss: 0.879 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 6.597183465957642
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 1.007 Vali Acc: 0.470 Test Loss: 1.007 Test Acc: 0.470
Validation loss decreased (-0.459991 --> -0.469990).  Saving model ...
Epoch: 3 cost time: 6.331226587295532
Epoch: 3, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.924 Vali Acc: 0.480 Test Loss: 0.924 Test Acc: 0.480
Validation loss decreased (-0.469990 --> -0.479991).  Saving model ...
Epoch: 4 cost time: 6.273371458053589
Epoch: 4, Steps: 20 | Train Loss: 0.588 Vali Loss: 1.105 Vali Acc: 0.480 Test Loss: 1.105 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.391387462615967
Epoch: 5, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.212 Vali Acc: 0.490 Test Loss: 1.212 Test Acc: 0.490
Validation loss decreased (-0.479991 --> -0.489988).  Saving model ...
Epoch: 6 cost time: 6.183025598526001
Epoch: 6, Steps: 20 | Train Loss: 0.570 Vali Loss: 1.083 Vali Acc: 0.490 Test Loss: 1.083 Test Acc: 0.490
Validation loss decreased (-0.489988 --> -0.489989).  Saving model ...
Epoch: 7 cost time: 6.422282695770264
Epoch: 7, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.715 Vali Acc: 0.500 Test Loss: 1.715 Test Acc: 0.500
Validation loss decreased (-0.489989 --> -0.499983).  Saving model ...
Epoch: 8 cost time: 6.357760429382324
Epoch: 8, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.183 Vali Acc: 0.520 Test Loss: 1.183 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519988).  Saving model ...
Epoch: 9 cost time: 6.359350204467773
Epoch: 9, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
Validation loss decreased (-0.519988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 6.263699054718018
Epoch: 10, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.408 Vali Acc: 0.520 Test Loss: 1.408 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.985827445983887
Epoch: 11, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.515 Vali Acc: 0.520 Test Loss: 1.515 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.907618284225464
Epoch: 12, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.725 Vali Acc: 0.490 Test Loss: 1.725 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.302132606506348
Epoch: 13, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.852 Vali Acc: 0.510 Test Loss: 1.852 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.643131494522095
Epoch: 14, Steps: 20 | Train Loss: 0.340 Vali Loss: 2.191 Vali Acc: 0.570 Test Loss: 2.191 Test Acc: 0.570
Validation loss decreased (-0.549988 --> -0.569978).  Saving model ...
Epoch: 15 cost time: 6.23358678817749
Epoch: 15, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.906 Vali Acc: 0.540 Test Loss: 1.906 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.012550592422485
Epoch: 16, Steps: 20 | Train Loss: 0.278 Vali Loss: 2.183 Vali Acc: 0.490 Test Loss: 2.183 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.512984037399292
Epoch: 17, Steps: 20 | Train Loss: 0.264 Vali Loss: 2.469 Vali Acc: 0.550 Test Loss: 2.469 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.6639792919158936
Epoch: 18, Steps: 20 | Train Loss: 0.259 Vali Loss: 3.259 Vali Acc: 0.500 Test Loss: 3.259 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.273003816604614
Epoch: 19, Steps: 20 | Train Loss: 0.293 Vali Loss: 2.151 Vali Acc: 0.530 Test Loss: 2.151 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.309569597244263
Epoch: 20, Steps: 20 | Train Loss: 0.224 Vali Loss: 2.719 Vali Acc: 0.510 Test Loss: 2.719 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.717572212219238
Epoch: 21, Steps: 20 | Train Loss: 0.138 Vali Loss: 2.074 Vali Acc: 0.560 Test Loss: 2.074 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.656929969787598
Epoch: 22, Steps: 20 | Train Loss: 0.237 Vali Loss: 3.325 Vali Acc: 0.490 Test Loss: 3.325 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.733245611190796
Epoch: 23, Steps: 20 | Train Loss: 0.116 Vali Loss: 2.850 Vali Acc: 0.620 Test Loss: 2.850 Test Acc: 0.620
Validation loss decreased (-0.569978 --> -0.619971).  Saving model ...
Epoch: 24 cost time: 6.124558687210083
Epoch: 24, Steps: 20 | Train Loss: 0.380 Vali Loss: 3.432 Vali Acc: 0.570 Test Loss: 3.432 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.1257164478302
Epoch: 25, Steps: 20 | Train Loss: 0.302 Vali Loss: 3.177 Vali Acc: 0.510 Test Loss: 3.177 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.033567190170288
Epoch: 26, Steps: 20 | Train Loss: 0.179 Vali Loss: 4.413 Vali Acc: 0.530 Test Loss: 4.413 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.3722968101501465
Epoch: 27, Steps: 20 | Train Loss: 0.133 Vali Loss: 3.291 Vali Acc: 0.540 Test Loss: 3.291 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.2103142738342285
Epoch: 28, Steps: 20 | Train Loss: 0.141 Vali Loss: 3.899 Vali Acc: 0.540 Test Loss: 3.899 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.721489429473877
Epoch: 29, Steps: 20 | Train Loss: 0.342 Vali Loss: 5.573 Vali Acc: 0.440 Test Loss: 5.573 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.064409494400024
Epoch: 30, Steps: 20 | Train Loss: 0.385 Vali Loss: 2.428 Vali Acc: 0.620 Test Loss: 2.428 Test Acc: 0.620
Validation loss decreased (-0.619971 --> -0.619976).  Saving model ...
Epoch: 31 cost time: 5.990500450134277
Epoch: 31, Steps: 20 | Train Loss: 0.107 Vali Loss: 3.852 Vali Acc: 0.520 Test Loss: 3.852 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.421651363372803
Epoch: 32, Steps: 20 | Train Loss: 0.188 Vali Loss: 3.659 Vali Acc: 0.550 Test Loss: 3.659 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.4624292850494385
Epoch: 33, Steps: 20 | Train Loss: 0.198 Vali Loss: 3.980 Vali Acc: 0.590 Test Loss: 3.980 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.423442125320435
Epoch: 34, Steps: 20 | Train Loss: 0.176 Vali Loss: 3.022 Vali Acc: 0.580 Test Loss: 3.022 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.485370635986328
Epoch: 35, Steps: 20 | Train Loss: 0.226 Vali Loss: 3.176 Vali Acc: 0.530 Test Loss: 3.176 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.111692667007446
Epoch: 36, Steps: 20 | Train Loss: 0.246 Vali Loss: 4.731 Vali Acc: 0.510 Test Loss: 4.731 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 5.287109851837158
Epoch: 37, Steps: 20 | Train Loss: 0.210 Vali Loss: 4.637 Vali Acc: 0.550 Test Loss: 4.637 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 5.29360032081604
Epoch: 38, Steps: 20 | Train Loss: 0.302 Vali Loss: 6.083 Vali Acc: 0.490 Test Loss: 6.083 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 5.89184045791626
Epoch: 39, Steps: 20 | Train Loss: 0.212 Vali Loss: 3.211 Vali Acc: 0.620 Test Loss: 3.211 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.492404937744141
Epoch: 40, Steps: 20 | Train Loss: 0.275 Vali Loss: 3.561 Vali Acc: 0.600 Test Loss: 3.561 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.32903504371643
Epoch: 1, Steps: 20 | Train Loss: 0.760 Vali Loss: 0.814 Vali Acc: 0.430 Test Loss: 0.814 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 6.338029861450195
Epoch: 2, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
Validation loss decreased (-0.429992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 6.065258502960205
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 5.893213272094727
Epoch: 4, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.976 Vali Acc: 0.530 Test Loss: 0.976 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.92698335647583
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.324012041091919
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.925 Vali Acc: 0.530 Test Loss: 0.925 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.806716203689575
Epoch: 7, Steps: 20 | Train Loss: 0.627 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.798086881637573
Epoch: 8, Steps: 20 | Train Loss: 0.719 Vali Loss: 1.439 Vali Acc: 0.540 Test Loss: 1.439 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.660391569137573
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 1.391 Vali Acc: 0.560 Test Loss: 1.391 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559986).  Saving model ...
Epoch: 10 cost time: 5.379737377166748
Epoch: 10, Steps: 20 | Train Loss: 0.599 Vali Loss: 1.448 Vali Acc: 0.600 Test Loss: 1.448 Test Acc: 0.600
Validation loss decreased (-0.559986 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 5.753114700317383
Epoch: 11, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.591 Vali Acc: 0.560 Test Loss: 1.591 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.698568344116211
Epoch: 12, Steps: 20 | Train Loss: 0.511 Vali Loss: 1.252 Vali Acc: 0.580 Test Loss: 1.252 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.25627589225769
Epoch: 13, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.990 Vali Acc: 0.470 Test Loss: 1.990 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.240802764892578
Epoch: 14, Steps: 20 | Train Loss: 0.554 Vali Loss: 2.258 Vali Acc: 0.510 Test Loss: 2.258 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.306785821914673
Epoch: 15, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.173 Vali Acc: 0.650 Test Loss: 1.173 Test Acc: 0.650
Validation loss decreased (-0.599986 --> -0.649988).  Saving model ...
Epoch: 16 cost time: 6.045182466506958
Epoch: 16, Steps: 20 | Train Loss: 0.358 Vali Loss: 2.102 Vali Acc: 0.630 Test Loss: 2.102 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.278571605682373
Epoch: 17, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.901 Vali Acc: 0.540 Test Loss: 1.901 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.869510173797607
Epoch: 18, Steps: 20 | Train Loss: 0.345 Vali Loss: 2.747 Vali Acc: 0.540 Test Loss: 2.747 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.967439889907837
Epoch: 19, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.914 Vali Acc: 0.570 Test Loss: 1.914 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.622890472412109
Epoch: 20, Steps: 20 | Train Loss: 0.270 Vali Loss: 2.455 Vali Acc: 0.510 Test Loss: 2.455 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.895506381988525
Epoch: 21, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.323 Vali Acc: 0.720 Test Loss: 1.323 Test Acc: 0.720
Validation loss decreased (-0.649988 --> -0.719987).  Saving model ...
Epoch: 22 cost time: 6.03556752204895
Epoch: 22, Steps: 20 | Train Loss: 0.372 Vali Loss: 2.698 Vali Acc: 0.570 Test Loss: 2.698 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.065676212310791
Epoch: 23, Steps: 20 | Train Loss: 0.276 Vali Loss: 3.366 Vali Acc: 0.530 Test Loss: 3.366 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.287207365036011
Epoch: 24, Steps: 20 | Train Loss: 0.342 Vali Loss: 2.857 Vali Acc: 0.550 Test Loss: 2.857 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.4785401821136475
Epoch: 25, Steps: 20 | Train Loss: 0.218 Vali Loss: 2.953 Vali Acc: 0.540 Test Loss: 2.953 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.906994581222534
Epoch: 26, Steps: 20 | Train Loss: 0.298 Vali Loss: 3.646 Vali Acc: 0.500 Test Loss: 3.646 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.123887300491333
Epoch: 27, Steps: 20 | Train Loss: 0.265 Vali Loss: 3.370 Vali Acc: 0.530 Test Loss: 3.370 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.928619146347046
Epoch: 28, Steps: 20 | Train Loss: 0.364 Vali Loss: 3.333 Vali Acc: 0.580 Test Loss: 3.333 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.962048053741455
Epoch: 29, Steps: 20 | Train Loss: 0.391 Vali Loss: 4.329 Vali Acc: 0.550 Test Loss: 4.329 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.01348614692688
Epoch: 30, Steps: 20 | Train Loss: 0.360 Vali Loss: 4.000 Vali Acc: 0.550 Test Loss: 4.000 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.049107313156128
Epoch: 31, Steps: 20 | Train Loss: 0.320 Vali Loss: 2.854 Vali Acc: 0.640 Test Loss: 2.854 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.72
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.419070720672607
Epoch: 1, Steps: 20 | Train Loss: 0.750 Vali Loss: 0.808 Vali Acc: 0.480 Test Loss: 0.808 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 5.394570350646973
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
Validation loss decreased (-0.479992 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 6.034733772277832
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 6.197210073471069
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.989 Vali Acc: 0.530 Test Loss: 0.989 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.5125346183776855
Epoch: 5, Steps: 20 | Train Loss: 0.645 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.966200590133667
Epoch: 6, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.977 Vali Acc: 0.540 Test Loss: 0.977 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.643101215362549
Epoch: 7, Steps: 20 | Train Loss: 0.617 Vali Loss: 1.298 Vali Acc: 0.560 Test Loss: 1.298 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559987).  Saving model ...
Epoch: 8 cost time: 6.50593638420105
Epoch: 8, Steps: 20 | Train Loss: 0.646 Vali Loss: 1.528 Vali Acc: 0.530 Test Loss: 1.528 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.1724817752838135
Epoch: 9, Steps: 20 | Train Loss: 0.610 Vali Loss: 1.413 Vali Acc: 0.600 Test Loss: 1.413 Test Acc: 0.600
Validation loss decreased (-0.559987 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 6.029024362564087
Epoch: 10, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.434 Vali Acc: 0.600 Test Loss: 1.434 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.023619174957275
Epoch: 11, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.899 Vali Acc: 0.580 Test Loss: 1.899 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.414824962615967
Epoch: 12, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.413 Vali Acc: 0.600 Test Loss: 1.413 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.754597187042236
Epoch: 13, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.942 Vali Acc: 0.490 Test Loss: 1.942 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.453850269317627
Epoch: 14, Steps: 20 | Train Loss: 0.430 Vali Loss: 2.478 Vali Acc: 0.570 Test Loss: 2.478 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.265633821487427
Epoch: 15, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.275 Vali Acc: 0.660 Test Loss: 1.275 Test Acc: 0.660
Validation loss decreased (-0.599986 --> -0.659987).  Saving model ...
Epoch: 16 cost time: 6.391610622406006
Epoch: 16, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.821 Vali Acc: 0.560 Test Loss: 1.821 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.158592462539673
Epoch: 17, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.814 Vali Acc: 0.640 Test Loss: 1.814 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.014444589614868
Epoch: 18, Steps: 20 | Train Loss: 0.248 Vali Loss: 3.657 Vali Acc: 0.500 Test Loss: 3.657 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.356405258178711
Epoch: 19, Steps: 20 | Train Loss: 0.334 Vali Loss: 2.951 Vali Acc: 0.510 Test Loss: 2.951 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.241979360580444
Epoch: 20, Steps: 20 | Train Loss: 0.292 Vali Loss: 2.753 Vali Acc: 0.520 Test Loss: 2.753 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.008078098297119
Epoch: 21, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.993 Vali Acc: 0.620 Test Loss: 1.993 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.64966082572937
Epoch: 22, Steps: 20 | Train Loss: 0.277 Vali Loss: 2.514 Vali Acc: 0.530 Test Loss: 2.514 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.82426905632019
Epoch: 23, Steps: 20 | Train Loss: 0.254 Vali Loss: 3.395 Vali Acc: 0.610 Test Loss: 3.395 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.844028472900391
Epoch: 24, Steps: 20 | Train Loss: 0.282 Vali Loss: 3.043 Vali Acc: 0.520 Test Loss: 3.043 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.769809722900391
Epoch: 25, Steps: 20 | Train Loss: 0.222 Vali Loss: 2.742 Vali Acc: 0.570 Test Loss: 2.742 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.350127935409546
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.562744855880737
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 6.677071571350098
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.41299843788147
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.145206689834595
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.9758851528167725
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.224384546279907
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.846514463424683
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.490851402282715
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.695109844207764
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.466172456741333
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.525249242782593
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 10670594
model size : 60.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.353114366531372
Epoch: 1, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 5.617298603057861
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.839 Vali Acc: 0.490 Test Loss: 0.839 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.929171085357666
Epoch: 3, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.937 Vali Acc: 0.510 Test Loss: 0.937 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.8333234786987305
Epoch: 4, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.816492319107056
Epoch: 5, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.180007457733154
Epoch: 6, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.050 Vali Acc: 0.510 Test Loss: 1.050 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.09727931022644
Epoch: 7, Steps: 20 | Train Loss: 0.464 Vali Loss: 1.095 Vali Acc: 0.480 Test Loss: 1.095 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.86645245552063
Epoch: 8, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.123 Vali Acc: 0.530 Test Loss: 1.123 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529989).  Saving model ...
Epoch: 9 cost time: 6.2908935546875
Epoch: 9, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.39499568939209
Epoch: 10, Steps: 20 | Train Loss: 0.366 Vali Loss: 1.109 Vali Acc: 0.560 Test Loss: 1.109 Test Acc: 0.560
Validation loss decreased (-0.529989 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 6.5154125690460205
Epoch: 11, Steps: 20 | Train Loss: 0.361 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.254854679107666
Epoch: 12, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.335435628890991
Epoch: 13, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.406 Vali Acc: 0.540 Test Loss: 1.406 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.24835205078125
Epoch: 14, Steps: 20 | Train Loss: 0.227 Vali Loss: 2.019 Vali Acc: 0.560 Test Loss: 2.019 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.111709356307983
Epoch: 15, Steps: 20 | Train Loss: 0.378 Vali Loss: 2.070 Vali Acc: 0.530 Test Loss: 2.070 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.798795938491821
Epoch: 16, Steps: 20 | Train Loss: 0.232 Vali Loss: 2.121 Vali Acc: 0.520 Test Loss: 2.121 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.36821985244751
Epoch: 17, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.724 Vali Acc: 0.530 Test Loss: 1.724 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.238618850708008
Epoch: 18, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.742 Vali Acc: 0.550 Test Loss: 1.742 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.236299514770508
Epoch: 19, Steps: 20 | Train Loss: 0.117 Vali Loss: 2.117 Vali Acc: 0.580 Test Loss: 2.117 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579979).  Saving model ...
Epoch: 20 cost time: 6.2595624923706055
Epoch: 20, Steps: 20 | Train Loss: 0.157 Vali Loss: 2.409 Vali Acc: 0.490 Test Loss: 2.409 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.202660799026489
Epoch: 21, Steps: 20 | Train Loss: 0.148 Vali Loss: 3.015 Vali Acc: 0.550 Test Loss: 3.015 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.286216735839844
Epoch: 22, Steps: 20 | Train Loss: 0.196 Vali Loss: 2.809 Vali Acc: 0.530 Test Loss: 2.809 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.0680413246154785
Epoch: 23, Steps: 20 | Train Loss: 0.162 Vali Loss: 2.836 Vali Acc: 0.520 Test Loss: 2.836 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.870091438293457
Epoch: 24, Steps: 20 | Train Loss: 0.111 Vali Loss: 2.598 Vali Acc: 0.590 Test Loss: 2.598 Test Acc: 0.590
Validation loss decreased (-0.579979 --> -0.589974).  Saving model ...
Epoch: 25 cost time: 5.823702335357666
Epoch: 25, Steps: 20 | Train Loss: 0.124 Vali Loss: 3.891 Vali Acc: 0.470 Test Loss: 3.891 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.037435293197632
Epoch: 26, Steps: 20 | Train Loss: 0.115 Vali Loss: 3.537 Vali Acc: 0.490 Test Loss: 3.537 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.1348631381988525
Epoch: 27, Steps: 20 | Train Loss: 0.103 Vali Loss: 3.307 Vali Acc: 0.470 Test Loss: 3.307 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.635729074478149
Epoch: 28, Steps: 20 | Train Loss: 0.153 Vali Loss: 3.431 Vali Acc: 0.530 Test Loss: 3.431 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.808413505554199
Epoch: 29, Steps: 20 | Train Loss: 0.112 Vali Loss: 3.694 Vali Acc: 0.510 Test Loss: 3.694 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.503610610961914
Epoch: 30, Steps: 20 | Train Loss: 0.051 Vali Loss: 6.025 Vali Acc: 0.510 Test Loss: 6.025 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.931908130645752
Epoch: 31, Steps: 20 | Train Loss: 0.211 Vali Loss: 4.409 Vali Acc: 0.540 Test Loss: 4.409 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.200597763061523
Epoch: 32, Steps: 20 | Train Loss: 0.174 Vali Loss: 4.512 Vali Acc: 0.500 Test Loss: 4.512 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.358771562576294
Epoch: 33, Steps: 20 | Train Loss: 0.085 Vali Loss: 5.493 Vali Acc: 0.510 Test Loss: 5.493 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.518487453460693
Epoch: 34, Steps: 20 | Train Loss: 0.153 Vali Loss: 4.913 Vali Acc: 0.510 Test Loss: 4.913 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.304422616958618
Epoch: 1, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.847 Vali Acc: 0.500 Test Loss: 0.847 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 6.609974384307861
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 6.049847602844238
Epoch: 3, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.961 Vali Acc: 0.440 Test Loss: 0.961 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.919880151748657
Epoch: 4, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.895 Vali Acc: 0.470 Test Loss: 0.895 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.120463848114014
Epoch: 5, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.881 Vali Acc: 0.470 Test Loss: 0.881 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.179760217666626
Epoch: 6, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.105 Vali Acc: 0.450 Test Loss: 1.105 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.553002119064331
Epoch: 7, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.046 Vali Acc: 0.510 Test Loss: 1.046 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509990).  Saving model ...
Epoch: 8 cost time: 6.211485862731934
Epoch: 8, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.172 Vali Acc: 0.490 Test Loss: 1.172 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.351544618606567
Epoch: 9, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.331 Vali Acc: 0.510 Test Loss: 1.331 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.421279668807983
Epoch: 10, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.281 Vali Acc: 0.560 Test Loss: 1.281 Test Acc: 0.560
Validation loss decreased (-0.509990 --> -0.559987).  Saving model ...
Epoch: 11 cost time: 5.882719278335571
Epoch: 11, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.347 Vali Acc: 0.490 Test Loss: 1.347 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.925693511962891
Epoch: 12, Steps: 20 | Train Loss: 0.293 Vali Loss: 1.673 Vali Acc: 0.490 Test Loss: 1.673 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.066745042800903
Epoch: 13, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.394 Vali Acc: 0.520 Test Loss: 1.394 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.1141204833984375
Epoch: 14, Steps: 20 | Train Loss: 0.279 Vali Loss: 2.011 Vali Acc: 0.510 Test Loss: 2.011 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.277875900268555
Epoch: 15, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.996 Vali Acc: 0.530 Test Loss: 1.996 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.185799598693848
Epoch: 16, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.743 Vali Acc: 0.510 Test Loss: 1.743 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.414400339126587
Epoch: 17, Steps: 20 | Train Loss: 0.166 Vali Loss: 2.252 Vali Acc: 0.480 Test Loss: 2.252 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.519464731216431
Epoch: 18, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.718 Vali Acc: 0.510 Test Loss: 1.718 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.673401832580566
Epoch: 19, Steps: 20 | Train Loss: 0.200 Vali Loss: 2.585 Vali Acc: 0.620 Test Loss: 2.585 Test Acc: 0.620
Validation loss decreased (-0.559987 --> -0.619974).  Saving model ...
Epoch: 20 cost time: 6.246021509170532
Epoch: 20, Steps: 20 | Train Loss: 0.149 Vali Loss: 2.343 Vali Acc: 0.530 Test Loss: 2.343 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.476879835128784
Epoch: 21, Steps: 20 | Train Loss: 0.217 Vali Loss: 2.453 Vali Acc: 0.510 Test Loss: 2.453 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.9569268226623535
Epoch: 22, Steps: 20 | Train Loss: 0.084 Vali Loss: 2.208 Vali Acc: 0.560 Test Loss: 2.208 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.40739369392395
Epoch: 23, Steps: 20 | Train Loss: 0.131 Vali Loss: 3.016 Vali Acc: 0.530 Test Loss: 3.016 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.0367748737335205
Epoch: 24, Steps: 20 | Train Loss: 0.143 Vali Loss: 3.233 Vali Acc: 0.490 Test Loss: 3.233 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.754246234893799
Epoch: 25, Steps: 20 | Train Loss: 0.152 Vali Loss: 2.989 Vali Acc: 0.520 Test Loss: 2.989 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.609994649887085
Epoch: 26, Steps: 20 | Train Loss: 0.094 Vali Loss: 3.144 Vali Acc: 0.490 Test Loss: 3.144 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.354973077774048
Epoch: 27, Steps: 20 | Train Loss: 0.061 Vali Loss: 3.150 Vali Acc: 0.540 Test Loss: 3.150 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.2839601039886475
Epoch: 28, Steps: 20 | Train Loss: 0.122 Vali Loss: 4.170 Vali Acc: 0.540 Test Loss: 4.170 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.033002853393555
Epoch: 29, Steps: 20 | Train Loss: 0.185 Vali Loss: 3.724 Vali Acc: 0.540 Test Loss: 3.724 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.41347074508667
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 6.0284950733184814
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.814 Vali Acc: 0.590 Test Loss: 0.814 Test Acc: 0.590
Validation loss decreased (-0.489992 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 6.008927822113037
Epoch: 3, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.876 Vali Acc: 0.490 Test Loss: 0.876 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.193418264389038
Epoch: 4, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.911 Vali Acc: 0.450 Test Loss: 0.911 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.278656482696533
Epoch: 5, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.065920829772949
Epoch: 6, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.135 Vali Acc: 0.480 Test Loss: 1.135 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.323568105697632
Epoch: 7, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.479918956756592
Epoch: 8, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.146 Vali Acc: 0.580 Test Loss: 1.146 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.4379096031188965
Epoch: 9, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.222 Vali Acc: 0.490 Test Loss: 1.222 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.6556408405303955
Epoch: 10, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.887 Vali Acc: 0.510 Test Loss: 1.887 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.58030104637146
Epoch: 11, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.036 Vali Acc: 0.540 Test Loss: 1.036 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.243166446685791
Epoch: 12, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.725 Vali Acc: 0.510 Test Loss: 1.725 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.07745885848999
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.829 Vali Acc: 0.450 Test Loss: 0.829 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 5.843419075012207
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
Validation loss decreased (-0.449992 --> -0.499991).  Saving model ...
Epoch: 3 cost time: 5.995506763458252
Epoch: 3, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.843 Vali Acc: 0.440 Test Loss: 0.843 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.058370113372803
Epoch: 4, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.911 Vali Acc: 0.470 Test Loss: 0.911 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.910072565078735
Epoch: 5, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.811 Vali Acc: 0.480 Test Loss: 0.811 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.801296710968018
Epoch: 6, Steps: 20 | Train Loss: 0.510 Vali Loss: 1.054 Vali Acc: 0.490 Test Loss: 1.054 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.9342124462127686
Epoch: 7, Steps: 20 | Train Loss: 0.449 Vali Loss: 1.059 Vali Acc: 0.480 Test Loss: 1.059 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.21832275390625
Epoch: 8, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.236046314239502
Epoch: 9, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
Validation loss decreased (-0.499991 --> -0.519989).  Saving model ...
Epoch: 10 cost time: 6.203023672103882
Epoch: 10, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.164 Vali Acc: 0.610 Test Loss: 1.164 Test Acc: 0.610
Validation loss decreased (-0.519989 --> -0.609988).  Saving model ...
Epoch: 11 cost time: 6.423417568206787
Epoch: 11, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.254 Vali Acc: 0.540 Test Loss: 1.254 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.3344480991363525
Epoch: 12, Steps: 20 | Train Loss: 0.294 Vali Loss: 1.356 Vali Acc: 0.570 Test Loss: 1.356 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.5320143699646
Epoch: 13, Steps: 20 | Train Loss: 0.273 Vali Loss: 1.636 Vali Acc: 0.520 Test Loss: 1.636 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.446798801422119
Epoch: 14, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.456 Vali Acc: 0.580 Test Loss: 1.456 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.755599737167358
Epoch: 15, Steps: 20 | Train Loss: 0.256 Vali Loss: 2.053 Vali Acc: 0.470 Test Loss: 2.053 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.823192596435547
Epoch: 16, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.659 Vali Acc: 0.580 Test Loss: 1.659 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.724679470062256
Epoch: 17, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.964 Vali Acc: 0.520 Test Loss: 1.964 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.0862414836883545
Epoch: 18, Steps: 20 | Train Loss: 0.160 Vali Loss: 2.407 Vali Acc: 0.530 Test Loss: 2.407 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.010456562042236
Epoch: 19, Steps: 20 | Train Loss: 0.181 Vali Loss: 2.135 Vali Acc: 0.580 Test Loss: 2.135 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.875781297683716
Epoch: 20, Steps: 20 | Train Loss: 0.157 Vali Loss: 2.851 Vali Acc: 0.580 Test Loss: 2.851 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.997967481613159
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.821 Vali Acc: 0.450 Test Loss: 0.821 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 5.916756868362427
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.946 Vali Acc: 0.460 Test Loss: 0.946 Test Acc: 0.460
Validation loss decreased (-0.449992 --> -0.459991).  Saving model ...
Epoch: 3 cost time: 6.30795431137085
Epoch: 3, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.952 Vali Acc: 0.420 Test Loss: 0.952 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1665637493133545
Epoch: 4, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.981 Vali Acc: 0.460 Test Loss: 0.981 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.209166765213013
Epoch: 5, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.928 Vali Acc: 0.560 Test Loss: 0.928 Test Acc: 0.560
Validation loss decreased (-0.459991 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 6.396543741226196
Epoch: 6, Steps: 20 | Train Loss: 0.536 Vali Loss: 1.223 Vali Acc: 0.480 Test Loss: 1.223 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.5620973110198975
Epoch: 7, Steps: 20 | Train Loss: 0.538 Vali Loss: 1.158 Vali Acc: 0.510 Test Loss: 1.158 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.435473680496216
Epoch: 8, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.0813987255096436
Epoch: 9, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.226 Vali Acc: 0.530 Test Loss: 1.226 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.703866004943848
Epoch: 10, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.697 Vali Acc: 0.500 Test Loss: 1.697 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.697973728179932
Epoch: 11, Steps: 20 | Train Loss: 0.487 Vali Loss: 1.437 Vali Acc: 0.500 Test Loss: 1.437 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.991279602050781
Epoch: 12, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.977 Vali Acc: 0.540 Test Loss: 1.977 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.3445258140563965
Epoch: 13, Steps: 20 | Train Loss: 0.385 Vali Loss: 1.666 Vali Acc: 0.480 Test Loss: 1.666 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.075204372406006
Epoch: 14, Steps: 20 | Train Loss: 0.264 Vali Loss: 2.423 Vali Acc: 0.550 Test Loss: 2.423 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.926134347915649
Epoch: 15, Steps: 20 | Train Loss: 0.309 Vali Loss: 2.153 Vali Acc: 0.500 Test Loss: 2.153 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.945245981216431
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.712 Vali Acc: 0.530 Test Loss: 0.712 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 6.064338207244873
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.765 Vali Acc: 0.540 Test Loss: 0.765 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 6.317649602890015
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.851 Vali Acc: 0.570 Test Loss: 0.851 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 4 cost time: 6.540550947189331
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.359139442443848
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.863 Vali Acc: 0.580 Test Loss: 0.863 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 6.6812193393707275
Epoch: 6, Steps: 20 | Train Loss: 0.628 Vali Loss: 1.139 Vali Acc: 0.510 Test Loss: 1.139 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.584591865539551
Epoch: 7, Steps: 20 | Train Loss: 0.624 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.111918926239014
Epoch: 8, Steps: 20 | Train Loss: 0.567 Vali Loss: 1.156 Vali Acc: 0.570 Test Loss: 1.156 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.255290746688843
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.423 Vali Acc: 0.510 Test Loss: 1.423 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.385876893997192
Epoch: 10, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.347 Vali Acc: 0.530 Test Loss: 1.347 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.9909093379974365
Epoch: 11, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.472 Vali Acc: 0.590 Test Loss: 1.472 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589985).  Saving model ...
Epoch: 12 cost time: 6.2977073192596436
Epoch: 12, Steps: 20 | Train Loss: 0.508 Vali Loss: 1.503 Vali Acc: 0.620 Test Loss: 1.503 Test Acc: 0.620
Validation loss decreased (-0.589985 --> -0.619985).  Saving model ...
Epoch: 13 cost time: 6.212928771972656
Epoch: 13, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.443 Vali Acc: 0.570 Test Loss: 1.443 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.374410390853882
Epoch: 14, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.858 Vali Acc: 0.530 Test Loss: 1.858 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.459806203842163
Epoch: 15, Steps: 20 | Train Loss: 0.395 Vali Loss: 2.082 Vali Acc: 0.500 Test Loss: 2.082 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.875567674636841
Epoch: 16, Steps: 20 | Train Loss: 0.463 Vali Loss: 2.366 Vali Acc: 0.560 Test Loss: 2.366 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.356870412826538
Epoch: 17, Steps: 20 | Train Loss: 0.591 Vali Loss: 2.138 Vali Acc: 0.560 Test Loss: 2.138 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.334837436676025
Epoch: 18, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.962 Vali Acc: 0.480 Test Loss: 1.962 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.426445484161377
Epoch: 19, Steps: 20 | Train Loss: 0.289 Vali Loss: 2.868 Vali Acc: 0.550 Test Loss: 2.868 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.393733978271484
Epoch: 20, Steps: 20 | Train Loss: 0.242 Vali Loss: 2.940 Vali Acc: 0.520 Test Loss: 2.940 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.240063190460205
Epoch: 21, Steps: 20 | Train Loss: 0.248 Vali Loss: 3.112 Vali Acc: 0.530 Test Loss: 3.112 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.797968626022339
Epoch: 22, Steps: 20 | Train Loss: 0.213 Vali Loss: 2.529 Vali Acc: 0.520 Test Loss: 2.529 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.81921124458313
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.934080362319946
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 6.504785776138306
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.845 Vali Acc: 0.560 Test Loss: 0.845 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 6.128525495529175
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 1.155 Vali Acc: 0.490 Test Loss: 1.155 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.750668525695801
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.958 Vali Acc: 0.550 Test Loss: 0.958 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.003006458282471
Epoch: 6, Steps: 20 | Train Loss: 0.557 Vali Loss: 1.103 Vali Acc: 0.540 Test Loss: 1.103 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.49539041519165
Epoch: 7, Steps: 20 | Train Loss: 0.585 Vali Loss: 1.229 Vali Acc: 0.520 Test Loss: 1.229 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.519719839096069
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.143 Vali Acc: 0.560 Test Loss: 1.143 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.492927551269531
Epoch: 9, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.383 Vali Acc: 0.510 Test Loss: 1.383 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.409386157989502
Epoch: 10, Steps: 20 | Train Loss: 0.437 Vali Loss: 1.263 Vali Acc: 0.550 Test Loss: 1.263 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.503439903259277
Epoch: 11, Steps: 20 | Train Loss: 0.469 Vali Loss: 1.509 Vali Acc: 0.590 Test Loss: 1.509 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589985).  Saving model ...
Epoch: 12 cost time: 6.8296427726745605
Epoch: 12, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.724 Vali Acc: 0.580 Test Loss: 1.724 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.411287307739258
Epoch: 13, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.559 Vali Acc: 0.550 Test Loss: 1.559 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.157512426376343
Epoch: 14, Steps: 20 | Train Loss: 0.428 Vali Loss: 2.035 Vali Acc: 0.550 Test Loss: 2.035 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.57415246963501
Epoch: 15, Steps: 20 | Train Loss: 0.367 Vali Loss: 2.187 Vali Acc: 0.530 Test Loss: 2.187 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.144531965255737
Epoch: 16, Steps: 20 | Train Loss: 0.467 Vali Loss: 2.116 Vali Acc: 0.580 Test Loss: 2.116 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.90654730796814
Epoch: 17, Steps: 20 | Train Loss: 0.437 Vali Loss: 2.021 Vali Acc: 0.530 Test Loss: 2.021 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.409193515777588
Epoch: 18, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.724 Vali Acc: 0.530 Test Loss: 1.724 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.443844318389893
Epoch: 19, Steps: 20 | Train Loss: 0.245 Vali Loss: 2.658 Vali Acc: 0.520 Test Loss: 2.658 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.223805665969849
Epoch: 20, Steps: 20 | Train Loss: 0.177 Vali Loss: 2.669 Vali Acc: 0.520 Test Loss: 2.669 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.048307418823242
Epoch: 21, Steps: 20 | Train Loss: 0.305 Vali Loss: 3.179 Vali Acc: 0.550 Test Loss: 3.179 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.484097003936768
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.683655738830566
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 6.239200592041016
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.026354551315308
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.1237006187438965
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.347282648086548
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.190653085708618
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.177086353302002
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.59956955909729
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.972521781921387
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.890294551849365
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.23794412612915
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 9097730
model size : 54.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.124025106430054
Epoch: 1, Steps: 20 | Train Loss: 0.763 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 6.234803676605225
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.819 Vali Acc: 0.460 Test Loss: 0.819 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0278801918029785
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 6.100979328155518
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.931 Vali Acc: 0.510 Test Loss: 0.931 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.226173639297485
Epoch: 5, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.047558307647705
Epoch: 6, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.167 Vali Acc: 0.490 Test Loss: 1.167 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.230637073516846
Epoch: 7, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.822 Vali Acc: 0.540 Test Loss: 0.822 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.3926615715026855
Epoch: 8, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.204 Vali Acc: 0.490 Test Loss: 1.204 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.2389235496521
Epoch: 9, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.331 Vali Acc: 0.530 Test Loss: 1.331 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.216479778289795
Epoch: 10, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.469 Vali Acc: 0.510 Test Loss: 1.469 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.182635068893433
Epoch: 11, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.291 Vali Acc: 0.540 Test Loss: 1.291 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.197703123092651
Epoch: 12, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.126 Vali Acc: 0.570 Test Loss: 1.126 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569989).  Saving model ...
Epoch: 13 cost time: 5.8622355461120605
Epoch: 13, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.343 Vali Acc: 0.540 Test Loss: 1.343 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.645519733428955
Epoch: 14, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.571 Vali Acc: 0.550 Test Loss: 1.571 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.913663148880005
Epoch: 15, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.772 Vali Acc: 0.500 Test Loss: 1.772 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.314620494842529
Epoch: 16, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.442 Vali Acc: 0.550 Test Loss: 1.442 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.173821449279785
Epoch: 17, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.663 Vali Acc: 0.500 Test Loss: 1.663 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.7134318351745605
Epoch: 18, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.719 Vali Acc: 0.510 Test Loss: 1.719 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.251379728317261
Epoch: 19, Steps: 20 | Train Loss: 0.213 Vali Loss: 2.505 Vali Acc: 0.530 Test Loss: 2.505 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.329749345779419
Epoch: 20, Steps: 20 | Train Loss: 0.141 Vali Loss: 2.516 Vali Acc: 0.430 Test Loss: 2.516 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.334564208984375
Epoch: 21, Steps: 20 | Train Loss: 0.102 Vali Loss: 2.352 Vali Acc: 0.530 Test Loss: 2.352 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.371801853179932
Epoch: 22, Steps: 20 | Train Loss: 0.152 Vali Loss: 2.325 Vali Acc: 0.580 Test Loss: 2.325 Test Acc: 0.580
Validation loss decreased (-0.569989 --> -0.579977).  Saving model ...
Epoch: 23 cost time: 6.283483266830444
Epoch: 23, Steps: 20 | Train Loss: 0.109 Vali Loss: 2.408 Vali Acc: 0.490 Test Loss: 2.408 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.859650611877441
Epoch: 24, Steps: 20 | Train Loss: 0.078 Vali Loss: 3.124 Vali Acc: 0.480 Test Loss: 3.124 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.065521478652954
Epoch: 25, Steps: 20 | Train Loss: 0.129 Vali Loss: 2.763 Vali Acc: 0.500 Test Loss: 2.763 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.685474634170532
Epoch: 26, Steps: 20 | Train Loss: 0.099 Vali Loss: 2.782 Vali Acc: 0.510 Test Loss: 2.782 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.851707935333252
Epoch: 27, Steps: 20 | Train Loss: 0.124 Vali Loss: 2.859 Vali Acc: 0.530 Test Loss: 2.859 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.241977691650391
Epoch: 28, Steps: 20 | Train Loss: 0.091 Vali Loss: 3.144 Vali Acc: 0.530 Test Loss: 3.144 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.134087800979614
Epoch: 29, Steps: 20 | Train Loss: 0.098 Vali Loss: 4.239 Vali Acc: 0.540 Test Loss: 4.239 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.955843687057495
Epoch: 30, Steps: 20 | Train Loss: 0.153 Vali Loss: 3.747 Vali Acc: 0.500 Test Loss: 3.747 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.168631315231323
Epoch: 31, Steps: 20 | Train Loss: 0.069 Vali Loss: 4.577 Vali Acc: 0.510 Test Loss: 4.577 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.84305477142334
Epoch: 32, Steps: 20 | Train Loss: 0.162 Vali Loss: 3.616 Vali Acc: 0.530 Test Loss: 3.616 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.068659067153931
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 5.750101804733276
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.844 Vali Acc: 0.460 Test Loss: 0.844 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.857210159301758
Epoch: 3, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 6.378199338912964
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.955 Vali Acc: 0.480 Test Loss: 0.955 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.2182910442352295
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.962 Vali Acc: 0.520 Test Loss: 0.962 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.094315528869629
Epoch: 6, Steps: 20 | Train Loss: 0.517 Vali Loss: 1.179 Vali Acc: 0.510 Test Loss: 1.179 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.969601154327393
Epoch: 7, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.829 Vali Acc: 0.580 Test Loss: 0.829 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 5.637861013412476
Epoch: 8, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.167 Vali Acc: 0.490 Test Loss: 1.167 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.462377548217773
Epoch: 9, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.411 Vali Acc: 0.540 Test Loss: 1.411 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.863582611083984
Epoch: 10, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.408 Vali Acc: 0.520 Test Loss: 1.408 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.26868748664856
Epoch: 11, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.363 Vali Acc: 0.510 Test Loss: 1.363 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.209707975387573
Epoch: 12, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.209 Vali Acc: 0.570 Test Loss: 1.209 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.3258302211761475
Epoch: 13, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.781 Vali Acc: 0.540 Test Loss: 1.781 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.037907838821411
Epoch: 14, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.386 Vali Acc: 0.560 Test Loss: 1.386 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.435784339904785
Epoch: 15, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.943 Vali Acc: 0.490 Test Loss: 1.943 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.529111385345459
Epoch: 16, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.902 Vali Acc: 0.480 Test Loss: 1.902 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.10350227355957
Epoch: 17, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.983 Vali Acc: 0.450 Test Loss: 1.983 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.930025815963745
Epoch: 1, Steps: 20 | Train Loss: 0.754 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 5.996509075164795
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.838 Vali Acc: 0.490 Test Loss: 0.838 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.134929180145264
Epoch: 3, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.813 Vali Acc: 0.590 Test Loss: 0.813 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 6.267001152038574
Epoch: 4, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.82954478263855
Epoch: 5, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.018 Vali Acc: 0.490 Test Loss: 1.018 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.863969564437866
Epoch: 6, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.999 Vali Acc: 0.530 Test Loss: 0.999 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.898341178894043
Epoch: 7, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.930 Vali Acc: 0.560 Test Loss: 0.930 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.050201416015625
Epoch: 8, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.003 Vali Acc: 0.540 Test Loss: 1.003 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.164601564407349
Epoch: 9, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.941 Vali Acc: 0.570 Test Loss: 0.941 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.4815332889556885
Epoch: 10, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.194 Vali Acc: 0.560 Test Loss: 1.194 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.34705924987793
Epoch: 11, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.372 Vali Acc: 0.490 Test Loss: 1.372 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.847188711166382
Epoch: 12, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.151 Vali Acc: 0.560 Test Loss: 1.151 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.489763975143433
Epoch: 13, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.301 Vali Acc: 0.560 Test Loss: 1.301 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.290318489074707
Epoch: 1, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.780 Vali Acc: 0.470 Test Loss: 0.780 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 6.236287593841553
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
Validation loss decreased (-0.469992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 6.516935110092163
Epoch: 3, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.832 Vali Acc: 0.560 Test Loss: 0.832 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 6.341305494308472
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.798 Vali Acc: 0.530 Test Loss: 0.798 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.290216684341431
Epoch: 5, Steps: 20 | Train Loss: 0.607 Vali Loss: 1.025 Vali Acc: 0.490 Test Loss: 1.025 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.00363826751709
Epoch: 6, Steps: 20 | Train Loss: 0.525 Vali Loss: 1.034 Vali Acc: 0.530 Test Loss: 1.034 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.195214033126831
Epoch: 7, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.997 Vali Acc: 0.570 Test Loss: 0.997 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569990).  Saving model ...
Epoch: 8 cost time: 6.361576318740845
Epoch: 8, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.076 Vali Acc: 0.460 Test Loss: 1.076 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.948309421539307
Epoch: 9, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.131 Vali Acc: 0.560 Test Loss: 1.131 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.940725803375244
Epoch: 10, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.373 Vali Acc: 0.490 Test Loss: 1.373 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.149867534637451
Epoch: 11, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.567 Vali Acc: 0.540 Test Loss: 1.567 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.110288858413696
Epoch: 12, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.389 Vali Acc: 0.500 Test Loss: 1.389 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.081788539886475
Epoch: 13, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.436 Vali Acc: 0.570 Test Loss: 1.436 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.013503313064575
Epoch: 14, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.743 Vali Acc: 0.480 Test Loss: 1.743 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.971379280090332
Epoch: 15, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.870 Vali Acc: 0.470 Test Loss: 1.870 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.7411208152771
Epoch: 16, Steps: 20 | Train Loss: 0.191 Vali Loss: 2.031 Vali Acc: 0.510 Test Loss: 2.031 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.54055118560791
Epoch: 17, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.773 Vali Acc: 0.550 Test Loss: 1.773 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.929577112197876
Epoch: 1, Steps: 20 | Train Loss: 0.768 Vali Loss: 0.815 Vali Acc: 0.450 Test Loss: 0.815 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 6.0524773597717285
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.940 Vali Acc: 0.480 Test Loss: 0.940 Test Acc: 0.480
Validation loss decreased (-0.449992 --> -0.479991).  Saving model ...
Epoch: 3 cost time: 5.972508430480957
Epoch: 3, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.971 Vali Acc: 0.500 Test Loss: 0.971 Test Acc: 0.500
Validation loss decreased (-0.479991 --> -0.499990).  Saving model ...
Epoch: 4 cost time: 6.04691743850708
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 1.078 Vali Acc: 0.490 Test Loss: 1.078 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.809001445770264
Epoch: 5, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.987 Vali Acc: 0.520 Test Loss: 0.987 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519990).  Saving model ...
Epoch: 6 cost time: 5.983820199966431
Epoch: 6, Steps: 20 | Train Loss: 0.529 Vali Loss: 1.229 Vali Acc: 0.530 Test Loss: 1.229 Test Acc: 0.530
Validation loss decreased (-0.519990 --> -0.529988).  Saving model ...
Epoch: 7 cost time: 6.068603515625
Epoch: 7, Steps: 20 | Train Loss: 0.511 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.189035415649414
Epoch: 8, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.009180545806885
Epoch: 9, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.355 Vali Acc: 0.510 Test Loss: 1.355 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.122037649154663
Epoch: 10, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.455 Vali Acc: 0.510 Test Loss: 1.455 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.045789003372192
Epoch: 11, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.414 Vali Acc: 0.490 Test Loss: 1.414 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.6711506843566895
Epoch: 12, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.623 Vali Acc: 0.540 Test Loss: 1.623 Test Acc: 0.540
Validation loss decreased (-0.529988 --> -0.539984).  Saving model ...
Epoch: 13 cost time: 6.071861267089844
Epoch: 13, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.554 Vali Acc: 0.540 Test Loss: 1.554 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539984).  Saving model ...
Epoch: 14 cost time: 5.398098468780518
Epoch: 14, Steps: 20 | Train Loss: 0.328 Vali Loss: 1.847 Vali Acc: 0.510 Test Loss: 1.847 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.106177568435669
Epoch: 15, Steps: 20 | Train Loss: 0.301 Vali Loss: 2.006 Vali Acc: 0.440 Test Loss: 2.006 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.7762110233306885
Epoch: 16, Steps: 20 | Train Loss: 0.188 Vali Loss: 2.206 Vali Acc: 0.490 Test Loss: 2.206 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.928717374801636
Epoch: 17, Steps: 20 | Train Loss: 0.201 Vali Loss: 2.284 Vali Acc: 0.510 Test Loss: 2.284 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.0191874504089355
Epoch: 18, Steps: 20 | Train Loss: 0.176 Vali Loss: 2.353 Vali Acc: 0.550 Test Loss: 2.353 Test Acc: 0.550
Validation loss decreased (-0.539984 --> -0.549976).  Saving model ...
Epoch: 19 cost time: 5.883265018463135
Epoch: 19, Steps: 20 | Train Loss: 0.237 Vali Loss: 3.192 Vali Acc: 0.550 Test Loss: 3.192 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.06651496887207
Epoch: 20, Steps: 20 | Train Loss: 0.154 Vali Loss: 3.873 Vali Acc: 0.500 Test Loss: 3.873 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.148374557495117
Epoch: 21, Steps: 20 | Train Loss: 0.203 Vali Loss: 2.492 Vali Acc: 0.520 Test Loss: 2.492 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.32421875
Epoch: 22, Steps: 20 | Train Loss: 0.281 Vali Loss: 2.719 Vali Acc: 0.530 Test Loss: 2.719 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.225800275802612
Epoch: 23, Steps: 20 | Train Loss: 0.127 Vali Loss: 2.559 Vali Acc: 0.580 Test Loss: 2.559 Test Acc: 0.580
Validation loss decreased (-0.549976 --> -0.579974).  Saving model ...
Epoch: 24 cost time: 6.225321531295776
Epoch: 24, Steps: 20 | Train Loss: 0.155 Vali Loss: 2.213 Vali Acc: 0.590 Test Loss: 2.213 Test Acc: 0.590
Validation loss decreased (-0.579974 --> -0.589978).  Saving model ...
Epoch: 25 cost time: 6.2558770179748535
Epoch: 25, Steps: 20 | Train Loss: 0.147 Vali Loss: 3.543 Vali Acc: 0.560 Test Loss: 3.543 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.028076648712158
Epoch: 26, Steps: 20 | Train Loss: 0.226 Vali Loss: 4.870 Vali Acc: 0.480 Test Loss: 4.870 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.119840621948242
Epoch: 27, Steps: 20 | Train Loss: 0.384 Vali Loss: 4.810 Vali Acc: 0.460 Test Loss: 4.810 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.861438035964966
Epoch: 28, Steps: 20 | Train Loss: 0.155 Vali Loss: 4.216 Vali Acc: 0.500 Test Loss: 4.216 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.797487258911133
Epoch: 29, Steps: 20 | Train Loss: 0.273 Vali Loss: 3.477 Vali Acc: 0.580 Test Loss: 3.477 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.261664867401123
Epoch: 30, Steps: 20 | Train Loss: 0.123 Vali Loss: 3.380 Vali Acc: 0.540 Test Loss: 3.380 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.207935810089111
Epoch: 31, Steps: 20 | Train Loss: 0.127 Vali Loss: 4.579 Vali Acc: 0.520 Test Loss: 4.579 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.48420524597168
Epoch: 32, Steps: 20 | Train Loss: 0.168 Vali Loss: 4.389 Vali Acc: 0.480 Test Loss: 4.389 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.326584815979004
Epoch: 33, Steps: 20 | Train Loss: 0.238 Vali Loss: 5.711 Vali Acc: 0.500 Test Loss: 5.711 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.63796591758728
Epoch: 34, Steps: 20 | Train Loss: 0.160 Vali Loss: 3.065 Vali Acc: 0.570 Test Loss: 3.065 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.69752836227417
Epoch: 1, Steps: 20 | Train Loss: 0.769 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 6.108396530151367
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.947 Vali Acc: 0.470 Test Loss: 0.947 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.989490509033203
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.831 Vali Acc: 0.480 Test Loss: 0.831 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.700422048568726
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 5.959244251251221
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.039 Vali Acc: 0.590 Test Loss: 1.039 Test Acc: 0.590
Validation loss decreased (-0.499989 --> -0.589990).  Saving model ...
Epoch: 6 cost time: 5.87856388092041
Epoch: 6, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.941 Vali Acc: 0.540 Test Loss: 0.941 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.424962282180786
Epoch: 7, Steps: 20 | Train Loss: 0.593 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
Validation loss decreased (-0.589990 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 5.712762117385864
Epoch: 8, Steps: 20 | Train Loss: 0.563 Vali Loss: 1.287 Vali Acc: 0.570 Test Loss: 1.287 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.819004774093628
Epoch: 9, Steps: 20 | Train Loss: 0.605 Vali Loss: 1.459 Vali Acc: 0.500 Test Loss: 1.459 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.864936351776123
Epoch: 10, Steps: 20 | Train Loss: 0.597 Vali Loss: 1.516 Vali Acc: 0.560 Test Loss: 1.516 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.685608148574829
Epoch: 11, Steps: 20 | Train Loss: 0.522 Vali Loss: 1.762 Vali Acc: 0.510 Test Loss: 1.762 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.98760986328125
Epoch: 12, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.505 Vali Acc: 0.540 Test Loss: 1.505 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.1246421337127686
Epoch: 13, Steps: 20 | Train Loss: 0.513 Vali Loss: 1.582 Vali Acc: 0.560 Test Loss: 1.582 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.288589715957642
Epoch: 14, Steps: 20 | Train Loss: 0.577 Vali Loss: 1.604 Vali Acc: 0.530 Test Loss: 1.604 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.893855333328247
Epoch: 15, Steps: 20 | Train Loss: 0.459 Vali Loss: 2.398 Vali Acc: 0.490 Test Loss: 2.398 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.921517848968506
Epoch: 16, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.935 Vali Acc: 0.570 Test Loss: 1.935 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.081161260604858
Epoch: 17, Steps: 20 | Train Loss: 0.380 Vali Loss: 2.361 Vali Acc: 0.570 Test Loss: 2.361 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.212119102478027
Epoch: 1, Steps: 20 | Train Loss: 0.783 Vali Loss: 0.745 Vali Acc: 0.420 Test Loss: 0.745 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 6.3327038288116455
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.986 Vali Acc: 0.450 Test Loss: 0.986 Test Acc: 0.450
Validation loss decreased (-0.419993 --> -0.449990).  Saving model ...
Epoch: 3 cost time: 6.333758592605591
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
Validation loss decreased (-0.449990 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 5.896101474761963
Epoch: 4, Steps: 20 | Train Loss: 0.637 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.693896770477295
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 1.026 Vali Acc: 0.550 Test Loss: 1.026 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 5.879248380661011
Epoch: 6, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.961 Vali Acc: 0.550 Test Loss: 0.961 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549990).  Saving model ...
Epoch: 7 cost time: 5.980198860168457
Epoch: 7, Steps: 20 | Train Loss: 0.548 Vali Loss: 1.066 Vali Acc: 0.580 Test Loss: 1.066 Test Acc: 0.580
Validation loss decreased (-0.549990 --> -0.579989).  Saving model ...
Epoch: 8 cost time: 6.068265914916992
Epoch: 8, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.215 Vali Acc: 0.600 Test Loss: 1.215 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 6.260272979736328
Epoch: 9, Steps: 20 | Train Loss: 0.571 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.120303153991699
Epoch: 10, Steps: 20 | Train Loss: 0.521 Vali Loss: 1.530 Vali Acc: 0.560 Test Loss: 1.530 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.719862222671509
Epoch: 11, Steps: 20 | Train Loss: 0.455 Vali Loss: 2.162 Vali Acc: 0.480 Test Loss: 2.162 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.027120590209961
Epoch: 12, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.448 Vali Acc: 0.530 Test Loss: 1.448 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.798985958099365
Epoch: 13, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.599 Vali Acc: 0.570 Test Loss: 1.599 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.25863790512085
Epoch: 14, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.637 Vali Acc: 0.560 Test Loss: 1.637 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.143028259277344
Epoch: 15, Steps: 20 | Train Loss: 0.383 Vali Loss: 2.085 Vali Acc: 0.520 Test Loss: 2.085 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.996395826339722
Epoch: 16, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.832 Vali Acc: 0.530 Test Loss: 1.832 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.114781379699707
Epoch: 17, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.973 Vali Acc: 0.540 Test Loss: 1.973 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.170971870422363
Epoch: 18, Steps: 20 | Train Loss: 0.268 Vali Loss: 2.493 Vali Acc: 0.500 Test Loss: 2.493 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.105508089065552
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.60388970375061
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.894062042236328
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 5.7768566608428955
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.77317214012146
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.570352554321289
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.446862697601318
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.770798921585083
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 9 cost time: 5.328017473220825
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.84266209602356
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.913389444351196
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.487281084060669
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.74054217338562
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.513476848602295
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.430626630783081
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.132062673568726
Epoch: 16, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.762164354324341
Epoch: 17, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.463884592056274
Epoch: 18, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 8311298
model size : 51.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.478888511657715
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.822 Vali Acc: 0.540 Test Loss: 0.822 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 5.911539316177368
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.039155721664429
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.80931830406189
Epoch: 4, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.860 Vali Acc: 0.500 Test Loss: 0.860 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.970911026000977
Epoch: 5, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.867 Vali Acc: 0.480 Test Loss: 0.867 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.938236951828003
Epoch: 6, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.791510343551636
Epoch: 7, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.007 Vali Acc: 0.510 Test Loss: 1.007 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.922511100769043
Epoch: 8, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.083 Vali Acc: 0.550 Test Loss: 1.083 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 6.029749631881714
Epoch: 9, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.086 Vali Acc: 0.550 Test Loss: 1.086 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.852403402328491
Epoch: 10, Steps: 20 | Train Loss: 0.442 Vali Loss: 1.272 Vali Acc: 0.540 Test Loss: 1.272 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.86198091506958
Epoch: 11, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.304 Vali Acc: 0.510 Test Loss: 1.304 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.605315208435059
Epoch: 12, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.594692945480347
Epoch: 13, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.292 Vali Acc: 0.530 Test Loss: 1.292 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.8927507400512695
Epoch: 14, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.550 Vali Acc: 0.550 Test Loss: 1.550 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.985567092895508
Epoch: 15, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.809 Vali Acc: 0.560 Test Loss: 1.809 Test Acc: 0.560
Validation loss decreased (-0.549989 --> -0.559982).  Saving model ...
Epoch: 16 cost time: 5.905674457550049
Epoch: 16, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.628 Vali Acc: 0.550 Test Loss: 1.628 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.735655069351196
Epoch: 17, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.684 Vali Acc: 0.510 Test Loss: 1.684 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.915040493011475
Epoch: 18, Steps: 20 | Train Loss: 0.196 Vali Loss: 2.094 Vali Acc: 0.520 Test Loss: 2.094 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.047815799713135
Epoch: 19, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.897 Vali Acc: 0.560 Test Loss: 1.897 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.920352458953857
Epoch: 20, Steps: 20 | Train Loss: 0.115 Vali Loss: 2.216 Vali Acc: 0.530 Test Loss: 2.216 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.547573566436768
Epoch: 21, Steps: 20 | Train Loss: 0.164 Vali Loss: 2.606 Vali Acc: 0.540 Test Loss: 2.606 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.557551145553589
Epoch: 22, Steps: 20 | Train Loss: 0.101 Vali Loss: 2.983 Vali Acc: 0.510 Test Loss: 2.983 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.831348180770874
Epoch: 23, Steps: 20 | Train Loss: 0.064 Vali Loss: 2.731 Vali Acc: 0.520 Test Loss: 2.731 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.68928861618042
Epoch: 24, Steps: 20 | Train Loss: 0.326 Vali Loss: 4.718 Vali Acc: 0.480 Test Loss: 4.718 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.0814759731292725
Epoch: 25, Steps: 20 | Train Loss: 0.206 Vali Loss: 3.346 Vali Acc: 0.510 Test Loss: 3.346 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.587637424468994
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 5.658729076385498
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.888 Vali Acc: 0.530 Test Loss: 0.888 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 5.8270299434661865
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.934 Vali Acc: 0.470 Test Loss: 0.934 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.968743085861206
Epoch: 4, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.811 Vali Acc: 0.500 Test Loss: 0.811 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.710334539413452
Epoch: 5, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.918 Vali Acc: 0.530 Test Loss: 0.918 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.94432258605957
Epoch: 6, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.971 Vali Acc: 0.480 Test Loss: 0.971 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.8320605754852295
Epoch: 7, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.005 Vali Acc: 0.500 Test Loss: 1.005 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.974220275878906
Epoch: 8, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.027 Vali Acc: 0.510 Test Loss: 1.027 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.042618989944458
Epoch: 9, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.134 Vali Acc: 0.490 Test Loss: 1.134 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.957080125808716
Epoch: 10, Steps: 20 | Train Loss: 0.383 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
Validation loss decreased (-0.529991 --> -0.559987).  Saving model ...
Epoch: 11 cost time: 6.032255172729492
Epoch: 11, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.222 Vali Acc: 0.540 Test Loss: 1.222 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.072748422622681
Epoch: 12, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.397 Vali Acc: 0.560 Test Loss: 1.397 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.267977476119995
Epoch: 13, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.419 Vali Acc: 0.560 Test Loss: 1.419 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.053906440734863
Epoch: 14, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.562 Vali Acc: 0.540 Test Loss: 1.562 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.076263427734375
Epoch: 15, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.778 Vali Acc: 0.530 Test Loss: 1.778 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.520625591278076
Epoch: 16, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.474 Vali Acc: 0.610 Test Loss: 1.474 Test Acc: 0.610
Validation loss decreased (-0.559987 --> -0.609985).  Saving model ...
Epoch: 17 cost time: 5.8827595710754395
Epoch: 17, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.742 Vali Acc: 0.580 Test Loss: 1.742 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.1983418464660645
Epoch: 18, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.869 Vali Acc: 0.520 Test Loss: 1.869 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.187433481216431
Epoch: 19, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.925 Vali Acc: 0.560 Test Loss: 1.925 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.1891632080078125
Epoch: 20, Steps: 20 | Train Loss: 0.208 Vali Loss: 2.453 Vali Acc: 0.550 Test Loss: 2.453 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.058473825454712
Epoch: 21, Steps: 20 | Train Loss: 0.190 Vali Loss: 2.304 Vali Acc: 0.470 Test Loss: 2.304 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.966782331466675
Epoch: 22, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.488 Vali Acc: 0.490 Test Loss: 2.488 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.437020778656006
Epoch: 23, Steps: 20 | Train Loss: 0.092 Vali Loss: 2.597 Vali Acc: 0.540 Test Loss: 2.597 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.742865085601807
Epoch: 24, Steps: 20 | Train Loss: 0.141 Vali Loss: 2.470 Vali Acc: 0.550 Test Loss: 2.470 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.7669878005981445
Epoch: 25, Steps: 20 | Train Loss: 0.080 Vali Loss: 2.863 Vali Acc: 0.490 Test Loss: 2.863 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.145944595336914
Epoch: 26, Steps: 20 | Train Loss: 0.095 Vali Loss: 2.341 Vali Acc: 0.580 Test Loss: 2.341 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.738967418670654
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.811 Vali Acc: 0.460 Test Loss: 0.811 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 6.206463575363159
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.959 Vali Acc: 0.530 Test Loss: 0.959 Test Acc: 0.530
Validation loss decreased (-0.459992 --> -0.529990).  Saving model ...
Epoch: 3 cost time: 6.040929079055786
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.954 Vali Acc: 0.460 Test Loss: 0.954 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.573259353637695
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.781 Vali Acc: 0.490 Test Loss: 0.781 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.512180805206299
Epoch: 5, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.897 Vali Acc: 0.530 Test Loss: 0.897 Test Acc: 0.530
Validation loss decreased (-0.529990 --> -0.529991).  Saving model ...
Epoch: 6 cost time: 6.014753341674805
Epoch: 6, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.885 Vali Acc: 0.540 Test Loss: 0.885 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 5.930704116821289
Epoch: 7, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.902 Vali Acc: 0.570 Test Loss: 0.902 Test Acc: 0.570
Validation loss decreased (-0.539991 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 5.958726406097412
Epoch: 8, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.030 Vali Acc: 0.540 Test Loss: 1.030 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.85806131362915
Epoch: 9, Steps: 20 | Train Loss: 0.444 Vali Loss: 1.010 Vali Acc: 0.580 Test Loss: 1.010 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579990).  Saving model ...
Epoch: 10 cost time: 5.990578889846802
Epoch: 10, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.321 Vali Acc: 0.540 Test Loss: 1.321 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.098416566848755
Epoch: 11, Steps: 20 | Train Loss: 0.370 Vali Loss: 1.303 Vali Acc: 0.560 Test Loss: 1.303 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.02350115776062
Epoch: 12, Steps: 20 | Train Loss: 0.412 Vali Loss: 1.247 Vali Acc: 0.580 Test Loss: 1.247 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.072611570358276
Epoch: 13, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.213 Vali Acc: 0.520 Test Loss: 1.213 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.970828294754028
Epoch: 14, Steps: 20 | Train Loss: 0.254 Vali Loss: 1.392 Vali Acc: 0.520 Test Loss: 1.392 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.83355450630188
Epoch: 15, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.340 Vali Acc: 0.580 Test Loss: 1.340 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.614237546920776
Epoch: 16, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.445 Vali Acc: 0.590 Test Loss: 1.445 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589986).  Saving model ...
Epoch: 17 cost time: 5.819689750671387
Epoch: 17, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.565 Vali Acc: 0.600 Test Loss: 1.565 Test Acc: 0.600
Validation loss decreased (-0.589986 --> -0.599984).  Saving model ...
Epoch: 18 cost time: 6.1017584800720215
Epoch: 18, Steps: 20 | Train Loss: 0.151 Vali Loss: 2.058 Vali Acc: 0.530 Test Loss: 2.058 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.0247063636779785
Epoch: 19, Steps: 20 | Train Loss: 0.207 Vali Loss: 2.256 Vali Acc: 0.520 Test Loss: 2.256 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.790318727493286
Epoch: 20, Steps: 20 | Train Loss: 0.138 Vali Loss: 2.214 Vali Acc: 0.540 Test Loss: 2.214 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.935424566268921
Epoch: 21, Steps: 20 | Train Loss: 0.267 Vali Loss: 2.291 Vali Acc: 0.570 Test Loss: 2.291 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.161890268325806
Epoch: 22, Steps: 20 | Train Loss: 0.135 Vali Loss: 2.080 Vali Acc: 0.570 Test Loss: 2.080 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.2281646728515625
Epoch: 23, Steps: 20 | Train Loss: 0.139 Vali Loss: 2.954 Vali Acc: 0.510 Test Loss: 2.954 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.244602918624878
Epoch: 24, Steps: 20 | Train Loss: 0.144 Vali Loss: 3.480 Vali Acc: 0.520 Test Loss: 3.480 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.665475130081177
Epoch: 25, Steps: 20 | Train Loss: 0.159 Vali Loss: 3.266 Vali Acc: 0.550 Test Loss: 3.266 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.729015588760376
Epoch: 26, Steps: 20 | Train Loss: 0.068 Vali Loss: 3.459 Vali Acc: 0.540 Test Loss: 3.459 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.785627603530884
Epoch: 27, Steps: 20 | Train Loss: 0.127 Vali Loss: 4.456 Vali Acc: 0.450 Test Loss: 4.456 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.511361122131348
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 5.9246251583099365
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 1.004 Vali Acc: 0.510 Test Loss: 1.004 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.464040279388428
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.951 Vali Acc: 0.470 Test Loss: 0.951 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.133625745773315
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.809 Vali Acc: 0.520 Test Loss: 0.809 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.152079820632935
Epoch: 5, Steps: 20 | Train Loss: 0.575 Vali Loss: 1.001 Vali Acc: 0.530 Test Loss: 1.001 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.314633846282959
Epoch: 6, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.863 Vali Acc: 0.470 Test Loss: 0.863 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.095889329910278
Epoch: 7, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.041 Vali Acc: 0.470 Test Loss: 1.041 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.010630130767822
Epoch: 8, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.081712961196899
Epoch: 9, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.072 Vali Acc: 0.530 Test Loss: 1.072 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.971627473831177
Epoch: 10, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.227 Vali Acc: 0.570 Test Loss: 1.227 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569988).  Saving model ...
Epoch: 11 cost time: 6.331012725830078
Epoch: 11, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.396 Vali Acc: 0.530 Test Loss: 1.396 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.874861001968384
Epoch: 12, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.720 Vali Acc: 0.520 Test Loss: 1.720 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.911121129989624
Epoch: 13, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.258 Vali Acc: 0.530 Test Loss: 1.258 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.935337781906128
Epoch: 14, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.769 Vali Acc: 0.520 Test Loss: 1.769 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.011371612548828
Epoch: 15, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.847 Vali Acc: 0.520 Test Loss: 1.847 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.092421531677246
Epoch: 16, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.610 Vali Acc: 0.570 Test Loss: 1.610 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.344572305679321
Epoch: 17, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.629 Vali Acc: 0.580 Test Loss: 1.629 Test Acc: 0.580
Validation loss decreased (-0.569988 --> -0.579984).  Saving model ...
Epoch: 18 cost time: 6.328272342681885
Epoch: 18, Steps: 20 | Train Loss: 0.138 Vali Loss: 2.435 Vali Acc: 0.550 Test Loss: 2.435 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.976209402084351
Epoch: 19, Steps: 20 | Train Loss: 0.173 Vali Loss: 2.055 Vali Acc: 0.520 Test Loss: 2.055 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.634723663330078
Epoch: 20, Steps: 20 | Train Loss: 0.143 Vali Loss: 2.728 Vali Acc: 0.560 Test Loss: 2.728 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.403202056884766
Epoch: 21, Steps: 20 | Train Loss: 0.284 Vali Loss: 2.686 Vali Acc: 0.540 Test Loss: 2.686 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.598954200744629
Epoch: 22, Steps: 20 | Train Loss: 0.144 Vali Loss: 2.163 Vali Acc: 0.530 Test Loss: 2.163 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.874288558959961
Epoch: 23, Steps: 20 | Train Loss: 0.130 Vali Loss: 2.437 Vali Acc: 0.510 Test Loss: 2.437 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.261853456497192
Epoch: 24, Steps: 20 | Train Loss: 0.071 Vali Loss: 3.338 Vali Acc: 0.510 Test Loss: 3.338 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.265260696411133
Epoch: 25, Steps: 20 | Train Loss: 0.151 Vali Loss: 3.748 Vali Acc: 0.450 Test Loss: 3.748 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.483724355697632
Epoch: 26, Steps: 20 | Train Loss: 0.078 Vali Loss: 4.075 Vali Acc: 0.490 Test Loss: 4.075 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.151218414306641
Epoch: 27, Steps: 20 | Train Loss: 0.113 Vali Loss: 3.736 Vali Acc: 0.480 Test Loss: 3.736 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.218410015106201
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 5.7696051597595215
Epoch: 2, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.038 Vali Acc: 0.480 Test Loss: 1.038 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.034677982330322
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 1.065 Vali Acc: 0.480 Test Loss: 1.065 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.118571519851685
Epoch: 4, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.927 Vali Acc: 0.450 Test Loss: 0.927 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.042396068572998
Epoch: 5, Steps: 20 | Train Loss: 0.592 Vali Loss: 1.159 Vali Acc: 0.560 Test Loss: 1.159 Test Acc: 0.560
Validation loss decreased (-0.499992 --> -0.559988).  Saving model ...
Epoch: 6 cost time: 5.7502968311309814
Epoch: 6, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.591656446456909
Epoch: 7, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.169 Vali Acc: 0.590 Test Loss: 1.169 Test Acc: 0.590
Validation loss decreased (-0.559988 --> -0.589988).  Saving model ...
Epoch: 8 cost time: 5.801980495452881
Epoch: 8, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.971 Vali Acc: 0.550 Test Loss: 0.971 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.840393781661987
Epoch: 9, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.679 Vali Acc: 0.560 Test Loss: 1.679 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.56831169128418
Epoch: 10, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.380 Vali Acc: 0.540 Test Loss: 1.380 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.522552967071533
Epoch: 11, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.826 Vali Acc: 0.530 Test Loss: 1.826 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.816740036010742
Epoch: 12, Steps: 20 | Train Loss: 0.477 Vali Loss: 1.389 Vali Acc: 0.520 Test Loss: 1.389 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.84602165222168
Epoch: 13, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.718 Vali Acc: 0.540 Test Loss: 1.718 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.475003957748413
Epoch: 14, Steps: 20 | Train Loss: 0.348 Vali Loss: 2.012 Vali Acc: 0.490 Test Loss: 2.012 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.468098163604736
Epoch: 15, Steps: 20 | Train Loss: 0.369 Vali Loss: 2.225 Vali Acc: 0.550 Test Loss: 2.225 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.638094186782837
Epoch: 16, Steps: 20 | Train Loss: 0.278 Vali Loss: 2.086 Vali Acc: 0.560 Test Loss: 2.086 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.635987997055054
Epoch: 17, Steps: 20 | Train Loss: 0.221 Vali Loss: 2.088 Vali Acc: 0.520 Test Loss: 2.088 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.078473091125488
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.772 Vali Acc: 0.510 Test Loss: 0.772 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.922844171524048
Epoch: 2, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.879 Vali Acc: 0.490 Test Loss: 0.879 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.858942031860352
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 1.016 Vali Acc: 0.470 Test Loss: 1.016 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.6899425983428955
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.887 Vali Acc: 0.570 Test Loss: 0.887 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569991).  Saving model ...
Epoch: 5 cost time: 5.649847507476807
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.902 Vali Acc: 0.550 Test Loss: 0.902 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.3726959228515625
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.944 Vali Acc: 0.580 Test Loss: 0.944 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 7 cost time: 6.310911655426025
Epoch: 7, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.160 Vali Acc: 0.570 Test Loss: 1.160 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.389648675918579
Epoch: 8, Steps: 20 | Train Loss: 0.589 Vali Loss: 1.272 Vali Acc: 0.530 Test Loss: 1.272 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.96150803565979
Epoch: 9, Steps: 20 | Train Loss: 0.590 Vali Loss: 1.136 Vali Acc: 0.540 Test Loss: 1.136 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.839481592178345
Epoch: 10, Steps: 20 | Train Loss: 0.512 Vali Loss: 1.322 Vali Acc: 0.560 Test Loss: 1.322 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.760098695755005
Epoch: 11, Steps: 20 | Train Loss: 0.491 Vali Loss: 1.789 Vali Acc: 0.520 Test Loss: 1.789 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.585643529891968
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 1.245 Vali Acc: 0.570 Test Loss: 1.245 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.877875089645386
Epoch: 13, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.540 Vali Acc: 0.610 Test Loss: 1.540 Test Acc: 0.610
Validation loss decreased (-0.579991 --> -0.609985).  Saving model ...
Epoch: 14 cost time: 6.362217664718628
Epoch: 14, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.763 Vali Acc: 0.520 Test Loss: 1.763 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.217031240463257
Epoch: 15, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.743 Vali Acc: 0.610 Test Loss: 1.743 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.0707385540008545
Epoch: 16, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.370 Vali Acc: 0.560 Test Loss: 1.370 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.126221418380737
Epoch: 17, Steps: 20 | Train Loss: 0.353 Vali Loss: 2.180 Vali Acc: 0.560 Test Loss: 2.180 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.792555570602417
Epoch: 18, Steps: 20 | Train Loss: 0.404 Vali Loss: 2.992 Vali Acc: 0.570 Test Loss: 2.992 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.54037880897522
Epoch: 19, Steps: 20 | Train Loss: 0.316 Vali Loss: 2.583 Vali Acc: 0.560 Test Loss: 2.583 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.832260370254517
Epoch: 20, Steps: 20 | Train Loss: 0.399 Vali Loss: 2.716 Vali Acc: 0.580 Test Loss: 2.716 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.895912408828735
Epoch: 21, Steps: 20 | Train Loss: 0.290 Vali Loss: 3.016 Vali Acc: 0.510 Test Loss: 3.016 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.925249338150024
Epoch: 22, Steps: 20 | Train Loss: 0.198 Vali Loss: 3.391 Vali Acc: 0.470 Test Loss: 3.391 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.823393821716309
Epoch: 23, Steps: 20 | Train Loss: 0.209 Vali Loss: 3.847 Vali Acc: 0.490 Test Loss: 3.847 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.462567090988159
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 5.646288871765137
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.885 Vali Acc: 0.530 Test Loss: 0.885 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.8593761920928955
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 1.007 Vali Acc: 0.480 Test Loss: 1.007 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.112147331237793
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.845 Vali Acc: 0.550 Test Loss: 0.845 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.940805912017822
Epoch: 5, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.929 Vali Acc: 0.570 Test Loss: 0.929 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 6 cost time: 6.3594536781311035
Epoch: 6, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.932 Vali Acc: 0.540 Test Loss: 0.932 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.180206537246704
Epoch: 7, Steps: 20 | Train Loss: 0.569 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.0803306102752686
Epoch: 8, Steps: 20 | Train Loss: 0.560 Vali Loss: 1.186 Vali Acc: 0.550 Test Loss: 1.186 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.781542062759399
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.170 Vali Acc: 0.530 Test Loss: 1.170 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.99674916267395
Epoch: 10, Steps: 20 | Train Loss: 0.458 Vali Loss: 1.397 Vali Acc: 0.560 Test Loss: 1.397 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.053453683853149
Epoch: 11, Steps: 20 | Train Loss: 0.456 Vali Loss: 1.861 Vali Acc: 0.560 Test Loss: 1.861 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.047870874404907
Epoch: 12, Steps: 20 | Train Loss: 0.583 Vali Loss: 1.438 Vali Acc: 0.570 Test Loss: 1.438 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.5640318393707275
Epoch: 13, Steps: 20 | Train Loss: 0.417 Vali Loss: 1.556 Vali Acc: 0.530 Test Loss: 1.556 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.045994520187378
Epoch: 14, Steps: 20 | Train Loss: 0.348 Vali Loss: 2.075 Vali Acc: 0.530 Test Loss: 2.075 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.872572898864746
Epoch: 15, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.958 Vali Acc: 0.580 Test Loss: 1.958 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579980).  Saving model ...
Epoch: 16 cost time: 6.06049919128418
Epoch: 16, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.518 Vali Acc: 0.580 Test Loss: 1.518 Test Acc: 0.580
Validation loss decreased (-0.579980 --> -0.579985).  Saving model ...
Epoch: 17 cost time: 6.056171417236328
Epoch: 17, Steps: 20 | Train Loss: 0.315 Vali Loss: 1.936 Vali Acc: 0.520 Test Loss: 1.936 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.209590196609497
Epoch: 18, Steps: 20 | Train Loss: 0.321 Vali Loss: 3.232 Vali Acc: 0.580 Test Loss: 3.232 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.562842845916748
Epoch: 19, Steps: 20 | Train Loss: 0.322 Vali Loss: 2.227 Vali Acc: 0.530 Test Loss: 2.227 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.011410474777222
Epoch: 20, Steps: 20 | Train Loss: 0.321 Vali Loss: 2.701 Vali Acc: 0.590 Test Loss: 2.701 Test Acc: 0.590
Validation loss decreased (-0.579985 --> -0.589973).  Saving model ...
Epoch: 21 cost time: 5.820811986923218
Epoch: 21, Steps: 20 | Train Loss: 0.212 Vali Loss: 2.586 Vali Acc: 0.510 Test Loss: 2.586 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.839336633682251
Epoch: 22, Steps: 20 | Train Loss: 0.144 Vali Loss: 2.785 Vali Acc: 0.440 Test Loss: 2.785 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.673612833023071
Epoch: 23, Steps: 20 | Train Loss: 0.139 Vali Loss: 3.245 Vali Acc: 0.520 Test Loss: 3.245 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.43263840675354
Epoch: 24, Steps: 20 | Train Loss: 0.420 Vali Loss: 3.593 Vali Acc: 0.620 Test Loss: 3.593 Test Acc: 0.620
Validation loss decreased (-0.589973 --> -0.619964).  Saving model ...
Epoch: 25 cost time: 6.3827126026153564
Epoch: 25, Steps: 20 | Train Loss: 0.296 Vali Loss: 2.977 Vali Acc: 0.550 Test Loss: 2.977 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.988209247589111
Epoch: 26, Steps: 20 | Train Loss: 0.195 Vali Loss: 3.535 Vali Acc: 0.550 Test Loss: 3.535 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.1444244384765625
Epoch: 27, Steps: 20 | Train Loss: 0.260 Vali Loss: 4.123 Vali Acc: 0.530 Test Loss: 4.123 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.585377931594849
Epoch: 28, Steps: 20 | Train Loss: 0.239 Vali Loss: 3.207 Vali Acc: 0.520 Test Loss: 3.207 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.22615647315979
Epoch: 29, Steps: 20 | Train Loss: 0.098 Vali Loss: 3.583 Vali Acc: 0.590 Test Loss: 3.583 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.131108999252319
Epoch: 30, Steps: 20 | Train Loss: 0.129 Vali Loss: 2.957 Vali Acc: 0.570 Test Loss: 2.957 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.168029069900513
Epoch: 31, Steps: 20 | Train Loss: 0.128 Vali Loss: 4.544 Vali Acc: 0.480 Test Loss: 4.544 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.9696595668792725
Epoch: 32, Steps: 20 | Train Loss: 0.125 Vali Loss: 3.910 Vali Acc: 0.530 Test Loss: 3.910 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.015619277954102
Epoch: 33, Steps: 20 | Train Loss: 0.147 Vali Loss: 4.488 Vali Acc: 0.500 Test Loss: 4.488 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.168951749801636
Epoch: 34, Steps: 20 | Train Loss: 0.144 Vali Loss: 4.035 Vali Acc: 0.530 Test Loss: 4.035 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.339147567749023
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.171947479248047
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.957650184631348
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.226818561553955
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.906780004501343
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.778111934661865
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.634800672531128
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.795767068862915
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.9765465259552
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.533690452575684
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.041511535644531
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 7918082
model size : 49.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.623657703399658
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.745 Vali Acc: 0.520 Test Loss: 0.745 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.5935142040252686
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.854 Vali Acc: 0.460 Test Loss: 0.854 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.549941539764404
Epoch: 3, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.867 Vali Acc: 0.500 Test Loss: 0.867 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.4598424434661865
Epoch: 4, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.837 Vali Acc: 0.550 Test Loss: 0.837 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 5.207285642623901
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.878 Vali Acc: 0.450 Test Loss: 0.878 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.780488729476929
Epoch: 6, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.635475397109985
Epoch: 7, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.014 Vali Acc: 0.540 Test Loss: 1.014 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.838757038116455
Epoch: 8, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.927 Vali Acc: 0.540 Test Loss: 0.927 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.936628341674805
Epoch: 9, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.002 Vali Acc: 0.500 Test Loss: 1.002 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.063789129257202
Epoch: 10, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.975 Vali Acc: 0.580 Test Loss: 0.975 Test Acc: 0.580
Validation loss decreased (-0.549992 --> -0.579990).  Saving model ...
Epoch: 11 cost time: 5.019376039505005
Epoch: 11, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.229 Vali Acc: 0.490 Test Loss: 1.229 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.993974208831787
Epoch: 12, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.897324323654175
Epoch: 13, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.275 Vali Acc: 0.520 Test Loss: 1.275 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.836688280105591
Epoch: 14, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.737299203872681
Epoch: 15, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.338 Vali Acc: 0.540 Test Loss: 1.338 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.755405902862549
Epoch: 16, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.680 Vali Acc: 0.520 Test Loss: 1.680 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.429800271987915
Epoch: 17, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.398 Vali Acc: 0.570 Test Loss: 1.398 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.482508182525635
Epoch: 18, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.678 Vali Acc: 0.500 Test Loss: 1.678 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.3041417598724365
Epoch: 19, Steps: 20 | Train Loss: 0.251 Vali Loss: 2.090 Vali Acc: 0.520 Test Loss: 2.090 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.644306898117065
Epoch: 20, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.426 Vali Acc: 0.540 Test Loss: 1.426 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.615917444229126
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 5.0805487632751465
Epoch: 2, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.863 Vali Acc: 0.460 Test Loss: 0.863 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.951604127883911
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.914 Vali Acc: 0.490 Test Loss: 0.914 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.291681289672852
Epoch: 4, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 5.3771679401397705
Epoch: 5, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.4898316860198975
Epoch: 6, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.846 Vali Acc: 0.540 Test Loss: 0.846 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 5.478611469268799
Epoch: 7, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.063 Vali Acc: 0.520 Test Loss: 1.063 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.133026123046875
Epoch: 8, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.947 Vali Acc: 0.530 Test Loss: 0.947 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.039769887924194
Epoch: 9, Steps: 20 | Train Loss: 0.413 Vali Loss: 1.037 Vali Acc: 0.510 Test Loss: 1.037 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.807260274887085
Epoch: 10, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 11 cost time: 5.057828903198242
Epoch: 11, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.337 Vali Acc: 0.510 Test Loss: 1.337 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.142395496368408
Epoch: 12, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.220 Vali Acc: 0.570 Test Loss: 1.220 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569988).  Saving model ...
Epoch: 13 cost time: 5.305702447891235
Epoch: 13, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.478 Vali Acc: 0.550 Test Loss: 1.478 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.227159023284912
Epoch: 14, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.232659816741943
Epoch: 15, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.556 Vali Acc: 0.510 Test Loss: 1.556 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.131830930709839
Epoch: 16, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.607 Vali Acc: 0.450 Test Loss: 1.607 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.9168243408203125
Epoch: 17, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.516 Vali Acc: 0.550 Test Loss: 1.516 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.957644701004028
Epoch: 18, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.492 Vali Acc: 0.560 Test Loss: 1.492 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.076619625091553
Epoch: 19, Steps: 20 | Train Loss: 0.230 Vali Loss: 2.088 Vali Acc: 0.520 Test Loss: 2.088 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.497095346450806
Epoch: 20, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.666 Vali Acc: 0.560 Test Loss: 1.666 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.469547986984253
Epoch: 21, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.855 Vali Acc: 0.540 Test Loss: 1.855 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.322236776351929
Epoch: 22, Steps: 20 | Train Loss: 0.114 Vali Loss: 2.327 Vali Acc: 0.510 Test Loss: 2.327 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.7386155128479
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.029724359512329
Epoch: 2, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.850 Vali Acc: 0.480 Test Loss: 0.850 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.7890379428863525
Epoch: 3, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.899 Vali Acc: 0.470 Test Loss: 0.899 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.3850953578948975
Epoch: 4, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.829 Vali Acc: 0.540 Test Loss: 0.829 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 5.4814817905426025
Epoch: 5, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.414519548416138
Epoch: 6, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.767 Vali Acc: 0.570 Test Loss: 0.767 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 5.162560939788818
Epoch: 7, Steps: 20 | Train Loss: 0.515 Vali Loss: 1.044 Vali Acc: 0.550 Test Loss: 1.044 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.867002248764038
Epoch: 8, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.886 Vali Acc: 0.570 Test Loss: 0.886 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.931443452835083
Epoch: 9, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.986 Vali Acc: 0.510 Test Loss: 0.986 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.854475259780884
Epoch: 10, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.944 Vali Acc: 0.540 Test Loss: 0.944 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.958174467086792
Epoch: 11, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.980 Vali Acc: 0.520 Test Loss: 0.980 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.121697187423706
Epoch: 12, Steps: 20 | Train Loss: 0.313 Vali Loss: 0.991 Vali Acc: 0.550 Test Loss: 0.991 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.288554668426514
Epoch: 13, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.179 Vali Acc: 0.580 Test Loss: 1.179 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579988).  Saving model ...
Epoch: 14 cost time: 5.133740663528442
Epoch: 14, Steps: 20 | Train Loss: 0.283 Vali Loss: 1.107 Vali Acc: 0.580 Test Loss: 1.107 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 15 cost time: 5.3139121532440186
Epoch: 15, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.625 Vali Acc: 0.530 Test Loss: 1.625 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.841800212860107
Epoch: 16, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.1044111251831055
Epoch: 17, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.111 Vali Acc: 0.580 Test Loss: 1.111 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.9938883781433105
Epoch: 18, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.108 Vali Acc: 0.630 Test Loss: 1.108 Test Acc: 0.630
Validation loss decreased (-0.579989 --> -0.629989).  Saving model ...
Epoch: 19 cost time: 5.003298282623291
Epoch: 19, Steps: 20 | Train Loss: 0.258 Vali Loss: 1.895 Vali Acc: 0.530 Test Loss: 1.895 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.2997705936431885
Epoch: 20, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.399 Vali Acc: 0.600 Test Loss: 1.399 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.568184852600098
Epoch: 21, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.534 Vali Acc: 0.540 Test Loss: 1.534 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.6235291957855225
Epoch: 22, Steps: 20 | Train Loss: 0.136 Vali Loss: 2.018 Vali Acc: 0.520 Test Loss: 2.018 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.266242265701294
Epoch: 23, Steps: 20 | Train Loss: 0.116 Vali Loss: 1.433 Vali Acc: 0.590 Test Loss: 1.433 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.226571083068848
Epoch: 24, Steps: 20 | Train Loss: 0.125 Vali Loss: 2.080 Vali Acc: 0.560 Test Loss: 2.080 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.164568901062012
Epoch: 25, Steps: 20 | Train Loss: 0.099 Vali Loss: 1.557 Vali Acc: 0.550 Test Loss: 1.557 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.121370792388916
Epoch: 26, Steps: 20 | Train Loss: 0.068 Vali Loss: 1.982 Vali Acc: 0.540 Test Loss: 1.982 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.15593409538269
Epoch: 27, Steps: 20 | Train Loss: 0.092 Vali Loss: 2.234 Vali Acc: 0.570 Test Loss: 2.234 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.274141550064087
Epoch: 28, Steps: 20 | Train Loss: 0.057 Vali Loss: 2.066 Vali Acc: 0.530 Test Loss: 2.066 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.201464653015137
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.772 Vali Acc: 0.430 Test Loss: 0.772 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 5.497038125991821
Epoch: 2, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.868 Vali Acc: 0.470 Test Loss: 0.868 Test Acc: 0.470
Validation loss decreased (-0.429992 --> -0.469991).  Saving model ...
Epoch: 3 cost time: 5.8746209144592285
Epoch: 3, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.890 Vali Acc: 0.480 Test Loss: 0.890 Test Acc: 0.480
Validation loss decreased (-0.469991 --> -0.479991).  Saving model ...
Epoch: 4 cost time: 5.5451555252075195
Epoch: 4, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.873 Vali Acc: 0.520 Test Loss: 0.873 Test Acc: 0.520
Validation loss decreased (-0.479991 --> -0.519991).  Saving model ...
Epoch: 5 cost time: 5.197680234909058
Epoch: 5, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.888 Vali Acc: 0.480 Test Loss: 0.888 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.838635206222534
Epoch: 6, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.906 Vali Acc: 0.560 Test Loss: 0.906 Test Acc: 0.560
Validation loss decreased (-0.519991 --> -0.559991).  Saving model ...
Epoch: 7 cost time: 5.75576376914978
Epoch: 7, Steps: 20 | Train Loss: 0.554 Vali Loss: 1.051 Vali Acc: 0.520 Test Loss: 1.051 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.683671951293945
Epoch: 8, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.937 Vali Acc: 0.560 Test Loss: 0.937 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.573354244232178
Epoch: 9, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.583863973617554
Epoch: 10, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.085 Vali Acc: 0.490 Test Loss: 1.085 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.68386173248291
Epoch: 11, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.972 Vali Acc: 0.550 Test Loss: 0.972 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.900348424911499
Epoch: 12, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.067 Vali Acc: 0.560 Test Loss: 1.067 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.980869293212891
Epoch: 13, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.371 Vali Acc: 0.470 Test Loss: 1.371 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.328039646148682
Epoch: 14, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.306 Vali Acc: 0.540 Test Loss: 1.306 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.912398099899292
Epoch: 15, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.174 Vali Acc: 0.550 Test Loss: 1.174 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.839750051498413
Epoch: 16, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.493 Vali Acc: 0.540 Test Loss: 1.493 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.642740726470947
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.842 Vali Acc: 0.440 Test Loss: 0.842 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 5.342159986495972
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.989 Vali Acc: 0.460 Test Loss: 0.989 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459990).  Saving model ...
Epoch: 3 cost time: 5.637483835220337
Epoch: 3, Steps: 20 | Train Loss: 0.647 Vali Loss: 1.055 Vali Acc: 0.420 Test Loss: 1.055 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.709692716598511
Epoch: 4, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.974 Vali Acc: 0.450 Test Loss: 0.974 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.511028528213501
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 1.037 Vali Acc: 0.470 Test Loss: 1.037 Test Acc: 0.470
Validation loss decreased (-0.459990 --> -0.469990).  Saving model ...
Epoch: 6 cost time: 5.284435272216797
Epoch: 6, Steps: 20 | Train Loss: 0.565 Vali Loss: 1.025 Vali Acc: 0.470 Test Loss: 1.025 Test Acc: 0.470
Validation loss decreased (-0.469990 --> -0.469990).  Saving model ...
Epoch: 7 cost time: 5.164222478866577
Epoch: 7, Steps: 20 | Train Loss: 0.578 Vali Loss: 1.248 Vali Acc: 0.490 Test Loss: 1.248 Test Acc: 0.490
Validation loss decreased (-0.469990 --> -0.489988).  Saving model ...
Epoch: 8 cost time: 5.278240442276001
Epoch: 8, Steps: 20 | Train Loss: 0.553 Vali Loss: 1.027 Vali Acc: 0.530 Test Loss: 1.027 Test Acc: 0.530
Validation loss decreased (-0.489988 --> -0.529990).  Saving model ...
Epoch: 9 cost time: 5.192815780639648
Epoch: 9, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.172 Vali Acc: 0.550 Test Loss: 1.172 Test Acc: 0.550
Validation loss decreased (-0.529990 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 5.840837240219116
Epoch: 10, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.082 Vali Acc: 0.520 Test Loss: 1.082 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.549718141555786
Epoch: 11, Steps: 20 | Train Loss: 0.435 Vali Loss: 1.434 Vali Acc: 0.510 Test Loss: 1.434 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.1999900341033936
Epoch: 12, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.225 Vali Acc: 0.600 Test Loss: 1.225 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 6.0001935958862305
Epoch: 13, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.185 Vali Acc: 0.560 Test Loss: 1.185 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.485857725143433
Epoch: 14, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.228 Vali Acc: 0.530 Test Loss: 1.228 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.386670827865601
Epoch: 15, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.532 Vali Acc: 0.470 Test Loss: 1.532 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.821371555328369
Epoch: 16, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.624 Vali Acc: 0.520 Test Loss: 1.624 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.614822864532471
Epoch: 17, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.446 Vali Acc: 0.530 Test Loss: 1.446 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.948821544647217
Epoch: 18, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.548 Vali Acc: 0.580 Test Loss: 1.548 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.69011116027832
Epoch: 19, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.779 Vali Acc: 0.430 Test Loss: 1.779 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.771556854248047
Epoch: 20, Steps: 20 | Train Loss: 0.259 Vali Loss: 1.817 Vali Acc: 0.510 Test Loss: 1.817 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.677579641342163
Epoch: 21, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.893 Vali Acc: 0.540 Test Loss: 1.893 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.13545036315918
Epoch: 22, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.975 Vali Acc: 0.520 Test Loss: 1.975 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.784146785736084
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.725 Vali Acc: 0.450 Test Loss: 0.725 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.526986360549927
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
Validation loss decreased (-0.449993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 5.804377794265747
Epoch: 3, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.856 Vali Acc: 0.520 Test Loss: 0.856 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.579504013061523
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.589627981185913
Epoch: 5, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.859 Vali Acc: 0.520 Test Loss: 0.859 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.210129022598267
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.884 Vali Acc: 0.540 Test Loss: 0.884 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.172800064086914
Epoch: 7, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.907 Vali Acc: 0.490 Test Loss: 0.907 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.357297658920288
Epoch: 8, Steps: 20 | Train Loss: 0.597 Vali Loss: 1.027 Vali Acc: 0.510 Test Loss: 1.027 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.565615892410278
Epoch: 9, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.963 Vali Acc: 0.570 Test Loss: 0.963 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569990).  Saving model ...
Epoch: 10 cost time: 5.903090715408325
Epoch: 10, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.68605637550354
Epoch: 11, Steps: 20 | Train Loss: 0.542 Vali Loss: 1.219 Vali Acc: 0.490 Test Loss: 1.219 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.764878511428833
Epoch: 12, Steps: 20 | Train Loss: 0.558 Vali Loss: 1.089 Vali Acc: 0.530 Test Loss: 1.089 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.241101980209351
Epoch: 13, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.991 Vali Acc: 0.590 Test Loss: 0.991 Test Acc: 0.590
Validation loss decreased (-0.569990 --> -0.589990).  Saving model ...
Epoch: 14 cost time: 5.453528165817261
Epoch: 14, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.989 Vali Acc: 0.560 Test Loss: 0.989 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.19223952293396
Epoch: 15, Steps: 20 | Train Loss: 0.576 Vali Loss: 1.494 Vali Acc: 0.530 Test Loss: 1.494 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.466069221496582
Epoch: 16, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.349 Vali Acc: 0.610 Test Loss: 1.349 Test Acc: 0.610
Validation loss decreased (-0.589990 --> -0.609987).  Saving model ...
Epoch: 17 cost time: 5.905331611633301
Epoch: 17, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.687 Vali Acc: 0.530 Test Loss: 1.687 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.671466112136841
Epoch: 18, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.457 Vali Acc: 0.580 Test Loss: 1.457 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.371407985687256
Epoch: 19, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.633 Vali Acc: 0.610 Test Loss: 1.633 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.007718324661255
Epoch: 20, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.285 Vali Acc: 0.600 Test Loss: 1.285 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.095501899719238
Epoch: 21, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.392 Vali Acc: 0.610 Test Loss: 1.392 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.114225387573242
Epoch: 22, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.703 Vali Acc: 0.520 Test Loss: 1.703 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.972546815872192
Epoch: 23, Steps: 20 | Train Loss: 0.304 Vali Loss: 1.607 Vali Acc: 0.580 Test Loss: 1.607 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.397018194198608
Epoch: 24, Steps: 20 | Train Loss: 0.267 Vali Loss: 1.793 Vali Acc: 0.550 Test Loss: 1.793 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.304554462432861
Epoch: 25, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.926 Vali Acc: 0.540 Test Loss: 1.926 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.539379835128784
Epoch: 26, Steps: 20 | Train Loss: 0.254 Vali Loss: 2.140 Vali Acc: 0.560 Test Loss: 2.140 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.346009254455566
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.726 Vali Acc: 0.480 Test Loss: 0.726 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.88681697845459
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
Validation loss decreased (-0.479993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 5.47929048538208
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.921 Vali Acc: 0.470 Test Loss: 0.921 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.643477916717529
Epoch: 4, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.488697290420532
Epoch: 5, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.835 Vali Acc: 0.520 Test Loss: 0.835 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.003056049346924
Epoch: 6, Steps: 20 | Train Loss: 0.629 Vali Loss: 1.005 Vali Acc: 0.570 Test Loss: 1.005 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569990).  Saving model ...
Epoch: 7 cost time: 5.34609580039978
Epoch: 7, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.985 Vali Acc: 0.500 Test Loss: 0.985 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.350078821182251
Epoch: 8, Steps: 20 | Train Loss: 0.555 Vali Loss: 1.036 Vali Acc: 0.500 Test Loss: 1.036 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.060567378997803
Epoch: 9, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.024 Vali Acc: 0.580 Test Loss: 1.024 Test Acc: 0.580
Validation loss decreased (-0.569990 --> -0.579990).  Saving model ...
Epoch: 10 cost time: 5.1858696937561035
Epoch: 10, Steps: 20 | Train Loss: 0.472 Vali Loss: 1.105 Vali Acc: 0.560 Test Loss: 1.105 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.172590494155884
Epoch: 11, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.311 Vali Acc: 0.510 Test Loss: 1.311 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.6247007846832275
Epoch: 12, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.549245834350586
Epoch: 13, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.111 Vali Acc: 0.540 Test Loss: 1.111 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.706503629684448
Epoch: 14, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.063 Vali Acc: 0.580 Test Loss: 1.063 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.8468544483184814
Epoch: 15, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.661 Vali Acc: 0.520 Test Loss: 1.661 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.865743398666382
Epoch: 16, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.475 Vali Acc: 0.530 Test Loss: 1.475 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.079825401306152
Epoch: 17, Steps: 20 | Train Loss: 0.467 Vali Loss: 1.813 Vali Acc: 0.520 Test Loss: 1.813 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.438316583633423
Epoch: 18, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.441 Vali Acc: 0.530 Test Loss: 1.441 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.442569255828857
Epoch: 19, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.664 Vali Acc: 0.590 Test Loss: 1.664 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589983).  Saving model ...
Epoch: 20 cost time: 5.105964183807373
Epoch: 20, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.358 Vali Acc: 0.640 Test Loss: 1.358 Test Acc: 0.640
Validation loss decreased (-0.589983 --> -0.639986).  Saving model ...
Epoch: 21 cost time: 5.271262168884277
Epoch: 21, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.345 Vali Acc: 0.610 Test Loss: 1.345 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.2630836963653564
Epoch: 22, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.986 Vali Acc: 0.540 Test Loss: 1.986 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.244826316833496
Epoch: 23, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.482 Vali Acc: 0.580 Test Loss: 1.482 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.825197219848633
Epoch: 24, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.913 Vali Acc: 0.550 Test Loss: 1.913 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.55494236946106
Epoch: 25, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.838 Vali Acc: 0.570 Test Loss: 1.838 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.69197416305542
Epoch: 26, Steps: 20 | Train Loss: 0.131 Vali Loss: 2.021 Vali Acc: 0.550 Test Loss: 2.021 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.603079557418823
Epoch: 27, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.781 Vali Acc: 0.580 Test Loss: 1.781 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.647087097167969
Epoch: 28, Steps: 20 | Train Loss: 0.093 Vali Loss: 2.640 Vali Acc: 0.550 Test Loss: 2.640 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.493001222610474
Epoch: 29, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.623 Vali Acc: 0.610 Test Loss: 1.623 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.565336465835571
Epoch: 30, Steps: 20 | Train Loss: 0.156 Vali Loss: 2.289 Vali Acc: 0.500 Test Loss: 2.289 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.1033265590667725
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.474391222000122
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.969473600387573
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.213476896286011
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.339499473571777
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.001814603805542
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.443621635437012
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.784902811050415
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.679242372512817
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.6725852489471436
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.0371787548065186
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 5056770
model size : 29.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.8155717849731445
Epoch: 1, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.759 Vali Acc: 0.480 Test Loss: 0.759 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 5.513431549072266
Epoch: 2, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
Validation loss decreased (-0.479992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 5.569369554519653
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.855 Vali Acc: 0.480 Test Loss: 0.855 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.426405191421509
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.836 Vali Acc: 0.490 Test Loss: 0.836 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.460077524185181
Epoch: 5, Steps: 20 | Train Loss: 0.612 Vali Loss: 1.031 Vali Acc: 0.520 Test Loss: 1.031 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.116618871688843
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.888 Vali Acc: 0.450 Test Loss: 0.888 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.905859708786011
Epoch: 7, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.877 Vali Acc: 0.530 Test Loss: 0.877 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.032470941543579
Epoch: 8, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.972 Vali Acc: 0.550 Test Loss: 0.972 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 9 cost time: 5.1246538162231445
Epoch: 9, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.076 Vali Acc: 0.560 Test Loss: 1.076 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559989).  Saving model ...
Epoch: 10 cost time: 5.222888469696045
Epoch: 10, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.033 Vali Acc: 0.470 Test Loss: 1.033 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.6142988204956055
Epoch: 11, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.360568046569824
Epoch: 12, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.037 Vali Acc: 0.510 Test Loss: 1.037 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.215122222900391
Epoch: 13, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.014 Vali Acc: 0.490 Test Loss: 1.014 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.01666784286499
Epoch: 14, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.098 Vali Acc: 0.540 Test Loss: 1.098 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.892046689987183
Epoch: 15, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.126 Vali Acc: 0.570 Test Loss: 1.126 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569989).  Saving model ...
Epoch: 16 cost time: 4.780681371688843
Epoch: 16, Steps: 20 | Train Loss: 0.237 Vali Loss: 1.372 Vali Acc: 0.520 Test Loss: 1.372 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.3130011558532715
Epoch: 17, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.335 Vali Acc: 0.520 Test Loss: 1.335 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.570418834686279
Epoch: 18, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.536 Vali Acc: 0.520 Test Loss: 1.536 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.346683502197266
Epoch: 19, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.485 Vali Acc: 0.530 Test Loss: 1.485 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.621604919433594
Epoch: 20, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.490 Vali Acc: 0.550 Test Loss: 1.490 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.317582607269287
Epoch: 21, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.843 Vali Acc: 0.520 Test Loss: 1.843 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.173880100250244
Epoch: 22, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.866 Vali Acc: 0.560 Test Loss: 1.866 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.190027713775635
Epoch: 23, Steps: 20 | Train Loss: 0.167 Vali Loss: 2.397 Vali Acc: 0.510 Test Loss: 2.397 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.909428596496582
Epoch: 24, Steps: 20 | Train Loss: 0.125 Vali Loss: 2.071 Vali Acc: 0.550 Test Loss: 2.071 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.914851665496826
Epoch: 25, Steps: 20 | Train Loss: 0.114 Vali Loss: 2.133 Vali Acc: 0.500 Test Loss: 2.133 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.8504133224487305
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.770 Vali Acc: 0.510 Test Loss: 0.770 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.561583995819092
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.842 Vali Acc: 0.510 Test Loss: 0.842 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.640897512435913
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.017848968505859
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.855 Vali Acc: 0.470 Test Loss: 0.855 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.316554307937622
Epoch: 5, Steps: 20 | Train Loss: 0.614 Vali Loss: 1.014 Vali Acc: 0.480 Test Loss: 1.014 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.216623306274414
Epoch: 6, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.867 Vali Acc: 0.480 Test Loss: 0.867 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.642075061798096
Epoch: 7, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.956 Vali Acc: 0.500 Test Loss: 0.956 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.389092445373535
Epoch: 8, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.891 Vali Acc: 0.470 Test Loss: 0.891 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.227837324142456
Epoch: 9, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.098 Vali Acc: 0.530 Test Loss: 1.098 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529989).  Saving model ...
Epoch: 10 cost time: 5.343859672546387
Epoch: 10, Steps: 20 | Train Loss: 0.460 Vali Loss: 1.061 Vali Acc: 0.520 Test Loss: 1.061 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.449971914291382
Epoch: 11, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.068 Vali Acc: 0.510 Test Loss: 1.068 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.19149923324585
Epoch: 12, Steps: 20 | Train Loss: 0.367 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.372967958450317
Epoch: 13, Steps: 20 | Train Loss: 0.384 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.529989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 5.5800957679748535
Epoch: 14, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.702099561691284
Epoch: 15, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.171 Vali Acc: 0.570 Test Loss: 1.171 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.598340749740601
Epoch: 16, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.407 Vali Acc: 0.520 Test Loss: 1.407 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.575875282287598
Epoch: 17, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.234 Vali Acc: 0.550 Test Loss: 1.234 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.419996500015259
Epoch: 18, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.417 Vali Acc: 0.560 Test Loss: 1.417 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.353948593139648
Epoch: 19, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.746 Vali Acc: 0.550 Test Loss: 1.746 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.563931226730347
Epoch: 20, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.398 Vali Acc: 0.550 Test Loss: 1.398 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.4303624629974365
Epoch: 21, Steps: 20 | Train Loss: 0.119 Vali Loss: 2.111 Vali Acc: 0.490 Test Loss: 2.111 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.764916181564331
Epoch: 22, Steps: 20 | Train Loss: 0.141 Vali Loss: 2.101 Vali Acc: 0.530 Test Loss: 2.101 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.56644606590271
Epoch: 23, Steps: 20 | Train Loss: 0.125 Vali Loss: 2.120 Vali Acc: 0.520 Test Loss: 2.120 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.120454549789429
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.773 Vali Acc: 0.510 Test Loss: 0.773 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 5.193367004394531
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.838 Vali Acc: 0.480 Test Loss: 0.838 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.48492169380188
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.823 Vali Acc: 0.470 Test Loss: 0.823 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.628964185714722
Epoch: 4, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.807 Vali Acc: 0.520 Test Loss: 0.807 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 5.619523048400879
Epoch: 5, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.963 Vali Acc: 0.470 Test Loss: 0.963 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.122212886810303
Epoch: 6, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 5.593402862548828
Epoch: 7, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.917 Vali Acc: 0.510 Test Loss: 0.917 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.365130424499512
Epoch: 8, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.797 Vali Acc: 0.510 Test Loss: 0.797 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.210561752319336
Epoch: 9, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.079 Vali Acc: 0.510 Test Loss: 1.079 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.234863758087158
Epoch: 10, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.828 Vali Acc: 0.570 Test Loss: 0.828 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 5.799149036407471
Epoch: 11, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.970 Vali Acc: 0.570 Test Loss: 0.970 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.902916669845581
Epoch: 12, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.865 Vali Acc: 0.600 Test Loss: 0.865 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599991).  Saving model ...
Epoch: 13 cost time: 5.9537482261657715
Epoch: 13, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.897 Vali Acc: 0.570 Test Loss: 0.897 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.134049892425537
Epoch: 14, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.078 Vali Acc: 0.530 Test Loss: 1.078 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.4917802810668945
Epoch: 15, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.108 Vali Acc: 0.570 Test Loss: 1.108 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.505105018615723
Epoch: 16, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.177 Vali Acc: 0.600 Test Loss: 1.177 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.166620254516602
Epoch: 17, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.076 Vali Acc: 0.610 Test Loss: 1.076 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609989).  Saving model ...
Epoch: 18 cost time: 5.3866753578186035
Epoch: 18, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.259 Vali Acc: 0.550 Test Loss: 1.259 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.711799144744873
Epoch: 19, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.418 Vali Acc: 0.550 Test Loss: 1.418 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.349501132965088
Epoch: 20, Steps: 20 | Train Loss: 0.184 Vali Loss: 1.361 Vali Acc: 0.600 Test Loss: 1.361 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.660297632217407
Epoch: 21, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.768 Vali Acc: 0.490 Test Loss: 1.768 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.164104461669922
Epoch: 22, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.596 Vali Acc: 0.550 Test Loss: 1.596 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.185379505157471
Epoch: 23, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.624 Vali Acc: 0.550 Test Loss: 1.624 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.1462721824646
Epoch: 24, Steps: 20 | Train Loss: 0.131 Vali Loss: 1.369 Vali Acc: 0.560 Test Loss: 1.369 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.261713266372681
Epoch: 25, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.462 Vali Acc: 0.590 Test Loss: 1.462 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.961409568786621
Epoch: 26, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.558 Vali Acc: 0.550 Test Loss: 1.558 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.931443691253662
Epoch: 27, Steps: 20 | Train Loss: 0.085 Vali Loss: 1.725 Vali Acc: 0.520 Test Loss: 1.725 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.295894622802734
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.804 Vali Acc: 0.410 Test Loss: 0.804 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 5.294306755065918
Epoch: 2, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.862 Vali Acc: 0.420 Test Loss: 0.862 Test Acc: 0.420
Validation loss decreased (-0.409992 --> -0.419991).  Saving model ...
Epoch: 3 cost time: 5.309447526931763
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.867 Vali Acc: 0.500 Test Loss: 0.867 Test Acc: 0.500
Validation loss decreased (-0.419991 --> -0.499991).  Saving model ...
Epoch: 4 cost time: 5.647190093994141
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.841 Vali Acc: 0.530 Test Loss: 0.841 Test Acc: 0.530
Validation loss decreased (-0.499991 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 6.093273162841797
Epoch: 5, Steps: 20 | Train Loss: 0.586 Vali Loss: 1.011 Vali Acc: 0.460 Test Loss: 1.011 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.263049125671387
Epoch: 6, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.926 Vali Acc: 0.490 Test Loss: 0.926 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.043905973434448
Epoch: 7, Steps: 20 | Train Loss: 0.538 Vali Loss: 1.032 Vali Acc: 0.540 Test Loss: 1.032 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539990).  Saving model ...
Epoch: 8 cost time: 5.75075888633728
Epoch: 8, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.961 Vali Acc: 0.430 Test Loss: 0.961 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.389267683029175
Epoch: 9, Steps: 20 | Train Loss: 0.490 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.426266670227051
Epoch: 10, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.361221551895142
Epoch: 11, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.102 Vali Acc: 0.480 Test Loss: 1.102 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.455102920532227
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.941 Vali Acc: 0.550 Test Loss: 0.941 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549991).  Saving model ...
Epoch: 13 cost time: 6.015207767486572
Epoch: 13, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.067 Vali Acc: 0.540 Test Loss: 1.067 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.912801742553711
Epoch: 14, Steps: 20 | Train Loss: 0.306 Vali Loss: 1.212 Vali Acc: 0.520 Test Loss: 1.212 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.607645511627197
Epoch: 15, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.039 Vali Acc: 0.580 Test Loss: 1.039 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579990).  Saving model ...
Epoch: 16 cost time: 5.766197443008423
Epoch: 16, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.465 Vali Acc: 0.470 Test Loss: 1.465 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.597381114959717
Epoch: 17, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.353 Vali Acc: 0.510 Test Loss: 1.353 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.531373500823975
Epoch: 18, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.611 Vali Acc: 0.520 Test Loss: 1.611 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.68599796295166
Epoch: 19, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.815 Vali Acc: 0.480 Test Loss: 1.815 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.861310958862305
Epoch: 20, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.859 Vali Acc: 0.530 Test Loss: 1.859 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.840270042419434
Epoch: 21, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.914 Vali Acc: 0.560 Test Loss: 1.914 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.716503858566284
Epoch: 22, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.920 Vali Acc: 0.500 Test Loss: 1.920 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.982271909713745
Epoch: 23, Steps: 20 | Train Loss: 0.096 Vali Loss: 2.088 Vali Acc: 0.510 Test Loss: 2.088 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.419960975646973
Epoch: 24, Steps: 20 | Train Loss: 0.091 Vali Loss: 2.325 Vali Acc: 0.520 Test Loss: 2.325 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.58056116104126
Epoch: 25, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.953 Vali Acc: 0.540 Test Loss: 1.953 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.992904901504517
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.746 Vali Acc: 0.480 Test Loss: 0.746 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.4957849979400635
Epoch: 2, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.909 Vali Acc: 0.470 Test Loss: 0.909 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.567674160003662
Epoch: 3, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.945 Vali Acc: 0.470 Test Loss: 0.945 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.523375749588013
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.891 Vali Acc: 0.440 Test Loss: 0.891 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.500192880630493
Epoch: 5, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.120 Vali Acc: 0.530 Test Loss: 1.120 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529989).  Saving model ...
Epoch: 6 cost time: 5.569347143173218
Epoch: 6, Steps: 20 | Train Loss: 0.596 Vali Loss: 1.031 Vali Acc: 0.540 Test Loss: 1.031 Test Acc: 0.540
Validation loss decreased (-0.529989 --> -0.539990).  Saving model ...
Epoch: 7 cost time: 5.078104734420776
Epoch: 7, Steps: 20 | Train Loss: 0.549 Vali Loss: 1.077 Vali Acc: 0.500 Test Loss: 1.077 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.288546562194824
Epoch: 8, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.019 Vali Acc: 0.550 Test Loss: 1.019 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549990).  Saving model ...
Epoch: 9 cost time: 5.834996461868286
Epoch: 9, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.839110612869263
Epoch: 10, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.020 Vali Acc: 0.540 Test Loss: 1.020 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.500233173370361
Epoch: 11, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.237 Vali Acc: 0.580 Test Loss: 1.237 Test Acc: 0.580
Validation loss decreased (-0.549990 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 5.535537958145142
Epoch: 12, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.101 Vali Acc: 0.550 Test Loss: 1.101 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.48561954498291
Epoch: 13, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.034 Vali Acc: 0.550 Test Loss: 1.034 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.427599191665649
Epoch: 14, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.226260662078857
Epoch: 15, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.319 Vali Acc: 0.580 Test Loss: 1.319 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.814252614974976
Epoch: 16, Steps: 20 | Train Loss: 0.493 Vali Loss: 1.428 Vali Acc: 0.510 Test Loss: 1.428 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.789179086685181
Epoch: 17, Steps: 20 | Train Loss: 0.342 Vali Loss: 1.393 Vali Acc: 0.580 Test Loss: 1.393 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.710863828659058
Epoch: 18, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.312 Vali Acc: 0.580 Test Loss: 1.312 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.582009792327881
Epoch: 19, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.877 Vali Acc: 0.470 Test Loss: 1.877 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.583250999450684
Epoch: 20, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.733 Vali Acc: 0.570 Test Loss: 1.733 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.267582893371582
Epoch: 21, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.862 Vali Acc: 0.610 Test Loss: 1.862 Test Acc: 0.610
Validation loss decreased (-0.579988 --> -0.609981).  Saving model ...
Epoch: 22 cost time: 5.35157036781311
Epoch: 22, Steps: 20 | Train Loss: 0.214 Vali Loss: 2.047 Vali Acc: 0.530 Test Loss: 2.047 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.4240336418151855
Epoch: 23, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.972 Vali Acc: 0.540 Test Loss: 1.972 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.078686714172363
Epoch: 24, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.902 Vali Acc: 0.540 Test Loss: 1.902 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.884636163711548
Epoch: 25, Steps: 20 | Train Loss: 0.123 Vali Loss: 2.524 Vali Acc: 0.550 Test Loss: 2.524 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.314624547958374
Epoch: 26, Steps: 20 | Train Loss: 0.251 Vali Loss: 2.091 Vali Acc: 0.560 Test Loss: 2.091 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.500643968582153
Epoch: 27, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.813 Vali Acc: 0.530 Test Loss: 1.813 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.410268545150757
Epoch: 28, Steps: 20 | Train Loss: 0.059 Vali Loss: 2.140 Vali Acc: 0.530 Test Loss: 2.140 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.767951250076294
Epoch: 29, Steps: 20 | Train Loss: 0.056 Vali Loss: 2.150 Vali Acc: 0.500 Test Loss: 2.150 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.519736289978027
Epoch: 30, Steps: 20 | Train Loss: 0.100 Vali Loss: 2.512 Vali Acc: 0.490 Test Loss: 2.512 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.575109481811523
Epoch: 31, Steps: 20 | Train Loss: 0.116 Vali Loss: 2.182 Vali Acc: 0.510 Test Loss: 2.182 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.085407733917236
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.750 Vali Acc: 0.480 Test Loss: 0.750 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.505997657775879
Epoch: 2, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 5.79394268989563
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.802 Vali Acc: 0.470 Test Loss: 0.802 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.666057109832764
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.804 Vali Acc: 0.470 Test Loss: 0.804 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.8021018505096436
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.967 Vali Acc: 0.550 Test Loss: 0.967 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 5.329482316970825
Epoch: 6, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.972 Vali Acc: 0.540 Test Loss: 0.972 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.95325493812561
Epoch: 7, Steps: 20 | Train Loss: 0.607 Vali Loss: 1.025 Vali Acc: 0.550 Test Loss: 1.025 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.130824327468872
Epoch: 8, Steps: 20 | Train Loss: 0.633 Vali Loss: 1.066 Vali Acc: 0.530 Test Loss: 1.066 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.485114097595215
Epoch: 9, Steps: 20 | Train Loss: 0.598 Vali Loss: 1.012 Vali Acc: 0.590 Test Loss: 1.012 Test Acc: 0.590
Validation loss decreased (-0.549990 --> -0.589990).  Saving model ...
Epoch: 10 cost time: 5.589801073074341
Epoch: 10, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.019 Vali Acc: 0.630 Test Loss: 1.019 Test Acc: 0.630
Validation loss decreased (-0.589990 --> -0.629990).  Saving model ...
Epoch: 11 cost time: 5.837621688842773
Epoch: 11, Steps: 20 | Train Loss: 0.543 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.584759950637817
Epoch: 12, Steps: 20 | Train Loss: 0.501 Vali Loss: 1.000 Vali Acc: 0.640 Test Loss: 1.000 Test Acc: 0.640
Validation loss decreased (-0.629990 --> -0.639990).  Saving model ...
Epoch: 13 cost time: 5.935357570648193
Epoch: 13, Steps: 20 | Train Loss: 0.518 Vali Loss: 1.082 Vali Acc: 0.550 Test Loss: 1.082 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.175595760345459
Epoch: 14, Steps: 20 | Train Loss: 0.486 Vali Loss: 1.332 Vali Acc: 0.590 Test Loss: 1.332 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.366990327835083
Epoch: 15, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.036 Vali Acc: 0.580 Test Loss: 1.036 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.358472108840942
Epoch: 16, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.255 Vali Acc: 0.530 Test Loss: 1.255 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.752963304519653
Epoch: 17, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.223 Vali Acc: 0.540 Test Loss: 1.223 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.009871482849121
Epoch: 18, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.935205936431885
Epoch: 19, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.759 Vali Acc: 0.530 Test Loss: 1.759 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.121522426605225
Epoch: 20, Steps: 20 | Train Loss: 0.331 Vali Loss: 1.319 Vali Acc: 0.590 Test Loss: 1.319 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.0800275802612305
Epoch: 21, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.586 Vali Acc: 0.550 Test Loss: 1.586 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.723423957824707
Epoch: 22, Steps: 20 | Train Loss: 0.308 Vali Loss: 2.350 Vali Acc: 0.560 Test Loss: 2.350 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.065949201583862
Epoch: 1, Steps: 20 | Train Loss: 0.727 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 5.859959363937378
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.865 Vali Acc: 0.520 Test Loss: 0.865 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519991).  Saving model ...
Epoch: 3 cost time: 5.961833477020264
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.817 Vali Acc: 0.520 Test Loss: 0.817 Test Acc: 0.520
Validation loss decreased (-0.519991 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 5.5410449504852295
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.801 Vali Acc: 0.490 Test Loss: 0.801 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.3271918296813965
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.970 Vali Acc: 0.560 Test Loss: 0.970 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559990).  Saving model ...
Epoch: 6 cost time: 5.222825527191162
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.995 Vali Acc: 0.530 Test Loss: 0.995 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.010632514953613
Epoch: 7, Steps: 20 | Train Loss: 0.570 Vali Loss: 1.039 Vali Acc: 0.530 Test Loss: 1.039 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.6602184772491455
Epoch: 8, Steps: 20 | Train Loss: 0.570 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.989318609237671
Epoch: 9, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.116 Vali Acc: 0.610 Test Loss: 1.116 Test Acc: 0.610
Validation loss decreased (-0.559990 --> -0.609989).  Saving model ...
Epoch: 10 cost time: 5.683385848999023
Epoch: 10, Steps: 20 | Train Loss: 0.546 Vali Loss: 1.037 Vali Acc: 0.580 Test Loss: 1.037 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.527450323104858
Epoch: 11, Steps: 20 | Train Loss: 0.506 Vali Loss: 1.198 Vali Acc: 0.550 Test Loss: 1.198 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.366203784942627
Epoch: 12, Steps: 20 | Train Loss: 0.466 Vali Loss: 1.074 Vali Acc: 0.580 Test Loss: 1.074 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.447229623794556
Epoch: 13, Steps: 20 | Train Loss: 0.454 Vali Loss: 1.137 Vali Acc: 0.600 Test Loss: 1.137 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.664089679718018
Epoch: 14, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.694426536560059
Epoch: 15, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.246 Vali Acc: 0.610 Test Loss: 1.246 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.75347375869751
Epoch: 16, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.221 Vali Acc: 0.570 Test Loss: 1.221 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.146172046661377
Epoch: 17, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.316 Vali Acc: 0.530 Test Loss: 1.316 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.842610597610474
Epoch: 18, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.302 Vali Acc: 0.580 Test Loss: 1.302 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.8538901805877686
Epoch: 19, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.771 Vali Acc: 0.520 Test Loss: 1.771 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.69628643989563
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 4.984121799468994
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.354522943496704
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.442185401916504
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.4505860805511475
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.339173316955566
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.051377773284912
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.0698089599609375
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.323668718338013
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.155642747879028
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.56832480430603
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 3483906
model size : 23.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.4389777183532715
Epoch: 1, Steps: 20 | Train Loss: 0.764 Vali Loss: 0.722 Vali Acc: 0.540 Test Loss: 0.722 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 4.9561848640441895
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.840 Vali Acc: 0.510 Test Loss: 0.840 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.08014178276062
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.998384237289429
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 1.018 Vali Acc: 0.510 Test Loss: 1.018 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.015241861343384
Epoch: 5, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.841 Vali Acc: 0.460 Test Loss: 0.841 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.392052888870239
Epoch: 6, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.844 Vali Acc: 0.550 Test Loss: 0.844 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 5.650899648666382
Epoch: 7, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.290914297103882
Epoch: 8, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.030 Vali Acc: 0.560 Test Loss: 1.030 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559990).  Saving model ...
Epoch: 9 cost time: 5.391853094100952
Epoch: 9, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.960 Vali Acc: 0.500 Test Loss: 0.960 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.0397047996521
Epoch: 10, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.027 Vali Acc: 0.510 Test Loss: 1.027 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.8686652183532715
Epoch: 11, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.930 Vali Acc: 0.560 Test Loss: 0.930 Test Acc: 0.560
Validation loss decreased (-0.559990 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 5.040774345397949
Epoch: 12, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.312 Vali Acc: 0.510 Test Loss: 1.312 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.940626621246338
Epoch: 13, Steps: 20 | Train Loss: 0.397 Vali Loss: 1.116 Vali Acc: 0.520 Test Loss: 1.116 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.959906101226807
Epoch: 14, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.179 Vali Acc: 0.520 Test Loss: 1.179 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.528630971908569
Epoch: 15, Steps: 20 | Train Loss: 0.301 Vali Loss: 1.172 Vali Acc: 0.520 Test Loss: 1.172 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.409230709075928
Epoch: 16, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.448 Vali Acc: 0.530 Test Loss: 1.448 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.429880380630493
Epoch: 17, Steps: 20 | Train Loss: 0.242 Vali Loss: 1.452 Vali Acc: 0.520 Test Loss: 1.452 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.140182971954346
Epoch: 18, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.360 Vali Acc: 0.590 Test Loss: 1.360 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589986).  Saving model ...
Epoch: 19 cost time: 5.303714275360107
Epoch: 19, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.325 Vali Acc: 0.610 Test Loss: 1.325 Test Acc: 0.610
Validation loss decreased (-0.589986 --> -0.609987).  Saving model ...
Epoch: 20 cost time: 5.1331751346588135
Epoch: 20, Steps: 20 | Train Loss: 0.181 Vali Loss: 1.417 Vali Acc: 0.570 Test Loss: 1.417 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.197076320648193
Epoch: 21, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.628 Vali Acc: 0.570 Test Loss: 1.628 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.303490161895752
Epoch: 22, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.579 Vali Acc: 0.560 Test Loss: 1.579 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.553778171539307
Epoch: 23, Steps: 20 | Train Loss: 0.064 Vali Loss: 1.528 Vali Acc: 0.560 Test Loss: 1.528 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.378448486328125
Epoch: 24, Steps: 20 | Train Loss: 0.069 Vali Loss: 1.760 Vali Acc: 0.560 Test Loss: 1.760 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.418269395828247
Epoch: 25, Steps: 20 | Train Loss: 0.065 Vali Loss: 2.143 Vali Acc: 0.490 Test Loss: 2.143 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.170447826385498
Epoch: 26, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.780 Vali Acc: 0.530 Test Loss: 1.780 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.034484386444092
Epoch: 27, Steps: 20 | Train Loss: 0.054 Vali Loss: 2.041 Vali Acc: 0.490 Test Loss: 2.041 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.174380779266357
Epoch: 28, Steps: 20 | Train Loss: 0.064 Vali Loss: 2.537 Vali Acc: 0.510 Test Loss: 2.537 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.1413702964782715
Epoch: 29, Steps: 20 | Train Loss: 0.040 Vali Loss: 2.162 Vali Acc: 0.500 Test Loss: 2.162 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.887432336807251
Epoch: 1, Steps: 20 | Train Loss: 0.752 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.654776334762573
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.980760812759399
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.958 Vali Acc: 0.510 Test Loss: 0.958 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.0637500286102295
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.145611524581909
Epoch: 5, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.849 Vali Acc: 0.460 Test Loss: 0.849 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.324416399002075
Epoch: 6, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.798948764801025
Epoch: 7, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.865 Vali Acc: 0.510 Test Loss: 0.865 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.840763807296753
Epoch: 8, Steps: 20 | Train Loss: 0.490 Vali Loss: 1.081 Vali Acc: 0.480 Test Loss: 1.081 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.068078517913818
Epoch: 9, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.625476598739624
Epoch: 10, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.078 Vali Acc: 0.560 Test Loss: 1.078 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 4.892542839050293
Epoch: 11, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.878 Vali Acc: 0.560 Test Loss: 0.878 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 4.95838737487793
Epoch: 12, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.184 Vali Acc: 0.490 Test Loss: 1.184 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.989648818969727
Epoch: 13, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.100 Vali Acc: 0.560 Test Loss: 1.100 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.515854358673096
Epoch: 14, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.253 Vali Acc: 0.510 Test Loss: 1.253 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.971519231796265
Epoch: 15, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.187 Vali Acc: 0.580 Test Loss: 1.187 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579988).  Saving model ...
Epoch: 16 cost time: 5.68446159362793
Epoch: 16, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.426 Vali Acc: 0.560 Test Loss: 1.426 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.510146141052246
Epoch: 17, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.550 Vali Acc: 0.480 Test Loss: 1.550 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.426036834716797
Epoch: 18, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.399 Vali Acc: 0.560 Test Loss: 1.399 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.066056489944458
Epoch: 19, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.165 Vali Acc: 0.620 Test Loss: 1.165 Test Acc: 0.620
Validation loss decreased (-0.579988 --> -0.619988).  Saving model ...
Epoch: 20 cost time: 5.459510326385498
Epoch: 20, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.581 Vali Acc: 0.490 Test Loss: 1.581 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.025819301605225
Epoch: 21, Steps: 20 | Train Loss: 0.182 Vali Loss: 1.519 Vali Acc: 0.530 Test Loss: 1.519 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.10193943977356
Epoch: 22, Steps: 20 | Train Loss: 0.155 Vali Loss: 1.429 Vali Acc: 0.610 Test Loss: 1.429 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.480079174041748
Epoch: 23, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.725 Vali Acc: 0.550 Test Loss: 1.725 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.41515588760376
Epoch: 24, Steps: 20 | Train Loss: 0.096 Vali Loss: 1.720 Vali Acc: 0.600 Test Loss: 1.720 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.442188262939453
Epoch: 25, Steps: 20 | Train Loss: 0.097 Vali Loss: 1.748 Vali Acc: 0.630 Test Loss: 1.748 Test Acc: 0.630
Validation loss decreased (-0.619988 --> -0.629983).  Saving model ...
Epoch: 26 cost time: 5.552640438079834
Epoch: 26, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.946 Vali Acc: 0.560 Test Loss: 1.946 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.356962203979492
Epoch: 27, Steps: 20 | Train Loss: 0.039 Vali Loss: 2.220 Vali Acc: 0.570 Test Loss: 2.220 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.287965536117554
Epoch: 28, Steps: 20 | Train Loss: 0.047 Vali Loss: 2.118 Vali Acc: 0.580 Test Loss: 2.118 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.506464242935181
Epoch: 29, Steps: 20 | Train Loss: 0.027 Vali Loss: 2.120 Vali Acc: 0.590 Test Loss: 2.120 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.748474836349487
Epoch: 30, Steps: 20 | Train Loss: 0.027 Vali Loss: 2.251 Vali Acc: 0.500 Test Loss: 2.251 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.951125383377075
Epoch: 31, Steps: 20 | Train Loss: 0.043 Vali Loss: 2.211 Vali Acc: 0.560 Test Loss: 2.211 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 5.896042585372925
Epoch: 32, Steps: 20 | Train Loss: 0.052 Vali Loss: 1.968 Vali Acc: 0.580 Test Loss: 1.968 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.791340589523315
Epoch: 33, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.063 Vali Acc: 0.530 Test Loss: 2.063 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.808632135391235
Epoch: 34, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.988 Vali Acc: 0.530 Test Loss: 2.988 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.440959453582764
Epoch: 35, Steps: 20 | Train Loss: 0.062 Vali Loss: 2.488 Vali Acc: 0.510 Test Loss: 2.488 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.911945581436157
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.752 Vali Acc: 0.490 Test Loss: 0.752 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 5.5136237144470215
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.870 Vali Acc: 0.490 Test Loss: 0.870 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5350341796875
Epoch: 3, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.886 Vali Acc: 0.520 Test Loss: 0.886 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 5.666029691696167
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.984 Vali Acc: 0.510 Test Loss: 0.984 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.510646820068359
Epoch: 5, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.397062301635742
Epoch: 6, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.839 Vali Acc: 0.480 Test Loss: 0.839 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.87813663482666
Epoch: 7, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 5.184124708175659
Epoch: 8, Steps: 20 | Train Loss: 0.496 Vali Loss: 1.022 Vali Acc: 0.530 Test Loss: 1.022 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.3099493980407715
Epoch: 9, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.392057180404663
Epoch: 10, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.969 Vali Acc: 0.550 Test Loss: 0.969 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 11 cost time: 5.570635557174683
Epoch: 11, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.839 Vali Acc: 0.590 Test Loss: 0.839 Test Acc: 0.590
Validation loss decreased (-0.549990 --> -0.589992).  Saving model ...
Epoch: 12 cost time: 5.4864442348480225
Epoch: 12, Steps: 20 | Train Loss: 0.419 Vali Loss: 1.111 Vali Acc: 0.550 Test Loss: 1.111 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.4537739753723145
Epoch: 13, Steps: 20 | Train Loss: 0.354 Vali Loss: 1.037 Vali Acc: 0.570 Test Loss: 1.037 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.178245306015015
Epoch: 14, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.178 Vali Acc: 0.570 Test Loss: 1.178 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.2925169467926025
Epoch: 15, Steps: 20 | Train Loss: 0.317 Vali Loss: 0.930 Vali Acc: 0.610 Test Loss: 0.930 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609991).  Saving model ...
Epoch: 16 cost time: 5.064615726470947
Epoch: 16, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.286 Vali Acc: 0.520 Test Loss: 1.286 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.998634099960327
Epoch: 17, Steps: 20 | Train Loss: 0.260 Vali Loss: 1.220 Vali Acc: 0.540 Test Loss: 1.220 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.865957736968994
Epoch: 18, Steps: 20 | Train Loss: 0.228 Vali Loss: 1.256 Vali Acc: 0.570 Test Loss: 1.256 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.300009727478027
Epoch: 19, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.098 Vali Acc: 0.620 Test Loss: 1.098 Test Acc: 0.620
Validation loss decreased (-0.609991 --> -0.619989).  Saving model ...
Epoch: 20 cost time: 5.22057318687439
Epoch: 20, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.502 Vali Acc: 0.510 Test Loss: 1.502 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.339357852935791
Epoch: 21, Steps: 20 | Train Loss: 0.153 Vali Loss: 1.409 Vali Acc: 0.580 Test Loss: 1.409 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.562167167663574
Epoch: 22, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.431 Vali Acc: 0.580 Test Loss: 1.431 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.092526912689209
Epoch: 23, Steps: 20 | Train Loss: 0.119 Vali Loss: 1.973 Vali Acc: 0.540 Test Loss: 1.973 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.173584461212158
Epoch: 24, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.870 Vali Acc: 0.570 Test Loss: 1.870 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.9384002685546875
Epoch: 25, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.586 Vali Acc: 0.590 Test Loss: 1.586 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.896441459655762
Epoch: 26, Steps: 20 | Train Loss: 0.059 Vali Loss: 1.761 Vali Acc: 0.560 Test Loss: 1.761 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.312335252761841
Epoch: 27, Steps: 20 | Train Loss: 0.053 Vali Loss: 1.758 Vali Acc: 0.540 Test Loss: 1.758 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.141455888748169
Epoch: 28, Steps: 20 | Train Loss: 0.028 Vali Loss: 1.911 Vali Acc: 0.550 Test Loss: 1.911 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.051745176315308
Epoch: 29, Steps: 20 | Train Loss: 0.041 Vali Loss: 1.706 Vali Acc: 0.560 Test Loss: 1.706 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.20668625831604
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.758 Vali Acc: 0.460 Test Loss: 0.758 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 5.3314948081970215
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.886 Vali Acc: 0.490 Test Loss: 0.886 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489991).  Saving model ...
Epoch: 3 cost time: 5.266918897628784
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.895 Vali Acc: 0.490 Test Loss: 0.895 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.11870002746582
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 1.010 Vali Acc: 0.490 Test Loss: 1.010 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.905348777770996
Epoch: 5, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.919 Vali Acc: 0.470 Test Loss: 0.919 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.8660736083984375
Epoch: 6, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.871 Vali Acc: 0.480 Test Loss: 0.871 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.657258749008179
Epoch: 7, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
Validation loss decreased (-0.489991 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 4.871326684951782
Epoch: 8, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.984 Vali Acc: 0.510 Test Loss: 0.984 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.1588521003723145
Epoch: 9, Steps: 20 | Train Loss: 0.505 Vali Loss: 1.031 Vali Acc: 0.460 Test Loss: 1.031 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.225597858428955
Epoch: 10, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.005 Vali Acc: 0.510 Test Loss: 1.005 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.041486501693726
Epoch: 11, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.044 Vali Acc: 0.520 Test Loss: 1.044 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.4756553173065186
Epoch: 12, Steps: 20 | Train Loss: 0.457 Vali Loss: 1.129 Vali Acc: 0.520 Test Loss: 1.129 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.830089330673218
Epoch: 13, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.196 Vali Acc: 0.460 Test Loss: 1.196 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.874173164367676
Epoch: 14, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.072 Vali Acc: 0.540 Test Loss: 1.072 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539989).  Saving model ...
Epoch: 15 cost time: 4.9229536056518555
Epoch: 15, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.466 Vali Acc: 0.500 Test Loss: 1.466 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.81671667098999
Epoch: 16, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.485 Vali Acc: 0.530 Test Loss: 1.485 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.106603384017944
Epoch: 17, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.357 Vali Acc: 0.570 Test Loss: 1.357 Test Acc: 0.570
Validation loss decreased (-0.539989 --> -0.569986).  Saving model ...
Epoch: 18 cost time: 5.320658445358276
Epoch: 18, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.617 Vali Acc: 0.500 Test Loss: 1.617 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.275394916534424
Epoch: 19, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.621 Vali Acc: 0.520 Test Loss: 1.621 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.455999851226807
Epoch: 20, Steps: 20 | Train Loss: 0.157 Vali Loss: 1.729 Vali Acc: 0.500 Test Loss: 1.729 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.168390274047852
Epoch: 21, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.830 Vali Acc: 0.520 Test Loss: 1.830 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.833131551742554
Epoch: 22, Steps: 20 | Train Loss: 0.234 Vali Loss: 1.790 Vali Acc: 0.530 Test Loss: 1.790 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.004853248596191
Epoch: 23, Steps: 20 | Train Loss: 0.233 Vali Loss: 2.594 Vali Acc: 0.550 Test Loss: 2.594 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.0151731967926025
Epoch: 24, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.843 Vali Acc: 0.580 Test Loss: 1.843 Test Acc: 0.580
Validation loss decreased (-0.569986 --> -0.579982).  Saving model ...
Epoch: 25 cost time: 5.1569201946258545
Epoch: 25, Steps: 20 | Train Loss: 0.070 Vali Loss: 2.220 Vali Acc: 0.510 Test Loss: 2.220 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.528552293777466
Epoch: 26, Steps: 20 | Train Loss: 0.078 Vali Loss: 2.425 Vali Acc: 0.570 Test Loss: 2.425 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.41693115234375
Epoch: 27, Steps: 20 | Train Loss: 0.071 Vali Loss: 2.336 Vali Acc: 0.520 Test Loss: 2.336 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.1790361404418945
Epoch: 28, Steps: 20 | Train Loss: 0.072 Vali Loss: 2.617 Vali Acc: 0.510 Test Loss: 2.617 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.202256917953491
Epoch: 29, Steps: 20 | Train Loss: 0.077 Vali Loss: 2.588 Vali Acc: 0.500 Test Loss: 2.588 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.115706205368042
Epoch: 30, Steps: 20 | Train Loss: 0.089 Vali Loss: 2.347 Vali Acc: 0.490 Test Loss: 2.347 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.041585206985474
Epoch: 31, Steps: 20 | Train Loss: 0.062 Vali Loss: 2.344 Vali Acc: 0.510 Test Loss: 2.344 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.641723394393921
Epoch: 32, Steps: 20 | Train Loss: 0.056 Vali Loss: 2.419 Vali Acc: 0.570 Test Loss: 2.419 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.896960973739624
Epoch: 33, Steps: 20 | Train Loss: 0.043 Vali Loss: 2.730 Vali Acc: 0.520 Test Loss: 2.730 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.518970012664795
Epoch: 34, Steps: 20 | Train Loss: 0.033 Vali Loss: 2.807 Vali Acc: 0.540 Test Loss: 2.807 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.796437978744507
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.753 Vali Acc: 0.450 Test Loss: 0.753 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 4.8847432136535645
Epoch: 2, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.880 Vali Acc: 0.440 Test Loss: 0.880 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.386559963226318
Epoch: 3, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.996 Vali Acc: 0.510 Test Loss: 0.996 Test Acc: 0.510
Validation loss decreased (-0.449992 --> -0.509990).  Saving model ...
Epoch: 4 cost time: 5.250906229019165
Epoch: 4, Steps: 20 | Train Loss: 0.649 Vali Loss: 1.075 Vali Acc: 0.510 Test Loss: 1.075 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.369601011276245
Epoch: 5, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.976 Vali Acc: 0.470 Test Loss: 0.976 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.531653642654419
Epoch: 6, Steps: 20 | Train Loss: 0.584 Vali Loss: 1.033 Vali Acc: 0.460 Test Loss: 1.033 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.948446035385132
Epoch: 7, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.988 Vali Acc: 0.490 Test Loss: 0.988 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.903977155685425
Epoch: 8, Steps: 20 | Train Loss: 0.547 Vali Loss: 1.113 Vali Acc: 0.520 Test Loss: 1.113 Test Acc: 0.520
Validation loss decreased (-0.509990 --> -0.519989).  Saving model ...
Epoch: 9 cost time: 5.613609552383423
Epoch: 9, Steps: 20 | Train Loss: 0.533 Vali Loss: 1.066 Vali Acc: 0.510 Test Loss: 1.066 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.440708637237549
Epoch: 10, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.187 Vali Acc: 0.480 Test Loss: 1.187 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.350155591964722
Epoch: 11, Steps: 20 | Train Loss: 0.431 Vali Loss: 1.121 Vali Acc: 0.530 Test Loss: 1.121 Test Acc: 0.530
Validation loss decreased (-0.519989 --> -0.529989).  Saving model ...
Epoch: 12 cost time: 5.176831960678101
Epoch: 12, Steps: 20 | Train Loss: 0.445 Vali Loss: 1.280 Vali Acc: 0.520 Test Loss: 1.280 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.606388092041016
Epoch: 13, Steps: 20 | Train Loss: 0.381 Vali Loss: 1.253 Vali Acc: 0.530 Test Loss: 1.253 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.944109201431274
Epoch: 14, Steps: 20 | Train Loss: 0.407 Vali Loss: 1.247 Vali Acc: 0.570 Test Loss: 1.247 Test Acc: 0.570
Validation loss decreased (-0.529989 --> -0.569988).  Saving model ...
Epoch: 15 cost time: 5.759774208068848
Epoch: 15, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.446 Vali Acc: 0.500 Test Loss: 1.446 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.883576393127441
Epoch: 16, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.827 Vali Acc: 0.500 Test Loss: 1.827 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.4234936237335205
Epoch: 17, Steps: 20 | Train Loss: 0.355 Vali Loss: 1.441 Vali Acc: 0.550 Test Loss: 1.441 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.147838592529297
Epoch: 18, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.732 Vali Acc: 0.510 Test Loss: 1.732 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.2337095737457275
Epoch: 19, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.726 Vali Acc: 0.560 Test Loss: 1.726 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.036894083023071
Epoch: 20, Steps: 20 | Train Loss: 0.231 Vali Loss: 1.671 Vali Acc: 0.530 Test Loss: 1.671 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.591676235198975
Epoch: 21, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.833 Vali Acc: 0.530 Test Loss: 1.833 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.325760364532471
Epoch: 22, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.900 Vali Acc: 0.530 Test Loss: 1.900 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.649247169494629
Epoch: 23, Steps: 20 | Train Loss: 0.137 Vali Loss: 2.111 Vali Acc: 0.560 Test Loss: 2.111 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.3694446086883545
Epoch: 24, Steps: 20 | Train Loss: 0.352 Vali Loss: 2.375 Vali Acc: 0.520 Test Loss: 2.375 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.405522584915161
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.744 Vali Acc: 0.460 Test Loss: 0.744 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 5.271557092666626
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.775 Vali Acc: 0.470 Test Loss: 0.775 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 5.885260343551636
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.838 Vali Acc: 0.540 Test Loss: 0.838 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 5.54377818107605
Epoch: 4, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.984 Vali Acc: 0.500 Test Loss: 0.984 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.196153879165649
Epoch: 5, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.980 Vali Acc: 0.500 Test Loss: 0.980 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.652739763259888
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.393948793411255
Epoch: 7, Steps: 20 | Train Loss: 0.618 Vali Loss: 1.054 Vali Acc: 0.540 Test Loss: 1.054 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.4569337368011475
Epoch: 8, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.944 Vali Acc: 0.530 Test Loss: 0.944 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.496248960494995
Epoch: 9, Steps: 20 | Train Loss: 0.583 Vali Loss: 1.070 Vali Acc: 0.520 Test Loss: 1.070 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.698443412780762
Epoch: 10, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.933 Vali Acc: 0.570 Test Loss: 0.933 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 11 cost time: 5.906045913696289
Epoch: 11, Steps: 20 | Train Loss: 0.502 Vali Loss: 1.007 Vali Acc: 0.580 Test Loss: 1.007 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579990).  Saving model ...
Epoch: 12 cost time: 5.765769004821777
Epoch: 12, Steps: 20 | Train Loss: 0.499 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.719274044036865
Epoch: 13, Steps: 20 | Train Loss: 0.496 Vali Loss: 1.484 Vali Acc: 0.520 Test Loss: 1.484 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.157440662384033
Epoch: 14, Steps: 20 | Train Loss: 0.478 Vali Loss: 1.288 Vali Acc: 0.560 Test Loss: 1.288 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.091453552246094
Epoch: 15, Steps: 20 | Train Loss: 0.483 Vali Loss: 1.434 Vali Acc: 0.530 Test Loss: 1.434 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.174946069717407
Epoch: 16, Steps: 20 | Train Loss: 0.521 Vali Loss: 1.387 Vali Acc: 0.540 Test Loss: 1.387 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.912086248397827
Epoch: 17, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.478 Vali Acc: 0.490 Test Loss: 1.478 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.623464584350586
Epoch: 18, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.982 Vali Acc: 0.510 Test Loss: 1.982 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.361387491226196
Epoch: 19, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.701 Vali Acc: 0.580 Test Loss: 1.701 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.83705472946167
Epoch: 20, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.544 Vali Acc: 0.500 Test Loss: 1.544 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.373440504074097
Epoch: 21, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.988 Vali Acc: 0.540 Test Loss: 1.988 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.200132846832275
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.737 Vali Acc: 0.490 Test Loss: 0.737 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.446668386459351
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.781 Vali Acc: 0.450 Test Loss: 0.781 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.139982461929321
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.835 Vali Acc: 0.500 Test Loss: 0.835 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 5.819936990737915
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.984 Vali Acc: 0.460 Test Loss: 0.984 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.049281597137451
Epoch: 5, Steps: 20 | Train Loss: 0.641 Vali Loss: 1.014 Vali Acc: 0.500 Test Loss: 1.014 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.950417995452881
Epoch: 6, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.881 Vali Acc: 0.530 Test Loss: 0.881 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 7 cost time: 5.506425380706787
Epoch: 7, Steps: 20 | Train Loss: 0.588 Vali Loss: 1.058 Vali Acc: 0.540 Test Loss: 1.058 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539989).  Saving model ...
Epoch: 8 cost time: 5.506979942321777
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.933 Vali Acc: 0.540 Test Loss: 0.933 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539991).  Saving model ...
Epoch: 9 cost time: 5.169942378997803
Epoch: 9, Steps: 20 | Train Loss: 0.566 Vali Loss: 1.112 Vali Acc: 0.510 Test Loss: 1.112 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.071355819702148
Epoch: 10, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.945 Vali Acc: 0.560 Test Loss: 0.945 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 5.57243013381958
Epoch: 11, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.990 Vali Acc: 0.550 Test Loss: 0.990 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.7233405113220215
Epoch: 12, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.199 Vali Acc: 0.570 Test Loss: 1.199 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569988).  Saving model ...
Epoch: 13 cost time: 5.8886353969573975
Epoch: 13, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.309 Vali Acc: 0.550 Test Loss: 1.309 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.1785807609558105
Epoch: 14, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.367 Vali Acc: 0.570 Test Loss: 1.367 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.155409336090088
Epoch: 15, Steps: 20 | Train Loss: 0.462 Vali Loss: 1.458 Vali Acc: 0.480 Test Loss: 1.458 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.53457498550415
Epoch: 16, Steps: 20 | Train Loss: 0.438 Vali Loss: 1.414 Vali Acc: 0.540 Test Loss: 1.414 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.399953603744507
Epoch: 17, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.612 Vali Acc: 0.510 Test Loss: 1.612 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.401142835617065
Epoch: 18, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.994 Vali Acc: 0.480 Test Loss: 1.994 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.6864333152771
Epoch: 19, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.617 Vali Acc: 0.530 Test Loss: 1.617 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.938184976577759
Epoch: 20, Steps: 20 | Train Loss: 0.303 Vali Loss: 1.760 Vali Acc: 0.520 Test Loss: 1.760 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.068336009979248
Epoch: 21, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.934 Vali Acc: 0.560 Test Loss: 1.934 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.557354927062988
Epoch: 22, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.627 Vali Acc: 0.600 Test Loss: 1.627 Test Acc: 0.600
Validation loss decreased (-0.569988 --> -0.599984).  Saving model ...
Epoch: 23 cost time: 5.521914720535278
Epoch: 23, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.693 Vali Acc: 0.570 Test Loss: 1.693 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.578206300735474
Epoch: 24, Steps: 20 | Train Loss: 0.267 Vali Loss: 2.257 Vali Acc: 0.560 Test Loss: 2.257 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.155962944030762
Epoch: 25, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.994 Vali Acc: 0.560 Test Loss: 1.994 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.890890121459961
Epoch: 26, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.541 Vali Acc: 0.580 Test Loss: 1.541 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.220582962036133
Epoch: 27, Steps: 20 | Train Loss: 0.107 Vali Loss: 2.420 Vali Acc: 0.470 Test Loss: 2.420 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.4268200397491455
Epoch: 28, Steps: 20 | Train Loss: 0.128 Vali Loss: 2.467 Vali Acc: 0.490 Test Loss: 2.467 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.58864426612854
Epoch: 29, Steps: 20 | Train Loss: 0.079 Vali Loss: 1.923 Vali Acc: 0.570 Test Loss: 1.923 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.170554161071777
Epoch: 30, Steps: 20 | Train Loss: 0.071 Vali Loss: 2.202 Vali Acc: 0.580 Test Loss: 2.202 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.436608076095581
Epoch: 31, Steps: 20 | Train Loss: 0.110 Vali Loss: 2.641 Vali Acc: 0.450 Test Loss: 2.641 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.80230975151062
Epoch: 32, Steps: 20 | Train Loss: 0.089 Vali Loss: 2.207 Vali Acc: 0.570 Test Loss: 2.207 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.514285564422607
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.890345811843872
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 5.2703540325164795
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 5.303358793258667
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.140170335769653
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.035459041595459
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.29136323928833
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.298624038696289
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.28989315032959
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.536999464035034
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.3932294845581055
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.078655242919922
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.782403945922852
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 2697474
model size : 20.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.7311577796936035
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.573877334594727
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.766 Vali Acc: 0.500 Test Loss: 0.766 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.424036026000977
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.864 Vali Acc: 0.490 Test Loss: 0.864 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.309250116348267
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.819 Vali Acc: 0.500 Test Loss: 0.819 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.957887172698975
Epoch: 5, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.178834676742554
Epoch: 6, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 5.06825852394104
Epoch: 7, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.893 Vali Acc: 0.510 Test Loss: 0.893 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.2139081954956055
Epoch: 8, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.339507579803467
Epoch: 9, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.883 Vali Acc: 0.470 Test Loss: 0.883 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.210256338119507
Epoch: 10, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.917 Vali Acc: 0.510 Test Loss: 0.917 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.149942874908447
Epoch: 11, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.043 Vali Acc: 0.540 Test Loss: 1.043 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.287895202636719
Epoch: 12, Steps: 20 | Train Loss: 0.396 Vali Loss: 1.205 Vali Acc: 0.580 Test Loss: 1.205 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579988).  Saving model ...
Epoch: 13 cost time: 5.163034677505493
Epoch: 13, Steps: 20 | Train Loss: 0.534 Vali Loss: 1.242 Vali Acc: 0.570 Test Loss: 1.242 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.837057113647461
Epoch: 14, Steps: 20 | Train Loss: 0.377 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.516244411468506
Epoch: 15, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.084 Vali Acc: 0.540 Test Loss: 1.084 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.447190523147583
Epoch: 16, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.218 Vali Acc: 0.580 Test Loss: 1.218 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.242034435272217
Epoch: 17, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.423 Vali Acc: 0.550 Test Loss: 1.423 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.988698482513428
Epoch: 18, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.253 Vali Acc: 0.510 Test Loss: 1.253 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.906820058822632
Epoch: 19, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.409 Vali Acc: 0.530 Test Loss: 1.409 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.971584320068359
Epoch: 20, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.379 Vali Acc: 0.570 Test Loss: 1.379 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.945395231246948
Epoch: 21, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.673 Vali Acc: 0.550 Test Loss: 1.673 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.330912351608276
Epoch: 22, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.839 Vali Acc: 0.560 Test Loss: 1.839 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.075543642044067
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.901334524154663
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 4.963317394256592
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.869 Vali Acc: 0.510 Test Loss: 0.869 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.000447034835815
Epoch: 4, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.819 Vali Acc: 0.450 Test Loss: 0.819 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.161236047744751
Epoch: 5, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.858 Vali Acc: 0.480 Test Loss: 0.858 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.403548002243042
Epoch: 6, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.833 Vali Acc: 0.470 Test Loss: 0.833 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.335522890090942
Epoch: 7, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.880 Vali Acc: 0.520 Test Loss: 0.880 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 8 cost time: 5.392310857772827
Epoch: 8, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.871 Vali Acc: 0.490 Test Loss: 0.871 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.559490203857422
Epoch: 9, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.916 Vali Acc: 0.510 Test Loss: 0.916 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.178403854370117
Epoch: 10, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.889 Vali Acc: 0.550 Test Loss: 0.889 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549991).  Saving model ...
Epoch: 11 cost time: 5.002390384674072
Epoch: 11, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.073 Vali Acc: 0.560 Test Loss: 1.073 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559989).  Saving model ...
Epoch: 12 cost time: 5.064603805541992
Epoch: 12, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.072 Vali Acc: 0.520 Test Loss: 1.072 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.387907028198242
Epoch: 13, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.062 Vali Acc: 0.540 Test Loss: 1.062 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.515321731567383
Epoch: 14, Steps: 20 | Train Loss: 0.373 Vali Loss: 1.136 Vali Acc: 0.590 Test Loss: 1.136 Test Acc: 0.590
Validation loss decreased (-0.559989 --> -0.589989).  Saving model ...
Epoch: 15 cost time: 5.150059461593628
Epoch: 15, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.080 Vali Acc: 0.560 Test Loss: 1.080 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.152217149734497
Epoch: 16, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.216 Vali Acc: 0.530 Test Loss: 1.216 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.2459940910339355
Epoch: 17, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.498 Vali Acc: 0.550 Test Loss: 1.498 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.874953508377075
Epoch: 18, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.302 Vali Acc: 0.580 Test Loss: 1.302 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.843982458114624
Epoch: 19, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.568 Vali Acc: 0.550 Test Loss: 1.568 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.987608194351196
Epoch: 20, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.452 Vali Acc: 0.560 Test Loss: 1.452 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.053480625152588
Epoch: 21, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.750 Vali Acc: 0.580 Test Loss: 1.750 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.346877574920654
Epoch: 22, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.596 Vali Acc: 0.570 Test Loss: 1.596 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.636196136474609
Epoch: 23, Steps: 20 | Train Loss: 0.140 Vali Loss: 2.025 Vali Acc: 0.520 Test Loss: 2.025 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.746251583099365
Epoch: 24, Steps: 20 | Train Loss: 0.111 Vali Loss: 1.625 Vali Acc: 0.550 Test Loss: 1.625 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.941538095474243
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.710 Vali Acc: 0.460 Test Loss: 0.710 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 5.025173902511597
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
Validation loss decreased (-0.459993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 5.083787441253662
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.827 Vali Acc: 0.520 Test Loss: 0.827 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.040019273757935
Epoch: 4, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.302572727203369
Epoch: 5, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.827 Vali Acc: 0.560 Test Loss: 0.827 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 5.282837152481079
Epoch: 6, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.829 Vali Acc: 0.450 Test Loss: 0.829 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.296202898025513
Epoch: 7, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.865 Vali Acc: 0.520 Test Loss: 0.865 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.184319972991943
Epoch: 8, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.881842613220215
Epoch: 9, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.820 Vali Acc: 0.630 Test Loss: 0.820 Test Acc: 0.630
Validation loss decreased (-0.559992 --> -0.629992).  Saving model ...
Epoch: 10 cost time: 4.807908058166504
Epoch: 10, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.824 Vali Acc: 0.560 Test Loss: 0.824 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.004858732223511
Epoch: 11, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.875 Vali Acc: 0.590 Test Loss: 0.875 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.737385511398315
Epoch: 12, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.981 Vali Acc: 0.590 Test Loss: 0.981 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.168079376220703
Epoch: 13, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.034 Vali Acc: 0.620 Test Loss: 1.034 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.480726718902588
Epoch: 14, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.943 Vali Acc: 0.560 Test Loss: 0.943 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.577877521514893
Epoch: 15, Steps: 20 | Train Loss: 0.353 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.419638156890869
Epoch: 16, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.147 Vali Acc: 0.530 Test Loss: 1.147 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.282258033752441
Epoch: 17, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.402 Vali Acc: 0.600 Test Loss: 1.402 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.045490264892578
Epoch: 18, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.228 Vali Acc: 0.560 Test Loss: 1.228 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.408695697784424
Epoch: 19, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.292 Vali Acc: 0.530 Test Loss: 1.292 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.691766738891602
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.807581424713135
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.538101673126221
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 5.2489073276519775
Epoch: 4, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.837 Vali Acc: 0.440 Test Loss: 0.837 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.250840663909912
Epoch: 5, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529992).  Saving model ...
Epoch: 6 cost time: 5.341476917266846
Epoch: 6, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.831 Vali Acc: 0.440 Test Loss: 0.831 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.452733278274536
Epoch: 7, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.861 Vali Acc: 0.550 Test Loss: 0.861 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 8 cost time: 5.444484710693359
Epoch: 8, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.286521673202515
Epoch: 9, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.824 Vali Acc: 0.570 Test Loss: 0.824 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 5.941405534744263
Epoch: 10, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.875 Vali Acc: 0.550 Test Loss: 0.875 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.132364273071289
Epoch: 11, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.947 Vali Acc: 0.560 Test Loss: 0.947 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.113744020462036
Epoch: 12, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.086 Vali Acc: 0.530 Test Loss: 1.086 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.069361448287964
Epoch: 13, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.869 Vali Acc: 0.530 Test Loss: 0.869 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.675258636474609
Epoch: 14, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.984 Vali Acc: 0.620 Test Loss: 0.984 Test Acc: 0.620
Validation loss decreased (-0.569992 --> -0.619990).  Saving model ...
Epoch: 15 cost time: 5.575088262557983
Epoch: 15, Steps: 20 | Train Loss: 0.324 Vali Loss: 1.131 Vali Acc: 0.570 Test Loss: 1.131 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.338286638259888
Epoch: 16, Steps: 20 | Train Loss: 0.325 Vali Loss: 1.070 Vali Acc: 0.560 Test Loss: 1.070 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.984310626983643
Epoch: 17, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.457 Vali Acc: 0.530 Test Loss: 1.457 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.933878421783447
Epoch: 18, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.377 Vali Acc: 0.470 Test Loss: 1.377 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.499998331069946
Epoch: 19, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.676 Vali Acc: 0.450 Test Loss: 1.676 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.0935540199279785
Epoch: 20, Steps: 20 | Train Loss: 0.189 Vali Loss: 1.449 Vali Acc: 0.580 Test Loss: 1.449 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.278800964355469
Epoch: 21, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.720 Vali Acc: 0.540 Test Loss: 1.720 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.082406282424927
Epoch: 22, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.575 Vali Acc: 0.590 Test Loss: 1.575 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.480467319488525
Epoch: 23, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.870 Vali Acc: 0.540 Test Loss: 1.870 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.601365089416504
Epoch: 24, Steps: 20 | Train Loss: 0.111 Vali Loss: 2.233 Vali Acc: 0.520 Test Loss: 2.233 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.887192964553833
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.760 Vali Acc: 0.470 Test Loss: 0.760 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 5.415858268737793
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.839 Vali Acc: 0.520 Test Loss: 0.839 Test Acc: 0.520
Validation loss decreased (-0.469992 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 5.445214509963989
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.971 Vali Acc: 0.490 Test Loss: 0.971 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.989825487136841
Epoch: 4, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.876 Vali Acc: 0.460 Test Loss: 0.876 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.928813934326172
Epoch: 5, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.979 Vali Acc: 0.450 Test Loss: 0.979 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.938360691070557
Epoch: 6, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.970 Vali Acc: 0.440 Test Loss: 0.970 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.145279884338379
Epoch: 7, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.924 Vali Acc: 0.520 Test Loss: 0.924 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.738456964492798
Epoch: 8, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.009 Vali Acc: 0.540 Test Loss: 1.009 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539990).  Saving model ...
Epoch: 9 cost time: 5.448180675506592
Epoch: 9, Steps: 20 | Train Loss: 0.536 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
Validation loss decreased (-0.539990 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 5.828066349029541
Epoch: 10, Steps: 20 | Train Loss: 0.504 Vali Loss: 1.031 Vali Acc: 0.570 Test Loss: 1.031 Test Acc: 0.570
Validation loss decreased (-0.549989 --> -0.569990).  Saving model ...
Epoch: 11 cost time: 5.822795391082764
Epoch: 11, Steps: 20 | Train Loss: 0.440 Vali Loss: 1.052 Vali Acc: 0.530 Test Loss: 1.052 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.853259563446045
Epoch: 12, Steps: 20 | Train Loss: 0.459 Vali Loss: 1.047 Vali Acc: 0.590 Test Loss: 1.047 Test Acc: 0.590
Validation loss decreased (-0.569990 --> -0.589990).  Saving model ...
Epoch: 13 cost time: 5.698878526687622
Epoch: 13, Steps: 20 | Train Loss: 0.479 Vali Loss: 1.130 Vali Acc: 0.550 Test Loss: 1.130 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.902926683425903
Epoch: 14, Steps: 20 | Train Loss: 0.432 Vali Loss: 1.301 Vali Acc: 0.530 Test Loss: 1.301 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.425782918930054
Epoch: 15, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.167 Vali Acc: 0.590 Test Loss: 1.167 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.162132263183594
Epoch: 16, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.275 Vali Acc: 0.560 Test Loss: 1.275 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.470869302749634
Epoch: 17, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.609 Vali Acc: 0.510 Test Loss: 1.609 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.274464130401611
Epoch: 18, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.548 Vali Acc: 0.540 Test Loss: 1.548 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.646894931793213
Epoch: 19, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.022217273712158
Epoch: 20, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.717 Vali Acc: 0.570 Test Loss: 1.717 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.542479038238525
Epoch: 21, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.598 Vali Acc: 0.530 Test Loss: 1.598 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.471588611602783
Epoch: 22, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.816 Vali Acc: 0.560 Test Loss: 1.816 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.8440024852752686
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.691 Vali Acc: 0.580 Test Loss: 0.691 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 5.372422456741333
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.917699813842773
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.806009292602539
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.857429504394531
Epoch: 5, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.772 Vali Acc: 0.590 Test Loss: 0.772 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 5.442221403121948
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.164491891860962
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.802 Vali Acc: 0.560 Test Loss: 0.802 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.340289831161499
Epoch: 8, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.502929449081421
Epoch: 9, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.843681812286377
Epoch: 10, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.918 Vali Acc: 0.600 Test Loss: 0.918 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599991).  Saving model ...
Epoch: 11 cost time: 5.878813982009888
Epoch: 11, Steps: 20 | Train Loss: 0.519 Vali Loss: 1.219 Vali Acc: 0.570 Test Loss: 1.219 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.7316575050354
Epoch: 12, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.994 Vali Acc: 0.580 Test Loss: 0.994 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.632867336273193
Epoch: 13, Steps: 20 | Train Loss: 0.572 Vali Loss: 1.110 Vali Acc: 0.610 Test Loss: 1.110 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609989).  Saving model ...
Epoch: 14 cost time: 5.234720706939697
Epoch: 14, Steps: 20 | Train Loss: 0.504 Vali Loss: 1.375 Vali Acc: 0.560 Test Loss: 1.375 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.025234222412109
Epoch: 15, Steps: 20 | Train Loss: 0.542 Vali Loss: 1.266 Vali Acc: 0.580 Test Loss: 1.266 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.987053155899048
Epoch: 16, Steps: 20 | Train Loss: 0.465 Vali Loss: 1.290 Vali Acc: 0.580 Test Loss: 1.290 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.995552062988281
Epoch: 17, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.200 Vali Acc: 0.560 Test Loss: 1.200 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.707363843917847
Epoch: 18, Steps: 20 | Train Loss: 0.418 Vali Loss: 1.456 Vali Acc: 0.550 Test Loss: 1.456 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.517322540283203
Epoch: 19, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.636 Vali Acc: 0.530 Test Loss: 1.636 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.729574918746948
Epoch: 20, Steps: 20 | Train Loss: 0.421 Vali Loss: 1.458 Vali Acc: 0.610 Test Loss: 1.458 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.4567811489105225
Epoch: 21, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.320 Vali Acc: 0.580 Test Loss: 1.320 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.896848678588867
Epoch: 22, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.528 Vali Acc: 0.610 Test Loss: 1.528 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.313226938247681
Epoch: 23, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.858 Vali Acc: 0.520 Test Loss: 1.858 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.303004503250122
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.699 Vali Acc: 0.570 Test Loss: 0.699 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 5.544631481170654
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.9669413566589355
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.089481353759766
Epoch: 4, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.9605183601379395
Epoch: 5, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.829 Vali Acc: 0.560 Test Loss: 0.829 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.754720211029053
Epoch: 6, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.818 Vali Acc: 0.550 Test Loss: 0.818 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.642870664596558
Epoch: 7, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.834 Vali Acc: 0.580 Test Loss: 0.834 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 8 cost time: 5.44053053855896
Epoch: 8, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.908 Vali Acc: 0.600 Test Loss: 0.908 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599991).  Saving model ...
Epoch: 9 cost time: 5.286582946777344
Epoch: 9, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.935 Vali Acc: 0.530 Test Loss: 0.935 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.029703378677368
Epoch: 10, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.994 Vali Acc: 0.540 Test Loss: 0.994 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.652852296829224
Epoch: 11, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.095 Vali Acc: 0.600 Test Loss: 1.095 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.540501117706299
Epoch: 12, Steps: 20 | Train Loss: 0.525 Vali Loss: 1.003 Vali Acc: 0.560 Test Loss: 1.003 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.954494953155518
Epoch: 13, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.713759183883667
Epoch: 14, Steps: 20 | Train Loss: 0.471 Vali Loss: 1.291 Vali Acc: 0.590 Test Loss: 1.291 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.626852750778198
Epoch: 15, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.299 Vali Acc: 0.550 Test Loss: 1.299 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.566606283187866
Epoch: 16, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.260 Vali Acc: 0.620 Test Loss: 1.260 Test Acc: 0.620
Validation loss decreased (-0.599991 --> -0.619987).  Saving model ...
Epoch: 17 cost time: 5.433727502822876
Epoch: 17, Steps: 20 | Train Loss: 0.399 Vali Loss: 1.428 Vali Acc: 0.560 Test Loss: 1.428 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.544260263442993
Epoch: 18, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.594 Vali Acc: 0.550 Test Loss: 1.594 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.3808205127716064
Epoch: 19, Steps: 20 | Train Loss: 0.352 Vali Loss: 1.338 Vali Acc: 0.580 Test Loss: 1.338 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.935630559921265
Epoch: 20, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.416 Vali Acc: 0.610 Test Loss: 1.416 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.391330003738403
Epoch: 21, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.442 Vali Acc: 0.570 Test Loss: 1.442 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.2114105224609375
Epoch: 22, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.595 Vali Acc: 0.630 Test Loss: 1.595 Test Acc: 0.630
Validation loss decreased (-0.619987 --> -0.629984).  Saving model ...
Epoch: 23 cost time: 5.451808214187622
Epoch: 23, Steps: 20 | Train Loss: 0.262 Vali Loss: 2.149 Vali Acc: 0.480 Test Loss: 2.149 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.059871435165405
Epoch: 24, Steps: 20 | Train Loss: 0.177 Vali Loss: 1.469 Vali Acc: 0.630 Test Loss: 1.469 Test Acc: 0.630
Validation loss decreased (-0.629984 --> -0.629985).  Saving model ...
Epoch: 25 cost time: 5.3023810386657715
Epoch: 25, Steps: 20 | Train Loss: 0.219 Vali Loss: 1.802 Vali Acc: 0.620 Test Loss: 1.802 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.020126581192017
Epoch: 26, Steps: 20 | Train Loss: 0.128 Vali Loss: 2.393 Vali Acc: 0.540 Test Loss: 2.393 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.142923355102539
Epoch: 27, Steps: 20 | Train Loss: 0.174 Vali Loss: 2.697 Vali Acc: 0.570 Test Loss: 2.697 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.396211862564087
Epoch: 28, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.884 Vali Acc: 0.660 Test Loss: 1.884 Test Acc: 0.660
Validation loss decreased (-0.629985 --> -0.659981).  Saving model ...
Epoch: 29 cost time: 5.351046323776245
Epoch: 29, Steps: 20 | Train Loss: 0.134 Vali Loss: 2.930 Vali Acc: 0.570 Test Loss: 2.930 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.641974687576294
Epoch: 30, Steps: 20 | Train Loss: 0.115 Vali Loss: 1.922 Vali Acc: 0.570 Test Loss: 1.922 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.79398775100708
Epoch: 31, Steps: 20 | Train Loss: 0.060 Vali Loss: 2.241 Vali Acc: 0.580 Test Loss: 2.241 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.180494070053101
Epoch: 32, Steps: 20 | Train Loss: 0.063 Vali Loss: 2.677 Vali Acc: 0.510 Test Loss: 2.677 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.466392517089844
Epoch: 33, Steps: 20 | Train Loss: 0.047 Vali Loss: 2.371 Vali Acc: 0.580 Test Loss: 2.371 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.967369318008423
Epoch: 34, Steps: 20 | Train Loss: 0.030 Vali Loss: 2.639 Vali Acc: 0.550 Test Loss: 2.639 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.551378011703491
Epoch: 35, Steps: 20 | Train Loss: 0.032 Vali Loss: 2.353 Vali Acc: 0.540 Test Loss: 2.353 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 5.737074136734009
Epoch: 36, Steps: 20 | Train Loss: 0.022 Vali Loss: 2.624 Vali Acc: 0.550 Test Loss: 2.624 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 5.518098592758179
Epoch: 37, Steps: 20 | Train Loss: 0.033 Vali Loss: 2.366 Vali Acc: 0.540 Test Loss: 2.366 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.654905557632446
Epoch: 38, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.781 Vali Acc: 0.540 Test Loss: 2.781 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.559925556182861
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 4.950453996658325
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 5.1178505420684814
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.9106433391571045
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.571071624755859
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.499182224273682
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.144463777542114
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.844457626342773
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.326592206954956
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.247343063354492
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.509570360183716
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.548149824142456
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 2304258
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.130937576293945
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.503843545913696
Epoch: 2, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.795 Vali Acc: 0.530 Test Loss: 0.795 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 5.535704851150513
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.889189004898071
Epoch: 4, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.814 Vali Acc: 0.460 Test Loss: 0.814 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.87972617149353
Epoch: 5, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.962 Vali Acc: 0.520 Test Loss: 0.962 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.648035764694214
Epoch: 6, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.864 Vali Acc: 0.490 Test Loss: 0.864 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.7617738246917725
Epoch: 7, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.828 Vali Acc: 0.510 Test Loss: 0.828 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.5200111865997314
Epoch: 8, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.959 Vali Acc: 0.500 Test Loss: 0.959 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.019865274429321
Epoch: 9, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.997054815292358
Epoch: 10, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.925 Vali Acc: 0.550 Test Loss: 0.925 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 11 cost time: 4.9807751178741455
Epoch: 11, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.962 Vali Acc: 0.480 Test Loss: 0.962 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.243805170059204
Epoch: 12, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.933 Vali Acc: 0.510 Test Loss: 0.933 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.984018564224243
Epoch: 13, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.872 Vali Acc: 0.520 Test Loss: 0.872 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.615035057067871
Epoch: 14, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.139 Vali Acc: 0.560 Test Loss: 1.139 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559989).  Saving model ...
Epoch: 15 cost time: 5.406811237335205
Epoch: 15, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.018 Vali Acc: 0.580 Test Loss: 1.018 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579990).  Saving model ...
Epoch: 16 cost time: 5.178263902664185
Epoch: 16, Steps: 20 | Train Loss: 0.360 Vali Loss: 1.098 Vali Acc: 0.490 Test Loss: 1.098 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.221806764602661
Epoch: 17, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.63147234916687
Epoch: 18, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.164 Vali Acc: 0.590 Test Loss: 1.164 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589988).  Saving model ...
Epoch: 19 cost time: 5.632793426513672
Epoch: 19, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.725660085678101
Epoch: 20, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.229 Vali Acc: 0.540 Test Loss: 1.229 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.631349802017212
Epoch: 21, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.514 Vali Acc: 0.500 Test Loss: 1.514 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.51344108581543
Epoch: 22, Steps: 20 | Train Loss: 0.174 Vali Loss: 1.496 Vali Acc: 0.570 Test Loss: 1.496 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.692030191421509
Epoch: 23, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.593 Vali Acc: 0.490 Test Loss: 1.593 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.194303274154663
Epoch: 24, Steps: 20 | Train Loss: 0.107 Vali Loss: 1.549 Vali Acc: 0.580 Test Loss: 1.549 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.825205326080322
Epoch: 25, Steps: 20 | Train Loss: 0.104 Vali Loss: 2.058 Vali Acc: 0.480 Test Loss: 2.058 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.227313995361328
Epoch: 26, Steps: 20 | Train Loss: 0.079 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.836240530014038
Epoch: 27, Steps: 20 | Train Loss: 0.054 Vali Loss: 2.141 Vali Acc: 0.540 Test Loss: 2.141 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.441928863525391
Epoch: 28, Steps: 20 | Train Loss: 0.061 Vali Loss: 2.259 Vali Acc: 0.530 Test Loss: 2.259 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.893625020980835
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.734 Vali Acc: 0.470 Test Loss: 0.734 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 4.812717437744141
Epoch: 2, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.806793212890625
Epoch: 3, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.829 Vali Acc: 0.470 Test Loss: 0.829 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.849700689315796
Epoch: 4, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.830 Vali Acc: 0.450 Test Loss: 0.830 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.015171051025391
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519990).  Saving model ...
Epoch: 6 cost time: 5.403909683227539
Epoch: 6, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.866 Vali Acc: 0.490 Test Loss: 0.866 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.360244989395142
Epoch: 7, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.861 Vali Acc: 0.500 Test Loss: 0.861 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.416364431381226
Epoch: 8, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.907 Vali Acc: 0.460 Test Loss: 0.907 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.501118421554565
Epoch: 9, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.921 Vali Acc: 0.500 Test Loss: 0.921 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.122760534286499
Epoch: 10, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.972 Vali Acc: 0.570 Test Loss: 0.972 Test Acc: 0.570
Validation loss decreased (-0.519990 --> -0.569990).  Saving model ...
Epoch: 11 cost time: 5.0169432163238525
Epoch: 11, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.985 Vali Acc: 0.500 Test Loss: 0.985 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.091102600097656
Epoch: 12, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.972 Vali Acc: 0.510 Test Loss: 0.972 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.023756265640259
Epoch: 13, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.837 Vali Acc: 0.570 Test Loss: 0.837 Test Acc: 0.570
Validation loss decreased (-0.569990 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 5.232704162597656
Epoch: 14, Steps: 20 | Train Loss: 0.332 Vali Loss: 1.156 Vali Acc: 0.510 Test Loss: 1.156 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.499283075332642
Epoch: 15, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.037 Vali Acc: 0.520 Test Loss: 1.037 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.541638374328613
Epoch: 16, Steps: 20 | Train Loss: 0.302 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.844533920288086
Epoch: 17, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.596 Vali Acc: 0.490 Test Loss: 1.596 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.1241774559021
Epoch: 18, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.252 Vali Acc: 0.560 Test Loss: 1.252 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.116219520568848
Epoch: 19, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.432 Vali Acc: 0.520 Test Loss: 1.432 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.274864196777344
Epoch: 20, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.224 Vali Acc: 0.580 Test Loss: 1.224 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579988).  Saving model ...
Epoch: 21 cost time: 5.283878564834595
Epoch: 21, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.915 Vali Acc: 0.540 Test Loss: 1.915 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.710966348648071
Epoch: 22, Steps: 20 | Train Loss: 0.154 Vali Loss: 1.519 Vali Acc: 0.540 Test Loss: 1.519 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.407952547073364
Epoch: 23, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.542 Vali Acc: 0.560 Test Loss: 1.542 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.664018630981445
Epoch: 24, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.562 Vali Acc: 0.580 Test Loss: 1.562 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.549076557159424
Epoch: 25, Steps: 20 | Train Loss: 0.093 Vali Loss: 2.155 Vali Acc: 0.570 Test Loss: 2.155 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.314736843109131
Epoch: 26, Steps: 20 | Train Loss: 0.092 Vali Loss: 1.739 Vali Acc: 0.540 Test Loss: 1.739 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.324220180511475
Epoch: 27, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.993 Vali Acc: 0.540 Test Loss: 1.993 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.1407365798950195
Epoch: 28, Steps: 20 | Train Loss: 0.042 Vali Loss: 2.180 Vali Acc: 0.540 Test Loss: 2.180 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.485462665557861
Epoch: 29, Steps: 20 | Train Loss: 0.026 Vali Loss: 2.019 Vali Acc: 0.550 Test Loss: 2.019 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.594956874847412
Epoch: 30, Steps: 20 | Train Loss: 0.034 Vali Loss: 2.347 Vali Acc: 0.560 Test Loss: 2.347 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.813564777374268
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.753 Vali Acc: 0.490 Test Loss: 0.753 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 5.159946441650391
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 5.237910509109497
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.850 Vali Acc: 0.450 Test Loss: 0.850 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.089310169219971
Epoch: 4, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.856 Vali Acc: 0.460 Test Loss: 0.856 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.3670313358306885
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.914 Vali Acc: 0.480 Test Loss: 0.914 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.513962268829346
Epoch: 6, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.850 Vali Acc: 0.540 Test Loss: 0.850 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539992).  Saving model ...
Epoch: 7 cost time: 5.095240831375122
Epoch: 7, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.876 Vali Acc: 0.510 Test Loss: 0.876 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.2772297859191895
Epoch: 8, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.926 Vali Acc: 0.500 Test Loss: 0.926 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.068201303482056
Epoch: 9, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.840229511260986
Epoch: 10, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.880 Vali Acc: 0.520 Test Loss: 0.880 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.90545654296875
Epoch: 11, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.963 Vali Acc: 0.470 Test Loss: 0.963 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.500272750854492
Epoch: 12, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.863 Vali Acc: 0.530 Test Loss: 0.863 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.356381177902222
Epoch: 13, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.883 Vali Acc: 0.530 Test Loss: 0.883 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.5060789585113525
Epoch: 14, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.072 Vali Acc: 0.530 Test Loss: 1.072 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.922537326812744
Epoch: 15, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.939 Vali Acc: 0.580 Test Loss: 0.939 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579991).  Saving model ...
Epoch: 16 cost time: 5.042853593826294
Epoch: 16, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.089 Vali Acc: 0.530 Test Loss: 1.089 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.937718152999878
Epoch: 17, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.84057354927063
Epoch: 18, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.115 Vali Acc: 0.590 Test Loss: 1.115 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589989).  Saving model ...
Epoch: 19 cost time: 5.583586692810059
Epoch: 19, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.187 Vali Acc: 0.530 Test Loss: 1.187 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.449892520904541
Epoch: 20, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.497 Vali Acc: 0.590 Test Loss: 1.497 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.329533576965332
Epoch: 21, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.390 Vali Acc: 0.590 Test Loss: 1.390 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.373064994812012
Epoch: 22, Steps: 20 | Train Loss: 0.120 Vali Loss: 1.350 Vali Acc: 0.570 Test Loss: 1.350 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.146267890930176
Epoch: 23, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.973 Vali Acc: 0.520 Test Loss: 1.973 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.234451055526733
Epoch: 24, Steps: 20 | Train Loss: 0.085 Vali Loss: 1.432 Vali Acc: 0.600 Test Loss: 1.432 Test Acc: 0.600
Validation loss decreased (-0.589989 --> -0.599986).  Saving model ...
Epoch: 25 cost time: 5.2579665184021
Epoch: 25, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.778 Vali Acc: 0.610 Test Loss: 1.778 Test Acc: 0.610
Validation loss decreased (-0.599986 --> -0.609982).  Saving model ...
Epoch: 26 cost time: 5.2590672969818115
Epoch: 26, Steps: 20 | Train Loss: 0.090 Vali Loss: 1.847 Vali Acc: 0.550 Test Loss: 1.847 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.527434349060059
Epoch: 27, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.787 Vali Acc: 0.510 Test Loss: 1.787 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.358999252319336
Epoch: 28, Steps: 20 | Train Loss: 0.038 Vali Loss: 2.409 Vali Acc: 0.500 Test Loss: 2.409 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.519637584686279
Epoch: 29, Steps: 20 | Train Loss: 0.059 Vali Loss: 1.926 Vali Acc: 0.560 Test Loss: 1.926 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.357843637466431
Epoch: 30, Steps: 20 | Train Loss: 0.051 Vali Loss: 2.170 Vali Acc: 0.560 Test Loss: 2.170 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.2360076904296875
Epoch: 31, Steps: 20 | Train Loss: 0.030 Vali Loss: 2.226 Vali Acc: 0.550 Test Loss: 2.226 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.954670667648315
Epoch: 32, Steps: 20 | Train Loss: 0.048 Vali Loss: 2.201 Vali Acc: 0.580 Test Loss: 2.201 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.917370796203613
Epoch: 33, Steps: 20 | Train Loss: 0.023 Vali Loss: 2.511 Vali Acc: 0.530 Test Loss: 2.511 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.99743127822876
Epoch: 34, Steps: 20 | Train Loss: 0.029 Vali Loss: 2.225 Vali Acc: 0.550 Test Loss: 2.225 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.227033853530884
Epoch: 35, Steps: 20 | Train Loss: 0.018 Vali Loss: 2.129 Vali Acc: 0.600 Test Loss: 2.129 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.1982598304748535
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.754 Vali Acc: 0.490 Test Loss: 0.754 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 4.970422267913818
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.9671454429626465
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.859 Vali Acc: 0.490 Test Loss: 0.859 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.059187889099121
Epoch: 4, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.839 Vali Acc: 0.490 Test Loss: 0.839 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.714945316314697
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.948 Vali Acc: 0.480 Test Loss: 0.948 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.64598822593689
Epoch: 6, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.860 Vali Acc: 0.510 Test Loss: 0.860 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509991).  Saving model ...
Epoch: 7 cost time: 5.5500428676605225
Epoch: 7, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
Validation loss decreased (-0.509991 --> -0.529991).  Saving model ...
Epoch: 8 cost time: 5.2590014934539795
Epoch: 8, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.947 Vali Acc: 0.490 Test Loss: 0.947 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.973362684249878
Epoch: 9, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.896 Vali Acc: 0.500 Test Loss: 0.896 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.929504156112671
Epoch: 10, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.907 Vali Acc: 0.480 Test Loss: 0.907 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.101463079452515
Epoch: 11, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.962 Vali Acc: 0.510 Test Loss: 0.962 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.164731979370117
Epoch: 12, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.004 Vali Acc: 0.510 Test Loss: 1.004 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.689019441604614
Epoch: 13, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.909 Vali Acc: 0.530 Test Loss: 0.909 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.432450771331787
Epoch: 14, Steps: 20 | Train Loss: 0.343 Vali Loss: 1.235 Vali Acc: 0.530 Test Loss: 1.235 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.176343202590942
Epoch: 15, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.019 Vali Acc: 0.540 Test Loss: 1.019 Test Acc: 0.540
Validation loss decreased (-0.529991 --> -0.539990).  Saving model ...
Epoch: 16 cost time: 5.2205517292022705
Epoch: 16, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.011 Vali Acc: 0.520 Test Loss: 1.011 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.062899112701416
Epoch: 17, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.249 Vali Acc: 0.530 Test Loss: 1.249 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.018625259399414
Epoch: 18, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
Validation loss decreased (-0.539990 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 5.009300231933594
Epoch: 19, Steps: 20 | Train Loss: 0.214 Vali Loss: 1.425 Vali Acc: 0.510 Test Loss: 1.425 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.17653226852417
Epoch: 20, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.612 Vali Acc: 0.580 Test Loss: 1.612 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.23810076713562
Epoch: 21, Steps: 20 | Train Loss: 0.160 Vali Loss: 1.791 Vali Acc: 0.500 Test Loss: 1.791 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.362914562225342
Epoch: 22, Steps: 20 | Train Loss: 0.153 Vali Loss: 1.881 Vali Acc: 0.500 Test Loss: 1.881 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.328778266906738
Epoch: 23, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.853 Vali Acc: 0.540 Test Loss: 1.853 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.1181535720825195
Epoch: 24, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.482 Vali Acc: 0.580 Test Loss: 1.482 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.1246864795684814
Epoch: 25, Steps: 20 | Train Loss: 0.115 Vali Loss: 2.414 Vali Acc: 0.550 Test Loss: 2.414 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.070821285247803
Epoch: 26, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.966 Vali Acc: 0.550 Test Loss: 1.966 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.012246131896973
Epoch: 27, Steps: 20 | Train Loss: 0.044 Vali Loss: 2.112 Vali Acc: 0.560 Test Loss: 2.112 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.59785795211792
Epoch: 28, Steps: 20 | Train Loss: 0.042 Vali Loss: 2.243 Vali Acc: 0.530 Test Loss: 2.243 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.11052393913269
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.761 Vali Acc: 0.450 Test Loss: 0.761 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 5.282761812210083
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.859 Vali Acc: 0.470 Test Loss: 0.859 Test Acc: 0.470
Validation loss decreased (-0.449992 --> -0.469991).  Saving model ...
Epoch: 3 cost time: 5.062185287475586
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.905 Vali Acc: 0.470 Test Loss: 0.905 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.775512218475342
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.904 Vali Acc: 0.470 Test Loss: 0.904 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.806295394897461
Epoch: 5, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.961 Vali Acc: 0.480 Test Loss: 0.961 Test Acc: 0.480
Validation loss decreased (-0.469991 --> -0.479990).  Saving model ...
Epoch: 6 cost time: 5.703620195388794
Epoch: 6, Steps: 20 | Train Loss: 0.562 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
Validation loss decreased (-0.479990 --> -0.499990).  Saving model ...
Epoch: 7 cost time: 5.232126951217651
Epoch: 7, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.981 Vali Acc: 0.550 Test Loss: 0.981 Test Acc: 0.550
Validation loss decreased (-0.499990 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 5.3905909061431885
Epoch: 8, Steps: 20 | Train Loss: 0.544 Vali Loss: 1.067 Vali Acc: 0.510 Test Loss: 1.067 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.412424564361572
Epoch: 9, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.992 Vali Acc: 0.510 Test Loss: 0.992 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.212886333465576
Epoch: 10, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.039 Vali Acc: 0.510 Test Loss: 1.039 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.152909755706787
Epoch: 11, Steps: 20 | Train Loss: 0.500 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.8655946254730225
Epoch: 12, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.252357482910156
Epoch: 13, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.953 Vali Acc: 0.590 Test Loss: 0.953 Test Acc: 0.590
Validation loss decreased (-0.549990 --> -0.589990).  Saving model ...
Epoch: 14 cost time: 5.3823606967926025
Epoch: 14, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.349 Vali Acc: 0.530 Test Loss: 1.349 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.6286561489105225
Epoch: 15, Steps: 20 | Train Loss: 0.391 Vali Loss: 1.053 Vali Acc: 0.650 Test Loss: 1.053 Test Acc: 0.650
Validation loss decreased (-0.589990 --> -0.649989).  Saving model ...
Epoch: 16 cost time: 5.828948736190796
Epoch: 16, Steps: 20 | Train Loss: 0.426 Vali Loss: 1.192 Vali Acc: 0.540 Test Loss: 1.192 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.402183294296265
Epoch: 17, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.713 Vali Acc: 0.520 Test Loss: 1.713 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.251964807510376
Epoch: 18, Steps: 20 | Train Loss: 0.310 Vali Loss: 1.296 Vali Acc: 0.590 Test Loss: 1.296 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.336044549942017
Epoch: 19, Steps: 20 | Train Loss: 0.288 Vali Loss: 1.494 Vali Acc: 0.530 Test Loss: 1.494 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.19677209854126
Epoch: 20, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.505 Vali Acc: 0.600 Test Loss: 1.505 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.436807870864868
Epoch: 21, Steps: 20 | Train Loss: 0.201 Vali Loss: 1.856 Vali Acc: 0.550 Test Loss: 1.856 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.059255599975586
Epoch: 22, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.715 Vali Acc: 0.530 Test Loss: 1.715 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.43304181098938
Epoch: 23, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.667 Vali Acc: 0.580 Test Loss: 1.667 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.582897424697876
Epoch: 24, Steps: 20 | Train Loss: 0.172 Vali Loss: 2.003 Vali Acc: 0.580 Test Loss: 2.003 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.670197010040283
Epoch: 25, Steps: 20 | Train Loss: 0.117 Vali Loss: 2.427 Vali Acc: 0.560 Test Loss: 2.427 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.144928216934204
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.493954420089722
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.300575017929077
Epoch: 3, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.525735139846802
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.687717914581299
Epoch: 5, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.899 Vali Acc: 0.510 Test Loss: 0.899 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509991).  Saving model ...
Epoch: 6 cost time: 5.396321535110474
Epoch: 6, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.886 Vali Acc: 0.540 Test Loss: 0.886 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 5.287070989608765
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.878 Vali Acc: 0.550 Test Loss: 0.878 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549991).  Saving model ...
Epoch: 8 cost time: 5.787705659866333
Epoch: 8, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.920 Vali Acc: 0.560 Test Loss: 0.920 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559991).  Saving model ...
Epoch: 9 cost time: 5.3479132652282715
Epoch: 9, Steps: 20 | Train Loss: 0.639 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.5799431800842285
Epoch: 10, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.893 Vali Acc: 0.560 Test Loss: 0.893 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559991).  Saving model ...
Epoch: 11 cost time: 5.829232215881348
Epoch: 11, Steps: 20 | Train Loss: 0.566 Vali Loss: 1.043 Vali Acc: 0.540 Test Loss: 1.043 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.972864389419556
Epoch: 12, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.975 Vali Acc: 0.580 Test Loss: 0.975 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579990).  Saving model ...
Epoch: 13 cost time: 5.986134052276611
Epoch: 13, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.972 Vali Acc: 0.600 Test Loss: 0.972 Test Acc: 0.600
Validation loss decreased (-0.579990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 5.739340782165527
Epoch: 14, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.374 Vali Acc: 0.570 Test Loss: 1.374 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.334780931472778
Epoch: 15, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.059 Vali Acc: 0.660 Test Loss: 1.059 Test Acc: 0.660
Validation loss decreased (-0.599990 --> -0.659989).  Saving model ...
Epoch: 16 cost time: 5.548131227493286
Epoch: 16, Steps: 20 | Train Loss: 0.531 Vali Loss: 1.085 Vali Acc: 0.590 Test Loss: 1.085 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.276592254638672
Epoch: 17, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.484 Vali Acc: 0.530 Test Loss: 1.484 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.153836727142334
Epoch: 18, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.122 Vali Acc: 0.570 Test Loss: 1.122 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.608379602432251
Epoch: 19, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.398 Vali Acc: 0.620 Test Loss: 1.398 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.241654396057129
Epoch: 20, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.431 Vali Acc: 0.610 Test Loss: 1.431 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.587786674499512
Epoch: 21, Steps: 20 | Train Loss: 0.291 Vali Loss: 1.497 Vali Acc: 0.600 Test Loss: 1.497 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.2305588722229
Epoch: 22, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.766 Vali Acc: 0.530 Test Loss: 1.766 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.353284120559692
Epoch: 23, Steps: 20 | Train Loss: 0.275 Vali Loss: 1.747 Vali Acc: 0.550 Test Loss: 1.747 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.481723070144653
Epoch: 24, Steps: 20 | Train Loss: 0.213 Vali Loss: 2.025 Vali Acc: 0.600 Test Loss: 2.025 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.188220739364624
Epoch: 25, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.776 Vali Acc: 0.580 Test Loss: 1.776 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.013731956481934
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.700 Vali Acc: 0.510 Test Loss: 0.700 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.234923362731934
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.381259918212891
Epoch: 3, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.845 Vali Acc: 0.530 Test Loss: 0.845 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 5.065605401992798
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.858 Vali Acc: 0.500 Test Loss: 0.858 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.169031143188477
Epoch: 5, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.869 Vali Acc: 0.520 Test Loss: 0.869 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.952389240264893
Epoch: 6, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.892 Vali Acc: 0.550 Test Loss: 0.892 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 7 cost time: 5.139631986618042
Epoch: 7, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
Validation loss decreased (-0.549991 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 5.338974475860596
Epoch: 8, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.910 Vali Acc: 0.570 Test Loss: 0.910 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 9 cost time: 5.479876756668091
Epoch: 9, Steps: 20 | Train Loss: 0.597 Vali Loss: 1.055 Vali Acc: 0.540 Test Loss: 1.055 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.198030948638916
Epoch: 10, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.926 Vali Acc: 0.560 Test Loss: 0.926 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.001372814178467
Epoch: 11, Steps: 20 | Train Loss: 0.519 Vali Loss: 1.053 Vali Acc: 0.580 Test Loss: 1.053 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 5.101528167724609
Epoch: 12, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.033 Vali Acc: 0.560 Test Loss: 1.033 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.950584411621094
Epoch: 13, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 5.16254734992981
Epoch: 14, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.329 Vali Acc: 0.620 Test Loss: 1.329 Test Acc: 0.620
Validation loss decreased (-0.599990 --> -0.619987).  Saving model ...
Epoch: 15 cost time: 4.929718971252441
Epoch: 15, Steps: 20 | Train Loss: 0.410 Vali Loss: 1.117 Vali Acc: 0.630 Test Loss: 1.117 Test Acc: 0.630
Validation loss decreased (-0.619987 --> -0.629989).  Saving model ...
Epoch: 16 cost time: 4.9947216510772705
Epoch: 16, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.124 Vali Acc: 0.590 Test Loss: 1.124 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.798149585723877
Epoch: 17, Steps: 20 | Train Loss: 0.413 Vali Loss: 1.512 Vali Acc: 0.610 Test Loss: 1.512 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.120770454406738
Epoch: 18, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.138 Vali Acc: 0.610 Test Loss: 1.138 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.22940468788147
Epoch: 19, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.343 Vali Acc: 0.600 Test Loss: 1.343 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.041231870651245
Epoch: 20, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.501 Vali Acc: 0.620 Test Loss: 1.501 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.491028785705566
Epoch: 21, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.509 Vali Acc: 0.610 Test Loss: 1.509 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.653002023696899
Epoch: 22, Steps: 20 | Train Loss: 0.247 Vali Loss: 2.068 Vali Acc: 0.550 Test Loss: 2.068 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.546535015106201
Epoch: 23, Steps: 20 | Train Loss: 0.230 Vali Loss: 1.604 Vali Acc: 0.600 Test Loss: 1.604 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.311151742935181
Epoch: 24, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.577 Vali Acc: 0.630 Test Loss: 1.577 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.191431045532227
Epoch: 25, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.965 Vali Acc: 0.560 Test Loss: 1.965 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.843092203140259
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.2207324504852295
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 5.253977060317993
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.077276229858398
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.9773969650268555
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.952299118041992
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.006437540054321
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.725631237030029
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.916645765304565
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.30400538444519
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.285914421081543
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.398165941238403
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 2107650
model size : 17.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.836109399795532
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.131960868835449
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 5.1626975536346436
Epoch: 3, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.810 Vali Acc: 0.430 Test Loss: 0.810 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.513890743255615
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.889 Vali Acc: 0.450 Test Loss: 0.889 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.413809776306152
Epoch: 5, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.821 Vali Acc: 0.490 Test Loss: 0.821 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.70356822013855
Epoch: 6, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.833 Vali Acc: 0.500 Test Loss: 0.833 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 5.530449628829956
Epoch: 7, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.921 Vali Acc: 0.500 Test Loss: 0.921 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.385982275009155
Epoch: 8, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.832 Vali Acc: 0.490 Test Loss: 0.832 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.982331991195679
Epoch: 9, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.922232389450073
Epoch: 10, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.977 Vali Acc: 0.520 Test Loss: 0.977 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519990).  Saving model ...
Epoch: 11 cost time: 5.300947666168213
Epoch: 11, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.931 Vali Acc: 0.520 Test Loss: 0.931 Test Acc: 0.520
Validation loss decreased (-0.519990 --> -0.519991).  Saving model ...
Epoch: 12 cost time: 5.533085107803345
Epoch: 12, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.044 Vali Acc: 0.550 Test Loss: 1.044 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 5.328528881072998
Epoch: 13, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.010 Vali Acc: 0.530 Test Loss: 1.010 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.617067098617554
Epoch: 14, Steps: 20 | Train Loss: 0.411 Vali Loss: 0.965 Vali Acc: 0.500 Test Loss: 0.965 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.434581279754639
Epoch: 15, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.091 Vali Acc: 0.510 Test Loss: 1.091 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.368089437484741
Epoch: 16, Steps: 20 | Train Loss: 0.311 Vali Loss: 0.984 Vali Acc: 0.530 Test Loss: 0.984 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.265035152435303
Epoch: 17, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.386 Vali Acc: 0.530 Test Loss: 1.386 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.2884132862091064
Epoch: 18, Steps: 20 | Train Loss: 0.292 Vali Loss: 1.087 Vali Acc: 0.590 Test Loss: 1.087 Test Acc: 0.590
Validation loss decreased (-0.549990 --> -0.589989).  Saving model ...
Epoch: 19 cost time: 5.866198778152466
Epoch: 19, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.406 Vali Acc: 0.530 Test Loss: 1.406 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.112951278686523
Epoch: 20, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.464 Vali Acc: 0.510 Test Loss: 1.464 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.433342933654785
Epoch: 21, Steps: 20 | Train Loss: 0.197 Vali Loss: 1.358 Vali Acc: 0.520 Test Loss: 1.358 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.461665868759155
Epoch: 22, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.409 Vali Acc: 0.520 Test Loss: 1.409 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.110443830490112
Epoch: 23, Steps: 20 | Train Loss: 0.196 Vali Loss: 1.413 Vali Acc: 0.510 Test Loss: 1.413 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.083253622055054
Epoch: 24, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.506 Vali Acc: 0.570 Test Loss: 1.506 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.1431334018707275
Epoch: 25, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.584 Vali Acc: 0.560 Test Loss: 1.584 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.320750951766968
Epoch: 26, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.544 Vali Acc: 0.530 Test Loss: 1.544 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.388422727584839
Epoch: 27, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.596 Vali Acc: 0.530 Test Loss: 1.596 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.745917081832886
Epoch: 28, Steps: 20 | Train Loss: 0.070 Vali Loss: 1.774 Vali Acc: 0.550 Test Loss: 1.774 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.121680736541748
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.752 Vali Acc: 0.460 Test Loss: 0.752 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 5.128561496734619
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.784 Vali Acc: 0.460 Test Loss: 0.784 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.055708169937134
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.823 Vali Acc: 0.440 Test Loss: 0.823 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.065656900405884
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.879 Vali Acc: 0.450 Test Loss: 0.879 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.217396020889282
Epoch: 5, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.837 Vali Acc: 0.490 Test Loss: 0.837 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489992).  Saving model ...
Epoch: 6 cost time: 5.361711740493774
Epoch: 6, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.880 Vali Acc: 0.490 Test Loss: 0.880 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.582007169723511
Epoch: 7, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.908 Vali Acc: 0.470 Test Loss: 0.908 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.976491689682007
Epoch: 8, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.855 Vali Acc: 0.520 Test Loss: 0.855 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519991).  Saving model ...
Epoch: 9 cost time: 5.578863620758057
Epoch: 9, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.989 Vali Acc: 0.490 Test Loss: 0.989 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.522683143615723
Epoch: 10, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.907 Vali Acc: 0.520 Test Loss: 0.907 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.358982563018799
Epoch: 11, Steps: 20 | Train Loss: 0.445 Vali Loss: 0.959 Vali Acc: 0.510 Test Loss: 0.959 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.406982421875
Epoch: 12, Steps: 20 | Train Loss: 0.412 Vali Loss: 1.031 Vali Acc: 0.490 Test Loss: 1.031 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.422850847244263
Epoch: 13, Steps: 20 | Train Loss: 0.379 Vali Loss: 0.944 Vali Acc: 0.550 Test Loss: 0.944 Test Acc: 0.550
Validation loss decreased (-0.519991 --> -0.549991).  Saving model ...
Epoch: 14 cost time: 5.628625392913818
Epoch: 14, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.013 Vali Acc: 0.520 Test Loss: 1.013 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.483781576156616
Epoch: 15, Steps: 20 | Train Loss: 0.338 Vali Loss: 1.100 Vali Acc: 0.530 Test Loss: 1.100 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.592928886413574
Epoch: 16, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.015 Vali Acc: 0.530 Test Loss: 1.015 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.244375467300415
Epoch: 17, Steps: 20 | Train Loss: 0.308 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.38014817237854
Epoch: 18, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.115 Vali Acc: 0.580 Test Loss: 1.115 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579989).  Saving model ...
Epoch: 19 cost time: 5.055131912231445
Epoch: 19, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.246 Vali Acc: 0.480 Test Loss: 1.246 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.798717498779297
Epoch: 20, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.385 Vali Acc: 0.510 Test Loss: 1.385 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.900424242019653
Epoch: 21, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.288 Vali Acc: 0.590 Test Loss: 1.288 Test Acc: 0.590
Validation loss decreased (-0.579989 --> -0.589987).  Saving model ...
Epoch: 22 cost time: 5.3922343254089355
Epoch: 22, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.393 Vali Acc: 0.520 Test Loss: 1.393 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.2959630489349365
Epoch: 23, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.362 Vali Acc: 0.540 Test Loss: 1.362 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.3739800453186035
Epoch: 24, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.457 Vali Acc: 0.510 Test Loss: 1.457 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.2504801750183105
Epoch: 25, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.618 Vali Acc: 0.530 Test Loss: 1.618 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.012940406799316
Epoch: 26, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.323 Vali Acc: 0.560 Test Loss: 1.323 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.640303373336792
Epoch: 27, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.412 Vali Acc: 0.530 Test Loss: 1.412 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.933649778366089
Epoch: 28, Steps: 20 | Train Loss: 0.088 Vali Loss: 1.637 Vali Acc: 0.570 Test Loss: 1.637 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.0485124588012695
Epoch: 29, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.630 Vali Acc: 0.530 Test Loss: 1.630 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.763293743133545
Epoch: 30, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.667 Vali Acc: 0.550 Test Loss: 1.667 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.772037744522095
Epoch: 31, Steps: 20 | Train Loss: 0.067 Vali Loss: 1.601 Vali Acc: 0.560 Test Loss: 1.601 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.821392059326172
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.761 Vali Acc: 0.490 Test Loss: 0.761 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 5.3063695430755615
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.802 Vali Acc: 0.490 Test Loss: 0.802 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.057936191558838
Epoch: 3, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.832 Vali Acc: 0.440 Test Loss: 0.832 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.240979433059692
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.848 Vali Acc: 0.460 Test Loss: 0.848 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.634682893753052
Epoch: 5, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 5.584346532821655
Epoch: 6, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.878 Vali Acc: 0.490 Test Loss: 0.878 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.266602277755737
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.881 Vali Acc: 0.520 Test Loss: 0.881 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.315851449966431
Epoch: 8, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.875 Vali Acc: 0.500 Test Loss: 0.875 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.038879632949829
Epoch: 9, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.941 Vali Acc: 0.480 Test Loss: 0.941 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.872895002365112
Epoch: 10, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.9577343463897705
Epoch: 11, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.915 Vali Acc: 0.510 Test Loss: 0.915 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.868129014968872
Epoch: 12, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.3321373462677
Epoch: 13, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.829 Vali Acc: 0.570 Test Loss: 0.829 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 5.466007471084595
Epoch: 14, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.933 Vali Acc: 0.520 Test Loss: 0.933 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.402845859527588
Epoch: 15, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.975 Vali Acc: 0.510 Test Loss: 0.975 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.146011590957642
Epoch: 16, Steps: 20 | Train Loss: 0.356 Vali Loss: 1.039 Vali Acc: 0.540 Test Loss: 1.039 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.316893577575684
Epoch: 17, Steps: 20 | Train Loss: 0.323 Vali Loss: 0.982 Vali Acc: 0.540 Test Loss: 0.982 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.255985736846924
Epoch: 18, Steps: 20 | Train Loss: 0.298 Vali Loss: 0.953 Vali Acc: 0.550 Test Loss: 0.953 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.516784191131592
Epoch: 19, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.147 Vali Acc: 0.540 Test Loss: 1.147 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.354349613189697
Epoch: 20, Steps: 20 | Train Loss: 0.241 Vali Loss: 1.262 Vali Acc: 0.560 Test Loss: 1.262 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.481625318527222
Epoch: 21, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.110 Vali Acc: 0.530 Test Loss: 1.110 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.382282495498657
Epoch: 22, Steps: 20 | Train Loss: 0.261 Vali Loss: 1.356 Vali Acc: 0.550 Test Loss: 1.356 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.618928909301758
Epoch: 23, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.127 Vali Acc: 0.550 Test Loss: 1.127 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.487716913223267
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.748 Vali Acc: 0.480 Test Loss: 0.748 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.142338275909424
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.792 Vali Acc: 0.460 Test Loss: 0.792 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.851947784423828
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.804 Vali Acc: 0.470 Test Loss: 0.804 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.569599866867065
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.317857265472412
Epoch: 5, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.839 Vali Acc: 0.560 Test Loss: 0.839 Test Acc: 0.560
Validation loss decreased (-0.479993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 5.302124261856079
Epoch: 6, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.829 Vali Acc: 0.520 Test Loss: 0.829 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.072840690612793
Epoch: 7, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.879 Vali Acc: 0.540 Test Loss: 0.879 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.7790446281433105
Epoch: 8, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.899 Vali Acc: 0.500 Test Loss: 0.899 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.084205627441406
Epoch: 9, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.932 Vali Acc: 0.570 Test Loss: 0.932 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 10 cost time: 4.641298294067383
Epoch: 10, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.897 Vali Acc: 0.550 Test Loss: 0.897 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.858892917633057
Epoch: 11, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.871 Vali Acc: 0.580 Test Loss: 0.871 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 12 cost time: 5.39452052116394
Epoch: 12, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.861 Vali Acc: 0.570 Test Loss: 0.861 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.367586374282837
Epoch: 13, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.925 Vali Acc: 0.520 Test Loss: 0.925 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.550676345825195
Epoch: 14, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.868 Vali Acc: 0.580 Test Loss: 0.868 Test Acc: 0.580
Validation loss decreased (-0.579991 --> -0.579991).  Saving model ...
Epoch: 15 cost time: 5.3647544384002686
Epoch: 15, Steps: 20 | Train Loss: 0.362 Vali Loss: 0.942 Vali Acc: 0.570 Test Loss: 0.942 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.038599729537964
Epoch: 16, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.962 Vali Acc: 0.560 Test Loss: 0.962 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.979066371917725
Epoch: 17, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.036 Vali Acc: 0.490 Test Loss: 1.036 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.224605321884155
Epoch: 18, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.919 Vali Acc: 0.620 Test Loss: 0.919 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619991).  Saving model ...
Epoch: 19 cost time: 5.230968713760376
Epoch: 19, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.195 Vali Acc: 0.560 Test Loss: 1.195 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.0376811027526855
Epoch: 20, Steps: 20 | Train Loss: 0.273 Vali Loss: 1.483 Vali Acc: 0.550 Test Loss: 1.483 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.091052770614624
Epoch: 21, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.187 Vali Acc: 0.530 Test Loss: 1.187 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.808605194091797
Epoch: 22, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.143 Vali Acc: 0.560 Test Loss: 1.143 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.9688897132873535
Epoch: 23, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.260 Vali Acc: 0.570 Test Loss: 1.260 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.56162166595459
Epoch: 24, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.245 Vali Acc: 0.580 Test Loss: 1.245 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.498741626739502
Epoch: 25, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.485 Vali Acc: 0.580 Test Loss: 1.485 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.382381439208984
Epoch: 26, Steps: 20 | Train Loss: 0.152 Vali Loss: 1.255 Vali Acc: 0.580 Test Loss: 1.255 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.6321210861206055
Epoch: 27, Steps: 20 | Train Loss: 0.103 Vali Loss: 1.405 Vali Acc: 0.540 Test Loss: 1.405 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.037413835525513
Epoch: 28, Steps: 20 | Train Loss: 0.108 Vali Loss: 1.431 Vali Acc: 0.570 Test Loss: 1.431 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.594458818435669
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.786 Vali Acc: 0.430 Test Loss: 0.786 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 5.6038336753845215
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.864 Vali Acc: 0.400 Test Loss: 0.864 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.483721971511841
Epoch: 3, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.894 Vali Acc: 0.400 Test Loss: 0.894 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.697298526763916
Epoch: 4, Steps: 20 | Train Loss: 0.634 Vali Loss: 1.018 Vali Acc: 0.440 Test Loss: 1.018 Test Acc: 0.440
Validation loss decreased (-0.429992 --> -0.439990).  Saving model ...
Epoch: 5 cost time: 5.910600662231445
Epoch: 5, Steps: 20 | Train Loss: 0.633 Vali Loss: 1.023 Vali Acc: 0.470 Test Loss: 1.023 Test Acc: 0.470
Validation loss decreased (-0.439990 --> -0.469990).  Saving model ...
Epoch: 6 cost time: 5.45212459564209
Epoch: 6, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.982 Vali Acc: 0.440 Test Loss: 0.982 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.321477174758911
Epoch: 7, Steps: 20 | Train Loss: 0.595 Vali Loss: 1.038 Vali Acc: 0.480 Test Loss: 1.038 Test Acc: 0.480
Validation loss decreased (-0.469990 --> -0.479990).  Saving model ...
Epoch: 8 cost time: 5.453052282333374
Epoch: 8, Steps: 20 | Train Loss: 0.570 Vali Loss: 1.140 Vali Acc: 0.530 Test Loss: 1.140 Test Acc: 0.530
Validation loss decreased (-0.479990 --> -0.529989).  Saving model ...
Epoch: 9 cost time: 5.411839962005615
Epoch: 9, Steps: 20 | Train Loss: 0.557 Vali Loss: 1.139 Vali Acc: 0.520 Test Loss: 1.139 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.168390512466431
Epoch: 10, Steps: 20 | Train Loss: 0.538 Vali Loss: 1.050 Vali Acc: 0.450 Test Loss: 1.050 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.730579853057861
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
Validation loss decreased (-0.529989 --> -0.529990).  Saving model ...
Epoch: 12 cost time: 5.733811616897583
Epoch: 12, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.135990381240845
Epoch: 13, Steps: 20 | Train Loss: 0.527 Vali Loss: 1.098 Vali Acc: 0.530 Test Loss: 1.098 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.319555997848511
Epoch: 14, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.985 Vali Acc: 0.580 Test Loss: 0.985 Test Acc: 0.580
Validation loss decreased (-0.529990 --> -0.579990).  Saving model ...
Epoch: 15 cost time: 5.574920892715454
Epoch: 15, Steps: 20 | Train Loss: 0.412 Vali Loss: 1.056 Vali Acc: 0.530 Test Loss: 1.056 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.2059972286224365
Epoch: 16, Steps: 20 | Train Loss: 0.489 Vali Loss: 1.154 Vali Acc: 0.420 Test Loss: 1.154 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.164761781692505
Epoch: 17, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.144 Vali Acc: 0.460 Test Loss: 1.144 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.325713634490967
Epoch: 18, Steps: 20 | Train Loss: 0.416 Vali Loss: 1.031 Vali Acc: 0.520 Test Loss: 1.031 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.753974437713623
Epoch: 19, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.340 Vali Acc: 0.470 Test Loss: 1.340 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.484658718109131
Epoch: 20, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.568 Vali Acc: 0.520 Test Loss: 1.568 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.099401235580444
Epoch: 21, Steps: 20 | Train Loss: 0.365 Vali Loss: 1.212 Vali Acc: 0.520 Test Loss: 1.212 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.308081388473511
Epoch: 22, Steps: 20 | Train Loss: 0.364 Vali Loss: 1.339 Vali Acc: 0.480 Test Loss: 1.339 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.171581745147705
Epoch: 23, Steps: 20 | Train Loss: 0.339 Vali Loss: 1.395 Vali Acc: 0.500 Test Loss: 1.395 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.230314254760742
Epoch: 24, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.241 Vali Acc: 0.530 Test Loss: 1.241 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.426104545593262
Epoch: 1, Steps: 20 | Train Loss: 0.743 Vali Loss: 0.722 Vali Acc: 0.480 Test Loss: 0.722 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.323490619659424
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.725 Vali Acc: 0.530 Test Loss: 0.725 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 5.205924987792969
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.813 Vali Acc: 0.450 Test Loss: 0.813 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.049527406692505
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.294191598892212
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.782 Vali Acc: 0.530 Test Loss: 0.782 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.265025854110718
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.795 Vali Acc: 0.560 Test Loss: 0.795 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 5.329507827758789
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.245146036148071
Epoch: 8, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.2668538093566895
Epoch: 9, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.981 Vali Acc: 0.510 Test Loss: 0.981 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.0324461460113525
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.877 Vali Acc: 0.530 Test Loss: 0.877 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.080765962600708
Epoch: 11, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.823 Vali Acc: 0.600 Test Loss: 0.823 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 12 cost time: 4.7070324420928955
Epoch: 12, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.855 Vali Acc: 0.570 Test Loss: 0.855 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.858244180679321
Epoch: 13, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.882 Vali Acc: 0.560 Test Loss: 0.882 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.096524477005005
Epoch: 14, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.859 Vali Acc: 0.570 Test Loss: 0.859 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.525884628295898
Epoch: 15, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.902 Vali Acc: 0.600 Test Loss: 0.902 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.122869491577148
Epoch: 16, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.969 Vali Acc: 0.510 Test Loss: 0.969 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.757413864135742
Epoch: 17, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.967 Vali Acc: 0.510 Test Loss: 0.967 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.095139741897583
Epoch: 18, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.857 Vali Acc: 0.620 Test Loss: 0.857 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619991).  Saving model ...
Epoch: 19 cost time: 4.903711795806885
Epoch: 19, Steps: 20 | Train Loss: 0.415 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.1131579875946045
Epoch: 20, Steps: 20 | Train Loss: 0.423 Vali Loss: 1.184 Vali Acc: 0.560 Test Loss: 1.184 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.1485724449157715
Epoch: 21, Steps: 20 | Train Loss: 0.430 Vali Loss: 1.043 Vali Acc: 0.550 Test Loss: 1.043 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.279071569442749
Epoch: 22, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.219 Vali Acc: 0.610 Test Loss: 1.219 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.456103801727295
Epoch: 23, Steps: 20 | Train Loss: 0.460 Vali Loss: 1.360 Vali Acc: 0.510 Test Loss: 1.360 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.5179595947265625
Epoch: 24, Steps: 20 | Train Loss: 0.454 Vali Loss: 1.253 Vali Acc: 0.560 Test Loss: 1.253 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.537553548812866
Epoch: 25, Steps: 20 | Train Loss: 0.349 Vali Loss: 1.033 Vali Acc: 0.580 Test Loss: 1.033 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.118675947189331
Epoch: 26, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.220 Vali Acc: 0.620 Test Loss: 1.220 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.161762952804565
Epoch: 27, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.224 Vali Acc: 0.550 Test Loss: 1.224 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.156097888946533
Epoch: 28, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.201725959777832
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.743 Vali Acc: 0.460 Test Loss: 0.743 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 5.668431282043457
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
Validation loss decreased (-0.459993 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 5.608675479888916
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.856 Vali Acc: 0.440 Test Loss: 0.856 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.1494176387786865
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 5.418091535568237
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.837 Vali Acc: 0.520 Test Loss: 0.837 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.082770109176636
Epoch: 6, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.367234230041504
Epoch: 7, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.875 Vali Acc: 0.560 Test Loss: 0.875 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559991).  Saving model ...
Epoch: 8 cost time: 5.344217777252197
Epoch: 8, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.935 Vali Acc: 0.520 Test Loss: 0.935 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.68519139289856
Epoch: 9, Steps: 20 | Train Loss: 0.572 Vali Loss: 1.034 Vali Acc: 0.510 Test Loss: 1.034 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.9302990436553955
Epoch: 10, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.928 Vali Acc: 0.510 Test Loss: 0.928 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.314109802246094
Epoch: 11, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.876 Vali Acc: 0.570 Test Loss: 0.876 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569991).  Saving model ...
Epoch: 12 cost time: 5.395678520202637
Epoch: 12, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.919 Vali Acc: 0.550 Test Loss: 0.919 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.196722507476807
Epoch: 13, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.924 Vali Acc: 0.550 Test Loss: 0.924 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.773255348205566
Epoch: 14, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.915 Vali Acc: 0.580 Test Loss: 0.915 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 15 cost time: 5.527528285980225
Epoch: 15, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.977 Vali Acc: 0.580 Test Loss: 0.977 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.772732496261597
Epoch: 16, Steps: 20 | Train Loss: 0.468 Vali Loss: 1.004 Vali Acc: 0.550 Test Loss: 1.004 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.988443613052368
Epoch: 17, Steps: 20 | Train Loss: 0.470 Vali Loss: 1.064 Vali Acc: 0.510 Test Loss: 1.064 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.50532603263855
Epoch: 18, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.958 Vali Acc: 0.570 Test Loss: 0.958 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.087660551071167
Epoch: 19, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.302685737609863
Epoch: 20, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.220 Vali Acc: 0.540 Test Loss: 1.220 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.1209557056427
Epoch: 21, Steps: 20 | Train Loss: 0.392 Vali Loss: 1.142 Vali Acc: 0.550 Test Loss: 1.142 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.304550647735596
Epoch: 22, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.181 Vali Acc: 0.580 Test Loss: 1.181 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.836287021636963
Epoch: 23, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.417 Vali Acc: 0.580 Test Loss: 1.417 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.833058834075928
Epoch: 24, Steps: 20 | Train Loss: 0.386 Vali Loss: 1.229 Vali Acc: 0.550 Test Loss: 1.229 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.804424524307251
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.026831150054932
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.227978229522705
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.795030832290649
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.700898885726929
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.084783554077148
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.463571786880493
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.203346490859985
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.989220380783081
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.160119533538818
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.41787052154541
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 2065538
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.75338888168335
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 5.095442056655884
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.742 Vali Acc: 0.490 Test Loss: 0.742 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.369924306869507
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 4.9370951652526855
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.850 Vali Acc: 0.460 Test Loss: 0.850 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.0913169384002686
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.324729681015015
Epoch: 6, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.825 Vali Acc: 0.490 Test Loss: 0.825 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.550548553466797
Epoch: 7, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.827 Vali Acc: 0.520 Test Loss: 0.827 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.589133977890015
Epoch: 8, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.827 Vali Acc: 0.510 Test Loss: 0.827 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.5345189571380615
Epoch: 9, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.990 Vali Acc: 0.540 Test Loss: 0.990 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.584766149520874
Epoch: 10, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.453733921051025
Epoch: 11, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.827 Vali Acc: 0.490 Test Loss: 0.827 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.219420909881592
Epoch: 12, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.984 Vali Acc: 0.540 Test Loss: 0.984 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.358246088027954
Epoch: 13, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.964 Vali Acc: 0.540 Test Loss: 0.964 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.031182765960693
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.747 Vali Acc: 0.480 Test Loss: 0.747 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 5.647237300872803
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.743 Vali Acc: 0.550 Test Loss: 0.743 Test Acc: 0.550
Validation loss decreased (-0.479993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 5.535460948944092
Epoch: 3, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.493605375289917
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.862 Vali Acc: 0.490 Test Loss: 0.862 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.013092756271362
Epoch: 5, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.809 Vali Acc: 0.480 Test Loss: 0.809 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.954269170761108
Epoch: 6, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.809 Vali Acc: 0.470 Test Loss: 0.809 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.979111433029175
Epoch: 7, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.960530519485474
Epoch: 8, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.834 Vali Acc: 0.510 Test Loss: 0.834 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.376851320266724
Epoch: 9, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.994 Vali Acc: 0.490 Test Loss: 0.994 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.193537950515747
Epoch: 10, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.830 Vali Acc: 0.490 Test Loss: 0.830 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.581556797027588
Epoch: 11, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.868 Vali Acc: 0.540 Test Loss: 0.868 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.246090412139893
Epoch: 12, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.964 Vali Acc: 0.520 Test Loss: 0.964 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.725523233413696
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.262876033782959
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 5.327338933944702
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.307809591293335
Epoch: 4, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.878 Vali Acc: 0.500 Test Loss: 0.878 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.337587118148804
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 5.219220161437988
Epoch: 6, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.320678949356079
Epoch: 7, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.5806591510772705
Epoch: 8, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 5.718778848648071
Epoch: 9, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.941 Vali Acc: 0.540 Test Loss: 0.941 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.456637620925903
Epoch: 10, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.651493787765503
Epoch: 11, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.810 Vali Acc: 0.570 Test Loss: 0.810 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 5.01698637008667
Epoch: 12, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.916 Vali Acc: 0.520 Test Loss: 0.916 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.211561918258667
Epoch: 13, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.113963842391968
Epoch: 14, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.947 Vali Acc: 0.500 Test Loss: 0.947 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.261673927307129
Epoch: 15, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.884 Vali Acc: 0.560 Test Loss: 0.884 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.44536280632019
Epoch: 16, Steps: 20 | Train Loss: 0.388 Vali Loss: 1.091 Vali Acc: 0.570 Test Loss: 1.091 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.9210286140441895
Epoch: 17, Steps: 20 | Train Loss: 0.427 Vali Loss: 0.999 Vali Acc: 0.530 Test Loss: 0.999 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.844129323959351
Epoch: 18, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.074 Vali Acc: 0.540 Test Loss: 1.074 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.996267318725586
Epoch: 19, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.274 Vali Acc: 0.530 Test Loss: 1.274 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.184783220291138
Epoch: 20, Steps: 20 | Train Loss: 0.308 Vali Loss: 0.967 Vali Acc: 0.550 Test Loss: 0.967 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.227018594741821
Epoch: 21, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.182081699371338
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 5.726212739944458
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.58526873588562
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.760 Vali Acc: 0.540 Test Loss: 0.760 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.445307970046997
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.907 Vali Acc: 0.460 Test Loss: 0.907 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.250279903411865
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 6 cost time: 5.417771339416504
Epoch: 6, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.824 Vali Acc: 0.560 Test Loss: 0.824 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 5.383736848831177
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.413534164428711
Epoch: 8, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.811 Vali Acc: 0.580 Test Loss: 0.811 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 5.5756449699401855
Epoch: 9, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.974 Vali Acc: 0.540 Test Loss: 0.974 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.232307434082031
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.556843519210815
Epoch: 11, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.121568202972412
Epoch: 12, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.960 Vali Acc: 0.500 Test Loss: 0.960 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.400652885437012
Epoch: 13, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.924 Vali Acc: 0.580 Test Loss: 0.924 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.1599931716918945
Epoch: 14, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.9922449588775635
Epoch: 15, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.850 Vali Acc: 0.540 Test Loss: 0.850 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.4363343715667725
Epoch: 16, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.940 Vali Acc: 0.570 Test Loss: 0.940 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.436754465103149
Epoch: 17, Steps: 20 | Train Loss: 0.427 Vali Loss: 1.075 Vali Acc: 0.560 Test Loss: 1.075 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.280436277389526
Epoch: 18, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.139 Vali Acc: 0.570 Test Loss: 1.139 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.953107595443726
Epoch: 1, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.546849489212036
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 5.515488862991333
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.200373411178589
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.947 Vali Acc: 0.490 Test Loss: 0.947 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.718953371047974
Epoch: 5, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.975 Vali Acc: 0.520 Test Loss: 0.975 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.816246032714844
Epoch: 6, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.778775930404663
Epoch: 7, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.964 Vali Acc: 0.460 Test Loss: 0.964 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.460582971572876
Epoch: 8, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.974 Vali Acc: 0.560 Test Loss: 0.974 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559990).  Saving model ...
Epoch: 9 cost time: 5.184719562530518
Epoch: 9, Steps: 20 | Train Loss: 0.549 Vali Loss: 1.071 Vali Acc: 0.540 Test Loss: 1.071 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.108678340911865
Epoch: 10, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.914 Vali Acc: 0.520 Test Loss: 0.914 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.104426145553589
Epoch: 11, Steps: 20 | Train Loss: 0.535 Vali Loss: 1.046 Vali Acc: 0.510 Test Loss: 1.046 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.375401735305786
Epoch: 12, Steps: 20 | Train Loss: 0.494 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.653097629547119
Epoch: 13, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.974 Vali Acc: 0.550 Test Loss: 0.974 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.850145101547241
Epoch: 14, Steps: 20 | Train Loss: 0.521 Vali Loss: 1.072 Vali Acc: 0.530 Test Loss: 1.072 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.598490476608276
Epoch: 15, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.948 Vali Acc: 0.500 Test Loss: 0.948 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.039773225784302
Epoch: 16, Steps: 20 | Train Loss: 0.461 Vali Loss: 1.023 Vali Acc: 0.570 Test Loss: 1.023 Test Acc: 0.570
Validation loss decreased (-0.559990 --> -0.569990).  Saving model ...
Epoch: 17 cost time: 5.148340463638306
Epoch: 17, Steps: 20 | Train Loss: 0.484 Vali Loss: 1.084 Vali Acc: 0.520 Test Loss: 1.084 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.073594570159912
Epoch: 18, Steps: 20 | Train Loss: 0.395 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.038175106048584
Epoch: 19, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.271 Vali Acc: 0.510 Test Loss: 1.271 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.492837429046631
Epoch: 20, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.041 Vali Acc: 0.520 Test Loss: 1.041 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.502556562423706
Epoch: 21, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.209 Vali Acc: 0.600 Test Loss: 1.209 Test Acc: 0.600
Validation loss decreased (-0.569990 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 6.583340644836426
Epoch: 22, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.190 Vali Acc: 0.560 Test Loss: 1.190 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.928109407424927
Epoch: 23, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.004 Vali Acc: 0.570 Test Loss: 1.004 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.615629196166992
Epoch: 24, Steps: 20 | Train Loss: 0.263 Vali Loss: 1.466 Vali Acc: 0.530 Test Loss: 1.466 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.540524482727051
Epoch: 25, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.750003337860107
Epoch: 26, Steps: 20 | Train Loss: 0.284 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.181153774261475
Epoch: 27, Steps: 20 | Train Loss: 0.252 Vali Loss: 1.139 Vali Acc: 0.540 Test Loss: 1.139 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.530022621154785
Epoch: 28, Steps: 20 | Train Loss: 0.191 Vali Loss: 1.190 Vali Acc: 0.560 Test Loss: 1.190 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.15083909034729
Epoch: 29, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.241 Vali Acc: 0.550 Test Loss: 1.241 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.48213791847229
Epoch: 30, Steps: 20 | Train Loss: 0.143 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 31 cost time: 5.855997323989868
Epoch: 31, Steps: 20 | Train Loss: 0.121 Vali Loss: 1.399 Vali Acc: 0.520 Test Loss: 1.399 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.777040958404541
Epoch: 32, Steps: 20 | Train Loss: 0.102 Vali Loss: 1.345 Vali Acc: 0.540 Test Loss: 1.345 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.328193664550781
Epoch: 33, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.787 Vali Acc: 0.530 Test Loss: 1.787 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.842089414596558
Epoch: 34, Steps: 20 | Train Loss: 0.091 Vali Loss: 1.459 Vali Acc: 0.530 Test Loss: 1.459 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.242093086242676
Epoch: 35, Steps: 20 | Train Loss: 0.062 Vali Loss: 1.469 Vali Acc: 0.530 Test Loss: 1.469 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 5.48784613609314
Epoch: 36, Steps: 20 | Train Loss: 0.053 Vali Loss: 1.820 Vali Acc: 0.530 Test Loss: 1.820 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 5.320792198181152
Epoch: 37, Steps: 20 | Train Loss: 0.049 Vali Loss: 1.799 Vali Acc: 0.570 Test Loss: 1.799 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 5.570789575576782
Epoch: 38, Steps: 20 | Train Loss: 0.047 Vali Loss: 1.863 Vali Acc: 0.540 Test Loss: 1.863 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 5.91649317741394
Epoch: 39, Steps: 20 | Train Loss: 0.056 Vali Loss: 1.638 Vali Acc: 0.560 Test Loss: 1.638 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 5.759795904159546
Epoch: 40, Steps: 20 | Train Loss: 0.057 Vali Loss: 1.748 Vali Acc: 0.580 Test Loss: 1.748 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.2297163009643555
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.477477073669434
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.709 Vali Acc: 0.480 Test Loss: 0.709 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.768429756164551
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.751 Vali Acc: 0.550 Test Loss: 0.751 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549992).  Saving model ...
Epoch: 4 cost time: 5.732088327407837
Epoch: 4, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.855 Vali Acc: 0.490 Test Loss: 0.855 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.5888330936431885
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.671507835388184
Epoch: 6, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.784 Vali Acc: 0.510 Test Loss: 0.784 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.756099224090576
Epoch: 7, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.738156080245972
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.810 Vali Acc: 0.560 Test Loss: 0.810 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 9 cost time: 5.92616868019104
Epoch: 9, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.970 Vali Acc: 0.540 Test Loss: 0.970 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.263132095336914
Epoch: 10, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.823 Vali Acc: 0.590 Test Loss: 0.823 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 5.402837753295898
Epoch: 11, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.913 Vali Acc: 0.540 Test Loss: 0.913 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.232790946960449
Epoch: 12, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.901 Vali Acc: 0.570 Test Loss: 0.901 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.653461694717407
Epoch: 13, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.883 Vali Acc: 0.590 Test Loss: 0.883 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.585298538208008
Epoch: 14, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.900 Vali Acc: 0.580 Test Loss: 0.900 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.643093585968018
Epoch: 15, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.025 Vali Acc: 0.580 Test Loss: 1.025 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.44892954826355
Epoch: 16, Steps: 20 | Train Loss: 0.544 Vali Loss: 1.041 Vali Acc: 0.590 Test Loss: 1.041 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.60929799079895
Epoch: 17, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.978 Vali Acc: 0.610 Test Loss: 0.978 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609990).  Saving model ...
Epoch: 18 cost time: 5.307477712631226
Epoch: 18, Steps: 20 | Train Loss: 0.480 Vali Loss: 1.014 Vali Acc: 0.530 Test Loss: 1.014 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.518867015838623
Epoch: 19, Steps: 20 | Train Loss: 0.473 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.232944965362549
Epoch: 20, Steps: 20 | Train Loss: 0.523 Vali Loss: 1.078 Vali Acc: 0.580 Test Loss: 1.078 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.423838138580322
Epoch: 21, Steps: 20 | Train Loss: 0.414 Vali Loss: 1.372 Vali Acc: 0.510 Test Loss: 1.372 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.467002630233765
Epoch: 22, Steps: 20 | Train Loss: 0.394 Vali Loss: 1.203 Vali Acc: 0.620 Test Loss: 1.203 Test Acc: 0.620
Validation loss decreased (-0.609990 --> -0.619988).  Saving model ...
Epoch: 23 cost time: 5.29383397102356
Epoch: 23, Steps: 20 | Train Loss: 0.405 Vali Loss: 1.171 Vali Acc: 0.620 Test Loss: 1.171 Test Acc: 0.620
Validation loss decreased (-0.619988 --> -0.619988).  Saving model ...
Epoch: 24 cost time: 5.087411403656006
Epoch: 24, Steps: 20 | Train Loss: 0.353 Vali Loss: 1.313 Vali Acc: 0.590 Test Loss: 1.313 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.382520914077759
Epoch: 25, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.273 Vali Acc: 0.620 Test Loss: 1.273 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.465786695480347
Epoch: 26, Steps: 20 | Train Loss: 0.340 Vali Loss: 1.438 Vali Acc: 0.570 Test Loss: 1.438 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.567747116088867
Epoch: 27, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.332 Vali Acc: 0.580 Test Loss: 1.332 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.522429466247559
Epoch: 28, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.484 Vali Acc: 0.570 Test Loss: 1.484 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.268994331359863
Epoch: 29, Steps: 20 | Train Loss: 0.170 Vali Loss: 1.653 Vali Acc: 0.560 Test Loss: 1.653 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.24679160118103
Epoch: 30, Steps: 20 | Train Loss: 0.166 Vali Loss: 1.436 Vali Acc: 0.620 Test Loss: 1.436 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.5259270668029785
Epoch: 31, Steps: 20 | Train Loss: 0.144 Vali Loss: 1.568 Vali Acc: 0.530 Test Loss: 1.568 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.14374041557312
Epoch: 32, Steps: 20 | Train Loss: 0.135 Vali Loss: 1.867 Vali Acc: 0.600 Test Loss: 1.867 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.349429368972778
Epoch: 33, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.999 Vali Acc: 0.570 Test Loss: 1.999 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.5544750690460205
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.692 Vali Acc: 0.540 Test Loss: 0.692 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 5.978347063064575
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 5.776808738708496
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.734 Vali Acc: 0.550 Test Loss: 0.734 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.701360464096069
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.601650953292847
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.838 Vali Acc: 0.560 Test Loss: 0.838 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 5.736856698989868
Epoch: 6, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.765 Vali Acc: 0.580 Test Loss: 0.765 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 7 cost time: 5.699493646621704
Epoch: 7, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.800 Vali Acc: 0.580 Test Loss: 0.800 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.53173303604126
Epoch: 8, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.819 Vali Acc: 0.600 Test Loss: 0.819 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599992).  Saving model ...
Epoch: 9 cost time: 5.838356256484985
Epoch: 9, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.906 Vali Acc: 0.580 Test Loss: 0.906 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.756600856781006
Epoch: 10, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.800 Vali Acc: 0.580 Test Loss: 0.800 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.058074951171875
Epoch: 11, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.908 Vali Acc: 0.570 Test Loss: 0.908 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.877565622329712
Epoch: 12, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.913 Vali Acc: 0.570 Test Loss: 0.913 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.738747596740723
Epoch: 13, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.874 Vali Acc: 0.580 Test Loss: 0.874 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.130437135696411
Epoch: 14, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.907 Vali Acc: 0.540 Test Loss: 0.907 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.301084995269775
Epoch: 15, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.963 Vali Acc: 0.550 Test Loss: 0.963 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.498486280441284
Epoch: 16, Steps: 20 | Train Loss: 0.495 Vali Loss: 1.020 Vali Acc: 0.570 Test Loss: 1.020 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.406493902206421
Epoch: 17, Steps: 20 | Train Loss: 0.537 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.35771918296814
Epoch: 18, Steps: 20 | Train Loss: 0.453 Vali Loss: 1.041 Vali Acc: 0.510 Test Loss: 1.041 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.259684324264526
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.572681427001953
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.382308006286621
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.744002342224121
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.461465120315552
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.757784366607666
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.518590927124023
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.366986989974976
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.4198596477508545
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.414300918579102
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.605060577392578
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 1279106
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.072077035903931
Epoch: 1, Steps: 20 | Train Loss: 0.749 Vali Loss: 0.751 Vali Acc: 0.450 Test Loss: 0.751 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 5.6576316356658936
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.800 Vali Acc: 0.420 Test Loss: 0.800 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.689136266708374
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.800 Vali Acc: 0.450 Test Loss: 0.800 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.678247690200806
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.802 Vali Acc: 0.480 Test Loss: 0.802 Test Acc: 0.480
Validation loss decreased (-0.449992 --> -0.479992).  Saving model ...
Epoch: 5 cost time: 5.928490161895752
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.852 Vali Acc: 0.480 Test Loss: 0.852 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.8119707107543945
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 6.059704303741455
Epoch: 7, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 5.947119951248169
Epoch: 8, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 5.73693323135376
Epoch: 9, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.760363578796387
Epoch: 10, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 5.8649632930755615
Epoch: 11, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.475834846496582
Epoch: 12, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.857 Vali Acc: 0.530 Test Loss: 0.857 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.489875793457031
Epoch: 13, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.897 Vali Acc: 0.500 Test Loss: 0.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.5181615352630615
Epoch: 14, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.000 Vali Acc: 0.530 Test Loss: 1.000 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.4275476932525635
Epoch: 15, Steps: 20 | Train Loss: 0.440 Vali Loss: 0.884 Vali Acc: 0.550 Test Loss: 0.884 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 16 cost time: 5.423717021942139
Epoch: 16, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.949 Vali Acc: 0.520 Test Loss: 0.949 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.306322813034058
Epoch: 17, Steps: 20 | Train Loss: 0.341 Vali Loss: 0.924 Vali Acc: 0.490 Test Loss: 0.924 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.361118793487549
Epoch: 18, Steps: 20 | Train Loss: 0.330 Vali Loss: 1.155 Vali Acc: 0.580 Test Loss: 1.155 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579988).  Saving model ...
Epoch: 19 cost time: 5.587965965270996
Epoch: 19, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.139 Vali Acc: 0.560 Test Loss: 1.139 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.62804913520813
Epoch: 20, Steps: 20 | Train Loss: 0.286 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.543313026428223
Epoch: 21, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.239 Vali Acc: 0.520 Test Loss: 1.239 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.4850242137908936
Epoch: 22, Steps: 20 | Train Loss: 0.206 Vali Loss: 1.359 Vali Acc: 0.580 Test Loss: 1.359 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.440779685974121
Epoch: 23, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.297 Vali Acc: 0.530 Test Loss: 1.297 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.338666200637817
Epoch: 24, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.169 Vali Acc: 0.530 Test Loss: 1.169 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.647698402404785
Epoch: 25, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.453 Vali Acc: 0.540 Test Loss: 1.453 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.65512228012085
Epoch: 26, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.393 Vali Acc: 0.530 Test Loss: 1.393 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.371986389160156
Epoch: 27, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.555 Vali Acc: 0.530 Test Loss: 1.555 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.337098121643066
Epoch: 28, Steps: 20 | Train Loss: 0.100 Vali Loss: 1.732 Vali Acc: 0.560 Test Loss: 1.732 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.181952714920044
Epoch: 1, Steps: 20 | Train Loss: 0.761 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 5.411748886108398
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.798 Vali Acc: 0.420 Test Loss: 0.798 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.551783323287964
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.802 Vali Acc: 0.450 Test Loss: 0.802 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.529938220977783
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.804 Vali Acc: 0.450 Test Loss: 0.804 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.602042198181152
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.853 Vali Acc: 0.490 Test Loss: 0.853 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.5238142013549805
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 7 cost time: 5.429427623748779
Epoch: 7, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.832 Vali Acc: 0.520 Test Loss: 0.832 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.306813716888428
Epoch: 8, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.828 Vali Acc: 0.510 Test Loss: 0.828 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.580490350723267
Epoch: 9, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.845 Vali Acc: 0.550 Test Loss: 0.845 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 5.353482961654663
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.818 Vali Acc: 0.520 Test Loss: 0.818 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.590681791305542
Epoch: 11, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.958 Vali Acc: 0.470 Test Loss: 0.958 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.335726737976074
Epoch: 12, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.568014621734619
Epoch: 13, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.927 Vali Acc: 0.470 Test Loss: 0.927 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.3224616050720215
Epoch: 14, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.995 Vali Acc: 0.510 Test Loss: 0.995 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.26624870300293
Epoch: 15, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.901 Vali Acc: 0.460 Test Loss: 0.901 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.299256324768066
Epoch: 16, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.005 Vali Acc: 0.520 Test Loss: 1.005 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.153467893600464
Epoch: 17, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.001 Vali Acc: 0.490 Test Loss: 1.001 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.452537536621094
Epoch: 18, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.183 Vali Acc: 0.550 Test Loss: 1.183 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.049606084823608
Epoch: 19, Steps: 20 | Train Loss: 0.295 Vali Loss: 1.233 Vali Acc: 0.460 Test Loss: 1.233 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.044215440750122
Epoch: 1, Steps: 20 | Train Loss: 0.753 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.468662738800049
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.791 Vali Acc: 0.430 Test Loss: 0.791 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.728254556655884
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.809 Vali Acc: 0.460 Test Loss: 0.809 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.7132728099823
Epoch: 4, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.804 Vali Acc: 0.480 Test Loss: 0.804 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.420022487640381
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.587622880935669
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.799 Vali Acc: 0.490 Test Loss: 0.799 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.879849195480347
Epoch: 7, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.778 Vali Acc: 0.550 Test Loss: 0.778 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 5.680882453918457
Epoch: 8, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.362289905548096
Epoch: 9, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.824 Vali Acc: 0.590 Test Loss: 0.824 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589992).  Saving model ...
Epoch: 10 cost time: 5.618250608444214
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.773 Vali Acc: 0.560 Test Loss: 0.773 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.7334465980529785
Epoch: 11, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.920 Vali Acc: 0.480 Test Loss: 0.920 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.7555224895477295
Epoch: 12, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.849 Vali Acc: 0.550 Test Loss: 0.849 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.662521123886108
Epoch: 13, Steps: 20 | Train Loss: 0.450 Vali Loss: 0.846 Vali Acc: 0.490 Test Loss: 0.846 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.1654372215271
Epoch: 14, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.923 Vali Acc: 0.550 Test Loss: 0.923 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.943384647369385
Epoch: 15, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.689205169677734
Epoch: 16, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.857 Vali Acc: 0.550 Test Loss: 0.857 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.003954172134399
Epoch: 17, Steps: 20 | Train Loss: 0.318 Vali Loss: 0.969 Vali Acc: 0.500 Test Loss: 0.969 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.177923679351807
Epoch: 18, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.157 Vali Acc: 0.590 Test Loss: 1.157 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.490873575210571
Epoch: 19, Steps: 20 | Train Loss: 0.300 Vali Loss: 1.118 Vali Acc: 0.500 Test Loss: 1.118 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.633627891540527
Epoch: 1, Steps: 20 | Train Loss: 0.755 Vali Loss: 0.763 Vali Acc: 0.430 Test Loss: 0.763 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 5.845604419708252
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.810 Vali Acc: 0.430 Test Loss: 0.810 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5759758949279785
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.813 Vali Acc: 0.440 Test Loss: 0.813 Test Acc: 0.440
Validation loss decreased (-0.429992 --> -0.439992).  Saving model ...
Epoch: 4 cost time: 5.610049247741699
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.805 Vali Acc: 0.460 Test Loss: 0.805 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459992).  Saving model ...
Epoch: 5 cost time: 5.763883829116821
Epoch: 5, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
Validation loss decreased (-0.459992 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 5.67911958694458
Epoch: 6, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 5.690628528594971
Epoch: 7, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 8 cost time: 5.708681106567383
Epoch: 8, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 5.502047061920166
Epoch: 9, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.856245279312134
Epoch: 10, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.795 Vali Acc: 0.550 Test Loss: 0.795 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 6.183053255081177
Epoch: 11, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.922 Vali Acc: 0.530 Test Loss: 0.922 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.929468631744385
Epoch: 12, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.826 Vali Acc: 0.500 Test Loss: 0.826 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.464236497879028
Epoch: 13, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.825962781906128
Epoch: 14, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.886 Vali Acc: 0.560 Test Loss: 0.886 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559991).  Saving model ...
Epoch: 15 cost time: 6.157178163528442
Epoch: 15, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.465326547622681
Epoch: 16, Steps: 20 | Train Loss: 0.401 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
Validation loss decreased (-0.559991 --> -0.559991).  Saving model ...
Epoch: 17 cost time: 5.704590082168579
Epoch: 17, Steps: 20 | Train Loss: 0.356 Vali Loss: 0.965 Vali Acc: 0.520 Test Loss: 0.965 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.546244859695435
Epoch: 18, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.223 Vali Acc: 0.540 Test Loss: 1.223 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.6408257484436035
Epoch: 19, Steps: 20 | Train Loss: 0.329 Vali Loss: 1.170 Vali Acc: 0.510 Test Loss: 1.170 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.741771221160889
Epoch: 20, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.174 Vali Acc: 0.530 Test Loss: 1.174 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.735498666763306
Epoch: 21, Steps: 20 | Train Loss: 0.257 Vali Loss: 1.276 Vali Acc: 0.480 Test Loss: 1.276 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.655397415161133
Epoch: 22, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.085 Vali Acc: 0.610 Test Loss: 1.085 Test Acc: 0.610
Validation loss decreased (-0.559991 --> -0.609989).  Saving model ...
Epoch: 23 cost time: 5.696307182312012
Epoch: 23, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.315 Vali Acc: 0.550 Test Loss: 1.315 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.930500745773315
Epoch: 24, Steps: 20 | Train Loss: 0.176 Vali Loss: 1.087 Vali Acc: 0.620 Test Loss: 1.087 Test Acc: 0.620
Validation loss decreased (-0.609989 --> -0.619989).  Saving model ...
Epoch: 25 cost time: 5.934211015701294
Epoch: 25, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.340 Vali Acc: 0.590 Test Loss: 1.340 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.060024261474609
Epoch: 26, Steps: 20 | Train Loss: 0.138 Vali Loss: 1.454 Vali Acc: 0.540 Test Loss: 1.454 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.716284275054932
Epoch: 27, Steps: 20 | Train Loss: 0.124 Vali Loss: 1.530 Vali Acc: 0.540 Test Loss: 1.530 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.703310251235962
Epoch: 28, Steps: 20 | Train Loss: 0.107 Vali Loss: 1.563 Vali Acc: 0.540 Test Loss: 1.563 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.840129375457764
Epoch: 29, Steps: 20 | Train Loss: 0.075 Vali Loss: 1.514 Vali Acc: 0.570 Test Loss: 1.514 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.600066184997559
Epoch: 30, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.661 Vali Acc: 0.570 Test Loss: 1.661 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.50429892539978
Epoch: 31, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.759 Vali Acc: 0.560 Test Loss: 1.759 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.511222839355469
Epoch: 32, Steps: 20 | Train Loss: 0.063 Vali Loss: 1.623 Vali Acc: 0.580 Test Loss: 1.623 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.477548837661743
Epoch: 33, Steps: 20 | Train Loss: 0.050 Vali Loss: 1.826 Vali Acc: 0.580 Test Loss: 1.826 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.8747239112854
Epoch: 34, Steps: 20 | Train Loss: 0.033 Vali Loss: 1.693 Vali Acc: 0.570 Test Loss: 1.693 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.98493766784668
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.771 Vali Acc: 0.440 Test Loss: 0.771 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 5.378851652145386
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.850 Vali Acc: 0.440 Test Loss: 0.850 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.555576324462891
Epoch: 3, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.911 Vali Acc: 0.410 Test Loss: 0.911 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.6077046394348145
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.891 Vali Acc: 0.420 Test Loss: 0.891 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.551062822341919
Epoch: 5, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.897 Vali Acc: 0.430 Test Loss: 0.897 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.336242437362671
Epoch: 6, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.914 Vali Acc: 0.420 Test Loss: 0.914 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.767454385757446
Epoch: 7, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.952 Vali Acc: 0.430 Test Loss: 0.952 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.4827704429626465
Epoch: 8, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.914 Vali Acc: 0.450 Test Loss: 0.914 Test Acc: 0.450
Validation loss decreased (-0.439992 --> -0.449991).  Saving model ...
Epoch: 9 cost time: 5.299620866775513
Epoch: 9, Steps: 20 | Train Loss: 0.586 Vali Loss: 1.040 Vali Acc: 0.530 Test Loss: 1.040 Test Acc: 0.530
Validation loss decreased (-0.449991 --> -0.529990).  Saving model ...
Epoch: 10 cost time: 5.462489604949951
Epoch: 10, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.983 Vali Acc: 0.490 Test Loss: 0.983 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.306650161743164
Epoch: 11, Steps: 20 | Train Loss: 0.507 Vali Loss: 1.128 Vali Acc: 0.460 Test Loss: 1.128 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.515577793121338
Epoch: 12, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.950 Vali Acc: 0.500 Test Loss: 0.950 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.968064069747925
Epoch: 13, Steps: 20 | Train Loss: 0.516 Vali Loss: 1.006 Vali Acc: 0.480 Test Loss: 1.006 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.772690773010254
Epoch: 14, Steps: 20 | Train Loss: 0.481 Vali Loss: 1.012 Vali Acc: 0.580 Test Loss: 1.012 Test Acc: 0.580
Validation loss decreased (-0.529990 --> -0.579990).  Saving model ...
Epoch: 15 cost time: 5.479123115539551
Epoch: 15, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.952 Vali Acc: 0.520 Test Loss: 0.952 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.023091077804565
Epoch: 16, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.956 Vali Acc: 0.570 Test Loss: 0.956 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.806992053985596
Epoch: 17, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.967 Vali Acc: 0.590 Test Loss: 0.967 Test Acc: 0.590
Validation loss decreased (-0.579990 --> -0.589990).  Saving model ...
Epoch: 18 cost time: 5.858765125274658
Epoch: 18, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
Validation loss decreased (-0.589990 --> -0.599988).  Saving model ...
Epoch: 19 cost time: 5.92947244644165
Epoch: 19, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.254 Vali Acc: 0.560 Test Loss: 1.254 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.911665916442871
Epoch: 20, Steps: 20 | Train Loss: 0.447 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 6.145508527755737
Epoch: 21, Steps: 20 | Train Loss: 0.334 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.3046979904174805
Epoch: 22, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.187 Vali Acc: 0.590 Test Loss: 1.187 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.294222831726074
Epoch: 23, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.331 Vali Acc: 0.480 Test Loss: 1.331 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.799567937850952
Epoch: 24, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 5.759509801864624
Epoch: 25, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.307 Vali Acc: 0.610 Test Loss: 1.307 Test Acc: 0.610
Validation loss decreased (-0.599990 --> -0.609987).  Saving model ...
Epoch: 26 cost time: 5.97568941116333
Epoch: 26, Steps: 20 | Train Loss: 0.265 Vali Loss: 1.393 Vali Acc: 0.570 Test Loss: 1.393 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.707523822784424
Epoch: 27, Steps: 20 | Train Loss: 0.205 Vali Loss: 1.332 Vali Acc: 0.560 Test Loss: 1.332 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.579300403594971
Epoch: 28, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.597 Vali Acc: 0.500 Test Loss: 1.597 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.296132564544678
Epoch: 29, Steps: 20 | Train Loss: 0.161 Vali Loss: 1.332 Vali Acc: 0.520 Test Loss: 1.332 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.27937126159668
Epoch: 30, Steps: 20 | Train Loss: 0.159 Vali Loss: 1.542 Vali Acc: 0.560 Test Loss: 1.542 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.826977491378784
Epoch: 31, Steps: 20 | Train Loss: 0.117 Vali Loss: 1.650 Vali Acc: 0.560 Test Loss: 1.650 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.080204010009766
Epoch: 32, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.560 Vali Acc: 0.540 Test Loss: 1.560 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.875209331512451
Epoch: 33, Steps: 20 | Train Loss: 0.110 Vali Loss: 1.707 Vali Acc: 0.570 Test Loss: 1.707 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.11958646774292
Epoch: 34, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.691 Vali Acc: 0.510 Test Loss: 1.691 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.853610038757324
Epoch: 35, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.574 Vali Acc: 0.550 Test Loss: 1.574 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.591679334640503
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.730 Vali Acc: 0.380 Test Loss: 0.730 Test Acc: 0.380
Validation loss decreased (inf --> -0.379993).  Saving model ...
Epoch: 2 cost time: 5.676084756851196
Epoch: 2, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.738 Vali Acc: 0.480 Test Loss: 0.738 Test Acc: 0.480
Validation loss decreased (-0.379993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 5.857024192810059
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.747 Vali Acc: 0.530 Test Loss: 0.747 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 5.992757081985474
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.743 Vali Acc: 0.490 Test Loss: 0.743 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.395781755447388
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.829 Vali Acc: 0.480 Test Loss: 0.829 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.92235541343689
Epoch: 6, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.877752780914307
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 5.939573526382446
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.039377450942993
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.809 Vali Acc: 0.570 Test Loss: 0.809 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 6.157576322555542
Epoch: 10, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.774 Vali Acc: 0.580 Test Loss: 0.774 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 6.041069269180298
Epoch: 11, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.944 Vali Acc: 0.530 Test Loss: 0.944 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.878054141998291
Epoch: 12, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.848 Vali Acc: 0.590 Test Loss: 0.848 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 13 cost time: 5.858522415161133
Epoch: 13, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.869 Vali Acc: 0.600 Test Loss: 0.869 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599991).  Saving model ...
Epoch: 14 cost time: 6.037163257598877
Epoch: 14, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.813 Vali Acc: 0.550 Test Loss: 0.813 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.801300525665283
Epoch: 15, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.882 Vali Acc: 0.610 Test Loss: 0.882 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609991).  Saving model ...
Epoch: 16 cost time: 5.8530895709991455
Epoch: 16, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.929 Vali Acc: 0.620 Test Loss: 0.929 Test Acc: 0.620
Validation loss decreased (-0.609991 --> -0.619991).  Saving model ...
Epoch: 17 cost time: 5.46306586265564
Epoch: 17, Steps: 20 | Train Loss: 0.512 Vali Loss: 1.015 Vali Acc: 0.550 Test Loss: 1.015 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.662937879562378
Epoch: 18, Steps: 20 | Train Loss: 0.492 Vali Loss: 1.053 Vali Acc: 0.570 Test Loss: 1.053 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.787731170654297
Epoch: 19, Steps: 20 | Train Loss: 0.498 Vali Loss: 1.300 Vali Acc: 0.510 Test Loss: 1.300 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.634185075759888
Epoch: 20, Steps: 20 | Train Loss: 0.482 Vali Loss: 1.154 Vali Acc: 0.560 Test Loss: 1.154 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.634930610656738
Epoch: 21, Steps: 20 | Train Loss: 0.448 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.762198448181152
Epoch: 22, Steps: 20 | Train Loss: 0.428 Vali Loss: 1.138 Vali Acc: 0.580 Test Loss: 1.138 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.072576284408569
Epoch: 23, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.075 Vali Acc: 0.620 Test Loss: 1.075 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.9865803718566895
Epoch: 24, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.090 Vali Acc: 0.610 Test Loss: 1.090 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.569827556610107
Epoch: 25, Steps: 20 | Train Loss: 0.346 Vali Loss: 1.213 Vali Acc: 0.580 Test Loss: 1.213 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.665529012680054
Epoch: 26, Steps: 20 | Train Loss: 0.276 Vali Loss: 1.208 Vali Acc: 0.630 Test Loss: 1.208 Test Acc: 0.630
Validation loss decreased (-0.619991 --> -0.629988).  Saving model ...
Epoch: 27 cost time: 5.633459091186523
Epoch: 27, Steps: 20 | Train Loss: 0.269 Vali Loss: 1.336 Vali Acc: 0.580 Test Loss: 1.336 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.578855037689209
Epoch: 28, Steps: 20 | Train Loss: 0.299 Vali Loss: 1.876 Vali Acc: 0.520 Test Loss: 1.876 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.66030740737915
Epoch: 29, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.523 Vali Acc: 0.580 Test Loss: 1.523 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.808266878128052
Epoch: 30, Steps: 20 | Train Loss: 0.239 Vali Loss: 1.579 Vali Acc: 0.560 Test Loss: 1.579 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.87220311164856
Epoch: 31, Steps: 20 | Train Loss: 0.171 Vali Loss: 1.571 Vali Acc: 0.530 Test Loss: 1.571 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.210480451583862
Epoch: 32, Steps: 20 | Train Loss: 0.199 Vali Loss: 1.670 Vali Acc: 0.560 Test Loss: 1.670 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.9634013175964355
Epoch: 33, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.776 Vali Acc: 0.540 Test Loss: 1.776 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.207131624221802
Epoch: 34, Steps: 20 | Train Loss: 0.116 Vali Loss: 1.861 Vali Acc: 0.540 Test Loss: 1.861 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.243972539901733
Epoch: 35, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.925 Vali Acc: 0.520 Test Loss: 1.925 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.012834072113037
Epoch: 36, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.803 Vali Acc: 0.500 Test Loss: 1.803 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.544785261154175
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.706 Vali Acc: 0.520 Test Loss: 0.706 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.925967216491699
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.719 Vali Acc: 0.580 Test Loss: 0.719 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 5.6995227336883545
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.916633605957031
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.271112680435181
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.881731748580933
Epoch: 6, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.769 Vali Acc: 0.580 Test Loss: 0.769 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.00217604637146
Epoch: 7, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.789 Vali Acc: 0.610 Test Loss: 0.789 Test Acc: 0.610
Validation loss decreased (-0.579993 --> -0.609992).  Saving model ...
Epoch: 8 cost time: 5.564343214035034
Epoch: 8, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.790 Vali Acc: 0.620 Test Loss: 0.790 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619992).  Saving model ...
Epoch: 9 cost time: 5.837787389755249
Epoch: 9, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.833 Vali Acc: 0.570 Test Loss: 0.833 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.343546152114868
Epoch: 10, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.810703992843628
Epoch: 11, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.976 Vali Acc: 0.510 Test Loss: 0.976 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.52925705909729
Epoch: 12, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.841 Vali Acc: 0.580 Test Loss: 0.841 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.597618103027344
Epoch: 13, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.877 Vali Acc: 0.580 Test Loss: 0.877 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.627388000488281
Epoch: 14, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.875 Vali Acc: 0.570 Test Loss: 0.875 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.533560037612915
Epoch: 15, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.784590244293213
Epoch: 16, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.966 Vali Acc: 0.590 Test Loss: 0.966 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.293700695037842
Epoch: 17, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.066 Vali Acc: 0.550 Test Loss: 1.066 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.61235785484314
Epoch: 18, Steps: 20 | Train Loss: 0.451 Vali Loss: 1.112 Vali Acc: 0.580 Test Loss: 1.112 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.475474834442139
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.379974842071533
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 5.8318634033203125
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.525498867034912
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.709197044372559
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.434161424636841
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.602099180221558
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.882156848907471
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.6317527294158936
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.03642463684082
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.870698928833008
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.840101480484009
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 885890
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.492129564285278
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.707 Vali Acc: 0.500 Test Loss: 0.707 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.749776840209961
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.751 Vali Acc: 0.470 Test Loss: 0.751 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.569459676742554
Epoch: 3, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.016420125961304
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.800 Vali Acc: 0.460 Test Loss: 0.800 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.461205720901489
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.817 Vali Acc: 0.470 Test Loss: 0.817 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.272891521453857
Epoch: 6, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.944 Vali Acc: 0.540 Test Loss: 0.944 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539991).  Saving model ...
Epoch: 7 cost time: 5.78100061416626
Epoch: 7, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.837 Vali Acc: 0.470 Test Loss: 0.837 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.923670530319214
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.879 Vali Acc: 0.480 Test Loss: 0.879 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.793055057525635
Epoch: 9, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.818 Vali Acc: 0.480 Test Loss: 0.818 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.760565757751465
Epoch: 10, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.51873779296875
Epoch: 11, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.868 Vali Acc: 0.520 Test Loss: 0.868 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.720674514770508
Epoch: 12, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.936 Vali Acc: 0.560 Test Loss: 0.936 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559991).  Saving model ...
Epoch: 13 cost time: 5.681022644042969
Epoch: 13, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5812506675720215
Epoch: 14, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.977 Vali Acc: 0.540 Test Loss: 0.977 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.884207487106323
Epoch: 15, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.952 Vali Acc: 0.540 Test Loss: 0.952 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.736453533172607
Epoch: 16, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.953 Vali Acc: 0.540 Test Loss: 0.953 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.625800371170044
Epoch: 17, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.068 Vali Acc: 0.530 Test Loss: 1.068 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.383815050125122
Epoch: 18, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.971 Vali Acc: 0.510 Test Loss: 0.971 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.745393991470337
Epoch: 19, Steps: 20 | Train Loss: 0.350 Vali Loss: 1.021 Vali Acc: 0.530 Test Loss: 1.021 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.077818155288696
Epoch: 20, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.087 Vali Acc: 0.530 Test Loss: 1.087 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.971896171569824
Epoch: 21, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.101 Vali Acc: 0.540 Test Loss: 1.101 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.679632663726807
Epoch: 22, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.325565338134766
Epoch: 1, Steps: 20 | Train Loss: 0.730 Vali Loss: 0.701 Vali Acc: 0.490 Test Loss: 0.701 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.700365304946899
Epoch: 2, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.753 Vali Acc: 0.480 Test Loss: 0.753 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.854903936386108
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.776 Vali Acc: 0.460 Test Loss: 0.776 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.984894275665283
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.800 Vali Acc: 0.470 Test Loss: 0.800 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.125964879989624
Epoch: 5, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.822 Vali Acc: 0.480 Test Loss: 0.822 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.6752588748931885
Epoch: 6, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.939 Vali Acc: 0.510 Test Loss: 0.939 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509991).  Saving model ...
Epoch: 7 cost time: 5.775634288787842
Epoch: 7, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.990315675735474
Epoch: 8, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.884 Vali Acc: 0.500 Test Loss: 0.884 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.267938613891602
Epoch: 9, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.824 Vali Acc: 0.520 Test Loss: 0.824 Test Acc: 0.520
Validation loss decreased (-0.509991 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 5.600322723388672
Epoch: 10, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.6092915534973145
Epoch: 11, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.894 Vali Acc: 0.490 Test Loss: 0.894 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.718697786331177
Epoch: 12, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.968 Vali Acc: 0.520 Test Loss: 0.968 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.307848215103149
Epoch: 13, Steps: 20 | Train Loss: 0.471 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.3716139793396
Epoch: 14, Steps: 20 | Train Loss: 0.497 Vali Loss: 1.067 Vali Acc: 0.530 Test Loss: 1.067 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529989).  Saving model ...
Epoch: 15 cost time: 5.782255411148071
Epoch: 15, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.925 Vali Acc: 0.510 Test Loss: 0.925 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.874974727630615
Epoch: 16, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.983 Vali Acc: 0.530 Test Loss: 0.983 Test Acc: 0.530
Validation loss decreased (-0.529989 --> -0.529990).  Saving model ...
Epoch: 17 cost time: 5.77678656578064
Epoch: 17, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.095 Vali Acc: 0.520 Test Loss: 1.095 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.04077410697937
Epoch: 18, Steps: 20 | Train Loss: 0.362 Vali Loss: 0.971 Vali Acc: 0.550 Test Loss: 0.971 Test Acc: 0.550
Validation loss decreased (-0.529990 --> -0.549990).  Saving model ...
Epoch: 19 cost time: 5.867428779602051
Epoch: 19, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.077 Vali Acc: 0.560 Test Loss: 1.077 Test Acc: 0.560
Validation loss decreased (-0.549990 --> -0.559989).  Saving model ...
Epoch: 20 cost time: 5.541149377822876
Epoch: 20, Steps: 20 | Train Loss: 0.281 Vali Loss: 1.175 Vali Acc: 0.570 Test Loss: 1.175 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569988).  Saving model ...
Epoch: 21 cost time: 5.474761486053467
Epoch: 21, Steps: 20 | Train Loss: 0.298 Vali Loss: 1.147 Vali Acc: 0.530 Test Loss: 1.147 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.68615460395813
Epoch: 22, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.252 Vali Acc: 0.540 Test Loss: 1.252 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.698320627212524
Epoch: 23, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.342 Vali Acc: 0.570 Test Loss: 1.342 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.83467698097229
Epoch: 24, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.235 Vali Acc: 0.530 Test Loss: 1.235 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.8698570728302
Epoch: 25, Steps: 20 | Train Loss: 0.226 Vali Loss: 1.452 Vali Acc: 0.510 Test Loss: 1.452 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.74188756942749
Epoch: 26, Steps: 20 | Train Loss: 0.145 Vali Loss: 1.313 Vali Acc: 0.520 Test Loss: 1.313 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.773053407669067
Epoch: 27, Steps: 20 | Train Loss: 0.141 Vali Loss: 1.342 Vali Acc: 0.570 Test Loss: 1.342 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.112386226654053
Epoch: 28, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.370 Vali Acc: 0.550 Test Loss: 1.370 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.670253276824951
Epoch: 29, Steps: 20 | Train Loss: 0.111 Vali Loss: 1.663 Vali Acc: 0.520 Test Loss: 1.663 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.11119270324707
Epoch: 30, Steps: 20 | Train Loss: 0.135 Vali Loss: 1.526 Vali Acc: 0.510 Test Loss: 1.526 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.720287561416626
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.696 Vali Acc: 0.520 Test Loss: 0.696 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 6.187687397003174
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.02970290184021
Epoch: 3, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 5.743719577789307
Epoch: 4, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.78196907043457
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.007751703262329
Epoch: 6, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.911 Vali Acc: 0.510 Test Loss: 0.911 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.2955310344696045
Epoch: 7, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.516629457473755
Epoch: 8, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.827 Vali Acc: 0.530 Test Loss: 0.827 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.581674098968506
Epoch: 9, Steps: 20 | Train Loss: 0.541 Vali Loss: 0.790 Vali Acc: 0.520 Test Loss: 0.790 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.945664882659912
Epoch: 10, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.719095230102539
Epoch: 11, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.835 Vali Acc: 0.540 Test Loss: 0.835 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.865371227264404
Epoch: 12, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.658561706542969
Epoch: 13, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.773 Vali Acc: 0.590 Test Loss: 0.773 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 14 cost time: 5.8429083824157715
Epoch: 14, Steps: 20 | Train Loss: 0.503 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 5.543941020965576
Epoch: 15, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.859 Vali Acc: 0.560 Test Loss: 0.859 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.6033031940460205
Epoch: 16, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.665623426437378
Epoch: 17, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.928 Vali Acc: 0.580 Test Loss: 0.928 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.323528289794922
Epoch: 18, Steps: 20 | Train Loss: 0.359 Vali Loss: 0.942 Vali Acc: 0.560 Test Loss: 0.942 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.43212366104126
Epoch: 19, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.984 Vali Acc: 0.590 Test Loss: 0.984 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.634039640426636
Epoch: 20, Steps: 20 | Train Loss: 0.287 Vali Loss: 1.006 Vali Acc: 0.570 Test Loss: 1.006 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.955960988998413
Epoch: 21, Steps: 20 | Train Loss: 0.286 Vali Loss: 0.961 Vali Acc: 0.590 Test Loss: 0.961 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.465882778167725
Epoch: 22, Steps: 20 | Train Loss: 0.238 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.639540433883667
Epoch: 23, Steps: 20 | Train Loss: 0.249 Vali Loss: 1.157 Vali Acc: 0.590 Test Loss: 1.157 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.021068096160889
Epoch: 24, Steps: 20 | Train Loss: 0.207 Vali Loss: 1.085 Vali Acc: 0.540 Test Loss: 1.085 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.575646638870239
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.465628385543823
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 5.725569248199463
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.002924919128418
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.826 Vali Acc: 0.480 Test Loss: 0.826 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.870115518569946
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.838 Vali Acc: 0.480 Test Loss: 0.838 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.086793899536133
Epoch: 6, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.919 Vali Acc: 0.490 Test Loss: 0.919 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.9260804653167725
Epoch: 7, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.834 Vali Acc: 0.480 Test Loss: 0.834 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.7673351764678955
Epoch: 8, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.843 Vali Acc: 0.550 Test Loss: 0.843 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 5.671204090118408
Epoch: 9, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 5.643956422805786
Epoch: 10, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.091695070266724
Epoch: 11, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.871 Vali Acc: 0.520 Test Loss: 0.871 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.7160866260528564
Epoch: 12, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.911 Vali Acc: 0.520 Test Loss: 0.911 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.91072940826416
Epoch: 13, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.790 Vali Acc: 0.540 Test Loss: 0.790 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.697521209716797
Epoch: 14, Steps: 20 | Train Loss: 0.521 Vali Loss: 1.068 Vali Acc: 0.550 Test Loss: 1.068 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.498292922973633
Epoch: 15, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.868 Vali Acc: 0.550 Test Loss: 0.868 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.7581682205200195
Epoch: 16, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.70668888092041
Epoch: 17, Steps: 20 | Train Loss: 0.422 Vali Loss: 0.878 Vali Acc: 0.520 Test Loss: 0.878 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.56282901763916
Epoch: 18, Steps: 20 | Train Loss: 0.371 Vali Loss: 0.942 Vali Acc: 0.520 Test Loss: 0.942 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.537961483001709
Epoch: 19, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.008 Vali Acc: 0.560 Test Loss: 1.008 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559990).  Saving model ...
Epoch: 20 cost time: 5.61082124710083
Epoch: 20, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.131 Vali Acc: 0.560 Test Loss: 1.131 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.867618799209595
Epoch: 21, Steps: 20 | Train Loss: 0.312 Vali Loss: 1.072 Vali Acc: 0.560 Test Loss: 1.072 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.7298500537872314
Epoch: 22, Steps: 20 | Train Loss: 0.270 Vali Loss: 1.065 Vali Acc: 0.560 Test Loss: 1.065 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.757296085357666
Epoch: 23, Steps: 20 | Train Loss: 0.255 Vali Loss: 1.194 Vali Acc: 0.550 Test Loss: 1.194 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.081995487213135
Epoch: 24, Steps: 20 | Train Loss: 0.222 Vali Loss: 1.208 Vali Acc: 0.560 Test Loss: 1.208 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.842737913131714
Epoch: 25, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.308 Vali Acc: 0.560 Test Loss: 1.308 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.835173606872559
Epoch: 26, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.318 Vali Acc: 0.590 Test Loss: 1.318 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589987).  Saving model ...
Epoch: 27 cost time: 5.790929794311523
Epoch: 27, Steps: 20 | Train Loss: 0.177 Vali Loss: 1.299 Vali Acc: 0.580 Test Loss: 1.299 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.669090986251831
Epoch: 28, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.349 Vali Acc: 0.550 Test Loss: 1.349 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.531935930252075
Epoch: 29, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.622 Vali Acc: 0.510 Test Loss: 1.622 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.190018177032471
Epoch: 30, Steps: 20 | Train Loss: 0.136 Vali Loss: 1.558 Vali Acc: 0.500 Test Loss: 1.558 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.062174558639526
Epoch: 31, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.735 Vali Acc: 0.570 Test Loss: 1.735 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.428548097610474
Epoch: 32, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.515 Vali Acc: 0.550 Test Loss: 1.515 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.8003809452056885
Epoch: 33, Steps: 20 | Train Loss: 0.076 Vali Loss: 1.635 Vali Acc: 0.530 Test Loss: 1.635 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.594068288803101
Epoch: 34, Steps: 20 | Train Loss: 0.070 Vali Loss: 1.637 Vali Acc: 0.590 Test Loss: 1.637 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.77778172492981
Epoch: 35, Steps: 20 | Train Loss: 0.048 Vali Loss: 1.771 Vali Acc: 0.560 Test Loss: 1.771 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.757709980010986
Epoch: 36, Steps: 20 | Train Loss: 0.040 Vali Loss: 1.658 Vali Acc: 0.590 Test Loss: 1.658 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.485323190689087
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 6.039848566055298
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.794 Vali Acc: 0.470 Test Loss: 0.794 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.093190908432007
Epoch: 3, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.839 Vali Acc: 0.440 Test Loss: 0.839 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.46527361869812
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.879 Vali Acc: 0.440 Test Loss: 0.879 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.715728521347046
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.952 Vali Acc: 0.400 Test Loss: 0.952 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.636419296264648
Epoch: 6, Steps: 20 | Train Loss: 0.604 Vali Loss: 1.042 Vali Acc: 0.490 Test Loss: 1.042 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.4327569007873535
Epoch: 7, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.905 Vali Acc: 0.450 Test Loss: 0.905 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.462430477142334
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.942 Vali Acc: 0.480 Test Loss: 0.942 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.569475412368774
Epoch: 9, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.935 Vali Acc: 0.490 Test Loss: 0.935 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.5100226402282715
Epoch: 10, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.73094367980957
Epoch: 11, Steps: 20 | Train Loss: 0.540 Vali Loss: 1.032 Vali Acc: 0.490 Test Loss: 1.032 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.5
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.7001893520355225
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 5.808710098266602
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.093553066253662
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.899126052856445
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.745 Vali Acc: 0.480 Test Loss: 0.745 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.2172791957855225
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.768 Vali Acc: 0.530 Test Loss: 0.768 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.502356767654419
Epoch: 6, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.846 Vali Acc: 0.530 Test Loss: 0.846 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.896864175796509
Epoch: 7, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.812 Vali Acc: 0.520 Test Loss: 0.812 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.559937953948975
Epoch: 8, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.787 Vali Acc: 0.580 Test Loss: 0.787 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 6.048945665359497
Epoch: 9, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.813 Vali Acc: 0.560 Test Loss: 0.813 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.038142442703247
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.787 Vali Acc: 0.590 Test Loss: 0.787 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 11 cost time: 5.865908861160278
Epoch: 11, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.807 Vali Acc: 0.550 Test Loss: 0.807 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.899965047836304
Epoch: 12, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.893 Vali Acc: 0.570 Test Loss: 0.893 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.961260795593262
Epoch: 13, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.904 Vali Acc: 0.560 Test Loss: 0.904 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.912750959396362
Epoch: 14, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.971 Vali Acc: 0.570 Test Loss: 0.971 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.7760114669799805
Epoch: 15, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.928 Vali Acc: 0.610 Test Loss: 0.928 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609991).  Saving model ...
Epoch: 16 cost time: 5.591993570327759
Epoch: 16, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.880 Vali Acc: 0.580 Test Loss: 0.880 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.962864637374878
Epoch: 17, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.893 Vali Acc: 0.550 Test Loss: 0.893 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.824442386627197
Epoch: 18, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.980 Vali Acc: 0.580 Test Loss: 0.980 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.563176155090332
Epoch: 19, Steps: 20 | Train Loss: 0.463 Vali Loss: 1.091 Vali Acc: 0.550 Test Loss: 1.091 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.674995422363281
Epoch: 20, Steps: 20 | Train Loss: 0.454 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.15071702003479
Epoch: 21, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.966375827789307
Epoch: 22, Steps: 20 | Train Loss: 0.424 Vali Loss: 1.264 Vali Acc: 0.570 Test Loss: 1.264 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.608208656311035
Epoch: 23, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.267 Vali Acc: 0.570 Test Loss: 1.267 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.288307189941406
Epoch: 24, Steps: 20 | Train Loss: 0.382 Vali Loss: 1.200 Vali Acc: 0.580 Test Loss: 1.200 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.0143444538116455
Epoch: 25, Steps: 20 | Train Loss: 0.372 Vali Loss: 1.275 Vali Acc: 0.560 Test Loss: 1.275 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.420632839202881
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.573338031768799
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 5.741785764694214
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.52556037902832
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.645056962966919
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.783 Vali Acc: 0.570 Test Loss: 0.783 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 5.456064224243164
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.869 Vali Acc: 0.560 Test Loss: 0.869 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.0371222496032715
Epoch: 7, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.562759876251221
Epoch: 8, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.814 Vali Acc: 0.590 Test Loss: 0.814 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 9 cost time: 5.533191442489624
Epoch: 9, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.835 Vali Acc: 0.560 Test Loss: 0.835 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.540430307388306
Epoch: 10, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.807 Vali Acc: 0.570 Test Loss: 0.807 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.46075963973999
Epoch: 11, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.813 Vali Acc: 0.530 Test Loss: 0.813 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.483087062835693
Epoch: 12, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.920 Vali Acc: 0.590 Test Loss: 0.920 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.235050916671753
Epoch: 13, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.930 Vali Acc: 0.580 Test Loss: 0.930 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.522004842758179
Epoch: 14, Steps: 20 | Train Loss: 0.606 Vali Loss: 1.027 Vali Acc: 0.530 Test Loss: 1.027 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.590176820755005
Epoch: 15, Steps: 20 | Train Loss: 0.511 Vali Loss: 1.001 Vali Acc: 0.610 Test Loss: 1.001 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609990).  Saving model ...
Epoch: 16 cost time: 5.371816635131836
Epoch: 16, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.909 Vali Acc: 0.570 Test Loss: 0.909 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.2031402587890625
Epoch: 17, Steps: 20 | Train Loss: 0.501 Vali Loss: 0.927 Vali Acc: 0.580 Test Loss: 0.927 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.205792427062988
Epoch: 18, Steps: 20 | Train Loss: 0.475 Vali Loss: 1.048 Vali Acc: 0.570 Test Loss: 1.048 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.511988639831543
Epoch: 19, Steps: 20 | Train Loss: 0.433 Vali Loss: 1.121 Vali Acc: 0.560 Test Loss: 1.121 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.252800703048706
Epoch: 20, Steps: 20 | Train Loss: 0.420 Vali Loss: 1.117 Vali Acc: 0.590 Test Loss: 1.117 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.391464710235596
Epoch: 21, Steps: 20 | Train Loss: 0.362 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.459562063217163
Epoch: 22, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.316856622695923
Epoch: 23, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.308 Vali Acc: 0.510 Test Loss: 1.308 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.303196907043457
Epoch: 24, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.230 Vali Acc: 0.580 Test Loss: 1.230 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.2969372272491455
Epoch: 25, Steps: 20 | Train Loss: 0.345 Vali Loss: 1.294 Vali Acc: 0.560 Test Loss: 1.294 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.756206512451172
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.962430953979492
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.583754301071167
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.704692363739014
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.529063940048218
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.450319766998291
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.48365592956543
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.720617771148682
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.776688098907471
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.603301048278809
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.267803907394409
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 689282
model size : 7.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.5550501346588135
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.751 Vali Acc: 0.460 Test Loss: 0.751 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 5.682400226593018
Epoch: 2, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 6.127295970916748
Epoch: 3, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.806 Vali Acc: 0.510 Test Loss: 0.806 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 4 cost time: 5.9461445808410645
Epoch: 4, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.092373609542847
Epoch: 5, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.105925798416138
Epoch: 6, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.832 Vali Acc: 0.490 Test Loss: 0.832 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.953174114227295
Epoch: 7, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.910465478897095
Epoch: 8, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.817 Vali Acc: 0.510 Test Loss: 0.817 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.800811529159546
Epoch: 9, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 5.836239576339722
Epoch: 10, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.851202726364136
Epoch: 11, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.880 Vali Acc: 0.490 Test Loss: 0.880 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.089481353759766
Epoch: 12, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.870 Vali Acc: 0.560 Test Loss: 0.870 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559991).  Saving model ...
Epoch: 13 cost time: 6.470370292663574
Epoch: 13, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.895 Vali Acc: 0.480 Test Loss: 0.895 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.099612236022949
Epoch: 14, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.840 Vali Acc: 0.530 Test Loss: 0.840 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.906037330627441
Epoch: 15, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.904 Vali Acc: 0.510 Test Loss: 0.904 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.789190769195557
Epoch: 16, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.043 Vali Acc: 0.490 Test Loss: 1.043 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.7266340255737305
Epoch: 17, Steps: 20 | Train Loss: 0.384 Vali Loss: 0.904 Vali Acc: 0.560 Test Loss: 0.904 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.70606255531311
Epoch: 18, Steps: 20 | Train Loss: 0.347 Vali Loss: 1.000 Vali Acc: 0.530 Test Loss: 1.000 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.772326469421387
Epoch: 19, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.321075677871704
Epoch: 20, Steps: 20 | Train Loss: 0.335 Vali Loss: 1.129 Vali Acc: 0.540 Test Loss: 1.129 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.147773265838623
Epoch: 21, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.035 Vali Acc: 0.570 Test Loss: 1.035 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569990).  Saving model ...
Epoch: 22 cost time: 5.2880470752716064
Epoch: 22, Steps: 20 | Train Loss: 0.256 Vali Loss: 1.068 Vali Acc: 0.540 Test Loss: 1.068 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.536595344543457
Epoch: 23, Steps: 20 | Train Loss: 0.251 Vali Loss: 1.184 Vali Acc: 0.510 Test Loss: 1.184 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.527009725570679
Epoch: 24, Steps: 20 | Train Loss: 0.195 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.241574287414551
Epoch: 25, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.339 Vali Acc: 0.550 Test Loss: 1.339 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.70617413520813
Epoch: 26, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.272 Vali Acc: 0.520 Test Loss: 1.272 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.42330265045166
Epoch: 27, Steps: 20 | Train Loss: 0.150 Vali Loss: 1.434 Vali Acc: 0.570 Test Loss: 1.434 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.6018195152282715
Epoch: 28, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.463 Vali Acc: 0.500 Test Loss: 1.463 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.5898377895355225
Epoch: 29, Steps: 20 | Train Loss: 0.113 Vali Loss: 1.565 Vali Acc: 0.530 Test Loss: 1.565 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.672171354293823
Epoch: 30, Steps: 20 | Train Loss: 0.082 Vali Loss: 1.491 Vali Acc: 0.540 Test Loss: 1.491 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.447996616363525
Epoch: 31, Steps: 20 | Train Loss: 0.081 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.885270118713379
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.756 Vali Acc: 0.450 Test Loss: 0.756 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 5.354342937469482
Epoch: 2, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.778 Vali Acc: 0.450 Test Loss: 0.778 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.212859869003296
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
Validation loss decreased (-0.449992 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 6.190115213394165
Epoch: 4, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 5.527282476425171
Epoch: 5, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.819 Vali Acc: 0.450 Test Loss: 0.819 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.026317596435547
Epoch: 6, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.822 Vali Acc: 0.480 Test Loss: 0.822 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.045455455780029
Epoch: 7, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.831 Vali Acc: 0.450 Test Loss: 0.831 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.714989185333252
Epoch: 8, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.633981227874756
Epoch: 9, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.823 Vali Acc: 0.450 Test Loss: 0.823 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.8642566204071045
Epoch: 10, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.843 Vali Acc: 0.470 Test Loss: 0.843 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.004827260971069
Epoch: 11, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.933 Vali Acc: 0.560 Test Loss: 0.933 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 5.8784496784210205
Epoch: 12, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.891 Vali Acc: 0.550 Test Loss: 0.891 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.301456689834595
Epoch: 13, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.908 Vali Acc: 0.520 Test Loss: 0.908 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.74641489982605
Epoch: 14, Steps: 20 | Train Loss: 0.429 Vali Loss: 0.873 Vali Acc: 0.530 Test Loss: 0.873 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.706757545471191
Epoch: 15, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.0201849937438965
Epoch: 16, Steps: 20 | Train Loss: 0.425 Vali Loss: 1.100 Vali Acc: 0.560 Test Loss: 1.100 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.765352487564087
Epoch: 17, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.965 Vali Acc: 0.510 Test Loss: 0.965 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.345403432846069
Epoch: 18, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.993 Vali Acc: 0.520 Test Loss: 0.993 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.644448757171631
Epoch: 19, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.962 Vali Acc: 0.530 Test Loss: 0.962 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.7004554271698
Epoch: 20, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.187 Vali Acc: 0.510 Test Loss: 1.187 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.774816989898682
Epoch: 21, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.117 Vali Acc: 0.540 Test Loss: 1.117 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.066800117492676
Epoch: 1, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.759 Vali Acc: 0.450 Test Loss: 0.759 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 5.7158753871917725
Epoch: 2, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.774 Vali Acc: 0.460 Test Loss: 0.774 Test Acc: 0.460
Validation loss decreased (-0.449992 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 5.4676501750946045
Epoch: 3, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.809 Vali Acc: 0.450 Test Loss: 0.809 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.745330333709717
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.806 Vali Acc: 0.490 Test Loss: 0.806 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489992).  Saving model ...
Epoch: 5 cost time: 5.880648612976074
Epoch: 5, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.808 Vali Acc: 0.480 Test Loss: 0.808 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.731772184371948
Epoch: 6, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 7 cost time: 5.706000089645386
Epoch: 7, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.829 Vali Acc: 0.470 Test Loss: 0.829 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.295217752456665
Epoch: 8, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 5.630051374435425
Epoch: 9, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.785 Vali Acc: 0.480 Test Loss: 0.785 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.262326717376709
Epoch: 10, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.840 Vali Acc: 0.480 Test Loss: 0.840 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.293497085571289
Epoch: 11, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.904 Vali Acc: 0.480 Test Loss: 0.904 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.716748237609863
Epoch: 12, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.853 Vali Acc: 0.550 Test Loss: 0.853 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549991).  Saving model ...
Epoch: 13 cost time: 5.2334465980529785
Epoch: 13, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.788 Vali Acc: 0.520 Test Loss: 0.788 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.365913152694702
Epoch: 14, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.831 Vali Acc: 0.510 Test Loss: 0.831 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.159819841384888
Epoch: 15, Steps: 20 | Train Loss: 0.403 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.461273431777954
Epoch: 16, Steps: 20 | Train Loss: 0.408 Vali Loss: 1.103 Vali Acc: 0.490 Test Loss: 1.103 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.557827472686768
Epoch: 17, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.884 Vali Acc: 0.560 Test Loss: 0.884 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559991).  Saving model ...
Epoch: 18 cost time: 5.473057508468628
Epoch: 18, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.931 Vali Acc: 0.500 Test Loss: 0.931 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.259620666503906
Epoch: 19, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.942 Vali Acc: 0.590 Test Loss: 0.942 Test Acc: 0.590
Validation loss decreased (-0.559991 --> -0.589991).  Saving model ...
Epoch: 20 cost time: 5.398303031921387
Epoch: 20, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.176 Vali Acc: 0.530 Test Loss: 1.176 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.419361591339111
Epoch: 21, Steps: 20 | Train Loss: 0.307 Vali Loss: 0.998 Vali Acc: 0.550 Test Loss: 0.998 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.087303876876831
Epoch: 22, Steps: 20 | Train Loss: 0.253 Vali Loss: 1.035 Vali Acc: 0.570 Test Loss: 1.035 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.2333738803863525
Epoch: 23, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.115 Vali Acc: 0.570 Test Loss: 1.115 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.593279600143433
Epoch: 24, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.127 Vali Acc: 0.540 Test Loss: 1.127 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.30774188041687
Epoch: 25, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.128 Vali Acc: 0.540 Test Loss: 1.128 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.198740243911743
Epoch: 26, Steps: 20 | Train Loss: 0.163 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.413388729095459
Epoch: 27, Steps: 20 | Train Loss: 0.145 Vali Loss: 1.285 Vali Acc: 0.520 Test Loss: 1.285 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.251415252685547
Epoch: 28, Steps: 20 | Train Loss: 0.101 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.448896884918213
Epoch: 29, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.361 Vali Acc: 0.500 Test Loss: 1.361 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.527691125869751
Epoch: 1, Steps: 20 | Train Loss: 0.739 Vali Loss: 0.755 Vali Acc: 0.420 Test Loss: 0.755 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 5.56470251083374
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
Validation loss decreased (-0.419992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 5.719310760498047
Epoch: 3, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.925486087799072
Epoch: 4, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.817 Vali Acc: 0.480 Test Loss: 0.817 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.972539663314819
Epoch: 5, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.825 Vali Acc: 0.450 Test Loss: 0.825 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.127946376800537
Epoch: 6, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.807 Vali Acc: 0.480 Test Loss: 0.807 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.245139837265015
Epoch: 7, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.831 Vali Acc: 0.470 Test Loss: 0.831 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.477770566940308
Epoch: 8, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 9 cost time: 5.800974607467651
Epoch: 9, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 10 cost time: 5.931821823120117
Epoch: 10, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.826 Vali Acc: 0.520 Test Loss: 0.826 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.206512928009033
Epoch: 11, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 6.187220573425293
Epoch: 12, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.851 Vali Acc: 0.550 Test Loss: 0.851 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.484607219696045
Epoch: 13, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.802 Vali Acc: 0.560 Test Loss: 0.802 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 5.8172767162323
Epoch: 14, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.822 Vali Acc: 0.550 Test Loss: 0.822 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.002246618270874
Epoch: 15, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.818 Vali Acc: 0.530 Test Loss: 0.818 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.963720798492432
Epoch: 16, Steps: 20 | Train Loss: 0.441 Vali Loss: 1.005 Vali Acc: 0.530 Test Loss: 1.005 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.999283790588379
Epoch: 17, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.883 Vali Acc: 0.510 Test Loss: 0.883 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.762263774871826
Epoch: 18, Steps: 20 | Train Loss: 0.348 Vali Loss: 0.994 Vali Acc: 0.570 Test Loss: 0.994 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569990).  Saving model ...
Epoch: 19 cost time: 6.045439958572388
Epoch: 19, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.930 Vali Acc: 0.590 Test Loss: 0.930 Test Acc: 0.590
Validation loss decreased (-0.569990 --> -0.589991).  Saving model ...
Epoch: 20 cost time: 6.14077091217041
Epoch: 20, Steps: 20 | Train Loss: 0.348 Vali Loss: 1.131 Vali Acc: 0.530 Test Loss: 1.131 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.754996061325073
Epoch: 21, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.016 Vali Acc: 0.560 Test Loss: 1.016 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.623324394226074
Epoch: 22, Steps: 20 | Train Loss: 0.272 Vali Loss: 1.023 Vali Acc: 0.580 Test Loss: 1.023 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.873242378234863
Epoch: 23, Steps: 20 | Train Loss: 0.271 Vali Loss: 1.156 Vali Acc: 0.530 Test Loss: 1.156 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.865394830703735
Epoch: 24, Steps: 20 | Train Loss: 0.223 Vali Loss: 1.099 Vali Acc: 0.570 Test Loss: 1.099 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.539707660675049
Epoch: 25, Steps: 20 | Train Loss: 0.183 Vali Loss: 1.166 Vali Acc: 0.560 Test Loss: 1.166 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.87851881980896
Epoch: 26, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.354 Vali Acc: 0.540 Test Loss: 1.354 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.649456262588501
Epoch: 27, Steps: 20 | Train Loss: 0.149 Vali Loss: 1.245 Vali Acc: 0.550 Test Loss: 1.245 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.639856815338135
Epoch: 28, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.383 Vali Acc: 0.560 Test Loss: 1.383 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.464265584945679
Epoch: 29, Steps: 20 | Train Loss: 0.130 Vali Loss: 1.388 Vali Acc: 0.580 Test Loss: 1.388 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.35623025894165
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.369121551513672
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.791 Vali Acc: 0.450 Test Loss: 0.791 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.899127244949341
Epoch: 3, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.857 Vali Acc: 0.480 Test Loss: 0.857 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.772578954696655
Epoch: 4, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.839 Vali Acc: 0.460 Test Loss: 0.839 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.815881729125977
Epoch: 5, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.876 Vali Acc: 0.430 Test Loss: 0.876 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.64236307144165
Epoch: 6, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.906 Vali Acc: 0.460 Test Loss: 0.906 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.596322536468506
Epoch: 7, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.905 Vali Acc: 0.470 Test Loss: 0.905 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.769631862640381
Epoch: 8, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.905 Vali Acc: 0.500 Test Loss: 0.905 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.574260711669922
Epoch: 9, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.951 Vali Acc: 0.450 Test Loss: 0.951 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.741959810256958
Epoch: 10, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.962 Vali Acc: 0.440 Test Loss: 0.962 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.654921770095825
Epoch: 11, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.978 Vali Acc: 0.450 Test Loss: 0.978 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 6.774123668670654
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 5.776258945465088
Epoch: 2, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.728 Vali Acc: 0.520 Test Loss: 0.728 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 5.56672477722168
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.769686460494995
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.805622577667236
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.763736248016357
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.778 Vali Acc: 0.520 Test Loss: 0.778 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.468657493591309
Epoch: 7, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 5.563360929489136
Epoch: 8, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.808 Vali Acc: 0.540 Test Loss: 0.808 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.579741954803467
Epoch: 9, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.65354061126709
Epoch: 10, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.829 Vali Acc: 0.550 Test Loss: 0.829 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 5.888077259063721
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.66878342628479
Epoch: 12, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.855 Vali Acc: 0.550 Test Loss: 0.855 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.76023268699646
Epoch: 13, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.836 Vali Acc: 0.570 Test Loss: 0.836 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 5.64643406867981
Epoch: 14, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.802 Vali Acc: 0.650 Test Loss: 0.802 Test Acc: 0.650
Validation loss decreased (-0.569992 --> -0.649992).  Saving model ...
Epoch: 15 cost time: 5.800846338272095
Epoch: 15, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.873 Vali Acc: 0.590 Test Loss: 0.873 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.9149861335754395
Epoch: 16, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.936 Vali Acc: 0.570 Test Loss: 0.936 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.89149284362793
Epoch: 17, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.915 Vali Acc: 0.640 Test Loss: 0.915 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.207468748092651
Epoch: 18, Steps: 20 | Train Loss: 0.452 Vali Loss: 1.037 Vali Acc: 0.590 Test Loss: 1.037 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.341204404830933
Epoch: 19, Steps: 20 | Train Loss: 0.476 Vali Loss: 1.010 Vali Acc: 0.590 Test Loss: 1.010 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.476158857345581
Epoch: 20, Steps: 20 | Train Loss: 0.409 Vali Loss: 1.159 Vali Acc: 0.530 Test Loss: 1.159 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.821887731552124
Epoch: 21, Steps: 20 | Train Loss: 0.404 Vali Loss: 1.267 Vali Acc: 0.590 Test Loss: 1.267 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.7871503829956055
Epoch: 22, Steps: 20 | Train Loss: 0.389 Vali Loss: 1.235 Vali Acc: 0.620 Test Loss: 1.235 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.957140684127808
Epoch: 23, Steps: 20 | Train Loss: 0.378 Vali Loss: 1.380 Vali Acc: 0.550 Test Loss: 1.380 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.480352163314819
Epoch: 24, Steps: 20 | Train Loss: 0.344 Vali Loss: 1.303 Vali Acc: 0.530 Test Loss: 1.303 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.394926071166992
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.756 Vali Acc: 0.440 Test Loss: 0.756 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 5.70628809928894
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
Validation loss decreased (-0.439992 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 5.289143323898315
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.774 Vali Acc: 0.470 Test Loss: 0.774 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.515918016433716
Epoch: 4, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.762 Vali Acc: 0.510 Test Loss: 0.762 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.834174633026123
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 5.359906911849976
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 5.388459205627441
Epoch: 7, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.845 Vali Acc: 0.550 Test Loss: 0.845 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.447529554367065
Epoch: 8, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.834 Vali Acc: 0.520 Test Loss: 0.834 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.593168258666992
Epoch: 9, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.842 Vali Acc: 0.560 Test Loss: 0.842 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 5.496034860610962
Epoch: 10, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.884 Vali Acc: 0.570 Test Loss: 0.884 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 11 cost time: 5.3135974407196045
Epoch: 11, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.899 Vali Acc: 0.490 Test Loss: 0.899 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.732778787612915
Epoch: 12, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.941 Vali Acc: 0.570 Test Loss: 0.941 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.875565052032471
Epoch: 13, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.923 Vali Acc: 0.540 Test Loss: 0.923 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.6086626052856445
Epoch: 14, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.866 Vali Acc: 0.600 Test Loss: 0.866 Test Acc: 0.600
Validation loss decreased (-0.569991 --> -0.599991).  Saving model ...
Epoch: 15 cost time: 5.281184434890747
Epoch: 15, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.964 Vali Acc: 0.610 Test Loss: 0.964 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609990).  Saving model ...
Epoch: 16 cost time: 5.894354581832886
Epoch: 16, Steps: 20 | Train Loss: 0.552 Vali Loss: 1.071 Vali Acc: 0.490 Test Loss: 1.071 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.925835609436035
Epoch: 17, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.989 Vali Acc: 0.530 Test Loss: 0.989 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.771295070648193
Epoch: 18, Steps: 20 | Train Loss: 0.455 Vali Loss: 1.064 Vali Acc: 0.590 Test Loss: 1.064 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.798577785491943
Epoch: 19, Steps: 20 | Train Loss: 0.439 Vali Loss: 1.067 Vali Acc: 0.530 Test Loss: 1.067 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.387060642242432
Epoch: 20, Steps: 20 | Train Loss: 0.393 Vali Loss: 1.224 Vali Acc: 0.480 Test Loss: 1.224 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.0452353954315186
Epoch: 21, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.234 Vali Acc: 0.560 Test Loss: 1.234 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.219069719314575
Epoch: 22, Steps: 20 | Train Loss: 0.357 Vali Loss: 1.264 Vali Acc: 0.590 Test Loss: 1.264 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.695507049560547
Epoch: 23, Steps: 20 | Train Loss: 0.351 Vali Loss: 1.440 Vali Acc: 0.520 Test Loss: 1.440 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.5002851486206055
Epoch: 24, Steps: 20 | Train Loss: 0.309 Vali Loss: 1.424 Vali Acc: 0.520 Test Loss: 1.424 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.647829532623291
Epoch: 25, Steps: 20 | Train Loss: 0.297 Vali Loss: 1.416 Vali Acc: 0.560 Test Loss: 1.416 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.480061769485474
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 5.442908048629761
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (-0.509993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 5.744710683822632
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.563062429428101
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.740878582000732
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.675435304641724
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.052412509918213
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.946509122848511
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.107347011566162
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.586084842681885
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.827429533004761
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.39606785774231
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 590978
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.439228057861328
Epoch: 1, Steps: 20 | Train Loss: 0.773 Vali Loss: 0.744 Vali Acc: 0.420 Test Loss: 0.744 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 5.800742149353027
Epoch: 2, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
Validation loss decreased (-0.419993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 5.741973161697388
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.793 Vali Acc: 0.480 Test Loss: 0.793 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.7831504344940186
Epoch: 4, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.870 Vali Acc: 0.510 Test Loss: 0.870 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509991).  Saving model ...
Epoch: 5 cost time: 5.872214078903198
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.810 Vali Acc: 0.450 Test Loss: 0.810 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.802972078323364
Epoch: 6, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.798 Vali Acc: 0.440 Test Loss: 0.798 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.939839601516724
Epoch: 7, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
Validation loss decreased (-0.509991 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 5.547020673751831
Epoch: 8, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.807 Vali Acc: 0.470 Test Loss: 0.807 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.738574743270874
Epoch: 9, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.870 Vali Acc: 0.540 Test Loss: 0.870 Test Acc: 0.540
Validation loss decreased (-0.509992 --> -0.539991).  Saving model ...
Epoch: 10 cost time: 5.515392303466797
Epoch: 10, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.529861688613892
Epoch: 11, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.849 Vali Acc: 0.520 Test Loss: 0.849 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.469347715377808
Epoch: 12, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.876 Vali Acc: 0.540 Test Loss: 0.876 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.5987560749053955
Epoch: 13, Steps: 20 | Train Loss: 0.488 Vali Loss: 0.965 Vali Acc: 0.480 Test Loss: 0.965 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.5463316440582275
Epoch: 14, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.968 Vali Acc: 0.510 Test Loss: 0.968 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.390519857406616
Epoch: 15, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.917 Vali Acc: 0.490 Test Loss: 0.917 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.500709772109985
Epoch: 16, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.934 Vali Acc: 0.510 Test Loss: 0.934 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.4083170890808105
Epoch: 17, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.933 Vali Acc: 0.490 Test Loss: 0.933 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.197489261627197
Epoch: 18, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.926 Vali Acc: 0.520 Test Loss: 0.926 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.426060914993286
Epoch: 19, Steps: 20 | Train Loss: 0.358 Vali Loss: 1.082 Vali Acc: 0.560 Test Loss: 1.082 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559989).  Saving model ...
Epoch: 20 cost time: 5.440323114395142
Epoch: 20, Steps: 20 | Train Loss: 0.376 Vali Loss: 0.892 Vali Acc: 0.480 Test Loss: 0.892 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.294049024581909
Epoch: 21, Steps: 20 | Train Loss: 0.337 Vali Loss: 1.058 Vali Acc: 0.490 Test Loss: 1.058 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.255694627761841
Epoch: 22, Steps: 20 | Train Loss: 0.326 Vali Loss: 1.062 Vali Acc: 0.490 Test Loss: 1.062 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.396695137023926
Epoch: 23, Steps: 20 | Train Loss: 0.281 Vali Loss: 0.992 Vali Acc: 0.530 Test Loss: 0.992 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.79276704788208
Epoch: 24, Steps: 20 | Train Loss: 0.278 Vali Loss: 1.114 Vali Acc: 0.480 Test Loss: 1.114 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.94509482383728
Epoch: 25, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.082 Vali Acc: 0.540 Test Loss: 1.082 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.523950576782227
Epoch: 26, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.014 Vali Acc: 0.510 Test Loss: 1.014 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.572917938232422
Epoch: 27, Steps: 20 | Train Loss: 0.177 Vali Loss: 1.182 Vali Acc: 0.510 Test Loss: 1.182 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.491851806640625
Epoch: 28, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.156 Vali Acc: 0.530 Test Loss: 1.156 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.467099666595459
Epoch: 29, Steps: 20 | Train Loss: 0.164 Vali Loss: 1.130 Vali Acc: 0.520 Test Loss: 1.130 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.234071493148804
Epoch: 1, Steps: 20 | Train Loss: 0.757 Vali Loss: 0.753 Vali Acc: 0.440 Test Loss: 0.753 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 5.614994525909424
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
Validation loss decreased (-0.439992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 5.6128997802734375
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.346416711807251
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.846 Vali Acc: 0.470 Test Loss: 0.846 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.463799953460693
Epoch: 5, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.822 Vali Acc: 0.460 Test Loss: 0.822 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.15808367729187
Epoch: 6, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.796 Vali Acc: 0.450 Test Loss: 0.796 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.334495306015015
Epoch: 7, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.822 Vali Acc: 0.490 Test Loss: 0.822 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.426241397857666
Epoch: 8, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.809 Vali Acc: 0.470 Test Loss: 0.809 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.121116638183594
Epoch: 9, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.857 Vali Acc: 0.520 Test Loss: 0.857 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519991).  Saving model ...
Epoch: 10 cost time: 5.432917833328247
Epoch: 10, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.865 Vali Acc: 0.490 Test Loss: 0.865 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.266634464263916
Epoch: 11, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.796334743499756
Epoch: 12, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.950284719467163
Epoch: 13, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.926 Vali Acc: 0.480 Test Loss: 0.926 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.406067132949829
Epoch: 14, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.928 Vali Acc: 0.500 Test Loss: 0.928 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.376137018203735
Epoch: 15, Steps: 20 | Train Loss: 0.466 Vali Loss: 0.972 Vali Acc: 0.490 Test Loss: 0.972 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.397474527359009
Epoch: 16, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.935 Vali Acc: 0.490 Test Loss: 0.935 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.381326198577881
Epoch: 17, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.926 Vali Acc: 0.530 Test Loss: 0.926 Test Acc: 0.530
Validation loss decreased (-0.519991 --> -0.529991).  Saving model ...
Epoch: 18 cost time: 5.191445350646973
Epoch: 18, Steps: 20 | Train Loss: 0.407 Vali Loss: 0.992 Vali Acc: 0.470 Test Loss: 0.992 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.6266796588897705
Epoch: 19, Steps: 20 | Train Loss: 0.371 Vali Loss: 1.052 Vali Acc: 0.510 Test Loss: 1.052 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.662644147872925
Epoch: 20, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.945 Vali Acc: 0.500 Test Loss: 0.945 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.631190299987793
Epoch: 21, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.102 Vali Acc: 0.480 Test Loss: 1.102 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.6537415981292725
Epoch: 22, Steps: 20 | Train Loss: 0.319 Vali Loss: 1.057 Vali Acc: 0.490 Test Loss: 1.057 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.5199549198150635
Epoch: 23, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.006 Vali Acc: 0.550 Test Loss: 1.006 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549990).  Saving model ...
Epoch: 24 cost time: 5.7756617069244385
Epoch: 24, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.092 Vali Acc: 0.480 Test Loss: 1.092 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.736893177032471
Epoch: 25, Steps: 20 | Train Loss: 0.313 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.8337082862854
Epoch: 26, Steps: 20 | Train Loss: 0.250 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.326943635940552
Epoch: 27, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.996757745742798
Epoch: 28, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.549546718597412
Epoch: 29, Steps: 20 | Train Loss: 0.168 Vali Loss: 1.254 Vali Acc: 0.510 Test Loss: 1.254 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.743037700653076
Epoch: 30, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.222 Vali Acc: 0.480 Test Loss: 1.222 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.683998107910156
Epoch: 31, Steps: 20 | Train Loss: 0.200 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.699064493179321
Epoch: 32, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.127 Vali Acc: 0.530 Test Loss: 1.127 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.665651559829712
Epoch: 33, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.374 Vali Acc: 0.510 Test Loss: 1.374 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.307906866073608
Epoch: 1, Steps: 20 | Train Loss: 0.765 Vali Loss: 0.730 Vali Acc: 0.520 Test Loss: 0.730 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 5.9079225063323975
Epoch: 2, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.752 Vali Acc: 0.470 Test Loss: 0.752 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.382315397262573
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.744311809539795
Epoch: 4, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 6.052492618560791
Epoch: 5, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.808 Vali Acc: 0.480 Test Loss: 0.808 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.840981721878052
Epoch: 6, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.094992160797119
Epoch: 7, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.491884469985962
Epoch: 8, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.900665998458862
Epoch: 9, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.806 Vali Acc: 0.560 Test Loss: 0.806 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 10 cost time: 5.839617729187012
Epoch: 10, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.822068214416504
Epoch: 11, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.847 Vali Acc: 0.520 Test Loss: 0.847 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.5469160079956055
Epoch: 12, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.882631301879883
Epoch: 13, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.809 Vali Acc: 0.580 Test Loss: 0.809 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 14 cost time: 5.531521320343018
Epoch: 14, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.883 Vali Acc: 0.560 Test Loss: 0.883 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.654763460159302
Epoch: 15, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.021463394165039
Epoch: 16, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.864546775817871
Epoch: 17, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.911 Vali Acc: 0.510 Test Loss: 0.911 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.19364857673645
Epoch: 18, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.916 Vali Acc: 0.510 Test Loss: 0.916 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.102336406707764
Epoch: 19, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.905 Vali Acc: 0.520 Test Loss: 0.905 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.134006023406982
Epoch: 20, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.911 Vali Acc: 0.540 Test Loss: 0.911 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.222655534744263
Epoch: 21, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.982 Vali Acc: 0.540 Test Loss: 0.982 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.158812046051025
Epoch: 22, Steps: 20 | Train Loss: 0.336 Vali Loss: 1.028 Vali Acc: 0.590 Test Loss: 1.028 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589990).  Saving model ...
Epoch: 23 cost time: 6.154165029525757
Epoch: 23, Steps: 20 | Train Loss: 0.310 Vali Loss: 0.862 Vali Acc: 0.590 Test Loss: 0.862 Test Acc: 0.590
Validation loss decreased (-0.589990 --> -0.589991).  Saving model ...
Epoch: 24 cost time: 5.835470914840698
Epoch: 24, Steps: 20 | Train Loss: 0.287 Vali Loss: 0.990 Vali Acc: 0.540 Test Loss: 0.990 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.182689189910889
Epoch: 25, Steps: 20 | Train Loss: 0.265 Vali Loss: 0.991 Vali Acc: 0.520 Test Loss: 0.991 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.447620630264282
Epoch: 26, Steps: 20 | Train Loss: 0.251 Vali Loss: 0.919 Vali Acc: 0.590 Test Loss: 0.919 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.125201225280762
Epoch: 27, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.008 Vali Acc: 0.570 Test Loss: 1.008 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.051661729812622
Epoch: 28, Steps: 20 | Train Loss: 0.204 Vali Loss: 1.000 Vali Acc: 0.580 Test Loss: 1.000 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.9130699634552
Epoch: 29, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.142 Vali Acc: 0.540 Test Loss: 1.142 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.940065860748291
Epoch: 30, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.096 Vali Acc: 0.560 Test Loss: 1.096 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.034142732620239
Epoch: 31, Steps: 20 | Train Loss: 0.209 Vali Loss: 1.398 Vali Acc: 0.530 Test Loss: 1.398 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.054643869400024
Epoch: 32, Steps: 20 | Train Loss: 0.165 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599990).  Saving model ...
Epoch: 33 cost time: 6.186050176620483
Epoch: 33, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.140 Vali Acc: 0.530 Test Loss: 1.140 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.2796478271484375
Epoch: 34, Steps: 20 | Train Loss: 0.133 Vali Loss: 1.283 Vali Acc: 0.540 Test Loss: 1.283 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.641634464263916
Epoch: 35, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.195 Vali Acc: 0.580 Test Loss: 1.195 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.838805675506592
Epoch: 36, Steps: 20 | Train Loss: 0.106 Vali Loss: 1.174 Vali Acc: 0.570 Test Loss: 1.174 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.1136252880096436
Epoch: 37, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.283 Vali Acc: 0.560 Test Loss: 1.283 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.026787996292114
Epoch: 38, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.296 Vali Acc: 0.590 Test Loss: 1.296 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.415386199951172
Epoch: 39, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 5.668911695480347
Epoch: 40, Steps: 20 | Train Loss: 0.058 Vali Loss: 1.346 Vali Acc: 0.580 Test Loss: 1.346 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 6.139461994171143
Epoch: 41, Steps: 20 | Train Loss: 0.055 Vali Loss: 1.413 Vali Acc: 0.560 Test Loss: 1.413 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 6.149079084396362
Epoch: 42, Steps: 20 | Train Loss: 0.049 Vali Loss: 1.437 Vali Acc: 0.560 Test Loss: 1.437 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.537219285964966
Epoch: 1, Steps: 20 | Train Loss: 0.758 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 5.934554576873779
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.753 Vali Acc: 0.470 Test Loss: 0.753 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.983910322189331
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.457455158233643
Epoch: 4, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.636325836181641
Epoch: 5, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.754646301269531
Epoch: 6, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.761 Vali Acc: 0.500 Test Loss: 0.761 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.867016315460205
Epoch: 7, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.703185319900513
Epoch: 8, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.481533050537109
Epoch: 9, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.779 Vali Acc: 0.580 Test Loss: 0.779 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 5.447099447250366
Epoch: 10, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.392587423324585
Epoch: 11, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.523986339569092
Epoch: 12, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.797 Vali Acc: 0.580 Test Loss: 0.797 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.580363988876343
Epoch: 13, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.807 Vali Acc: 0.580 Test Loss: 0.807 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.63578724861145
Epoch: 14, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.836 Vali Acc: 0.560 Test Loss: 0.836 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.375492334365845
Epoch: 15, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.820 Vali Acc: 0.530 Test Loss: 0.820 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.509987831115723
Epoch: 16, Steps: 20 | Train Loss: 0.449 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.581506729125977
Epoch: 17, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.511924982070923
Epoch: 18, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.932 Vali Acc: 0.440 Test Loss: 0.932 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.672072172164917
Epoch: 19, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.781 Vali Acc: 0.580 Test Loss: 0.781 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.283307790756226
Epoch: 1, Steps: 20 | Train Loss: 0.789 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.881196737289429
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 5.642246961593628
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.867 Vali Acc: 0.490 Test Loss: 0.867 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489991).  Saving model ...
Epoch: 4 cost time: 5.4978625774383545
Epoch: 4, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.861 Vali Acc: 0.480 Test Loss: 0.861 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.497701406478882
Epoch: 5, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.889 Vali Acc: 0.450 Test Loss: 0.889 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.577784061431885
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.852 Vali Acc: 0.470 Test Loss: 0.852 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.107030153274536
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.848 Vali Acc: 0.500 Test Loss: 0.848 Test Acc: 0.500
Validation loss decreased (-0.489991 --> -0.499992).  Saving model ...
Epoch: 8 cost time: 5.961851596832275
Epoch: 8, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.880 Vali Acc: 0.430 Test Loss: 0.880 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.636470079421997
Epoch: 9, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.946 Vali Acc: 0.490 Test Loss: 0.946 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.857931852340698
Epoch: 10, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.996 Vali Acc: 0.520 Test Loss: 0.996 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519990).  Saving model ...
Epoch: 11 cost time: 5.890872955322266
Epoch: 11, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.984 Vali Acc: 0.450 Test Loss: 0.984 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.891430616378784
Epoch: 12, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.872 Vali Acc: 0.470 Test Loss: 0.872 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.595832347869873
Epoch: 13, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
Validation loss decreased (-0.519990 --> -0.519991).  Saving model ...
Epoch: 14 cost time: 5.8657166957855225
Epoch: 14, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.866 Vali Acc: 0.480 Test Loss: 0.866 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.095168352127075
Epoch: 15, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.876 Vali Acc: 0.560 Test Loss: 0.876 Test Acc: 0.560
Validation loss decreased (-0.519991 --> -0.559991).  Saving model ...
Epoch: 16 cost time: 5.989569664001465
Epoch: 16, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.880 Vali Acc: 0.470 Test Loss: 0.880 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.989922285079956
Epoch: 17, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.890623331069946
Epoch: 18, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.873 Vali Acc: 0.500 Test Loss: 0.873 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.707874536514282
Epoch: 19, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.904 Vali Acc: 0.520 Test Loss: 0.904 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.7955851554870605
Epoch: 20, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.771561145782471
Epoch: 21, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.989 Vali Acc: 0.500 Test Loss: 0.989 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.848693132400513
Epoch: 22, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.947 Vali Acc: 0.540 Test Loss: 0.947 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.580001354217529
Epoch: 23, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.973 Vali Acc: 0.510 Test Loss: 0.973 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.926075220108032
Epoch: 24, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.943 Vali Acc: 0.560 Test Loss: 0.943 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.6990721225738525
Epoch: 25, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.951 Vali Acc: 0.540 Test Loss: 0.951 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.219198226928711
Epoch: 1, Steps: 20 | Train Loss: 0.767 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 5.466069221496582
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.708 Vali Acc: 0.540 Test Loss: 0.708 Test Acc: 0.540
Validation loss decreased (-0.499993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 6.1235504150390625
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.5659918785095215
Epoch: 4, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.756486892700195
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 5.385911703109741
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.785583972930908
Epoch: 7, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.711153268814087
Epoch: 8, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.645471811294556
Epoch: 9, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.614022493362427
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.851 Vali Acc: 0.520 Test Loss: 0.851 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.853244304656982
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.789 Vali Acc: 0.560 Test Loss: 0.789 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.14802622795105
Epoch: 12, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.803 Vali Acc: 0.530 Test Loss: 0.803 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.135838985443115
Epoch: 13, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.606908559799194
Epoch: 14, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.007122039794922
Epoch: 15, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.847 Vali Acc: 0.590 Test Loss: 0.847 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 5.458958148956299
Epoch: 16, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.809 Vali Acc: 0.550 Test Loss: 0.809 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.9542951583862305
Epoch: 17, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.751708984375
Epoch: 18, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.794 Vali Acc: 0.590 Test Loss: 0.794 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589992).  Saving model ...
Epoch: 19 cost time: 6.024298906326294
Epoch: 19, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.602327108383179
Epoch: 20, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.839 Vali Acc: 0.600 Test Loss: 0.839 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 21 cost time: 5.291290760040283
Epoch: 21, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.907 Vali Acc: 0.490 Test Loss: 0.907 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.3220374584198
Epoch: 22, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.825 Vali Acc: 0.570 Test Loss: 0.825 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.292718172073364
Epoch: 23, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.779 Vali Acc: 0.630 Test Loss: 0.779 Test Acc: 0.630
Validation loss decreased (-0.599992 --> -0.629992).  Saving model ...
Epoch: 24 cost time: 5.4211297035217285
Epoch: 24, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.791 Vali Acc: 0.620 Test Loss: 0.791 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.195582389831543
Epoch: 25, Steps: 20 | Train Loss: 0.510 Vali Loss: 0.810 Vali Acc: 0.590 Test Loss: 0.810 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.351146221160889
Epoch: 26, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.763 Vali Acc: 0.570 Test Loss: 0.763 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.724358797073364
Epoch: 27, Steps: 20 | Train Loss: 0.462 Vali Loss: 0.836 Vali Acc: 0.610 Test Loss: 0.836 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.555703639984131
Epoch: 28, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.939 Vali Acc: 0.630 Test Loss: 0.939 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.314906597137451
Epoch: 29, Steps: 20 | Train Loss: 0.430 Vali Loss: 0.928 Vali Acc: 0.580 Test Loss: 0.928 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.37348484992981
Epoch: 30, Steps: 20 | Train Loss: 0.402 Vali Loss: 1.007 Vali Acc: 0.610 Test Loss: 1.007 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.27977728843689
Epoch: 31, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.928 Vali Acc: 0.630 Test Loss: 0.928 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.936091423034668
Epoch: 32, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.934 Vali Acc: 0.600 Test Loss: 0.934 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.3438801765441895
Epoch: 33, Steps: 20 | Train Loss: 0.305 Vali Loss: 1.117 Vali Acc: 0.610 Test Loss: 1.117 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.3448097705841064
Epoch: 1, Steps: 20 | Train Loss: 0.766 Vali Loss: 0.717 Vali Acc: 0.480 Test Loss: 0.717 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 6.647353887557983
Epoch: 2, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.703 Vali Acc: 0.510 Test Loss: 0.703 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 6.351137161254883
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.720 Vali Acc: 0.540 Test Loss: 0.720 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 6.01718282699585
Epoch: 4, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.595292091369629
Epoch: 5, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.793155193328857
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.760 Vali Acc: 0.550 Test Loss: 0.760 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 5.865401268005371
Epoch: 7, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.808 Vali Acc: 0.470 Test Loss: 0.808 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.7974584102630615
Epoch: 8, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.770 Vali Acc: 0.570 Test Loss: 0.770 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 9 cost time: 6.415565252304077
Epoch: 9, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.6947972774505615
Epoch: 10, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.890 Vali Acc: 0.520 Test Loss: 0.890 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.504420280456543
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.826 Vali Acc: 0.550 Test Loss: 0.826 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.5881125926971436
Epoch: 12, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.802 Vali Acc: 0.540 Test Loss: 0.802 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.749333143234253
Epoch: 13, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.757176876068115
Epoch: 14, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.8641746044158936
Epoch: 15, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.863 Vali Acc: 0.540 Test Loss: 0.863 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.738361597061157
Epoch: 16, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.844 Vali Acc: 0.500 Test Loss: 0.844 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.578845262527466
Epoch: 17, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.861 Vali Acc: 0.570 Test Loss: 0.861 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.611347198486328
Epoch: 18, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.841 Vali Acc: 0.560 Test Loss: 0.841 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.063613653182983
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 5.960160970687866
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 5.753682374954224
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 5.780701160430908
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 5.781913995742798
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.06463360786438
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.119222402572632
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.125316619873047
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.051889181137085
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.049298048019409
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.999392986297607
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.668943405151367
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.3416407108306885
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.607110977172852
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 917058
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.406316757202148
Epoch: 1, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.753 Vali Acc: 0.390 Test Loss: 0.753 Test Acc: 0.390
Validation loss decreased (inf --> -0.389992).  Saving model ...
Epoch: 2 cost time: 5.6605119705200195
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.778 Vali Acc: 0.490 Test Loss: 0.778 Test Acc: 0.490
Validation loss decreased (-0.389992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 5.9708640575408936
Epoch: 3, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.794 Vali Acc: 0.420 Test Loss: 0.794 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.760680675506592
Epoch: 4, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.805 Vali Acc: 0.460 Test Loss: 0.805 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.415018558502197
Epoch: 5, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.827 Vali Acc: 0.480 Test Loss: 0.827 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.913077354431152
Epoch: 6, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
Validation loss decreased (-0.489992 --> -0.509991).  Saving model ...
Epoch: 7 cost time: 5.963863134384155
Epoch: 7, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.841 Vali Acc: 0.490 Test Loss: 0.841 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.596205234527588
Epoch: 8, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.850 Vali Acc: 0.500 Test Loss: 0.850 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.9040422439575195
Epoch: 9, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.842 Vali Acc: 0.460 Test Loss: 0.842 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.369083404541016
Epoch: 10, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.853 Vali Acc: 0.460 Test Loss: 0.853 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.153083562850952
Epoch: 11, Steps: 20 | Train Loss: 0.546 Vali Loss: 0.884 Vali Acc: 0.510 Test Loss: 0.884 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.9591896533966064
Epoch: 12, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.856 Vali Acc: 0.540 Test Loss: 0.856 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539991).  Saving model ...
Epoch: 13 cost time: 6.292279958724976
Epoch: 13, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.912 Vali Acc: 0.520 Test Loss: 0.912 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.367035627365112
Epoch: 14, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.837 Vali Acc: 0.530 Test Loss: 0.837 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.757798910140991
Epoch: 15, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.204583168029785
Epoch: 16, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.918 Vali Acc: 0.520 Test Loss: 0.918 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.7579731941223145
Epoch: 17, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.930 Vali Acc: 0.530 Test Loss: 0.930 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.062107563018799
Epoch: 18, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.921 Vali Acc: 0.540 Test Loss: 0.921 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.085062503814697
Epoch: 19, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.983 Vali Acc: 0.540 Test Loss: 0.983 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.9697747230529785
Epoch: 20, Steps: 20 | Train Loss: 0.359 Vali Loss: 1.059 Vali Acc: 0.480 Test Loss: 1.059 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.763570785522461
Epoch: 21, Steps: 20 | Train Loss: 0.327 Vali Loss: 0.992 Vali Acc: 0.520 Test Loss: 0.992 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.130906581878662
Epoch: 22, Steps: 20 | Train Loss: 0.321 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.877840042114258
Epoch: 1, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.751 Vali Acc: 0.390 Test Loss: 0.751 Test Acc: 0.390
Validation loss decreased (inf --> -0.389992).  Saving model ...
Epoch: 2 cost time: 7.163686990737915
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.782 Vali Acc: 0.410 Test Loss: 0.782 Test Acc: 0.410
Validation loss decreased (-0.389992 --> -0.409992).  Saving model ...
Epoch: 3 cost time: 6.759342432022095
Epoch: 3, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.796 Vali Acc: 0.420 Test Loss: 0.796 Test Acc: 0.420
Validation loss decreased (-0.409992 --> -0.419992).  Saving model ...
Epoch: 4 cost time: 6.877100706100464
Epoch: 4, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.804 Vali Acc: 0.420 Test Loss: 0.804 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.752141237258911
Epoch: 5, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
Validation loss decreased (-0.419992 --> -0.459992).  Saving model ...
Epoch: 6 cost time: 7.12352180480957
Epoch: 6, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.852 Vali Acc: 0.460 Test Loss: 0.852 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.911710977554321
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.844 Vali Acc: 0.450 Test Loss: 0.844 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.698678493499756
Epoch: 8, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.849 Vali Acc: 0.460 Test Loss: 0.849 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.654620885848999
Epoch: 9, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.839 Vali Acc: 0.460 Test Loss: 0.839 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.756387233734131
Epoch: 10, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.874 Vali Acc: 0.430 Test Loss: 0.874 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.260894298553467
Epoch: 11, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.897 Vali Acc: 0.470 Test Loss: 0.897 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469991).  Saving model ...
Epoch: 12 cost time: 7.344624996185303
Epoch: 12, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.876 Vali Acc: 0.470 Test Loss: 0.876 Test Acc: 0.470
Validation loss decreased (-0.469991 --> -0.469991).  Saving model ...
Epoch: 13 cost time: 5.667565584182739
Epoch: 13, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.928 Vali Acc: 0.460 Test Loss: 0.928 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.708774566650391
Epoch: 14, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.892 Vali Acc: 0.490 Test Loss: 0.892 Test Acc: 0.490
Validation loss decreased (-0.469991 --> -0.489991).  Saving model ...
Epoch: 15 cost time: 5.613353252410889
Epoch: 15, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.924 Vali Acc: 0.510 Test Loss: 0.924 Test Acc: 0.510
Validation loss decreased (-0.489991 --> -0.509991).  Saving model ...
Epoch: 16 cost time: 6.244416236877441
Epoch: 16, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.948 Vali Acc: 0.480 Test Loss: 0.948 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.89224648475647
Epoch: 17, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.982 Vali Acc: 0.500 Test Loss: 0.982 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.753366470336914
Epoch: 18, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.990 Vali Acc: 0.510 Test Loss: 0.990 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.91913104057312
Epoch: 19, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.957 Vali Acc: 0.480 Test Loss: 0.957 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.913123846054077
Epoch: 20, Steps: 20 | Train Loss: 0.380 Vali Loss: 1.002 Vali Acc: 0.560 Test Loss: 1.002 Test Acc: 0.560
Validation loss decreased (-0.509991 --> -0.559990).  Saving model ...
Epoch: 21 cost time: 6.070316314697266
Epoch: 21, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.971 Vali Acc: 0.530 Test Loss: 0.971 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.0360894203186035
Epoch: 22, Steps: 20 | Train Loss: 0.316 Vali Loss: 1.038 Vali Acc: 0.460 Test Loss: 1.038 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.837876319885254
Epoch: 23, Steps: 20 | Train Loss: 0.324 Vali Loss: 1.289 Vali Acc: 0.550 Test Loss: 1.289 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.703332901000977
Epoch: 24, Steps: 20 | Train Loss: 0.323 Vali Loss: 1.202 Vali Acc: 0.480 Test Loss: 1.202 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.791852235794067
Epoch: 25, Steps: 20 | Train Loss: 0.277 Vali Loss: 1.075 Vali Acc: 0.560 Test Loss: 1.075 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.81719708442688
Epoch: 26, Steps: 20 | Train Loss: 0.248 Vali Loss: 1.093 Vali Acc: 0.480 Test Loss: 1.093 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.725863456726074
Epoch: 27, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.143 Vali Acc: 0.530 Test Loss: 1.143 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.8858323097229
Epoch: 28, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.082 Vali Acc: 0.520 Test Loss: 1.082 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.230616569519043
Epoch: 29, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.230 Vali Acc: 0.530 Test Loss: 1.230 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.700268507003784
Epoch: 30, Steps: 20 | Train Loss: 0.179 Vali Loss: 1.179 Vali Acc: 0.560 Test Loss: 1.179 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.239048004150391
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.733 Vali Acc: 0.400 Test Loss: 0.733 Test Acc: 0.400
Validation loss decreased (inf --> -0.399993).  Saving model ...
Epoch: 2 cost time: 5.687382936477661
Epoch: 2, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.763 Vali Acc: 0.470 Test Loss: 0.763 Test Acc: 0.470
Validation loss decreased (-0.399993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 6.307184457778931
Epoch: 3, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.787 Vali Acc: 0.460 Test Loss: 0.787 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.130551815032959
Epoch: 4, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.794 Vali Acc: 0.440 Test Loss: 0.794 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.932429075241089
Epoch: 5, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.797 Vali Acc: 0.480 Test Loss: 0.797 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479992).  Saving model ...
Epoch: 6 cost time: 5.940305948257446
Epoch: 6, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.824 Vali Acc: 0.470 Test Loss: 0.824 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.014146566390991
Epoch: 7, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.801 Vali Acc: 0.510 Test Loss: 0.801 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 5.9575419425964355
Epoch: 8, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.797 Vali Acc: 0.460 Test Loss: 0.797 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.247562408447266
Epoch: 9, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.779 Vali Acc: 0.520 Test Loss: 0.779 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 6.249382019042969
Epoch: 10, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.974904298782349
Epoch: 11, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.854 Vali Acc: 0.560 Test Loss: 0.854 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559991).  Saving model ...
Epoch: 12 cost time: 5.984482765197754
Epoch: 12, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.844 Vali Acc: 0.550 Test Loss: 0.844 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.327025890350342
Epoch: 13, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.894 Vali Acc: 0.520 Test Loss: 0.894 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.163458585739136
Epoch: 14, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.885 Vali Acc: 0.520 Test Loss: 0.885 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.883615255355835
Epoch: 15, Steps: 20 | Train Loss: 0.461 Vali Loss: 0.842 Vali Acc: 0.520 Test Loss: 0.842 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.285667657852173
Epoch: 16, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.859 Vali Acc: 0.530 Test Loss: 0.859 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.1838555335998535
Epoch: 17, Steps: 20 | Train Loss: 0.454 Vali Loss: 0.891 Vali Acc: 0.540 Test Loss: 0.891 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.517669677734375
Epoch: 18, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.907 Vali Acc: 0.560 Test Loss: 0.907 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.400481462478638
Epoch: 19, Steps: 20 | Train Loss: 0.394 Vali Loss: 0.871 Vali Acc: 0.570 Test Loss: 0.871 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569991).  Saving model ...
Epoch: 20 cost time: 6.691104888916016
Epoch: 20, Steps: 20 | Train Loss: 0.386 Vali Loss: 0.924 Vali Acc: 0.500 Test Loss: 0.924 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.254578351974487
Epoch: 21, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.937 Vali Acc: 0.580 Test Loss: 0.937 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 22 cost time: 6.3963518142700195
Epoch: 22, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.946 Vali Acc: 0.570 Test Loss: 0.946 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.589752674102783
Epoch: 23, Steps: 20 | Train Loss: 0.322 Vali Loss: 1.013 Vali Acc: 0.570 Test Loss: 1.013 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.730926752090454
Epoch: 24, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.130 Vali Acc: 0.530 Test Loss: 1.130 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.871968984603882
Epoch: 25, Steps: 20 | Train Loss: 0.290 Vali Loss: 0.902 Vali Acc: 0.630 Test Loss: 0.902 Test Acc: 0.630
Validation loss decreased (-0.579991 --> -0.629991).  Saving model ...
Epoch: 26 cost time: 6.880255222320557
Epoch: 26, Steps: 20 | Train Loss: 0.266 Vali Loss: 1.020 Vali Acc: 0.580 Test Loss: 1.020 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.995842933654785
Epoch: 27, Steps: 20 | Train Loss: 0.246 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.9783782958984375
Epoch: 28, Steps: 20 | Train Loss: 0.215 Vali Loss: 1.017 Vali Acc: 0.590 Test Loss: 1.017 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.296656131744385
Epoch: 29, Steps: 20 | Train Loss: 0.232 Vali Loss: 0.990 Vali Acc: 0.570 Test Loss: 0.990 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.138981342315674
Epoch: 30, Steps: 20 | Train Loss: 0.175 Vali Loss: 1.030 Vali Acc: 0.550 Test Loss: 1.030 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 7.062089204788208
Epoch: 31, Steps: 20 | Train Loss: 0.180 Vali Loss: 1.002 Vali Acc: 0.560 Test Loss: 1.002 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 7.269352436065674
Epoch: 32, Steps: 20 | Train Loss: 0.186 Vali Loss: 1.080 Vali Acc: 0.570 Test Loss: 1.080 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.862907648086548
Epoch: 33, Steps: 20 | Train Loss: 0.150 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.883201360702515
Epoch: 34, Steps: 20 | Train Loss: 0.126 Vali Loss: 1.100 Vali Acc: 0.550 Test Loss: 1.100 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.059610366821289
Epoch: 35, Steps: 20 | Train Loss: 0.114 Vali Loss: 1.160 Vali Acc: 0.570 Test Loss: 1.160 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.114934206008911
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.718 Vali Acc: 0.430 Test Loss: 0.718 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 6.211217880249023
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.742 Vali Acc: 0.450 Test Loss: 0.742 Test Acc: 0.450
Validation loss decreased (-0.429993 --> -0.449993).  Saving model ...
Epoch: 3 cost time: 6.322719573974609
Epoch: 3, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.764 Vali Acc: 0.450 Test Loss: 0.764 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.392281532287598
Epoch: 4, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 6.472105026245117
Epoch: 5, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 6.487324476242065
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.330596446990967
Epoch: 7, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.783 Vali Acc: 0.460 Test Loss: 0.783 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.502594232559204
Epoch: 8, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.782 Vali Acc: 0.470 Test Loss: 0.782 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.572956562042236
Epoch: 9, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.782 Vali Acc: 0.520 Test Loss: 0.782 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 6.730149745941162
Epoch: 10, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.717824935913086
Epoch: 11, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.823 Vali Acc: 0.520 Test Loss: 0.823 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.700205087661743
Epoch: 12, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.052950859069824
Epoch: 13, Steps: 20 | Train Loss: 0.530 Vali Loss: 0.864 Vali Acc: 0.490 Test Loss: 0.864 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.218232870101929
Epoch: 14, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 15 cost time: 6.793977499008179
Epoch: 15, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 16 cost time: 6.94938325881958
Epoch: 16, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.564573287963867
Epoch: 17, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.829 Vali Acc: 0.530 Test Loss: 0.829 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.717737913131714
Epoch: 18, Steps: 20 | Train Loss: 0.444 Vali Loss: 0.904 Vali Acc: 0.520 Test Loss: 0.904 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.581407308578491
Epoch: 19, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.858 Vali Acc: 0.490 Test Loss: 0.858 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.415734529495239
Epoch: 20, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.923 Vali Acc: 0.570 Test Loss: 0.923 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569991).  Saving model ...
Epoch: 21 cost time: 6.811616897583008
Epoch: 21, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.950 Vali Acc: 0.530 Test Loss: 0.950 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.584877014160156
Epoch: 22, Steps: 20 | Train Loss: 0.343 Vali Loss: 0.947 Vali Acc: 0.580 Test Loss: 0.947 Test Acc: 0.580
Validation loss decreased (-0.569991 --> -0.579991).  Saving model ...
Epoch: 23 cost time: 6.803739547729492
Epoch: 23, Steps: 20 | Train Loss: 0.366 Vali Loss: 0.987 Vali Acc: 0.570 Test Loss: 0.987 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.891663074493408
Epoch: 24, Steps: 20 | Train Loss: 0.314 Vali Loss: 1.007 Vali Acc: 0.620 Test Loss: 1.007 Test Acc: 0.620
Validation loss decreased (-0.579991 --> -0.619990).  Saving model ...
Epoch: 25 cost time: 6.750053882598877
Epoch: 25, Steps: 20 | Train Loss: 0.316 Vali Loss: 0.889 Vali Acc: 0.570 Test Loss: 0.889 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.717657804489136
Epoch: 26, Steps: 20 | Train Loss: 0.296 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.828641891479492
Epoch: 27, Steps: 20 | Train Loss: 0.266 Vali Loss: 0.931 Vali Acc: 0.610 Test Loss: 0.931 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.823674917221069
Epoch: 28, Steps: 20 | Train Loss: 0.233 Vali Loss: 0.931 Vali Acc: 0.600 Test Loss: 0.931 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.622413396835327
Epoch: 29, Steps: 20 | Train Loss: 0.230 Vali Loss: 0.879 Vali Acc: 0.600 Test Loss: 0.879 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.687469244003296
Epoch: 30, Steps: 20 | Train Loss: 0.198 Vali Loss: 0.979 Vali Acc: 0.590 Test Loss: 0.979 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.683546781539917
Epoch: 31, Steps: 20 | Train Loss: 0.211 Vali Loss: 1.019 Vali Acc: 0.620 Test Loss: 1.019 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.407337427139282
Epoch: 32, Steps: 20 | Train Loss: 0.178 Vali Loss: 1.083 Vali Acc: 0.570 Test Loss: 1.083 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.54748010635376
Epoch: 33, Steps: 20 | Train Loss: 0.155 Vali Loss: 0.972 Vali Acc: 0.580 Test Loss: 0.972 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.774197816848755
Epoch: 34, Steps: 20 | Train Loss: 0.148 Vali Loss: 1.077 Vali Acc: 0.570 Test Loss: 1.077 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.434962511062622
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.753 Vali Acc: 0.400 Test Loss: 0.753 Test Acc: 0.400
Validation loss decreased (inf --> -0.399992).  Saving model ...
Epoch: 2 cost time: 6.7915167808532715
Epoch: 2, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.786 Vali Acc: 0.450 Test Loss: 0.786 Test Acc: 0.450
Validation loss decreased (-0.399992 --> -0.449992).  Saving model ...
Epoch: 3 cost time: 7.285630226135254
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.827 Vali Acc: 0.480 Test Loss: 0.827 Test Acc: 0.480
Validation loss decreased (-0.449992 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 6.795143127441406
Epoch: 4, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.829 Vali Acc: 0.450 Test Loss: 0.829 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.920994520187378
Epoch: 5, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.864 Vali Acc: 0.460 Test Loss: 0.864 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.86378812789917
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.922 Vali Acc: 0.520 Test Loss: 0.922 Test Acc: 0.520
Validation loss decreased (-0.479992 --> -0.519991).  Saving model ...
Epoch: 7 cost time: 7.021297216415405
Epoch: 7, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.898 Vali Acc: 0.450 Test Loss: 0.898 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.590211629867554
Epoch: 8, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.929 Vali Acc: 0.460 Test Loss: 0.929 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.445633888244629
Epoch: 9, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.966 Vali Acc: 0.480 Test Loss: 0.966 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.680052042007446
Epoch: 10, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.961 Vali Acc: 0.480 Test Loss: 0.961 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.669742584228516
Epoch: 11, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.943 Vali Acc: 0.490 Test Loss: 0.943 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.626070499420166
Epoch: 12, Steps: 20 | Train Loss: 0.568 Vali Loss: 1.004 Vali Acc: 0.520 Test Loss: 1.004 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.401139497756958
Epoch: 13, Steps: 20 | Train Loss: 0.602 Vali Loss: 1.019 Vali Acc: 0.520 Test Loss: 1.019 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.366802930831909
Epoch: 14, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.963 Vali Acc: 0.510 Test Loss: 0.963 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.8073625564575195
Epoch: 15, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.931 Vali Acc: 0.510 Test Loss: 0.931 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.820657730102539
Epoch: 16, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.970 Vali Acc: 0.510 Test Loss: 0.970 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.52
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.487788677215576
Epoch: 1, Steps: 20 | Train Loss: 0.715 Vali Loss: 0.712 Vali Acc: 0.450 Test Loss: 0.712 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.962337255477905
Epoch: 2, Steps: 20 | Train Loss: 0.722 Vali Loss: 0.717 Vali Acc: 0.450 Test Loss: 0.717 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0775041580200195
Epoch: 3, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 6.262008905410767
Epoch: 4, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.736 Vali Acc: 0.560 Test Loss: 0.736 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 6.3047051429748535
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.1009626388549805
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.176638126373291
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.476497411727905
Epoch: 8, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.118321895599365
Epoch: 9, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.775 Vali Acc: 0.520 Test Loss: 0.775 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.534242391586304
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.806 Vali Acc: 0.530 Test Loss: 0.806 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.133848428726196
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.902 Vali Acc: 0.500 Test Loss: 0.902 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.6938090324401855
Epoch: 12, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.842 Vali Acc: 0.560 Test Loss: 0.842 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.748118877410889
Epoch: 13, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.739659786224365
Epoch: 14, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.855 Vali Acc: 0.560 Test Loss: 0.855 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.018794059753418
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.703 Vali Acc: 0.490 Test Loss: 0.703 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.936091899871826
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.706 Vali Acc: 0.490 Test Loss: 0.706 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.973997116088867
Epoch: 3, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
Validation loss decreased (-0.489993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 6.993264198303223
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 6.414523124694824
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.736 Vali Acc: 0.540 Test Loss: 0.736 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.662204265594482
Epoch: 6, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.183509111404419
Epoch: 7, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.790 Vali Acc: 0.510 Test Loss: 0.790 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.779968500137329
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.761 Vali Acc: 0.600 Test Loss: 0.761 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599992).  Saving model ...
Epoch: 9 cost time: 6.613290548324585
Epoch: 9, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.760 Vali Acc: 0.560 Test Loss: 0.760 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.195673227310181
Epoch: 10, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.778 Vali Acc: 0.580 Test Loss: 0.778 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.911751747131348
Epoch: 11, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.911 Vali Acc: 0.530 Test Loss: 0.911 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.591576099395752
Epoch: 12, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.837 Vali Acc: 0.600 Test Loss: 0.837 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.776652097702026
Epoch: 13, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.883 Vali Acc: 0.570 Test Loss: 0.883 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.2684338092803955
Epoch: 14, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.856 Vali Acc: 0.570 Test Loss: 0.856 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.200397253036499
Epoch: 15, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.44402813911438
Epoch: 16, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.877 Vali Acc: 0.540 Test Loss: 0.877 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.680184364318848
Epoch: 17, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.844 Vali Acc: 0.580 Test Loss: 0.844 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.4216086864471436
Epoch: 18, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.844 Vali Acc: 0.600 Test Loss: 0.844 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.66288948059082
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.687777280807495
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 6.337684154510498
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.437705993652344
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.37556791305542
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.194209098815918
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 7 cost time: 6.4249677658081055
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.420146942138672
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.449326992034912
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.1597065925598145
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.556083679199219
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.620859622955322
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.407121896743774
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 14 cost time: 6.772028923034668
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.011783838272095
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.405480861663818
Epoch: 16, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.881035327911377
Epoch: 17, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.29328179359436
Epoch: 18, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.395504713058472
Epoch: 19, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.5469725131988525
Epoch: 20, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.334516763687134
Epoch: 21, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.316362380981445
Epoch: 22, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.586327075958252
Epoch: 23, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 523842
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.259538888931274
Epoch: 1, Steps: 20 | Train Loss: 0.748 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.399456977844238
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.743 Vali Acc: 0.440 Test Loss: 0.743 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.404109001159668
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.452713251113892
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.825 Vali Acc: 0.440 Test Loss: 0.825 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.737871170043945
Epoch: 5, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 6 cost time: 7.07703423500061
Epoch: 6, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.807 Vali Acc: 0.470 Test Loss: 0.807 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.96680212020874
Epoch: 7, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.8731231689453125
Epoch: 8, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.776936292648315
Epoch: 9, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.851 Vali Acc: 0.490 Test Loss: 0.851 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.809054851531982
Epoch: 10, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.937 Vali Acc: 0.490 Test Loss: 0.937 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.631788969039917
Epoch: 11, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.831 Vali Acc: 0.480 Test Loss: 0.831 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.651576280593872
Epoch: 12, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.868 Vali Acc: 0.510 Test Loss: 0.868 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.398207187652588
Epoch: 13, Steps: 20 | Train Loss: 0.515 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.378942012786865
Epoch: 14, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.853 Vali Acc: 0.520 Test Loss: 0.853 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519991).  Saving model ...
Epoch: 15 cost time: 6.637363910675049
Epoch: 15, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.871 Vali Acc: 0.500 Test Loss: 0.871 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.436122417449951
Epoch: 16, Steps: 20 | Train Loss: 0.453 Vali Loss: 0.861 Vali Acc: 0.520 Test Loss: 0.861 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.364265203475952
Epoch: 17, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.896 Vali Acc: 0.510 Test Loss: 0.896 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.122606039047241
Epoch: 18, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.941 Vali Acc: 0.520 Test Loss: 0.941 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.473505735397339
Epoch: 19, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539992).  Saving model ...
Epoch: 20 cost time: 6.661685466766357
Epoch: 20, Steps: 20 | Train Loss: 0.397 Vali Loss: 0.843 Vali Acc: 0.520 Test Loss: 0.843 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.3029820919036865
Epoch: 21, Steps: 20 | Train Loss: 0.376 Vali Loss: 1.013 Vali Acc: 0.510 Test Loss: 1.013 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.746281862258911
Epoch: 22, Steps: 20 | Train Loss: 0.351 Vali Loss: 0.896 Vali Acc: 0.550 Test Loss: 0.896 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549991).  Saving model ...
Epoch: 23 cost time: 7.172464609146118
Epoch: 23, Steps: 20 | Train Loss: 0.313 Vali Loss: 0.893 Vali Acc: 0.540 Test Loss: 0.893 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.86963415145874
Epoch: 24, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.070 Vali Acc: 0.540 Test Loss: 1.070 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.0405213832855225
Epoch: 25, Steps: 20 | Train Loss: 0.306 Vali Loss: 0.974 Vali Acc: 0.530 Test Loss: 0.974 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.167515277862549
Epoch: 26, Steps: 20 | Train Loss: 0.269 Vali Loss: 0.960 Vali Acc: 0.530 Test Loss: 0.960 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.711348295211792
Epoch: 27, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.756612300872803
Epoch: 28, Steps: 20 | Train Loss: 0.213 Vali Loss: 1.118 Vali Acc: 0.540 Test Loss: 1.118 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.927748918533325
Epoch: 29, Steps: 20 | Train Loss: 0.220 Vali Loss: 1.112 Vali Acc: 0.490 Test Loss: 1.112 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.267772436141968
Epoch: 30, Steps: 20 | Train Loss: 0.208 Vali Loss: 1.228 Vali Acc: 0.530 Test Loss: 1.228 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.6686155796051025
Epoch: 31, Steps: 20 | Train Loss: 0.217 Vali Loss: 1.102 Vali Acc: 0.550 Test Loss: 1.102 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.295124292373657
Epoch: 32, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.172 Vali Acc: 0.530 Test Loss: 1.172 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.459335088729858
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.715 Vali Acc: 0.530 Test Loss: 0.715 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 6.339299917221069
Epoch: 2, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.745 Vali Acc: 0.510 Test Loss: 0.745 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.633732557296753
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.206435203552246
Epoch: 4, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.815 Vali Acc: 0.480 Test Loss: 0.815 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.276245355606079
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.534680128097534
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.344825506210327
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.803 Vali Acc: 0.490 Test Loss: 0.803 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.395037889480591
Epoch: 8, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.805 Vali Acc: 0.460 Test Loss: 0.805 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.467081069946289
Epoch: 9, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.855 Vali Acc: 0.490 Test Loss: 0.855 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.4208409786224365
Epoch: 10, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.903 Vali Acc: 0.480 Test Loss: 0.903 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.613527059555054
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.835 Vali Acc: 0.480 Test Loss: 0.835 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.21505618095398
Epoch: 1, Steps: 20 | Train Loss: 0.736 Vali Loss: 0.721 Vali Acc: 0.530 Test Loss: 0.721 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 6.311098337173462
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.321074724197388
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.163267135620117
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.608822584152222
Epoch: 5, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.805 Vali Acc: 0.520 Test Loss: 0.805 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.211387634277344
Epoch: 6, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.368969202041626
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.561762094497681
Epoch: 8, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.781 Vali Acc: 0.530 Test Loss: 0.781 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.688084602355957
Epoch: 9, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.9641852378845215
Epoch: 10, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.849 Vali Acc: 0.550 Test Loss: 0.849 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 6.50499963760376
Epoch: 11, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.836731910705566
Epoch: 12, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.811 Vali Acc: 0.510 Test Loss: 0.811 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.647119522094727
Epoch: 13, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.556385278701782
Epoch: 14, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 15 cost time: 6.657354354858398
Epoch: 15, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.810 Vali Acc: 0.550 Test Loss: 0.810 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.004223823547363
Epoch: 16, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.784 Vali Acc: 0.590 Test Loss: 0.784 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589992).  Saving model ...
Epoch: 17 cost time: 6.512896776199341
Epoch: 17, Steps: 20 | Train Loss: 0.451 Vali Loss: 0.771 Vali Acc: 0.530 Test Loss: 0.771 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.393858909606934
Epoch: 18, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.825 Vali Acc: 0.580 Test Loss: 0.825 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.429565191268921
Epoch: 19, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.749 Vali Acc: 0.610 Test Loss: 0.749 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609993).  Saving model ...
Epoch: 20 cost time: 6.381113529205322
Epoch: 20, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.817 Vali Acc: 0.560 Test Loss: 0.817 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.513909101486206
Epoch: 21, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.917 Vali Acc: 0.510 Test Loss: 0.917 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.135911703109741
Epoch: 22, Steps: 20 | Train Loss: 0.358 Vali Loss: 0.801 Vali Acc: 0.610 Test Loss: 0.801 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.9817893505096436
Epoch: 23, Steps: 20 | Train Loss: 0.314 Vali Loss: 0.870 Vali Acc: 0.550 Test Loss: 0.870 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.446422815322876
Epoch: 24, Steps: 20 | Train Loss: 0.317 Vali Loss: 1.022 Vali Acc: 0.520 Test Loss: 1.022 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.923380136489868
Epoch: 25, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.984 Vali Acc: 0.590 Test Loss: 0.984 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.034118175506592
Epoch: 26, Steps: 20 | Train Loss: 0.272 Vali Loss: 0.836 Vali Acc: 0.610 Test Loss: 0.836 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.515458106994629
Epoch: 27, Steps: 20 | Train Loss: 0.235 Vali Loss: 1.034 Vali Acc: 0.530 Test Loss: 1.034 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.532172203063965
Epoch: 28, Steps: 20 | Train Loss: 0.238 Vali Loss: 0.966 Vali Acc: 0.580 Test Loss: 0.966 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.50749659538269
Epoch: 29, Steps: 20 | Train Loss: 0.228 Vali Loss: 0.925 Vali Acc: 0.610 Test Loss: 0.925 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.205739259719849
Epoch: 1, Steps: 20 | Train Loss: 0.741 Vali Loss: 0.738 Vali Acc: 0.440 Test Loss: 0.738 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 6.353351354598999
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.747 Vali Acc: 0.470 Test Loss: 0.747 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 6.308591604232788
Epoch: 3, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 6.232542276382446
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 6.00851845741272
Epoch: 5, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.102678298950195
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 7 cost time: 6.280960321426392
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.220649480819702
Epoch: 8, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 6.128281831741333
Epoch: 9, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.806 Vali Acc: 0.530 Test Loss: 0.806 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.461695671081543
Epoch: 10, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.260557651519775
Epoch: 11, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.802 Vali Acc: 0.520 Test Loss: 0.802 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.154768466949463
Epoch: 12, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.800 Vali Acc: 0.590 Test Loss: 0.800 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589992).  Saving model ...
Epoch: 13 cost time: 6.404163837432861
Epoch: 13, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.792 Vali Acc: 0.570 Test Loss: 0.792 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.037042856216431
Epoch: 14, Steps: 20 | Train Loss: 0.536 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.500987529754639
Epoch: 15, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.782 Vali Acc: 0.580 Test Loss: 0.782 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.86067533493042
Epoch: 16, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.140221834182739
Epoch: 17, Steps: 20 | Train Loss: 0.465 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.075576305389404
Epoch: 18, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.827 Vali Acc: 0.600 Test Loss: 0.827 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 19 cost time: 6.121282577514648
Epoch: 19, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.3805506229400635
Epoch: 20, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.854 Vali Acc: 0.540 Test Loss: 0.854 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.153545379638672
Epoch: 21, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.814 Vali Acc: 0.560 Test Loss: 0.814 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.94991397857666
Epoch: 22, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.764 Vali Acc: 0.600 Test Loss: 0.764 Test Acc: 0.600
Validation loss decreased (-0.599992 --> -0.599992).  Saving model ...
Epoch: 23 cost time: 6.329177618026733
Epoch: 23, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.816 Vali Acc: 0.620 Test Loss: 0.816 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619992).  Saving model ...
Epoch: 24 cost time: 6.25410270690918
Epoch: 24, Steps: 20 | Train Loss: 0.347 Vali Loss: 0.976 Vali Acc: 0.600 Test Loss: 0.976 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.380260467529297
Epoch: 25, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.939 Vali Acc: 0.580 Test Loss: 0.939 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.773565769195557
Epoch: 26, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.874 Vali Acc: 0.590 Test Loss: 0.874 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.677285432815552
Epoch: 27, Steps: 20 | Train Loss: 0.252 Vali Loss: 0.971 Vali Acc: 0.580 Test Loss: 0.971 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.395158052444458
Epoch: 28, Steps: 20 | Train Loss: 0.267 Vali Loss: 0.927 Vali Acc: 0.610 Test Loss: 0.927 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.6674416065216064
Epoch: 29, Steps: 20 | Train Loss: 0.251 Vali Loss: 0.951 Vali Acc: 0.640 Test Loss: 0.951 Test Acc: 0.640
Validation loss decreased (-0.619992 --> -0.639990).  Saving model ...
Epoch: 30 cost time: 6.517472505569458
Epoch: 30, Steps: 20 | Train Loss: 0.227 Vali Loss: 1.052 Vali Acc: 0.610 Test Loss: 1.052 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 7.019789695739746
Epoch: 31, Steps: 20 | Train Loss: 0.233 Vali Loss: 1.006 Vali Acc: 0.590 Test Loss: 1.006 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.433457851409912
Epoch: 32, Steps: 20 | Train Loss: 0.203 Vali Loss: 1.036 Vali Acc: 0.540 Test Loss: 1.036 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.7757298946380615
Epoch: 33, Steps: 20 | Train Loss: 0.194 Vali Loss: 1.101 Vali Acc: 0.600 Test Loss: 1.101 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.35095739364624
Epoch: 34, Steps: 20 | Train Loss: 0.187 Vali Loss: 1.198 Vali Acc: 0.540 Test Loss: 1.198 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.552444934844971
Epoch: 35, Steps: 20 | Train Loss: 0.146 Vali Loss: 1.174 Vali Acc: 0.590 Test Loss: 1.174 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.785410165786743
Epoch: 36, Steps: 20 | Train Loss: 0.134 Vali Loss: 1.149 Vali Acc: 0.590 Test Loss: 1.149 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.706988334655762
Epoch: 37, Steps: 20 | Train Loss: 0.098 Vali Loss: 1.274 Vali Acc: 0.560 Test Loss: 1.274 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.56666374206543
Epoch: 38, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.270 Vali Acc: 0.550 Test Loss: 1.270 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.370061874389648
Epoch: 39, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.325 Vali Acc: 0.570 Test Loss: 1.325 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.448191165924072
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 6.958096504211426
Epoch: 2, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 6.725674629211426
Epoch: 3, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.477902412414551
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.845 Vali Acc: 0.510 Test Loss: 0.845 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.467757701873779
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.882 Vali Acc: 0.500 Test Loss: 0.882 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.52967643737793
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.883 Vali Acc: 0.500 Test Loss: 0.883 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.690538167953491
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.954 Vali Acc: 0.490 Test Loss: 0.954 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.2234721183776855
Epoch: 8, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.940 Vali Acc: 0.490 Test Loss: 0.940 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.918351173400879
Epoch: 9, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.935 Vali Acc: 0.460 Test Loss: 0.935 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.035105228424072
Epoch: 10, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.964 Vali Acc: 0.460 Test Loss: 0.964 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.0899903774261475
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.956 Vali Acc: 0.470 Test Loss: 0.956 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.8284783363342285
Epoch: 12, Steps: 20 | Train Loss: 0.559 Vali Loss: 1.014 Vali Acc: 0.460 Test Loss: 1.014 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.3370280265808105
Epoch: 1, Steps: 20 | Train Loss: 0.737 Vali Loss: 0.692 Vali Acc: 0.560 Test Loss: 0.692 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 6.257259845733643
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.711 Vali Acc: 0.520 Test Loss: 0.711 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.106713056564331
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.698 Vali Acc: 0.600 Test Loss: 0.698 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 6.004080533981323
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.716 Vali Acc: 0.570 Test Loss: 0.716 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.2890613079071045
Epoch: 5, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.741 Vali Acc: 0.540 Test Loss: 0.741 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.282639503479004
Epoch: 6, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.738 Vali Acc: 0.570 Test Loss: 0.738 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.111445188522339
Epoch: 7, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.804 Vali Acc: 0.510 Test Loss: 0.804 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.235857009887695
Epoch: 8, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.798 Vali Acc: 0.550 Test Loss: 0.798 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.252521276473999
Epoch: 9, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.786 Vali Acc: 0.560 Test Loss: 0.786 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.070920705795288
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.707016944885254
Epoch: 11, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.352534294128418
Epoch: 12, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.08493709564209
Epoch: 13, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.847 Vali Acc: 0.570 Test Loss: 0.847 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.659298419952393
Epoch: 1, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.689 Vali Acc: 0.560 Test Loss: 0.689 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 6.103268146514893
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.164063453674316
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.699 Vali Acc: 0.520 Test Loss: 0.699 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.557394981384277
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.432227849960327
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.436236381530762
Epoch: 6, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.761469841003418
Epoch: 7, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.820 Vali Acc: 0.480 Test Loss: 0.820 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.573374032974243
Epoch: 8, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.184127569198608
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.832 Vali Acc: 0.490 Test Loss: 0.832 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.60458779335022
Epoch: 10, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.826 Vali Acc: 0.570 Test Loss: 0.826 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 11 cost time: 6.191012859344482
Epoch: 11, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.797 Vali Acc: 0.540 Test Loss: 0.797 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.146073818206787
Epoch: 12, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.846 Vali Acc: 0.520 Test Loss: 0.846 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.248681545257568
Epoch: 13, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.142272472381592
Epoch: 14, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.856 Vali Acc: 0.560 Test Loss: 0.856 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.213409185409546
Epoch: 15, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.867 Vali Acc: 0.560 Test Loss: 0.867 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.113068103790283
Epoch: 16, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.889 Vali Acc: 0.550 Test Loss: 0.889 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.46400785446167
Epoch: 17, Steps: 20 | Train Loss: 0.526 Vali Loss: 0.890 Vali Acc: 0.570 Test Loss: 0.890 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.003543853759766
Epoch: 18, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.978 Vali Acc: 0.540 Test Loss: 0.978 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.625516653060913
Epoch: 19, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.941 Vali Acc: 0.590 Test Loss: 0.941 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589991).  Saving model ...
Epoch: 20 cost time: 6.553453683853149
Epoch: 20, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.913 Vali Acc: 0.580 Test Loss: 0.913 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.495921611785889
Epoch: 21, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.18901252746582
Epoch: 22, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.921 Vali Acc: 0.620 Test Loss: 0.921 Test Acc: 0.620
Validation loss decreased (-0.589991 --> -0.619991).  Saving model ...
Epoch: 23 cost time: 6.2388916015625
Epoch: 23, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.929 Vali Acc: 0.560 Test Loss: 0.929 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.036999940872192
Epoch: 24, Steps: 20 | Train Loss: 0.415 Vali Loss: 0.876 Vali Acc: 0.570 Test Loss: 0.876 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.145276069641113
Epoch: 25, Steps: 20 | Train Loss: 0.434 Vali Loss: 0.984 Vali Acc: 0.580 Test Loss: 0.984 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.936619997024536
Epoch: 26, Steps: 20 | Train Loss: 0.390 Vali Loss: 1.077 Vali Acc: 0.520 Test Loss: 1.077 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.7700440883636475
Epoch: 27, Steps: 20 | Train Loss: 0.387 Vali Loss: 1.045 Vali Acc: 0.580 Test Loss: 1.045 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.188369989395142
Epoch: 28, Steps: 20 | Train Loss: 0.374 Vali Loss: 1.049 Vali Acc: 0.610 Test Loss: 1.049 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.980556488037109
Epoch: 29, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.131 Vali Acc: 0.590 Test Loss: 1.131 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.167356729507446
Epoch: 30, Steps: 20 | Train Loss: 0.318 Vali Loss: 1.071 Vali Acc: 0.570 Test Loss: 1.071 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.769160747528076
Epoch: 31, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.692435026168823
Epoch: 32, Steps: 20 | Train Loss: 0.379 Vali Loss: 1.139 Vali Acc: 0.590 Test Loss: 1.139 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.799401044845581
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.133124351501465
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.34145450592041
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.6213414669036865
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.844459772109985
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 6 cost time: 6.50434422492981
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.422621488571167
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.29341197013855
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.161620616912842
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.280878067016602
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.260386943817139
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.1211042404174805
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.558485746383667
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.585905313491821
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.7053608894348145
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 327234
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.179498195648193
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.747 Vali Acc: 0.420 Test Loss: 0.747 Test Acc: 0.420
Validation loss decreased (inf --> -0.419993).  Saving model ...
Epoch: 2 cost time: 7.053470849990845
Epoch: 2, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.779 Vali Acc: 0.460 Test Loss: 0.779 Test Acc: 0.460
Validation loss decreased (-0.419993 --> -0.459992).  Saving model ...
Epoch: 3 cost time: 7.318127870559692
Epoch: 3, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.789 Vali Acc: 0.450 Test Loss: 0.789 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.293115139007568
Epoch: 4, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
Validation loss decreased (-0.459992 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 7.301164388656616
Epoch: 5, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.809 Vali Acc: 0.460 Test Loss: 0.809 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.7484190464019775
Epoch: 6, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.830 Vali Acc: 0.450 Test Loss: 0.830 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.088525056838989
Epoch: 7, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.836 Vali Acc: 0.430 Test Loss: 0.836 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.793337106704712
Epoch: 8, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.822 Vali Acc: 0.460 Test Loss: 0.822 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.17146110534668
Epoch: 9, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.849 Vali Acc: 0.490 Test Loss: 0.849 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.06279993057251
Epoch: 10, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.857 Vali Acc: 0.480 Test Loss: 0.857 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.184126615524292
Epoch: 11, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.853 Vali Acc: 0.490 Test Loss: 0.853 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.997000455856323
Epoch: 12, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.863 Vali Acc: 0.550 Test Loss: 0.863 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549991).  Saving model ...
Epoch: 13 cost time: 7.073047399520874
Epoch: 13, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.859 Vali Acc: 0.520 Test Loss: 0.859 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.137636661529541
Epoch: 14, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.6437668800354
Epoch: 15, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.894 Vali Acc: 0.490 Test Loss: 0.894 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.626631736755371
Epoch: 16, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.826095342636108
Epoch: 17, Steps: 20 | Train Loss: 0.520 Vali Loss: 1.011 Vali Acc: 0.480 Test Loss: 1.011 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.398712396621704
Epoch: 18, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.942 Vali Acc: 0.470 Test Loss: 0.942 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.178397178649902
Epoch: 19, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.893 Vali Acc: 0.490 Test Loss: 0.893 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.675953388214111
Epoch: 20, Steps: 20 | Train Loss: 0.404 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.316815376281738
Epoch: 21, Steps: 20 | Train Loss: 0.385 Vali Loss: 0.939 Vali Acc: 0.490 Test Loss: 0.939 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.832334518432617
Epoch: 22, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.902 Vali Acc: 0.500 Test Loss: 0.902 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.86689805984497
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.727 Vali Acc: 0.410 Test Loss: 0.727 Test Acc: 0.410
Validation loss decreased (inf --> -0.409993).  Saving model ...
Epoch: 2 cost time: 6.501413583755493
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.763 Vali Acc: 0.490 Test Loss: 0.763 Test Acc: 0.490
Validation loss decreased (-0.409993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 6.7833571434021
Epoch: 3, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.767 Vali Acc: 0.460 Test Loss: 0.767 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.277719259262085
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.804 Vali Acc: 0.480 Test Loss: 0.804 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.2646777629852295
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.795 Vali Acc: 0.450 Test Loss: 0.795 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.7671661376953125
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.663109302520752
Epoch: 7, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.802 Vali Acc: 0.450 Test Loss: 0.802 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.875768423080444
Epoch: 8, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 9 cost time: 6.766385555267334
Epoch: 9, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.835 Vali Acc: 0.510 Test Loss: 0.835 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 10 cost time: 6.504398822784424
Epoch: 10, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.00933313369751
Epoch: 11, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.845 Vali Acc: 0.470 Test Loss: 0.845 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.857530832290649
Epoch: 12, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.847 Vali Acc: 0.490 Test Loss: 0.847 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.73827600479126
Epoch: 13, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.3277482986450195
Epoch: 14, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.857 Vali Acc: 0.510 Test Loss: 0.857 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.390756368637085
Epoch: 15, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.896 Vali Acc: 0.470 Test Loss: 0.896 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.268327236175537
Epoch: 16, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.875 Vali Acc: 0.490 Test Loss: 0.875 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.264597415924072
Epoch: 17, Steps: 20 | Train Loss: 0.526 Vali Loss: 1.030 Vali Acc: 0.520 Test Loss: 1.030 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519990).  Saving model ...
Epoch: 18 cost time: 6.190925598144531
Epoch: 18, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.945 Vali Acc: 0.510 Test Loss: 0.945 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.08197283744812
Epoch: 19, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.916 Vali Acc: 0.500 Test Loss: 0.916 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.681787014007568
Epoch: 20, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.899 Vali Acc: 0.500 Test Loss: 0.899 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.389517068862915
Epoch: 21, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.929 Vali Acc: 0.490 Test Loss: 0.929 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.114488840103149
Epoch: 22, Steps: 20 | Train Loss: 0.409 Vali Loss: 0.933 Vali Acc: 0.490 Test Loss: 0.933 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.351170063018799
Epoch: 23, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.969 Vali Acc: 0.490 Test Loss: 0.969 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.783036231994629
Epoch: 24, Steps: 20 | Train Loss: 0.360 Vali Loss: 0.942 Vali Acc: 0.500 Test Loss: 0.942 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.671727180480957
Epoch: 25, Steps: 20 | Train Loss: 0.367 Vali Loss: 0.990 Vali Acc: 0.500 Test Loss: 0.990 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.475910186767578
Epoch: 26, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.959 Vali Acc: 0.520 Test Loss: 0.959 Test Acc: 0.520
Validation loss decreased (-0.519990 --> -0.519990).  Saving model ...
Epoch: 27 cost time: 6.533219575881958
Epoch: 27, Steps: 20 | Train Loss: 0.296 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
Validation loss decreased (-0.519990 --> -0.549988).  Saving model ...
Epoch: 28 cost time: 6.58338189125061
Epoch: 28, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.024 Vali Acc: 0.500 Test Loss: 1.024 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.335245609283447
Epoch: 29, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.077 Vali Acc: 0.530 Test Loss: 1.077 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.272577285766602
Epoch: 30, Steps: 20 | Train Loss: 0.232 Vali Loss: 1.080 Vali Acc: 0.520 Test Loss: 1.080 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.870310306549072
Epoch: 31, Steps: 20 | Train Loss: 0.221 Vali Loss: 1.159 Vali Acc: 0.520 Test Loss: 1.159 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.6657555103302
Epoch: 32, Steps: 20 | Train Loss: 0.193 Vali Loss: 1.131 Vali Acc: 0.530 Test Loss: 1.131 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.398605585098267
Epoch: 33, Steps: 20 | Train Loss: 0.173 Vali Loss: 1.036 Vali Acc: 0.560 Test Loss: 1.036 Test Acc: 0.560
Validation loss decreased (-0.549988 --> -0.559990).  Saving model ...
Epoch: 34 cost time: 6.6806347370147705
Epoch: 34, Steps: 20 | Train Loss: 0.167 Vali Loss: 1.244 Vali Acc: 0.510 Test Loss: 1.244 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.823939323425293
Epoch: 35, Steps: 20 | Train Loss: 0.169 Vali Loss: 1.242 Vali Acc: 0.520 Test Loss: 1.242 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.901845932006836
Epoch: 36, Steps: 20 | Train Loss: 0.150 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 7.146110773086548
Epoch: 37, Steps: 20 | Train Loss: 0.129 Vali Loss: 1.262 Vali Acc: 0.550 Test Loss: 1.262 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 7.3475377559661865
Epoch: 38, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.293 Vali Acc: 0.520 Test Loss: 1.293 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 7.361386775970459
Epoch: 39, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.325 Vali Acc: 0.480 Test Loss: 1.325 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 7.654617547988892
Epoch: 40, Steps: 20 | Train Loss: 0.071 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 6.763237237930298
Epoch: 41, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.238 Vali Acc: 0.530 Test Loss: 1.238 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 6.710661172866821
Epoch: 42, Steps: 20 | Train Loss: 0.083 Vali Loss: 1.387 Vali Acc: 0.540 Test Loss: 1.387 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 6.498821496963501
Epoch: 43, Steps: 20 | Train Loss: 0.073 Vali Loss: 1.217 Vali Acc: 0.580 Test Loss: 1.217 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579988).  Saving model ...
Epoch: 44 cost time: 6.355783224105835
Epoch: 44, Steps: 20 | Train Loss: 0.065 Vali Loss: 1.436 Vali Acc: 0.560 Test Loss: 1.436 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.582540273666382
Epoch: 45, Steps: 20 | Train Loss: 0.063 Vali Loss: 1.510 Vali Acc: 0.520 Test Loss: 1.510 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.763869762420654
Epoch: 46, Steps: 20 | Train Loss: 0.072 Vali Loss: 1.315 Vali Acc: 0.540 Test Loss: 1.315 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 7.270972490310669
Epoch: 47, Steps: 20 | Train Loss: 0.056 Vali Loss: 1.495 Vali Acc: 0.560 Test Loss: 1.495 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 7.187209844589233
Epoch: 48, Steps: 20 | Train Loss: 0.051 Vali Loss: 1.415 Vali Acc: 0.570 Test Loss: 1.415 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 6.919746398925781
Epoch: 49, Steps: 20 | Train Loss: 0.049 Vali Loss: 1.479 Vali Acc: 0.570 Test Loss: 1.479 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 7.005044460296631
Epoch: 50, Steps: 20 | Train Loss: 0.039 Vali Loss: 1.474 Vali Acc: 0.590 Test Loss: 1.474 Test Acc: 0.590
Validation loss decreased (-0.579988 --> -0.589985).  Saving model ...
Epoch: 51 cost time: 6.968406438827515
Epoch: 51, Steps: 20 | Train Loss: 0.024 Vali Loss: 1.448 Vali Acc: 0.590 Test Loss: 1.448 Test Acc: 0.590
Validation loss decreased (-0.589985 --> -0.589986).  Saving model ...
Epoch: 52 cost time: 7.478107690811157
Epoch: 52, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.463 Vali Acc: 0.600 Test Loss: 1.463 Test Acc: 0.600
Validation loss decreased (-0.589986 --> -0.599985).  Saving model ...
Epoch: 53 cost time: 6.903950214385986
Epoch: 53, Steps: 20 | Train Loss: 0.037 Vali Loss: 1.747 Vali Acc: 0.550 Test Loss: 1.747 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.801615238189697
Epoch: 54, Steps: 20 | Train Loss: 0.033 Vali Loss: 1.536 Vali Acc: 0.560 Test Loss: 1.536 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.767033100128174
Epoch: 55, Steps: 20 | Train Loss: 0.029 Vali Loss: 1.584 Vali Acc: 0.520 Test Loss: 1.584 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.550150632858276
Epoch: 56, Steps: 20 | Train Loss: 0.031 Vali Loss: 1.593 Vali Acc: 0.570 Test Loss: 1.593 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 6.520555019378662
Epoch: 57, Steps: 20 | Train Loss: 0.027 Vali Loss: 1.842 Vali Acc: 0.530 Test Loss: 1.842 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 6.691841125488281
Epoch: 58, Steps: 20 | Train Loss: 0.024 Vali Loss: 1.727 Vali Acc: 0.530 Test Loss: 1.727 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 6.81945013999939
Epoch: 59, Steps: 20 | Train Loss: 0.026 Vali Loss: 1.734 Vali Acc: 0.590 Test Loss: 1.734 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 6.822039365768433
Epoch: 60, Steps: 20 | Train Loss: 0.015 Vali Loss: 1.616 Vali Acc: 0.590 Test Loss: 1.616 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 7.035900115966797
Epoch: 61, Steps: 20 | Train Loss: 0.018 Vali Loss: 1.775 Vali Acc: 0.570 Test Loss: 1.775 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 6.817807674407959
Epoch: 62, Steps: 20 | Train Loss: 0.016 Vali Loss: 1.758 Vali Acc: 0.540 Test Loss: 1.758 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.804389476776123
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.722 Vali Acc: 0.400 Test Loss: 0.722 Test Acc: 0.400
Validation loss decreased (inf --> -0.399993).  Saving model ...
Epoch: 2 cost time: 7.044253826141357
Epoch: 2, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.755 Vali Acc: 0.470 Test Loss: 0.755 Test Acc: 0.470
Validation loss decreased (-0.399993 --> -0.469992).  Saving model ...
Epoch: 3 cost time: 7.0820019245147705
Epoch: 3, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.759 Vali Acc: 0.440 Test Loss: 0.759 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.1204798221588135
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.789 Vali Acc: 0.510 Test Loss: 0.789 Test Acc: 0.510
Validation loss decreased (-0.469992 --> -0.509992).  Saving model ...
Epoch: 5 cost time: 6.683051109313965
Epoch: 5, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.778 Vali Acc: 0.470 Test Loss: 0.778 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.537649869918823
Epoch: 6, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.258266925811768
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.790 Vali Acc: 0.460 Test Loss: 0.790 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.321410179138184
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.6605494022369385
Epoch: 9, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519992).  Saving model ...
Epoch: 10 cost time: 6.529476642608643
Epoch: 10, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.793 Vali Acc: 0.480 Test Loss: 0.793 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.053357839584351
Epoch: 11, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.875102758407593
Epoch: 12, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.682363748550415
Epoch: 13, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 14 cost time: 7.270877122879028
Epoch: 14, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529992).  Saving model ...
Epoch: 15 cost time: 6.7809484004974365
Epoch: 15, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.444594383239746
Epoch: 16, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.769 Vali Acc: 0.570 Test Loss: 0.769 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569992).  Saving model ...
Epoch: 17 cost time: 7.170249700546265
Epoch: 17, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.919 Vali Acc: 0.510 Test Loss: 0.919 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.108623504638672
Epoch: 18, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.806 Vali Acc: 0.530 Test Loss: 0.806 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.684112071990967
Epoch: 19, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.805 Vali Acc: 0.540 Test Loss: 0.805 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.881953239440918
Epoch: 20, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.962615251541138
Epoch: 21, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.65532112121582
Epoch: 22, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.773 Vali Acc: 0.580 Test Loss: 0.773 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 23 cost time: 6.695323705673218
Epoch: 23, Steps: 20 | Train Loss: 0.387 Vali Loss: 0.830 Vali Acc: 0.590 Test Loss: 0.830 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 24 cost time: 6.724904775619507
Epoch: 24, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.814 Vali Acc: 0.580 Test Loss: 0.814 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.056486368179321
Epoch: 25, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.784 Vali Acc: 0.590 Test Loss: 0.784 Test Acc: 0.590
Validation loss decreased (-0.589992 --> -0.589992).  Saving model ...
Epoch: 26 cost time: 7.219846487045288
Epoch: 26, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.796 Vali Acc: 0.520 Test Loss: 0.796 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.039724349975586
Epoch: 27, Steps: 20 | Train Loss: 0.303 Vali Loss: 0.906 Vali Acc: 0.580 Test Loss: 0.906 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.0557451248168945
Epoch: 28, Steps: 20 | Train Loss: 0.282 Vali Loss: 0.815 Vali Acc: 0.580 Test Loss: 0.815 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.32555079460144
Epoch: 29, Steps: 20 | Train Loss: 0.239 Vali Loss: 0.930 Vali Acc: 0.560 Test Loss: 0.930 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.0982396602630615
Epoch: 30, Steps: 20 | Train Loss: 0.225 Vali Loss: 0.859 Vali Acc: 0.550 Test Loss: 0.859 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.988436222076416
Epoch: 31, Steps: 20 | Train Loss: 0.217 Vali Loss: 0.963 Vali Acc: 0.580 Test Loss: 0.963 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.948267936706543
Epoch: 32, Steps: 20 | Train Loss: 0.192 Vali Loss: 0.912 Vali Acc: 0.580 Test Loss: 0.912 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.744702577590942
Epoch: 33, Steps: 20 | Train Loss: 0.167 Vali Loss: 0.994 Vali Acc: 0.580 Test Loss: 0.994 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.57597017288208
Epoch: 34, Steps: 20 | Train Loss: 0.142 Vali Loss: 1.096 Vali Acc: 0.530 Test Loss: 1.096 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.302206754684448
Epoch: 35, Steps: 20 | Train Loss: 0.192 Vali Loss: 1.032 Vali Acc: 0.550 Test Loss: 1.032 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.61950135231018
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 6.601527690887451
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.755 Vali Acc: 0.520 Test Loss: 0.755 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 7.0889739990234375
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.773 Vali Acc: 0.480 Test Loss: 0.773 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.7296788692474365
Epoch: 4, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.341660022735596
Epoch: 5, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.772 Vali Acc: 0.470 Test Loss: 0.772 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.026166915893555
Epoch: 6, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.181739568710327
Epoch: 7, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.806 Vali Acc: 0.480 Test Loss: 0.806 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.105105400085449
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 9 cost time: 6.445274114608765
Epoch: 9, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.743534564971924
Epoch: 10, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.820 Vali Acc: 0.520 Test Loss: 0.820 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.001155853271484
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.792 Vali Acc: 0.530 Test Loss: 0.792 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.433054685592651
Epoch: 12, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 13 cost time: 6.6242499351501465
Epoch: 13, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.808 Vali Acc: 0.560 Test Loss: 0.808 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 6.781820058822632
Epoch: 14, Steps: 20 | Train Loss: 0.531 Vali Loss: 0.777 Vali Acc: 0.570 Test Loss: 0.777 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 15 cost time: 7.070209741592407
Epoch: 15, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.456925392150879
Epoch: 16, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.782 Vali Acc: 0.490 Test Loss: 0.782 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.697914361953735
Epoch: 17, Steps: 20 | Train Loss: 0.512 Vali Loss: 0.875 Vali Acc: 0.510 Test Loss: 0.875 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.882106781005859
Epoch: 18, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.823 Vali Acc: 0.510 Test Loss: 0.823 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.439625263214111
Epoch: 19, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.828 Vali Acc: 0.530 Test Loss: 0.828 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.892467260360718
Epoch: 20, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.825 Vali Acc: 0.590 Test Loss: 0.825 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 21 cost time: 7.27075457572937
Epoch: 21, Steps: 20 | Train Loss: 0.418 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.827222585678101
Epoch: 22, Steps: 20 | Train Loss: 0.420 Vali Loss: 0.848 Vali Acc: 0.620 Test Loss: 0.848 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619992).  Saving model ...
Epoch: 23 cost time: 6.996589183807373
Epoch: 23, Steps: 20 | Train Loss: 0.378 Vali Loss: 0.837 Vali Acc: 0.580 Test Loss: 0.837 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.136257648468018
Epoch: 24, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.856 Vali Acc: 0.510 Test Loss: 0.856 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.725669860839844
Epoch: 25, Steps: 20 | Train Loss: 0.361 Vali Loss: 0.887 Vali Acc: 0.540 Test Loss: 0.887 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.229173183441162
Epoch: 26, Steps: 20 | Train Loss: 0.319 Vali Loss: 0.874 Vali Acc: 0.590 Test Loss: 0.874 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.005338907241821
Epoch: 27, Steps: 20 | Train Loss: 0.331 Vali Loss: 0.989 Vali Acc: 0.540 Test Loss: 0.989 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.363670349121094
Epoch: 28, Steps: 20 | Train Loss: 0.288 Vali Loss: 0.970 Vali Acc: 0.610 Test Loss: 0.970 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.5518105030059814
Epoch: 29, Steps: 20 | Train Loss: 0.256 Vali Loss: 0.937 Vali Acc: 0.520 Test Loss: 0.937 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.321573972702026
Epoch: 30, Steps: 20 | Train Loss: 0.236 Vali Loss: 1.021 Vali Acc: 0.550 Test Loss: 1.021 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 7.341574668884277
Epoch: 31, Steps: 20 | Train Loss: 0.229 Vali Loss: 1.007 Vali Acc: 0.570 Test Loss: 1.007 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.363759756088257
Epoch: 32, Steps: 20 | Train Loss: 0.212 Vali Loss: 1.127 Vali Acc: 0.560 Test Loss: 1.127 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.646792888641357
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.744 Vali Acc: 0.470 Test Loss: 0.744 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 6.7352659702301025
Epoch: 2, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.786 Vali Acc: 0.450 Test Loss: 0.786 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.898714303970337
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 6.402545690536499
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 5 cost time: 7.176177740097046
Epoch: 5, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.850 Vali Acc: 0.510 Test Loss: 0.850 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.383916139602661
Epoch: 6, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.876 Vali Acc: 0.480 Test Loss: 0.876 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.399322748184204
Epoch: 7, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.889 Vali Acc: 0.490 Test Loss: 0.889 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.965692520141602
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.129167556762695
Epoch: 9, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.908 Vali Acc: 0.470 Test Loss: 0.908 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.382849454879761
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.907 Vali Acc: 0.490 Test Loss: 0.907 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.013845682144165
Epoch: 11, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.917 Vali Acc: 0.490 Test Loss: 0.917 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.781470537185669
Epoch: 12, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.971 Vali Acc: 0.550 Test Loss: 0.971 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549990).  Saving model ...
Epoch: 13 cost time: 6.7406346797943115
Epoch: 13, Steps: 20 | Train Loss: 0.551 Vali Loss: 1.006 Vali Acc: 0.490 Test Loss: 1.006 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.222026348114014
Epoch: 14, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.941 Vali Acc: 0.490 Test Loss: 0.941 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.945032119750977
Epoch: 15, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.974 Vali Acc: 0.490 Test Loss: 0.974 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.1276774406433105
Epoch: 16, Steps: 20 | Train Loss: 0.556 Vali Loss: 1.010 Vali Acc: 0.480 Test Loss: 1.010 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.489353895187378
Epoch: 17, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.991 Vali Acc: 0.440 Test Loss: 0.991 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.5552966594696045
Epoch: 18, Steps: 20 | Train Loss: 0.498 Vali Loss: 0.949 Vali Acc: 0.510 Test Loss: 0.949 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.526304483413696
Epoch: 19, Steps: 20 | Train Loss: 0.524 Vali Loss: 1.000 Vali Acc: 0.510 Test Loss: 1.000 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.996735095977783
Epoch: 20, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.926 Vali Acc: 0.510 Test Loss: 0.926 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.356093406677246
Epoch: 21, Steps: 20 | Train Loss: 0.467 Vali Loss: 0.937 Vali Acc: 0.550 Test Loss: 0.937 Test Acc: 0.550
Validation loss decreased (-0.549990 --> -0.549991).  Saving model ...
Epoch: 22 cost time: 6.486211538314819
Epoch: 22, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.001 Vali Acc: 0.540 Test Loss: 1.001 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.1445090770721436
Epoch: 23, Steps: 20 | Train Loss: 0.474 Vali Loss: 1.006 Vali Acc: 0.550 Test Loss: 1.006 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.734599590301514
Epoch: 24, Steps: 20 | Train Loss: 0.431 Vali Loss: 0.969 Vali Acc: 0.540 Test Loss: 0.969 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.31124210357666
Epoch: 25, Steps: 20 | Train Loss: 0.401 Vali Loss: 1.038 Vali Acc: 0.520 Test Loss: 1.038 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.62380051612854
Epoch: 26, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.968 Vali Acc: 0.580 Test Loss: 0.968 Test Acc: 0.580
Validation loss decreased (-0.549991 --> -0.579990).  Saving model ...
Epoch: 27 cost time: 6.567542314529419
Epoch: 27, Steps: 20 | Train Loss: 0.411 Vali Loss: 1.076 Vali Acc: 0.570 Test Loss: 1.076 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.689138412475586
Epoch: 28, Steps: 20 | Train Loss: 0.375 Vali Loss: 1.095 Vali Acc: 0.560 Test Loss: 1.095 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.730249643325806
Epoch: 29, Steps: 20 | Train Loss: 0.311 Vali Loss: 1.117 Vali Acc: 0.520 Test Loss: 1.117 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.36805272102356
Epoch: 30, Steps: 20 | Train Loss: 0.363 Vali Loss: 1.115 Vali Acc: 0.550 Test Loss: 1.115 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.515382766723633
Epoch: 31, Steps: 20 | Train Loss: 0.327 Vali Loss: 1.167 Vali Acc: 0.510 Test Loss: 1.167 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.801645278930664
Epoch: 32, Steps: 20 | Train Loss: 0.280 Vali Loss: 1.212 Vali Acc: 0.550 Test Loss: 1.212 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.5531556606292725
Epoch: 33, Steps: 20 | Train Loss: 0.285 Vali Loss: 1.094 Vali Acc: 0.550 Test Loss: 1.094 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 7.0982866287231445
Epoch: 34, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.137 Vali Acc: 0.560 Test Loss: 1.137 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 7.148658752441406
Epoch: 35, Steps: 20 | Train Loss: 0.282 Vali Loss: 1.260 Vali Acc: 0.570 Test Loss: 1.260 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 7.2065958976745605
Epoch: 36, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.129 Vali Acc: 0.510 Test Loss: 1.129 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.722976446151733
Epoch: 1, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.733 Vali Acc: 0.440 Test Loss: 0.733 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 6.173081398010254
Epoch: 2, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.733 Vali Acc: 0.410 Test Loss: 0.733 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.216063022613525
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.735 Vali Acc: 0.420 Test Loss: 0.735 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.189960956573486
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
Validation loss decreased (-0.439993 --> -0.469993).  Saving model ...
Epoch: 5 cost time: 6.1255621910095215
Epoch: 5, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
Validation loss decreased (-0.469993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 6.350403785705566
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.762 Vali Acc: 0.450 Test Loss: 0.762 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.279772520065308
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.760 Vali Acc: 0.490 Test Loss: 0.760 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.433220624923706
Epoch: 8, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.895388841629028
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.564335107803345
Epoch: 10, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.890 Vali Acc: 0.460 Test Loss: 0.890 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.254939794540405
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.782 Vali Acc: 0.540 Test Loss: 0.782 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.340731382369995
Epoch: 12, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.472134590148926
Epoch: 13, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.793 Vali Acc: 0.570 Test Loss: 0.793 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 7.33893084526062
Epoch: 14, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.715018272399902
Epoch: 15, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.850 Vali Acc: 0.560 Test Loss: 0.850 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.739420652389526
Epoch: 16, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.821 Vali Acc: 0.580 Test Loss: 0.821 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 17 cost time: 6.531767129898071
Epoch: 17, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.962 Vali Acc: 0.530 Test Loss: 0.962 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.923811674118042
Epoch: 18, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.806 Vali Acc: 0.590 Test Loss: 0.806 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 19 cost time: 6.1251397132873535
Epoch: 19, Steps: 20 | Train Loss: 0.532 Vali Loss: 0.826 Vali Acc: 0.620 Test Loss: 0.826 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619992).  Saving model ...
Epoch: 20 cost time: 6.025430202484131
Epoch: 20, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.830 Vali Acc: 0.600 Test Loss: 0.830 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.488068580627441
Epoch: 21, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.59991717338562
Epoch: 22, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.938 Vali Acc: 0.560 Test Loss: 0.938 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.024417400360107
Epoch: 23, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.885 Vali Acc: 0.590 Test Loss: 0.885 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.660434007644653
Epoch: 24, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.853 Vali Acc: 0.600 Test Loss: 0.853 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.553411245346069
Epoch: 25, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.908 Vali Acc: 0.580 Test Loss: 0.908 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.345811605453491
Epoch: 26, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.889 Vali Acc: 0.570 Test Loss: 0.889 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.425487995147705
Epoch: 27, Steps: 20 | Train Loss: 0.488 Vali Loss: 1.022 Vali Acc: 0.550 Test Loss: 1.022 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.229765176773071
Epoch: 28, Steps: 20 | Train Loss: 0.422 Vali Loss: 1.052 Vali Acc: 0.550 Test Loss: 1.052 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.246286392211914
Epoch: 29, Steps: 20 | Train Loss: 0.434 Vali Loss: 1.121 Vali Acc: 0.580 Test Loss: 1.121 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.009807825088501
Epoch: 1, Steps: 20 | Train Loss: 0.709 Vali Loss: 0.711 Vali Acc: 0.460 Test Loss: 0.711 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 6.466579914093018
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 6.260434627532959
Epoch: 3, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.278453826904297
Epoch: 4, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.730 Vali Acc: 0.560 Test Loss: 0.730 Test Acc: 0.560
Validation loss decreased (-0.519993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 6.7305402755737305
Epoch: 5, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.9385666847229
Epoch: 6, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.759 Vali Acc: 0.530 Test Loss: 0.759 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.681546688079834
Epoch: 7, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.539547443389893
Epoch: 8, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.454700708389282
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.803 Vali Acc: 0.570 Test Loss: 0.803 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 6.371028184890747
Epoch: 10, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.290653944015503
Epoch: 11, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.792 Vali Acc: 0.560 Test Loss: 0.792 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.259537220001221
Epoch: 12, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.262458324432373
Epoch: 13, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.800 Vali Acc: 0.560 Test Loss: 0.800 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.440583229064941
Epoch: 14, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.784 Vali Acc: 0.590 Test Loss: 0.784 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 15 cost time: 6.023813009262085
Epoch: 15, Steps: 20 | Train Loss: 0.553 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.04165244102478
Epoch: 16, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.829 Vali Acc: 0.570 Test Loss: 0.829 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.245590448379517
Epoch: 17, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.939 Vali Acc: 0.540 Test Loss: 0.939 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.6370627880096436
Epoch: 18, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.814 Vali Acc: 0.600 Test Loss: 0.814 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 19 cost time: 6.499701023101807
Epoch: 19, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.832 Vali Acc: 0.590 Test Loss: 0.832 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.7711567878723145
Epoch: 20, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.831 Vali Acc: 0.610 Test Loss: 0.831 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609992).  Saving model ...
Epoch: 21 cost time: 6.740061521530151
Epoch: 21, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.929 Vali Acc: 0.560 Test Loss: 0.929 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.163443088531494
Epoch: 22, Steps: 20 | Train Loss: 0.482 Vali Loss: 0.931 Vali Acc: 0.600 Test Loss: 0.931 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.555877923965454
Epoch: 23, Steps: 20 | Train Loss: 0.464 Vali Loss: 0.873 Vali Acc: 0.580 Test Loss: 0.873 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.5406999588012695
Epoch: 24, Steps: 20 | Train Loss: 0.432 Vali Loss: 0.895 Vali Acc: 0.600 Test Loss: 0.895 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.496252536773682
Epoch: 25, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.909 Vali Acc: 0.620 Test Loss: 0.909 Test Acc: 0.620
Validation loss decreased (-0.609992 --> -0.619991).  Saving model ...
Epoch: 26 cost time: 6.711482763290405
Epoch: 26, Steps: 20 | Train Loss: 0.414 Vali Loss: 0.928 Vali Acc: 0.590 Test Loss: 0.928 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.410656690597534
Epoch: 27, Steps: 20 | Train Loss: 0.429 Vali Loss: 1.057 Vali Acc: 0.550 Test Loss: 1.057 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.377202987670898
Epoch: 28, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.980 Vali Acc: 0.630 Test Loss: 0.980 Test Acc: 0.630
Validation loss decreased (-0.619991 --> -0.629990).  Saving model ...
Epoch: 29 cost time: 6.329532146453857
Epoch: 29, Steps: 20 | Train Loss: 0.400 Vali Loss: 1.060 Vali Acc: 0.570 Test Loss: 1.060 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.307383298873901
Epoch: 30, Steps: 20 | Train Loss: 0.403 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.125107765197754
Epoch: 31, Steps: 20 | Train Loss: 0.342 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.3939902782440186
Epoch: 32, Steps: 20 | Train Loss: 0.333 Vali Loss: 1.030 Vali Acc: 0.620 Test Loss: 1.030 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 7.36160135269165
Epoch: 33, Steps: 20 | Train Loss: 0.289 Vali Loss: 1.113 Vali Acc: 0.600 Test Loss: 1.113 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 6.774491310119629
Epoch: 34, Steps: 20 | Train Loss: 0.320 Vali Loss: 1.232 Vali Acc: 0.570 Test Loss: 1.232 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.411076545715332
Epoch: 35, Steps: 20 | Train Loss: 0.307 Vali Loss: 1.199 Vali Acc: 0.590 Test Loss: 1.199 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.446410179138184
Epoch: 36, Steps: 20 | Train Loss: 0.279 Vali Loss: 1.281 Vali Acc: 0.550 Test Loss: 1.281 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 6.3701491355896
Epoch: 37, Steps: 20 | Train Loss: 0.243 Vali Loss: 1.195 Vali Acc: 0.570 Test Loss: 1.195 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 6.2592997550964355
Epoch: 38, Steps: 20 | Train Loss: 0.246 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.9422338008880615
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.338005542755127
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.361496925354004
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.441707134246826
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 6.453237056732178
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.24319314956665
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.745907783508301
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.4104650020599365
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.185286998748779
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.178543567657471
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.3931849002838135
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.233381748199463
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.324743986129761
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.174226522445679
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 228930
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.920470952987671
Epoch: 1, Steps: 20 | Train Loss: 0.733 Vali Loss: 0.707 Vali Acc: 0.490 Test Loss: 0.707 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.24067497253418
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.715 Vali Acc: 0.550 Test Loss: 0.715 Test Acc: 0.550
Validation loss decreased (-0.489993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 6.402485132217407
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.740 Vali Acc: 0.530 Test Loss: 0.740 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.422293424606323
Epoch: 4, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.752 Vali Acc: 0.510 Test Loss: 0.752 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.694854736328125
Epoch: 5, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.41832971572876
Epoch: 6, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.772 Vali Acc: 0.490 Test Loss: 0.772 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.597721338272095
Epoch: 7, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.354893922805786
Epoch: 8, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.806 Vali Acc: 0.470 Test Loss: 0.806 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.87691068649292
Epoch: 9, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.802 Vali Acc: 0.470 Test Loss: 0.802 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.613046169281006
Epoch: 10, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.828 Vali Acc: 0.470 Test Loss: 0.828 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.8375890254974365
Epoch: 11, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.654609203338623
Epoch: 12, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.827 Vali Acc: 0.450 Test Loss: 0.827 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.375689268112183
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 7.230862617492676
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.720 Vali Acc: 0.530 Test Loss: 0.720 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 6.899475574493408
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.39510440826416
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.747 Vali Acc: 0.520 Test Loss: 0.747 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.112883567810059
Epoch: 5, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.774 Vali Acc: 0.540 Test Loss: 0.774 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 7.689834356307983
Epoch: 6, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.760 Vali Acc: 0.440 Test Loss: 0.760 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.286168575286865
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.772 Vali Acc: 0.520 Test Loss: 0.772 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.01860785484314
Epoch: 8, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.801 Vali Acc: 0.490 Test Loss: 0.801 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.573505401611328
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.797 Vali Acc: 0.460 Test Loss: 0.797 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.61005163192749
Epoch: 10, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.807 Vali Acc: 0.440 Test Loss: 0.807 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.432535886764526
Epoch: 11, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.842 Vali Acc: 0.510 Test Loss: 0.842 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.443106412887573
Epoch: 12, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.812 Vali Acc: 0.470 Test Loss: 0.812 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.535151481628418
Epoch: 13, Steps: 20 | Train Loss: 0.524 Vali Loss: 0.822 Vali Acc: 0.460 Test Loss: 0.822 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.2589521408081055
Epoch: 14, Steps: 20 | Train Loss: 0.542 Vali Loss: 0.810 Vali Acc: 0.490 Test Loss: 0.810 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.434628248214722
Epoch: 15, Steps: 20 | Train Loss: 0.511 Vali Loss: 0.854 Vali Acc: 0.470 Test Loss: 0.854 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.167644500732422
Epoch: 1, Steps: 20 | Train Loss: 0.738 Vali Loss: 0.715 Vali Acc: 0.490 Test Loss: 0.715 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.339215278625488
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 6.863653182983398
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.743 Vali Acc: 0.510 Test Loss: 0.743 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 4 cost time: 6.548453092575073
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 6.444491624832153
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 6 cost time: 6.233757495880127
Epoch: 6, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.29929256439209
Epoch: 7, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.754 Vali Acc: 0.540 Test Loss: 0.754 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 6.235126972198486
Epoch: 8, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.2946460247039795
Epoch: 9, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.480893135070801
Epoch: 10, Steps: 20 | Train Loss: 0.611 Vali Loss: 0.779 Vali Acc: 0.540 Test Loss: 0.779 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.508949041366577
Epoch: 11, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.787 Vali Acc: 0.550 Test Loss: 0.787 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 6.270326614379883
Epoch: 12, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 13 cost time: 6.487340688705444
Epoch: 13, Steps: 20 | Train Loss: 0.533 Vali Loss: 0.775 Vali Acc: 0.550 Test Loss: 0.775 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.780515670776367
Epoch: 14, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.764 Vali Acc: 0.520 Test Loss: 0.764 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.995191335678101
Epoch: 15, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.793 Vali Acc: 0.480 Test Loss: 0.793 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.574559926986694
Epoch: 16, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.747 Vali Acc: 0.570 Test Loss: 0.747 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569993).  Saving model ...
Epoch: 17 cost time: 6.4798805713653564
Epoch: 17, Steps: 20 | Train Loss: 0.480 Vali Loss: 0.729 Vali Acc: 0.580 Test Loss: 0.729 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 18 cost time: 6.776896715164185
Epoch: 18, Steps: 20 | Train Loss: 0.474 Vali Loss: 0.792 Vali Acc: 0.550 Test Loss: 0.792 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.6586549282073975
Epoch: 19, Steps: 20 | Train Loss: 0.457 Vali Loss: 0.750 Vali Acc: 0.600 Test Loss: 0.750 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599992).  Saving model ...
Epoch: 20 cost time: 6.5075883865356445
Epoch: 20, Steps: 20 | Train Loss: 0.435 Vali Loss: 0.780 Vali Acc: 0.580 Test Loss: 0.780 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.158189058303833
Epoch: 21, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.815 Vali Acc: 0.570 Test Loss: 0.815 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.43134617805481
Epoch: 22, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.795 Vali Acc: 0.560 Test Loss: 0.795 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.3481125831604
Epoch: 23, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.824 Vali Acc: 0.580 Test Loss: 0.824 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.588441610336304
Epoch: 24, Steps: 20 | Train Loss: 0.346 Vali Loss: 0.810 Vali Acc: 0.600 Test Loss: 0.810 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.650265693664551
Epoch: 25, Steps: 20 | Train Loss: 0.345 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.511719465255737
Epoch: 26, Steps: 20 | Train Loss: 0.328 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.678331136703491
Epoch: 27, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.860 Vali Acc: 0.570 Test Loss: 0.860 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.46348237991333
Epoch: 28, Steps: 20 | Train Loss: 0.263 Vali Loss: 0.833 Vali Acc: 0.620 Test Loss: 0.833 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619992).  Saving model ...
Epoch: 29 cost time: 6.495722532272339
Epoch: 29, Steps: 20 | Train Loss: 0.278 Vali Loss: 0.893 Vali Acc: 0.640 Test Loss: 0.893 Test Acc: 0.640
Validation loss decreased (-0.619992 --> -0.639991).  Saving model ...
Epoch: 30 cost time: 6.936645030975342
Epoch: 30, Steps: 20 | Train Loss: 0.256 Vali Loss: 0.892 Vali Acc: 0.600 Test Loss: 0.892 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.58674430847168
Epoch: 31, Steps: 20 | Train Loss: 0.222 Vali Loss: 0.934 Vali Acc: 0.500 Test Loss: 0.934 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 7.009001970291138
Epoch: 32, Steps: 20 | Train Loss: 0.198 Vali Loss: 0.895 Vali Acc: 0.550 Test Loss: 0.895 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.989938735961914
Epoch: 33, Steps: 20 | Train Loss: 0.187 Vali Loss: 0.971 Vali Acc: 0.540 Test Loss: 0.971 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.587686777114868
Epoch: 34, Steps: 20 | Train Loss: 0.172 Vali Loss: 0.934 Vali Acc: 0.570 Test Loss: 0.934 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.6820762157440186
Epoch: 35, Steps: 20 | Train Loss: 0.153 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.190230846405029
Epoch: 36, Steps: 20 | Train Loss: 0.137 Vali Loss: 1.054 Vali Acc: 0.550 Test Loss: 1.054 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.295881748199463
Epoch: 37, Steps: 20 | Train Loss: 0.122 Vali Loss: 1.155 Vali Acc: 0.540 Test Loss: 1.155 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.144200801849365
Epoch: 38, Steps: 20 | Train Loss: 0.123 Vali Loss: 1.039 Vali Acc: 0.580 Test Loss: 1.039 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.2771618366241455
Epoch: 39, Steps: 20 | Train Loss: 0.105 Vali Loss: 1.010 Vali Acc: 0.550 Test Loss: 1.010 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.148311853408813
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.708 Vali Acc: 0.530 Test Loss: 0.708 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 6.749857664108276
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.48127818107605
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.8790130615234375
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 6.199519395828247
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.327332019805908
Epoch: 6, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.774 Vali Acc: 0.460 Test Loss: 0.774 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.018895864486694
Epoch: 7, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.211395978927612
Epoch: 8, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.789 Vali Acc: 0.490 Test Loss: 0.789 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.160253047943115
Epoch: 9, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.485495567321777
Epoch: 10, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.840 Vali Acc: 0.580 Test Loss: 0.840 Test Acc: 0.580
Validation loss decreased (-0.539992 --> -0.579992).  Saving model ...
Epoch: 11 cost time: 6.288129568099976
Epoch: 11, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.822 Vali Acc: 0.560 Test Loss: 0.822 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.547033071517944
Epoch: 12, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.767 Vali Acc: 0.510 Test Loss: 0.767 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.644144535064697
Epoch: 13, Steps: 20 | Train Loss: 0.557 Vali Loss: 0.804 Vali Acc: 0.580 Test Loss: 0.804 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579992).  Saving model ...
Epoch: 14 cost time: 6.934149503707886
Epoch: 14, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.427332401275635
Epoch: 15, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.814 Vali Acc: 0.470 Test Loss: 0.814 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.697643041610718
Epoch: 16, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.071448087692261
Epoch: 17, Steps: 20 | Train Loss: 0.505 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.005582571029663
Epoch: 18, Steps: 20 | Train Loss: 0.489 Vali Loss: 0.850 Vali Acc: 0.560 Test Loss: 0.850 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.258234977722168
Epoch: 19, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.801 Vali Acc: 0.580 Test Loss: 0.801 Test Acc: 0.580
Validation loss decreased (-0.579992 --> -0.579992).  Saving model ...
Epoch: 20 cost time: 6.609381198883057
Epoch: 20, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.885 Vali Acc: 0.590 Test Loss: 0.885 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589991).  Saving model ...
Epoch: 21 cost time: 6.292125225067139
Epoch: 21, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.883 Vali Acc: 0.600 Test Loss: 0.883 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599991).  Saving model ...
Epoch: 22 cost time: 6.469321966171265
Epoch: 22, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.847 Vali Acc: 0.580 Test Loss: 0.847 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.536832809448242
Epoch: 23, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.855 Vali Acc: 0.600 Test Loss: 0.855 Test Acc: 0.600
Validation loss decreased (-0.599991 --> -0.599991).  Saving model ...
Epoch: 24 cost time: 6.536304712295532
Epoch: 24, Steps: 20 | Train Loss: 0.369 Vali Loss: 0.908 Vali Acc: 0.600 Test Loss: 0.908 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.241625547409058
Epoch: 25, Steps: 20 | Train Loss: 0.377 Vali Loss: 0.858 Vali Acc: 0.560 Test Loss: 0.858 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.5776526927948
Epoch: 26, Steps: 20 | Train Loss: 0.319 Vali Loss: 0.829 Vali Acc: 0.580 Test Loss: 0.829 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.602978467941284
Epoch: 27, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.829 Vali Acc: 0.570 Test Loss: 0.829 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.08472752571106
Epoch: 28, Steps: 20 | Train Loss: 0.285 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.102340221405029
Epoch: 29, Steps: 20 | Train Loss: 0.272 Vali Loss: 0.956 Vali Acc: 0.610 Test Loss: 0.956 Test Acc: 0.610
Validation loss decreased (-0.599991 --> -0.609990).  Saving model ...
Epoch: 30 cost time: 6.699477672576904
Epoch: 30, Steps: 20 | Train Loss: 0.254 Vali Loss: 0.992 Vali Acc: 0.600 Test Loss: 0.992 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.940200567245483
Epoch: 31, Steps: 20 | Train Loss: 0.241 Vali Loss: 0.966 Vali Acc: 0.530 Test Loss: 0.966 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 7.246344804763794
Epoch: 32, Steps: 20 | Train Loss: 0.224 Vali Loss: 1.033 Vali Acc: 0.550 Test Loss: 1.033 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.780682563781738
Epoch: 33, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.002 Vali Acc: 0.530 Test Loss: 1.002 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 7.034439563751221
Epoch: 34, Steps: 20 | Train Loss: 0.185 Vali Loss: 1.059 Vali Acc: 0.590 Test Loss: 1.059 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.550861597061157
Epoch: 35, Steps: 20 | Train Loss: 0.172 Vali Loss: 1.066 Vali Acc: 0.610 Test Loss: 1.066 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.615515470504761
Epoch: 36, Steps: 20 | Train Loss: 0.140 Vali Loss: 1.143 Vali Acc: 0.540 Test Loss: 1.143 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.530190467834473
Epoch: 37, Steps: 20 | Train Loss: 0.151 Vali Loss: 1.191 Vali Acc: 0.550 Test Loss: 1.191 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.330673933029175
Epoch: 38, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.171 Vali Acc: 0.580 Test Loss: 1.171 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.556028604507446
Epoch: 39, Steps: 20 | Train Loss: 0.128 Vali Loss: 1.151 Vali Acc: 0.620 Test Loss: 1.151 Test Acc: 0.620
Validation loss decreased (-0.609990 --> -0.619988).  Saving model ...
Epoch: 40 cost time: 7.102809429168701
Epoch: 40, Steps: 20 | Train Loss: 0.104 Vali Loss: 1.254 Vali Acc: 0.580 Test Loss: 1.254 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.89685845375061
Epoch: 41, Steps: 20 | Train Loss: 0.094 Vali Loss: 1.290 Vali Acc: 0.550 Test Loss: 1.290 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.839143991470337
Epoch: 42, Steps: 20 | Train Loss: 0.098 Vali Loss: 1.284 Vali Acc: 0.560 Test Loss: 1.284 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.59533429145813
Epoch: 43, Steps: 20 | Train Loss: 0.080 Vali Loss: 1.384 Vali Acc: 0.560 Test Loss: 1.384 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.8959455490112305
Epoch: 44, Steps: 20 | Train Loss: 0.066 Vali Loss: 1.516 Vali Acc: 0.550 Test Loss: 1.516 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 6.649933338165283
Epoch: 45, Steps: 20 | Train Loss: 0.061 Vali Loss: 1.386 Vali Acc: 0.560 Test Loss: 1.386 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 6.870332717895508
Epoch: 46, Steps: 20 | Train Loss: 0.089 Vali Loss: 1.304 Vali Acc: 0.570 Test Loss: 1.304 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 6.681864500045776
Epoch: 47, Steps: 20 | Train Loss: 0.056 Vali Loss: 1.346 Vali Acc: 0.560 Test Loss: 1.346 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 6.733248949050903
Epoch: 48, Steps: 20 | Train Loss: 0.056 Vali Loss: 1.427 Vali Acc: 0.550 Test Loss: 1.427 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 6.4709649085998535
Epoch: 49, Steps: 20 | Train Loss: 0.052 Vali Loss: 1.494 Vali Acc: 0.580 Test Loss: 1.494 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.301114559173584
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.236581087112427
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.769 Vali Acc: 0.540 Test Loss: 0.769 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 6.475242853164673
Epoch: 3, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.699756860733032
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.833 Vali Acc: 0.530 Test Loss: 0.833 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.955769062042236
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.896 Vali Acc: 0.470 Test Loss: 0.896 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.505853891372681
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.892 Vali Acc: 0.470 Test Loss: 0.892 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.996119499206543
Epoch: 7, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.916 Vali Acc: 0.480 Test Loss: 0.916 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.314526081085205
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.925 Vali Acc: 0.450 Test Loss: 0.925 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.80327296257019
Epoch: 9, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.936 Vali Acc: 0.460 Test Loss: 0.936 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.824472665786743
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.988 Vali Acc: 0.470 Test Loss: 0.988 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.468045711517334
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.933 Vali Acc: 0.510 Test Loss: 0.933 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.753403902053833
Epoch: 12, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.900 Vali Acc: 0.440 Test Loss: 0.900 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.544692039489746
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 6.80214524269104
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 6.588608503341675
Epoch: 3, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 7.217177629470825
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.733 Vali Acc: 0.520 Test Loss: 0.733 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.1742753982543945
Epoch: 5, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 6.5654613971710205
Epoch: 6, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 7 cost time: 6.9402570724487305
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.152726411819458
Epoch: 8, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.757 Vali Acc: 0.580 Test Loss: 0.757 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 9 cost time: 6.73872447013855
Epoch: 9, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.757 Vali Acc: 0.550 Test Loss: 0.757 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.36233925819397
Epoch: 10, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.042004108428955
Epoch: 11, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.3393166065216064
Epoch: 12, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.777 Vali Acc: 0.570 Test Loss: 0.777 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.533480882644653
Epoch: 13, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.583633184432983
Epoch: 14, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.912 Vali Acc: 0.510 Test Loss: 0.912 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.29148006439209
Epoch: 15, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.833 Vali Acc: 0.560 Test Loss: 0.833 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.191264390945435
Epoch: 16, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.823 Vali Acc: 0.570 Test Loss: 0.823 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.221495628356934
Epoch: 17, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.793 Vali Acc: 0.610 Test Loss: 0.793 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609992).  Saving model ...
Epoch: 18 cost time: 6.657028436660767
Epoch: 18, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.856 Vali Acc: 0.550 Test Loss: 0.856 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.2829694747924805
Epoch: 19, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.853 Vali Acc: 0.540 Test Loss: 0.853 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.556116342544556
Epoch: 20, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.923 Vali Acc: 0.570 Test Loss: 0.923 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.986695289611816
Epoch: 21, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.918 Vali Acc: 0.590 Test Loss: 0.918 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.824660301208496
Epoch: 22, Steps: 20 | Train Loss: 0.544 Vali Loss: 0.906 Vali Acc: 0.570 Test Loss: 0.906 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.789992332458496
Epoch: 23, Steps: 20 | Train Loss: 0.530 Vali Loss: 1.012 Vali Acc: 0.580 Test Loss: 1.012 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.5041117668151855
Epoch: 24, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.902 Vali Acc: 0.610 Test Loss: 0.902 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.202397108078003
Epoch: 25, Steps: 20 | Train Loss: 0.492 Vali Loss: 0.852 Vali Acc: 0.590 Test Loss: 0.852 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.087848424911499
Epoch: 26, Steps: 20 | Train Loss: 0.469 Vali Loss: 0.805 Vali Acc: 0.560 Test Loss: 0.805 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.377806901931763
Epoch: 27, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.950 Vali Acc: 0.580 Test Loss: 0.950 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.273748397827148
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.688 Vali Acc: 0.510 Test Loss: 0.688 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.317980051040649
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (-0.509993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 6.335214853286743
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.701 Vali Acc: 0.510 Test Loss: 0.701 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.7477757930755615
Epoch: 4, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.501066207885742
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.716 Vali Acc: 0.490 Test Loss: 0.716 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.182351350784302
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.727 Vali Acc: 0.490 Test Loss: 0.727 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.178585529327393
Epoch: 7, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.750 Vali Acc: 0.490 Test Loss: 0.750 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.542689085006714
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.041435956954956
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.753 Vali Acc: 0.540 Test Loss: 0.753 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.268709421157837
Epoch: 10, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.804 Vali Acc: 0.570 Test Loss: 0.804 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.823955535888672
Epoch: 11, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.784 Vali Acc: 0.570 Test Loss: 0.784 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.02233099937439
Epoch: 12, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.544234991073608
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.89771580696106
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.686971187591553
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.8533477783203125
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.721731424331665
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.915787696838379
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.522523403167725
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.360344886779785
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.402720212936401
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.452417612075806
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.399557590484619
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 179778
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.4681978225708
Epoch: 1, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.738 Vali Acc: 0.450 Test Loss: 0.738 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 7.057030200958252
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.760 Vali Acc: 0.450 Test Loss: 0.760 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.718393325805664
Epoch: 3, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.764 Vali Acc: 0.480 Test Loss: 0.764 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479992).  Saving model ...
Epoch: 4 cost time: 6.753728866577148
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 7.6160900592803955
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.767 Vali Acc: 0.490 Test Loss: 0.767 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.491952657699585
Epoch: 6, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.803 Vali Acc: 0.450 Test Loss: 0.803 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.812990427017212
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.769 Vali Acc: 0.460 Test Loss: 0.769 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.546577215194702
Epoch: 8, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.758 Vali Acc: 0.480 Test Loss: 0.758 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.463567018508911
Epoch: 9, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.828 Vali Acc: 0.490 Test Loss: 0.828 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.508948087692261
Epoch: 10, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.812 Vali Acc: 0.440 Test Loss: 0.812 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.429612636566162
Epoch: 11, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499992).  Saving model ...
Epoch: 12 cost time: 6.432511806488037
Epoch: 12, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.805 Vali Acc: 0.480 Test Loss: 0.805 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.638781309127808
Epoch: 13, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 14 cost time: 6.627568960189819
Epoch: 14, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.827 Vali Acc: 0.460 Test Loss: 0.827 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.6973865032196045
Epoch: 15, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.830 Vali Acc: 0.470 Test Loss: 0.830 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.177662134170532
Epoch: 16, Steps: 20 | Train Loss: 0.540 Vali Loss: 0.792 Vali Acc: 0.450 Test Loss: 0.792 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.693655729293823
Epoch: 17, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.811 Vali Acc: 0.560 Test Loss: 0.811 Test Acc: 0.560
Validation loss decreased (-0.509992 --> -0.559992).  Saving model ...
Epoch: 18 cost time: 6.855846405029297
Epoch: 18, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.7476606369018555
Epoch: 19, Steps: 20 | Train Loss: 0.486 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.811182260513306
Epoch: 20, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.790 Vali Acc: 0.510 Test Loss: 0.790 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.385934114456177
Epoch: 21, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.871 Vali Acc: 0.560 Test Loss: 0.871 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.519060373306274
Epoch: 22, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.850 Vali Acc: 0.550 Test Loss: 0.850 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.337200880050659
Epoch: 23, Steps: 20 | Train Loss: 0.426 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.441800832748413
Epoch: 24, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.329012870788574
Epoch: 25, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.830 Vali Acc: 0.550 Test Loss: 0.830 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.146599531173706
Epoch: 26, Steps: 20 | Train Loss: 0.408 Vali Loss: 0.779 Vali Acc: 0.560 Test Loss: 0.779 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 27 cost time: 6.080292701721191
Epoch: 27, Steps: 20 | Train Loss: 0.372 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.440407037734985
Epoch: 28, Steps: 20 | Train Loss: 0.382 Vali Loss: 0.814 Vali Acc: 0.480 Test Loss: 0.814 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.6806604862213135
Epoch: 29, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.810 Vali Acc: 0.590 Test Loss: 0.810 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 30 cost time: 6.668237209320068
Epoch: 30, Steps: 20 | Train Loss: 0.315 Vali Loss: 0.877 Vali Acc: 0.530 Test Loss: 0.877 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.264049053192139
Epoch: 31, Steps: 20 | Train Loss: 0.322 Vali Loss: 0.881 Vali Acc: 0.530 Test Loss: 0.881 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.49314022064209
Epoch: 32, Steps: 20 | Train Loss: 0.293 Vali Loss: 0.832 Vali Acc: 0.610 Test Loss: 0.832 Test Acc: 0.610
Validation loss decreased (-0.589992 --> -0.609992).  Saving model ...
Epoch: 33 cost time: 6.431272983551025
Epoch: 33, Steps: 20 | Train Loss: 0.332 Vali Loss: 0.989 Vali Acc: 0.560 Test Loss: 0.989 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.432628631591797
Epoch: 34, Steps: 20 | Train Loss: 0.288 Vali Loss: 0.811 Vali Acc: 0.540 Test Loss: 0.811 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.223247051239014
Epoch: 35, Steps: 20 | Train Loss: 0.237 Vali Loss: 0.914 Vali Acc: 0.580 Test Loss: 0.914 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.381617307662964
Epoch: 36, Steps: 20 | Train Loss: 0.260 Vali Loss: 0.870 Vali Acc: 0.550 Test Loss: 0.870 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.50588846206665
Epoch: 37, Steps: 20 | Train Loss: 0.189 Vali Loss: 0.933 Vali Acc: 0.530 Test Loss: 0.933 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.543761253356934
Epoch: 38, Steps: 20 | Train Loss: 0.198 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.293596982955933
Epoch: 39, Steps: 20 | Train Loss: 0.262 Vali Loss: 1.056 Vali Acc: 0.520 Test Loss: 1.056 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.340481281280518
Epoch: 40, Steps: 20 | Train Loss: 0.185 Vali Loss: 0.996 Vali Acc: 0.590 Test Loss: 0.996 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 6.580658435821533
Epoch: 41, Steps: 20 | Train Loss: 0.216 Vali Loss: 1.056 Vali Acc: 0.550 Test Loss: 1.056 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 6.474655389785767
Epoch: 42, Steps: 20 | Train Loss: 0.155 Vali Loss: 0.907 Vali Acc: 0.590 Test Loss: 0.907 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.618377447128296
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.745 Vali Acc: 0.430 Test Loss: 0.745 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 6.835796356201172
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.762 Vali Acc: 0.440 Test Loss: 0.762 Test Acc: 0.440
Validation loss decreased (-0.429993 --> -0.439992).  Saving model ...
Epoch: 3 cost time: 7.414985656738281
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.773 Vali Acc: 0.460 Test Loss: 0.773 Test Acc: 0.460
Validation loss decreased (-0.439992 --> -0.459992).  Saving model ...
Epoch: 4 cost time: 6.680368185043335
Epoch: 4, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.798 Vali Acc: 0.470 Test Loss: 0.798 Test Acc: 0.470
Validation loss decreased (-0.459992 --> -0.469992).  Saving model ...
Epoch: 5 cost time: 6.583644866943359
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.779 Vali Acc: 0.480 Test Loss: 0.779 Test Acc: 0.480
Validation loss decreased (-0.469992 --> -0.479992).  Saving model ...
Epoch: 6 cost time: 7.466581583023071
Epoch: 6, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.800 Vali Acc: 0.430 Test Loss: 0.800 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.572242975234985
Epoch: 7, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.768 Vali Acc: 0.490 Test Loss: 0.768 Test Acc: 0.490
Validation loss decreased (-0.479992 --> -0.489992).  Saving model ...
Epoch: 8 cost time: 6.333728075027466
Epoch: 8, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.779 Vali Acc: 0.470 Test Loss: 0.779 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.715569019317627
Epoch: 9, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.803 Vali Acc: 0.450 Test Loss: 0.803 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.504271030426025
Epoch: 10, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
Validation loss decreased (-0.489992 --> -0.499992).  Saving model ...
Epoch: 11 cost time: 7.243713617324829
Epoch: 11, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.799 Vali Acc: 0.430 Test Loss: 0.799 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.03557562828064
Epoch: 12, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.800 Vali Acc: 0.470 Test Loss: 0.800 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.131843328475952
Epoch: 13, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.826 Vali Acc: 0.540 Test Loss: 0.826 Test Acc: 0.540
Validation loss decreased (-0.499992 --> -0.539992).  Saving model ...
Epoch: 14 cost time: 6.611083507537842
Epoch: 14, Steps: 20 | Train Loss: 0.556 Vali Loss: 0.828 Vali Acc: 0.470 Test Loss: 0.828 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.289485692977905
Epoch: 15, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.005683422088623
Epoch: 16, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.007763624191284
Epoch: 17, Steps: 20 | Train Loss: 0.517 Vali Loss: 0.837 Vali Acc: 0.510 Test Loss: 0.837 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.812582731246948
Epoch: 18, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.896 Vali Acc: 0.510 Test Loss: 0.896 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.702883005142212
Epoch: 19, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.852 Vali Acc: 0.480 Test Loss: 0.852 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.601458311080933
Epoch: 20, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.845 Vali Acc: 0.490 Test Loss: 0.845 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.867250680923462
Epoch: 21, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.900 Vali Acc: 0.490 Test Loss: 0.900 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.330873489379883
Epoch: 22, Steps: 20 | Train Loss: 0.478 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.4537811279296875
Epoch: 23, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.852 Vali Acc: 0.450 Test Loss: 0.852 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.10674238204956
Epoch: 1, Steps: 20 | Train Loss: 0.747 Vali Loss: 0.741 Vali Acc: 0.460 Test Loss: 0.741 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 6.504688262939453
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.753 Vali Acc: 0.420 Test Loss: 0.753 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2005767822265625
Epoch: 3, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.772 Vali Acc: 0.430 Test Loss: 0.772 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.485700607299805
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.801 Vali Acc: 0.470 Test Loss: 0.801 Test Acc: 0.470
Validation loss decreased (-0.459993 --> -0.469992).  Saving model ...
Epoch: 5 cost time: 6.461546182632446
Epoch: 5, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.791 Vali Acc: 0.440 Test Loss: 0.791 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.537169933319092
Epoch: 6, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.805 Vali Acc: 0.490 Test Loss: 0.805 Test Acc: 0.490
Validation loss decreased (-0.469992 --> -0.489992).  Saving model ...
Epoch: 7 cost time: 6.136713743209839
Epoch: 7, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.775 Vali Acc: 0.520 Test Loss: 0.775 Test Acc: 0.520
Validation loss decreased (-0.489992 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 6.489666700363159
Epoch: 8, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.589294672012329
Epoch: 9, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.800 Vali Acc: 0.500 Test Loss: 0.800 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.964816331863403
Epoch: 10, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.788 Vali Acc: 0.540 Test Loss: 0.788 Test Acc: 0.540
Validation loss decreased (-0.519992 --> -0.539992).  Saving model ...
Epoch: 11 cost time: 6.796323537826538
Epoch: 11, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.737457513809204
Epoch: 12, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.816 Vali Acc: 0.520 Test Loss: 0.816 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.890043258666992
Epoch: 13, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.834 Vali Acc: 0.560 Test Loss: 0.834 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 14 cost time: 7.072241306304932
Epoch: 14, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.838 Vali Acc: 0.530 Test Loss: 0.838 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.9157938957214355
Epoch: 15, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.823 Vali Acc: 0.470 Test Loss: 0.823 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.7513697147369385
Epoch: 16, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.691390037536621
Epoch: 17, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.882 Vali Acc: 0.510 Test Loss: 0.882 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.6857709884643555
Epoch: 18, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.939 Vali Acc: 0.500 Test Loss: 0.939 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.61028790473938
Epoch: 19, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.877 Vali Acc: 0.520 Test Loss: 0.877 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.375308275222778
Epoch: 20, Steps: 20 | Train Loss: 0.490 Vali Loss: 0.821 Vali Acc: 0.590 Test Loss: 0.821 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 21 cost time: 6.598606586456299
Epoch: 21, Steps: 20 | Train Loss: 0.491 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.7359373569488525
Epoch: 22, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.848 Vali Acc: 0.560 Test Loss: 0.848 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.581232309341431
Epoch: 23, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.885 Vali Acc: 0.510 Test Loss: 0.885 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.87835693359375
Epoch: 24, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.942 Vali Acc: 0.510 Test Loss: 0.942 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.872087717056274
Epoch: 25, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.872 Vali Acc: 0.550 Test Loss: 0.872 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.97382116317749
Epoch: 26, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.888 Vali Acc: 0.520 Test Loss: 0.888 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.990357875823975
Epoch: 27, Steps: 20 | Train Loss: 0.390 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.164571523666382
Epoch: 28, Steps: 20 | Train Loss: 0.363 Vali Loss: 0.849 Vali Acc: 0.500 Test Loss: 0.849 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.887383460998535
Epoch: 29, Steps: 20 | Train Loss: 0.354 Vali Loss: 0.906 Vali Acc: 0.550 Test Loss: 0.906 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.736964225769043
Epoch: 30, Steps: 20 | Train Loss: 0.321 Vali Loss: 0.927 Vali Acc: 0.520 Test Loss: 0.927 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.761693716049194
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.733 Vali Acc: 0.430 Test Loss: 0.733 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 6.299787282943726
Epoch: 2, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.757 Vali Acc: 0.440 Test Loss: 0.757 Test Acc: 0.440
Validation loss decreased (-0.429993 --> -0.439992).  Saving model ...
Epoch: 3 cost time: 6.392697095870972
Epoch: 3, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.773 Vali Acc: 0.540 Test Loss: 0.773 Test Acc: 0.540
Validation loss decreased (-0.439992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 6.301859378814697
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.815 Vali Acc: 0.440 Test Loss: 0.815 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.566695928573608
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.774 Vali Acc: 0.490 Test Loss: 0.774 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.474074602127075
Epoch: 6, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.827 Vali Acc: 0.420 Test Loss: 0.827 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.564490079879761
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.769 Vali Acc: 0.560 Test Loss: 0.769 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 8 cost time: 6.78705906867981
Epoch: 8, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.780 Vali Acc: 0.480 Test Loss: 0.780 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.607855796813965
Epoch: 9, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.827 Vali Acc: 0.470 Test Loss: 0.827 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.5206592082977295
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.304120779037476
Epoch: 11, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.794 Vali Acc: 0.510 Test Loss: 0.794 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.069173097610474
Epoch: 12, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.842 Vali Acc: 0.490 Test Loss: 0.842 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.067305564880371
Epoch: 13, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.479436159133911
Epoch: 14, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.3868303298950195
Epoch: 15, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.718902587890625
Epoch: 16, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.036355495452881
Epoch: 17, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.835 Vali Acc: 0.490 Test Loss: 0.835 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.271228313446045
Epoch: 1, Steps: 20 | Train Loss: 0.732 Vali Loss: 0.751 Vali Acc: 0.490 Test Loss: 0.751 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 6.648868083953857
Epoch: 2, Steps: 20 | Train Loss: 0.718 Vali Loss: 0.770 Vali Acc: 0.420 Test Loss: 0.770 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.893107652664185
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.801 Vali Acc: 0.430 Test Loss: 0.801 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.588347434997559
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.828 Vali Acc: 0.450 Test Loss: 0.828 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.125478506088257
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.824 Vali Acc: 0.490 Test Loss: 0.824 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.193050384521484
Epoch: 6, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.842 Vali Acc: 0.440 Test Loss: 0.842 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.5255351066589355
Epoch: 7, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.830 Vali Acc: 0.430 Test Loss: 0.830 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.416369676589966
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.846 Vali Acc: 0.430 Test Loss: 0.846 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.249276638031006
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.865 Vali Acc: 0.470 Test Loss: 0.865 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.445950508117676
Epoch: 10, Steps: 20 | Train Loss: 0.637 Vali Loss: 0.853 Vali Acc: 0.440 Test Loss: 0.853 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.629835605621338
Epoch: 11, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.848 Vali Acc: 0.440 Test Loss: 0.848 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.098533868789673
Epoch: 1, Steps: 20 | Train Loss: 0.729 Vali Loss: 0.718 Vali Acc: 0.490 Test Loss: 0.718 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.634652137756348
Epoch: 2, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.727 Vali Acc: 0.530 Test Loss: 0.727 Test Acc: 0.530
Validation loss decreased (-0.489993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 6.7312171459198
Epoch: 3, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.722 Vali Acc: 0.530 Test Loss: 0.722 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 6.566392660140991
Epoch: 4, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.594408750534058
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.052407503128052
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.735 Vali Acc: 0.530 Test Loss: 0.735 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.470106840133667
Epoch: 7, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.55728554725647
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.738 Vali Acc: 0.500 Test Loss: 0.738 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.566084384918213
Epoch: 9, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.422351837158203
Epoch: 10, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.759 Vali Acc: 0.550 Test Loss: 0.759 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 6.398193359375
Epoch: 11, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.753 Vali Acc: 0.570 Test Loss: 0.753 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 12 cost time: 6.533902406692505
Epoch: 12, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.701161623001099
Epoch: 13, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.062279462814331
Epoch: 14, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.961306571960449
Epoch: 15, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.741 Vali Acc: 0.580 Test Loss: 0.741 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579993).  Saving model ...
Epoch: 16 cost time: 7.087049245834351
Epoch: 16, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.744 Vali Acc: 0.560 Test Loss: 0.744 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.052029371261597
Epoch: 17, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.548906087875366
Epoch: 18, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.431753635406494
Epoch: 19, Steps: 20 | Train Loss: 0.608 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.720801115036011
Epoch: 20, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.722 Vali Acc: 0.590 Test Loss: 0.722 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 21 cost time: 7.022734880447388
Epoch: 21, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.769 Vali Acc: 0.570 Test Loss: 0.769 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.306073188781738
Epoch: 22, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.775 Vali Acc: 0.560 Test Loss: 0.775 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.871110677719116
Epoch: 23, Steps: 20 | Train Loss: 0.564 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.062211275100708
Epoch: 24, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.770 Vali Acc: 0.580 Test Loss: 0.770 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.948380470275879
Epoch: 25, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.782 Vali Acc: 0.540 Test Loss: 0.782 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.725732088088989
Epoch: 26, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.585479021072388
Epoch: 27, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.798 Vali Acc: 0.480 Test Loss: 0.798 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.7695982456207275
Epoch: 28, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.412468910217285
Epoch: 29, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.807 Vali Acc: 0.590 Test Loss: 0.807 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 7.540759801864624
Epoch: 30, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.806 Vali Acc: 0.500 Test Loss: 0.806 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.368309259414673
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 6.249210834503174
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 6.513613224029541
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 6.230770826339722
Epoch: 4, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.30687403678894
Epoch: 5, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.71228814125061
Epoch: 6, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.3028740882873535
Epoch: 7, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.463319778442383
Epoch: 8, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.756 Vali Acc: 0.550 Test Loss: 0.756 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 6.7219078540802
Epoch: 9, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.789 Vali Acc: 0.530 Test Loss: 0.789 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.320901155471802
Epoch: 10, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.883280277252197
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.981483221054077
Epoch: 12, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.783 Vali Acc: 0.550 Test Loss: 0.783 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.992953300476074
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.808 Vali Acc: 0.570 Test Loss: 0.808 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569992).  Saving model ...
Epoch: 14 cost time: 5.957984924316406
Epoch: 14, Steps: 20 | Train Loss: 0.595 Vali Loss: 0.819 Vali Acc: 0.540 Test Loss: 0.819 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.252408504486084
Epoch: 15, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.903483629226685
Epoch: 16, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.968087434768677
Epoch: 17, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.886468172073364
Epoch: 18, Steps: 20 | Train Loss: 0.604 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.5305845737457275
Epoch: 19, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.793 Vali Acc: 0.580 Test Loss: 0.793 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 20 cost time: 6.577921390533447
Epoch: 20, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.789 Vali Acc: 0.570 Test Loss: 0.789 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.5605080127716064
Epoch: 21, Steps: 20 | Train Loss: 0.579 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.484479904174805
Epoch: 22, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.812 Vali Acc: 0.580 Test Loss: 0.812 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.582240581512451
Epoch: 23, Steps: 20 | Train Loss: 0.550 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.115355730056763
Epoch: 24, Steps: 20 | Train Loss: 0.534 Vali Loss: 0.841 Vali Acc: 0.530 Test Loss: 0.841 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.425601005554199
Epoch: 25, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.836 Vali Acc: 0.570 Test Loss: 0.836 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.10882043838501
Epoch: 26, Steps: 20 | Train Loss: 0.539 Vali Loss: 0.933 Vali Acc: 0.520 Test Loss: 0.933 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.34210205078125
Epoch: 27, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.836 Vali Acc: 0.590 Test Loss: 0.836 Test Acc: 0.590
Validation loss decreased (-0.579992 --> -0.589992).  Saving model ...
Epoch: 28 cost time: 6.25529146194458
Epoch: 28, Steps: 20 | Train Loss: 0.543 Vali Loss: 0.796 Vali Acc: 0.570 Test Loss: 0.796 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.267072677612305
Epoch: 29, Steps: 20 | Train Loss: 0.496 Vali Loss: 0.796 Vali Acc: 0.560 Test Loss: 0.796 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.608850955963135
Epoch: 30, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.667912244796753
Epoch: 31, Steps: 20 | Train Loss: 0.485 Vali Loss: 0.851 Vali Acc: 0.550 Test Loss: 0.851 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.792999505996704
Epoch: 32, Steps: 20 | Train Loss: 0.502 Vali Loss: 0.827 Vali Acc: 0.540 Test Loss: 0.827 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.583923101425171
Epoch: 33, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.840 Vali Acc: 0.560 Test Loss: 0.840 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.581813812255859
Epoch: 34, Steps: 20 | Train Loss: 0.410 Vali Loss: 0.842 Vali Acc: 0.560 Test Loss: 0.842 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.11709189414978
Epoch: 35, Steps: 20 | Train Loss: 0.423 Vali Loss: 0.858 Vali Acc: 0.590 Test Loss: 0.858 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.7853171825408936
Epoch: 36, Steps: 20 | Train Loss: 0.441 Vali Loss: 0.855 Vali Acc: 0.570 Test Loss: 0.855 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.198256492614746
Epoch: 37, Steps: 20 | Train Loss: 0.389 Vali Loss: 0.838 Vali Acc: 0.580 Test Loss: 0.838 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.946882963180542
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.11618971824646
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.926306962966919
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.546692848205566
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 6.396547079086304
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.31514310836792
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 7 cost time: 6.152411937713623
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 8 cost time: 6.645474910736084
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.481871604919434
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 10 cost time: 6.123921155929565
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.089318752288818
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 12 cost time: 5.592769622802734
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.843313455581665
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.052525520324707
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 15 cost time: 6.060879468917847
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.368624687194824
Epoch: 16, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.8180177211761475
Epoch: 17, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.537378549575806
Epoch: 18, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.756350517272949
Epoch: 19, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 20 cost time: 6.088267803192139
Epoch: 20, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 21 cost time: 6.430048227310181
Epoch: 21, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 22 cost time: 6.623852968215942
Epoch: 22, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.414353847503662
Epoch: 23, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.4106035232543945
Epoch: 24, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.4569315910339355
Epoch: 25, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 26 cost time: 5.890425443649292
Epoch: 26, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 27 cost time: 6.271701812744141
Epoch: 27, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 28 cost time: 6.126183032989502
Epoch: 28, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.919335126876831
Epoch: 29, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.817661285400391
Epoch: 30, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 31 cost time: 6.634931325912476
Epoch: 31, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.903943777084351
Epoch: 32, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 33 cost time: 6.948796272277832
Epoch: 33, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.346081495285034
Epoch: 34, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 7.2972822189331055
Epoch: 35, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 7.248054504394531
Epoch: 36, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 7.206518173217773
Epoch: 37, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 7.966031312942505
Epoch: 38, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 7.092888832092285
Epoch: 39, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.530826807022095
Epoch: 40, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 41 cost time: 6.231590032577515
Epoch: 41, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.684192895889282
Epoch: 42, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 43 cost time: 6.832905292510986
Epoch: 43, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 44 cost time: 6.57710599899292
Epoch: 44, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 45 cost time: 7.00335955619812
Epoch: 45, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 7.576760292053223
Epoch: 46, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 47 cost time: 6.930878162384033
Epoch: 47, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 7.045893907546997
Epoch: 48, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 7.189166784286499
Epoch: 49, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 7.005588054656982
Epoch: 50, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 7.0187036991119385
Epoch: 51, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 6.874629497528076
Epoch: 52, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 6.3346107006073
Epoch: 53, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 6.587860345840454
Epoch: 54, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 6.583213567733765
Epoch: 55, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 6.619131326675415
Epoch: 56, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 429602
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.974077939987183
Epoch: 1, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.725 Vali Acc: 0.510 Test Loss: 0.725 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.741445064544678
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.742 Vali Acc: 0.480 Test Loss: 0.742 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.880468845367432
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.766 Vali Acc: 0.510 Test Loss: 0.766 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.169392108917236
Epoch: 4, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.769 Vali Acc: 0.530 Test Loss: 0.769 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 6.491019010543823
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.294940948486328
Epoch: 6, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.250243425369263
Epoch: 7, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.768 Vali Acc: 0.540 Test Loss: 0.768 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 8 cost time: 6.794073820114136
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.013060569763184
Epoch: 9, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.794 Vali Acc: 0.550 Test Loss: 0.794 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 6.1802263259887695
Epoch: 10, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.780 Vali Acc: 0.470 Test Loss: 0.780 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.544360876083374
Epoch: 11, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.802 Vali Acc: 0.530 Test Loss: 0.802 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.698358535766602
Epoch: 12, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.875131607055664
Epoch: 13, Steps: 20 | Train Loss: 0.571 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.165087938308716
Epoch: 14, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.843 Vali Acc: 0.510 Test Loss: 0.843 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.920619249343872
Epoch: 15, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.641819953918457
Epoch: 16, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.811 Vali Acc: 0.490 Test Loss: 0.811 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.119218826293945
Epoch: 17, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.834 Vali Acc: 0.530 Test Loss: 0.834 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.45386528968811
Epoch: 18, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.825 Vali Acc: 0.490 Test Loss: 0.825 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.542261600494385
Epoch: 19, Steps: 20 | Train Loss: 0.504 Vali Loss: 0.814 Vali Acc: 0.520 Test Loss: 0.814 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.959269046783447
Epoch: 1, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.741 Vali Acc: 0.490 Test Loss: 0.741 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.155704021453857
Epoch: 2, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.762 Vali Acc: 0.450 Test Loss: 0.762 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.260046482086182
Epoch: 3, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.4816038608551025
Epoch: 4, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.787 Vali Acc: 0.470 Test Loss: 0.787 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.012546062469482
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.784 Vali Acc: 0.460 Test Loss: 0.784 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.390656232833862
Epoch: 6, Steps: 20 | Train Loss: 0.663 Vali Loss: 0.784 Vali Acc: 0.470 Test Loss: 0.784 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.531035661697388
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.782 Vali Acc: 0.510 Test Loss: 0.782 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509992).  Saving model ...
Epoch: 8 cost time: 6.38344669342041
Epoch: 8, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.8745505809783936
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.809 Vali Acc: 0.490 Test Loss: 0.809 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.702256679534912
Epoch: 10, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.511319875717163
Epoch: 11, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.792 Vali Acc: 0.480 Test Loss: 0.792 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.5063323974609375
Epoch: 12, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.807 Vali Acc: 0.470 Test Loss: 0.807 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.368344068527222
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.804 Vali Acc: 0.470 Test Loss: 0.804 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.51113486289978
Epoch: 14, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.665346145629883
Epoch: 15, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.780 Vali Acc: 0.490 Test Loss: 0.780 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.454058408737183
Epoch: 16, Steps: 20 | Train Loss: 0.554 Vali Loss: 0.800 Vali Acc: 0.460 Test Loss: 0.800 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.6058855056762695
Epoch: 17, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.812 Vali Acc: 0.480 Test Loss: 0.812 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.005207300186157
Epoch: 1, Steps: 20 | Train Loss: 0.721 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 6.33859658241272
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.256751775741577
Epoch: 3, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.864957809448242
Epoch: 4, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.779 Vali Acc: 0.490 Test Loss: 0.779 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.276671886444092
Epoch: 5, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.792 Vali Acc: 0.470 Test Loss: 0.792 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.138807535171509
Epoch: 6, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.788 Vali Acc: 0.480 Test Loss: 0.788 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.5251100063323975
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.58854603767395
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.685308456420898
Epoch: 9, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.802 Vali Acc: 0.500 Test Loss: 0.802 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.5564234256744385
Epoch: 10, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.764 Vali Acc: 0.510 Test Loss: 0.764 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509992).  Saving model ...
Epoch: 11 cost time: 6.361821174621582
Epoch: 11, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.793334722518921
Epoch: 12, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.791 Vali Acc: 0.470 Test Loss: 0.791 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.1625378131866455
Epoch: 13, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.704407691955566
Epoch: 14, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.796 Vali Acc: 0.500 Test Loss: 0.796 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.4547929763793945
Epoch: 15, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.777 Vali Acc: 0.530 Test Loss: 0.777 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 16 cost time: 6.643201112747192
Epoch: 16, Steps: 20 | Train Loss: 0.537 Vali Loss: 0.810 Vali Acc: 0.510 Test Loss: 0.810 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.6477437019348145
Epoch: 17, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.790 Vali Acc: 0.490 Test Loss: 0.790 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.269173622131348
Epoch: 18, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.815 Vali Acc: 0.510 Test Loss: 0.815 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.610440969467163
Epoch: 19, Steps: 20 | Train Loss: 0.507 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.806594610214233
Epoch: 20, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 21 cost time: 6.60065770149231
Epoch: 21, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.870061159133911
Epoch: 22, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.538378000259399
Epoch: 23, Steps: 20 | Train Loss: 0.425 Vali Loss: 0.817 Vali Acc: 0.520 Test Loss: 0.817 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.784963369369507
Epoch: 24, Steps: 20 | Train Loss: 0.448 Vali Loss: 0.854 Vali Acc: 0.520 Test Loss: 0.854 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.648344039916992
Epoch: 25, Steps: 20 | Train Loss: 0.419 Vali Loss: 0.787 Vali Acc: 0.560 Test Loss: 0.787 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 26 cost time: 6.777570486068726
Epoch: 26, Steps: 20 | Train Loss: 0.428 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.695793151855469
Epoch: 27, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.096437692642212
Epoch: 28, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.805 Vali Acc: 0.560 Test Loss: 0.805 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.680219411849976
Epoch: 29, Steps: 20 | Train Loss: 0.380 Vali Loss: 0.828 Vali Acc: 0.570 Test Loss: 0.828 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 30 cost time: 6.350050687789917
Epoch: 30, Steps: 20 | Train Loss: 0.355 Vali Loss: 0.846 Vali Acc: 0.560 Test Loss: 0.846 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.160620927810669
Epoch: 31, Steps: 20 | Train Loss: 0.365 Vali Loss: 0.960 Vali Acc: 0.550 Test Loss: 0.960 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.655456781387329
Epoch: 32, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.915 Vali Acc: 0.540 Test Loss: 0.915 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.512308597564697
Epoch: 33, Steps: 20 | Train Loss: 0.311 Vali Loss: 0.863 Vali Acc: 0.560 Test Loss: 0.863 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.6811723709106445
Epoch: 34, Steps: 20 | Train Loss: 0.309 Vali Loss: 0.915 Vali Acc: 0.570 Test Loss: 0.915 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 7.034507989883423
Epoch: 35, Steps: 20 | Train Loss: 0.279 Vali Loss: 0.924 Vali Acc: 0.540 Test Loss: 0.924 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.622791051864624
Epoch: 36, Steps: 20 | Train Loss: 0.284 Vali Loss: 0.797 Vali Acc: 0.600 Test Loss: 0.797 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599992).  Saving model ...
Epoch: 37 cost time: 6.753392219543457
Epoch: 37, Steps: 20 | Train Loss: 0.251 Vali Loss: 0.922 Vali Acc: 0.540 Test Loss: 0.922 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.2088847160339355
Epoch: 38, Steps: 20 | Train Loss: 0.259 Vali Loss: 0.952 Vali Acc: 0.560 Test Loss: 0.952 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.952908039093018
Epoch: 39, Steps: 20 | Train Loss: 0.245 Vali Loss: 1.038 Vali Acc: 0.540 Test Loss: 1.038 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.457711458206177
Epoch: 40, Steps: 20 | Train Loss: 0.225 Vali Loss: 1.052 Vali Acc: 0.560 Test Loss: 1.052 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.871852874755859
Epoch: 41, Steps: 20 | Train Loss: 0.204 Vali Loss: 0.988 Vali Acc: 0.580 Test Loss: 0.988 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.593456268310547
Epoch: 42, Steps: 20 | Train Loss: 0.208 Vali Loss: 0.981 Vali Acc: 0.570 Test Loss: 0.981 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 6.485876560211182
Epoch: 43, Steps: 20 | Train Loss: 0.190 Vali Loss: 1.047 Vali Acc: 0.540 Test Loss: 1.047 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 6.756820917129517
Epoch: 44, Steps: 20 | Train Loss: 0.162 Vali Loss: 1.073 Vali Acc: 0.570 Test Loss: 1.073 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 6.882002592086792
Epoch: 45, Steps: 20 | Train Loss: 0.156 Vali Loss: 1.118 Vali Acc: 0.570 Test Loss: 1.118 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 7.329495668411255
Epoch: 46, Steps: 20 | Train Loss: 0.150 Vali Loss: 1.133 Vali Acc: 0.580 Test Loss: 1.133 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.14778995513916
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.813753366470337
Epoch: 2, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.744 Vali Acc: 0.470 Test Loss: 0.744 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.148431301116943
Epoch: 3, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.770 Vali Acc: 0.440 Test Loss: 0.770 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.002831220626831
Epoch: 4, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.613377571105957
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.802 Vali Acc: 0.430 Test Loss: 0.802 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.211300611495972
Epoch: 6, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.789 Vali Acc: 0.450 Test Loss: 0.789 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.480168104171753
Epoch: 7, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.786 Vali Acc: 0.490 Test Loss: 0.786 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.6654558181762695
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.810 Vali Acc: 0.420 Test Loss: 0.810 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.611403703689575
Epoch: 9, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.816 Vali Acc: 0.480 Test Loss: 0.816 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.9976348876953125
Epoch: 10, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499992).  Saving model ...
Epoch: 11 cost time: 7.317001581192017
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.800 Vali Acc: 0.490 Test Loss: 0.800 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.386058807373047
Epoch: 12, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.813 Vali Acc: 0.460 Test Loss: 0.813 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.870722055435181
Epoch: 13, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.830 Vali Acc: 0.520 Test Loss: 0.830 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519992).  Saving model ...
Epoch: 14 cost time: 6.68689751625061
Epoch: 14, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.823 Vali Acc: 0.510 Test Loss: 0.823 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.446683168411255
Epoch: 15, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.814 Vali Acc: 0.450 Test Loss: 0.814 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.294000864028931
Epoch: 16, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.801 Vali Acc: 0.530 Test Loss: 0.801 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 17 cost time: 6.951886892318726
Epoch: 17, Steps: 20 | Train Loss: 0.525 Vali Loss: 0.817 Vali Acc: 0.540 Test Loss: 0.817 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 18 cost time: 6.471997499465942
Epoch: 18, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.591047525405884
Epoch: 19, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.91886830329895
Epoch: 20, Steps: 20 | Train Loss: 0.509 Vali Loss: 0.777 Vali Acc: 0.570 Test Loss: 0.777 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 21 cost time: 6.622512102127075
Epoch: 21, Steps: 20 | Train Loss: 0.523 Vali Loss: 0.774 Vali Acc: 0.580 Test Loss: 0.774 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 22 cost time: 6.589084148406982
Epoch: 22, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.763 Vali Acc: 0.570 Test Loss: 0.763 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.772283315658569
Epoch: 23, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.6817240715026855
Epoch: 24, Steps: 20 | Train Loss: 0.483 Vali Loss: 0.782 Vali Acc: 0.600 Test Loss: 0.782 Test Acc: 0.600
Validation loss decreased (-0.579992 --> -0.599992).  Saving model ...
Epoch: 25 cost time: 7.475938081741333
Epoch: 25, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.752 Vali Acc: 0.600 Test Loss: 0.752 Test Acc: 0.600
Validation loss decreased (-0.599992 --> -0.599992).  Saving model ...
Epoch: 26 cost time: 6.665703296661377
Epoch: 26, Steps: 20 | Train Loss: 0.455 Vali Loss: 0.743 Vali Acc: 0.620 Test Loss: 0.743 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619993).  Saving model ...
Epoch: 27 cost time: 7.635670185089111
Epoch: 27, Steps: 20 | Train Loss: 0.402 Vali Loss: 0.721 Vali Acc: 0.640 Test Loss: 0.721 Test Acc: 0.640
Validation loss decreased (-0.619993 --> -0.639993).  Saving model ...
Epoch: 28 cost time: 7.596402883529663
Epoch: 28, Steps: 20 | Train Loss: 0.405 Vali Loss: 0.717 Vali Acc: 0.630 Test Loss: 0.717 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.825285911560059
Epoch: 29, Steps: 20 | Train Loss: 0.406 Vali Loss: 0.792 Vali Acc: 0.620 Test Loss: 0.792 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.606021881103516
Epoch: 30, Steps: 20 | Train Loss: 0.368 Vali Loss: 0.757 Vali Acc: 0.620 Test Loss: 0.757 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.150632619857788
Epoch: 31, Steps: 20 | Train Loss: 0.412 Vali Loss: 0.868 Vali Acc: 0.550 Test Loss: 0.868 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.6350579261779785
Epoch: 32, Steps: 20 | Train Loss: 0.352 Vali Loss: 0.833 Vali Acc: 0.580 Test Loss: 0.833 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.998519659042358
Epoch: 33, Steps: 20 | Train Loss: 0.335 Vali Loss: 0.785 Vali Acc: 0.620 Test Loss: 0.785 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.967681884765625
Epoch: 34, Steps: 20 | Train Loss: 0.294 Vali Loss: 0.803 Vali Acc: 0.640 Test Loss: 0.803 Test Acc: 0.640
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 7.525150537490845
Epoch: 35, Steps: 20 | Train Loss: 0.300 Vali Loss: 0.872 Vali Acc: 0.590 Test Loss: 0.872 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 7.3030476570129395
Epoch: 36, Steps: 20 | Train Loss: 0.290 Vali Loss: 0.797 Vali Acc: 0.640 Test Loss: 0.797 Test Acc: 0.640
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 7.07204270362854
Epoch: 37, Steps: 20 | Train Loss: 0.269 Vali Loss: 0.834 Vali Acc: 0.630 Test Loss: 0.834 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.072591304779053
Epoch: 1, Steps: 20 | Train Loss: 0.720 Vali Loss: 0.747 Vali Acc: 0.440 Test Loss: 0.747 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 6.877528667449951
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.769 Vali Acc: 0.420 Test Loss: 0.769 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.81351900100708
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.801 Vali Acc: 0.430 Test Loss: 0.801 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.762871265411377
Epoch: 4, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.821 Vali Acc: 0.450 Test Loss: 0.821 Test Acc: 0.450
Validation loss decreased (-0.439993 --> -0.449992).  Saving model ...
Epoch: 5 cost time: 6.33635401725769
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.844 Vali Acc: 0.440 Test Loss: 0.844 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.16726279258728
Epoch: 6, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.848 Vali Acc: 0.480 Test Loss: 0.848 Test Acc: 0.480
Validation loss decreased (-0.449992 --> -0.479992).  Saving model ...
Epoch: 7 cost time: 6.06306529045105
Epoch: 7, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.834 Vali Acc: 0.440 Test Loss: 0.834 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.265113830566406
Epoch: 8, Steps: 20 | Train Loss: 0.638 Vali Loss: 0.860 Vali Acc: 0.460 Test Loss: 0.860 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.173864126205444
Epoch: 9, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.886 Vali Acc: 0.420 Test Loss: 0.886 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.115347385406494
Epoch: 10, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.856 Vali Acc: 0.450 Test Loss: 0.856 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.271538496017456
Epoch: 11, Steps: 20 | Train Loss: 0.636 Vali Loss: 0.872 Vali Acc: 0.460 Test Loss: 0.872 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.327625513076782
Epoch: 12, Steps: 20 | Train Loss: 0.607 Vali Loss: 0.876 Vali Acc: 0.430 Test Loss: 0.876 Test Acc: 0.430
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.465608835220337
Epoch: 13, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.919 Vali Acc: 0.500 Test Loss: 0.919 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499991).  Saving model ...
Epoch: 14 cost time: 7.398536205291748
Epoch: 14, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.866 Vali Acc: 0.470 Test Loss: 0.866 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.017616033554077
Epoch: 15, Steps: 20 | Train Loss: 0.605 Vali Loss: 0.847 Vali Acc: 0.510 Test Loss: 0.847 Test Acc: 0.510
Validation loss decreased (-0.499991 --> -0.509992).  Saving model ...
Epoch: 16 cost time: 6.773072004318237
Epoch: 16, Steps: 20 | Train Loss: 0.591 Vali Loss: 0.880 Vali Acc: 0.490 Test Loss: 0.880 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.782895088195801
Epoch: 17, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.852 Vali Acc: 0.470 Test Loss: 0.852 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.901627779006958
Epoch: 18, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.838 Vali Acc: 0.530 Test Loss: 0.838 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 19 cost time: 6.3012003898620605
Epoch: 19, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.855 Vali Acc: 0.530 Test Loss: 0.855 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.868739366531372
Epoch: 20, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 21 cost time: 6.493813991546631
Epoch: 21, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.922 Vali Acc: 0.510 Test Loss: 0.922 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.0604846477508545
Epoch: 22, Steps: 20 | Train Loss: 0.535 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.3049070835113525
Epoch: 23, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.800 Vali Acc: 0.560 Test Loss: 0.800 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559992).  Saving model ...
Epoch: 24 cost time: 7.79655647277832
Epoch: 24, Steps: 20 | Train Loss: 0.516 Vali Loss: 0.822 Vali Acc: 0.570 Test Loss: 0.822 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 25 cost time: 7.300890207290649
Epoch: 25, Steps: 20 | Train Loss: 0.506 Vali Loss: 0.759 Vali Acc: 0.620 Test Loss: 0.759 Test Acc: 0.620
Validation loss decreased (-0.569992 --> -0.619992).  Saving model ...
Epoch: 26 cost time: 6.871137380599976
Epoch: 26, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.752 Vali Acc: 0.610 Test Loss: 0.752 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.775394439697266
Epoch: 27, Steps: 20 | Train Loss: 0.481 Vali Loss: 0.717 Vali Acc: 0.590 Test Loss: 0.717 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.723562479019165
Epoch: 28, Steps: 20 | Train Loss: 0.456 Vali Loss: 0.757 Vali Acc: 0.600 Test Loss: 0.757 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.347736597061157
Epoch: 29, Steps: 20 | Train Loss: 0.452 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.201808452606201
Epoch: 30, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.758 Vali Acc: 0.610 Test Loss: 0.758 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.208592414855957
Epoch: 31, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.837 Vali Acc: 0.560 Test Loss: 0.837 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.3787453174591064
Epoch: 32, Steps: 20 | Train Loss: 0.392 Vali Loss: 0.743 Vali Acc: 0.600 Test Loss: 0.743 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.335919618606567
Epoch: 33, Steps: 20 | Train Loss: 0.424 Vali Loss: 0.733 Vali Acc: 0.590 Test Loss: 0.733 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.191402435302734
Epoch: 34, Steps: 20 | Train Loss: 0.395 Vali Loss: 0.784 Vali Acc: 0.620 Test Loss: 0.784 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.8783464431762695
Epoch: 35, Steps: 20 | Train Loss: 0.342 Vali Loss: 0.778 Vali Acc: 0.600 Test Loss: 0.778 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.037536382675171
Epoch: 1, Steps: 20 | Train Loss: 0.728 Vali Loss: 0.720 Vali Acc: 0.450 Test Loss: 0.720 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 6.72379469871521
Epoch: 2, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
Validation loss decreased (-0.449993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 6.67685079574585
Epoch: 3, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.735 Vali Acc: 0.480 Test Loss: 0.735 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.66324257850647
Epoch: 4, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.730 Vali Acc: 0.480 Test Loss: 0.730 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.558086633682251
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.731 Vali Acc: 0.480 Test Loss: 0.731 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.469011306762695
Epoch: 6, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
Validation loss decreased (-0.479993 --> -0.499993).  Saving model ...
Epoch: 7 cost time: 6.538271427154541
Epoch: 7, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.742 Vali Acc: 0.500 Test Loss: 0.742 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.365562200546265
Epoch: 8, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.739 Vali Acc: 0.530 Test Loss: 0.739 Test Acc: 0.530
Validation loss decreased (-0.499993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 6.375655889511108
Epoch: 9, Steps: 20 | Train Loss: 0.680 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.72472071647644
Epoch: 10, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 6.671440839767456
Epoch: 11, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.759 Vali Acc: 0.540 Test Loss: 0.759 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.651603698730469
Epoch: 12, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.767 Vali Acc: 0.480 Test Loss: 0.767 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.806977987289429
Epoch: 13, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.94440221786499
Epoch: 14, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.746 Vali Acc: 0.520 Test Loss: 0.746 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.540726900100708
Epoch: 15, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.721052885055542
Epoch: 16, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.768 Vali Acc: 0.560 Test Loss: 0.768 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 17 cost time: 6.788623332977295
Epoch: 17, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.791 Vali Acc: 0.510 Test Loss: 0.791 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.789608955383301
Epoch: 18, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.815 Vali Acc: 0.540 Test Loss: 0.815 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.376175165176392
Epoch: 19, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.327483892440796
Epoch: 20, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.763 Vali Acc: 0.560 Test Loss: 0.763 Test Acc: 0.560
Validation loss decreased (-0.559992 --> -0.559992).  Saving model ...
Epoch: 21 cost time: 6.514827728271484
Epoch: 21, Steps: 20 | Train Loss: 0.577 Vali Loss: 0.813 Vali Acc: 0.490 Test Loss: 0.813 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.510604381561279
Epoch: 22, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.825 Vali Acc: 0.560 Test Loss: 0.825 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.707567930221558
Epoch: 23, Steps: 20 | Train Loss: 0.587 Vali Loss: 0.852 Vali Acc: 0.520 Test Loss: 0.852 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.689398527145386
Epoch: 24, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.756 Vali Acc: 0.570 Test Loss: 0.756 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569992).  Saving model ...
Epoch: 25 cost time: 6.845127105712891
Epoch: 25, Steps: 20 | Train Loss: 0.573 Vali Loss: 0.772 Vali Acc: 0.480 Test Loss: 0.772 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.719372034072876
Epoch: 26, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.791 Vali Acc: 0.540 Test Loss: 0.791 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.904953718185425
Epoch: 27, Steps: 20 | Train Loss: 0.520 Vali Loss: 0.791 Vali Acc: 0.590 Test Loss: 0.791 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589992).  Saving model ...
Epoch: 28 cost time: 6.75640082359314
Epoch: 28, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.349423170089722
Epoch: 29, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.430630207061768
Epoch: 30, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.754 Vali Acc: 0.600 Test Loss: 0.754 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 31 cost time: 6.280926942825317
Epoch: 31, Steps: 20 | Train Loss: 0.547 Vali Loss: 0.865 Vali Acc: 0.570 Test Loss: 0.865 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.120159149169922
Epoch: 32, Steps: 20 | Train Loss: 0.528 Vali Loss: 0.840 Vali Acc: 0.520 Test Loss: 0.840 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.381592035293579
Epoch: 33, Steps: 20 | Train Loss: 0.513 Vali Loss: 0.876 Vali Acc: 0.550 Test Loss: 0.876 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.211374998092651
Epoch: 34, Steps: 20 | Train Loss: 0.479 Vali Loss: 0.798 Vali Acc: 0.580 Test Loss: 0.798 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.488901853561401
Epoch: 35, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.865 Vali Acc: 0.530 Test Loss: 0.865 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.77154803276062
Epoch: 36, Steps: 20 | Train Loss: 0.459 Vali Loss: 0.866 Vali Acc: 0.530 Test Loss: 0.866 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 7.101649284362793
Epoch: 37, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.868 Vali Acc: 0.540 Test Loss: 0.868 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.880960464477539
Epoch: 38, Steps: 20 | Train Loss: 0.443 Vali Loss: 0.975 Vali Acc: 0.500 Test Loss: 0.975 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.7240660190582275
Epoch: 39, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.883 Vali Acc: 0.540 Test Loss: 0.883 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.338503122329712
Epoch: 40, Steps: 20 | Train Loss: 0.433 Vali Loss: 0.851 Vali Acc: 0.570 Test Loss: 0.851 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.245769262313843
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 6.525190830230713
Epoch: 2, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.702 Vali Acc: 0.510 Test Loss: 0.702 Test Acc: 0.510
Validation loss decreased (-0.479993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 6.146639823913574
Epoch: 3, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.721 Vali Acc: 0.490 Test Loss: 0.721 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.460505485534668
Epoch: 4, Steps: 20 | Train Loss: 0.711 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 6.156090497970581
Epoch: 5, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.724 Vali Acc: 0.510 Test Loss: 0.724 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.159095287322998
Epoch: 6, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.740 Vali Acc: 0.510 Test Loss: 0.740 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.703189849853516
Epoch: 7, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 6.502042531967163
Epoch: 8, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.261494398117065
Epoch: 9, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.576652765274048
Epoch: 10, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.642873048782349
Epoch: 11, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.774 Vali Acc: 0.560 Test Loss: 0.774 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 12 cost time: 6.514358043670654
Epoch: 12, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.788 Vali Acc: 0.490 Test Loss: 0.788 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.355066299438477
Epoch: 13, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.2055344581604
Epoch: 14, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.762 Vali Acc: 0.580 Test Loss: 0.762 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579992).  Saving model ...
Epoch: 15 cost time: 6.007825613021851
Epoch: 15, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.807 Vali Acc: 0.490 Test Loss: 0.807 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.188291072845459
Epoch: 16, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.797 Vali Acc: 0.570 Test Loss: 0.797 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.533702850341797
Epoch: 17, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.814 Vali Acc: 0.540 Test Loss: 0.814 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.519842147827148
Epoch: 18, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.851 Vali Acc: 0.540 Test Loss: 0.851 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.508558034896851
Epoch: 19, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.846 Vali Acc: 0.550 Test Loss: 0.846 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.69372034072876
Epoch: 20, Steps: 20 | Train Loss: 0.559 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.674036502838135
Epoch: 21, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.846 Vali Acc: 0.550 Test Loss: 0.846 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.4427525997161865
Epoch: 22, Steps: 20 | Train Loss: 0.560 Vali Loss: 0.856 Vali Acc: 0.560 Test Loss: 0.856 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.589908838272095
Epoch: 23, Steps: 20 | Train Loss: 0.561 Vali Loss: 0.876 Vali Acc: 0.560 Test Loss: 0.876 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.677609205245972
Epoch: 24, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.793 Vali Acc: 0.560 Test Loss: 0.793 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.09193730354309
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.013143062591553
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 5.866563558578491
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.22160267829895
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.24834418296814
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.278947114944458
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.358821630477905
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.409451723098755
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.85280442237854
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.401383399963379
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.531635999679565
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.63475227355957
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 232994
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.663182735443115
Epoch: 1, Steps: 20 | Train Loss: 0.731 Vali Loss: 0.700 Vali Acc: 0.440 Test Loss: 0.700 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 6.056185483932495
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.704 Vali Acc: 0.520 Test Loss: 0.704 Test Acc: 0.520
Validation loss decreased (-0.439993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 6.343265056610107
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.324660539627075
Epoch: 4, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.742 Vali Acc: 0.540 Test Loss: 0.742 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 6.358821153640747
Epoch: 5, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.590327501296997
Epoch: 6, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.749 Vali Acc: 0.530 Test Loss: 0.749 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.9178571701049805
Epoch: 7, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.830341339111328
Epoch: 8, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.413097858428955
Epoch: 9, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.348419904708862
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.786 Vali Acc: 0.540 Test Loss: 0.786 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.395429372787476
Epoch: 11, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.319644212722778
Epoch: 12, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.774 Vali Acc: 0.510 Test Loss: 0.774 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.47226881980896
Epoch: 13, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.790 Vali Acc: 0.530 Test Loss: 0.790 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.456693410873413
Epoch: 14, Steps: 20 | Train Loss: 0.576 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549992).  Saving model ...
Epoch: 15 cost time: 6.8680479526519775
Epoch: 15, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.777 Vali Acc: 0.590 Test Loss: 0.777 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589992).  Saving model ...
Epoch: 16 cost time: 6.50081729888916
Epoch: 16, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.464475154876709
Epoch: 17, Steps: 20 | Train Loss: 0.562 Vali Loss: 0.836 Vali Acc: 0.510 Test Loss: 0.836 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.645370960235596
Epoch: 18, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.808 Vali Acc: 0.500 Test Loss: 0.808 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.880042552947998
Epoch: 19, Steps: 20 | Train Loss: 0.521 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.765510082244873
Epoch: 20, Steps: 20 | Train Loss: 0.518 Vali Loss: 0.802 Vali Acc: 0.480 Test Loss: 0.802 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.669137716293335
Epoch: 21, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.824 Vali Acc: 0.510 Test Loss: 0.824 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.759844779968262
Epoch: 22, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.801 Vali Acc: 0.520 Test Loss: 0.801 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.828722715377808
Epoch: 23, Steps: 20 | Train Loss: 0.475 Vali Loss: 0.803 Vali Acc: 0.500 Test Loss: 0.803 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.331948757171631
Epoch: 24, Steps: 20 | Train Loss: 0.447 Vali Loss: 0.803 Vali Acc: 0.510 Test Loss: 0.803 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.550126791000366
Epoch: 25, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.777 Vali Acc: 0.520 Test Loss: 0.777 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.577337980270386
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 6.78777551651001
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.260709285736084
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.733 Vali Acc: 0.510 Test Loss: 0.733 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.592627048492432
Epoch: 4, Steps: 20 | Train Loss: 0.684 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 5 cost time: 6.349548101425171
Epoch: 5, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.764 Vali Acc: 0.560 Test Loss: 0.764 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559992).  Saving model ...
Epoch: 6 cost time: 6.552337408065796
Epoch: 6, Steps: 20 | Train Loss: 0.652 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.547794580459595
Epoch: 7, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.761 Vali Acc: 0.480 Test Loss: 0.761 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.540508031845093
Epoch: 8, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.820 Vali Acc: 0.510 Test Loss: 0.820 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.304389715194702
Epoch: 9, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.254933595657349
Epoch: 10, Steps: 20 | Train Loss: 0.624 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.276615858078003
Epoch: 11, Steps: 20 | Train Loss: 0.612 Vali Loss: 0.811 Vali Acc: 0.520 Test Loss: 0.811 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.613538503646851
Epoch: 12, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.48878812789917
Epoch: 13, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.548928737640381
Epoch: 14, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.404701471328735
Epoch: 15, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.282719612121582
Epoch: 1, Steps: 20 | Train Loss: 0.735 Vali Loss: 0.701 Vali Acc: 0.520 Test Loss: 0.701 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 6.253145456314087
Epoch: 2, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.202759504318237
Epoch: 3, Steps: 20 | Train Loss: 0.704 Vali Loss: 0.716 Vali Acc: 0.540 Test Loss: 0.716 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 4 cost time: 6.589337110519409
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.742 Vali Acc: 0.530 Test Loss: 0.742 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.824493646621704
Epoch: 5, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.754 Vali Acc: 0.580 Test Loss: 0.754 Test Acc: 0.580
Validation loss decreased (-0.539993 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 6.889050722122192
Epoch: 6, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.747 Vali Acc: 0.570 Test Loss: 0.747 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.247820615768433
Epoch: 7, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.644813060760498
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.859633684158325
Epoch: 9, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.37835955619812
Epoch: 10, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.367068767547607
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.765 Vali Acc: 0.520 Test Loss: 0.765 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.3400468826293945
Epoch: 12, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.751 Vali Acc: 0.530 Test Loss: 0.751 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.405369997024536
Epoch: 13, Steps: 20 | Train Loss: 0.596 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.468397378921509
Epoch: 14, Steps: 20 | Train Loss: 0.585 Vali Loss: 0.758 Vali Acc: 0.550 Test Loss: 0.758 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.675810813903809
Epoch: 15, Steps: 20 | Train Loss: 0.572 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.78510856628418
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.691 Vali Acc: 0.500 Test Loss: 0.691 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 7.282873153686523
Epoch: 2, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.697 Vali Acc: 0.500 Test Loss: 0.697 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.589875221252441
Epoch: 3, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.716 Vali Acc: 0.480 Test Loss: 0.716 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.633184432983398
Epoch: 4, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 7.07559061050415
Epoch: 5, Steps: 20 | Train Loss: 0.664 Vali Loss: 0.742 Vali Acc: 0.510 Test Loss: 0.742 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.861116170883179
Epoch: 6, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.741 Vali Acc: 0.480 Test Loss: 0.741 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.61257791519165
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.752 Vali Acc: 0.480 Test Loss: 0.752 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.421583414077759
Epoch: 8, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.761 Vali Acc: 0.540 Test Loss: 0.761 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539992).  Saving model ...
Epoch: 9 cost time: 6.5845983028411865
Epoch: 9, Steps: 20 | Train Loss: 0.632 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.907437562942505
Epoch: 10, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.187727451324463
Epoch: 11, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.2746007442474365
Epoch: 12, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.0767412185668945
Epoch: 13, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.770 Vali Acc: 0.520 Test Loss: 0.770 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.7656636238098145
Epoch: 14, Steps: 20 | Train Loss: 0.589 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.111669540405273
Epoch: 15, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.007390260696411
Epoch: 16, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.865734100341797
Epoch: 17, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.755432367324829
Epoch: 18, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.784 Vali Acc: 0.550 Test Loss: 0.784 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 19 cost time: 6.901785135269165
Epoch: 19, Steps: 20 | Train Loss: 0.538 Vali Loss: 0.764 Vali Acc: 0.550 Test Loss: 0.764 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 20 cost time: 6.27654242515564
Epoch: 20, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.788 Vali Acc: 0.600 Test Loss: 0.788 Test Acc: 0.600
Validation loss decreased (-0.549992 --> -0.599992).  Saving model ...
Epoch: 21 cost time: 6.721596002578735
Epoch: 21, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.780 Vali Acc: 0.560 Test Loss: 0.780 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.819008827209473
Epoch: 22, Steps: 20 | Train Loss: 0.503 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.045547008514404
Epoch: 23, Steps: 20 | Train Loss: 0.499 Vali Loss: 0.799 Vali Acc: 0.530 Test Loss: 0.799 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.302262306213379
Epoch: 24, Steps: 20 | Train Loss: 0.493 Vali Loss: 0.816 Vali Acc: 0.500 Test Loss: 0.816 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.093596696853638
Epoch: 25, Steps: 20 | Train Loss: 0.460 Vali Loss: 0.777 Vali Acc: 0.570 Test Loss: 0.777 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.552658319473267
Epoch: 26, Steps: 20 | Train Loss: 0.446 Vali Loss: 0.788 Vali Acc: 0.560 Test Loss: 0.788 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.832528591156006
Epoch: 27, Steps: 20 | Train Loss: 0.442 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.022689342498779
Epoch: 28, Steps: 20 | Train Loss: 0.417 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.640902042388916
Epoch: 29, Steps: 20 | Train Loss: 0.396 Vali Loss: 0.858 Vali Acc: 0.580 Test Loss: 0.858 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.673642873764038
Epoch: 30, Steps: 20 | Train Loss: 0.373 Vali Loss: 0.837 Vali Acc: 0.590 Test Loss: 0.837 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.04386019706726
Epoch: 1, Steps: 20 | Train Loss: 0.742 Vali Loss: 0.740 Vali Acc: 0.450 Test Loss: 0.740 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 6.315392255783081
Epoch: 2, Steps: 20 | Train Loss: 0.702 Vali Loss: 0.724 Vali Acc: 0.540 Test Loss: 0.724 Test Acc: 0.540
Validation loss decreased (-0.449993 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 6.388182163238525
Epoch: 3, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.670270919799805
Epoch: 4, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.151854991912842
Epoch: 5, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.917380332946777
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.613055229187012
Epoch: 7, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.8794732093811035
Epoch: 8, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.829 Vali Acc: 0.490 Test Loss: 0.829 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.8365843296051025
Epoch: 9, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.844 Vali Acc: 0.500 Test Loss: 0.844 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.329632997512817
Epoch: 10, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.835 Vali Acc: 0.480 Test Loss: 0.835 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.277658224105835
Epoch: 11, Steps: 20 | Train Loss: 0.635 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.308828830718994
Epoch: 12, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.840 Vali Acc: 0.510 Test Loss: 0.840 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.994765520095825
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.703 Vali Acc: 0.470 Test Loss: 0.703 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 6.791347503662109
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
Validation loss decreased (-0.469993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 7.233093738555908
Epoch: 3, Steps: 20 | Train Loss: 0.717 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 7.189003944396973
Epoch: 4, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.700 Vali Acc: 0.570 Test Loss: 0.700 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 7.241613388061523
Epoch: 5, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.159890174865723
Epoch: 6, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.704 Vali Acc: 0.530 Test Loss: 0.704 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.843303203582764
Epoch: 7, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.708 Vali Acc: 0.600 Test Loss: 0.708 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 8 cost time: 6.623276233673096
Epoch: 8, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.715 Vali Acc: 0.560 Test Loss: 0.715 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.542255640029907
Epoch: 9, Steps: 20 | Train Loss: 0.656 Vali Loss: 0.722 Vali Acc: 0.560 Test Loss: 0.722 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.414162635803223
Epoch: 10, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.724 Vali Acc: 0.560 Test Loss: 0.724 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.4022438526153564
Epoch: 11, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.491586923599243
Epoch: 12, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.568155765533447
Epoch: 13, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.767 Vali Acc: 0.560 Test Loss: 0.767 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.816865682601929
Epoch: 14, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.759 Vali Acc: 0.590 Test Loss: 0.759 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.054237365722656
Epoch: 15, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.786 Vali Acc: 0.550 Test Loss: 0.786 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.797860145568848
Epoch: 16, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.788 Vali Acc: 0.530 Test Loss: 0.788 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.799746036529541
Epoch: 17, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.779 Vali Acc: 0.550 Test Loss: 0.779 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.993533611297607
Epoch: 1, Steps: 20 | Train Loss: 0.716 Vali Loss: 0.714 Vali Acc: 0.490 Test Loss: 0.714 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.987619400024414
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.705 Vali Acc: 0.490 Test Loss: 0.705 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 6.659506320953369
Epoch: 3, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.707 Vali Acc: 0.450 Test Loss: 0.707 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.520232200622559
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (-0.489993 --> -0.509993).  Saving model ...
Epoch: 5 cost time: 6.7976462841033936
Epoch: 5, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 6 cost time: 6.597251653671265
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.721 Vali Acc: 0.510 Test Loss: 0.721 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.807090997695923
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 6.538467645645142
Epoch: 8, Steps: 20 | Train Loss: 0.661 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.898952960968018
Epoch: 9, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.737 Vali Acc: 0.540 Test Loss: 0.737 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.860860347747803
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.746 Vali Acc: 0.560 Test Loss: 0.746 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 11 cost time: 6.864244699478149
Epoch: 11, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.765 Vali Acc: 0.550 Test Loss: 0.765 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.977176189422607
Epoch: 12, Steps: 20 | Train Loss: 0.629 Vali Loss: 0.755 Vali Acc: 0.560 Test Loss: 0.755 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.559053182601929
Epoch: 13, Steps: 20 | Train Loss: 0.618 Vali Loss: 0.780 Vali Acc: 0.540 Test Loss: 0.780 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.7577292919158936
Epoch: 14, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.758 Vali Acc: 0.580 Test Loss: 0.758 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579992).  Saving model ...
Epoch: 15 cost time: 6.279723167419434
Epoch: 15, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.782 Vali Acc: 0.550 Test Loss: 0.782 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.345444679260254
Epoch: 16, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.778 Vali Acc: 0.580 Test Loss: 0.778 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.5237298011779785
Epoch: 17, Steps: 20 | Train Loss: 0.580 Vali Loss: 0.798 Vali Acc: 0.510 Test Loss: 0.798 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.4030163288116455
Epoch: 18, Steps: 20 | Train Loss: 0.584 Vali Loss: 0.798 Vali Acc: 0.520 Test Loss: 0.798 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.425899505615234
Epoch: 19, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.800 Vali Acc: 0.540 Test Loss: 0.800 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.651928186416626
Epoch: 20, Steps: 20 | Train Loss: 0.565 Vali Loss: 0.800 Vali Acc: 0.570 Test Loss: 0.800 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.808383464813232
Epoch: 21, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.883 Vali Acc: 0.510 Test Loss: 0.883 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.615350008010864
Epoch: 22, Steps: 20 | Train Loss: 0.566 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.948929309844971
Epoch: 23, Steps: 20 | Train Loss: 0.527 Vali Loss: 0.834 Vali Acc: 0.550 Test Loss: 0.834 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.681569814682007
Epoch: 24, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.862 Vali Acc: 0.560 Test Loss: 0.862 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.776347398757935
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 6.510037422180176
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 6.7223265171051025
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 4 cost time: 6.457137823104858
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.260561943054199
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.485319137573242
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.599985122680664
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.750256776809692
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.381624937057495
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.679569482803345
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.713702917098999
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.265533208847046
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.240830183029175
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 134690
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.730036973953247
Epoch: 1, Steps: 20 | Train Loss: 0.724 Vali Loss: 0.695 Vali Acc: 0.460 Test Loss: 0.695 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 6.661673307418823
Epoch: 2, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.697 Vali Acc: 0.430 Test Loss: 0.697 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.580472230911255
Epoch: 3, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.707 Vali Acc: 0.480 Test Loss: 0.707 Test Acc: 0.480
Validation loss decreased (-0.459993 --> -0.479993).  Saving model ...
Epoch: 4 cost time: 6.664796829223633
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.716 Vali Acc: 0.530 Test Loss: 0.716 Test Acc: 0.530
Validation loss decreased (-0.479993 --> -0.529993).  Saving model ...
Epoch: 5 cost time: 6.966029644012451
Epoch: 5, Steps: 20 | Train Loss: 0.667 Vali Loss: 0.729 Vali Acc: 0.510 Test Loss: 0.729 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.5769641399383545
Epoch: 6, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.725 Vali Acc: 0.490 Test Loss: 0.725 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.405234336853027
Epoch: 7, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.746 Vali Acc: 0.530 Test Loss: 0.746 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.556118011474609
Epoch: 8, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.750 Vali Acc: 0.520 Test Loss: 0.750 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.148155927658081
Epoch: 9, Steps: 20 | Train Loss: 0.626 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.084343910217285
Epoch: 10, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.075644493103027
Epoch: 11, Steps: 20 | Train Loss: 0.600 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.260956764221191
Epoch: 12, Steps: 20 | Train Loss: 0.592 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.379592180252075
Epoch: 13, Steps: 20 | Train Loss: 0.575 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.904419183731079
Epoch: 14, Steps: 20 | Train Loss: 0.570 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.25780725479126
Epoch: 1, Steps: 20 | Train Loss: 0.723 Vali Loss: 0.704 Vali Acc: 0.470 Test Loss: 0.704 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 6.741297960281372
Epoch: 2, Steps: 20 | Train Loss: 0.705 Vali Loss: 0.706 Vali Acc: 0.530 Test Loss: 0.706 Test Acc: 0.530
Validation loss decreased (-0.469993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 6.31601881980896
Epoch: 3, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.720 Vali Acc: 0.470 Test Loss: 0.720 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.380505561828613
Epoch: 4, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.731 Vali Acc: 0.490 Test Loss: 0.731 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.05915379524231
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.746 Vali Acc: 0.510 Test Loss: 0.746 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.854037523269653
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.738 Vali Acc: 0.510 Test Loss: 0.738 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.366034984588623
Epoch: 7, Steps: 20 | Train Loss: 0.643 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.730044603347778
Epoch: 8, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.987503290176392
Epoch: 9, Steps: 20 | Train Loss: 0.616 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.826206922531128
Epoch: 10, Steps: 20 | Train Loss: 0.631 Vali Loss: 0.770 Vali Acc: 0.490 Test Loss: 0.770 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.754668235778809
Epoch: 11, Steps: 20 | Train Loss: 0.601 Vali Loss: 0.775 Vali Acc: 0.510 Test Loss: 0.775 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.762027263641357
Epoch: 12, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.53
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.313292264938354
Epoch: 1, Steps: 20 | Train Loss: 0.714 Vali Loss: 0.699 Vali Acc: 0.450 Test Loss: 0.699 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 6.58137059211731
Epoch: 2, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.702 Vali Acc: 0.440 Test Loss: 0.702 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.502378225326538
Epoch: 3, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 6.93122935295105
Epoch: 4, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.729 Vali Acc: 0.490 Test Loss: 0.729 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.828174591064453
Epoch: 5, Steps: 20 | Train Loss: 0.666 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.664844989776611
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.709840536117554
Epoch: 7, Steps: 20 | Train Loss: 0.647 Vali Loss: 0.756 Vali Acc: 0.520 Test Loss: 0.756 Test Acc: 0.520
Validation loss decreased (-0.499993 --> -0.519992).  Saving model ...
Epoch: 8 cost time: 6.897296667098999
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.0874738693237305
Epoch: 9, Steps: 20 | Train Loss: 0.621 Vali Loss: 0.748 Vali Acc: 0.530 Test Loss: 0.748 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529993).  Saving model ...
Epoch: 10 cost time: 7.371256113052368
Epoch: 10, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.586220026016235
Epoch: 11, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.514912843704224
Epoch: 12, Steps: 20 | Train Loss: 0.590 Vali Loss: 0.753 Vali Acc: 0.520 Test Loss: 0.753 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.724603176116943
Epoch: 13, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.698432207107544
Epoch: 14, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.422142267227173
Epoch: 15, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.683477878570557
Epoch: 16, Steps: 20 | Train Loss: 0.568 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.916992664337158
Epoch: 17, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.793 Vali Acc: 0.530 Test Loss: 0.793 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.906229496002197
Epoch: 18, Steps: 20 | Train Loss: 0.551 Vali Loss: 0.782 Vali Acc: 0.540 Test Loss: 0.782 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539992).  Saving model ...
Epoch: 19 cost time: 6.98811674118042
Epoch: 19, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549992).  Saving model ...
Epoch: 20 cost time: 7.143687725067139
Epoch: 20, Steps: 20 | Train Loss: 0.514 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.981416702270508
Epoch: 21, Steps: 20 | Train Loss: 0.500 Vali Loss: 0.784 Vali Acc: 0.530 Test Loss: 0.784 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.782423973083496
Epoch: 22, Steps: 20 | Train Loss: 0.487 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 23 cost time: 6.7707366943359375
Epoch: 23, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.786 Vali Acc: 0.590 Test Loss: 0.786 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589992).  Saving model ...
Epoch: 24 cost time: 6.403631687164307
Epoch: 24, Steps: 20 | Train Loss: 0.468 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.30620265007019
Epoch: 25, Steps: 20 | Train Loss: 0.436 Vali Loss: 0.785 Vali Acc: 0.530 Test Loss: 0.785 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.353490352630615
Epoch: 26, Steps: 20 | Train Loss: 0.439 Vali Loss: 0.861 Vali Acc: 0.530 Test Loss: 0.861 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.641866207122803
Epoch: 27, Steps: 20 | Train Loss: 0.393 Vali Loss: 0.830 Vali Acc: 0.510 Test Loss: 0.830 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.174149036407471
Epoch: 28, Steps: 20 | Train Loss: 0.399 Vali Loss: 0.883 Vali Acc: 0.480 Test Loss: 0.883 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.5674357414245605
Epoch: 29, Steps: 20 | Train Loss: 0.349 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.8943798542022705
Epoch: 30, Steps: 20 | Train Loss: 0.326 Vali Loss: 0.807 Vali Acc: 0.520 Test Loss: 0.807 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.742825746536255
Epoch: 31, Steps: 20 | Train Loss: 0.325 Vali Loss: 0.805 Vali Acc: 0.550 Test Loss: 0.805 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.642358779907227
Epoch: 32, Steps: 20 | Train Loss: 0.318 Vali Loss: 0.878 Vali Acc: 0.500 Test Loss: 0.878 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.654460906982422
Epoch: 33, Steps: 20 | Train Loss: 0.310 Vali Loss: 0.895 Vali Acc: 0.510 Test Loss: 0.895 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.642968893051147
Epoch: 1, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.708 Vali Acc: 0.570 Test Loss: 0.708 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 6.3043060302734375
Epoch: 2, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.58404541015625
Epoch: 3, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.726 Vali Acc: 0.460 Test Loss: 0.726 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.39806342124939
Epoch: 4, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.742 Vali Acc: 0.450 Test Loss: 0.742 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.0541770458221436
Epoch: 5, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.757 Vali Acc: 0.450 Test Loss: 0.757 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.278041839599609
Epoch: 6, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.681954860687256
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.509790420532227
Epoch: 8, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.768 Vali Acc: 0.480 Test Loss: 0.768 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.37858247756958
Epoch: 9, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.28665828704834
Epoch: 10, Steps: 20 | Train Loss: 0.641 Vali Loss: 0.775 Vali Acc: 0.530 Test Loss: 0.775 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.208026647567749
Epoch: 11, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.770 Vali Acc: 0.530 Test Loss: 0.770 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.501904487609863
Epoch: 1, Steps: 20 | Train Loss: 0.745 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 6.328038215637207
Epoch: 2, Steps: 20 | Train Loss: 0.712 Vali Loss: 0.693 Vali Acc: 0.590 Test Loss: 0.693 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 6.459133863449097
Epoch: 3, Steps: 20 | Train Loss: 0.703 Vali Loss: 0.705 Vali Acc: 0.530 Test Loss: 0.705 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.170949697494507
Epoch: 4, Steps: 20 | Train Loss: 0.685 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.385483741760254
Epoch: 5, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.748 Vali Acc: 0.520 Test Loss: 0.748 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.69572639465332
Epoch: 6, Steps: 20 | Train Loss: 0.681 Vali Loss: 0.757 Vali Acc: 0.560 Test Loss: 0.757 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.128801584243774
Epoch: 7, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.791 Vali Acc: 0.520 Test Loss: 0.791 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.6981260776519775
Epoch: 8, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.792 Vali Acc: 0.520 Test Loss: 0.792 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.179995775222778
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.809 Vali Acc: 0.470 Test Loss: 0.809 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.443099021911621
Epoch: 10, Steps: 20 | Train Loss: 0.653 Vali Loss: 0.823 Vali Acc: 0.470 Test Loss: 0.823 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.444822788238525
Epoch: 11, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.820 Vali Acc: 0.450 Test Loss: 0.820 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.3588502407073975
Epoch: 12, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.810 Vali Acc: 0.480 Test Loss: 0.810 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.078812599182129
Epoch: 1, Steps: 20 | Train Loss: 0.726 Vali Loss: 0.691 Vali Acc: 0.460 Test Loss: 0.691 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 6.311999320983887
Epoch: 2, Steps: 20 | Train Loss: 0.701 Vali Loss: 0.687 Vali Acc: 0.570 Test Loss: 0.687 Test Acc: 0.570
Validation loss decreased (-0.459993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 7.259636640548706
Epoch: 3, Steps: 20 | Train Loss: 0.695 Vali Loss: 0.691 Vali Acc: 0.490 Test Loss: 0.691 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.877990961074829
Epoch: 4, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.697 Vali Acc: 0.530 Test Loss: 0.697 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.959981203079224
Epoch: 5, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.033229112625122
Epoch: 6, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.693 Vali Acc: 0.520 Test Loss: 0.693 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.7755608558654785
Epoch: 7, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.704 Vali Acc: 0.560 Test Loss: 0.704 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.800426244735718
Epoch: 8, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.771239519119263
Epoch: 9, Steps: 20 | Train Loss: 0.672 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.2336061000823975
Epoch: 10, Steps: 20 | Train Loss: 0.677 Vali Loss: 0.725 Vali Acc: 0.570 Test Loss: 0.725 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.421917200088501
Epoch: 11, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.29311990737915
Epoch: 12, Steps: 20 | Train Loss: 0.654 Vali Loss: 0.713 Vali Acc: 0.590 Test Loss: 0.713 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 6.408799171447754
Epoch: 13, Steps: 20 | Train Loss: 0.642 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.175325155258179
Epoch: 14, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.086831092834473
Epoch: 15, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.751 Vali Acc: 0.580 Test Loss: 0.751 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.69800877571106
Epoch: 16, Steps: 20 | Train Loss: 0.628 Vali Loss: 0.742 Vali Acc: 0.560 Test Loss: 0.742 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.646978378295898
Epoch: 17, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.767 Vali Acc: 0.530 Test Loss: 0.767 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.607022047042847
Epoch: 18, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.781 Vali Acc: 0.540 Test Loss: 0.781 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.774435520172119
Epoch: 19, Steps: 20 | Train Loss: 0.610 Vali Loss: 0.782 Vali Acc: 0.590 Test Loss: 0.782 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.234979867935181
Epoch: 20, Steps: 20 | Train Loss: 0.597 Vali Loss: 0.776 Vali Acc: 0.540 Test Loss: 0.776 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.442371606826782
Epoch: 21, Steps: 20 | Train Loss: 0.567 Vali Loss: 0.790 Vali Acc: 0.570 Test Loss: 0.790 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.701876401901245
Epoch: 22, Steps: 20 | Train Loss: 0.581 Vali Loss: 0.797 Vali Acc: 0.600 Test Loss: 0.797 Test Acc: 0.600
Validation loss decreased (-0.589993 --> -0.599992).  Saving model ...
Epoch: 23 cost time: 6.424705505371094
Epoch: 23, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.806 Vali Acc: 0.580 Test Loss: 0.806 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.1860737800598145
Epoch: 24, Steps: 20 | Train Loss: 0.574 Vali Loss: 0.827 Vali Acc: 0.580 Test Loss: 0.827 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.891442537307739
Epoch: 25, Steps: 20 | Train Loss: 0.529 Vali Loss: 0.785 Vali Acc: 0.620 Test Loss: 0.785 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619992).  Saving model ...
Epoch: 26 cost time: 6.214019775390625
Epoch: 26, Steps: 20 | Train Loss: 0.545 Vali Loss: 0.812 Vali Acc: 0.540 Test Loss: 0.812 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.400822877883911
Epoch: 27, Steps: 20 | Train Loss: 0.522 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.374507904052734
Epoch: 28, Steps: 20 | Train Loss: 0.519 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.549815893173218
Epoch: 29, Steps: 20 | Train Loss: 0.472 Vali Loss: 0.802 Vali Acc: 0.620 Test Loss: 0.802 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.4101786613464355
Epoch: 30, Steps: 20 | Train Loss: 0.494 Vali Loss: 0.797 Vali Acc: 0.570 Test Loss: 0.797 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.8858771324157715
Epoch: 31, Steps: 20 | Train Loss: 0.495 Vali Loss: 0.761 Vali Acc: 0.600 Test Loss: 0.761 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.700645208358765
Epoch: 32, Steps: 20 | Train Loss: 0.484 Vali Loss: 0.861 Vali Acc: 0.540 Test Loss: 0.861 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.523119926452637
Epoch: 33, Steps: 20 | Train Loss: 0.470 Vali Loss: 0.762 Vali Acc: 0.600 Test Loss: 0.762 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.7197182178497314
Epoch: 34, Steps: 20 | Train Loss: 0.477 Vali Loss: 0.758 Vali Acc: 0.560 Test Loss: 0.758 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.532166481018066
Epoch: 35, Steps: 20 | Train Loss: 0.437 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 7.90480899810791
Epoch: 1, Steps: 20 | Train Loss: 0.734 Vali Loss: 0.717 Vali Acc: 0.390 Test Loss: 0.717 Test Acc: 0.390
Validation loss decreased (inf --> -0.389993).  Saving model ...
Epoch: 2 cost time: 6.274958848953247
Epoch: 2, Steps: 20 | Train Loss: 0.697 Vali Loss: 0.714 Vali Acc: 0.480 Test Loss: 0.714 Test Acc: 0.480
Validation loss decreased (-0.389993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 6.934478998184204
Epoch: 3, Steps: 20 | Train Loss: 0.694 Vali Loss: 0.716 Vali Acc: 0.520 Test Loss: 0.716 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 6.649852275848389
Epoch: 4, Steps: 20 | Train Loss: 0.691 Vali Loss: 0.720 Vali Acc: 0.510 Test Loss: 0.720 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.626065015792847
Epoch: 5, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.723 Vali Acc: 0.470 Test Loss: 0.723 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.240204811096191
Epoch: 6, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.717 Vali Acc: 0.520 Test Loss: 0.717 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.78891134262085
Epoch: 7, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.731 Vali Acc: 0.460 Test Loss: 0.731 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.900464057922363
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529993).  Saving model ...
Epoch: 9 cost time: 6.279311418533325
Epoch: 9, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 6.102705717086792
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.745 Vali Acc: 0.580 Test Loss: 0.745 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 11 cost time: 6.513657808303833
Epoch: 11, Steps: 20 | Train Loss: 0.660 Vali Loss: 0.731 Vali Acc: 0.590 Test Loss: 0.731 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589993).  Saving model ...
Epoch: 12 cost time: 6.290723562240601
Epoch: 12, Steps: 20 | Train Loss: 0.639 Vali Loss: 0.740 Vali Acc: 0.570 Test Loss: 0.740 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.515666961669922
Epoch: 13, Steps: 20 | Train Loss: 0.634 Vali Loss: 0.769 Vali Acc: 0.510 Test Loss: 0.769 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.370136499404907
Epoch: 14, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.1835737228393555
Epoch: 15, Steps: 20 | Train Loss: 0.617 Vali Loss: 0.775 Vali Acc: 0.560 Test Loss: 0.775 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.304375886917114
Epoch: 16, Steps: 20 | Train Loss: 0.599 Vali Loss: 0.774 Vali Acc: 0.570 Test Loss: 0.774 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.587202072143555
Epoch: 17, Steps: 20 | Train Loss: 0.606 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.55401611328125
Epoch: 18, Steps: 20 | Train Loss: 0.602 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.150262117385864
Epoch: 19, Steps: 20 | Train Loss: 0.594 Vali Loss: 0.812 Vali Acc: 0.580 Test Loss: 0.812 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.329309701919556
Epoch: 20, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.820 Vali Acc: 0.540 Test Loss: 0.820 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.391857147216797
Epoch: 21, Steps: 20 | Train Loss: 0.555 Vali Loss: 0.823 Vali Acc: 0.580 Test Loss: 0.823 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.294762372970581
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.437480926513672
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.653231620788574
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.804858207702637
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.455446243286133
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.598256349563599
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.786777496337891
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.0351951122283936
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.0082995891571045
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.433860540390015
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.922515392303467
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.510 Test Loss: 0.693 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.51
model parameter : 85538
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.098347187042236
Epoch: 1, Steps: 20 | Train Loss: 0.713 Vali Loss: 0.689 Vali Acc: 0.510 Test Loss: 0.689 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.355673789978027
Epoch: 2, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.694 Vali Acc: 0.560 Test Loss: 0.694 Test Acc: 0.560
Validation loss decreased (-0.509993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 6.445387601852417
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.568582057952881
Epoch: 4, Steps: 20 | Train Loss: 0.683 Vali Loss: 0.727 Vali Acc: 0.570 Test Loss: 0.727 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 6.414159774780273
Epoch: 5, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.350609302520752
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.3781514167785645
Epoch: 7, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.754 Vali Acc: 0.570 Test Loss: 0.754 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.772627353668213
Epoch: 8, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.764 Vali Acc: 0.540 Test Loss: 0.764 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.702516317367554
Epoch: 9, Steps: 20 | Train Loss: 0.625 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.299350261688232
Epoch: 10, Steps: 20 | Train Loss: 0.622 Vali Loss: 0.775 Vali Acc: 0.520 Test Loss: 0.775 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.370187044143677
Epoch: 11, Steps: 20 | Train Loss: 0.613 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.2785258293151855
Epoch: 12, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.152415990829468
Epoch: 13, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.787 Vali Acc: 0.510 Test Loss: 0.787 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.567885160446167
Epoch: 14, Steps: 20 | Train Loss: 0.582 Vali Loss: 0.795 Vali Acc: 0.510 Test Loss: 0.795 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 60962
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.491645812988281
Epoch: 1, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.698 Vali Acc: 0.560 Test Loss: 0.698 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 6.213119745254517
Epoch: 2, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.709 Vali Acc: 0.560 Test Loss: 0.709 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.417750597000122
Epoch: 3, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.723 Vali Acc: 0.590 Test Loss: 0.723 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 6.387547016143799
Epoch: 4, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.743 Vali Acc: 0.560 Test Loss: 0.743 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.721860647201538
Epoch: 5, Steps: 20 | Train Loss: 0.648 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.547563791275024
Epoch: 6, Steps: 20 | Train Loss: 0.669 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.015311241149902
Epoch: 7, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.968111515045166
Epoch: 8, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.778 Vali Acc: 0.560 Test Loss: 0.778 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.886332035064697
Epoch: 9, Steps: 20 | Train Loss: 0.630 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.4129321575164795
Epoch: 10, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.785 Vali Acc: 0.510 Test Loss: 0.785 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.144532680511475
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.785 Vali Acc: 0.490 Test Loss: 0.785 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.7330663204193115
Epoch: 12, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.547870397567749
Epoch: 13, Steps: 20 | Train Loss: 0.609 Vali Loss: 0.796 Vali Acc: 0.510 Test Loss: 0.796 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 60962
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.401201725006104
Epoch: 1, Steps: 20 | Train Loss: 0.699 Vali Loss: 0.694 Vali Acc: 0.510 Test Loss: 0.694 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.8608787059783936
Epoch: 2, Steps: 20 | Train Loss: 0.679 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.523247241973877
Epoch: 3, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
Validation loss decreased (-0.509993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 6.2547807693481445
Epoch: 4, Steps: 20 | Train Loss: 0.675 Vali Loss: 0.740 Vali Acc: 0.520 Test Loss: 0.740 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.047939300537109
Epoch: 5, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.754 Vali Acc: 0.480 Test Loss: 0.754 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.988912582397461
Epoch: 6, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.761 Vali Acc: 0.510 Test Loss: 0.761 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.225238084793091
Epoch: 7, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.760 Vali Acc: 0.530 Test Loss: 0.760 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 8 cost time: 6.237709045410156
Epoch: 8, Steps: 20 | Train Loss: 0.650 Vali Loss: 0.768 Vali Acc: 0.510 Test Loss: 0.768 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.393920183181763
Epoch: 9, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.380119800567627
Epoch: 10, Steps: 20 | Train Loss: 0.619 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.242388486862183
Epoch: 11, Steps: 20 | Train Loss: 0.623 Vali Loss: 0.778 Vali Acc: 0.490 Test Loss: 0.778 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.319463729858398
Epoch: 12, Steps: 20 | Train Loss: 0.593 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
Validation loss decreased (-0.529992 --> -0.539992).  Saving model ...
Epoch: 13 cost time: 6.6778154373168945
Epoch: 13, Steps: 20 | Train Loss: 0.615 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.914246559143066
Epoch: 14, Steps: 20 | Train Loss: 0.586 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.700910806655884
Epoch: 15, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.037755966186523
Epoch: 16, Steps: 20 | Train Loss: 0.569 Vali Loss: 0.787 Vali Acc: 0.540 Test Loss: 0.787 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.902052640914917
Epoch: 17, Steps: 20 | Train Loss: 0.558 Vali Loss: 0.793 Vali Acc: 0.520 Test Loss: 0.793 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.923033952713013
Epoch: 18, Steps: 20 | Train Loss: 0.552 Vali Loss: 0.768 Vali Acc: 0.570 Test Loss: 0.768 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 19 cost time: 6.462673664093018
Epoch: 19, Steps: 20 | Train Loss: 0.548 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.362759351730347
Epoch: 20, Steps: 20 | Train Loss: 0.549 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.449538230895996
Epoch: 21, Steps: 20 | Train Loss: 0.508 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.660093545913696
Epoch: 22, Steps: 20 | Train Loss: 0.473 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.716886281967163
Epoch: 23, Steps: 20 | Train Loss: 0.458 Vali Loss: 0.806 Vali Acc: 0.540 Test Loss: 0.806 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.064706563949585
Epoch: 24, Steps: 20 | Train Loss: 0.463 Vali Loss: 0.792 Vali Acc: 0.540 Test Loss: 0.792 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.205976486206055
Epoch: 25, Steps: 20 | Train Loss: 0.476 Vali Loss: 0.818 Vali Acc: 0.510 Test Loss: 0.818 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.937627553939819
Epoch: 26, Steps: 20 | Train Loss: 0.438 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.524521112442017
Epoch: 27, Steps: 20 | Train Loss: 0.400 Vali Loss: 0.828 Vali Acc: 0.550 Test Loss: 0.828 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.3261425495147705
Epoch: 28, Steps: 20 | Train Loss: 0.413 Vali Loss: 0.825 Vali Acc: 0.510 Test Loss: 0.825 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 60962
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.132949829101562
Epoch: 1, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.684 Vali Acc: 0.580 Test Loss: 0.684 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 6.669259786605835
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.775851011276245
Epoch: 3, Steps: 20 | Train Loss: 0.671 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.223238229751587
Epoch: 4, Steps: 20 | Train Loss: 0.674 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.065225601196289
Epoch: 5, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.737 Vali Acc: 0.510 Test Loss: 0.737 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.931619882583618
Epoch: 6, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.748 Vali Acc: 0.510 Test Loss: 0.748 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.780505895614624
Epoch: 7, Steps: 20 | Train Loss: 0.670 Vali Loss: 0.756 Vali Acc: 0.490 Test Loss: 0.756 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.045612096786499
Epoch: 8, Steps: 20 | Train Loss: 0.644 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.441583633422852
Epoch: 9, Steps: 20 | Train Loss: 0.640 Vali Loss: 0.784 Vali Acc: 0.490 Test Loss: 0.784 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.75906229019165
Epoch: 10, Steps: 20 | Train Loss: 0.633 Vali Loss: 0.771 Vali Acc: 0.510 Test Loss: 0.771 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.81146764755249
Epoch: 11, Steps: 20 | Train Loss: 0.627 Vali Loss: 0.780 Vali Acc: 0.510 Test Loss: 0.780 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 60962
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.845478534698486
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.708 Vali Acc: 0.560 Test Loss: 0.708 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 6.415340423583984
Epoch: 2, Steps: 20 | Train Loss: 0.690 Vali Loss: 0.717 Vali Acc: 0.540 Test Loss: 0.717 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.383009195327759
Epoch: 3, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.613344669342041
Epoch: 4, Steps: 20 | Train Loss: 0.708 Vali Loss: 0.756 Vali Acc: 0.480 Test Loss: 0.756 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.092061281204224
Epoch: 5, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.456119775772095
Epoch: 6, Steps: 20 | Train Loss: 0.676 Vali Loss: 0.793 Vali Acc: 0.450 Test Loss: 0.793 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.157015085220337
Epoch: 7, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.804 Vali Acc: 0.490 Test Loss: 0.804 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.978168249130249
Epoch: 8, Steps: 20 | Train Loss: 0.655 Vali Loss: 0.826 Vali Acc: 0.480 Test Loss: 0.826 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.908665180206299
Epoch: 9, Steps: 20 | Train Loss: 0.659 Vali Loss: 0.863 Vali Acc: 0.490 Test Loss: 0.863 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.130899667739868
Epoch: 10, Steps: 20 | Train Loss: 0.657 Vali Loss: 0.837 Vali Acc: 0.460 Test Loss: 0.837 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.986511468887329
Epoch: 11, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.838 Vali Acc: 0.480 Test Loss: 0.838 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 60962
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.385003328323364
Epoch: 1, Steps: 20 | Train Loss: 0.706 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 6.480602025985718
Epoch: 2, Steps: 20 | Train Loss: 0.687 Vali Loss: 0.703 Vali Acc: 0.570 Test Loss: 0.703 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 6.911239385604858
Epoch: 3, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.665697813034058
Epoch: 4, Steps: 20 | Train Loss: 0.698 Vali Loss: 0.711 Vali Acc: 0.550 Test Loss: 0.711 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.8674938678741455
Epoch: 5, Steps: 20 | Train Loss: 0.692 Vali Loss: 0.717 Vali Acc: 0.530 Test Loss: 0.717 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.352840423583984
Epoch: 6, Steps: 20 | Train Loss: 0.689 Vali Loss: 0.717 Vali Acc: 0.510 Test Loss: 0.717 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.042196273803711
Epoch: 7, Steps: 20 | Train Loss: 0.710 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.0894951820373535
Epoch: 8, Steps: 20 | Train Loss: 0.682 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.544494867324829
Epoch: 9, Steps: 20 | Train Loss: 0.673 Vali Loss: 0.744 Vali Acc: 0.520 Test Loss: 0.744 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.192055940628052
Epoch: 10, Steps: 20 | Train Loss: 0.658 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.127155542373657
Epoch: 11, Steps: 20 | Train Loss: 0.668 Vali Loss: 0.758 Vali Acc: 0.540 Test Loss: 0.758 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.654348134994507
Epoch: 12, Steps: 20 | Train Loss: 0.651 Vali Loss: 0.757 Vali Acc: 0.540 Test Loss: 0.757 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 60962
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 8.608470678329468
Epoch: 1, Steps: 20 | Train Loss: 0.725 Vali Loss: 0.704 Vali Acc: 0.510 Test Loss: 0.704 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 6.604953050613403
Epoch: 2, Steps: 20 | Train Loss: 0.686 Vali Loss: 0.701 Vali Acc: 0.500 Test Loss: 0.701 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.576975584030151
Epoch: 3, Steps: 20 | Train Loss: 0.719 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.58860445022583
Epoch: 4, Steps: 20 | Train Loss: 0.700 Vali Loss: 0.711 Vali Acc: 0.470 Test Loss: 0.711 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.6777496337890625
Epoch: 5, Steps: 20 | Train Loss: 0.696 Vali Loss: 0.717 Vali Acc: 0.490 Test Loss: 0.717 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.64786171913147
Epoch: 6, Steps: 20 | Train Loss: 0.688 Vali Loss: 0.718 Vali Acc: 0.530 Test Loss: 0.718 Test Acc: 0.530
Validation loss decreased (-0.509993 --> -0.529993).  Saving model ...
Epoch: 7 cost time: 6.6180713176727295
Epoch: 7, Steps: 20 | Train Loss: 0.707 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.529993 --> -0.539993).  Saving model ...
Epoch: 8 cost time: 6.187067747116089
Epoch: 8, Steps: 20 | Train Loss: 0.678 Vali Loss: 0.729 Vali Acc: 0.540 Test Loss: 0.729 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.460054397583008
Epoch: 9, Steps: 20 | Train Loss: 0.665 Vali Loss: 0.751 Vali Acc: 0.540 Test Loss: 0.751 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.685579299926758
Epoch: 10, Steps: 20 | Train Loss: 0.649 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 11 cost time: 7.047070264816284
Epoch: 11, Steps: 20 | Train Loss: 0.662 Vali Loss: 0.751 Vali Acc: 0.530 Test Loss: 0.751 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.9363484382629395
Epoch: 12, Steps: 20 | Train Loss: 0.646 Vali Loss: 0.748 Vali Acc: 0.590 Test Loss: 0.748 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589993).  Saving model ...
Epoch: 13 cost time: 6.738250494003296
Epoch: 13, Steps: 20 | Train Loss: 0.645 Vali Loss: 0.749 Vali Acc: 0.540 Test Loss: 0.749 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.739238500595093
Epoch: 14, Steps: 20 | Train Loss: 0.620 Vali Loss: 0.773 Vali Acc: 0.530 Test Loss: 0.773 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.888458728790283
Epoch: 15, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.781 Vali Acc: 0.510 Test Loss: 0.781 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.5923333168029785
Epoch: 16, Steps: 20 | Train Loss: 0.614 Vali Loss: 0.767 Vali Acc: 0.550 Test Loss: 0.767 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.374707460403442
Epoch: 17, Steps: 20 | Train Loss: 0.598 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.33408522605896
Epoch: 18, Steps: 20 | Train Loss: 0.603 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.507032155990601
Epoch: 19, Steps: 20 | Train Loss: 0.578 Vali Loss: 0.794 Vali Acc: 0.520 Test Loss: 0.794 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.582737922668457
Epoch: 20, Steps: 20 | Train Loss: 0.583 Vali Loss: 0.819 Vali Acc: 0.510 Test Loss: 0.819 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.622024774551392
Epoch: 21, Steps: 20 | Train Loss: 0.588 Vali Loss: 0.810 Vali Acc: 0.540 Test Loss: 0.810 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.98875093460083
Epoch: 22, Steps: 20 | Train Loss: 0.563 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 60962
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_FingerMovements Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/FingerMovements
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             28                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

316
100
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
 fourier enhanced cross attention used!
modes_q=12, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
modes_kv=25, index_kv=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24]
>>>>>>>start training : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
316
100
100
Epoch: 1 cost time: 9.039957284927368
Epoch: 1, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 7.302708148956299
Epoch: 2, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 3 cost time: 7.291963815689087
Epoch: 3, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.198513746261597
Epoch: 4, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 5 cost time: 6.856301784515381
Epoch: 5, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.663068771362305
Epoch: 6, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 7 cost time: 6.288209915161133
Epoch: 7, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 8 cost time: 6.720631122589111
Epoch: 8, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
Validation loss decreased (-0.489993 --> -0.489993).  Saving model ...
Epoch: 9 cost time: 6.34825325012207
Epoch: 9, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.040667533874512
Epoch: 10, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.7125244140625
Epoch: 11, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.7126641273498535
Epoch: 12, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.465763092041016
Epoch: 13, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.932257652282715
Epoch: 14, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.474140167236328
Epoch: 15, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.5254998207092285
Epoch: 16, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.486586570739746
Epoch: 17, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.822294473648071
Epoch: 18, Steps: 20 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.490 Test Loss: 0.693 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_FingerMovements_FEDformer_UEA_ftM_sl50_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.49
model parameter : 60962
model size : 1.48MB
