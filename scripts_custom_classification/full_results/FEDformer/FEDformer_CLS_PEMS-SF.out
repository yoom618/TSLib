Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.951498031616211
Epoch: 1, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.553 Vali Acc: 0.318 Test Loss: 1.553 Test Acc: 0.318
Validation loss decreased (inf --> -0.317904).  Saving model ...
Epoch: 2 cost time: 5.518261432647705
Epoch: 2, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.693 Vali Acc: 0.769 Test Loss: 0.693 Test Acc: 0.769
Validation loss decreased (-0.317904 --> -0.768779).  Saving model ...
Epoch: 3 cost time: 5.6899237632751465
Epoch: 3, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.939 Vali Acc: 0.642 Test Loss: 0.939 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.458524465560913
Epoch: 4, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.781 Vali Acc: 0.751 Test Loss: 0.781 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.742067098617554
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.683 Vali Acc: 0.780 Test Loss: 0.683 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780340).  Saving model ...
Epoch: 6 cost time: 5.899320840835571
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.756 Vali Acc: 0.786 Test Loss: 0.756 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 5.6648478507995605
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.753 Vali Acc: 0.780 Test Loss: 0.753 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.717276334762573
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.937 Vali Acc: 0.763 Test Loss: 0.937 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.674034595489502
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.954 Vali Acc: 0.809 Test Loss: 0.954 Test Acc: 0.809
Validation loss decreased (-0.786120 --> -0.809239).  Saving model ...
Epoch: 10 cost time: 5.935478210449219
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.976 Vali Acc: 0.734 Test Loss: 1.976 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.0347654819488525
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.755 Vali Acc: 0.740 Test Loss: 1.755 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.848225355148315
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.820 Vali Acc: 0.769 Test Loss: 1.820 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.123230695724487
Epoch: 13, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.292 Vali Acc: 0.832 Test Loss: 1.292 Test Acc: 0.832
Validation loss decreased (-0.809239 --> -0.832357).  Saving model ...
Epoch: 14 cost time: 5.47093653678894
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.187 Vali Acc: 0.728 Test Loss: 2.187 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.553402662277222
Epoch: 15, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.777 Vali Acc: 0.809 Test Loss: 1.777 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.03563380241394
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.601 Vali Acc: 0.821 Test Loss: 1.601 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.057171583175659
Epoch: 17, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.881 Vali Acc: 0.798 Test Loss: 1.881 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.163156032562256
Epoch: 18, Steps: 17 | Train Loss: 0.116 Vali Loss: 4.178 Vali Acc: 0.699 Test Loss: 4.178 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.017437696456909
Epoch: 19, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.082 Vali Acc: 0.855 Test Loss: 1.082 Test Acc: 0.855
Validation loss decreased (-0.832357 --> -0.855481).  Saving model ...
Epoch: 20 cost time: 5.829597473144531
Epoch: 20, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.357 Vali Acc: 0.844 Test Loss: 1.357 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.899945974349976
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 4.107 Vali Acc: 0.705 Test Loss: 4.107 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.535073757171631
Epoch: 22, Steps: 17 | Train Loss: 0.132 Vali Loss: 2.110 Vali Acc: 0.803 Test Loss: 2.110 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.091104745864868
Epoch: 23, Steps: 17 | Train Loss: 0.183 Vali Loss: 3.699 Vali Acc: 0.746 Test Loss: 3.699 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.9348464012146
Epoch: 24, Steps: 17 | Train Loss: 0.248 Vali Loss: 4.778 Vali Acc: 0.769 Test Loss: 4.778 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.617187976837158
Epoch: 25, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.770 Vali Acc: 0.809 Test Loss: 1.770 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.333735466003418
Epoch: 26, Steps: 17 | Train Loss: 0.028 Vali Loss: 4.694 Vali Acc: 0.740 Test Loss: 4.694 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.315203428268433
Epoch: 27, Steps: 17 | Train Loss: 0.157 Vali Loss: 2.817 Vali Acc: 0.855 Test Loss: 2.817 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.5675575733184814
Epoch: 28, Steps: 17 | Train Loss: 0.130 Vali Loss: 3.664 Vali Acc: 0.803 Test Loss: 3.664 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.3662497997283936
Epoch: 29, Steps: 17 | Train Loss: 0.194 Vali Loss: 4.316 Vali Acc: 0.769 Test Loss: 4.316 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.597885847091675
Epoch: 1, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.537 Vali Acc: 0.329 Test Loss: 1.537 Test Acc: 0.329
Validation loss decreased (inf --> -0.329464).  Saving model ...
Epoch: 2 cost time: 5.897792339324951
Epoch: 2, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
Validation loss decreased (-0.329464 --> -0.751439).  Saving model ...
Epoch: 3 cost time: 5.301943302154541
Epoch: 3, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.830 Vali Acc: 0.688 Test Loss: 0.830 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.408460855484009
Epoch: 4, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
Validation loss decreased (-0.751439 --> -0.774558).  Saving model ...
Epoch: 5 cost time: 5.152257204055786
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.066 Vali Acc: 0.757 Test Loss: 1.066 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.224656105041504
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.267 Vali Acc: 0.757 Test Loss: 1.267 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.105565071105957
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.884 Vali Acc: 0.786 Test Loss: 0.884 Test Acc: 0.786
Validation loss decreased (-0.774558 --> -0.786118).  Saving model ...
Epoch: 8 cost time: 5.351103782653809
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.080 Vali Acc: 0.769 Test Loss: 1.080 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.572412967681885
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.691 Vali Acc: 0.821 Test Loss: 0.691 Test Acc: 0.821
Validation loss decreased (-0.786118 --> -0.820802).  Saving model ...
Epoch: 10 cost time: 5.835025072097778
Epoch: 10, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.904 Vali Acc: 0.815 Test Loss: 0.904 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.39882493019104
Epoch: 11, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.2521913051605225
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
Validation loss decreased (-0.820802 --> -0.843924).  Saving model ...
Epoch: 13 cost time: 5.402929067611694
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.838 Test Loss: 0.674 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.515778064727783
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.850 Test Loss: 0.680 Test Acc: 0.850
Validation loss decreased (-0.843924 --> -0.849704).  Saving model ...
Epoch: 15 cost time: 5.733897686004639
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.844 Test Loss: 0.689 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.6313230991363525
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.844 Test Loss: 0.694 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.380640983581543
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.844 Test Loss: 0.704 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.316391944885254
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.844 Test Loss: 0.708 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.490119218826294
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.760517120361328
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.850 Test Loss: 0.714 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.150577783584595
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.459250211715698
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.5134522914886475
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.5002546310424805
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.855 Test Loss: 0.717 Test Acc: 0.855
Validation loss decreased (-0.849704 --> -0.855484).  Saving model ...
Epoch: 25 cost time: 6.101267099380493
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.855 Test Loss: 0.719 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.4444615840911865
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.861 Test Loss: 0.723 Test Acc: 0.861
Validation loss decreased (-0.855484 --> -0.861264).  Saving model ...
Epoch: 27 cost time: 6.317849636077881
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.861 Test Loss: 0.723 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.294013261795044
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.861 Test Loss: 0.724 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.118715763092041
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.564795732498169
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.861 Test Loss: 0.727 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.61288857460022
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.861 Test Loss: 0.731 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.080408334732056
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.476685047149658
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.855 Test Loss: 0.733 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.443222999572754
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.861 Test Loss: 0.735 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.484395265579224
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.643800735473633
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.87330436706543
Epoch: 1, Steps: 17 | Train Loss: 1.740 Vali Loss: 1.431 Vali Acc: 0.353 Test Loss: 1.431 Test Acc: 0.353
Validation loss decreased (inf --> -0.352587).  Saving model ...
Epoch: 2 cost time: 6.067398309707642
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.352587 --> -0.809243).  Saving model ...
Epoch: 3 cost time: 5.865328073501587
Epoch: 3, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.826 Vali Acc: 0.688 Test Loss: 0.826 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.558516263961792
Epoch: 4, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.638 Vali Acc: 0.780 Test Loss: 0.638 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.924148082733154
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.574 Vali Acc: 0.815 Test Loss: 0.574 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 6 cost time: 7.059598684310913
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.844 Test Loss: 0.489 Test Acc: 0.844
Validation loss decreased (-0.815023 --> -0.843926).  Saving model ...
Epoch: 7 cost time: 6.098138332366943
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.827 Test Loss: 0.612 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.479839563369751
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.832 Test Loss: 0.477 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.865578889846802
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849706).  Saving model ...
Epoch: 10 cost time: 6.887801885604858
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.306502103805542
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.827 Test Loss: 0.472 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.781442642211914
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.827 Test Loss: 0.468 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.656573057174683
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.832 Test Loss: 0.466 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.690823793411255
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.827 Test Loss: 0.467 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.980132102966309
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.827 Test Loss: 0.468 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.498186826705933
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.530784845352173
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.821 Test Loss: 0.475 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.4797375202178955
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.388039588928223
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.33921504020691
Epoch: 1, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.486 Vali Acc: 0.341 Test Loss: 1.486 Test Acc: 0.341
Validation loss decreased (inf --> -0.341026).  Saving model ...
Epoch: 2 cost time: 6.855926275253296
Epoch: 2, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.580 Vali Acc: 0.821 Test Loss: 0.580 Test Acc: 0.821
Validation loss decreased (-0.341026 --> -0.820803).  Saving model ...
Epoch: 3 cost time: 7.241410493850708
Epoch: 3, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.582 Vali Acc: 0.792 Test Loss: 0.582 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.347323417663574
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
Validation loss decreased (-0.820803 --> -0.861268).  Saving model ...
Epoch: 5 cost time: 7.004343271255493
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.478 Vali Acc: 0.827 Test Loss: 0.478 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.806106090545654
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.803 Test Loss: 0.463 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.028003454208374
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.20750880241394
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
Validation loss decreased (-0.861268 --> -0.867048).  Saving model ...
Epoch: 9 cost time: 7.223879098892212
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 10 cost time: 6.592314958572388
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.873 Test Loss: 0.353 Test Acc: 0.873
Validation loss decreased (-0.867048 --> -0.872829).  Saving model ...
Epoch: 11 cost time: 6.621604681015015
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.926726579666138
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.350 Vali Acc: 0.867 Test Loss: 0.350 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.110168695449829
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.867 Test Loss: 0.352 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.15642237663269
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.757386922836304
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.264981031417847
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.315584421157837
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.4870991706848145
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.052345275878906
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.370598077774048
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.352 Vali Acc: 0.867 Test Loss: 0.352 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.248223304748535
Epoch: 1, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.705 Vali Acc: 0.335 Test Loss: 1.705 Test Acc: 0.335
Validation loss decreased (inf --> -0.335243).  Saving model ...
Epoch: 2 cost time: 6.326953649520874
Epoch: 2, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.855 Vali Acc: 0.671 Test Loss: 0.855 Test Acc: 0.671
Validation loss decreased (-0.335243 --> -0.670512).  Saving model ...
Epoch: 3 cost time: 6.325693368911743
Epoch: 3, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.677 Vali Acc: 0.676 Test Loss: 0.677 Test Acc: 0.676
Validation loss decreased (-0.670512 --> -0.676294).  Saving model ...
Epoch: 4 cost time: 6.604070663452148
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.596 Vali Acc: 0.699 Test Loss: 0.596 Test Acc: 0.699
Validation loss decreased (-0.676294 --> -0.699416).  Saving model ...
Epoch: 5 cost time: 6.539290904998779
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.798 Test Loss: 0.525 Test Acc: 0.798
Validation loss decreased (-0.699416 --> -0.797683).  Saving model ...
Epoch: 6 cost time: 7.028344631195068
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.769 Test Loss: 0.472 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.861132383346558
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.798 Test Loss: 0.512 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 8 cost time: 6.715395927429199
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
Validation loss decreased (-0.797683 --> -0.849707).  Saving model ...
Epoch: 9 cost time: 6.759457111358643
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
Validation loss decreased (-0.849707 --> -0.855487).  Saving model ...
Epoch: 10 cost time: 6.400394916534424
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 6.582336664199829
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 12 cost time: 6.5339744091033936
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.412349462509155
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.495694160461426
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.9788408279418945
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.490771532058716
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.838 Test Loss: 0.426 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.336635589599609
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.617291688919067
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.445761203765869
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 20 cost time: 6.974281072616577
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 21 cost time: 7.187182903289795
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 22 cost time: 7.070624351501465
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.861 Test Loss: 0.415 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.673511981964111
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 24 cost time: 6.273446798324585
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.861 Test Loss: 0.408 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 25 cost time: 6.535250902175903
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 26 cost time: 6.506234884262085
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.861 Test Loss: 0.403 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 27 cost time: 6.485217809677124
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 28 cost time: 6.846694469451904
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 29 cost time: 6.6896445751190186
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 30 cost time: 6.55456280708313
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.6311869621276855
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.808185338973999
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 33 cost time: 6.7262656688690186
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.511164426803589
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.362991809844971
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 36 cost time: 6.635205984115601
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 37 cost time: 6.49793004989624
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 38 cost time: 5.9749109745025635
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.342474460601807
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.852956295013428
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.861 Test Loss: 0.393 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 7.089598894119263
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.79797101020813
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 6.575691223144531
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.861 Test Loss: 0.391 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.33517861366272
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.861 Test Loss: 0.390 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 45 cost time: 6.981969356536865
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 46 cost time: 6.576228380203247
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 47 cost time: 6.433562755584717
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 48 cost time: 6.443784952163696
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.861 Test Loss: 0.383 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.237450122833252
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.0601019859313965
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.861 Test Loss: 0.384 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.527996778488159
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 52 cost time: 6.858639240264893
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 53 cost time: 6.771793603897095
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 7.16066312789917
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 6.713633298873901
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 6.4045350551605225
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 6.727770805358887
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 58 cost time: 6.834979772567749
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 6.306380987167358
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 6.297049045562744
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.861 Test Loss: 0.380 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 6.542098760604858
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 6.461632490158081
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 5.723863124847412
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 6.645589828491211
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 6.700207233428955
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.861 Test Loss: 0.378 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 66 cost time: 6.532944917678833
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 67 cost time: 7.000385522842407
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.861 Test Loss: 0.376 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 68 cost time: 6.949286460876465
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.861 Test Loss: 0.374 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 69 cost time: 6.587936162948608
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.224436521530151
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.352652072906494
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 6.334882736206055
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 5.947016000747681
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 6.201704502105713
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 6.321321249008179
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 6.570157051086426
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.861 Test Loss: 0.373 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 77 cost time: 6.651894569396973
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 6.8601295948028564
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 6.892284154891968
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 6.843972206115723
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.850 Test Loss: 0.374 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 6.918531656265259
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 6.816666603088379
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 6.670473575592041
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.850 Test Loss: 0.372 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 6.316475868225098
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 6.066959619522095
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 6.5531909465789795
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.850 Test Loss: 0.369 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.400854349136353
Epoch: 1, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.727 Vali Acc: 0.364 Test Loss: 1.727 Test Acc: 0.364
Validation loss decreased (inf --> -0.364145).  Saving model ...
Epoch: 2 cost time: 6.689500570297241
Epoch: 2, Steps: 17 | Train Loss: 0.990 Vali Loss: 0.909 Vali Acc: 0.705 Test Loss: 0.909 Test Acc: 0.705
Validation loss decreased (-0.364145 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 6.952146530151367
Epoch: 3, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.823 Vali Acc: 0.613 Test Loss: 0.823 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.800382852554321
Epoch: 4, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.684 Vali Acc: 0.682 Test Loss: 0.684 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.957830905914307
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.638 Vali Acc: 0.723 Test Loss: 0.638 Test Acc: 0.723
Validation loss decreased (-0.705193 --> -0.722537).  Saving model ...
Epoch: 6 cost time: 6.4905219078063965
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
Validation loss decreased (-0.722537 --> -0.780341).  Saving model ...
Epoch: 7 cost time: 6.4052557945251465
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.780 Test Loss: 0.571 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.597349405288696
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.780 Test Loss: 0.535 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 9 cost time: 6.615694284439087
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.798 Test Loss: 0.537 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 6.214902877807617
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.769 Test Loss: 0.537 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.719534873962402
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.798 Test Loss: 0.531 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797683).  Saving model ...
Epoch: 12 cost time: 6.950315475463867
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 6.736467599868774
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.798 Test Loss: 0.533 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.744026184082031
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 6.908294439315796
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.076949596405029
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.928490161895752
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.652506113052368
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.821 Test Loss: 0.514 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 19 cost time: 5.847973823547363
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.511496305465698
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.798 Test Loss: 0.515 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.81793999671936
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.275730848312378
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.9601922035217285
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.966755628585815
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.798 Test Loss: 0.510 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.594330310821533
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.798 Test Loss: 0.513 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.636281967163086
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.572962284088135
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.985082149505615
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.798 Test Loss: 0.504 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.00522780418396
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.811 Vali Acc: 0.370 Test Loss: 1.811 Test Acc: 0.370
Validation loss decreased (inf --> -0.369924).  Saving model ...
Epoch: 2 cost time: 6.628662109375
Epoch: 2, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.018 Vali Acc: 0.659 Test Loss: 1.018 Test Acc: 0.659
Validation loss decreased (-0.369924 --> -0.658949).  Saving model ...
Epoch: 3 cost time: 6.261293172836304
Epoch: 3, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.866 Vali Acc: 0.618 Test Loss: 0.866 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.884370803833008
Epoch: 4, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.802 Vali Acc: 0.642 Test Loss: 0.802 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.87724232673645
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.590 Vali Acc: 0.734 Test Loss: 0.590 Test Acc: 0.734
Validation loss decreased (-0.658949 --> -0.734098).  Saving model ...
Epoch: 6 cost time: 6.955811262130737
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.664 Vali Acc: 0.694 Test Loss: 0.664 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.860839605331421
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.723 Test Loss: 0.584 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.4275312423706055
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.711 Test Loss: 0.571 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.486246585845947
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.958825588226318
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.682 Test Loss: 0.600 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.726829290390015
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.472563743591309
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.705 Test Loss: 0.579 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.090444803237915
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.705 Test Loss: 0.575 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.721348762512207
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.723 Test Loss: 0.560 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.509950876235962
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.728 Test Loss: 0.556 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7341040462427746
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.324318408966064
Epoch: 1, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.852 Vali Acc: 0.329 Test Loss: 1.852 Test Acc: 0.329
Validation loss decreased (inf --> -0.329461).  Saving model ...
Epoch: 2 cost time: 6.767609596252441
Epoch: 2, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.067 Vali Acc: 0.647 Test Loss: 1.067 Test Acc: 0.647
Validation loss decreased (-0.329461 --> -0.647388).  Saving model ...
Epoch: 3 cost time: 7.02587366104126
Epoch: 3, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.795 Vali Acc: 0.618 Test Loss: 0.795 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.7269322872161865
Epoch: 4, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.823 Vali Acc: 0.682 Test Loss: 0.823 Test Acc: 0.682
Validation loss decreased (-0.647388 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 6.375846862792969
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.642 Vali Acc: 0.682 Test Loss: 0.642 Test Acc: 0.682
Validation loss decreased (-0.682073 --> -0.682075).  Saving model ...
Epoch: 6 cost time: 6.713958501815796
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.688 Vali Acc: 0.728 Test Loss: 0.688 Test Acc: 0.728
Validation loss decreased (-0.682075 --> -0.728317).  Saving model ...
Epoch: 7 cost time: 7.023833751678467
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.490 Vali Acc: 0.792 Test Loss: 0.490 Test Acc: 0.792
Validation loss decreased (-0.728317 --> -0.791903).  Saving model ...
Epoch: 8 cost time: 6.3630194664001465
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.792 Test Loss: 0.508 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.450972080230713
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.769 Test Loss: 0.536 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.6227076053619385
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.769 Test Loss: 0.502 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.789777755737305
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.821 Test Loss: 0.494 Test Acc: 0.821
Validation loss decreased (-0.791903 --> -0.820804).  Saving model ...
Epoch: 12 cost time: 7.1246702671051025
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.107723712921143
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.798 Test Loss: 0.502 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.3007142543792725
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.972984075546265
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.827 Test Loss: 0.484 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 16 cost time: 6.801727771759033
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.235688924789429
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.786 Test Loss: 0.490 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.562661409378052
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.798 Test Loss: 0.479 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.465862989425659
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.792 Test Loss: 0.493 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.308281421661377
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.9234559535980225
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.815 Test Loss: 0.503 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.284160137176514
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.780 Test Loss: 0.499 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.572458505630493
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.775 Test Loss: 0.494 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.937765598297119
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.769 Test Loss: 0.496 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.677526473999023
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.815 Test Loss: 0.488 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.95589017868042
Epoch: 1, Steps: 17 | Train Loss: 1.947 Vali Loss: 1.885 Vali Acc: 0.312 Test Loss: 1.885 Test Acc: 0.312
Validation loss decreased (inf --> -0.312120).  Saving model ...
Epoch: 2 cost time: 6.695561170578003
Epoch: 2, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.100 Vali Acc: 0.636 Test Loss: 1.100 Test Acc: 0.636
Validation loss decreased (-0.312120 --> -0.635827).  Saving model ...
Epoch: 3 cost time: 6.68482780456543
Epoch: 3, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.830 Vali Acc: 0.624 Test Loss: 0.830 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.265953063964844
Epoch: 4, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.789 Vali Acc: 0.671 Test Loss: 0.789 Test Acc: 0.671
Validation loss decreased (-0.635827 --> -0.670512).  Saving model ...
Epoch: 5 cost time: 6.822958707809448
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.648 Vali Acc: 0.688 Test Loss: 0.648 Test Acc: 0.688
Validation loss decreased (-0.670512 --> -0.687855).  Saving model ...
Epoch: 6 cost time: 6.794541835784912
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
Validation loss decreased (-0.687855 --> -0.763001).  Saving model ...
Epoch: 7 cost time: 6.77204155921936
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.734 Test Loss: 0.590 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.607489585876465
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
Validation loss decreased (-0.763001 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 6.840906858444214
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.780 Test Loss: 0.542 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.814292907714844
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.077923774719238
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.780 Test Loss: 0.496 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.726937770843506
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.792 Test Loss: 0.495 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.558609485626221
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.780 Test Loss: 0.501 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.6082940101623535
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.786 Test Loss: 0.504 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.491103410720825
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.792 Test Loss: 0.489 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.7212090492248535
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.780 Test Loss: 0.482 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.638628721237183
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.786 Test Loss: 0.494 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.636203289031982
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.780 Test Loss: 0.485 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.499127626419067
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 6.831585645675659
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.723174810409546
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.60443377494812
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.340332984924316
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.221938133239746
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.326431035995483
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.402585506439209
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.196460962295532
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.214951038360596
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.70700740814209
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.17341040462427745
model parameter : 18797575
model size : 91.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.942511558532715
Epoch: 1, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.043 Vali Acc: 0.676 Test Loss: 1.043 Test Acc: 0.676
Validation loss decreased (inf --> -0.676290).  Saving model ...
Epoch: 2 cost time: 6.556854724884033
Epoch: 2, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.786 Vali Acc: 0.688 Test Loss: 0.786 Test Acc: 0.688
Validation loss decreased (-0.676290 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 6.584839820861816
Epoch: 3, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
Validation loss decreased (-0.687853 --> -0.803462).  Saving model ...
Epoch: 4 cost time: 6.4931604862213135
Epoch: 4, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.662 Vali Acc: 0.780 Test Loss: 0.662 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.545030355453491
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.437052965164185
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.039161205291748
Epoch: 7, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.800 Vali Acc: 0.827 Test Loss: 0.800 Test Acc: 0.827
Validation loss decreased (-0.803462 --> -0.826582).  Saving model ...
Epoch: 8 cost time: 5.76278281211853
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.824 Vali Acc: 0.809 Test Loss: 0.824 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.200608491897583
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
Validation loss decreased (-0.826582 --> -0.855486).  Saving model ...
Epoch: 10 cost time: 6.584018230438232
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.651 Vali Acc: 0.821 Test Loss: 0.651 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.53439736366272
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.821 Test Loss: 0.629 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.683375358581543
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.318 Vali Acc: 0.798 Test Loss: 1.318 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.959576845169067
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.407 Vali Acc: 0.769 Test Loss: 1.407 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.720282793045044
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.128 Vali Acc: 0.821 Test Loss: 1.128 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.497694253921509
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.285 Vali Acc: 0.786 Test Loss: 1.285 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.990795850753784
Epoch: 16, Steps: 17 | Train Loss: 0.060 Vali Loss: 2.061 Vali Acc: 0.757 Test Loss: 2.061 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.222403287887573
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 2.092 Vali Acc: 0.734 Test Loss: 2.092 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.339693784713745
Epoch: 18, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.425 Vali Acc: 0.740 Test Loss: 2.425 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.266595363616943
Epoch: 19, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.869 Vali Acc: 0.688 Test Loss: 2.869 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.982885122299194
Epoch: 1, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.064 Vali Acc: 0.642 Test Loss: 1.064 Test Acc: 0.642
Validation loss decreased (inf --> -0.641608).  Saving model ...
Epoch: 2 cost time: 6.243064880371094
Epoch: 2, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.641608 --> -0.716756).  Saving model ...
Epoch: 3 cost time: 6.791138648986816
Epoch: 3, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.686 Vali Acc: 0.780 Test Loss: 0.686 Test Acc: 0.780
Validation loss decreased (-0.716756 --> -0.780340).  Saving model ...
Epoch: 4 cost time: 6.290520668029785
Epoch: 4, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.640 Vali Acc: 0.798 Test Loss: 0.640 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797681).  Saving model ...
Epoch: 5 cost time: 6.537433385848999
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
Validation loss decreased (-0.797681 --> -0.838145).  Saving model ...
Epoch: 6 cost time: 6.361043453216553
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.667 Vali Acc: 0.827 Test Loss: 0.667 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.55692720413208
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.639 Vali Acc: 0.827 Test Loss: 0.639 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.601259231567383
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849706).  Saving model ...
Epoch: 9 cost time: 6.604797124862671
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.781 Vali Acc: 0.815 Test Loss: 0.781 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.936469316482544
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.953 Vali Acc: 0.803 Test Loss: 0.953 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.560997724533081
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.677 Vali Acc: 0.832 Test Loss: 0.677 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.182458162307739
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.948 Vali Acc: 0.809 Test Loss: 0.948 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.917069435119629
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.052 Vali Acc: 0.769 Test Loss: 1.052 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.564113140106201
Epoch: 14, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.797 Vali Acc: 0.757 Test Loss: 1.797 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.634661674499512
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.517 Vali Acc: 0.803 Test Loss: 1.517 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.763838529586792
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.951 Vali Acc: 0.798 Test Loss: 1.951 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.468703985214233
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 3.164 Vali Acc: 0.740 Test Loss: 3.164 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.910443544387817
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 3.996 Vali Acc: 0.746 Test Loss: 3.996 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.875699043273926
Epoch: 1, Steps: 17 | Train Loss: 1.672 Vali Loss: 1.091 Vali Acc: 0.636 Test Loss: 1.091 Test Acc: 0.636
Validation loss decreased (inf --> -0.635827).  Saving model ...
Epoch: 2 cost time: 6.395594835281372
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.738 Vali Acc: 0.763 Test Loss: 0.738 Test Acc: 0.763
Validation loss decreased (-0.635827 --> -0.762998).  Saving model ...
Epoch: 3 cost time: 6.13152289390564
Epoch: 3, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.604 Vali Acc: 0.780 Test Loss: 0.604 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780341).  Saving model ...
Epoch: 4 cost time: 6.3525896072387695
Epoch: 4, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.508 Vali Acc: 0.821 Test Loss: 0.508 Test Acc: 0.821
Validation loss decreased (-0.780341 --> -0.820804).  Saving model ...
Epoch: 5 cost time: 6.732404470443726
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.472 Vali Acc: 0.803 Test Loss: 0.472 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.594768524169922
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.2001118659973145
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.815 Test Loss: 0.499 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.457321405410767
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.316683292388916
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.084228038787842
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.995240926742554
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.798 Test Loss: 0.474 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.457813739776611
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820805).  Saving model ...
Epoch: 13 cost time: 6.068866968154907
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.832 Test Loss: 0.471 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 14 cost time: 6.083910703659058
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.827 Test Loss: 0.468 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.316349506378174
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.838 Test Loss: 0.467 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 16 cost time: 6.581963062286377
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.838 Test Loss: 0.467 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 17 cost time: 6.897031307220459
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.825321912765503
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 19 cost time: 6.921580791473389
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 20 cost time: 6.702626943588257
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.293169736862183
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.832 Test Loss: 0.458 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.517951011657715
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.500549793243408
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.832 Test Loss: 0.459 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.627737998962402
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.838 Test Loss: 0.461 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.315215349197388
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.553779363632202
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.838 Test Loss: 0.461 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.3126914501190186
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.450263023376465
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.674432992935181
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.838 Test Loss: 0.458 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.296486854553223
Epoch: 1, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.224 Vali Acc: 0.561 Test Loss: 1.224 Test Acc: 0.561
Validation loss decreased (inf --> -0.560681).  Saving model ...
Epoch: 2 cost time: 6.281310319900513
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.684 Vali Acc: 0.792 Test Loss: 0.684 Test Acc: 0.792
Validation loss decreased (-0.560681 --> -0.791901).  Saving model ...
Epoch: 3 cost time: 5.931025981903076
Epoch: 3, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.445 Vali Acc: 0.809 Test Loss: 0.445 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809244).  Saving model ...
Epoch: 4 cost time: 6.042066335678101
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.838 Test Loss: 0.446 Test Acc: 0.838
Validation loss decreased (-0.809244 --> -0.838146).  Saving model ...
Epoch: 5 cost time: 6.2376251220703125
Epoch: 5, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849706).  Saving model ...
Epoch: 6 cost time: 6.199432849884033
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.292739152908325
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.827 Test Loss: 0.462 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.562358856201172
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.694238662719727
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.821 Test Loss: 0.476 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.427879810333252
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.3496177196502686
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.821 Test Loss: 0.459 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.246499538421631
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.821 Test Loss: 0.459 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.210163831710815
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.821 Test Loss: 0.455 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.413247346878052
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.821 Test Loss: 0.453 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.043960332870483
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.821 Test Loss: 0.448 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.720542907714844
Epoch: 1, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.554 Vali Acc: 0.451 Test Loss: 1.554 Test Acc: 0.451
Validation loss decreased (inf --> -0.450852).  Saving model ...
Epoch: 2 cost time: 5.795762062072754
Epoch: 2, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.868 Vali Acc: 0.659 Test Loss: 0.868 Test Acc: 0.659
Validation loss decreased (-0.450852 --> -0.658951).  Saving model ...
Epoch: 3 cost time: 6.345522403717041
Epoch: 3, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.581 Vali Acc: 0.798 Test Loss: 0.581 Test Acc: 0.798
Validation loss decreased (-0.658951 --> -0.797682).  Saving model ...
Epoch: 4 cost time: 6.318026542663574
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.527 Vali Acc: 0.821 Test Loss: 0.527 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820804).  Saving model ...
Epoch: 5 cost time: 5.406991720199585
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.566 Vali Acc: 0.769 Test Loss: 0.566 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.988369703292847
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.820804 --> -0.849706).  Saving model ...
Epoch: 7 cost time: 6.392068147659302
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.238170385360718
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.390046834945679
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.075948476791382
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.838 Test Loss: 0.466 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.037720203399658
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
Validation loss decreased (-0.849706 --> -0.867047).  Saving model ...
Epoch: 12 cost time: 6.007495164871216
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.035628318786621
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.844 Test Loss: 0.457 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.452120780944824
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.340515851974487
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.873 Test Loss: 0.446 Test Acc: 0.873
Validation loss decreased (-0.867047 --> -0.872828).  Saving model ...
Epoch: 16 cost time: 6.469268321990967
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.153018474578857
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.151098012924194
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.873 Test Loss: 0.442 Test Acc: 0.873
Validation loss decreased (-0.872828 --> -0.872828).  Saving model ...
Epoch: 19 cost time: 6.220911026000977
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.123719930648804
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.193662643432617
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.345837831497192
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.867 Test Loss: 0.437 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.077109098434448
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.873 Test Loss: 0.433 Test Acc: 0.873
Validation loss decreased (-0.872828 --> -0.872828).  Saving model ...
Epoch: 24 cost time: 5.919001579284668
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.078876972198486
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.092172384262085
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.4194207191467285
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.398144483566284
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.873 Test Loss: 0.423 Test Acc: 0.873
Validation loss decreased (-0.872828 --> -0.872828).  Saving model ...
Epoch: 29 cost time: 6.077120780944824
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.867 Test Loss: 0.424 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.017590522766113
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.867 Test Loss: 0.429 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.678194761276245
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.983681678771973
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.210258722305298
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 6.076571226119995
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.867 Test Loss: 0.421 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.951401948928833
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.127227067947388
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 6.107383728027344
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.802692890167236
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.867 Test Loss: 0.411 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.388113737106323
Epoch: 1, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.692 Vali Acc: 0.387 Test Loss: 1.692 Test Acc: 0.387
Validation loss decreased (inf --> -0.387266).  Saving model ...
Epoch: 2 cost time: 6.197159767150879
Epoch: 2, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.049 Vali Acc: 0.584 Test Loss: 1.049 Test Acc: 0.584
Validation loss decreased (-0.387266 --> -0.583805).  Saving model ...
Epoch: 3 cost time: 6.131800413131714
Epoch: 3, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
Validation loss decreased (-0.583805 --> -0.716756).  Saving model ...
Epoch: 4 cost time: 6.196333646774292
Epoch: 4, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.736 Vali Acc: 0.723 Test Loss: 0.736 Test Acc: 0.723
Validation loss decreased (-0.716756 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 6.163438081741333
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.685 Vali Acc: 0.671 Test Loss: 0.685 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.1052796840667725
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.728 Test Loss: 0.623 Test Acc: 0.728
Validation loss decreased (-0.722536 --> -0.728317).  Saving model ...
Epoch: 7 cost time: 6.158074378967285
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.815 Test Loss: 0.534 Test Acc: 0.815
Validation loss decreased (-0.728317 --> -0.815024).  Saving model ...
Epoch: 8 cost time: 5.939987421035767
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.786 Test Loss: 0.560 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.635565757751465
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.769 Test Loss: 0.572 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.629001617431641
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.769 Test Loss: 0.541 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.869153738021851
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.775 Test Loss: 0.535 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.088365793228149
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.780 Test Loss: 0.546 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.348902225494385
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.786 Test Loss: 0.541 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.263079643249512
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.786 Test Loss: 0.541 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.191998481750488
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.300364255905151
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.775 Test Loss: 0.530 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.36777925491333
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.786 Test Loss: 0.531 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.714212656021118
Epoch: 1, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.820 Vali Acc: 0.289 Test Loss: 1.820 Test Acc: 0.289
Validation loss decreased (inf --> -0.288999).  Saving model ...
Epoch: 2 cost time: 6.37933874130249
Epoch: 2, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.226 Vali Acc: 0.618 Test Loss: 1.226 Test Acc: 0.618
Validation loss decreased (-0.288999 --> -0.618485).  Saving model ...
Epoch: 3 cost time: 6.022787809371948
Epoch: 3, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.780 Vali Acc: 0.682 Test Loss: 0.780 Test Acc: 0.682
Validation loss decreased (-0.618485 --> -0.682073).  Saving model ...
Epoch: 4 cost time: 5.81581449508667
Epoch: 4, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.804 Vali Acc: 0.676 Test Loss: 0.804 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.840608835220337
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.653 Vali Acc: 0.705 Test Loss: 0.653 Test Acc: 0.705
Validation loss decreased (-0.682073 --> -0.705196).  Saving model ...
Epoch: 6 cost time: 6.050779819488525
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.697 Vali Acc: 0.665 Test Loss: 0.697 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.11768651008606
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.740 Test Loss: 0.569 Test Acc: 0.740
Validation loss decreased (-0.705196 --> -0.739879).  Saving model ...
Epoch: 8 cost time: 6.062138795852661
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.751 Test Loss: 0.599 Test Acc: 0.751
Validation loss decreased (-0.739879 --> -0.751439).  Saving model ...
Epoch: 9 cost time: 6.676342248916626
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.769 Test Loss: 0.575 Test Acc: 0.769
Validation loss decreased (-0.751439 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 6.210001707077026
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.763 Test Loss: 0.565 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.874969482421875
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774561).  Saving model ...
Epoch: 12 cost time: 6.055382013320923
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.775 Test Loss: 0.562 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 13 cost time: 6.105993270874023
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.769 Test Loss: 0.560 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.694525957107544
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 15 cost time: 6.423412322998047
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 16 cost time: 6.1161274909973145
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.786 Test Loss: 0.531 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 17 cost time: 6.162852764129639
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.837044954299927
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.446263313293457
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.775 Test Loss: 0.537 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.278226137161255
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.775 Test Loss: 0.540 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.271615028381348
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.57338285446167
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.774062395095825
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.224191188812256
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.769 Test Loss: 0.527 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.232070207595825
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.763 Test Loss: 0.536 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.88210916519165
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.769 Test Loss: 0.532 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.154976844787598
Epoch: 1, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.818 Vali Acc: 0.306 Test Loss: 1.818 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 5.990022659301758
Epoch: 2, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.285 Vali Acc: 0.595 Test Loss: 1.285 Test Acc: 0.595
Validation loss decreased (-0.306340 --> -0.595363).  Saving model ...
Epoch: 3 cost time: 6.335951566696167
Epoch: 3, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.901 Vali Acc: 0.636 Test Loss: 0.901 Test Acc: 0.636
Validation loss decreased (-0.595363 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 6.431720733642578
Epoch: 4, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.790 Vali Acc: 0.642 Test Loss: 0.790 Test Acc: 0.642
Validation loss decreased (-0.635829 --> -0.641611).  Saving model ...
Epoch: 5 cost time: 6.377122640609741
Epoch: 5, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.798 Vali Acc: 0.647 Test Loss: 0.798 Test Acc: 0.647
Validation loss decreased (-0.641611 --> -0.647391).  Saving model ...
Epoch: 6 cost time: 6.463283061981201
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.734 Test Loss: 0.627 Test Acc: 0.734
Validation loss decreased (-0.647391 --> -0.734098).  Saving model ...
Epoch: 7 cost time: 6.172046184539795
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
Validation loss decreased (-0.734098 --> -0.774560).  Saving model ...
Epoch: 8 cost time: 6.002513647079468
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.769 Test Loss: 0.572 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.293788909912109
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.711 Test Loss: 0.624 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.386773109436035
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.734 Test Loss: 0.592 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.495954275131226
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.740 Test Loss: 0.591 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.302450180053711
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.751 Test Loss: 0.580 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.148304224014282
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.004229545593262
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.740 Test Loss: 0.578 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.300595760345459
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.746 Test Loss: 0.575 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.22214150428772
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.751 Test Loss: 0.553 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.670787811279297
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.294302463531494
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.807 Vali Acc: 0.295 Test Loss: 1.807 Test Acc: 0.295
Validation loss decreased (inf --> -0.294780).  Saving model ...
Epoch: 2 cost time: 6.464760780334473
Epoch: 2, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.247 Vali Acc: 0.601 Test Loss: 1.247 Test Acc: 0.601
Validation loss decreased (-0.294780 --> -0.601144).  Saving model ...
Epoch: 3 cost time: 6.333143949508667
Epoch: 3, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.851 Vali Acc: 0.642 Test Loss: 0.851 Test Acc: 0.642
Validation loss decreased (-0.601144 --> -0.641610).  Saving model ...
Epoch: 4 cost time: 6.480211973190308
Epoch: 4, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.707 Vali Acc: 0.711 Test Loss: 0.707 Test Acc: 0.711
Validation loss decreased (-0.641610 --> -0.710976).  Saving model ...
Epoch: 5 cost time: 6.152350664138794
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.670 Vali Acc: 0.694 Test Loss: 0.670 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.5922322273254395
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
Validation loss decreased (-0.710976 --> -0.751439).  Saving model ...
Epoch: 7 cost time: 6.859016180038452
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.775 Test Loss: 0.591 Test Acc: 0.775
Validation loss decreased (-0.751439 --> -0.774561).  Saving model ...
Epoch: 8 cost time: 6.723058462142944
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.769 Test Loss: 0.511 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.755214214324951
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.734 Test Loss: 0.544 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.532304286956787
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.769 Test Loss: 0.531 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.444918632507324
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.780 Test Loss: 0.515 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780342).  Saving model ...
Epoch: 12 cost time: 6.156089782714844
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.757 Test Loss: 0.521 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.410914659500122
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.757 Test Loss: 0.510 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.790576934814453
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.769 Test Loss: 0.520 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.594985008239746
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.780 Test Loss: 0.515 Test Acc: 0.780
Validation loss decreased (-0.780342 --> -0.780342).  Saving model ...
Epoch: 16 cost time: 6.611119508743286
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.780 Test Loss: 0.490 Test Acc: 0.780
Validation loss decreased (-0.780342 --> -0.780342).  Saving model ...
Epoch: 17 cost time: 6.351859092712402
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.780 Test Loss: 0.488 Test Acc: 0.780
Validation loss decreased (-0.780342 --> -0.780342).  Saving model ...
Epoch: 18 cost time: 6.354365587234497
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.775 Test Loss: 0.506 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.849912643432617
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.775 Test Loss: 0.508 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.439182281494141
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.775 Test Loss: 0.510 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.45294451713562
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.763 Test Loss: 0.486 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.351392030715942
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.763 Test Loss: 0.499 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.475201845169067
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.757 Test Loss: 0.496 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.6216607093811035
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.757 Test Loss: 0.494 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.861328840255737
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.763 Test Loss: 0.498 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.365344762802124
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.792 Test Loss: 0.487 Test Acc: 0.792
Validation loss decreased (-0.780342 --> -0.791903).  Saving model ...
Epoch: 27 cost time: 6.435588359832764
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.769 Test Loss: 0.490 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.555489540100098
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.780 Test Loss: 0.482 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.445286750793457
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.786 Test Loss: 0.488 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.191253662109375
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.792 Test Loss: 0.484 Test Acc: 0.792
Validation loss decreased (-0.791903 --> -0.791903).  Saving model ...
Epoch: 31 cost time: 6.5737221240997314
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.786 Test Loss: 0.480 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.788305997848511
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.792 Test Loss: 0.478 Test Acc: 0.792
Validation loss decreased (-0.791903 --> -0.791903).  Saving model ...
Epoch: 33 cost time: 6.435398101806641
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.792 Test Loss: 0.478 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.010359764099121
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.792 Test Loss: 0.476 Test Acc: 0.792
Validation loss decreased (-0.791903 --> -0.791903).  Saving model ...
Epoch: 35 cost time: 6.579085111618042
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.780 Test Loss: 0.485 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.401946067810059
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.792 Test Loss: 0.479 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.519320249557495
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
Validation loss decreased (-0.791903 --> -0.803463).  Saving model ...
Epoch: 38 cost time: 6.487333059310913
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.803 Test Loss: 0.472 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.343050956726074
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803464).  Saving model ...
Epoch: 40 cost time: 6.049577713012695
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.792 Test Loss: 0.470 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.667539834976196
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.792 Test Loss: 0.471 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 6.518935918807983
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.3514909744262695
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
Validation loss decreased (-0.803464 --> -0.815024).  Saving model ...
Epoch: 44 cost time: 6.089085340499878
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.656392574310303
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.798 Test Loss: 0.481 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.198156356811523
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.798 Test Loss: 0.479 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 6.406412124633789
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.815 Test Loss: 0.475 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 6.478783845901489
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.798 Test Loss: 0.477 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 6.530657052993774
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.798 Test Loss: 0.479 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 6.693437576293945
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 6.4400269985198975
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 6.343141078948975
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 6.503948926925659
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.609915494918823
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
Validation loss decreased (inf --> -0.127148).  Saving model ...
Epoch: 2 cost time: 5.901119947433472
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.148479461669922
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.126797437667847
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.364424705505371
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.044531583786011
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.099650859832764
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.003643751144409
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.646459341049194
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.028011322021484
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.577437400817871
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.12716763005780346
model parameter : 15651847
model size : 79.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.535011529922485
Epoch: 1, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.093 Vali Acc: 0.613 Test Loss: 1.093 Test Acc: 0.613
Validation loss decreased (inf --> -0.612706).  Saving model ...
Epoch: 2 cost time: 6.587128162384033
Epoch: 2, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.859 Vali Acc: 0.728 Test Loss: 0.859 Test Acc: 0.728
Validation loss decreased (-0.612706 --> -0.728315).  Saving model ...
Epoch: 3 cost time: 6.924832820892334
Epoch: 3, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.710 Vali Acc: 0.751 Test Loss: 0.710 Test Acc: 0.751
Validation loss decreased (-0.728315 --> -0.751438).  Saving model ...
Epoch: 4 cost time: 6.900604248046875
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.885 Vali Acc: 0.757 Test Loss: 0.885 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 6.702290058135986
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
Validation loss decreased (-0.757217 --> -0.803463).  Saving model ...
Epoch: 6 cost time: 6.8418214321136475
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.802 Vali Acc: 0.792 Test Loss: 0.802 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.725921392440796
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.100 Vali Acc: 0.775 Test Loss: 1.100 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.831610202789307
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.181 Vali Acc: 0.803 Test Loss: 1.181 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.417091608047485
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.619 Vali Acc: 0.798 Test Loss: 0.619 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.378392696380615
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.742 Vali Acc: 0.798 Test Loss: 0.742 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.61579704284668
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.803 Test Loss: 0.664 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.453004598617554
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.786 Test Loss: 0.711 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.754083871841431
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.701 Vali Acc: 0.815 Test Loss: 0.701 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815022).  Saving model ...
Epoch: 14 cost time: 6.990313529968262
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.784 Vali Acc: 0.832 Test Loss: 0.784 Test Acc: 0.832
Validation loss decreased (-0.815022 --> -0.832362).  Saving model ...
Epoch: 15 cost time: 6.540044069290161
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.471 Vali Acc: 0.775 Test Loss: 1.471 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.308485269546509
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.108 Vali Acc: 0.809 Test Loss: 1.108 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.285943031311035
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.288 Vali Acc: 0.757 Test Loss: 1.288 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.28094220161438
Epoch: 18, Steps: 17 | Train Loss: 0.127 Vali Loss: 2.001 Vali Acc: 0.751 Test Loss: 2.001 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.042989253997803
Epoch: 19, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.919 Vali Acc: 0.775 Test Loss: 1.919 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.109788656234741
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 3.907 Vali Acc: 0.682 Test Loss: 3.907 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.278210878372192
Epoch: 21, Steps: 17 | Train Loss: 0.128 Vali Loss: 2.334 Vali Acc: 0.757 Test Loss: 2.334 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.311197519302368
Epoch: 22, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.075 Vali Acc: 0.855 Test Loss: 1.075 Test Acc: 0.855
Validation loss decreased (-0.832362 --> -0.855481).  Saving model ...
Epoch: 23 cost time: 6.068537473678589
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.564 Vali Acc: 0.792 Test Loss: 2.564 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.431805372238159
Epoch: 24, Steps: 17 | Train Loss: 0.160 Vali Loss: 2.196 Vali Acc: 0.809 Test Loss: 2.196 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.842766284942627
Epoch: 25, Steps: 17 | Train Loss: 0.216 Vali Loss: 6.777 Vali Acc: 0.694 Test Loss: 6.777 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.375230073928833
Epoch: 26, Steps: 17 | Train Loss: 0.777 Vali Loss: 4.605 Vali Acc: 0.786 Test Loss: 4.605 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.4251415729522705
Epoch: 27, Steps: 17 | Train Loss: 0.203 Vali Loss: 3.788 Vali Acc: 0.792 Test Loss: 3.788 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.1707117557525635
Epoch: 28, Steps: 17 | Train Loss: 0.094 Vali Loss: 3.191 Vali Acc: 0.821 Test Loss: 3.191 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.300316572189331
Epoch: 29, Steps: 17 | Train Loss: 0.141 Vali Loss: 5.360 Vali Acc: 0.792 Test Loss: 5.360 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.273974180221558
Epoch: 30, Steps: 17 | Train Loss: 0.133 Vali Loss: 3.585 Vali Acc: 0.803 Test Loss: 3.585 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.923894166946411
Epoch: 31, Steps: 17 | Train Loss: 0.264 Vali Loss: 2.281 Vali Acc: 0.815 Test Loss: 2.281 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.958022356033325
Epoch: 32, Steps: 17 | Train Loss: 0.166 Vali Loss: 3.866 Vali Acc: 0.780 Test Loss: 3.866 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.261928558349609
Epoch: 1, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.055 Vali Acc: 0.613 Test Loss: 1.055 Test Acc: 0.613
Validation loss decreased (inf --> -0.612706).  Saving model ...
Epoch: 2 cost time: 6.218433618545532
Epoch: 2, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
Validation loss decreased (-0.612706 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 6.188807487487793
Epoch: 3, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.584 Vali Acc: 0.780 Test Loss: 0.584 Test Acc: 0.780
Validation loss decreased (-0.716755 --> -0.780341).  Saving model ...
Epoch: 4 cost time: 5.871520519256592
Epoch: 4, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.999 Vali Acc: 0.734 Test Loss: 0.999 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.584433555603027
Epoch: 5, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.546 Vali Acc: 0.798 Test Loss: 0.546 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797682).  Saving model ...
Epoch: 6 cost time: 5.9273107051849365
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.836 Vali Acc: 0.780 Test Loss: 0.836 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.300560712814331
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.801 Vali Acc: 0.780 Test Loss: 0.801 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.190903902053833
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
Validation loss decreased (-0.797682 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 6.1476356983184814
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.815 Test Loss: 0.531 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.825433015823364
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.879 Test Loss: 0.409 Test Acc: 0.879
Validation loss decreased (-0.843926 --> -0.878609).  Saving model ...
Epoch: 11 cost time: 5.420305967330933
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.873 Test Loss: 0.387 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.11078953742981
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.879 Test Loss: 0.376 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 13 cost time: 6.317032814025879
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.873 Test Loss: 0.366 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.154435157775879
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.262695789337158
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.939263343811035
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.732480049133301
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.296198844909668
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.958507061004639
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.873 Test Loss: 0.374 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.855762958526611
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.873 Test Loss: 0.375 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.868403196334839
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.879 Test Loss: 0.377 Test Acc: 0.879
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.982373952865601
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.873 Test Loss: 0.377 Test Acc: 0.873
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.761139631271362
Epoch: 1, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.075 Vali Acc: 0.630 Test Loss: 1.075 Test Acc: 0.630
Validation loss decreased (inf --> -0.630047).  Saving model ...
Epoch: 2 cost time: 5.971332788467407
Epoch: 2, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.841 Vali Acc: 0.723 Test Loss: 0.841 Test Acc: 0.723
Validation loss decreased (-0.630047 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 6.415677070617676
Epoch: 3, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
Validation loss decreased (-0.722535 --> -0.803463).  Saving model ...
Epoch: 4 cost time: 6.4020020961761475
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.688 Vali Acc: 0.798 Test Loss: 0.688 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.8628857135772705
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 6 cost time: 5.863556861877441
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 7 cost time: 5.998488426208496
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.699036121368408
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820804).  Saving model ...
Epoch: 9 cost time: 6.6050941944122314
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.815 Test Loss: 0.478 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.091315746307373
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.798 Test Loss: 0.483 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.337541580200195
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.792 Test Loss: 0.485 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.54685640335083
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.792 Test Loss: 0.480 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.523335933685303
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.230460166931152
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.19882345199585
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.131417989730835
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.292123794555664
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.798 Test Loss: 0.470 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.399317979812622
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.798 Test Loss: 0.469 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.696558475494385
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.197 Vali Acc: 0.671 Test Loss: 1.197 Test Acc: 0.671
Validation loss decreased (inf --> -0.670508).  Saving model ...
Epoch: 2 cost time: 5.989201545715332
Epoch: 2, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.808 Vali Acc: 0.723 Test Loss: 0.808 Test Acc: 0.723
Validation loss decreased (-0.670508 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 6.019573926925659
Epoch: 3, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.527 Vali Acc: 0.798 Test Loss: 0.527 Test Acc: 0.798
Validation loss decreased (-0.722535 --> -0.797683).  Saving model ...
Epoch: 4 cost time: 6.687268972396851
Epoch: 4, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.450 Vali Acc: 0.815 Test Loss: 0.450 Test Acc: 0.815
Validation loss decreased (-0.797683 --> -0.815024).  Saving model ...
Epoch: 5 cost time: 6.203861951828003
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.815024 --> -0.838145).  Saving model ...
Epoch: 6 cost time: 6.087627649307251
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.034487247467041
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.844 Test Loss: 0.461 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843926).  Saving model ...
Epoch: 8 cost time: 6.357577323913574
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.827 Test Loss: 0.474 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.08330774307251
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.832 Test Loss: 0.460 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.133007287979126
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.838 Test Loss: 0.450 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.132946729660034
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.9541099071502686
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.15472412109375
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.1697869300842285
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.485251188278198
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.164983749389648
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.838 Test Loss: 0.458 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.912615537643433
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.816035985946655
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.429 Vali Acc: 0.613 Test Loss: 1.429 Test Acc: 0.613
Validation loss decreased (inf --> -0.612702).  Saving model ...
Epoch: 2 cost time: 6.454908132553101
Epoch: 2, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.938 Vali Acc: 0.659 Test Loss: 0.938 Test Acc: 0.659
Validation loss decreased (-0.612702 --> -0.658950).  Saving model ...
Epoch: 3 cost time: 6.2277586460113525
Epoch: 3, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.723 Vali Acc: 0.740 Test Loss: 0.723 Test Acc: 0.740
Validation loss decreased (-0.658950 --> -0.739877).  Saving model ...
Epoch: 4 cost time: 6.269435405731201
Epoch: 4, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
Validation loss decreased (-0.739877 --> -0.774561).  Saving model ...
Epoch: 5 cost time: 6.45084285736084
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.774561 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 6.435948610305786
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.821 Test Loss: 0.540 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 6.522263526916504
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.261837959289551
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.815 Test Loss: 0.498 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.306296348571777
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.815 Test Loss: 0.481 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.657496213912964
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 6.514015197753906
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.057424783706665
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 13 cost time: 6.325435400009155
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.644446134567261
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849706).  Saving model ...
Epoch: 15 cost time: 6.471714496612549
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.832 Test Loss: 0.451 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.098248243331909
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.832 Test Loss: 0.451 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.318640470504761
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.403956651687622
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.50662088394165
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.832 Test Loss: 0.441 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.4057605266571045
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.0297627449035645
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.266635179519653
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.832 Test Loss: 0.437 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.198383569717407
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.838 Test Loss: 0.430 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.684406518936157
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.832 Test Loss: 0.425 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.785632371902466
Epoch: 1, Steps: 17 | Train Loss: 1.910 Vali Loss: 1.593 Vali Acc: 0.491 Test Loss: 1.593 Test Acc: 0.491
Validation loss decreased (inf --> -0.491314).  Saving model ...
Epoch: 2 cost time: 6.261831760406494
Epoch: 2, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.044 Vali Acc: 0.624 Test Loss: 1.044 Test Acc: 0.624
Validation loss decreased (-0.491314 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 5.916147708892822
Epoch: 3, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.960 Vali Acc: 0.630 Test Loss: 0.960 Test Acc: 0.630
Validation loss decreased (-0.624267 --> -0.630048).  Saving model ...
Epoch: 4 cost time: 5.915781736373901
Epoch: 4, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.757 Vali Acc: 0.665 Test Loss: 0.757 Test Acc: 0.665
Validation loss decreased (-0.630048 --> -0.664732).  Saving model ...
Epoch: 5 cost time: 5.577225923538208
Epoch: 5, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.670 Vali Acc: 0.688 Test Loss: 0.670 Test Acc: 0.688
Validation loss decreased (-0.664732 --> -0.687855).  Saving model ...
Epoch: 6 cost time: 5.829662561416626
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.687855 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 6.39838719367981
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.785643577575684
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.734 Test Loss: 0.567 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.866659164428711
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.740 Test Loss: 0.590 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.85647177696228
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.1492297649383545
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.757 Test Loss: 0.554 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.333041667938232
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.2225658893585205
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.679627180099487
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.125998497009277
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.769 Test Loss: 0.543 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.242537021636963
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.230023145675659
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.738 Vali Acc: 0.376 Test Loss: 1.738 Test Acc: 0.376
Validation loss decreased (inf --> -0.375705).  Saving model ...
Epoch: 2 cost time: 5.6637256145477295
Epoch: 2, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.146 Vali Acc: 0.647 Test Loss: 1.146 Test Acc: 0.647
Validation loss decreased (-0.375705 --> -0.647387).  Saving model ...
Epoch: 3 cost time: 5.974544525146484
Epoch: 3, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.062 Vali Acc: 0.618 Test Loss: 1.062 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.227449893951416
Epoch: 4, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.765 Vali Acc: 0.647 Test Loss: 0.765 Test Acc: 0.647
Validation loss decreased (-0.647387 --> -0.647391).  Saving model ...
Epoch: 5 cost time: 6.441924810409546
Epoch: 5, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.624 Vali Acc: 0.705 Test Loss: 0.624 Test Acc: 0.705
Validation loss decreased (-0.647391 --> -0.705196).  Saving model ...
Epoch: 6 cost time: 5.707024812698364
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
Validation loss decreased (-0.705196 --> -0.774561).  Saving model ...
Epoch: 7 cost time: 5.676184415817261
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.780 Test Loss: 0.555 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 8 cost time: 6.033599138259888
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.775 Test Loss: 0.563 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.272310256958008
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.798 Test Loss: 0.555 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 6.1254496574401855
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 11 cost time: 5.718084096908569
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.780 Test Loss: 0.544 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.80883002281189
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.786 Test Loss: 0.542 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.138662338256836
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.798 Test Loss: 0.540 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.079704999923706
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.780 Test Loss: 0.548 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.908212661743164
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.786 Test Loss: 0.537 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.740880966186523
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.786 Test Loss: 0.529 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.818953514099121
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.780 Test Loss: 0.531 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.871742486953735
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.786 Test Loss: 0.533 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.726071357727051
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.6696107387542725
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.786 Test Loss: 0.521 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.039703369140625
Epoch: 1, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.772 Vali Acc: 0.318 Test Loss: 1.772 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 6.065534591674805
Epoch: 2, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.152 Vali Acc: 0.595 Test Loss: 1.152 Test Acc: 0.595
Validation loss decreased (-0.317901 --> -0.595364).  Saving model ...
Epoch: 3 cost time: 5.986926794052124
Epoch: 3, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.166 Vali Acc: 0.613 Test Loss: 1.166 Test Acc: 0.613
Validation loss decreased (-0.595364 --> -0.612705).  Saving model ...
Epoch: 4 cost time: 5.812329053878784
Epoch: 4, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.838 Vali Acc: 0.636 Test Loss: 0.838 Test Acc: 0.636
Validation loss decreased (-0.612705 --> -0.635830).  Saving model ...
Epoch: 5 cost time: 5.73050594329834
Epoch: 5, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
Validation loss decreased (-0.635830 --> -0.763000).  Saving model ...
Epoch: 6 cost time: 6.305651426315308
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.670 Vali Acc: 0.746 Test Loss: 0.670 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.310556173324585
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.9691736698150635
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.769 Test Loss: 0.565 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 9 cost time: 5.890413045883179
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.798 Test Loss: 0.507 Test Acc: 0.798
Validation loss decreased (-0.768780 --> -0.797683).  Saving model ...
Epoch: 10 cost time: 6.370668888092041
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.827 Test Loss: 0.487 Test Acc: 0.827
Validation loss decreased (-0.797683 --> -0.826585).  Saving model ...
Epoch: 11 cost time: 6.16546106338501
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.780 Test Loss: 0.539 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.035053491592407
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.798 Test Loss: 0.510 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.833858013153076
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.208486318588257
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.786 Test Loss: 0.513 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.960994243621826
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.3467185497283936
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.809 Test Loss: 0.489 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.210775136947632
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.801494359970093
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.798 Test Loss: 0.480 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.003363847732544
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.8879475593566895
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.977699041366577
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.759 Vali Acc: 0.318 Test Loss: 1.759 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 6.673405408859253
Epoch: 2, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.130 Vali Acc: 0.647 Test Loss: 1.130 Test Acc: 0.647
Validation loss decreased (-0.317901 --> -0.647388).  Saving model ...
Epoch: 3 cost time: 6.3869874477386475
Epoch: 3, Steps: 17 | Train Loss: 0.516 Vali Loss: 1.103 Vali Acc: 0.630 Test Loss: 1.103 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.223193168640137
Epoch: 4, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
Validation loss decreased (-0.647388 --> -0.710975).  Saving model ...
Epoch: 5 cost time: 6.902620077133179
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.610 Vali Acc: 0.740 Test Loss: 0.610 Test Acc: 0.740
Validation loss decreased (-0.710975 --> -0.739878).  Saving model ...
Epoch: 6 cost time: 6.733639717102051
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751439).  Saving model ...
Epoch: 7 cost time: 6.591533184051514
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.815 Test Loss: 0.493 Test Acc: 0.815
Validation loss decreased (-0.751439 --> -0.815024).  Saving model ...
Epoch: 8 cost time: 6.284147262573242
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.757 Test Loss: 0.525 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.13352370262146
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.792 Test Loss: 0.506 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.0643486976623535
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.780 Test Loss: 0.503 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.073671817779541
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.746 Test Loss: 0.535 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.217471599578857
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.780 Test Loss: 0.494 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.323971509933472
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.780 Test Loss: 0.499 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.486882925033569
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.763 Test Loss: 0.511 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.493993282318115
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.780 Test Loss: 0.497 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.174464225769043
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.792 Test Loss: 0.498 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.183426856994629
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.815 Test Loss: 0.502 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.3385701179504395
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
Validation loss decreased (inf --> -0.127148).  Saving model ...
Epoch: 2 cost time: 6.0501673221588135
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.336872577667236
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.6663498878479
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.272228240966797
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.392170190811157
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.706932544708252
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.543912649154663
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.137756586074829
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.399384498596191
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.695722579956055
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.12716763005780346
model parameter : 14078983
model size : 73.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.799569368362427
Epoch: 1, Steps: 17 | Train Loss: 1.673 Vali Loss: 1.137 Vali Acc: 0.543 Test Loss: 1.137 Test Acc: 0.543
Validation loss decreased (inf --> -0.543341).  Saving model ...
Epoch: 2 cost time: 6.420140504837036
Epoch: 2, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.770 Vali Acc: 0.734 Test Loss: 0.770 Test Acc: 0.734
Validation loss decreased (-0.543341 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 6.173551559448242
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.752 Vali Acc: 0.746 Test Loss: 0.752 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745657).  Saving model ...
Epoch: 4 cost time: 6.278978109359741
Epoch: 4, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
Validation loss decreased (-0.745657 --> -0.757220).  Saving model ...
Epoch: 5 cost time: 6.293485879898071
Epoch: 5, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.699 Vali Acc: 0.769 Test Loss: 0.699 Test Acc: 0.769
Validation loss decreased (-0.757220 --> -0.768779).  Saving model ...
Epoch: 6 cost time: 6.4676125049591064
Epoch: 6, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.467 Vali Acc: 0.827 Test Loss: 0.467 Test Acc: 0.827
Validation loss decreased (-0.768779 --> -0.826585).  Saving model ...
Epoch: 7 cost time: 5.682159900665283
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.515 Vali Acc: 0.838 Test Loss: 0.515 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838145).  Saving model ...
Epoch: 8 cost time: 5.704961061477661
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.615 Vali Acc: 0.827 Test Loss: 0.615 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.053462266921997
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.0358686447143555
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.53929591178894
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.712 Vali Acc: 0.763 Test Loss: 1.712 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.946911573410034
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.461 Vali Acc: 0.792 Test Loss: 1.461 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.1220762729644775
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.109 Vali Acc: 0.803 Test Loss: 1.109 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.177117109298706
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.118 Vali Acc: 0.798 Test Loss: 1.118 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.353073358535767
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.539 Vali Acc: 0.751 Test Loss: 1.539 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.167107820510864
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.919 Vali Acc: 0.769 Test Loss: 1.919 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.326117038726807
Epoch: 17, Steps: 17 | Train Loss: 0.085 Vali Loss: 3.208 Vali Acc: 0.688 Test Loss: 3.208 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.735044479370117
Epoch: 1, Steps: 17 | Train Loss: 1.694 Vali Loss: 1.123 Vali Acc: 0.566 Test Loss: 1.123 Test Acc: 0.566
Validation loss decreased (inf --> -0.566463).  Saving model ...
Epoch: 2 cost time: 6.170298337936401
Epoch: 2, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.721 Vali Acc: 0.751 Test Loss: 0.721 Test Acc: 0.751
Validation loss decreased (-0.566463 --> -0.751438).  Saving model ...
Epoch: 3 cost time: 6.1251139640808105
Epoch: 3, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.687 Vali Acc: 0.763 Test Loss: 0.687 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 6.318413496017456
Epoch: 4, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.650 Vali Acc: 0.786 Test Loss: 0.650 Test Acc: 0.786
Validation loss decreased (-0.762999 --> -0.786121).  Saving model ...
Epoch: 5 cost time: 6.36034083366394
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809244).  Saving model ...
Epoch: 6 cost time: 6.434430837631226
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.798 Test Loss: 0.642 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.880055904388428
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.490 Vali Acc: 0.827 Test Loss: 0.490 Test Acc: 0.827
Validation loss decreased (-0.809244 --> -0.826585).  Saving model ...
Epoch: 8 cost time: 6.7292115688323975
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
Validation loss decreased (-0.826585 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 6.362318754196167
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.060 Vali Acc: 0.775 Test Loss: 1.060 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.62930703163147
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.699 Vali Acc: 0.786 Test Loss: 0.699 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.6593945026397705
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.792 Test Loss: 0.814 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.117676258087158
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.688203811645508
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.682328939437866
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.798 Test Loss: 0.527 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.345976829528809
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.815 Test Loss: 0.531 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.968589782714844
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.821 Test Loss: 0.531 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.3230602741241455
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.821 Test Loss: 0.529 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.821613788604736
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.815 Test Loss: 0.528 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.208665370941162
Epoch: 1, Steps: 17 | Train Loss: 1.736 Vali Loss: 1.140 Vali Acc: 0.509 Test Loss: 1.140 Test Acc: 0.509
Validation loss decreased (inf --> -0.508659).  Saving model ...
Epoch: 2 cost time: 6.299807071685791
Epoch: 2, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.705 Vali Acc: 0.769 Test Loss: 0.705 Test Acc: 0.769
Validation loss decreased (-0.508659 --> -0.768779).  Saving model ...
Epoch: 3 cost time: 6.16447377204895
Epoch: 3, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.617 Vali Acc: 0.792 Test Loss: 0.617 Test Acc: 0.792
Validation loss decreased (-0.768779 --> -0.791901).  Saving model ...
Epoch: 4 cost time: 6.484367847442627
Epoch: 4, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.543 Vali Acc: 0.786 Test Loss: 0.543 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.399836778640747
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.497 Vali Acc: 0.775 Test Loss: 0.497 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.2847206592559814
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.798 Test Loss: 0.503 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797683).  Saving model ...
Epoch: 7 cost time: 6.63885498046875
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.797683 --> -0.809244).  Saving model ...
Epoch: 8 cost time: 6.818727254867554
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.297398805618286
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 10 cost time: 6.388638257980347
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
Validation loss decreased (-0.809244 --> -0.815024).  Saving model ...
Epoch: 11 cost time: 6.447909355163574
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.325956106185913
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.269234895706177
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.4981689453125
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.101548910140991
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.815 Test Loss: 0.492 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.944962501525879
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.044501066207886
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.343230962753296
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.101738929748535
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.096951246261597
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.932770490646362
Epoch: 1, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.230 Vali Acc: 0.543 Test Loss: 1.230 Test Acc: 0.543
Validation loss decreased (inf --> -0.543340).  Saving model ...
Epoch: 2 cost time: 7.135729789733887
Epoch: 2, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.711 Vali Acc: 0.734 Test Loss: 0.711 Test Acc: 0.734
Validation loss decreased (-0.543340 --> -0.734097).  Saving model ...
Epoch: 3 cost time: 6.220386981964111
Epoch: 3, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.638 Vali Acc: 0.798 Test Loss: 0.638 Test Acc: 0.798
Validation loss decreased (-0.734097 --> -0.797681).  Saving model ...
Epoch: 4 cost time: 6.1932947635650635
Epoch: 4, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803463).  Saving model ...
Epoch: 5 cost time: 5.702398061752319
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.1857264041900635
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.803 Test Loss: 0.443 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803464).  Saving model ...
Epoch: 7 cost time: 6.422628879547119
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.391 Vali Acc: 0.838 Test Loss: 0.391 Test Acc: 0.838
Validation loss decreased (-0.803464 --> -0.838146).  Saving model ...
Epoch: 8 cost time: 6.055521726608276
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.815 Test Loss: 0.432 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.4258527755737305
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.809 Test Loss: 0.410 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.7153990268707275
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.838 Test Loss: 0.401 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.3638200759887695
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.815 Test Loss: 0.405 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.494403600692749
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.815 Test Loss: 0.408 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.256423234939575
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.821 Test Loss: 0.403 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.217488050460815
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.827 Test Loss: 0.408 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.206624269485474
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.832 Test Loss: 0.411 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.117766618728638
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.809 Test Loss: 0.412 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.230234384536743
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.827 Test Loss: 0.412 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.11928653717041
Epoch: 1, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.470 Vali Acc: 0.480 Test Loss: 1.470 Test Acc: 0.480
Validation loss decreased (inf --> -0.479754).  Saving model ...
Epoch: 2 cost time: 6.31961464881897
Epoch: 2, Steps: 17 | Train Loss: 0.888 Vali Loss: 0.955 Vali Acc: 0.607 Test Loss: 0.955 Test Acc: 0.607
Validation loss decreased (-0.479754 --> -0.606927).  Saving model ...
Epoch: 3 cost time: 6.833374500274658
Epoch: 3, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.800 Vali Acc: 0.671 Test Loss: 0.800 Test Acc: 0.671
Validation loss decreased (-0.606927 --> -0.670512).  Saving model ...
Epoch: 4 cost time: 6.687903165817261
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.607 Vali Acc: 0.786 Test Loss: 0.607 Test Acc: 0.786
Validation loss decreased (-0.670512 --> -0.786121).  Saving model ...
Epoch: 5 cost time: 6.124754190444946
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803462).  Saving model ...
Epoch: 6 cost time: 6.493790864944458
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.827 Test Loss: 0.481 Test Acc: 0.827
Validation loss decreased (-0.803462 --> -0.826585).  Saving model ...
Epoch: 7 cost time: 6.55089807510376
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
Validation loss decreased (-0.826585 --> -0.867048).  Saving model ...
Epoch: 8 cost time: 5.631765365600586
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.969141960144043
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.492740869522095
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.109541893005371
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.861 Test Loss: 0.442 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.048231601715088
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.867 Test Loss: 0.444 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 13 cost time: 6.456566333770752
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.861 Test Loss: 0.434 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.410610198974609
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.7578818798065186
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.567578554153442
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 17 cost time: 6.958224773406982
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.137613773345947
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.184603691101074
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.228278875350952
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
Validation loss decreased (-0.867048 --> -0.884389).  Saving model ...
Epoch: 21 cost time: 5.8395702838897705
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.700922250747681
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.398821592330933
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.568290948867798
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.3201904296875
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.867 Test Loss: 0.413 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.092205047607422
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.873 Test Loss: 0.403 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.819378614425659
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.85502815246582
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.738593339920044
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.884 Test Loss: 0.402 Test Acc: 0.884
Validation loss decreased (-0.884389 --> -0.884389).  Saving model ...
Epoch: 30 cost time: 6.315608501434326
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.873 Test Loss: 0.403 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.034847974777222
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.867 Test Loss: 0.403 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.821009874343872
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.873 Test Loss: 0.399 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.853127717971802
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.879 Test Loss: 0.396 Test Acc: 0.879
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.518298864364624
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.867 Test Loss: 0.399 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.159372806549072
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.867 Test Loss: 0.397 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.345336437225342
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.867 Test Loss: 0.393 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.5265185832977295
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.138038635253906
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.867 Test Loss: 0.388 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.617361068725586
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.596139430999756
Epoch: 1, Steps: 17 | Train Loss: 1.959 Vali Loss: 1.578 Vali Acc: 0.439 Test Loss: 1.578 Test Acc: 0.439
Validation loss decreased (inf --> -0.439291).  Saving model ...
Epoch: 2 cost time: 5.520574569702148
Epoch: 2, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.038 Vali Acc: 0.590 Test Loss: 1.038 Test Acc: 0.590
Validation loss decreased (-0.439291 --> -0.589585).  Saving model ...
Epoch: 3 cost time: 6.1808013916015625
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.943 Vali Acc: 0.642 Test Loss: 0.943 Test Acc: 0.642
Validation loss decreased (-0.589585 --> -0.641609).  Saving model ...
Epoch: 4 cost time: 5.934832334518433
Epoch: 4, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.724 Vali Acc: 0.659 Test Loss: 0.724 Test Acc: 0.659
Validation loss decreased (-0.641609 --> -0.658952).  Saving model ...
Epoch: 5 cost time: 6.0855536460876465
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.634 Vali Acc: 0.711 Test Loss: 0.634 Test Acc: 0.711
Validation loss decreased (-0.658952 --> -0.710976).  Saving model ...
Epoch: 6 cost time: 6.058825731277466
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.710976 --> -0.763000).  Saving model ...
Epoch: 7 cost time: 5.969812393188477
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 8 cost time: 6.132855653762817
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
Validation loss decreased (-0.763000 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 6.02511191368103
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.769 Test Loss: 0.547 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.0600426197052
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.049047470092773
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.798 Test Loss: 0.521 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.846679925918579
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.101806879043579
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.792 Test Loss: 0.513 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.169553279876709
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 6.138247489929199
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.139060020446777
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.133569955825806
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.798 Test Loss: 0.512 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.851697206497192
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.868197202682495
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 20 cost time: 5.746819257736206
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.798 Test Loss: 0.508 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.775471210479736
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.6196815967559814
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.798 Test Loss: 0.505 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.107494354248047
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.963231086730957
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809244).  Saving model ...
Epoch: 25 cost time: 6.135704517364502
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.030818223953247
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.951594591140747
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.7554521560668945
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 29 cost time: 5.1997458934783936
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 30 cost time: 5.8170013427734375
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.821410179138184
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.0972740650177
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.201896905899048
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.792 Test Loss: 0.489 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.957674503326416
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.792 Test Loss: 0.492 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 6.259371042251587
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.808504343032837
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.5107104778289795
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 6.249651670455933
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 6.327115535736084
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.897583484649658
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.720 Vali Acc: 0.353 Test Loss: 1.720 Test Acc: 0.353
Validation loss decreased (inf --> -0.352584).  Saving model ...
Epoch: 2 cost time: 6.091682434082031
Epoch: 2, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.150 Vali Acc: 0.607 Test Loss: 1.150 Test Acc: 0.607
Validation loss decreased (-0.352584 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 5.941354513168335
Epoch: 3, Steps: 17 | Train Loss: 0.478 Vali Loss: 1.034 Vali Acc: 0.601 Test Loss: 1.034 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.703881025314331
Epoch: 4, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.764 Vali Acc: 0.682 Test Loss: 0.764 Test Acc: 0.682
Validation loss decreased (-0.606925 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 5.660229206085205
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.746 Vali Acc: 0.653 Test Loss: 0.746 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.6847686767578125
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.717 Vali Acc: 0.671 Test Loss: 0.717 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.257252931594849
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
Validation loss decreased (-0.682073 --> -0.757220).  Saving model ...
Epoch: 8 cost time: 5.780669927597046
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.780 Test Loss: 0.528 Test Acc: 0.780
Validation loss decreased (-0.757220 --> -0.780342).  Saving model ...
Epoch: 9 cost time: 6.123403549194336
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.705 Test Loss: 0.627 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.453628778457642
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.178766250610352
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.757 Test Loss: 0.555 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.380823612213135
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.843674182891846
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.775802135467529
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.757 Test Loss: 0.555 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.911625385284424
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.734 Test Loss: 0.568 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.6916210651397705
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.769 Test Loss: 0.552 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.4910888671875
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.651318073272705
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.757 Test Loss: 0.562 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.891966342926025
Epoch: 1, Steps: 17 | Train Loss: 1.953 Vali Loss: 1.727 Vali Acc: 0.387 Test Loss: 1.727 Test Acc: 0.387
Validation loss decreased (inf --> -0.387266).  Saving model ...
Epoch: 2 cost time: 6.256885528564453
Epoch: 2, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.146 Vali Acc: 0.607 Test Loss: 1.146 Test Acc: 0.607
Validation loss decreased (-0.387266 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 6.329125165939331
Epoch: 3, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.963 Vali Acc: 0.636 Test Loss: 0.963 Test Acc: 0.636
Validation loss decreased (-0.606925 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 6.198359727859497
Epoch: 4, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.761 Vali Acc: 0.665 Test Loss: 0.761 Test Acc: 0.665
Validation loss decreased (-0.635829 --> -0.664732).  Saving model ...
Epoch: 5 cost time: 5.975398540496826
Epoch: 5, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.694 Vali Acc: 0.682 Test Loss: 0.694 Test Acc: 0.682
Validation loss decreased (-0.664732 --> -0.682074).  Saving model ...
Epoch: 6 cost time: 6.1763410568237305
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
Validation loss decreased (-0.682074 --> -0.751439).  Saving model ...
Epoch: 7 cost time: 6.234576463699341
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.723 Test Loss: 0.589 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.158323287963867
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 9 cost time: 6.278940200805664
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.728 Test Loss: 0.612 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.473448038101196
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.757 Test Loss: 0.532 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757220).  Saving model ...
Epoch: 11 cost time: 7.294033527374268
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.757 Test Loss: 0.562 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.6945154666900635
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.518682241439819
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.780 Test Loss: 0.538 Test Acc: 0.780
Validation loss decreased (-0.757220 --> -0.780341).  Saving model ...
Epoch: 14 cost time: 7.3672261238098145
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.775 Test Loss: 0.543 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.906402587890625
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.717695236206055
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 17 cost time: 7.360572576522827
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.769 Test Loss: 0.555 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.294274568557739
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.795963287353516
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.786 Test Loss: 0.556 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.798848628997803
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.792 Test Loss: 0.538 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 21 cost time: 7.754256010055542
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.792 Test Loss: 0.541 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.278601408004761
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.828516483306885
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.792 Test Loss: 0.550 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.463117599487305
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.780 Test Loss: 0.551 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.174120187759399
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.792 Test Loss: 0.550 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 7.681203126907349
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.548166036605835
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.792 Test Loss: 0.542 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.683933973312378
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 29 cost time: 7.874446868896484
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.792 Test Loss: 0.556 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 7.271521091461182
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 31 cost time: 7.06694483757019
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.567390203475952
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.792 Test Loss: 0.551 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.325468063354492
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 34 cost time: 7.125671863555908
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 35 cost time: 7.2226433753967285
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 7.3741233348846436
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.798 Test Loss: 0.565 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 7.253494024276733
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.786 Test Loss: 0.572 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 7.486208915710449
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 7.587918043136597
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 40 cost time: 7.183383226394653
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 41 cost time: 6.764578104019165
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.821 Test Loss: 0.542 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 42 cost time: 7.842690467834473
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.821 Test Loss: 0.550 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 7.114311218261719
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.821 Test Loss: 0.551 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.815832138061523
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.827 Test Loss: 0.555 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 45 cost time: 6.812593221664429
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 7.014355182647705
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.815 Test Loss: 0.574 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 7.350200653076172
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.815 Test Loss: 0.578 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 7.712540149688721
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.815 Test Loss: 0.574 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 7.856439113616943
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.827 Test Loss: 0.566 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 7.6756672859191895
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.827 Test Loss: 0.561 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 7.088029623031616
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.815 Test Loss: 0.569 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 6.022215843200684
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.827 Test Loss: 0.564 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 6.0223069190979
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.827 Test Loss: 0.555 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 7.160930633544922
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.827 Test Loss: 0.559 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.385542869567871
Epoch: 1, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.759 Vali Acc: 0.387 Test Loss: 1.759 Test Acc: 0.387
Validation loss decreased (inf --> -0.387266).  Saving model ...
Epoch: 2 cost time: 7.163808822631836
Epoch: 2, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.161 Vali Acc: 0.607 Test Loss: 1.161 Test Acc: 0.607
Validation loss decreased (-0.387266 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 7.320644855499268
Epoch: 3, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.976 Vali Acc: 0.601 Test Loss: 0.976 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.280321359634399
Epoch: 4, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.774 Vali Acc: 0.636 Test Loss: 0.774 Test Acc: 0.636
Validation loss decreased (-0.606925 --> -0.635830).  Saving model ...
Epoch: 5 cost time: 6.852643251419067
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.656 Vali Acc: 0.676 Test Loss: 0.656 Test Acc: 0.676
Validation loss decreased (-0.635830 --> -0.676294).  Saving model ...
Epoch: 6 cost time: 7.038729906082153
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.645 Vali Acc: 0.705 Test Loss: 0.645 Test Acc: 0.705
Validation loss decreased (-0.676294 --> -0.705196).  Saving model ...
Epoch: 7 cost time: 7.167889833450317
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
Validation loss decreased (-0.705196 --> -0.757220).  Saving model ...
Epoch: 8 cost time: 7.282051086425781
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.325483322143555
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.422703266143799
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.780 Test Loss: 0.526 Test Acc: 0.780
Validation loss decreased (-0.757220 --> -0.780342).  Saving model ...
Epoch: 11 cost time: 7.037438631057739
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.786 Test Loss: 0.525 Test Acc: 0.786
Validation loss decreased (-0.780342 --> -0.786122).  Saving model ...
Epoch: 12 cost time: 7.366750240325928
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.769 Test Loss: 0.531 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.984553575515747
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.763 Test Loss: 0.531 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.772103548049927
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.786 Test Loss: 0.519 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 15 cost time: 6.672877073287964
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.769 Test Loss: 0.525 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.980736255645752
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.769 Test Loss: 0.518 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.82218074798584
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.340399503707886
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.786 Test Loss: 0.513 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 19 cost time: 7.059803009033203
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.786 Test Loss: 0.508 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 20 cost time: 7.064925670623779
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 21 cost time: 7.121555805206299
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.780 Test Loss: 0.492 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.298906326293945
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.780 Test Loss: 0.510 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.022814989089966
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 24 cost time: 7.14448356628418
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 25 cost time: 7.101660251617432
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.792 Test Loss: 0.501 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.642298221588135
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820804).  Saving model ...
Epoch: 27 cost time: 6.615514278411865
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.815 Test Loss: 0.494 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.8350255489349365
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.7602458000183105
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.6073596477508545
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.832 Test Loss: 0.493 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 31 cost time: 7.801361560821533
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.821 Test Loss: 0.492 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 7.688616752624512
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.400446176528931
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.798 Test Loss: 0.497 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 7.67636775970459
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.821 Test Loss: 0.493 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 7.805530548095703
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 7.477970123291016
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.832 Test Loss: 0.515 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 7.620208501815796
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 7.317410945892334
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.832 Test Loss: 0.500 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.798500299453735
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.832 Test Loss: 0.499 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 7.155841112136841
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.838 Test Loss: 0.494 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 41 cost time: 6.887874603271484
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 7.510846138000488
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 7.243609428405762
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.815 Test Loss: 0.502 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 7.560917377471924
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 7.287097692489624
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 7.332709550857544
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.821 Test Loss: 0.501 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 7.680099725723267
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.821 Test Loss: 0.507 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 7.251915454864502
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.827 Test Loss: 0.516 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 7.289451837539673
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.815 Test Loss: 0.515 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 7.49974799156189
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.832 Test Loss: 0.505 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.31792402267456
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 6.5154078006744385
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
Validation loss decreased (-0.144489 --> -0.150270).  Saving model ...
Epoch: 3 cost time: 6.968196630477905
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.7484471797943115
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.619176387786865
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.821855068206787
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.228392839431763
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.369020700454712
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.745986461639404
Epoch: 9, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.9857542514801025
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.3959901332855225
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.711900472640991
Epoch: 12, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15028901734104047
model parameter : 13292551
model size : 70.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.397534608840942
Epoch: 1, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.155 Vali Acc: 0.561 Test Loss: 1.155 Test Acc: 0.561
Validation loss decreased (inf --> -0.560682).  Saving model ...
Epoch: 2 cost time: 7.811227321624756
Epoch: 2, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.739 Vali Acc: 0.723 Test Loss: 0.739 Test Acc: 0.723
Validation loss decreased (-0.560682 --> -0.722536).  Saving model ...
Epoch: 3 cost time: 7.0820677280426025
Epoch: 3, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
Validation loss decreased (-0.722536 --> -0.797681).  Saving model ...
Epoch: 4 cost time: 7.693700313568115
Epoch: 4, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809244).  Saving model ...
Epoch: 5 cost time: 7.3343377113342285
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.8348469734191895
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.683 Vali Acc: 0.769 Test Loss: 0.683 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.1196746826171875
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.799 Vali Acc: 0.769 Test Loss: 0.799 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.1995625495910645
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.581 Vali Acc: 0.821 Test Loss: 0.581 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820803).  Saving model ...
Epoch: 9 cost time: 7.03882622718811
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.572 Vali Acc: 0.815 Test Loss: 0.572 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.992092132568359
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.832 Test Loss: 0.402 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832366).  Saving model ...
Epoch: 11 cost time: 6.960258483886719
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.838 Test Loss: 0.433 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 12 cost time: 7.102949380874634
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 13 cost time: 6.800318241119385
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 14 cost time: 7.679619550704956
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.838 Test Loss: 0.429 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.408584833145142
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.838 Test Loss: 0.438 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.1747801303863525
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.018144607543945
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.832 Test Loss: 0.436 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.14283561706543
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.832 Test Loss: 0.435 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.9857096672058105
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.042908191680908
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.2721874713897705
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.701050519943237
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.832 Test Loss: 0.448 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.711756467819214
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.832 Test Loss: 0.448 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.541853189468384
Epoch: 1, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.189 Vali Acc: 0.543 Test Loss: 1.189 Test Acc: 0.543
Validation loss decreased (inf --> -0.543341).  Saving model ...
Epoch: 2 cost time: 7.158361911773682
Epoch: 2, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.663 Vali Acc: 0.769 Test Loss: 0.663 Test Acc: 0.769
Validation loss decreased (-0.543341 --> -0.768779).  Saving model ...
Epoch: 3 cost time: 7.360137939453125
Epoch: 3, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
Validation loss decreased (-0.768779 --> -0.768780).  Saving model ...
Epoch: 4 cost time: 7.139084815979004
Epoch: 4, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.413 Vali Acc: 0.832 Test Loss: 0.413 Test Acc: 0.832
Validation loss decreased (-0.768780 --> -0.832366).  Saving model ...
Epoch: 5 cost time: 7.3819074630737305
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.460088014602661
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.783 Vali Acc: 0.815 Test Loss: 0.783 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.030974626541138
Epoch: 7, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.824 Vali Acc: 0.751 Test Loss: 0.824 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.689805269241333
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.042 Vali Acc: 0.792 Test Loss: 1.042 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.3714563846588135
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.928 Vali Acc: 0.821 Test Loss: 0.928 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.7461137771606445
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.985 Vali Acc: 0.792 Test Loss: 0.985 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.463218927383423
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.897 Vali Acc: 0.798 Test Loss: 0.897 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.0201966762542725
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.792 Test Loss: 0.839 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.796396255493164
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.815 Test Loss: 0.661 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.292734861373901
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.821 Test Loss: 0.617 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.649192810058594
Epoch: 1, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.162 Vali Acc: 0.549 Test Loss: 1.162 Test Acc: 0.549
Validation loss decreased (inf --> -0.549121).  Saving model ...
Epoch: 2 cost time: 6.792346954345703
Epoch: 2, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.681 Vali Acc: 0.775 Test Loss: 0.681 Test Acc: 0.775
Validation loss decreased (-0.549121 --> -0.774560).  Saving model ...
Epoch: 3 cost time: 7.038129091262817
Epoch: 3, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.634 Vali Acc: 0.769 Test Loss: 0.634 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.518103122711182
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.566 Vali Acc: 0.775 Test Loss: 0.566 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774561).  Saving model ...
Epoch: 5 cost time: 7.2850329875946045
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.415 Vali Acc: 0.832 Test Loss: 0.415 Test Acc: 0.832
Validation loss decreased (-0.774561 --> -0.832366).  Saving model ...
Epoch: 6 cost time: 7.175425052642822
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.827 Test Loss: 0.447 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.880777835845947
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
Validation loss decreased (-0.832366 --> -0.855487).  Saving model ...
Epoch: 8 cost time: 7.107194900512695
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.815 Test Loss: 0.459 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.357973098754883
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.221376895904541
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 11 cost time: 7.382052183151245
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.453989267349243
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.387847185134888
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.983525037765503
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.096654891967773
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.867 Test Loss: 0.408 Test Acc: 0.867
Validation loss decreased (-0.861268 --> -0.867048).  Saving model ...
Epoch: 16 cost time: 7.481593370437622
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.420803546905518
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.587852239608765
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.8797008991241455
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.877525806427002
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.891252279281616
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.861 Test Loss: 0.415 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.614230394363403
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.861 Test Loss: 0.417 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.104616403579712
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.867 Test Loss: 0.412 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.140763998031616
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.301973581314087
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.879 Test Loss: 0.419 Test Acc: 0.879
Validation loss decreased (-0.867048 --> -0.878609).  Saving model ...
Epoch: 26 cost time: 7.312421798706055
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.873 Test Loss: 0.423 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.411913633346558
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.464030742645264
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 7.533660888671875
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.873 Test Loss: 0.421 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.218517780303955
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.873 Test Loss: 0.421 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 7.131130218505859
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.691410779953003
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.990224599838257
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.873 Test Loss: 0.425 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 7.4899609088897705
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.867 Test Loss: 0.430 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.574172496795654
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.861 Test Loss: 0.423 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.859777927398682
Epoch: 1, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.248 Vali Acc: 0.503 Test Loss: 1.248 Test Acc: 0.503
Validation loss decreased (inf --> -0.502878).  Saving model ...
Epoch: 2 cost time: 7.086244106292725
Epoch: 2, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.680 Vali Acc: 0.780 Test Loss: 0.680 Test Acc: 0.780
Validation loss decreased (-0.502878 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 7.264466762542725
Epoch: 3, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
Validation loss decreased (-0.780340 --> -0.809243).  Saving model ...
Epoch: 4 cost time: 7.197482109069824
Epoch: 4, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.521 Vali Acc: 0.751 Test Loss: 0.521 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.616393804550171
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.732643365859985
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.501 Vali Acc: 0.821 Test Loss: 0.501 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 6.718349456787109
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.821 Test Loss: 0.445 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820805).  Saving model ...
Epoch: 8 cost time: 6.245874881744385
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.827 Test Loss: 0.446 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 6.336752653121948
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838146).  Saving model ...
Epoch: 10 cost time: 6.886713743209839
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.844 Test Loss: 0.438 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 7.411517858505249
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.832 Test Loss: 0.433 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.9688215255737305
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.832 Test Loss: 0.435 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.830216407775879
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.838 Test Loss: 0.435 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.783650636672974
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.844 Test Loss: 0.428 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 15 cost time: 7.0610833168029785
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.832 Test Loss: 0.432 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.942962646484375
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.832 Test Loss: 0.429 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.825528383255005
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.832 Test Loss: 0.428 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.686457633972168
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.832 Test Loss: 0.424 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.641756534576416
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.838 Test Loss: 0.431 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.875274658203125
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.838 Test Loss: 0.431 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.353813886642456
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.832 Test Loss: 0.430 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.48790979385376
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.838 Test Loss: 0.430 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.0560407638549805
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.827 Test Loss: 0.426 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.326878070831299
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.832 Test Loss: 0.426 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.599076509475708
Epoch: 1, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.519 Vali Acc: 0.439 Test Loss: 1.519 Test Acc: 0.439
Validation loss decreased (inf --> -0.439291).  Saving model ...
Epoch: 2 cost time: 7.268515110015869
Epoch: 2, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.860 Vali Acc: 0.688 Test Loss: 0.860 Test Acc: 0.688
Validation loss decreased (-0.439291 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 7.0486180782318115
Epoch: 3, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.588 Vali Acc: 0.821 Test Loss: 0.588 Test Acc: 0.821
Validation loss decreased (-0.687853 --> -0.820803).  Saving model ...
Epoch: 4 cost time: 7.073858976364136
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.772388219833374
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.798 Test Loss: 0.525 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.482320070266724
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
Validation loss decreased (-0.820803 --> -0.838145).  Saving model ...
Epoch: 7 cost time: 6.4795191287994385
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.821 Test Loss: 0.448 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.602709531784058
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.43357515335083
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.832 Test Loss: 0.437 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.027612209320068
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.838 Test Loss: 0.435 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 6.8110504150390625
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.994110107421875
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 13 cost time: 6.889574766159058
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.838 Test Loss: 0.423 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 6.7243123054504395
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.838 Test Loss: 0.418 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 7.2474730014801025
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.838 Test Loss: 0.422 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.148163318634033
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.838 Test Loss: 0.414 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 17 cost time: 6.976413011550903
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.838 Test Loss: 0.415 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.0523858070373535
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.827 Test Loss: 0.409 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.33615517616272
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.838 Test Loss: 0.408 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 20 cost time: 6.471063852310181
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849707).  Saving model ...
Epoch: 21 cost time: 6.5289626121521
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
Validation loss decreased (-0.849707 --> -0.861268).  Saving model ...
Epoch: 22 cost time: 6.941890716552734
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.49820876121521
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.861 Test Loss: 0.401 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.995127201080322
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 25 cost time: 6.481847524642944
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.508898735046387
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.079789161682129
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.094632863998413
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
Validation loss decreased (-0.861268 --> -0.867048).  Saving model ...
Epoch: 29 cost time: 6.852898120880127
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.684751033782959
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 7.202122926712036
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.867 Test Loss: 0.391 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 32 cost time: 6.965600490570068
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 33 cost time: 6.909749984741211
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 34 cost time: 6.784984588623047
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.595792293548584
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 36 cost time: 6.4094462394714355
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 37 cost time: 6.892334938049316
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.911827802658081
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.855 Test Loss: 0.382 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.823896408081055
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 5.792328834533691
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.742676019668579
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.5695648193359375
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 7.005239725112915
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.855 Test Loss: 0.376 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 6.90606689453125
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.867 Test Loss: 0.378 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 45 cost time: 7.045873403549194
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.905881643295288
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 6.727802276611328
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.844 Test Loss: 0.374 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 7.086636304855347
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 7.310152769088745
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.855 Test Loss: 0.372 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 6.822314739227295
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 6.25074028968811
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 5.946655750274658
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.371 Vali Acc: 0.855 Test Loss: 0.371 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 6.741156101226807
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.371 Vali Acc: 0.844 Test Loss: 0.371 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 6.277862787246704
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.844 Test Loss: 0.370 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.945575714111328
Epoch: 1, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.650 Vali Acc: 0.370 Test Loss: 1.650 Test Acc: 0.370
Validation loss decreased (inf --> -0.369926).  Saving model ...
Epoch: 2 cost time: 6.93650484085083
Epoch: 2, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.019 Vali Acc: 0.653 Test Loss: 1.019 Test Acc: 0.653
Validation loss decreased (-0.369926 --> -0.653169).  Saving model ...
Epoch: 3 cost time: 7.503529787063599
Epoch: 3, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.657 Vali Acc: 0.780 Test Loss: 0.657 Test Acc: 0.780
Validation loss decreased (-0.653169 --> -0.780340).  Saving model ...
Epoch: 4 cost time: 7.207812070846558
Epoch: 4, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.692 Vali Acc: 0.699 Test Loss: 0.692 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.100882053375244
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.769 Test Loss: 0.571 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.3702874183654785
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.487155199050903
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.786 Test Loss: 0.528 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786122).  Saving model ...
Epoch: 8 cost time: 6.6430253982543945
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.792 Test Loss: 0.525 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 9 cost time: 6.531999826431274
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.780 Test Loss: 0.509 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.661647081375122
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.775 Test Loss: 0.517 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.9252941608428955
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.786 Test Loss: 0.502 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.879535913467407
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.775 Test Loss: 0.500 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.845169305801392
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.775 Test Loss: 0.496 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.157728433609009
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.775 Test Loss: 0.491 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.039903163909912
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.786 Test Loss: 0.498 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.878036737442017
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.786 Test Loss: 0.494 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.373269557952881
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.798 Test Loss: 0.495 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 18 cost time: 6.888755559921265
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.792 Test Loss: 0.489 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.911884546279907
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.798 Test Loss: 0.483 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 20 cost time: 6.78933048248291
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 21 cost time: 6.82888126373291
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.786 Test Loss: 0.477 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.799493312835693
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 23 cost time: 6.974389314651489
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 24 cost time: 7.104080677032471
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.827 Test Loss: 0.473 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826585).  Saving model ...
Epoch: 25 cost time: 6.773360729217529
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.827 Test Loss: 0.470 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 26 cost time: 6.911543130874634
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.392631530761719
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.798 Test Loss: 0.465 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.001463174819946
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.815 Test Loss: 0.463 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.870779514312744
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 30 cost time: 7.230751276016235
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 31 cost time: 6.489118576049805
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.815 Test Loss: 0.458 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.608280897140503
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.827 Test Loss: 0.454 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.1267547607421875
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.827 Test Loss: 0.454 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.787553071975708
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.832 Test Loss: 0.458 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 35 cost time: 5.684906482696533
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.815 Test Loss: 0.451 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.937057256698608
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 37 cost time: 7.054925918579102
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.827 Test Loss: 0.448 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 7.136533737182617
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.821 Test Loss: 0.447 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 7.003372669219971
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.821 Test Loss: 0.446 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.709763526916504
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.803 Test Loss: 0.446 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.832628965377808
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.821 Test Loss: 0.444 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.749046802520752
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.821 Test Loss: 0.440 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 7.16980242729187
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.821 Test Loss: 0.439 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 6.7365052700042725
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.821 Test Loss: 0.441 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 6.912947416305542
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.827 Test Loss: 0.441 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 6.860236883163452
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.821 Test Loss: 0.439 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.52319598197937
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.775 Vali Acc: 0.283 Test Loss: 1.775 Test Acc: 0.283
Validation loss decreased (inf --> -0.283219).  Saving model ...
Epoch: 2 cost time: 6.846724510192871
Epoch: 2, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.164 Vali Acc: 0.572 Test Loss: 1.164 Test Acc: 0.572
Validation loss decreased (-0.283219 --> -0.572243).  Saving model ...
Epoch: 3 cost time: 7.1399147510528564
Epoch: 3, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.784 Vali Acc: 0.676 Test Loss: 0.784 Test Acc: 0.676
Validation loss decreased (-0.572243 --> -0.676293).  Saving model ...
Epoch: 4 cost time: 7.123073101043701
Epoch: 4, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.785 Vali Acc: 0.636 Test Loss: 0.785 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.0465989112854
Epoch: 5, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.723 Test Loss: 0.604 Test Acc: 0.723
Validation loss decreased (-0.676293 --> -0.722537).  Saving model ...
Epoch: 6 cost time: 7.018403768539429
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.734 Test Loss: 0.605 Test Acc: 0.734
Validation loss decreased (-0.722537 --> -0.734098).  Saving model ...
Epoch: 7 cost time: 6.967007637023926
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.769 Test Loss: 0.549 Test Acc: 0.769
Validation loss decreased (-0.734098 --> -0.768781).  Saving model ...
Epoch: 8 cost time: 6.7911217212677
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.543590784072876
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.974037408828735
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.925820589065552
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.748485565185547
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.769 Test Loss: 0.529 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 13 cost time: 7.105871200561523
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.769 Test Loss: 0.516 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 14 cost time: 6.884464263916016
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.798 Test Loss: 0.507 Test Acc: 0.798
Validation loss decreased (-0.768781 --> -0.797683).  Saving model ...
Epoch: 15 cost time: 7.33203125
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.769 Test Loss: 0.519 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.263718843460083
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.775 Test Loss: 0.525 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.045278072357178
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.769 Test Loss: 0.517 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.534771680831909
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.786 Test Loss: 0.498 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.237308740615845
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.780 Test Loss: 0.509 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.368702411651611
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 21 cost time: 6.907706022262573
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.786 Test Loss: 0.500 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.547354459762573
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.798 Test Loss: 0.490 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.845119953155518
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.792 Test Loss: 0.489 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.221672773361206
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.798 Test Loss: 0.492 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.975054502487183
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.798 Test Loss: 0.490 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.858604907989502
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.792 Test Loss: 0.494 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.225161790847778
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.798 Test Loss: 0.489 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.022086143493652
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.798 Test Loss: 0.487 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.221898317337036
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.798 Test Loss: 0.492 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.796327590942383
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.792 Test Loss: 0.489 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.093996047973633
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.778 Vali Acc: 0.277 Test Loss: 1.778 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 6.595327138900757
Epoch: 2, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.178 Vali Acc: 0.590 Test Loss: 1.178 Test Acc: 0.590
Validation loss decreased (-0.277439 --> -0.589584).  Saving model ...
Epoch: 3 cost time: 6.93935489654541
Epoch: 3, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.745 Vali Acc: 0.711 Test Loss: 0.745 Test Acc: 0.711
Validation loss decreased (-0.589584 --> -0.710975).  Saving model ...
Epoch: 4 cost time: 6.530626535415649
Epoch: 4, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.746 Vali Acc: 0.636 Test Loss: 0.746 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.925349712371826
Epoch: 5, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.646 Vali Acc: 0.723 Test Loss: 0.646 Test Acc: 0.723
Validation loss decreased (-0.710975 --> -0.722537).  Saving model ...
Epoch: 6 cost time: 6.933777093887329
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.887 Vali Acc: 0.659 Test Loss: 0.887 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.1117846965789795
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
Validation loss decreased (-0.722537 --> -0.757220).  Saving model ...
Epoch: 8 cost time: 6.845279216766357
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
Validation loss decreased (-0.757220 --> -0.780341).  Saving model ...
Epoch: 9 cost time: 7.347702741622925
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.711 Test Loss: 0.591 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.230784893035889
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.780 Test Loss: 0.542 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 7.511271238327026
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.780 Test Loss: 0.547 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.680445432662964
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.715550184249878
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.798 Test Loss: 0.554 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797682).  Saving model ...
Epoch: 14 cost time: 7.671387195587158
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.780 Test Loss: 0.560 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.976480722427368
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.605201959609985
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.798 Test Loss: 0.530 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797683).  Saving model ...
Epoch: 17 cost time: 6.775664329528809
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.780 Test Loss: 0.544 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.034462213516235
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.895097732543945
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.728 Test Loss: 0.581 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.50440526008606
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.917508125305176
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.798 Test Loss: 0.539 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.027211904525757
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.769 Test Loss: 0.565 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.999741315841675
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.757 Test Loss: 0.571 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.607135534286499
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.792 Test Loss: 0.562 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.719757556915283
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.780 Test Loss: 0.564 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.692854404449463
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.83442497253418
Epoch: 1, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.833 Vali Acc: 0.295 Test Loss: 1.833 Test Acc: 0.295
Validation loss decreased (inf --> -0.294779).  Saving model ...
Epoch: 2 cost time: 6.3471152782440186
Epoch: 2, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.241 Vali Acc: 0.566 Test Loss: 1.241 Test Acc: 0.566
Validation loss decreased (-0.294779 --> -0.566462).  Saving model ...
Epoch: 3 cost time: 6.349949836730957
Epoch: 3, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.780 Vali Acc: 0.665 Test Loss: 0.780 Test Acc: 0.665
Validation loss decreased (-0.566462 --> -0.664732).  Saving model ...
Epoch: 4 cost time: 6.913741111755371
Epoch: 4, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.735 Vali Acc: 0.694 Test Loss: 0.735 Test Acc: 0.694
Validation loss decreased (-0.664732 --> -0.693634).  Saving model ...
Epoch: 5 cost time: 6.527302265167236
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.713 Vali Acc: 0.694 Test Loss: 0.713 Test Acc: 0.694
Validation loss decreased (-0.693634 --> -0.693634).  Saving model ...
Epoch: 6 cost time: 6.649969577789307
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.728 Test Loss: 0.639 Test Acc: 0.728
Validation loss decreased (-0.693634 --> -0.728317).  Saving model ...
Epoch: 7 cost time: 6.764171838760376
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.734 Test Loss: 0.627 Test Acc: 0.734
Validation loss decreased (-0.728317 --> -0.734098).  Saving model ...
Epoch: 8 cost time: 6.700788259506226
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.740 Test Loss: 0.538 Test Acc: 0.740
Validation loss decreased (-0.734098 --> -0.739879).  Saving model ...
Epoch: 9 cost time: 5.8205885887146
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.723 Test Loss: 0.552 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.3174638748168945
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.757 Test Loss: 0.542 Test Acc: 0.757
Validation loss decreased (-0.739879 --> -0.757220).  Saving model ...
Epoch: 11 cost time: 6.498809814453125
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.740 Test Loss: 0.561 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.380933523178101
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.751 Test Loss: 0.532 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.678324937820435
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.5297746658325195
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.723 Test Loss: 0.555 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.8047308921813965
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.728 Test Loss: 0.537 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.681182146072388
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.757 Test Loss: 0.530 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 17 cost time: 6.622874736785889
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.740 Test Loss: 0.533 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.544229984283447
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.751 Test Loss: 0.524 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.905149221420288
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.734 Test Loss: 0.534 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.8361976146698
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.746 Test Loss: 0.534 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.544544458389282
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.769 Test Loss: 0.508 Test Acc: 0.769
Validation loss decreased (-0.757220 --> -0.768781).  Saving model ...
Epoch: 22 cost time: 6.157305717468262
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.757 Test Loss: 0.521 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.625486135482788
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.734 Test Loss: 0.533 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.230776309967041
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.381059408187866
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.757 Test Loss: 0.518 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.325650930404663
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.740 Test Loss: 0.528 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.55318021774292
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.769 Test Loss: 0.512 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.789174795150757
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.746 Test Loss: 0.526 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.836122751235962
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.746 Test Loss: 0.533 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.661309242248535
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.757 Test Loss: 0.533 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.867109298706055
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.769 Test Loss: 0.530 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.9215247631073
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 5.781343460083008
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.879674196243286
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.693004369735718
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.931792974472046
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.106977224349976
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.094215631484985
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.63694143295288
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.436850786209106
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.643986701965332
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.766374349594116
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.17341040462427745
model parameter : 12899335
model size : 68.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.117362976074219
Epoch: 1, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.264 Vali Acc: 0.451 Test Loss: 1.264 Test Acc: 0.451
Validation loss decreased (inf --> -0.450854).  Saving model ...
Epoch: 2 cost time: 6.147174596786499
Epoch: 2, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
Validation loss decreased (-0.450854 --> -0.595364).  Saving model ...
Epoch: 3 cost time: 6.214888334274292
Epoch: 3, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.739 Vali Acc: 0.734 Test Loss: 0.739 Test Acc: 0.734
Validation loss decreased (-0.595364 --> -0.734097).  Saving model ...
Epoch: 4 cost time: 6.8688037395477295
Epoch: 4, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.484 Vali Acc: 0.815 Test Loss: 0.484 Test Acc: 0.815
Validation loss decreased (-0.734097 --> -0.815024).  Saving model ...
Epoch: 5 cost time: 6.41076922416687
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.555 Vali Acc: 0.798 Test Loss: 0.555 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.457778692245483
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.414 Vali Acc: 0.873 Test Loss: 0.414 Test Acc: 0.873
Validation loss decreased (-0.815024 --> -0.872828).  Saving model ...
Epoch: 7 cost time: 7.001803874969482
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.946365833282471
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.832 Test Loss: 0.450 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.259451389312744
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.465956926345825
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.898606538772583
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.867 Test Loss: 0.463 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.53746223449707
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.405249834060669
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.604807615280151
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.658527374267578
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.504246711730957
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.96895146369934
Epoch: 1, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.274 Vali Acc: 0.445 Test Loss: 1.274 Test Acc: 0.445
Validation loss decreased (inf --> -0.445074).  Saving model ...
Epoch: 2 cost time: 6.019785404205322
Epoch: 2, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.047 Vali Acc: 0.578 Test Loss: 1.047 Test Acc: 0.578
Validation loss decreased (-0.445074 --> -0.578024).  Saving model ...
Epoch: 3 cost time: 6.723370552062988
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
Validation loss decreased (-0.578024 --> -0.751438).  Saving model ...
Epoch: 4 cost time: 6.722115993499756
Epoch: 4, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.763000).  Saving model ...
Epoch: 5 cost time: 6.237231969833374
Epoch: 5, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.513 Vali Acc: 0.786 Test Loss: 0.513 Test Acc: 0.786
Validation loss decreased (-0.763000 --> -0.786122).  Saving model ...
Epoch: 6 cost time: 6.1599297523498535
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
Validation loss decreased (-0.786122 --> -0.843926).  Saving model ...
Epoch: 7 cost time: 6.9582438468933105
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.7939465045928955
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
Validation loss decreased (-0.843926 --> -0.867048).  Saving model ...
Epoch: 9 cost time: 6.401508808135986
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.1013453006744385
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.936663627624512
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.867 Test Loss: 0.441 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.747722625732422
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.867 Test Loss: 0.438 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.714323043823242
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.205352544784546
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.867 Test Loss: 0.444 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.929665803909302
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.861 Test Loss: 0.441 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.4295079708099365
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.969817638397217
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.867 Test Loss: 0.447 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.418062210083008
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.867 Test Loss: 0.446 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.708866596221924
Epoch: 1, Steps: 17 | Train Loss: 1.785 Vali Loss: 1.308 Vali Acc: 0.422 Test Loss: 1.308 Test Acc: 0.422
Validation loss decreased (inf --> -0.421952).  Saving model ...
Epoch: 2 cost time: 6.797729730606079
Epoch: 2, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
Validation loss decreased (-0.421952 --> -0.595366).  Saving model ...
Epoch: 3 cost time: 6.1237030029296875
Epoch: 3, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.638 Vali Acc: 0.769 Test Loss: 0.638 Test Acc: 0.769
Validation loss decreased (-0.595366 --> -0.768780).  Saving model ...
Epoch: 4 cost time: 7.2189717292785645
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.956871509552002
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809244).  Saving model ...
Epoch: 6 cost time: 6.455628156661987
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.798 Test Loss: 0.607 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.461507320404053
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
Validation loss decreased (-0.809244 --> -0.843926).  Saving model ...
Epoch: 8 cost time: 5.839974403381348
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.815 Test Loss: 0.456 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.250557899475098
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.827 Test Loss: 0.441 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.552459716796875
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.815 Test Loss: 0.446 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.661297082901001
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.821 Test Loss: 0.450 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.026128768920898
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.721438884735107
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.832 Test Loss: 0.453 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.662750244140625
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.074041128158569
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.926650285720825
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.832 Test Loss: 0.453 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.663513422012329
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.024494171142578
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.492 Vali Acc: 0.393 Test Loss: 1.492 Test Acc: 0.393
Validation loss decreased (inf --> -0.393049).  Saving model ...
Epoch: 2 cost time: 6.732362985610962
Epoch: 2, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.001 Vali Acc: 0.624 Test Loss: 1.001 Test Acc: 0.624
Validation loss decreased (-0.393049 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 6.590848207473755
Epoch: 3, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.618 Vali Acc: 0.798 Test Loss: 0.618 Test Acc: 0.798
Validation loss decreased (-0.624267 --> -0.797682).  Saving model ...
Epoch: 4 cost time: 6.80776047706604
Epoch: 4, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.518 Vali Acc: 0.792 Test Loss: 0.518 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.870696544647217
Epoch: 5, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 6 cost time: 6.225342512130737
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.468 Vali Acc: 0.821 Test Loss: 0.468 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820805).  Saving model ...
Epoch: 7 cost time: 6.904097080230713
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.832 Test Loss: 0.467 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 6.656188488006592
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 6.62596583366394
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.838 Test Loss: 0.461 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.55802583694458
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 6.179265975952148
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.495550632476807
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.94325852394104
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.516449451446533
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.298279523849487
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.679610729217529
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.872822523117065
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.304554462432861
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.939051389694214
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.315430164337158
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.186376810073853
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.705 Vali Acc: 0.277 Test Loss: 1.705 Test Acc: 0.277
Validation loss decreased (inf --> -0.277440).  Saving model ...
Epoch: 2 cost time: 6.360006809234619
Epoch: 2, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.254 Vali Acc: 0.561 Test Loss: 1.254 Test Acc: 0.561
Validation loss decreased (-0.277440 --> -0.560681).  Saving model ...
Epoch: 3 cost time: 6.6439549922943115
Epoch: 3, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.804 Vali Acc: 0.705 Test Loss: 0.804 Test Acc: 0.705
Validation loss decreased (-0.560681 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 6.378581762313843
Epoch: 4, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
Validation loss decreased (-0.705194 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 6.147160768508911
Epoch: 5, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.540 Vali Acc: 0.815 Test Loss: 0.540 Test Acc: 0.815
Validation loss decreased (-0.797682 --> -0.815024).  Saving model ...
Epoch: 6 cost time: 6.301185369491577
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.42772364616394
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 6.579607248306274
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.468 Vali Acc: 0.798 Test Loss: 0.468 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.215585708618164
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.821 Test Loss: 0.439 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.352257490158081
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.821 Test Loss: 0.441 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.467539548873901
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.821 Test Loss: 0.446 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.08604884147644
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.821 Test Loss: 0.436 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.603060245513916
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.827 Test Loss: 0.435 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.187467575073242
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.832 Test Loss: 0.431 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832366).  Saving model ...
Epoch: 15 cost time: 6.4733805656433105
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.832 Test Loss: 0.426 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 16 cost time: 6.540525436401367
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.832 Test Loss: 0.425 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 17 cost time: 5.81663966178894
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.827 Test Loss: 0.424 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.910542249679565
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.838 Test Loss: 0.423 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 19 cost time: 6.06187105178833
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.832 Test Loss: 0.422 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.959499359130859
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.832 Test Loss: 0.419 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.011876821517944
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.838 Test Loss: 0.418 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 22 cost time: 6.493136644363403
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.838 Test Loss: 0.416 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 23 cost time: 6.7592620849609375
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.838 Test Loss: 0.412 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 24 cost time: 6.871166467666626
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.838 Test Loss: 0.412 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.687319993972778
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.838 Test Loss: 0.410 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 26 cost time: 5.9089131355285645
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.838 Test Loss: 0.410 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 27 cost time: 6.368192672729492
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.838 Test Loss: 0.407 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 28 cost time: 6.505000829696655
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.844 Test Loss: 0.406 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843927).  Saving model ...
Epoch: 29 cost time: 6.304961919784546
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.838 Test Loss: 0.405 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.5337817668914795
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.838 Test Loss: 0.406 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.341270446777344
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.838 Test Loss: 0.405 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.069451570510864
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.838 Test Loss: 0.405 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.347399950027466
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.838 Test Loss: 0.404 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.97468638420105
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.838 Test Loss: 0.399 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.059901714324951
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
Validation loss decreased (-0.843927 --> -0.855487).  Saving model ...
Epoch: 36 cost time: 6.034535884857178
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 37 cost time: 5.916426658630371
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 38 cost time: 5.848680734634399
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 39 cost time: 5.606302738189697
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.855 Test Loss: 0.397 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.977053642272949
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 41 cost time: 6.18057918548584
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 42 cost time: 6.385344743728638
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 43 cost time: 5.9951512813568115
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 5.831991910934448
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.869892120361328
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.861 Test Loss: 0.397 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 46 cost time: 5.974411487579346
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.863794803619385
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.9412431716918945
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.929945468902588
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.392 Vali Acc: 0.855 Test Loss: 0.392 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 5.746337652206421
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.391 Vali Acc: 0.855 Test Loss: 0.391 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 6.013594388961792
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 6.134925603866577
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.390 Vali Acc: 0.855 Test Loss: 0.390 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 5.890079021453857
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 6.176267147064209
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.855 Test Loss: 0.388 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 5.967078685760498
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.389 Vali Acc: 0.855 Test Loss: 0.389 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.579249382019043
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.798 Vali Acc: 0.249 Test Loss: 1.798 Test Acc: 0.249
Validation loss decreased (inf --> -0.248537).  Saving model ...
Epoch: 2 cost time: 6.363902568817139
Epoch: 2, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.429 Vali Acc: 0.457 Test Loss: 1.429 Test Acc: 0.457
Validation loss decreased (-0.248537 --> -0.456633).  Saving model ...
Epoch: 3 cost time: 6.314045190811157
Epoch: 3, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.994 Vali Acc: 0.705 Test Loss: 0.994 Test Acc: 0.705
Validation loss decreased (-0.456633 --> -0.705192).  Saving model ...
Epoch: 4 cost time: 6.290127754211426
Epoch: 4, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.716 Vali Acc: 0.694 Test Loss: 0.716 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.5745391845703125
Epoch: 5, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
Validation loss decreased (-0.705192 --> -0.745658).  Saving model ...
Epoch: 6 cost time: 6.699378728866577
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
Validation loss decreased (-0.745658 --> -0.757220).  Saving model ...
Epoch: 7 cost time: 6.539154767990112
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.584156036376953
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.723 Test Loss: 0.589 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.419260025024414
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
Validation loss decreased (-0.757220 --> -0.774561).  Saving model ...
Epoch: 10 cost time: 6.808326482772827
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.53081750869751
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.775 Test Loss: 0.559 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 12 cost time: 5.987767934799194
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
Validation loss decreased (-0.774561 --> -0.786122).  Saving model ...
Epoch: 13 cost time: 5.712541341781616
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.481414318084717
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.914855241775513
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.763 Test Loss: 0.541 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.654988050460815
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.1708526611328125
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.786 Test Loss: 0.533 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 18 cost time: 6.725644826889038
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.769 Test Loss: 0.530 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.453411102294922
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.078799486160278
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.775 Test Loss: 0.527 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.193990230560303
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.769 Test Loss: 0.525 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.985858678817749
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.780 Test Loss: 0.519 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.858399391174316
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.780 Test Loss: 0.515 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.748556613922119
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.6739342212677
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.780 Test Loss: 0.514 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.086768388748169
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.792 Test Loss: 0.510 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 27 cost time: 6.104301691055298
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.530723571777344
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.798 Test Loss: 0.505 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 29 cost time: 6.365860939025879
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.078888416290283
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.798 Test Loss: 0.503 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 31 cost time: 6.039162874221802
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.780 Test Loss: 0.500 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.009270429611206
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 33 cost time: 5.870522499084473
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.798 Test Loss: 0.501 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.9731690883636475
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 35 cost time: 5.884632349014282
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.798 Test Loss: 0.493 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.925904035568237
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.792 Test Loss: 0.493 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.424822807312012
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.792 Test Loss: 0.492 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 7.021997928619385
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.798 Test Loss: 0.488 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 6.8157477378845215
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.798 Test Loss: 0.487 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 6.794767379760742
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.798 Test Loss: 0.485 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 6.345852851867676
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.798 Test Loss: 0.484 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.928415775299072
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 43 cost time: 5.787513256072998
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 44 cost time: 5.8728346824646
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.030900716781616
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 46 cost time: 6.056141138076782
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.798 Test Loss: 0.479 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.395693063735962
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.803 Test Loss: 0.478 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 48 cost time: 6.477837800979614
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.803 Test Loss: 0.477 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 49 cost time: 6.247871160507202
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.792 Test Loss: 0.474 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.5153608322143555
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.803 Test Loss: 0.474 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 51 cost time: 6.065124988555908
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.798 Test Loss: 0.474 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.925678968429565
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.792 Test Loss: 0.474 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.051117420196533
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 54 cost time: 5.866666555404663
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 55 cost time: 5.888973236083984
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 56 cost time: 6.006510019302368
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 6.708647012710571
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.809 Test Loss: 0.468 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 58 cost time: 6.558003187179565
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 59 cost time: 6.582216262817383
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.798 Test Loss: 0.467 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.3005475997924805
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.798 Test Loss: 0.467 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 6.201480865478516
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.798 Test Loss: 0.467 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 6.369019269943237
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 6.140215873718262
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.798 Test Loss: 0.464 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 5.898806095123291
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.798 Test Loss: 0.462 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 6.033046245574951
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.803 Test Loss: 0.462 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 6.293673992156982
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.798 Test Loss: 0.460 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 6.126412391662598
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.798 Test Loss: 0.461 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 6.333972215652466
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.798 Test Loss: 0.460 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.962088108062744
Epoch: 1, Steps: 17 | Train Loss: 2.004 Vali Loss: 1.919 Vali Acc: 0.185 Test Loss: 1.919 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 6.290939569473267
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.564 Vali Acc: 0.497 Test Loss: 1.564 Test Acc: 0.497
Validation loss decreased (-0.184952 --> -0.497094).  Saving model ...
Epoch: 3 cost time: 6.060492277145386
Epoch: 3, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.084 Vali Acc: 0.607 Test Loss: 1.084 Test Acc: 0.607
Validation loss decreased (-0.497094 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 5.907617568969727
Epoch: 4, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.836 Vali Acc: 0.647 Test Loss: 0.836 Test Acc: 0.647
Validation loss decreased (-0.606926 --> -0.647390).  Saving model ...
Epoch: 5 cost time: 6.112234830856323
Epoch: 5, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.707 Vali Acc: 0.688 Test Loss: 0.707 Test Acc: 0.688
Validation loss decreased (-0.647390 --> -0.687854).  Saving model ...
Epoch: 6 cost time: 6.0950376987457275
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.680 Vali Acc: 0.699 Test Loss: 0.680 Test Acc: 0.699
Validation loss decreased (-0.687854 --> -0.699415).  Saving model ...
Epoch: 7 cost time: 6.071451425552368
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.740 Test Loss: 0.588 Test Acc: 0.740
Validation loss decreased (-0.699415 --> -0.739879).  Saving model ...
Epoch: 8 cost time: 5.9615397453308105
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.740 Test Loss: 0.613 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.209276437759399
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.775 Test Loss: 0.587 Test Acc: 0.775
Validation loss decreased (-0.739879 --> -0.774561).  Saving model ...
Epoch: 10 cost time: 5.795621871948242
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.811122417449951
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.780 Test Loss: 0.576 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 6.073079824447632
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.786 Test Loss: 0.569 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 13 cost time: 6.1207592487335205
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.786 Test Loss: 0.576 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.1399986743927
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.916502475738525
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.780 Test Loss: 0.560 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.934892654418945
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.4666407108306885
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.780 Test Loss: 0.558 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.471043348312378
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.769 Test Loss: 0.547 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.231880187988281
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.775 Test Loss: 0.549 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.210226774215698
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.792 Test Loss: 0.545 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 21 cost time: 6.342211484909058
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.769 Test Loss: 0.558 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.331569671630859
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.786 Test Loss: 0.541 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.207597732543945
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.786 Test Loss: 0.530 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.736247539520264
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.769 Test Loss: 0.545 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.723405838012695
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.775 Test Loss: 0.525 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.2738072872161865
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.405735492706299
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.780 Test Loss: 0.525 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.978553533554077
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.780 Test Loss: 0.523 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.011882543563843
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.786 Test Loss: 0.524 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.796236515045166
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.786 Test Loss: 0.529 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.546032428741455
Epoch: 1, Steps: 17 | Train Loss: 2.005 Vali Loss: 1.877 Vali Acc: 0.214 Test Loss: 1.877 Test Acc: 0.214
Validation loss decreased (inf --> -0.213854).  Saving model ...
Epoch: 2 cost time: 6.558809041976929
Epoch: 2, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.521 Vali Acc: 0.457 Test Loss: 1.521 Test Acc: 0.457
Validation loss decreased (-0.213854 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 6.038897514343262
Epoch: 3, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.077 Vali Acc: 0.647 Test Loss: 1.077 Test Acc: 0.647
Validation loss decreased (-0.456632 --> -0.647388).  Saving model ...
Epoch: 4 cost time: 6.109216213226318
Epoch: 4, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
Validation loss decreased (-0.647388 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 5.840433835983276
Epoch: 5, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.685 Vali Acc: 0.705 Test Loss: 0.685 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.219329595565796
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.685 Vali Acc: 0.665 Test Loss: 0.685 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.111779451370239
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.642 Vali Acc: 0.659 Test Loss: 0.642 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.089829683303833
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.552 Vali Acc: 0.763 Test Loss: 0.552 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.763000).  Saving model ...
Epoch: 9 cost time: 6.427961349487305
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.469176292419434
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.285942792892456
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.775 Test Loss: 0.533 Test Acc: 0.775
Validation loss decreased (-0.763000 --> -0.774561).  Saving model ...
Epoch: 12 cost time: 6.114274263381958
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.792 Test Loss: 0.525 Test Acc: 0.792
Validation loss decreased (-0.774561 --> -0.791902).  Saving model ...
Epoch: 13 cost time: 6.290544033050537
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.792 Test Loss: 0.523 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 14 cost time: 6.452284574508667
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.5738441944122314
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.798 Test Loss: 0.486 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 16 cost time: 6.594814777374268
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.798 Test Loss: 0.508 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.602187633514404
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.751 Test Loss: 0.507 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.259779453277588
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.792 Test Loss: 0.497 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.154379844665527
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.792 Test Loss: 0.491 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.5392539501190186
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.815 Test Loss: 0.474 Test Acc: 0.815
Validation loss decreased (-0.797683 --> -0.815024).  Saving model ...
Epoch: 21 cost time: 6.197611331939697
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.798 Test Loss: 0.476 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.477251291275024
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.786 Test Loss: 0.464 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.699879884719849
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.803 Test Loss: 0.462 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.617251634597778
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.792 Test Loss: 0.466 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.733977317810059
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.786 Test Loss: 0.463 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.906770706176758
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.786 Test Loss: 0.475 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.087129831314087
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.746 Test Loss: 0.510 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.781745195388794
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.780 Test Loss: 0.484 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.250283479690552
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.786 Test Loss: 0.467 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.47553277015686
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.775 Test Loss: 0.469 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.10389494895935
Epoch: 1, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.840 Vali Acc: 0.197 Test Loss: 1.840 Test Acc: 0.197
Validation loss decreased (inf --> -0.196513).  Saving model ...
Epoch: 2 cost time: 5.83009934425354
Epoch: 2, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.470 Vali Acc: 0.549 Test Loss: 1.470 Test Acc: 0.549
Validation loss decreased (-0.196513 --> -0.549118).  Saving model ...
Epoch: 3 cost time: 5.893723726272583
Epoch: 3, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.031 Vali Acc: 0.682 Test Loss: 1.031 Test Acc: 0.682
Validation loss decreased (-0.549118 --> -0.682071).  Saving model ...
Epoch: 4 cost time: 5.835197687149048
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.781 Vali Acc: 0.699 Test Loss: 0.781 Test Acc: 0.699
Validation loss decreased (-0.682071 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 6.155855417251587
Epoch: 5, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.660 Vali Acc: 0.723 Test Loss: 0.660 Test Acc: 0.723
Validation loss decreased (-0.699414 --> -0.722537).  Saving model ...
Epoch: 6 cost time: 6.216037034988403
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.656 Vali Acc: 0.694 Test Loss: 0.656 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.256218194961548
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.734 Test Loss: 0.560 Test Acc: 0.734
Validation loss decreased (-0.722537 --> -0.734098).  Saving model ...
Epoch: 8 cost time: 6.195960998535156
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
Validation loss decreased (-0.734098 --> -0.745659).  Saving model ...
Epoch: 9 cost time: 5.941689491271973
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
Validation loss decreased (-0.745659 --> -0.751440).  Saving model ...
Epoch: 10 cost time: 5.793010234832764
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.769 Test Loss: 0.524 Test Acc: 0.769
Validation loss decreased (-0.751440 --> -0.768781).  Saving model ...
Epoch: 11 cost time: 6.000511646270752
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.769 Test Loss: 0.509 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 12 cost time: 5.987555980682373
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.775 Test Loss: 0.500 Test Acc: 0.775
Validation loss decreased (-0.768781 --> -0.774561).  Saving model ...
Epoch: 13 cost time: 6.238668441772461
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.780 Test Loss: 0.500 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780342).  Saving model ...
Epoch: 14 cost time: 6.2036521434783936
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.780 Test Loss: 0.495 Test Acc: 0.780
Validation loss decreased (-0.780342 --> -0.780342).  Saving model ...
Epoch: 15 cost time: 6.113718032836914
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.792 Test Loss: 0.476 Test Acc: 0.792
Validation loss decreased (-0.780342 --> -0.791903).  Saving model ...
Epoch: 16 cost time: 6.333916902542114
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.792 Test Loss: 0.490 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.923686504364014
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.798 Test Loss: 0.488 Test Acc: 0.798
Validation loss decreased (-0.791903 --> -0.797683).  Saving model ...
Epoch: 18 cost time: 6.044304847717285
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.792 Test Loss: 0.478 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.864524841308594
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.798 Test Loss: 0.474 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 20 cost time: 6.188962459564209
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.815 Test Loss: 0.452 Test Acc: 0.815
Validation loss decreased (-0.797683 --> -0.815024).  Saving model ...
Epoch: 21 cost time: 6.295903921127319
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.792 Test Loss: 0.462 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.382110595703125
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.815 Test Loss: 0.451 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 23 cost time: 6.20112681388855
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.832 Test Loss: 0.446 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832365).  Saving model ...
Epoch: 24 cost time: 5.983576059341431
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.803 Test Loss: 0.450 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.825516939163208
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.803 Test Loss: 0.448 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.788782358169556
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.803 Test Loss: 0.452 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.716435194015503
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.815 Test Loss: 0.459 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.478587865829468
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.803 Test Loss: 0.453 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.681291103363037
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.803 Test Loss: 0.452 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.934885263442993
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.803 Test Loss: 0.449 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.333860158920288
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.809 Test Loss: 0.436 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.2662036418914795
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.815 Test Loss: 0.431 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.217430830001831
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.815 Test Loss: 0.434 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.156323432922363
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 5.742952346801758
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0348827838897705
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.915678977966309
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.123623847961426
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.47681999206543
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.947349786758423
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.084143400192261
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.854791879653931
Epoch: 9, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.123816251754761
Epoch: 10, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.423058986663818
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15606936416184972
model parameter : 6777351
model size : 35.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.99821138381958
Epoch: 1, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.351 Vali Acc: 0.358 Test Loss: 1.351 Test Acc: 0.358
Validation loss decreased (inf --> -0.358368).  Saving model ...
Epoch: 2 cost time: 5.736092567443848
Epoch: 2, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.978 Vali Acc: 0.624 Test Loss: 0.978 Test Acc: 0.624
Validation loss decreased (-0.358368 --> -0.624268).  Saving model ...
Epoch: 3 cost time: 5.476179599761963
Epoch: 3, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
Validation loss decreased (-0.624268 --> -0.803462).  Saving model ...
Epoch: 4 cost time: 5.934611082077026
Epoch: 4, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 5 cost time: 5.913615465164185
Epoch: 5, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.519 Vali Acc: 0.832 Test Loss: 0.519 Test Acc: 0.832
Validation loss decreased (-0.803462 --> -0.832365).  Saving model ...
Epoch: 6 cost time: 6.234034538269043
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.438 Vali Acc: 0.821 Test Loss: 0.438 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.9424498081207275
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.855 Test Loss: 0.427 Test Acc: 0.855
Validation loss decreased (-0.832365 --> -0.855487).  Saving model ...
Epoch: 8 cost time: 6.684514045715332
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.379767179489136
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 10 cost time: 6.429023265838623
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 6.184036016464233
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.847547769546509
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.01352334022522
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.867101430892944
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.238405466079712
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.335583686828613
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.818568229675293
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.024040937423706
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.184874773025513
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.832 Test Loss: 0.439 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.308455228805542
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.885136604309082
Epoch: 1, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.370 Vali Acc: 0.387 Test Loss: 1.370 Test Acc: 0.387
Validation loss decreased (inf --> -0.387270).  Saving model ...
Epoch: 2 cost time: 6.524760484695435
Epoch: 2, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.955 Vali Acc: 0.601 Test Loss: 0.955 Test Acc: 0.601
Validation loss decreased (-0.387270 --> -0.601147).  Saving model ...
Epoch: 3 cost time: 6.0135862827301025
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.596 Vali Acc: 0.815 Test Loss: 0.596 Test Acc: 0.815
Validation loss decreased (-0.601147 --> -0.815023).  Saving model ...
Epoch: 4 cost time: 6.6601293087005615
Epoch: 4, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.6620752811431885
Epoch: 5, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.682 Vali Acc: 0.757 Test Loss: 0.682 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.965611696243286
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.509 Vali Acc: 0.786 Test Loss: 0.509 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.195101499557495
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.463 Vali Acc: 0.821 Test Loss: 0.463 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820805).  Saving model ...
Epoch: 8 cost time: 6.6849236488342285
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.588 Vali Acc: 0.809 Test Loss: 0.588 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.405406951904297
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.815 Test Loss: 0.502 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.851325035095215
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.4816906452178955
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.827 Test Loss: 0.468 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 12 cost time: 6.197829723358154
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.827 Test Loss: 0.462 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 6.5281665325164795
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.821 Test Loss: 0.471 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.133710861206055
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.815 Test Loss: 0.469 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.8405516147613525
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.827 Test Loss: 0.463 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.299451589584351
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 17 cost time: 6.423449516296387
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 18 cost time: 6.454694509506226
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.821 Test Loss: 0.468 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.889074087142944
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.389271259307861
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.821 Test Loss: 0.468 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.250361919403076
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.821 Test Loss: 0.466 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.419862747192383
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.821 Test Loss: 0.466 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.154487133026123
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.815 Test Loss: 0.469 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.5158445835113525
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.821 Test Loss: 0.471 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.362957239151001
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.815 Test Loss: 0.473 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.54330039024353
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.243567943572998
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.821 Test Loss: 0.470 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.44077467918396
Epoch: 1, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.393 Vali Acc: 0.393 Test Loss: 1.393 Test Acc: 0.393
Validation loss decreased (inf --> -0.393050).  Saving model ...
Epoch: 2 cost time: 6.666161060333252
Epoch: 2, Steps: 17 | Train Loss: 0.932 Vali Loss: 0.950 Vali Acc: 0.572 Test Loss: 0.950 Test Acc: 0.572
Validation loss decreased (-0.393050 --> -0.572245).  Saving model ...
Epoch: 3 cost time: 6.530537366867065
Epoch: 3, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.648 Vali Acc: 0.798 Test Loss: 0.648 Test Acc: 0.798
Validation loss decreased (-0.572245 --> -0.797681).  Saving model ...
Epoch: 4 cost time: 5.828768730163574
Epoch: 4, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803463).  Saving model ...
Epoch: 5 cost time: 6.141023874282837
Epoch: 5, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.682 Vali Acc: 0.780 Test Loss: 0.682 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.147785186767578
Epoch: 6, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.492 Vali Acc: 0.821 Test Loss: 0.492 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 6.554650545120239
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.838 Test Loss: 0.462 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838146).  Saving model ...
Epoch: 8 cost time: 6.98969030380249
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.838146 --> -0.855487).  Saving model ...
Epoch: 9 cost time: 6.530340909957886
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.838 Test Loss: 0.409 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.460750579833984
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.184209585189819
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.074703931808472
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.861 Test Loss: 0.404 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 13 cost time: 5.942950487136841
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.861 Test Loss: 0.416 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.7600226402282715
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.5025975704193115
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.861 Test Loss: 0.414 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.372966289520264
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.442688941955566
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.441947937011719
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.295297622680664
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.204958200454712
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.43352198600769
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.6983115673065186
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.21229100227356
Epoch: 1, Steps: 17 | Train Loss: 1.909 Vali Loss: 1.561 Vali Acc: 0.376 Test Loss: 1.561 Test Acc: 0.376
Validation loss decreased (inf --> -0.375707).  Saving model ...
Epoch: 2 cost time: 5.786858320236206
Epoch: 2, Steps: 17 | Train Loss: 1.016 Vali Loss: 0.992 Vali Acc: 0.624 Test Loss: 0.992 Test Acc: 0.624
Validation loss decreased (-0.375707 --> -0.624268).  Saving model ...
Epoch: 3 cost time: 5.6678688526153564
Epoch: 3, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
Validation loss decreased (-0.624268 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 6.327996015548706
Epoch: 4, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.506 Vali Acc: 0.827 Test Loss: 0.506 Test Acc: 0.827
Validation loss decreased (-0.774559 --> -0.826585).  Saving model ...
Epoch: 5 cost time: 6.055231094360352
Epoch: 5, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.450 Vali Acc: 0.821 Test Loss: 0.450 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.544422388076782
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.826585 --> -0.843926).  Saving model ...
Epoch: 7 cost time: 6.111043930053711
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.792 Test Loss: 0.501 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.028432369232178
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.753173828125
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.832 Test Loss: 0.472 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.69319486618042
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.827 Test Loss: 0.467 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.02404260635376
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.821 Test Loss: 0.467 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.063191890716553
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.096739053726196
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.821 Test Loss: 0.467 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.224090337753296
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.057913780212402
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.976339817047119
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.855186462402344
Epoch: 1, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.755 Vali Acc: 0.347 Test Loss: 1.755 Test Acc: 0.347
Validation loss decreased (inf --> -0.346803).  Saving model ...
Epoch: 2 cost time: 6.326617240905762
Epoch: 2, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.219 Vali Acc: 0.549 Test Loss: 1.219 Test Acc: 0.549
Validation loss decreased (-0.346803 --> -0.549121).  Saving model ...
Epoch: 3 cost time: 6.013511419296265
Epoch: 3, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.845 Vali Acc: 0.740 Test Loss: 0.845 Test Acc: 0.740
Validation loss decreased (-0.549121 --> -0.739876).  Saving model ...
Epoch: 4 cost time: 5.706798791885376
Epoch: 4, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
Validation loss decreased (-0.739876 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 5.687387704849243
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.567 Vali Acc: 0.775 Test Loss: 0.567 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774561).  Saving model ...
Epoch: 6 cost time: 5.89018440246582
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.528 Vali Acc: 0.821 Test Loss: 0.528 Test Acc: 0.821
Validation loss decreased (-0.774561 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 5.947436094284058
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.827 Test Loss: 0.537 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 8 cost time: 6.16776442527771
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.792 Test Loss: 0.512 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.0748350620269775
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.815 Test Loss: 0.499 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.177523136138916
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.821 Test Loss: 0.493 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.9365458488464355
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.993283033370972
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.815 Test Loss: 0.490 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.9673097133636475
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.717845916748047
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.774895906448364
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.858781099319458
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.217008352279663
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.980841398239136
Epoch: 1, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.814 Vali Acc: 0.324 Test Loss: 1.814 Test Acc: 0.324
Validation loss decreased (inf --> -0.323681).  Saving model ...
Epoch: 2 cost time: 6.409960508346558
Epoch: 2, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.299 Vali Acc: 0.566 Test Loss: 1.299 Test Acc: 0.566
Validation loss decreased (-0.323681 --> -0.566461).  Saving model ...
Epoch: 3 cost time: 6.3520214557647705
Epoch: 3, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.937 Vali Acc: 0.723 Test Loss: 0.937 Test Acc: 0.723
Validation loss decreased (-0.566461 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 6.531041145324707
Epoch: 4, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.765 Vali Acc: 0.723 Test Loss: 0.765 Test Acc: 0.723
Validation loss decreased (-0.722534 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 6.417976379394531
Epoch: 5, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.705 Vali Acc: 0.694 Test Loss: 0.705 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.014589071273804
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.642 Vali Acc: 0.728 Test Loss: 0.642 Test Acc: 0.728
Validation loss decreased (-0.722536 --> -0.728317).  Saving model ...
Epoch: 7 cost time: 6.159768581390381
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.751 Test Loss: 0.601 Test Acc: 0.751
Validation loss decreased (-0.728317 --> -0.751439).  Saving model ...
Epoch: 8 cost time: 6.017327308654785
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757220).  Saving model ...
Epoch: 9 cost time: 6.502675771713257
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.3718767166137695
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
Validation loss decreased (-0.757220 --> -0.786122).  Saving model ...
Epoch: 11 cost time: 6.527210235595703
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.407365560531616
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.792 Test Loss: 0.542 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 13 cost time: 6.44918417930603
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.116144180297852
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 15 cost time: 6.962646961212158
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 16 cost time: 5.988338232040405
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.792 Test Loss: 0.527 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 17 cost time: 6.189499616622925
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.780 Test Loss: 0.523 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.019601345062256
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 19 cost time: 6.3959009647369385
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.798 Test Loss: 0.517 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.696211099624634
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 21 cost time: 6.701611757278442
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.786 Test Loss: 0.516 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.292383909225464
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 23 cost time: 7.079296588897705
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 24 cost time: 6.904426097869873
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809244).  Saving model ...
Epoch: 25 cost time: 6.911184310913086
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.815 Test Loss: 0.500 Test Acc: 0.815
Validation loss decreased (-0.809244 --> -0.815024).  Saving model ...
Epoch: 26 cost time: 6.681223630905151
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.332958936691284
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.889321327209473
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.665618658065796
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.815 Test Loss: 0.489 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 30 cost time: 6.9703450202941895
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.785902976989746
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 7.281244277954102
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.777340650558472
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 6.724592447280884
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 35 cost time: 7.132428884506226
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.821 Test Loss: 0.477 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 36 cost time: 6.735929727554321
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.932741641998291
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820805).  Saving model ...
Epoch: 38 cost time: 6.646680593490601
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.815 Test Loss: 0.470 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.50263524055481
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.9243268966674805
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.821 Test Loss: 0.470 Test Acc: 0.821
Validation loss decreased (-0.820805 --> -0.820805).  Saving model ...
Epoch: 41 cost time: 6.599304676055908
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.832 Test Loss: 0.466 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 42 cost time: 6.423698663711548
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 43 cost time: 5.794617652893066
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 44 cost time: 6.036647796630859
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.872081756591797
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.832 Test Loss: 0.458 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 46 cost time: 6.202834129333496
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.832 Test Loss: 0.457 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 47 cost time: 6.531030178070068
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 48 cost time: 5.750922441482544
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.698639154434204
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.838 Test Loss: 0.453 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.591487646102905
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.838 Test Loss: 0.452 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.323402643203735
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.832 Test Loss: 0.453 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.676679849624634
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.832 Test Loss: 0.453 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.512287616729736
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.832 Test Loss: 0.450 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 6.218156576156616
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 5.880911350250244
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.832 Test Loss: 0.446 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 5.863199949264526
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 5.846390724182129
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.832 Test Loss: 0.446 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.89424729347229
Epoch: 1, Steps: 17 | Train Loss: 1.963 Vali Loss: 1.881 Vali Acc: 0.283 Test Loss: 1.881 Test Acc: 0.283
Validation loss decreased (inf --> -0.283218).  Saving model ...
Epoch: 2 cost time: 6.083904027938843
Epoch: 2, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.437 Vali Acc: 0.549 Test Loss: 1.437 Test Acc: 0.549
Validation loss decreased (-0.283218 --> -0.549119).  Saving model ...
Epoch: 3 cost time: 6.395124673843384
Epoch: 3, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.137 Vali Acc: 0.578 Test Loss: 1.137 Test Acc: 0.578
Validation loss decreased (-0.549119 --> -0.578023).  Saving model ...
Epoch: 4 cost time: 6.693331241607666
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.861 Vali Acc: 0.699 Test Loss: 0.861 Test Acc: 0.699
Validation loss decreased (-0.578023 --> -0.699413).  Saving model ...
Epoch: 5 cost time: 6.318222761154175
Epoch: 5, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.793 Vali Acc: 0.636 Test Loss: 0.793 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.192235469818115
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.697 Vali Acc: 0.699 Test Loss: 0.697 Test Acc: 0.699
Validation loss decreased (-0.699413 --> -0.699415).  Saving model ...
Epoch: 7 cost time: 6.03973650932312
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.643 Vali Acc: 0.699 Test Loss: 0.643 Test Acc: 0.699
Validation loss decreased (-0.699415 --> -0.699416).  Saving model ...
Epoch: 8 cost time: 6.104658603668213
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.631 Vali Acc: 0.734 Test Loss: 0.631 Test Acc: 0.734
Validation loss decreased (-0.699416 --> -0.734098).  Saving model ...
Epoch: 9 cost time: 6.474791526794434
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.699 Test Loss: 0.621 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.569990396499634
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.728 Test Loss: 0.599 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.354322910308838
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.723 Test Loss: 0.608 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.8140692710876465
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.734 Test Loss: 0.577 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 13 cost time: 6.05904483795166
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.734 Test Loss: 0.601 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.3840413093566895
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
Validation loss decreased (-0.734098 --> -0.745659).  Saving model ...
Epoch: 15 cost time: 6.128881216049194
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.734 Test Loss: 0.602 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.325074911117554
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.728 Test Loss: 0.597 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.87311315536499
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
Validation loss decreased (-0.745659 --> -0.757220).  Saving model ...
Epoch: 18 cost time: 5.935396671295166
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.945144891738892
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.1936821937561035
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.066155910491943
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.8217689990997314
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.137790679931641
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.747215986251831
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.746 Test Loss: 0.564 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.3479485511779785
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.751 Test Loss: 0.552 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.020833969116211
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.740 Test Loss: 0.567 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.229790687561035
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.746 Test Loss: 0.555 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.741137266159058
Epoch: 1, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.913 Vali Acc: 0.260 Test Loss: 1.913 Test Acc: 0.260
Validation loss decreased (inf --> -0.260096).  Saving model ...
Epoch: 2 cost time: 5.652623414993286
Epoch: 2, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.476 Vali Acc: 0.526 Test Loss: 1.476 Test Acc: 0.526
Validation loss decreased (-0.260096 --> -0.525997).  Saving model ...
Epoch: 3 cost time: 5.6064980030059814
Epoch: 3, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.158 Vali Acc: 0.601 Test Loss: 1.158 Test Acc: 0.601
Validation loss decreased (-0.525997 --> -0.601144).  Saving model ...
Epoch: 4 cost time: 6.13034725189209
Epoch: 4, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.858 Vali Acc: 0.746 Test Loss: 0.858 Test Acc: 0.746
Validation loss decreased (-0.601144 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 6.153419733047485
Epoch: 5, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.734 Vali Acc: 0.665 Test Loss: 0.734 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.213247776031494
Epoch: 6, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.599 Vali Acc: 0.734 Test Loss: 0.599 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.0633368492126465
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
Validation loss decreased (-0.745656 --> -0.751439).  Saving model ...
Epoch: 8 cost time: 6.004290819168091
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.670 Vali Acc: 0.688 Test Loss: 0.670 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.310759782791138
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.510 Vali Acc: 0.792 Test Loss: 0.510 Test Acc: 0.792
Validation loss decreased (-0.751439 --> -0.791902).  Saving model ...
Epoch: 10 cost time: 6.440633535385132
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.769 Test Loss: 0.495 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.320348739624023
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.746 Test Loss: 0.518 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.795474529266357
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.780 Test Loss: 0.490 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.8249757289886475
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.780 Test Loss: 0.511 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.184354543685913
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.775 Test Loss: 0.491 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.170349836349487
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.798 Test Loss: 0.485 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 16 cost time: 5.973737955093384
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
Validation loss decreased (-0.797683 --> -0.809244).  Saving model ...
Epoch: 17 cost time: 5.802630424499512
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.827 Test Loss: 0.461 Test Acc: 0.827
Validation loss decreased (-0.809244 --> -0.826585).  Saving model ...
Epoch: 18 cost time: 6.435329914093018
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.691873073577881
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.815 Test Loss: 0.468 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.880751371383667
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.827 Test Loss: 0.456 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 21 cost time: 6.970271110534668
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 22 cost time: 6.713075160980225
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.832 Test Loss: 0.457 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.967436790466309
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.815 Test Loss: 0.460 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.727665901184082
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.821 Test Loss: 0.445 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.833208322525024
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.821 Test Loss: 0.443 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.177799940109253
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.821 Test Loss: 0.450 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.893605470657349
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.815 Test Loss: 0.457 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.6534035205841064
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.815 Test Loss: 0.451 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.615182161331177
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.821 Test Loss: 0.436 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.2098939418792725
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.827 Test Loss: 0.433 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.919389963150024
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.821 Test Loss: 0.432 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.536257743835449
Epoch: 1, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.927 Vali Acc: 0.202 Test Loss: 1.927 Test Acc: 0.202
Validation loss decreased (inf --> -0.202293).  Saving model ...
Epoch: 2 cost time: 5.390080690383911
Epoch: 2, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.464 Vali Acc: 0.491 Test Loss: 1.464 Test Acc: 0.491
Validation loss decreased (-0.202293 --> -0.491315).  Saving model ...
Epoch: 3 cost time: 6.001103401184082
Epoch: 3, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.114 Vali Acc: 0.607 Test Loss: 1.114 Test Acc: 0.607
Validation loss decreased (-0.491315 --> -0.606925).  Saving model ...
Epoch: 4 cost time: 6.485705852508545
Epoch: 4, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.869 Vali Acc: 0.676 Test Loss: 0.869 Test Acc: 0.676
Validation loss decreased (-0.606925 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 6.007948637008667
Epoch: 5, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.706 Vali Acc: 0.723 Test Loss: 0.706 Test Acc: 0.723
Validation loss decreased (-0.676292 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 5.83207368850708
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.557 Vali Acc: 0.786 Test Loss: 0.557 Test Acc: 0.786
Validation loss decreased (-0.722536 --> -0.786122).  Saving model ...
Epoch: 7 cost time: 5.9272730350494385
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.505 Vali Acc: 0.821 Test Loss: 0.505 Test Acc: 0.821
Validation loss decreased (-0.786122 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 6.5659098625183105
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.540 Vali Acc: 0.734 Test Loss: 0.540 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.115805625915527
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838146).  Saving model ...
Epoch: 10 cost time: 6.521949052810669
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849706).  Saving model ...
Epoch: 11 cost time: 6.883331775665283
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.815 Test Loss: 0.474 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.005086183547974
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.838 Test Loss: 0.440 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.968595743179321
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.844 Test Loss: 0.451 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.815296173095703
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.9506518840789795
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.770132541656494
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.743653297424316
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.861 Test Loss: 0.412 Test Acc: 0.861
Validation loss decreased (-0.849706 --> -0.861268).  Saving model ...
Epoch: 18 cost time: 6.40169358253479
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.828242301940918
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.021040678024292
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.844 Test Loss: 0.402 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.785017490386963
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.832 Test Loss: 0.399 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.133303880691528
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.838 Test Loss: 0.398 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.778203248977661
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.844 Test Loss: 0.399 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.6275012493133545
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.393 Vali Acc: 0.832 Test Loss: 0.393 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.798673629760742
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.838 Test Loss: 0.385 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.072398900985718
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.394 Vali Acc: 0.832 Test Loss: 0.394 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.292164325714111
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.838 Test Loss: 0.397 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.382848739624023
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 6.2227301597595215
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.9294753074646
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.1176862716674805
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.3328917026519775
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.9884326457977295
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.536840438842773
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.566379070281982
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.210691452026367
Epoch: 9, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.851729154586792
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.997997999191284
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.14450867052023122
model parameter : 5204487
model size : 29.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.713333606719971
Epoch: 1, Steps: 17 | Train Loss: 1.678 Vali Loss: 1.265 Vali Acc: 0.532 Test Loss: 1.265 Test Acc: 0.532
Validation loss decreased (inf --> -0.531779).  Saving model ...
Epoch: 2 cost time: 6.137283802032471
Epoch: 2, Steps: 17 | Train Loss: 1.002 Vali Loss: 0.919 Vali Acc: 0.578 Test Loss: 0.919 Test Acc: 0.578
Validation loss decreased (-0.531779 --> -0.578025).  Saving model ...
Epoch: 3 cost time: 6.311435699462891
Epoch: 3, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
Validation loss decreased (-0.578025 --> -0.774560).  Saving model ...
Epoch: 4 cost time: 6.184112310409546
Epoch: 4, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.538 Vali Acc: 0.769 Test Loss: 0.538 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.953405857086182
Epoch: 5, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.635 Vali Acc: 0.792 Test Loss: 0.635 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 6.189250230789185
Epoch: 6, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.543 Vali Acc: 0.827 Test Loss: 0.543 Test Acc: 0.827
Validation loss decreased (-0.791901 --> -0.826584).  Saving model ...
Epoch: 7 cost time: 6.003497123718262
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 8 cost time: 6.1837077140808105
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.884 Test Loss: 0.444 Test Acc: 0.884
Validation loss decreased (-0.843926 --> -0.884389).  Saving model ...
Epoch: 9 cost time: 5.502283096313477
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
Validation loss decreased (-0.884389 --> -0.884389).  Saving model ...
Epoch: 10 cost time: 5.679570436477661
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.890 Test Loss: 0.410 Test Acc: 0.890
Validation loss decreased (-0.884389 --> -0.890169).  Saving model ...
Epoch: 11 cost time: 6.087055444717407
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.873 Test Loss: 0.436 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.249181270599365
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.867 Test Loss: 0.415 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.499927282333374
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.884 Test Loss: 0.434 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.918264865875244
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.890 Test Loss: 0.434 Test Acc: 0.890
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.226377725601196
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.884 Test Loss: 0.431 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.5148913860321045
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.867 Test Loss: 0.436 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.427356719970703
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.884 Test Loss: 0.434 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.133878231048584
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.81753396987915
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.867 Test Loss: 0.445 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.997308015823364
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.884 Test Loss: 0.441 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8901734104046243
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.890640497207642
Epoch: 1, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.283 Vali Acc: 0.514 Test Loss: 1.283 Test Acc: 0.514
Validation loss decreased (inf --> -0.514438).  Saving model ...
Epoch: 2 cost time: 6.576025485992432
Epoch: 2, Steps: 17 | Train Loss: 0.965 Vali Loss: 0.878 Vali Acc: 0.613 Test Loss: 0.878 Test Acc: 0.613
Validation loss decreased (-0.514438 --> -0.612708).  Saving model ...
Epoch: 3 cost time: 6.5208961963653564
Epoch: 3, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.604 Vali Acc: 0.792 Test Loss: 0.604 Test Acc: 0.792
Validation loss decreased (-0.612708 --> -0.791901).  Saving model ...
Epoch: 4 cost time: 6.3331029415130615
Epoch: 4, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.511 Vali Acc: 0.780 Test Loss: 0.511 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.0725812911987305
Epoch: 5, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.441 Vali Acc: 0.867 Test Loss: 0.441 Test Acc: 0.867
Validation loss decreased (-0.791901 --> -0.867048).  Saving model ...
Epoch: 6 cost time: 6.114391088485718
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.659 Vali Acc: 0.757 Test Loss: 0.659 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.487956285476685
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 8 cost time: 6.2905659675598145
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.815 Test Loss: 0.619 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.797844171524048
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.861 Test Loss: 0.413 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.782819986343384
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.985398530960083
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.402 Vali Acc: 0.844 Test Loss: 0.402 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.263933420181274
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.079761505126953
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.867 Test Loss: 0.365 Test Acc: 0.867
Validation loss decreased (-0.867048 --> -0.867048).  Saving model ...
Epoch: 14 cost time: 6.002258777618408
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.904637813568115
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.855 Test Loss: 0.373 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.36342191696167
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.855 Test Loss: 0.375 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.218565940856934
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.374 Vali Acc: 0.855 Test Loss: 0.374 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.108877658843994
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.861 Test Loss: 0.377 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.996962308883667
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.8719353675842285
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.335965394973755
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.855 Test Loss: 0.385 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.49807071685791
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.6891584396362305
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.105814933776855
Epoch: 1, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.343 Vali Acc: 0.514 Test Loss: 1.343 Test Acc: 0.514
Validation loss decreased (inf --> -0.514437).  Saving model ...
Epoch: 2 cost time: 6.05479621887207
Epoch: 2, Steps: 17 | Train Loss: 0.967 Vali Loss: 0.832 Vali Acc: 0.711 Test Loss: 0.832 Test Acc: 0.711
Validation loss decreased (-0.514437 --> -0.710974).  Saving model ...
Epoch: 3 cost time: 5.834299564361572
Epoch: 3, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.620 Vali Acc: 0.786 Test Loss: 0.620 Test Acc: 0.786
Validation loss decreased (-0.710974 --> -0.786121).  Saving model ...
Epoch: 4 cost time: 6.303173303604126
Epoch: 4, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.514 Vali Acc: 0.769 Test Loss: 0.514 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.369472026824951
Epoch: 5, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.453 Vali Acc: 0.838 Test Loss: 0.453 Test Acc: 0.838
Validation loss decreased (-0.786121 --> -0.838146).  Saving model ...
Epoch: 6 cost time: 7.038177490234375
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.786 Test Loss: 0.662 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.857613801956177
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.414 Vali Acc: 0.809 Test Loss: 0.414 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.176084041595459
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.294896364212036
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.844 Test Loss: 0.385 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843927).  Saving model ...
Epoch: 10 cost time: 6.343872547149658
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
Validation loss decreased (-0.843927 --> -0.843927).  Saving model ...
Epoch: 11 cost time: 5.972766637802124
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.838 Test Loss: 0.383 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.041574716567993
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.377 Vali Acc: 0.838 Test Loss: 0.377 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.549973011016846
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.380 Vali Acc: 0.838 Test Loss: 0.380 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.455442428588867
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.838 Test Loss: 0.385 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.330687999725342
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
Validation loss decreased (-0.843927 --> -0.849707).  Saving model ...
Epoch: 16 cost time: 5.8655173778533936
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.525946378707886
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.844 Test Loss: 0.379 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.532927989959717
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.382 Vali Acc: 0.844 Test Loss: 0.382 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.098151206970215
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.838 Test Loss: 0.383 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.215657711029053
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.477733373641968
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.838 Test Loss: 0.383 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.844036340713501
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.383 Vali Acc: 0.838 Test Loss: 0.383 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.141655683517456
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.838 Test Loss: 0.387 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.40738582611084
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.387 Vali Acc: 0.844 Test Loss: 0.387 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.375610589981079
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.838 Test Loss: 0.385 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.994504690170288
Epoch: 1, Steps: 17 | Train Loss: 1.859 Vali Loss: 1.544 Vali Acc: 0.468 Test Loss: 1.544 Test Acc: 0.468
Validation loss decreased (inf --> -0.468193).  Saving model ...
Epoch: 2 cost time: 6.8633952140808105
Epoch: 2, Steps: 17 | Train Loss: 1.074 Vali Loss: 0.908 Vali Acc: 0.723 Test Loss: 0.908 Test Acc: 0.723
Validation loss decreased (-0.468193 --> -0.722534).  Saving model ...
Epoch: 3 cost time: 6.080633163452148
Epoch: 3, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.640 Vali Acc: 0.769 Test Loss: 0.640 Test Acc: 0.769
Validation loss decreased (-0.722534 --> -0.768780).  Saving model ...
Epoch: 4 cost time: 6.761205673217773
Epoch: 4, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.497122049331665
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
Validation loss decreased (-0.768780 --> -0.815024).  Saving model ...
Epoch: 6 cost time: 6.0571959018707275
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.102877140045166
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.832 Test Loss: 0.459 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 6.71152400970459
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.779896259307861
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.827 Test Loss: 0.459 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.325989007949829
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 6.1822333335876465
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.867449045181274
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 13 cost time: 6.801856517791748
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.832 Test Loss: 0.450 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.420054197311401
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.145533323287964
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.844 Test Loss: 0.445 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 6.71497368812561
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.827 Test Loss: 0.447 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.475878000259399
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.844 Test Loss: 0.445 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.8923399448394775
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.844 Test Loss: 0.445 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.970860719680786
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 20 cost time: 6.499188423156738
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.838 Test Loss: 0.448 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.234883069992065
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.143866300582886
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.403958559036255
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.844 Test Loss: 0.449 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.623255968093872
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.838 Test Loss: 0.449 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.710407733917236
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.387582778930664
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.850 Test Loss: 0.446 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.918193578720093
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.844 Test Loss: 0.450 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.047834396362305
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.983479738235474
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.016328573226929
Epoch: 1, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.703 Vali Acc: 0.341 Test Loss: 1.703 Test Acc: 0.341
Validation loss decreased (inf --> -0.341023).  Saving model ...
Epoch: 2 cost time: 6.534172058105469
Epoch: 2, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.171 Vali Acc: 0.647 Test Loss: 1.171 Test Acc: 0.647
Validation loss decreased (-0.341023 --> -0.647387).  Saving model ...
Epoch: 3 cost time: 6.494126558303833
Epoch: 3, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.858 Vali Acc: 0.642 Test Loss: 0.858 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.03896951675415
Epoch: 4, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
Validation loss decreased (-0.647387 --> -0.751439).  Saving model ...
Epoch: 5 cost time: 6.638813257217407
Epoch: 5, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
Validation loss decreased (-0.751439 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 6.584590673446655
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.473724365234375
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.809 Test Loss: 0.506 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 5.674614667892456
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.815 Test Loss: 0.511 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 9 cost time: 6.583867788314819
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.792 Test Loss: 0.512 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.618185758590698
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.815 Test Loss: 0.489 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 11 cost time: 5.948862552642822
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.821 Test Loss: 0.501 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 12 cost time: 6.16635274887085
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.821 Test Loss: 0.488 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 6.654648303985596
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.821 Test Loss: 0.485 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 14 cost time: 6.571052312850952
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.821 Test Loss: 0.482 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 15 cost time: 6.232997179031372
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 16 cost time: 6.568521022796631
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.827 Test Loss: 0.479 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.506337642669678
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 18 cost time: 6.230093002319336
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.827 Test Loss: 0.472 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 19 cost time: 5.927889108657837
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.827 Test Loss: 0.467 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 20 cost time: 6.566798448562622
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.827 Test Loss: 0.468 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.436658143997192
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.827 Test Loss: 0.464 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 22 cost time: 5.852553606033325
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.827 Test Loss: 0.464 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 23 cost time: 6.122171401977539
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.827 Test Loss: 0.462 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 24 cost time: 6.65461277961731
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.827 Test Loss: 0.458 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 25 cost time: 5.773342132568359
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.827 Test Loss: 0.457 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 26 cost time: 6.331335544586182
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.827 Test Loss: 0.452 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 27 cost time: 6.36257004737854
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.827 Test Loss: 0.451 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 28 cost time: 6.0247886180877686
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.827 Test Loss: 0.450 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 29 cost time: 5.914494752883911
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.827 Test Loss: 0.451 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.512331962585449
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 31 cost time: 6.519265174865723
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.827 Test Loss: 0.446 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 32 cost time: 5.884042024612427
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.838 Test Loss: 0.446 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838146).  Saving model ...
Epoch: 33 cost time: 6.35661506652832
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.827 Test Loss: 0.445 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.42387580871582
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 35 cost time: 5.828184604644775
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 36 cost time: 6.486974000930786
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 37 cost time: 6.53576135635376
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.838 Test Loss: 0.441 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 38 cost time: 6.369960069656372
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.838 Test Loss: 0.440 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 39 cost time: 6.48301100730896
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.838 Test Loss: 0.436 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 40 cost time: 6.844785451889038
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.838 Test Loss: 0.436 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.687865972518921
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.838 Test Loss: 0.434 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 42 cost time: 6.468565464019775
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.838 Test Loss: 0.434 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.729772567749023
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.838 Test Loss: 0.434 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.785291433334351
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.838 Test Loss: 0.433 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 45 cost time: 5.814743518829346
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.838 Test Loss: 0.433 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 46 cost time: 5.737216234207153
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.838 Test Loss: 0.430 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 47 cost time: 5.533108949661255
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.838 Test Loss: 0.429 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 48 cost time: 5.865433216094971
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.838 Test Loss: 0.428 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 49 cost time: 6.224043846130371
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.838 Test Loss: 0.429 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.0781333446502686
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 51 cost time: 6.290916204452515
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.838 Test Loss: 0.428 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.297784328460693
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 53 cost time: 6.514899492263794
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.838 Test Loss: 0.426 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.636319875717163
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.838 Test Loss: 0.425 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.4937756061553955
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 56 cost time: 5.777280569076538
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 57 cost time: 6.112746000289917
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 58 cost time: 6.0586981773376465
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.850 Test Loss: 0.422 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 59 cost time: 5.736297845840454
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 60 cost time: 6.513813018798828
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.337770938873291
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.24600076675415
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 63 cost time: 6.457423686981201
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 64 cost time: 6.145081996917725
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 65 cost time: 6.062600135803223
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.5617499351501465
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 5.577758312225342
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 68 cost time: 5.803354263305664
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 69 cost time: 5.772225856781006
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 70 cost time: 5.973219394683838
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 71 cost time: 6.581577777862549
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.387814283370972
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.161836385726929
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 74 cost time: 6.235086917877197
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 75 cost time: 5.876086711883545
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 76 cost time: 6.392215251922607
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 77 cost time: 5.4447102546691895
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.850 Test Loss: 0.415 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 78 cost time: 5.508439779281616
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 79 cost time: 5.353168725967407
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 80 cost time: 6.174435377120972
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 81 cost time: 6.227204322814941
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 82 cost time: 6.420787811279297
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.850 Test Loss: 0.414 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 6.035275459289551
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 84 cost time: 6.046206712722778
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 85 cost time: 6.116807699203491
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 86 cost time: 5.939601182937622
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 87 cost time: 5.613794803619385
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.849707 --> -0.849707).  Saving model ...
Epoch: 88 cost time: 6.038104057312012
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 6.184097528457642
Epoch: 89, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 6.007400035858154
Epoch: 90, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 6.171405076980591
Epoch: 91, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 6.2056543827056885
Epoch: 92, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 5.88761305809021
Epoch: 93, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 5.9052605628967285
Epoch: 94, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 6.228015184402466
Epoch: 95, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 6.217862606048584
Epoch: 96, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 6.286026477813721
Epoch: 97, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.006388664245605
Epoch: 1, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.794 Vali Acc: 0.347 Test Loss: 1.794 Test Acc: 0.347
Validation loss decreased (inf --> -0.346803).  Saving model ...
Epoch: 2 cost time: 6.5543577671051025
Epoch: 2, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.306 Vali Acc: 0.601 Test Loss: 1.306 Test Acc: 0.601
Validation loss decreased (-0.346803 --> -0.601143).  Saving model ...
Epoch: 3 cost time: 6.5989766120910645
Epoch: 3, Steps: 17 | Train Loss: 0.756 Vali Loss: 1.021 Vali Acc: 0.618 Test Loss: 1.021 Test Acc: 0.618
Validation loss decreased (-0.601143 --> -0.618487).  Saving model ...
Epoch: 4 cost time: 6.255236864089966
Epoch: 4, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.866 Vali Acc: 0.613 Test Loss: 0.866 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.454968690872192
Epoch: 5, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
Validation loss decreased (-0.618487 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 6.475609540939331
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.622486591339111
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.740 Test Loss: 0.593 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.369327068328857
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.649568319320679
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.964824914932251
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774561).  Saving model ...
Epoch: 11 cost time: 6.56569504737854
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.24290132522583
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.365974426269531
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.769 Test Loss: 0.568 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.1496100425720215
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 15 cost time: 6.400914907455444
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.786 Test Loss: 0.557 Test Acc: 0.786
Validation loss decreased (-0.774561 --> -0.786122).  Saving model ...
Epoch: 16 cost time: 6.015417575836182
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.737093687057495
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.775 Test Loss: 0.554 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.528221368789673
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.780 Test Loss: 0.545 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.374883651733398
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.786 Test Loss: 0.540 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 20 cost time: 6.781250715255737
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.780 Test Loss: 0.540 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.80572509765625
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 22 cost time: 6.84143328666687
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.786 Test Loss: 0.532 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 23 cost time: 6.839702129364014
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.792 Test Loss: 0.532 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 24 cost time: 7.174404621124268
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.786 Test Loss: 0.530 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.781760215759277
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.786 Test Loss: 0.527 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.076011896133423
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.780 Test Loss: 0.518 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.815597057342529
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.780 Test Loss: 0.516 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 7.0827436447143555
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.780 Test Loss: 0.515 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.661034107208252
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.780 Test Loss: 0.515 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.91041898727417
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.780 Test Loss: 0.515 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.4845850467681885
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.786 Test Loss: 0.507 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.6476404666900635
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.026159763336182
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.155582666397095
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.858 Vali Acc: 0.260 Test Loss: 1.858 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 5.92191743850708
Epoch: 2, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.463 Vali Acc: 0.549 Test Loss: 1.463 Test Acc: 0.549
Validation loss decreased (-0.260097 --> -0.549118).  Saving model ...
Epoch: 3 cost time: 6.7291100025177
Epoch: 3, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.233 Vali Acc: 0.584 Test Loss: 1.233 Test Acc: 0.584
Validation loss decreased (-0.549118 --> -0.583803).  Saving model ...
Epoch: 4 cost time: 6.667893648147583
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.008 Vali Acc: 0.618 Test Loss: 1.008 Test Acc: 0.618
Validation loss decreased (-0.583803 --> -0.618487).  Saving model ...
Epoch: 5 cost time: 6.2524094581604
Epoch: 5, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.716 Vali Acc: 0.653 Test Loss: 0.716 Test Acc: 0.653
Validation loss decreased (-0.618487 --> -0.653172).  Saving model ...
Epoch: 6 cost time: 6.006804943084717
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.768 Vali Acc: 0.618 Test Loss: 0.768 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.222930431365967
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.593 Vali Acc: 0.734 Test Loss: 0.593 Test Acc: 0.734
Validation loss decreased (-0.653172 --> -0.734098).  Saving model ...
Epoch: 8 cost time: 6.320128440856934
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.694 Test Loss: 0.634 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.6907057762146
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.694 Test Loss: 0.604 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.1752402782440186
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.705 Test Loss: 0.579 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.13565468788147
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.740 Test Loss: 0.589 Test Acc: 0.740
Validation loss decreased (-0.734098 --> -0.739879).  Saving model ...
Epoch: 12 cost time: 5.918931245803833
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.728 Test Loss: 0.577 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.03150486946106
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.723 Test Loss: 0.573 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.897643089294434
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.740 Test Loss: 0.573 Test Acc: 0.740
Validation loss decreased (-0.739879 --> -0.739879).  Saving model ...
Epoch: 15 cost time: 6.379806756973267
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.740 Test Loss: 0.557 Test Acc: 0.740
Validation loss decreased (-0.739879 --> -0.739879).  Saving model ...
Epoch: 16 cost time: 6.138528823852539
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.728 Test Loss: 0.557 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.004196882247925
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.740 Test Loss: 0.551 Test Acc: 0.740
Validation loss decreased (-0.739879 --> -0.739879).  Saving model ...
Epoch: 18 cost time: 5.888379812240601
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.734 Test Loss: 0.548 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.292868614196777
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.734 Test Loss: 0.549 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.440690517425537
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
Validation loss decreased (-0.739879 --> -0.757220).  Saving model ...
Epoch: 21 cost time: 6.1164281368255615
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.757 Test Loss: 0.537 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 22 cost time: 6.063235759735107
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.751 Test Loss: 0.531 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.96782922744751
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.734 Test Loss: 0.539 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.892453908920288
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 25 cost time: 6.026315212249756
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.780 Test Loss: 0.527 Test Acc: 0.780
Validation loss decreased (-0.757220 --> -0.780342).  Saving model ...
Epoch: 26 cost time: 6.128032207489014
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.166696548461914
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.775 Test Loss: 0.513 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.088283061981201
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.786 Test Loss: 0.511 Test Acc: 0.786
Validation loss decreased (-0.780342 --> -0.786122).  Saving model ...
Epoch: 29 cost time: 6.414083957672119
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.775 Test Loss: 0.513 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.507883787155151
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.769 Test Loss: 0.516 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.522210121154785
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.786 Test Loss: 0.502 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 32 cost time: 6.254237651824951
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.786 Test Loss: 0.499 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 33 cost time: 5.621674299240112
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.769 Test Loss: 0.508 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.571948766708374
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.880030393600464
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.763 Test Loss: 0.504 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.795905590057373
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.757 Test Loss: 0.500 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.931658029556274
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.798 Test Loss: 0.495 Test Acc: 0.798
Validation loss decreased (-0.786122 --> -0.797683).  Saving model ...
Epoch: 38 cost time: 6.096900224685669
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.792 Test Loss: 0.502 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.378561019897461
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.433239221572876
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.780 Test Loss: 0.504 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.511695861816406
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.792 Test Loss: 0.498 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.277597188949585
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.798 Test Loss: 0.494 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 43 cost time: 6.4451916217803955
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.792 Test Loss: 0.488 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.000399112701416
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.798 Test Loss: 0.494 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 45 cost time: 6.046298027038574
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.798 Test Loss: 0.495 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.404690742492676
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.798 Test Loss: 0.489 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 47 cost time: 6.1851561069488525
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.798 Test Loss: 0.486 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 48 cost time: 6.176400184631348
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.792 Test Loss: 0.485 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.532111644744873
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.792 Test Loss: 0.491 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.920468807220459
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.798 Test Loss: 0.497 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.801095008850098
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.798 Test Loss: 0.493 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 7.024070501327515
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.798 Test Loss: 0.487 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.686582088470459
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.792 Test Loss: 0.487 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 6.067483186721802
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.792 Test Loss: 0.495 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 5.7498862743377686
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.792 Test Loss: 0.500 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 6.142714262008667
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.798 Test Loss: 0.502 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 6.0618650913238525
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.798 Test Loss: 0.500 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.079659461975098
Epoch: 1, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.836 Vali Acc: 0.318 Test Loss: 1.836 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 6.2461020946502686
Epoch: 2, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.488 Vali Acc: 0.572 Test Loss: 1.488 Test Acc: 0.572
Validation loss decreased (-0.317901 --> -0.572239).  Saving model ...
Epoch: 3 cost time: 6.166141033172607
Epoch: 3, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.284 Vali Acc: 0.584 Test Loss: 1.284 Test Acc: 0.584
Validation loss decreased (-0.572239 --> -0.583802).  Saving model ...
Epoch: 4 cost time: 5.935013055801392
Epoch: 4, Steps: 17 | Train Loss: 0.577 Vali Loss: 1.010 Vali Acc: 0.618 Test Loss: 1.010 Test Acc: 0.618
Validation loss decreased (-0.583802 --> -0.618487).  Saving model ...
Epoch: 5 cost time: 6.003866672515869
Epoch: 5, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.736 Vali Acc: 0.728 Test Loss: 0.736 Test Acc: 0.728
Validation loss decreased (-0.618487 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 6.08278751373291
Epoch: 6, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.667 Vali Acc: 0.734 Test Loss: 0.667 Test Acc: 0.734
Validation loss decreased (-0.728316 --> -0.734097).  Saving model ...
Epoch: 7 cost time: 5.850924491882324
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.640 Vali Acc: 0.723 Test Loss: 0.640 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.0202109813690186
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.775 Test Loss: 0.516 Test Acc: 0.775
Validation loss decreased (-0.734097 --> -0.774561).  Saving model ...
Epoch: 9 cost time: 5.872253179550171
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.555 Vali Acc: 0.740 Test Loss: 0.555 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.142226696014404
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.763 Test Loss: 0.522 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.601006746292114
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.769 Test Loss: 0.546 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.667715072631836
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.780 Test Loss: 0.525 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780342).  Saving model ...
Epoch: 13 cost time: 5.492895126342773
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.775 Test Loss: 0.503 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.941056966781616
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.786 Test Loss: 0.509 Test Acc: 0.786
Validation loss decreased (-0.780342 --> -0.786122).  Saving model ...
Epoch: 15 cost time: 6.176926374435425
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.780 Test Loss: 0.497 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.298389196395874
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.775 Test Loss: 0.475 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.339402914047241
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.786 Test Loss: 0.489 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 18 cost time: 6.26340651512146
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.786 Test Loss: 0.499 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.416320562362671
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.780 Test Loss: 0.479 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.779500484466553
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.775 Test Loss: 0.504 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.73817253112793
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.775 Test Loss: 0.498 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.452476501464844
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.786 Test Loss: 0.497 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.514821290969849
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.786 Test Loss: 0.498 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.819498300552368
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.798 Test Loss: 0.489 Test Acc: 0.798
Validation loss decreased (-0.786122 --> -0.797683).  Saving model ...
Epoch: 25 cost time: 6.057990074157715
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.798 Test Loss: 0.494 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.316699266433716
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.798 Test Loss: 0.499 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.45813250541687
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
Validation loss decreased (-0.797683 --> -0.809244).  Saving model ...
Epoch: 28 cost time: 6.289835214614868
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.798 Test Loss: 0.478 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.415340185165405
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.798 Test Loss: 0.493 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.958243131637573
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.798 Test Loss: 0.500 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.670907735824585
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.578124046325684
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.798 Test Loss: 0.492 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.543625593185425
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.928431987762451
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.798 Test Loss: 0.501 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.962841272354126
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.815 Test Loss: 0.503 Test Acc: 0.815
Validation loss decreased (-0.809244 --> -0.815024).  Saving model ...
Epoch: 36 cost time: 6.063560962677002
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.815 Test Loss: 0.506 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.795828104019165
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.646234035491943
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.810927629470825
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.815 Test Loss: 0.492 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 40 cost time: 6.11851954460144
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.821 Test Loss: 0.501 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 41 cost time: 5.790439128875732
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.815 Test Loss: 0.507 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.302465200424194
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.714452743530273
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 6.131220817565918
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 5.6409912109375
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.821 Test Loss: 0.519 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 6.156983137130737
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.815 Test Loss: 0.513 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 5.804569482803345
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.821 Test Loss: 0.510 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 6.0379955768585205
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.815 Test Loss: 0.521 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 5.72704291343689
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.821 Test Loss: 0.511 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 6.286356449127197
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.821 Test Loss: 0.522 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.286046504974365
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.848 Vali Acc: 0.272 Test Loss: 1.848 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 5.701749563217163
Epoch: 2, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.480 Vali Acc: 0.514 Test Loss: 1.480 Test Acc: 0.514
Validation loss decreased (-0.271658 --> -0.514436).  Saving model ...
Epoch: 3 cost time: 5.619959592819214
Epoch: 3, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.277 Vali Acc: 0.538 Test Loss: 1.277 Test Acc: 0.538
Validation loss decreased (-0.514436 --> -0.537559).  Saving model ...
Epoch: 4 cost time: 5.8391852378845215
Epoch: 4, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.922 Vali Acc: 0.572 Test Loss: 0.922 Test Acc: 0.572
Validation loss decreased (-0.537559 --> -0.572245).  Saving model ...
Epoch: 5 cost time: 5.720018148422241
Epoch: 5, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.692 Vali Acc: 0.740 Test Loss: 0.692 Test Acc: 0.740
Validation loss decreased (-0.572245 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 6.344493389129639
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.656 Vali Acc: 0.734 Test Loss: 0.656 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.985271692276001
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.560 Vali Acc: 0.746 Test Loss: 0.560 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745659).  Saving model ...
Epoch: 8 cost time: 6.2801971435546875
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.745659 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 6.166645765304565
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.775 Test Loss: 0.547 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.896522760391235
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.497 Vali Acc: 0.792 Test Loss: 0.497 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.14636754989624
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.938181161880493
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.910587310791016
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.815 Test Loss: 0.476 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 14 cost time: 6.0889787673950195
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.803 Test Loss: 0.472 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.135363578796387
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.815 Test Loss: 0.464 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 16 cost time: 6.226159572601318
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.821 Test Loss: 0.454 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820805).  Saving model ...
Epoch: 17 cost time: 5.971564054489136
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.815 Test Loss: 0.457 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.426187992095947
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.809 Test Loss: 0.457 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.436362028121948
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.815 Test Loss: 0.440 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.994246244430542
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.821 Test Loss: 0.451 Test Acc: 0.821
Validation loss decreased (-0.820805 --> -0.820805).  Saving model ...
Epoch: 21 cost time: 6.251697778701782
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.809 Test Loss: 0.452 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.328547239303589
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.815 Test Loss: 0.454 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.8472301959991455
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.827 Test Loss: 0.440 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 24 cost time: 6.90757155418396
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.827 Test Loss: 0.432 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 25 cost time: 6.854939699172974
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.821 Test Loss: 0.442 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.561539173126221
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.827 Test Loss: 0.443 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.931410551071167
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.832 Test Loss: 0.435 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832366).  Saving model ...
Epoch: 28 cost time: 5.907762289047241
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
Validation loss decreased (-0.832366 --> -0.843926).  Saving model ...
Epoch: 29 cost time: 6.345475912094116
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.832 Test Loss: 0.434 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.064969301223755
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.832 Test Loss: 0.439 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.493511199951172
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.832 Test Loss: 0.432 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.379363059997559
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.838 Test Loss: 0.436 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.161048889160156
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.821 Test Loss: 0.444 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.591074705123901
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.0495758056640625
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.821 Test Loss: 0.439 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.122827053070068
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.821 Test Loss: 0.445 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 5.9972243309021
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.815 Test Loss: 0.452 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 6.148478746414185
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.093684911727905
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 5.755887746810913
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.514802694320679
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.570004463195801
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.72947359085083
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.011384963989258
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.24565052986145
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.3428332805633545
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.377670764923096
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.924663543701172
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.945983171463013
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.17341040462427745
model parameter : 4418055
model size : 26.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.688621759414673
Epoch: 1, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.274 Vali Acc: 0.491 Test Loss: 1.274 Test Acc: 0.491
Validation loss decreased (inf --> -0.491317).  Saving model ...
Epoch: 2 cost time: 6.38722038269043
Epoch: 2, Steps: 17 | Train Loss: 0.951 Vali Loss: 0.917 Vali Acc: 0.682 Test Loss: 0.917 Test Acc: 0.682
Validation loss decreased (-0.491317 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 6.285273551940918
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
Validation loss decreased (-0.682072 --> -0.809243).  Saving model ...
Epoch: 4 cost time: 6.196797609329224
Epoch: 4, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.549 Vali Acc: 0.786 Test Loss: 0.549 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.364422082901001
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.617 Vali Acc: 0.786 Test Loss: 0.617 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.319452285766602
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.458 Vali Acc: 0.827 Test Loss: 0.458 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826585).  Saving model ...
Epoch: 7 cost time: 6.0890793800354
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.486 Vali Acc: 0.815 Test Loss: 0.486 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.2072837352752686
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.415 Vali Acc: 0.827 Test Loss: 0.415 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 6.0726728439331055
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.821 Test Loss: 0.510 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.166314125061035
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.821 Test Loss: 0.435 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.938669204711914
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.838 Test Loss: 0.446 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838146).  Saving model ...
Epoch: 12 cost time: 5.943328857421875
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.821 Test Loss: 0.449 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.069758653640747
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.219596862792969
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.293169021606445
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.838 Test Loss: 0.449 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.063627243041992
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.815 Test Loss: 0.445 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.061330556869507
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.060025691986084
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.219297409057617
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849706).  Saving model ...
Epoch: 20 cost time: 6.22822117805481
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.1158928871154785
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.0220420360565186
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.014264106750488
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.851026296615601
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.861 Test Loss: 0.451 Test Acc: 0.861
Validation loss decreased (-0.849706 --> -0.861267).  Saving model ...
Epoch: 25 cost time: 5.939911603927612
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.593157768249512
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.897662162780762
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.443606853485107
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.593434572219849
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.9089601039886475
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.958384275436401
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.005060911178589
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.882552623748779
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.850 Test Loss: 0.463 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.344601154327393
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.945552825927734
Epoch: 1, Steps: 17 | Train Loss: 1.771 Vali Loss: 1.299 Vali Acc: 0.445 Test Loss: 1.299 Test Acc: 0.445
Validation loss decreased (inf --> -0.445074).  Saving model ...
Epoch: 2 cost time: 6.016098976135254
Epoch: 2, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.897 Vali Acc: 0.699 Test Loss: 0.897 Test Acc: 0.699
Validation loss decreased (-0.445074 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 6.019642114639282
Epoch: 3, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.559 Vali Acc: 0.821 Test Loss: 0.559 Test Acc: 0.821
Validation loss decreased (-0.699413 --> -0.820804).  Saving model ...
Epoch: 4 cost time: 5.998157024383545
Epoch: 4, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.476 Vali Acc: 0.780 Test Loss: 0.476 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.342169284820557
Epoch: 5, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.214424133300781
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.219828128814697
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.418 Vali Acc: 0.867 Test Loss: 0.418 Test Acc: 0.867
Validation loss decreased (-0.820804 --> -0.867048).  Saving model ...
Epoch: 8 cost time: 5.410519361495972
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.422 Vali Acc: 0.838 Test Loss: 0.422 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.779025554656982
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.861 Test Loss: 0.425 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.607133388519287
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.873 Test Loss: 0.398 Test Acc: 0.873
Validation loss decreased (-0.867048 --> -0.872828).  Saving model ...
Epoch: 11 cost time: 5.768537282943726
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.401 Vali Acc: 0.867 Test Loss: 0.401 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.48337984085083
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.398 Vali Acc: 0.879 Test Loss: 0.398 Test Acc: 0.879
Validation loss decreased (-0.872828 --> -0.878609).  Saving model ...
Epoch: 13 cost time: 6.281269550323486
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.879 Test Loss: 0.402 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.245792865753174
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.873 Test Loss: 0.407 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.828310966491699
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.958450794219971
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.401 Vali Acc: 0.873 Test Loss: 0.401 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.08726167678833
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.861 Test Loss: 0.423 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.584821701049805
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.861 Test Loss: 0.421 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.019678354263306
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.867 Test Loss: 0.411 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.153456687927246
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.1346211433410645
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.885805130004883
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.294331789016724
Epoch: 1, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.338 Vali Acc: 0.468 Test Loss: 1.338 Test Acc: 0.468
Validation loss decreased (inf --> -0.468195).  Saving model ...
Epoch: 2 cost time: 6.132976531982422
Epoch: 2, Steps: 17 | Train Loss: 0.918 Vali Loss: 0.885 Vali Acc: 0.653 Test Loss: 0.885 Test Acc: 0.653
Validation loss decreased (-0.468195 --> -0.653170).  Saving model ...
Epoch: 3 cost time: 6.389612913131714
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.543 Vali Acc: 0.855 Test Loss: 0.543 Test Acc: 0.855
Validation loss decreased (-0.653170 --> -0.855486).  Saving model ...
Epoch: 4 cost time: 6.360915660858154
Epoch: 4, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.498 Vali Acc: 0.780 Test Loss: 0.498 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.204420328140259
Epoch: 5, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.503 Vali Acc: 0.815 Test Loss: 0.503 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.9984612464904785
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.468 Vali Acc: 0.798 Test Loss: 0.468 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.951036691665649
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.863710641860962
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
Validation loss decreased (-0.855486 --> -0.855487).  Saving model ...
Epoch: 9 cost time: 6.091176748275757
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.643549919128418
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.390921592712402
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.645177841186523
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.295152187347412
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.0478856563568115
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.952415943145752
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.786607265472412
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.13412070274353
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.132730484008789
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.925616025924683
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.524 Vali Acc: 0.410 Test Loss: 1.524 Test Acc: 0.410
Validation loss decreased (inf --> -0.410389).  Saving model ...
Epoch: 2 cost time: 6.224647283554077
Epoch: 2, Steps: 17 | Train Loss: 1.021 Vali Loss: 0.947 Vali Acc: 0.699 Test Loss: 0.947 Test Acc: 0.699
Validation loss decreased (-0.410389 --> -0.699412).  Saving model ...
Epoch: 3 cost time: 6.4159510135650635
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.555 Vali Acc: 0.838 Test Loss: 0.555 Test Acc: 0.838
Validation loss decreased (-0.699412 --> -0.838145).  Saving model ...
Epoch: 4 cost time: 6.3143861293792725
Epoch: 4, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.627365827560425
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.574095964431763
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.448 Vali Acc: 0.803 Test Loss: 0.448 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.843531847000122
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.821 Test Loss: 0.433 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.669824838638306
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.821 Test Loss: 0.430 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.93252968788147
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.431 Vali Acc: 0.821 Test Loss: 0.431 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.135848760604858
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.815 Test Loss: 0.429 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.234381437301636
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.827 Test Loss: 0.425 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.418895244598389
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.832 Test Loss: 0.431 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.482824325561523
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.827 Test Loss: 0.427 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.054208517074585
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.730 Vali Acc: 0.306 Test Loss: 1.730 Test Acc: 0.306
Validation loss decreased (inf --> -0.306341).  Saving model ...
Epoch: 2 cost time: 5.970674514770508
Epoch: 2, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.235 Vali Acc: 0.566 Test Loss: 1.235 Test Acc: 0.566
Validation loss decreased (-0.306341 --> -0.566462).  Saving model ...
Epoch: 3 cost time: 6.220380783081055
Epoch: 3, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.780 Vali Acc: 0.711 Test Loss: 0.780 Test Acc: 0.711
Validation loss decreased (-0.566462 --> -0.710975).  Saving model ...
Epoch: 4 cost time: 6.162719488143921
Epoch: 4, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
Validation loss decreased (-0.710975 --> -0.780341).  Saving model ...
Epoch: 5 cost time: 5.929637908935547
Epoch: 5, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
Validation loss decreased (-0.780341 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 5.921458721160889
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.518 Vali Acc: 0.815 Test Loss: 0.518 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 7 cost time: 5.7431416511535645
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.765007495880127
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.470 Vali Acc: 0.827 Test Loss: 0.470 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 6.000913381576538
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.815 Test Loss: 0.473 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.98075795173645
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.069146394729614
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.815 Test Loss: 0.463 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.434563636779785
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.815 Test Loss: 0.464 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.223537445068359
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.821 Test Loss: 0.455 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.3903844356536865
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.815 Test Loss: 0.459 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.5588603019714355
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.453 Vali Acc: 0.815 Test Loss: 0.453 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.663370132446289
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.815 Test Loss: 0.447 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.61592698097229
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.821 Test Loss: 0.451 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.052055597305298
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.815 Test Loss: 0.452 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.191041946411133
Epoch: 1, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.801 Vali Acc: 0.318 Test Loss: 1.801 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 5.939691543579102
Epoch: 2, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.369 Vali Acc: 0.543 Test Loss: 1.369 Test Acc: 0.543
Validation loss decreased (-0.317901 --> -0.543339).  Saving model ...
Epoch: 3 cost time: 6.120940446853638
Epoch: 3, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.959 Vali Acc: 0.665 Test Loss: 0.959 Test Acc: 0.665
Validation loss decreased (-0.543339 --> -0.664730).  Saving model ...
Epoch: 4 cost time: 6.0959131717681885
Epoch: 4, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.739 Vali Acc: 0.705 Test Loss: 0.739 Test Acc: 0.705
Validation loss decreased (-0.664730 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 6.300705194473267
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.659 Vali Acc: 0.734 Test Loss: 0.659 Test Acc: 0.734
Validation loss decreased (-0.705195 --> -0.734097).  Saving model ...
Epoch: 6 cost time: 5.923184633255005
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.624 Vali Acc: 0.751 Test Loss: 0.624 Test Acc: 0.751
Validation loss decreased (-0.734097 --> -0.751439).  Saving model ...
Epoch: 7 cost time: 6.1502625942230225
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.602 Vali Acc: 0.751 Test Loss: 0.602 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 8 cost time: 6.071269512176514
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.751439 --> -0.763000).  Saving model ...
Epoch: 9 cost time: 6.342961072921753
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.587 Vali Acc: 0.769 Test Loss: 0.587 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 6.5208494663238525
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.780 Test Loss: 0.582 Test Acc: 0.780
Validation loss decreased (-0.768780 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 6.627851724624634
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.780 Test Loss: 0.575 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 6.555419683456421
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.798 Test Loss: 0.573 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797682).  Saving model ...
Epoch: 13 cost time: 6.212544202804565
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.814653158187866
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.990762710571289
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.853345632553101
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.780 Test Loss: 0.554 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.787221908569336
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.641965866088867
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.798 Test Loss: 0.554 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797682).  Saving model ...
Epoch: 19 cost time: 6.451613664627075
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.786 Test Loss: 0.544 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.40790057182312
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.228464841842651
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.786 Test Loss: 0.539 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.7742674350738525
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.792 Test Loss: 0.536 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.838680028915405
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 24 cost time: 5.823566913604736
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.786 Test Loss: 0.528 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.375318288803101
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.786 Test Loss: 0.523 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.029080390930176
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 27 cost time: 5.706165313720703
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.792 Test Loss: 0.516 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.53812050819397
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.826144695281982
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.368574142456055
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.792 Test Loss: 0.513 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.472336769104004
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.815 Test Loss: 0.512 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 32 cost time: 6.496397495269775
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.815 Test Loss: 0.508 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 33 cost time: 6.000147342681885
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.882120847702026
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.815 Test Loss: 0.501 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 35 cost time: 5.832962989807129
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.827 Test Loss: 0.500 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826585).  Saving model ...
Epoch: 36 cost time: 6.707453012466431
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.815 Test Loss: 0.495 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.313429594039917
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.821 Test Loss: 0.492 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.381173849105835
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.009589195251465
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.821 Test Loss: 0.491 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.959698438644409
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.815 Test Loss: 0.488 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.312082529067993
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 6.80668306350708
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 7.131916284561157
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.832 Test Loss: 0.484 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 44 cost time: 6.260637521743774
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 45 cost time: 6.508812189102173
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 46 cost time: 5.817265748977661
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.844 Test Loss: 0.480 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 47 cost time: 6.496706008911133
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.832 Test Loss: 0.479 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.415844202041626
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.998654127120972
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.832 Test Loss: 0.478 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.672548294067383
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.593159198760986
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 5.963355302810669
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.827 Test Loss: 0.473 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 6.295347452163696
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 6.4844136238098145
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849706).  Saving model ...
Epoch: 55 cost time: 6.6709301471710205
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.065768718719482
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.861 Test Loss: 0.471 Test Acc: 0.861
Validation loss decreased (-0.849706 --> -0.861267).  Saving model ...
Epoch: 57 cost time: 6.395603656768799
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 6.1989662647247314
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.838 Test Loss: 0.467 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 6.19578742980957
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 6.704693555831909
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.010018348693848
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 6.1498260498046875
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 6.076562404632568
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 6.665694236755371
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 6.35895037651062
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 6.406657934188843
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.850 Test Loss: 0.458 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.693803310394287
Epoch: 1, Steps: 17 | Train Loss: 1.944 Vali Loss: 1.877 Vali Acc: 0.277 Test Loss: 1.877 Test Acc: 0.277
Validation loss decreased (inf --> -0.277438).  Saving model ...
Epoch: 2 cost time: 6.31238317489624
Epoch: 2, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.526 Vali Acc: 0.486 Test Loss: 1.526 Test Acc: 0.486
Validation loss decreased (-0.277438 --> -0.485534).  Saving model ...
Epoch: 3 cost time: 6.1350929737091064
Epoch: 3, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.182 Vali Acc: 0.538 Test Loss: 1.182 Test Acc: 0.538
Validation loss decreased (-0.485534 --> -0.537560).  Saving model ...
Epoch: 4 cost time: 6.128572225570679
Epoch: 4, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.877 Vali Acc: 0.624 Test Loss: 0.877 Test Acc: 0.624
Validation loss decreased (-0.537560 --> -0.624269).  Saving model ...
Epoch: 5 cost time: 6.594865322113037
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.730 Vali Acc: 0.642 Test Loss: 0.730 Test Acc: 0.642
Validation loss decreased (-0.624269 --> -0.641611).  Saving model ...
Epoch: 6 cost time: 6.4317755699157715
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.712 Vali Acc: 0.653 Test Loss: 0.712 Test Acc: 0.653
Validation loss decreased (-0.641611 --> -0.653172).  Saving model ...
Epoch: 7 cost time: 6.609079837799072
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.660 Vali Acc: 0.688 Test Loss: 0.660 Test Acc: 0.688
Validation loss decreased (-0.653172 --> -0.687855).  Saving model ...
Epoch: 8 cost time: 6.156391382217407
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.740 Test Loss: 0.634 Test Acc: 0.740
Validation loss decreased (-0.687855 --> -0.739878).  Saving model ...
Epoch: 9 cost time: 6.1133809089660645
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.636 Vali Acc: 0.728 Test Loss: 0.636 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.017729759216309
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.723 Test Loss: 0.635 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.2060911655426025
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
Validation loss decreased (-0.739878 --> -0.774560).  Saving model ...
Epoch: 12 cost time: 6.482827186584473
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.734 Test Loss: 0.618 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.139971971511841
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.941527843475342
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.751 Test Loss: 0.601 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.049980640411377
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.769 Test Loss: 0.583 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.714148998260498
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.422291278839111
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.659873962402344
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.751 Test Loss: 0.598 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.371729373931885
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774561).  Saving model ...
Epoch: 20 cost time: 6.199749708175659
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.780 Test Loss: 0.577 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 21 cost time: 5.879197359085083
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.780 Test Loss: 0.580 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.747732162475586
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.769 Test Loss: 0.580 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.618555784225464
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.769 Test Loss: 0.585 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.096631288528442
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.182548761367798
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 26 cost time: 6.5736048221588135
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.434895277023315
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.780 Test Loss: 0.561 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 28 cost time: 6.920864582061768
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.780 Test Loss: 0.567 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.769986152648926
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.780 Test Loss: 0.561 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 30 cost time: 6.7275755405426025
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.90401291847229
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.775 Test Loss: 0.549 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.251240491867065
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.775 Test Loss: 0.549 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.467879295349121
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.780 Test Loss: 0.548 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 34 cost time: 6.6620142459869385
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.793353080749512
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.780 Test Loss: 0.541 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 36 cost time: 6.031578540802002
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.780 Test Loss: 0.536 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 37 cost time: 6.214441776275635
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.775 Test Loss: 0.533 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.340888977050781
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.136467695236206
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.780 Test Loss: 0.553 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.2172465324401855
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.780 Test Loss: 0.541 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 6.280974864959717
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.775 Test Loss: 0.532 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.250988483428955
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 6.493196964263916
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.780 Test Loss: 0.535 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 44 cost time: 6.300003528594971
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.780 Test Loss: 0.530 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780342).  Saving model ...
Epoch: 45 cost time: 5.864612817764282
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.792 Test Loss: 0.537 Test Acc: 0.792
Validation loss decreased (-0.780342 --> -0.791902).  Saving model ...
Epoch: 46 cost time: 6.240527868270874
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 47 cost time: 6.739737272262573
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.792 Test Loss: 0.527 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 48 cost time: 6.862024784088135
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.52469277381897
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.775 Test Loss: 0.529 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.208120822906494
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.775 Test Loss: 0.522 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.062873363494873
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.775 Test Loss: 0.520 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.757210969924927
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.775 Test Loss: 0.517 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.841784715652466
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.775 Test Loss: 0.520 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 6.057426452636719
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 6.252355098724365
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.775 Test Loss: 0.523 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 6.305149078369141
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.775 Test Loss: 0.519 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 6.460535287857056
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.775 Test Loss: 0.510 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.078408241271973
Epoch: 1, Steps: 17 | Train Loss: 1.954 Vali Loss: 1.911 Vali Acc: 0.249 Test Loss: 1.911 Test Acc: 0.249
Validation loss decreased (inf --> -0.248536).  Saving model ...
Epoch: 2 cost time: 6.669918775558472
Epoch: 2, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.543 Vali Acc: 0.434 Test Loss: 1.543 Test Acc: 0.434
Validation loss decreased (-0.248536 --> -0.433511).  Saving model ...
Epoch: 3 cost time: 6.265193223953247
Epoch: 3, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.188 Vali Acc: 0.561 Test Loss: 1.188 Test Acc: 0.561
Validation loss decreased (-0.433511 --> -0.560682).  Saving model ...
Epoch: 4 cost time: 6.261467456817627
Epoch: 4, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.866 Vali Acc: 0.665 Test Loss: 0.866 Test Acc: 0.665
Validation loss decreased (-0.560682 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 5.731029510498047
Epoch: 5, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.736 Vali Acc: 0.694 Test Loss: 0.736 Test Acc: 0.694
Validation loss decreased (-0.664731 --> -0.693634).  Saving model ...
Epoch: 6 cost time: 5.722349166870117
Epoch: 6, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.779 Vali Acc: 0.630 Test Loss: 0.779 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.4011266231536865
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.641 Vali Acc: 0.723 Test Loss: 0.641 Test Acc: 0.723
Validation loss decreased (-0.693634 --> -0.722537).  Saving model ...
Epoch: 8 cost time: 6.1930320262908936
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
Validation loss decreased (-0.722537 --> -0.780341).  Saving model ...
Epoch: 9 cost time: 5.903639554977417
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.79133939743042
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.780 Test Loss: 0.548 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 11 cost time: 5.925328969955444
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 12 cost time: 6.57846474647522
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.417804479598999
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.792 Test Loss: 0.531 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 14 cost time: 6.548307418823242
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.780 Test Loss: 0.547 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.114684581756592
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 16 cost time: 5.904886960983276
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.962922096252441
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.530 Vali Acc: 0.792 Test Loss: 0.530 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.1758201122283936
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.798 Test Loss: 0.517 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 19 cost time: 6.411713123321533
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.798 Test Loss: 0.517 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 20 cost time: 5.717819929122925
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 21 cost time: 5.486252546310425
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 22 cost time: 6.001861810684204
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.798 Test Loss: 0.512 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.4205639362335205
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 24 cost time: 6.530856609344482
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.792 Test Loss: 0.506 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.292142391204834
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.786 Test Loss: 0.500 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.168411016464233
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.798 Test Loss: 0.496 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.260620594024658
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.792 Test Loss: 0.486 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.367929458618164
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.792 Test Loss: 0.482 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.1908345222473145
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.792 Test Loss: 0.493 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.4250688552856445
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.459607124328613
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.786 Test Loss: 0.490 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.948302745819092
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.786 Test Loss: 0.490 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.000796318054199
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.798 Test Loss: 0.484 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.957417011260986
Epoch: 1, Steps: 17 | Train Loss: 1.995 Vali Loss: 1.871 Vali Acc: 0.254 Test Loss: 1.871 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 6.103010654449463
Epoch: 2, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.501 Vali Acc: 0.526 Test Loss: 1.501 Test Acc: 0.526
Validation loss decreased (-0.254317 --> -0.525997).  Saving model ...
Epoch: 3 cost time: 6.515689134597778
Epoch: 3, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.167 Vali Acc: 0.572 Test Loss: 1.167 Test Acc: 0.572
Validation loss decreased (-0.525997 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 6.454832553863525
Epoch: 4, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.832 Vali Acc: 0.711 Test Loss: 0.832 Test Acc: 0.711
Validation loss decreased (-0.572243 --> -0.710974).  Saving model ...
Epoch: 5 cost time: 6.103122711181641
Epoch: 5, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.695 Vali Acc: 0.728 Test Loss: 0.695 Test Acc: 0.728
Validation loss decreased (-0.710974 --> -0.728317).  Saving model ...
Epoch: 6 cost time: 6.429572582244873
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.662 Vali Acc: 0.728 Test Loss: 0.662 Test Acc: 0.728
Validation loss decreased (-0.728317 --> -0.728317).  Saving model ...
Epoch: 7 cost time: 6.048352479934692
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.586 Vali Acc: 0.711 Test Loss: 0.586 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.175122261047363
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.515 Vali Acc: 0.780 Test Loss: 0.515 Test Acc: 0.780
Validation loss decreased (-0.728317 --> -0.780342).  Saving model ...
Epoch: 9 cost time: 6.429138660430908
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.746 Test Loss: 0.523 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.37128758430481
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.798 Test Loss: 0.491 Test Acc: 0.798
Validation loss decreased (-0.780342 --> -0.797683).  Saving model ...
Epoch: 11 cost time: 6.287016153335571
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.786 Test Loss: 0.489 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.974504232406616
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.786 Test Loss: 0.493 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.171051740646362
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.792 Test Loss: 0.470 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.104548454284668
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 15 cost time: 6.058181524276733
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.792 Test Loss: 0.461 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.77777624130249
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.792 Test Loss: 0.461 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.4177937507629395
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 18 cost time: 6.5811378955841064
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.792 Test Loss: 0.461 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.8419718742370605
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.792 Test Loss: 0.451 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.156227111816406
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.792 Test Loss: 0.441 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.647850036621094
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.792 Test Loss: 0.440 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.764880657196045
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 23 cost time: 6.5501439571380615
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.792 Test Loss: 0.438 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.262398719787598
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.803 Test Loss: 0.428 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.50423002243042
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.809 Test Loss: 0.425 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 26 cost time: 6.658335447311401
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.809 Test Loss: 0.422 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 27 cost time: 6.361765623092651
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.809 Test Loss: 0.417 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 28 cost time: 6.229598045349121
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.803 Test Loss: 0.420 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.044811964035034
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.827 Test Loss: 0.418 Test Acc: 0.827
Validation loss decreased (-0.809244 --> -0.826585).  Saving model ...
Epoch: 30 cost time: 6.133213758468628
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.827 Test Loss: 0.413 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 31 cost time: 6.308613061904907
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.827 Test Loss: 0.415 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.601128578186035
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.414 Vali Acc: 0.827 Test Loss: 0.414 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.8752923011779785
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.832 Test Loss: 0.409 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832366).  Saving model ...
Epoch: 34 cost time: 5.937674522399902
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.832 Test Loss: 0.411 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.103179693222046
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.413 Vali Acc: 0.827 Test Loss: 0.413 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.468329906463623
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
Validation loss decreased (-0.832366 --> -0.855487).  Saving model ...
Epoch: 37 cost time: 6.38752555847168
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.861 Test Loss: 0.405 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861268).  Saving model ...
Epoch: 38 cost time: 5.8167266845703125
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.832 Test Loss: 0.406 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.617447376251221
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.832 Test Loss: 0.402 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.417928218841553
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.398 Vali Acc: 0.861 Test Loss: 0.398 Test Acc: 0.861
Validation loss decreased (-0.861268 --> -0.861268).  Saving model ...
Epoch: 41 cost time: 6.365504264831543
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.399 Vali Acc: 0.838 Test Loss: 0.399 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.852907657623291
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.844 Test Loss: 0.397 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.546313524246216
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.832 Test Loss: 0.402 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 6.372138261795044
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.400 Vali Acc: 0.879 Test Loss: 0.400 Test Acc: 0.879
Validation loss decreased (-0.861268 --> -0.878609).  Saving model ...
Epoch: 45 cost time: 6.410479784011841
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.844 Test Loss: 0.402 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.145850658416748
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.397 Vali Acc: 0.879 Test Loss: 0.397 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 47 cost time: 5.804385662078857
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.404 Vali Acc: 0.867 Test Loss: 0.404 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.812315225601196
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.405 Vali Acc: 0.867 Test Loss: 0.405 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.285701274871826
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.855 Test Loss: 0.409 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 6.272398471832275
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 5.664548635482788
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.861 Test Loss: 0.409 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 5.721080303192139
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.861 Test Loss: 0.406 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 6.553739309310913
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.403 Vali Acc: 0.879 Test Loss: 0.403 Test Acc: 0.879
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 6.361374378204346
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.873 Test Loss: 0.406 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 6.18721079826355
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.402 Vali Acc: 0.861 Test Loss: 0.402 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 5.82323431968689
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.861 Test Loss: 0.407 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.7906973361969
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
Validation loss decreased (inf --> -0.150270).  Saving model ...
Epoch: 2 cost time: 5.658905744552612
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.104761600494385
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.890550851821899
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.331783771514893
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.972951412200928
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.865323066711426
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.516383647918701
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.791590452194214
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.491923093795776
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.2155420780181885
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.133 Test Loss: 1.947 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15028901734104047
model parameter : 4024839
model size : 25.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.430429220199585
Epoch: 1, Steps: 17 | Train Loss: 1.741 Vali Loss: 1.233 Vali Acc: 0.566 Test Loss: 1.233 Test Acc: 0.566
Validation loss decreased (inf --> -0.566462).  Saving model ...
Epoch: 2 cost time: 6.5610387325286865
Epoch: 2, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.972 Vali Acc: 0.624 Test Loss: 0.972 Test Acc: 0.624
Validation loss decreased (-0.566462 --> -0.624268).  Saving model ...
Epoch: 3 cost time: 6.177303791046143
Epoch: 3, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.793 Vali Acc: 0.723 Test Loss: 0.793 Test Acc: 0.723
Validation loss decreased (-0.624268 --> -0.722535).  Saving model ...
Epoch: 4 cost time: 6.422733306884766
Epoch: 4, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
Validation loss decreased (-0.722535 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 6.360910892486572
Epoch: 5, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.587 Vali Acc: 0.798 Test Loss: 0.587 Test Acc: 0.798
Validation loss decreased (-0.751438 --> -0.797682).  Saving model ...
Epoch: 6 cost time: 6.255180835723877
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
Validation loss decreased (-0.797682 --> -0.832365).  Saving model ...
Epoch: 7 cost time: 6.85622501373291
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.453 Vali Acc: 0.815 Test Loss: 0.453 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.204528331756592
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.461 Vali Acc: 0.792 Test Loss: 0.461 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.4759955406188965
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.832 Test Loss: 0.426 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832366).  Saving model ...
Epoch: 10 cost time: 6.8060150146484375
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
Validation loss decreased (-0.832366 --> -0.867048).  Saving model ...
Epoch: 11 cost time: 6.550430059432983
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.844 Test Loss: 0.437 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.553673982620239
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.099452018737793
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.0896337032318115
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.7217583656311035
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.929966688156128
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.467613458633423
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.43754243850708
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.695117950439453
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.691424608230591
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.030367851257324
Epoch: 1, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.248 Vali Acc: 0.572 Test Loss: 1.248 Test Acc: 0.572
Validation loss decreased (inf --> -0.572242).  Saving model ...
Epoch: 2 cost time: 6.552320718765259
Epoch: 2, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.896 Vali Acc: 0.682 Test Loss: 0.896 Test Acc: 0.682
Validation loss decreased (-0.572242 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 6.410884380340576
Epoch: 3, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.705 Vali Acc: 0.751 Test Loss: 0.705 Test Acc: 0.751
Validation loss decreased (-0.682072 --> -0.751438).  Saving model ...
Epoch: 4 cost time: 5.657613039016724
Epoch: 4, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 6.170047044754028
Epoch: 5, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.652 Vali Acc: 0.775 Test Loss: 0.652 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 6.360430479049683
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.457 Vali Acc: 0.821 Test Loss: 0.457 Test Acc: 0.821
Validation loss decreased (-0.774560 --> -0.820805).  Saving model ...
Epoch: 7 cost time: 6.293999671936035
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 5.5945305824279785
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.838 Test Loss: 0.440 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 9 cost time: 5.753225803375244
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.844 Test Loss: 0.411 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843927).  Saving model ...
Epoch: 10 cost time: 6.03663444519043
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.832 Test Loss: 0.423 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.878328084945679
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
Validation loss decreased (-0.843927 --> -0.855487).  Saving model ...
Epoch: 12 cost time: 5.884127378463745
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.229011297225952
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.832 Test Loss: 0.433 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.9643049240112305
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.832 Test Loss: 0.437 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.065186500549316
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.832 Test Loss: 0.432 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.761781692504883
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.832 Test Loss: 0.434 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.031082630157471
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.827 Test Loss: 0.434 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.069420099258423
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.827 Test Loss: 0.437 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.803808927536011
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.832 Test Loss: 0.437 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.747925281524658
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.832 Test Loss: 0.439 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.084158658981323
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.714841604232788
Epoch: 1, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.290 Vali Acc: 0.595 Test Loss: 1.290 Test Acc: 0.595
Validation loss decreased (inf --> -0.595363).  Saving model ...
Epoch: 2 cost time: 6.404531478881836
Epoch: 2, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.849 Vali Acc: 0.728 Test Loss: 0.849 Test Acc: 0.728
Validation loss decreased (-0.595363 --> -0.728315).  Saving model ...
Epoch: 3 cost time: 6.386834383010864
Epoch: 3, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.655 Vali Acc: 0.769 Test Loss: 0.655 Test Acc: 0.769
Validation loss decreased (-0.728315 --> -0.768780).  Saving model ...
Epoch: 4 cost time: 6.495734453201294
Epoch: 4, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.9754252433776855
Epoch: 5, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.1630449295043945
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803464).  Saving model ...
Epoch: 7 cost time: 6.374439001083374
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.468 Vali Acc: 0.809 Test Loss: 0.468 Test Acc: 0.809
Validation loss decreased (-0.803464 --> -0.809244).  Saving model ...
Epoch: 8 cost time: 5.903312683105469
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.827 Test Loss: 0.413 Test Acc: 0.827
Validation loss decreased (-0.809244 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 5.930883884429932
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838146).  Saving model ...
Epoch: 10 cost time: 6.526406526565552
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.838 Test Loss: 0.417 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 6.333209037780762
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.832 Test Loss: 0.410 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.730501890182495
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.838 Test Loss: 0.418 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.009742975234985
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.832 Test Loss: 0.420 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.390703916549683
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.838 Test Loss: 0.424 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.864606857299805
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.832 Test Loss: 0.421 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.495643615722656
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.832 Test Loss: 0.422 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.2614312171936035
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.838 Test Loss: 0.419 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.911841630935669
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.827 Test Loss: 0.420 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.339092254638672
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.827 Test Loss: 0.421 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.676976203918457
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.832 Test Loss: 0.422 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.041513919830322
Epoch: 1, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.476 Vali Acc: 0.509 Test Loss: 1.476 Test Acc: 0.509
Validation loss decreased (inf --> -0.508656).  Saving model ...
Epoch: 2 cost time: 6.278043985366821
Epoch: 2, Steps: 17 | Train Loss: 1.001 Vali Loss: 0.898 Vali Acc: 0.711 Test Loss: 0.898 Test Acc: 0.711
Validation loss decreased (-0.508656 --> -0.710974).  Saving model ...
Epoch: 3 cost time: 6.466323375701904
Epoch: 3, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
Validation loss decreased (-0.710974 --> -0.757219).  Saving model ...
Epoch: 4 cost time: 6.707918882369995
Epoch: 4, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
Validation loss decreased (-0.757219 --> -0.803463).  Saving model ...
Epoch: 5 cost time: 6.886236906051636
Epoch: 5, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.526 Vali Acc: 0.769 Test Loss: 0.526 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.287356853485107
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.503 Vali Acc: 0.815 Test Loss: 0.503 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815024).  Saving model ...
Epoch: 7 cost time: 6.184848308563232
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.133760213851929
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.815 Test Loss: 0.441 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 9 cost time: 6.764396667480469
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
Validation loss decreased (-0.815024 --> -0.843926).  Saving model ...
Epoch: 10 cost time: 6.868860721588135
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.815 Test Loss: 0.425 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.096516132354736
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.827 Test Loss: 0.428 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.21787691116333
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.821 Test Loss: 0.426 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.262814283370972
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.815 Test Loss: 0.426 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.692199468612671
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.815 Test Loss: 0.427 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.50029444694519
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.821 Test Loss: 0.423 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.108487844467163
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.815 Test Loss: 0.425 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.627917051315308
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.821 Test Loss: 0.422 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.346879720687866
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.838 Test Loss: 0.422 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.123226642608643
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.821 Test Loss: 0.424 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.160860061645508
Epoch: 1, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.676 Vali Acc: 0.457 Test Loss: 1.676 Test Acc: 0.457
Validation loss decreased (inf --> -0.456631).  Saving model ...
Epoch: 2 cost time: 5.320225715637207
Epoch: 2, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.194 Vali Acc: 0.590 Test Loss: 1.194 Test Acc: 0.590
Validation loss decreased (-0.456631 --> -0.589583).  Saving model ...
Epoch: 3 cost time: 5.8008270263671875
Epoch: 3, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.847 Vali Acc: 0.705 Test Loss: 0.847 Test Acc: 0.705
Validation loss decreased (-0.589583 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 6.33457088470459
Epoch: 4, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
Validation loss decreased (-0.705194 --> -0.774560).  Saving model ...
Epoch: 5 cost time: 6.16899561882019
Epoch: 5, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.090754985809326
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.774560 --> -0.838145).  Saving model ...
Epoch: 7 cost time: 5.971778869628906
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843926).  Saving model ...
Epoch: 8 cost time: 6.256979703903198
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.497 Vali Acc: 0.821 Test Loss: 0.497 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.085688829421997
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.604095220565796
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.815 Test Loss: 0.471 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.48929238319397
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.832 Test Loss: 0.472 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.822502851486206
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.821 Test Loss: 0.458 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.32535982131958
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.821 Test Loss: 0.461 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.1416215896606445
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.821 Test Loss: 0.467 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.188758611679077
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.815 Test Loss: 0.450 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.166011571884155
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.821 Test Loss: 0.447 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.862908601760864
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.821 Test Loss: 0.448 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.825015544891357
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.774 Vali Acc: 0.335 Test Loss: 1.774 Test Acc: 0.335
Validation loss decreased (inf --> -0.335242).  Saving model ...
Epoch: 2 cost time: 6.1946024894714355
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.350 Vali Acc: 0.532 Test Loss: 1.350 Test Acc: 0.532
Validation loss decreased (-0.335242 --> -0.531778).  Saving model ...
Epoch: 3 cost time: 6.038005113601685
Epoch: 3, Steps: 17 | Train Loss: 0.752 Vali Loss: 0.958 Vali Acc: 0.665 Test Loss: 0.958 Test Acc: 0.665
Validation loss decreased (-0.531778 --> -0.664730).  Saving model ...
Epoch: 4 cost time: 6.167446851730347
Epoch: 4, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.729 Vali Acc: 0.705 Test Loss: 0.729 Test Acc: 0.705
Validation loss decreased (-0.664730 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 5.7189860343933105
Epoch: 5, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.719 Vali Acc: 0.688 Test Loss: 0.719 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.213764667510986
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.675 Vali Acc: 0.711 Test Loss: 0.675 Test Acc: 0.711
Validation loss decreased (-0.705195 --> -0.710976).  Saving model ...
Epoch: 7 cost time: 6.1768958568573
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
Validation loss decreased (-0.710976 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 5.855375289916992
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.628 Vali Acc: 0.711 Test Loss: 0.628 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.756389379501343
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.745658 --> -0.757219).  Saving model ...
Epoch: 10 cost time: 6.341224193572998
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.534640073776245
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.769740581512451
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.744659423828125
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757220).  Saving model ...
Epoch: 14 cost time: 6.397322177886963
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.287670373916626
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.740 Test Loss: 0.580 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.633371353149414
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.809788465499878
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.553476095199585
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
Validation loss decreased (-0.757220 --> -0.763000).  Saving model ...
Epoch: 19 cost time: 6.046621561050415
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.714518785476685
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.424301385879517
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.769 Test Loss: 0.559 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768781).  Saving model ...
Epoch: 22 cost time: 6.507585048675537
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.770309686660767
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.769 Test Loss: 0.555 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 24 cost time: 6.060585975646973
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.769 Test Loss: 0.550 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 25 cost time: 6.641768455505371
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.769 Test Loss: 0.550 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.5560221672058105
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.769 Test Loss: 0.548 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 27 cost time: 5.698944807052612
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.769 Test Loss: 0.545 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 28 cost time: 5.816401243209839
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.769 Test Loss: 0.546 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.444227933883667
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.769 Test Loss: 0.544 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 30 cost time: 6.392301559448242
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.775 Test Loss: 0.543 Test Acc: 0.775
Validation loss decreased (-0.768781 --> -0.774561).  Saving model ...
Epoch: 31 cost time: 5.6865150928497314
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 32 cost time: 5.90864372253418
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.775 Test Loss: 0.538 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 33 cost time: 5.793358087539673
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.775 Test Loss: 0.536 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 34 cost time: 5.990099191665649
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.775 Test Loss: 0.532 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 35 cost time: 6.160545825958252
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.775 Test Loss: 0.529 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 36 cost time: 5.846909523010254
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 37 cost time: 6.0650856494903564
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.643602132797241
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.690564155578613
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.775 Test Loss: 0.525 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 40 cost time: 5.750993251800537
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.775 Test Loss: 0.520 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 41 cost time: 5.868584632873535
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.775 Test Loss: 0.517 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 42 cost time: 5.740336894989014
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.775 Test Loss: 0.517 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 43 cost time: 5.765892505645752
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.775 Test Loss: 0.515 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 44 cost time: 5.831711530685425
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.775 Test Loss: 0.516 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.914302349090576
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.763 Test Loss: 0.515 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.557500600814819
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.775 Test Loss: 0.513 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 47 cost time: 5.864034652709961
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.775 Test Loss: 0.510 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 48 cost time: 6.0312628746032715
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.775 Test Loss: 0.509 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 49 cost time: 6.214069843292236
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
Validation loss decreased (-0.774561 --> -0.786122).  Saving model ...
Epoch: 50 cost time: 6.067882776260376
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.811361312866211
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.786 Test Loss: 0.508 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.608464479446411
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.775 Test Loss: 0.504 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.5780088901519775
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.786 Test Loss: 0.500 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 54 cost time: 5.843963384628296
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.786 Test Loss: 0.500 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.882117033004761
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.786 Test Loss: 0.501 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.975661516189575
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.780 Test Loss: 0.501 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.673572301864624
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.786 Test Loss: 0.499 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 58 cost time: 6.287590265274048
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.786 Test Loss: 0.499 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 59 cost time: 6.152655124664307
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.792 Test Loss: 0.493 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791903).  Saving model ...
Epoch: 60 cost time: 6.282767057418823
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.791903 --> -0.803463).  Saving model ...
Epoch: 61 cost time: 6.101388454437256
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 62 cost time: 5.846999168395996
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.792 Test Loss: 0.490 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 5.848672866821289
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 64 cost time: 5.862560510635376
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 65 cost time: 5.767122745513916
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.798 Test Loss: 0.487 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 5.975284099578857
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.487 Vali Acc: 0.798 Test Loss: 0.487 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 6.099604368209839
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 68 cost time: 6.417302370071411
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.792 Test Loss: 0.484 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 6.018569707870483
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 6.29589319229126
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 6.2673726081848145
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 5.897554636001587
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 5.730919361114502
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820804).  Saving model ...
Epoch: 74 cost time: 5.634410381317139
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.821 Test Loss: 0.480 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 75 cost time: 5.479894161224365
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.821 Test Loss: 0.480 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.860533714294434
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 6.060559988021851
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 78 cost time: 6.130947589874268
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.832 Test Loss: 0.479 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 79 cost time: 6.139005184173584
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.827 Test Loss: 0.475 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 6.11919093132019
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.827 Test Loss: 0.475 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 6.3224570751190186
Epoch: 81, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.821 Test Loss: 0.477 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 5.575343608856201
Epoch: 82, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.821 Test Loss: 0.477 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 6.004745244979858
Epoch: 83, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.821 Test Loss: 0.478 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 5.555957317352295
Epoch: 84, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 5.876968622207642
Epoch: 85, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 5.84154486656189
Epoch: 86, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.827 Test Loss: 0.474 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 5.8828418254852295
Epoch: 87, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.827 Test Loss: 0.474 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 5.979156732559204
Epoch: 88, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.827 Test Loss: 0.474 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.537673473358154
Epoch: 1, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.879 Vali Acc: 0.208 Test Loss: 1.879 Test Acc: 0.208
Validation loss decreased (inf --> -0.208074).  Saving model ...
Epoch: 2 cost time: 6.4731245040893555
Epoch: 2, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.502 Vali Acc: 0.491 Test Loss: 1.502 Test Acc: 0.491
Validation loss decreased (-0.208074 --> -0.491314).  Saving model ...
Epoch: 3 cost time: 6.149917840957642
Epoch: 3, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.096 Vali Acc: 0.613 Test Loss: 1.096 Test Acc: 0.613
Validation loss decreased (-0.491314 --> -0.612706).  Saving model ...
Epoch: 4 cost time: 5.973618745803833
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.957 Vali Acc: 0.618 Test Loss: 0.957 Test Acc: 0.618
Validation loss decreased (-0.612706 --> -0.618488).  Saving model ...
Epoch: 5 cost time: 5.9719977378845215
Epoch: 5, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.850 Vali Acc: 0.630 Test Loss: 0.850 Test Acc: 0.630
Validation loss decreased (-0.618488 --> -0.630049).  Saving model ...
Epoch: 6 cost time: 6.091235399246216
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.710 Vali Acc: 0.624 Test Loss: 0.710 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.032062292098999
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.638 Vali Acc: 0.688 Test Loss: 0.638 Test Acc: 0.688
Validation loss decreased (-0.630049 --> -0.687855).  Saving model ...
Epoch: 8 cost time: 6.094068288803101
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.628 Vali Acc: 0.705 Test Loss: 0.628 Test Acc: 0.705
Validation loss decreased (-0.687855 --> -0.705196).  Saving model ...
Epoch: 9 cost time: 6.214767932891846
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
Validation loss decreased (-0.705196 --> -0.757219).  Saving model ...
Epoch: 10 cost time: 6.504542827606201
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.728 Test Loss: 0.596 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.3492515087127686
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.01389741897583
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.740 Test Loss: 0.593 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.2075700759887695
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.581 Vali Acc: 0.751 Test Loss: 0.581 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.127922534942627
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.930554389953613
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.164781808853149
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.895327568054199
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.769 Test Loss: 0.571 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 6.262982130050659
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.769 Test Loss: 0.567 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 19 cost time: 6.1528356075286865
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.287490129470825
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.20626163482666
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.123735189437866
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.301267147064209
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.993625640869141
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.856459856033325
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.224865198135376
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.054580450057983
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.734 Test Loss: 0.552 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.9274702072143555
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.642506122589111
Epoch: 1, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.921 Vali Acc: 0.185 Test Loss: 1.921 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 5.7856457233428955
Epoch: 2, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.541 Vali Acc: 0.526 Test Loss: 1.541 Test Acc: 0.526
Validation loss decreased (-0.184952 --> -0.525996).  Saving model ...
Epoch: 3 cost time: 6.030427932739258
Epoch: 3, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.123 Vali Acc: 0.624 Test Loss: 1.123 Test Acc: 0.624
Validation loss decreased (-0.525996 --> -0.624266).  Saving model ...
Epoch: 4 cost time: 6.5050904750823975
Epoch: 4, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.977 Vali Acc: 0.671 Test Loss: 0.977 Test Acc: 0.671
Validation loss decreased (-0.624266 --> -0.670510).  Saving model ...
Epoch: 5 cost time: 5.950693845748901
Epoch: 5, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.872 Vali Acc: 0.653 Test Loss: 0.872 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.006850481033325
Epoch: 6, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.699 Vali Acc: 0.694 Test Loss: 0.699 Test Acc: 0.694
Validation loss decreased (-0.670510 --> -0.693635).  Saving model ...
Epoch: 7 cost time: 6.430166006088257
Epoch: 7, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.674 Vali Acc: 0.699 Test Loss: 0.674 Test Acc: 0.699
Validation loss decreased (-0.693635 --> -0.699415).  Saving model ...
Epoch: 8 cost time: 6.372706174850464
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
Validation loss decreased (-0.699415 --> -0.745659).  Saving model ...
Epoch: 9 cost time: 6.333523511886597
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
Validation loss decreased (-0.745659 --> -0.745659).  Saving model ...
Epoch: 10 cost time: 6.005621433258057
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.769 Test Loss: 0.573 Test Acc: 0.769
Validation loss decreased (-0.745659 --> -0.768780).  Saving model ...
Epoch: 11 cost time: 5.672308683395386
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.769 Test Loss: 0.549 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768781).  Saving model ...
Epoch: 12 cost time: 5.7939558029174805
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.746 Test Loss: 0.555 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.803188323974609
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.792 Test Loss: 0.550 Test Acc: 0.792
Validation loss decreased (-0.768781 --> -0.791902).  Saving model ...
Epoch: 14 cost time: 5.896750211715698
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.786 Test Loss: 0.562 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.092108488082886
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.786 Test Loss: 0.525 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.827847480773926
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.769 Test Loss: 0.545 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.478606939315796
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.362550497055054
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.792 Test Loss: 0.534 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 19 cost time: 6.270278453826904
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.792 Test Loss: 0.524 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 20 cost time: 6.2490105628967285
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.780 Test Loss: 0.539 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.772596597671509
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.780 Test Loss: 0.536 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.687349796295166
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.786 Test Loss: 0.538 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.732578992843628
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.786 Test Loss: 0.519 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.734917879104614
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 25 cost time: 6.041907548904419
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 26 cost time: 6.451745986938477
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 27 cost time: 6.680497169494629
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 28 cost time: 7.136080026626587
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.599441051483154
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.046532392501831
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.792 Test Loss: 0.510 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.337394952774048
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.780 Test Loss: 0.514 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.442669630050659
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.780 Test Loss: 0.512 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.393547534942627
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.798 Test Loss: 0.514 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.265650510787964
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.786 Test Loss: 0.510 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.172576427459717
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.798 Test Loss: 0.496 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.90816593170166
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.786 Test Loss: 0.502 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.647059202194214
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.786 Test Loss: 0.505 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.051411390304565
Epoch: 1, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.911 Vali Acc: 0.191 Test Loss: 1.911 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 6.137487173080444
Epoch: 2, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.530 Vali Acc: 0.514 Test Loss: 1.530 Test Acc: 0.514
Validation loss decreased (-0.190732 --> -0.514436).  Saving model ...
Epoch: 3 cost time: 5.794405937194824
Epoch: 3, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.107 Vali Acc: 0.601 Test Loss: 1.107 Test Acc: 0.601
Validation loss decreased (-0.514436 --> -0.601145).  Saving model ...
Epoch: 4 cost time: 5.79593300819397
Epoch: 4, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.907 Vali Acc: 0.659 Test Loss: 0.907 Test Acc: 0.659
Validation loss decreased (-0.601145 --> -0.658950).  Saving model ...
Epoch: 5 cost time: 5.41642165184021
Epoch: 5, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.845 Vali Acc: 0.636 Test Loss: 0.845 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.670997381210327
Epoch: 6, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.674 Vali Acc: 0.676 Test Loss: 0.674 Test Acc: 0.676
Validation loss decreased (-0.658950 --> -0.676294).  Saving model ...
Epoch: 7 cost time: 6.089533567428589
Epoch: 7, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.678 Vali Acc: 0.676 Test Loss: 0.678 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.225502252578735
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.553 Vali Acc: 0.780 Test Loss: 0.553 Test Acc: 0.780
Validation loss decreased (-0.676294 --> -0.780341).  Saving model ...
Epoch: 9 cost time: 6.493135213851929
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.769 Test Loss: 0.543 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.528965950012207
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.723 Test Loss: 0.562 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.998957633972168
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.757 Test Loss: 0.533 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.829679012298584
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.740 Test Loss: 0.533 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.03285026550293
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.763 Test Loss: 0.511 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.637059926986694
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.740 Test Loss: 0.531 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.955181121826172
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.763 Test Loss: 0.505 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.508202314376831
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.751 Test Loss: 0.509 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.836435079574585
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.799394130706787
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.769 Test Loss: 0.504 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.16899585723877
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
Validation loss decreased (inf --> -0.127148).  Saving model ...
Epoch: 2 cost time: 6.207920551300049
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.362716913223267
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.944034576416016
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.869184255599976
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.513982057571411
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.656896114349365
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.125486850738525
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.506494045257568
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.765427589416504
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.643517255783081
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.12716763005780346
model parameter : 3828231
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.706336975097656
Epoch: 1, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.431 Vali Acc: 0.347 Test Loss: 1.431 Test Acc: 0.347
Validation loss decreased (inf --> -0.346807).  Saving model ...
Epoch: 2 cost time: 5.59783411026001
Epoch: 2, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.121 Vali Acc: 0.538 Test Loss: 1.121 Test Acc: 0.538
Validation loss decreased (-0.346807 --> -0.537561).  Saving model ...
Epoch: 3 cost time: 6.116168022155762
Epoch: 3, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.798 Vali Acc: 0.694 Test Loss: 0.798 Test Acc: 0.694
Validation loss decreased (-0.537561 --> -0.693634).  Saving model ...
Epoch: 4 cost time: 5.833558797836304
Epoch: 4, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.693634 --> -0.803462).  Saving model ...
Epoch: 5 cost time: 6.098857879638672
Epoch: 5, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.548 Vali Acc: 0.786 Test Loss: 0.548 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.003803968429565
Epoch: 6, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.504 Vali Acc: 0.821 Test Loss: 0.504 Test Acc: 0.821
Validation loss decreased (-0.803462 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 6.260690212249756
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
Validation loss decreased (-0.820804 --> -0.855487).  Saving model ...
Epoch: 8 cost time: 5.964003086090088
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.534 Vali Acc: 0.838 Test Loss: 0.534 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.608486890792847
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.798 Test Loss: 0.482 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.353172063827515
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.827 Test Loss: 0.529 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.275480270385742
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.815 Test Loss: 0.480 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.015947580337524
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.034879922866821
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.827 Test Loss: 0.494 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.234416484832764
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.546991586685181
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.733442783355713
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.396265983581543
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.4412736892700195
Epoch: 1, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.433 Vali Acc: 0.324 Test Loss: 1.433 Test Acc: 0.324
Validation loss decreased (inf --> -0.323685).  Saving model ...
Epoch: 2 cost time: 5.6947922706604
Epoch: 2, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.096 Vali Acc: 0.584 Test Loss: 1.096 Test Acc: 0.584
Validation loss decreased (-0.323685 --> -0.583804).  Saving model ...
Epoch: 3 cost time: 6.239140510559082
Epoch: 3, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.764 Vali Acc: 0.705 Test Loss: 0.764 Test Acc: 0.705
Validation loss decreased (-0.583804 --> -0.705195).  Saving model ...
Epoch: 4 cost time: 6.479793548583984
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.613 Vali Acc: 0.798 Test Loss: 0.613 Test Acc: 0.798
Validation loss decreased (-0.705195 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 6.481076240539551
Epoch: 5, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.495 Vali Acc: 0.792 Test Loss: 0.495 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.338754177093506
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
Validation loss decreased (-0.797682 --> -0.867048).  Saving model ...
Epoch: 7 cost time: 6.145987272262573
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.3345787525177
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.529 Vali Acc: 0.815 Test Loss: 0.529 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.875398874282837
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.582531929016113
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.827 Test Loss: 0.515 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.9161906242370605
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.824037075042725
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.2315404415130615
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.832 Test Loss: 0.506 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.230564594268799
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.832 Test Loss: 0.505 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.281266689300537
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.130921363830566
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.832 Test Loss: 0.514 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.662328720092773
Epoch: 1, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.560 Vali Acc: 0.289 Test Loss: 1.560 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 5.5996994972229
Epoch: 2, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.091 Vali Acc: 0.595 Test Loss: 1.091 Test Acc: 0.595
Validation loss decreased (-0.289002 --> -0.595365).  Saving model ...
Epoch: 3 cost time: 6.00158429145813
Epoch: 3, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.761 Vali Acc: 0.723 Test Loss: 0.761 Test Acc: 0.723
Validation loss decreased (-0.595365 --> -0.722536).  Saving model ...
Epoch: 4 cost time: 6.372052192687988
Epoch: 4, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.586 Vali Acc: 0.798 Test Loss: 0.586 Test Acc: 0.798
Validation loss decreased (-0.722536 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 5.905399560928345
Epoch: 5, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 6.031987190246582
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838146).  Saving model ...
Epoch: 7 cost time: 5.468488931655884
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.584977626800537
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 5.682579517364502
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.682521820068359
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.832 Test Loss: 0.452 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.987374782562256
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.838 Test Loss: 0.461 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.563183546066284
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.827 Test Loss: 0.460 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.072998285293579
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.821 Test Loss: 0.461 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.337817430496216
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.113128423690796
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.534109592437744
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.331006288528442
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.832 Test Loss: 0.472 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.955790042877197
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.614942789077759
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.705 Vali Acc: 0.295 Test Loss: 1.705 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 5.9503395557403564
Epoch: 2, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.168 Vali Acc: 0.561 Test Loss: 1.168 Test Acc: 0.561
Validation loss decreased (-0.294781 --> -0.560682).  Saving model ...
Epoch: 3 cost time: 6.682111978530884
Epoch: 3, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.829 Vali Acc: 0.734 Test Loss: 0.829 Test Acc: 0.734
Validation loss decreased (-0.560682 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 6.9572577476501465
Epoch: 4, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
Validation loss decreased (-0.734096 --> -0.774560).  Saving model ...
Epoch: 5 cost time: 6.5525736808776855
Epoch: 5, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.530 Vali Acc: 0.815 Test Loss: 0.530 Test Acc: 0.815
Validation loss decreased (-0.774560 --> -0.815024).  Saving model ...
Epoch: 6 cost time: 6.717939615249634
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.491 Vali Acc: 0.832 Test Loss: 0.491 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832365).  Saving model ...
Epoch: 7 cost time: 5.868714094161987
Epoch: 7, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.480 Vali Acc: 0.798 Test Loss: 0.480 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.336811542510986
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.439 Vali Acc: 0.844 Test Loss: 0.439 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 6.427239894866943
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.865772485733032
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.821 Test Loss: 0.440 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.506298542022705
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.809 Test Loss: 0.445 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.3566601276397705
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.673536062240601
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.116732597351074
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.838 Test Loss: 0.441 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.756822347640991
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.832 Test Loss: 0.445 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.03821587562561
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.446054220199585
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.838 Test Loss: 0.439 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.7601282596588135
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.325543165206909
Epoch: 1, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.829 Vali Acc: 0.249 Test Loss: 1.829 Test Acc: 0.249
Validation loss decreased (inf --> -0.248537).  Saving model ...
Epoch: 2 cost time: 5.257475852966309
Epoch: 2, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.444 Vali Acc: 0.503 Test Loss: 1.444 Test Acc: 0.503
Validation loss decreased (-0.248537 --> -0.502876).  Saving model ...
Epoch: 3 cost time: 5.80235481262207
Epoch: 3, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.088 Vali Acc: 0.688 Test Loss: 1.088 Test Acc: 0.688
Validation loss decreased (-0.502876 --> -0.687850).  Saving model ...
Epoch: 4 cost time: 5.363848924636841
Epoch: 4, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.742 Vali Acc: 0.763 Test Loss: 0.742 Test Acc: 0.763
Validation loss decreased (-0.687850 --> -0.762998).  Saving model ...
Epoch: 5 cost time: 5.773350238800049
Epoch: 5, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.633 Vali Acc: 0.728 Test Loss: 0.633 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.683637619018555
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.512 Vali Acc: 0.798 Test Loss: 0.512 Test Acc: 0.798
Validation loss decreased (-0.762998 --> -0.797683).  Saving model ...
Epoch: 7 cost time: 6.048654079437256
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.551 Vali Acc: 0.786 Test Loss: 0.551 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.181068420410156
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
Validation loss decreased (-0.797683 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 6.640900611877441
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.861 Test Loss: 0.432 Test Acc: 0.861
Validation loss decreased (-0.826585 --> -0.861267).  Saving model ...
Epoch: 10 cost time: 6.175405263900757
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.861 Test Loss: 0.444 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.098011493682861
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.827 Test Loss: 0.438 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.307149648666382
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.020084857940674
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.861 Test Loss: 0.426 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861267).  Saving model ...
Epoch: 14 cost time: 5.728181838989258
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.642123460769653
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.855 Test Loss: 0.423 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.261233568191528
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.324527025222778
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.982491731643677
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.845320224761963
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.413 Vali Acc: 0.855 Test Loss: 0.413 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.010474443435669
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.855 Test Loss: 0.408 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.0319530963897705
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.847534656524658
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.7846152782440186
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.855 Test Loss: 0.406 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.557927131652832
Epoch: 1, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.884 Vali Acc: 0.231 Test Loss: 1.884 Test Acc: 0.231
Validation loss decreased (inf --> -0.231195).  Saving model ...
Epoch: 2 cost time: 5.372300624847412
Epoch: 2, Steps: 17 | Train Loss: 1.596 Vali Loss: 1.579 Vali Acc: 0.405 Test Loss: 1.579 Test Acc: 0.405
Validation loss decreased (-0.231195 --> -0.404608).  Saving model ...
Epoch: 3 cost time: 5.109893560409546
Epoch: 3, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.259 Vali Acc: 0.590 Test Loss: 1.259 Test Acc: 0.590
Validation loss decreased (-0.404608 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 5.326550483703613
Epoch: 4, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.989 Vali Acc: 0.653 Test Loss: 0.989 Test Acc: 0.653
Validation loss decreased (-0.589583 --> -0.653169).  Saving model ...
Epoch: 5 cost time: 5.561578989028931
Epoch: 5, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.777 Vali Acc: 0.711 Test Loss: 0.777 Test Acc: 0.711
Validation loss decreased (-0.653169 --> -0.710975).  Saving model ...
Epoch: 6 cost time: 5.611012935638428
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
Validation loss decreased (-0.710975 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 5.826157331466675
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.699 Vali Acc: 0.671 Test Loss: 0.699 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.990135192871094
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.723 Test Loss: 0.620 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.957340717315674
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.617 Vali Acc: 0.751 Test Loss: 0.617 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751439).  Saving model ...
Epoch: 10 cost time: 6.547910213470459
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.619 Vali Acc: 0.728 Test Loss: 0.619 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.503155708312988
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.734 Test Loss: 0.607 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.487110376358032
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.491119384765625
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.734 Test Loss: 0.619 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.363039016723633
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.780 Test Loss: 0.595 Test Acc: 0.780
Validation loss decreased (-0.751439 --> -0.780341).  Saving model ...
Epoch: 15 cost time: 5.280785322189331
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.98609733581543
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.910214900970459
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.110146999359131
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.720457315444946
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.927881240844727
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.574012756347656
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.768654108047485
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.734 Test Loss: 0.593 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.336485862731934
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.487623691558838
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.428689002990723
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.922 Vali Acc: 0.197 Test Loss: 1.922 Test Acc: 0.197
Validation loss decreased (inf --> -0.196513).  Saving model ...
Epoch: 2 cost time: 5.842241525650024
Epoch: 2, Steps: 17 | Train Loss: 1.681 Vali Loss: 1.661 Vali Acc: 0.405 Test Loss: 1.661 Test Acc: 0.405
Validation loss decreased (-0.196513 --> -0.404608).  Saving model ...
Epoch: 3 cost time: 6.051053762435913
Epoch: 3, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.390 Vali Acc: 0.555 Test Loss: 1.390 Test Acc: 0.555
Validation loss decreased (-0.404608 --> -0.554899).  Saving model ...
Epoch: 4 cost time: 5.901961088180542
Epoch: 4, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.212 Vali Acc: 0.555 Test Loss: 1.212 Test Acc: 0.555
Validation loss decreased (-0.554899 --> -0.554901).  Saving model ...
Epoch: 5 cost time: 5.914692401885986
Epoch: 5, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.928 Vali Acc: 0.642 Test Loss: 0.928 Test Acc: 0.642
Validation loss decreased (-0.554901 --> -0.641609).  Saving model ...
Epoch: 6 cost time: 6.0225441455841064
Epoch: 6, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.749 Vali Acc: 0.694 Test Loss: 0.749 Test Acc: 0.694
Validation loss decreased (-0.641609 --> -0.693634).  Saving model ...
Epoch: 7 cost time: 5.802794456481934
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.699 Vali Acc: 0.676 Test Loss: 0.699 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.9266886711120605
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.654 Vali Acc: 0.671 Test Loss: 0.654 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.731796741485596
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
Validation loss decreased (-0.693634 --> -0.716757).  Saving model ...
Epoch: 10 cost time: 5.921374082565308
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.705 Test Loss: 0.619 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.730003118515015
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.694 Test Loss: 0.618 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.732543468475342
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.740 Test Loss: 0.609 Test Acc: 0.740
Validation loss decreased (-0.716757 --> -0.739878).  Saving model ...
Epoch: 13 cost time: 5.590319633483887
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.682 Test Loss: 0.637 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.822536468505859
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.751 Test Loss: 0.595 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751439).  Saving model ...
Epoch: 15 cost time: 6.589163780212402
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.734 Test Loss: 0.597 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.341753959655762
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.728 Test Loss: 0.597 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.397132635116577
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.740 Test Loss: 0.585 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.4966185092926025
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.740 Test Loss: 0.582 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.553171396255493
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.723 Test Loss: 0.594 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.938672304153442
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.08357048034668
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.728 Test Loss: 0.592 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.1937596797943115
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 23 cost time: 6.039481163024902
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757220).  Saving model ...
Epoch: 24 cost time: 6.347538232803345
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.780 Test Loss: 0.562 Test Acc: 0.780
Validation loss decreased (-0.757220 --> -0.780341).  Saving model ...
Epoch: 25 cost time: 6.618167400360107
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.517059564590454
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.038652181625366
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.780 Test Loss: 0.558 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 28 cost time: 5.844707489013672
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.9868738651275635
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.775 Test Loss: 0.562 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.945955753326416
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.775 Test Loss: 0.563 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.576576471328735
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.769 Test Loss: 0.557 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.057394981384277
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.19824743270874
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.769 Test Loss: 0.554 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.793463468551636
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.632141590118408
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.051323413848877
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.786 Test Loss: 0.559 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 37 cost time: 6.034770488739014
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.769 Test Loss: 0.568 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.633141756057739
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 6.471504211425781
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 40 cost time: 6.334901332855225
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 41 cost time: 6.302687168121338
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
Validation loss decreased (-0.786122 --> -0.803463).  Saving model ...
Epoch: 42 cost time: 5.986440896987915
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.439446687698364
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.427691698074341
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.815 Test Loss: 0.555 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815023).  Saving model ...
Epoch: 45 cost time: 5.8057777881622314
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.150339841842651
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.786 Test Loss: 0.555 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.989809036254883
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.786 Test Loss: 0.557 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 6.115774393081665
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.792 Test Loss: 0.550 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 5.629354476928711
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.815 Test Loss: 0.549 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 50 cost time: 5.866428852081299
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.643465757369995
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 6.146480083465576
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 6.2806079387664795
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.798 Test Loss: 0.555 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 6.22778058052063
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.775 Test Loss: 0.564 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 6.346195936203003
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.786 Test Loss: 0.558 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 5.781550407409668
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.827 Test Loss: 0.544 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 57 cost time: 5.6481239795684814
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.815 Test Loss: 0.548 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.67885160446167
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.821 Test Loss: 0.550 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 5.53748345375061
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.815 Test Loss: 0.540 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 6.540560960769653
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.315075159072876
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.821 Test Loss: 0.542 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 6.165579557418823
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 6.086609363555908
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 5.63652491569519
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 5.695714950561523
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 5.485662460327148
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.82458758354187
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.913 Vali Acc: 0.162 Test Loss: 1.913 Test Acc: 0.162
Validation loss decreased (inf --> -0.161831).  Saving model ...
Epoch: 2 cost time: 5.749956369400024
Epoch: 2, Steps: 17 | Train Loss: 1.754 Vali Loss: 1.669 Vali Acc: 0.416 Test Loss: 1.669 Test Acc: 0.416
Validation loss decreased (-0.161831 --> -0.416168).  Saving model ...
Epoch: 3 cost time: 5.743009328842163
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.395 Vali Acc: 0.566 Test Loss: 1.395 Test Acc: 0.566
Validation loss decreased (-0.416168 --> -0.566460).  Saving model ...
Epoch: 4 cost time: 5.713659048080444
Epoch: 4, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.217 Vali Acc: 0.555 Test Loss: 1.217 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.728185415267944
Epoch: 5, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.871 Vali Acc: 0.682 Test Loss: 0.871 Test Acc: 0.682
Validation loss decreased (-0.566460 --> -0.682072).  Saving model ...
Epoch: 6 cost time: 6.072663307189941
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.695 Vali Acc: 0.711 Test Loss: 0.695 Test Acc: 0.711
Validation loss decreased (-0.682072 --> -0.710976).  Saving model ...
Epoch: 7 cost time: 5.881547212600708
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.662 Vali Acc: 0.723 Test Loss: 0.662 Test Acc: 0.723
Validation loss decreased (-0.710976 --> -0.722537).  Saving model ...
Epoch: 8 cost time: 6.342994689941406
Epoch: 8, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.606 Vali Acc: 0.746 Test Loss: 0.606 Test Acc: 0.746
Validation loss decreased (-0.722537 --> -0.745659).  Saving model ...
Epoch: 9 cost time: 5.412366151809692
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.532 Vali Acc: 0.815 Test Loss: 0.532 Test Acc: 0.815
Validation loss decreased (-0.745659 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 5.839034557342529
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.500 Vali Acc: 0.821 Test Loss: 0.500 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 11 cost time: 5.801817178726196
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838146).  Saving model ...
Epoch: 12 cost time: 5.736338376998901
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.417112350463867
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.104815244674683
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.832 Test Loss: 0.470 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.170130252838135
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 5.974597930908203
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.821 Test Loss: 0.469 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.656053781509399
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
Validation loss decreased (-0.843926 --> -0.855487).  Saving model ...
Epoch: 18 cost time: 5.698505640029907
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.894751787185669
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.855 Test Loss: 0.449 Test Acc: 0.855
Validation loss decreased (-0.855487 --> -0.855487).  Saving model ...
Epoch: 20 cost time: 5.8860673904418945
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.861 Test Loss: 0.439 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861267).  Saving model ...
Epoch: 21 cost time: 6.040253400802612
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861267).  Saving model ...
Epoch: 22 cost time: 6.146284103393555
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.861 Test Loss: 0.438 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.387206554412842
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.827 Test Loss: 0.459 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.47574782371521
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.827 Test Loss: 0.446 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.427337169647217
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.519843339920044
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.821 Test Loss: 0.441 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.998715400695801
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.184956073760986
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.832 Test Loss: 0.439 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.187713384628296
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.770279169082642
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.396538972854614
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861267).  Saving model ...
Epoch: 32 cost time: 5.5244224071502686
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.827 Test Loss: 0.428 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.381212472915649
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.832 Test Loss: 0.424 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.1984546184539795
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.861 Test Loss: 0.419 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861267).  Saving model ...
Epoch: 35 cost time: 6.088433027267456
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.772354364395142
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.918123960494995
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.821 Test Loss: 0.435 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.9069952964782715
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.827 Test Loss: 0.431 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.785382270812988
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 6.239299297332764
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 6.039867877960205
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.827 Test Loss: 0.458 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 6.076278448104858
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 5.861932039260864
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
Validation loss decreased (-0.861267 --> -0.867048).  Saving model ...
Epoch: 44 cost time: 5.693392038345337
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.838 Test Loss: 0.430 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.681519031524658
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.653821706771851
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 5.712059259414673
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.838 Test Loss: 0.431 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 6.332567930221558
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.838 Test Loss: 0.433 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 6.391862154006958
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.838 Test Loss: 0.433 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 6.349420070648193
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 6.233595132827759
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.873 Test Loss: 0.427 Test Acc: 0.873
Validation loss decreased (-0.867048 --> -0.872828).  Saving model ...
Epoch: 52 cost time: 6.193129539489746
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 6.041568279266357
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 5.403804540634155
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.838 Test Loss: 0.440 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 5.739483594894409
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 5.851349115371704
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.838 Test Loss: 0.443 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 5.838337182998657
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 5.668440580368042
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 5.654689788818359
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 5.393445014953613
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.838 Test Loss: 0.440 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 5.764276504516602
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.9605185985565186
Epoch: 1, Steps: 17 | Train Loss: 2.042 Vali Loss: 1.896 Vali Acc: 0.185 Test Loss: 1.896 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 6.19759726524353
Epoch: 2, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.647 Vali Acc: 0.451 Test Loss: 1.647 Test Acc: 0.451
Validation loss decreased (-0.184952 --> -0.450851).  Saving model ...
Epoch: 3 cost time: 6.057812929153442
Epoch: 3, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.380 Vali Acc: 0.613 Test Loss: 1.380 Test Acc: 0.613
Validation loss decreased (-0.450851 --> -0.612703).  Saving model ...
Epoch: 4 cost time: 5.655363082885742
Epoch: 4, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.177 Vali Acc: 0.555 Test Loss: 1.177 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.508334636688232
Epoch: 5, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.861 Vali Acc: 0.734 Test Loss: 0.861 Test Acc: 0.734
Validation loss decreased (-0.612703 --> -0.734095).  Saving model ...
Epoch: 6 cost time: 5.60542106628418
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.706 Vali Acc: 0.751 Test Loss: 0.706 Test Acc: 0.751
Validation loss decreased (-0.734095 --> -0.751438).  Saving model ...
Epoch: 7 cost time: 6.335826635360718
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.660 Vali Acc: 0.728 Test Loss: 0.660 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.511122226715088
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.584 Vali Acc: 0.740 Test Loss: 0.584 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.106632471084595
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.529 Vali Acc: 0.786 Test Loss: 0.529 Test Acc: 0.786
Validation loss decreased (-0.751438 --> -0.786122).  Saving model ...
Epoch: 10 cost time: 5.91817569732666
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.507 Vali Acc: 0.786 Test Loss: 0.507 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 11 cost time: 5.746044397354126
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.513 Vali Acc: 0.792 Test Loss: 0.513 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 12 cost time: 6.4864044189453125
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 6.268590688705444
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.292987585067749
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 15 cost time: 5.787991046905518
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.913276195526123
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.564072132110596
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 18 cost time: 6.146338224411011
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.188433647155762
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.844 Test Loss: 0.470 Test Acc: 0.844
Validation loss decreased (-0.832365 --> -0.843926).  Saving model ...
Epoch: 20 cost time: 6.128584623336792
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.832 Test Loss: 0.459 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.017576456069946
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.827 Test Loss: 0.454 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.105919122695923
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.838 Test Loss: 0.447 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.9685447216033936
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.832 Test Loss: 0.466 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.323832988739014
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849706).  Saving model ...
Epoch: 25 cost time: 6.213460683822632
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
Validation loss decreased (-0.849706 --> -0.855487).  Saving model ...
Epoch: 26 cost time: 5.772429704666138
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.850 Test Loss: 0.445 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.653878211975098
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.5243964195251465
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.844 Test Loss: 0.442 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.663444519042969
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.260335206985474
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.223773956298828
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.600322723388672
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.6346423625946045
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.850 Test Loss: 0.427 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.513368606567383
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.062869310379028
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.637451171875
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
Validation loss decreased (inf --> -0.150270).  Saving model ...
Epoch: 2 cost time: 5.7690839767456055
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.1844801902771
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.6861732006073
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.692032098770142
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.268247365951538
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.359719753265381
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.190188884735107
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.516437292098999
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.316359519958496
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.463079452514648
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15028901734104047
model parameter : 2733319
model size : 15.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.259211778640747
Epoch: 1, Steps: 17 | Train Loss: 1.795 Vali Loss: 1.453 Vali Acc: 0.324 Test Loss: 1.453 Test Acc: 0.324
Validation loss decreased (inf --> -0.323685).  Saving model ...
Epoch: 2 cost time: 6.727590799331665
Epoch: 2, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.089 Vali Acc: 0.532 Test Loss: 1.089 Test Acc: 0.532
Validation loss decreased (-0.323685 --> -0.531781).  Saving model ...
Epoch: 3 cost time: 6.685542583465576
Epoch: 3, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.856 Vali Acc: 0.717 Test Loss: 0.856 Test Acc: 0.717
Validation loss decreased (-0.531781 --> -0.716754).  Saving model ...
Epoch: 4 cost time: 5.977394342422485
Epoch: 4, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.748 Vali Acc: 0.705 Test Loss: 0.748 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.8751983642578125
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.581 Vali Acc: 0.780 Test Loss: 0.581 Test Acc: 0.780
Validation loss decreased (-0.716754 --> -0.780341).  Saving model ...
Epoch: 6 cost time: 5.911638021469116
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.558 Vali Acc: 0.792 Test Loss: 0.558 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791902).  Saving model ...
Epoch: 7 cost time: 6.271675109863281
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
Validation loss decreased (-0.791902 --> -0.832365).  Saving model ...
Epoch: 8 cost time: 6.6870293617248535
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 9 cost time: 6.39848780632019
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849706).  Saving model ...
Epoch: 10 cost time: 5.720377683639526
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.827 Test Loss: 0.464 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.021096467971802
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.5905516147613525
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.827 Test Loss: 0.479 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.078901290893555
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.832 Test Loss: 0.478 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.195491313934326
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.116974830627441
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.832 Test Loss: 0.479 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.09861159324646
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.827 Test Loss: 0.491 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.772183418273926
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.827 Test Loss: 0.491 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.275954484939575
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.832 Test Loss: 0.489 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.741212368011475
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.832 Test Loss: 0.496 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.689926624298096
Epoch: 1, Steps: 17 | Train Loss: 1.871 Vali Loss: 1.513 Vali Acc: 0.335 Test Loss: 1.513 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 6.335870981216431
Epoch: 2, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.072 Vali Acc: 0.578 Test Loss: 1.072 Test Acc: 0.578
Validation loss decreased (-0.335245 --> -0.578024).  Saving model ...
Epoch: 3 cost time: 6.758226633071899
Epoch: 3, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.829 Vali Acc: 0.723 Test Loss: 0.829 Test Acc: 0.723
Validation loss decreased (-0.578024 --> -0.722535).  Saving model ...
Epoch: 4 cost time: 7.014097452163696
Epoch: 4, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.720 Vali Acc: 0.717 Test Loss: 0.720 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.429504632949829
Epoch: 5, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.553 Vali Acc: 0.798 Test Loss: 0.553 Test Acc: 0.798
Validation loss decreased (-0.722535 --> -0.797682).  Saving model ...
Epoch: 6 cost time: 6.538299083709717
Epoch: 6, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.462 Vali Acc: 0.827 Test Loss: 0.462 Test Acc: 0.827
Validation loss decreased (-0.797682 --> -0.826585).  Saving model ...
Epoch: 7 cost time: 6.485427379608154
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838146).  Saving model ...
Epoch: 8 cost time: 7.18828558921814
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.130821466445923
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.844 Test Loss: 0.454 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 10 cost time: 6.7411580085754395
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.832 Test Loss: 0.457 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.510782718658447
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.1446967124938965
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.1169753074646
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.509580135345459
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.832 Test Loss: 0.470 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.964968919754028
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.838 Test Loss: 0.471 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.665388345718384
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.832 Test Loss: 0.479 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.192373037338257
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.338381052017212
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.775577783584595
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.832 Test Loss: 0.485 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.117987394332886
Epoch: 1, Steps: 17 | Train Loss: 1.909 Vali Loss: 1.580 Vali Acc: 0.272 Test Loss: 1.580 Test Acc: 0.272
Validation loss decreased (inf --> -0.271660).  Saving model ...
Epoch: 2 cost time: 5.882035493850708
Epoch: 2, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.071 Vali Acc: 0.613 Test Loss: 1.071 Test Acc: 0.613
Validation loss decreased (-0.271660 --> -0.612706).  Saving model ...
Epoch: 3 cost time: 6.208345890045166
Epoch: 3, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.802 Vali Acc: 0.746 Test Loss: 0.802 Test Acc: 0.746
Validation loss decreased (-0.612706 --> -0.745657).  Saving model ...
Epoch: 4 cost time: 5.885753870010376
Epoch: 4, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 5.723647594451904
Epoch: 5, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
Validation loss decreased (-0.762999 --> -0.763000).  Saving model ...
Epoch: 6 cost time: 6.3688719272613525
Epoch: 6, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
Validation loss decreased (-0.763000 --> -0.843926).  Saving model ...
Epoch: 7 cost time: 6.07292103767395
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.443 Vali Acc: 0.815 Test Loss: 0.443 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.952371835708618
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.426 Vali Acc: 0.832 Test Loss: 0.426 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.835256099700928
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.844 Test Loss: 0.437 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 10 cost time: 5.205810785293579
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.832 Test Loss: 0.443 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.3117146492004395
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.832 Test Loss: 0.440 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.478172540664673
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.838 Test Loss: 0.443 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.654296159744263
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.488714694976807
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.832 Test Loss: 0.452 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.612422704696655
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.832 Test Loss: 0.450 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.482461452484131
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.832 Test Loss: 0.454 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.521267652511597
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.832 Test Loss: 0.456 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.7962305545806885
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.827 Test Loss: 0.455 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.788693428039551
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.832 Test Loss: 0.456 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.557401657104492
Epoch: 1, Steps: 17 | Train Loss: 1.926 Vali Loss: 1.695 Vali Acc: 0.301 Test Loss: 1.695 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 5.599262952804565
Epoch: 2, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.132 Vali Acc: 0.630 Test Loss: 1.132 Test Acc: 0.630
Validation loss decreased (-0.300561 --> -0.630046).  Saving model ...
Epoch: 3 cost time: 5.109331846237183
Epoch: 3, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.799 Vali Acc: 0.780 Test Loss: 0.799 Test Acc: 0.780
Validation loss decreased (-0.630046 --> -0.780339).  Saving model ...
Epoch: 4 cost time: 5.021164417266846
Epoch: 4, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.657 Vali Acc: 0.792 Test Loss: 0.657 Test Acc: 0.792
Validation loss decreased (-0.780339 --> -0.791901).  Saving model ...
Epoch: 5 cost time: 5.4210288524627686
Epoch: 5, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.550 Vali Acc: 0.798 Test Loss: 0.550 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797682).  Saving model ...
Epoch: 6 cost time: 5.7119224071502686
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.497 Vali Acc: 0.821 Test Loss: 0.497 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 5.869752645492554
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.579056024551392
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.460 Vali Acc: 0.821 Test Loss: 0.460 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820805).  Saving model ...
Epoch: 9 cost time: 5.639909505844116
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.453 Vali Acc: 0.827 Test Loss: 0.453 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 10 cost time: 5.910901784896851
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 6.185126781463623
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.821 Test Loss: 0.456 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.907779693603516
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.838 Test Loss: 0.461 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 13 cost time: 5.3215672969818115
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 14 cost time: 5.264190435409546
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.821 Test Loss: 0.462 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.566238164901733
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.6466569900512695
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 5.412829160690308
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.633937835693359
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.821 Test Loss: 0.465 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.731566905975342
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.821 Test Loss: 0.465 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.944951772689819
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.827 Test Loss: 0.464 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.954449415206909
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.190199136734009
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.757029056549072
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.697755336761475
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.827 Test Loss: 0.472 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.985567331314087
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.827 Test Loss: 0.474 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.900766134262085
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.718350172042847
Epoch: 1, Steps: 17 | Train Loss: 1.963 Vali Loss: 1.841 Vali Acc: 0.243 Test Loss: 1.841 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 6.472325086593628
Epoch: 2, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.418 Vali Acc: 0.601 Test Loss: 1.418 Test Acc: 0.601
Validation loss decreased (-0.242756 --> -0.601142).  Saving model ...
Epoch: 3 cost time: 6.337906360626221
Epoch: 3, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.066 Vali Acc: 0.665 Test Loss: 1.066 Test Acc: 0.665
Validation loss decreased (-0.601142 --> -0.664729).  Saving model ...
Epoch: 4 cost time: 6.267428398132324
Epoch: 4, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.832 Vali Acc: 0.699 Test Loss: 0.832 Test Acc: 0.699
Validation loss decreased (-0.664729 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 6.009641647338867
Epoch: 5, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.705 Vali Acc: 0.711 Test Loss: 0.705 Test Acc: 0.711
Validation loss decreased (-0.699414 --> -0.710976).  Saving model ...
Epoch: 6 cost time: 5.7015838623046875
Epoch: 6, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.530 Vali Acc: 0.832 Test Loss: 0.530 Test Acc: 0.832
Validation loss decreased (-0.710976 --> -0.832365).  Saving model ...
Epoch: 7 cost time: 5.991422414779663
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.532 Vali Acc: 0.798 Test Loss: 0.532 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.0468950271606445
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.467 Vali Acc: 0.855 Test Loss: 0.467 Test Acc: 0.855
Validation loss decreased (-0.832365 --> -0.855487).  Saving model ...
Epoch: 9 cost time: 5.596136569976807
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.838 Test Loss: 0.461 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.500708818435669
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.849554538726807
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861267).  Saving model ...
Epoch: 12 cost time: 6.60024881362915
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.862689256668091
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.093487977981567
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.006312608718872
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.838 Test Loss: 0.432 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.97477912902832
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.7174742221832275
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.3425517082214355
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.6576526165008545
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.302497386932373
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.712391138076782
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.635488986968994
Epoch: 1, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.903 Vali Acc: 0.197 Test Loss: 1.903 Test Acc: 0.197
Validation loss decreased (inf --> -0.196513).  Saving model ...
Epoch: 2 cost time: 6.294611692428589
Epoch: 2, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.558 Vali Acc: 0.514 Test Loss: 1.558 Test Acc: 0.514
Validation loss decreased (-0.196513 --> -0.514435).  Saving model ...
Epoch: 3 cost time: 6.816701173782349
Epoch: 3, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.271 Vali Acc: 0.595 Test Loss: 1.271 Test Acc: 0.595
Validation loss decreased (-0.514435 --> -0.595363).  Saving model ...
Epoch: 4 cost time: 6.748120069503784
Epoch: 4, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.988 Vali Acc: 0.665 Test Loss: 0.988 Test Acc: 0.665
Validation loss decreased (-0.595363 --> -0.664730).  Saving model ...
Epoch: 5 cost time: 6.2762291431427
Epoch: 5, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.824 Vali Acc: 0.694 Test Loss: 0.824 Test Acc: 0.694
Validation loss decreased (-0.664730 --> -0.693633).  Saving model ...
Epoch: 6 cost time: 6.048174619674683
Epoch: 6, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.659 Vali Acc: 0.792 Test Loss: 0.659 Test Acc: 0.792
Validation loss decreased (-0.693633 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 5.743452548980713
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.709 Vali Acc: 0.711 Test Loss: 0.709 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.327566862106323
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.622 Vali Acc: 0.717 Test Loss: 0.622 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.84460711479187
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.786 Test Loss: 0.596 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.715163707733154
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.589 Vali Acc: 0.792 Test Loss: 0.589 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 6.465357303619385
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.586 Vali Acc: 0.792 Test Loss: 0.586 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 12 cost time: 6.402076721191406
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.798 Test Loss: 0.585 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 13 cost time: 6.281914949417114
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 14 cost time: 6.3439671993255615
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.578 Vali Acc: 0.786 Test Loss: 0.578 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.574846982955933
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.0636303424835205
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.827 Test Loss: 0.568 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826584).  Saving model ...
Epoch: 17 cost time: 5.7663514614105225
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.650032997131348
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.958364725112915
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.848102807998657
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.827 Test Loss: 0.560 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 21 cost time: 6.3670361042022705
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.821 Test Loss: 0.555 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.628179311752319
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.827 Test Loss: 0.553 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 23 cost time: 6.669336795806885
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.815 Test Loss: 0.557 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.174453973770142
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.815 Test Loss: 0.557 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.1985883712768555
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.827 Test Loss: 0.552 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 26 cost time: 6.638399600982666
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.821 Test Loss: 0.549 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.808107376098633
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.821 Test Loss: 0.550 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.781379699707031
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.236824989318848
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.675694704055786
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.063006639480591
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 5.785104751586914
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.835531711578369
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.815 Test Loss: 0.539 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.758429765701294
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.164918899536133
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.803 Test Loss: 0.533 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.904397010803223
Epoch: 1, Steps: 17 | Train Loss: 2.007 Vali Loss: 1.947 Vali Acc: 0.202 Test Loss: 1.947 Test Acc: 0.202
Validation loss decreased (inf --> -0.202293).  Saving model ...
Epoch: 2 cost time: 5.439742088317871
Epoch: 2, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.682 Vali Acc: 0.434 Test Loss: 1.682 Test Acc: 0.434
Validation loss decreased (-0.202293 --> -0.433509).  Saving model ...
Epoch: 3 cost time: 6.059446811676025
Epoch: 3, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.457 Vali Acc: 0.520 Test Loss: 1.457 Test Acc: 0.520
Validation loss decreased (-0.433509 --> -0.520217).  Saving model ...
Epoch: 4 cost time: 6.852358102798462
Epoch: 4, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.155 Vali Acc: 0.566 Test Loss: 1.155 Test Acc: 0.566
Validation loss decreased (-0.520217 --> -0.566462).  Saving model ...
Epoch: 5 cost time: 6.104033708572388
Epoch: 5, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.942 Vali Acc: 0.624 Test Loss: 0.942 Test Acc: 0.624
Validation loss decreased (-0.566462 --> -0.624268).  Saving model ...
Epoch: 6 cost time: 6.019043445587158
Epoch: 6, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.746 Vali Acc: 0.653 Test Loss: 0.746 Test Acc: 0.653
Validation loss decreased (-0.624268 --> -0.653172).  Saving model ...
Epoch: 7 cost time: 6.637282609939575
Epoch: 7, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.710 Vali Acc: 0.694 Test Loss: 0.710 Test Acc: 0.694
Validation loss decreased (-0.653172 --> -0.693635).  Saving model ...
Epoch: 8 cost time: 6.491311073303223
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.637 Vali Acc: 0.676 Test Loss: 0.637 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.93658971786499
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.635 Vali Acc: 0.711 Test Loss: 0.635 Test Acc: 0.711
Validation loss decreased (-0.693635 --> -0.710976).  Saving model ...
Epoch: 10 cost time: 5.463210582733154
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.632 Vali Acc: 0.699 Test Loss: 0.632 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.508320569992065
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.699 Test Loss: 0.628 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.932758092880249
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.631 Vali Acc: 0.699 Test Loss: 0.631 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.7918055057525635
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.740 Test Loss: 0.611 Test Acc: 0.740
Validation loss decreased (-0.710976 --> -0.739878).  Saving model ...
Epoch: 14 cost time: 5.479929208755493
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.699 Test Loss: 0.622 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.1290364265441895
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.711 Test Loss: 0.606 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.326552152633667
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.728 Test Loss: 0.612 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.060119867324829
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.740 Test Loss: 0.609 Test Acc: 0.740
Validation loss decreased (-0.739878 --> -0.739878).  Saving model ...
Epoch: 18 cost time: 5.497895002365112
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.598 Vali Acc: 0.728 Test Loss: 0.598 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.73301887512207
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
Validation loss decreased (-0.739878 --> -0.763000).  Saving model ...
Epoch: 20 cost time: 6.252967357635498
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.108215808868408
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.15360426902771
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.769 Test Loss: 0.597 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 23 cost time: 5.73479962348938
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.3274548053741455
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.295978307723999
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.919248819351196
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.677722692489624
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.769 Test Loss: 0.591 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 28 cost time: 6.182671308517456
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.769 Test Loss: 0.582 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 29 cost time: 6.6987526416778564
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.769 Test Loss: 0.585 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.610370874404907
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.769 Test Loss: 0.589 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.19307279586792
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.811304330825806
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.286747217178345
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 6.444947957992554
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.769 Test Loss: 0.574 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 35 cost time: 5.615746974945068
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.751 Test Loss: 0.577 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.587580919265747
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.919620752334595
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 6.544727563858032
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 6.655733346939087
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 6.304949998855591
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.695789575576782
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.626925945281982
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 6.625259637832642
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 5.896422863006592
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.57402777671814
Epoch: 1, Steps: 17 | Train Loss: 2.021 Vali Loss: 1.962 Vali Acc: 0.162 Test Loss: 1.962 Test Acc: 0.162
Validation loss decreased (inf --> -0.161830).  Saving model ...
Epoch: 2 cost time: 5.651899099349976
Epoch: 2, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.710 Vali Acc: 0.399 Test Loss: 1.710 Test Acc: 0.399
Validation loss decreased (-0.161830 --> -0.398827).  Saving model ...
Epoch: 3 cost time: 5.986645221710205
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.497 Vali Acc: 0.486 Test Loss: 1.497 Test Acc: 0.486
Validation loss decreased (-0.398827 --> -0.485534).  Saving model ...
Epoch: 4 cost time: 6.5669660568237305
Epoch: 4, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.184 Vali Acc: 0.572 Test Loss: 1.184 Test Acc: 0.572
Validation loss decreased (-0.485534 --> -0.572242).  Saving model ...
Epoch: 5 cost time: 5.745732545852661
Epoch: 5, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.922 Vali Acc: 0.676 Test Loss: 0.922 Test Acc: 0.676
Validation loss decreased (-0.572242 --> -0.676291).  Saving model ...
Epoch: 6 cost time: 5.840328216552734
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.744 Vali Acc: 0.711 Test Loss: 0.744 Test Acc: 0.711
Validation loss decreased (-0.676291 --> -0.710975).  Saving model ...
Epoch: 7 cost time: 6.4588212966918945
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.610 Vali Acc: 0.815 Test Loss: 0.610 Test Acc: 0.815
Validation loss decreased (-0.710975 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 5.9867236614227295
Epoch: 8, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.604 Vali Acc: 0.786 Test Loss: 0.604 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.39501690864563
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.583 Vali Acc: 0.786 Test Loss: 0.583 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.9528937339782715
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 11 cost time: 6.656674861907959
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.603175163269043
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.1412436962127686
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.363749742507935
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.314501762390137
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.037525177001953
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.821 Test Loss: 0.527 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820804).  Saving model ...
Epoch: 17 cost time: 6.019750118255615
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.821 Test Loss: 0.516 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 18 cost time: 6.2501842975616455
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.821 Test Loss: 0.529 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.304860591888428
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.821 Test Loss: 0.528 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.667587518692017
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.821 Test Loss: 0.518 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.688210725784302
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.821 Test Loss: 0.505 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 22 cost time: 6.001745700836182
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.821 Test Loss: 0.523 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.27985143661499
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.603428840637207
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.096809148788452
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.815 Test Loss: 0.508 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.237978219985962
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.821 Test Loss: 0.510 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.913737535476685
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.815 Test Loss: 0.508 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.560395240783691
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.827 Test Loss: 0.497 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 29 cost time: 5.698250770568848
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.833578586578369
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.821 Test Loss: 0.509 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.412992238998413
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.821 Test Loss: 0.512 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.040635108947754
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.838 Test Loss: 0.503 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838145).  Saving model ...
Epoch: 33 cost time: 5.613800525665283
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.172532796859741
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.0486133098602295
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.821 Test Loss: 0.505 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.3188629150390625
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.493 Vali Acc: 0.821 Test Loss: 0.493 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.189286231994629
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.491 Vali Acc: 0.827 Test Loss: 0.491 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.224130868911743
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.815 Test Loss: 0.502 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.988804578781128
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.031028747558594
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 6.330732345581055
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 6.87284517288208
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.151058912277222
Epoch: 1, Steps: 17 | Train Loss: 1.992 Vali Loss: 2.005 Vali Acc: 0.150 Test Loss: 2.005 Test Acc: 0.150
Validation loss decreased (inf --> -0.150269).  Saving model ...
Epoch: 2 cost time: 6.285562992095947
Epoch: 2, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.736 Vali Acc: 0.324 Test Loss: 1.736 Test Acc: 0.324
Validation loss decreased (-0.150269 --> -0.323682).  Saving model ...
Epoch: 3 cost time: 6.5951642990112305
Epoch: 3, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.524 Vali Acc: 0.462 Test Loss: 1.524 Test Acc: 0.462
Validation loss decreased (-0.323682 --> -0.462413).  Saving model ...
Epoch: 4 cost time: 6.969325304031372
Epoch: 4, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.171 Vali Acc: 0.590 Test Loss: 1.171 Test Acc: 0.590
Validation loss decreased (-0.462413 --> -0.589584).  Saving model ...
Epoch: 5 cost time: 6.582249879837036
Epoch: 5, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.903 Vali Acc: 0.699 Test Loss: 0.903 Test Acc: 0.699
Validation loss decreased (-0.589584 --> -0.699413).  Saving model ...
Epoch: 6 cost time: 6.3974926471710205
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.730 Vali Acc: 0.728 Test Loss: 0.730 Test Acc: 0.728
Validation loss decreased (-0.699413 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 7.130926132202148
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
Validation loss decreased (-0.728316 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 6.941803455352783
Epoch: 8, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.592 Vali Acc: 0.757 Test Loss: 0.592 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.766746997833252
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.555 Vali Acc: 0.780 Test Loss: 0.555 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.514618158340454
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 11 cost time: 6.353986024856567
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.530 Vali Acc: 0.792 Test Loss: 0.530 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.995588302612305
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.815 Test Loss: 0.515 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 13 cost time: 6.902689456939697
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.344698429107666
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.245250225067139
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.948586702346802
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.503 Vali Acc: 0.815 Test Loss: 0.503 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 17 cost time: 6.373358726501465
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.821 Test Loss: 0.488 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 18 cost time: 6.615147829055786
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.1126954555511475
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.827 Test Loss: 0.484 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 20 cost time: 6.38700008392334
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838145).  Saving model ...
Epoch: 21 cost time: 6.272729396820068
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838146).  Saving model ...
Epoch: 22 cost time: 6.716277599334717
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.827 Test Loss: 0.470 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.219877243041992
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.24035906791687
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.029212713241577
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.832 Test Loss: 0.474 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.802398681640625
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.827 Test Loss: 0.472 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.511975288391113
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 28 cost time: 7.123868703842163
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 29 cost time: 6.535542964935303
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.832 Test Loss: 0.465 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.15907621383667
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.43034291267395
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.423024654388428
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.827 Test Loss: 0.460 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.020758628845215
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 6.174950122833252
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.832 Test Loss: 0.462 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.3130011558532715
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.832 Test Loss: 0.474 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.960845470428467
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.838 Test Loss: 0.459 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 7.108090400695801
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.821 Test Loss: 0.459 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 6.822445869445801
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.827 Test Loss: 0.461 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.713061094284058
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
Validation loss decreased (inf --> -0.132929).  Saving model ...
Epoch: 2 cost time: 5.666526556015015
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.3124611377716064
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.271948337554932
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.791520595550537
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.385544061660767
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.23396897315979
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.913532972335815
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.6778693199157715
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.133 Test Loss: 1.947 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.787066459655762
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.133 Test Loss: 1.947 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.449442386627197
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.133 Test Loss: 1.947 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.1329479768786127
model parameter : 1946887
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.68582820892334
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.425 Vali Acc: 0.370 Test Loss: 1.425 Test Acc: 0.370
Validation loss decreased (inf --> -0.369928).  Saving model ...
Epoch: 2 cost time: 5.881025552749634
Epoch: 2, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.063 Vali Acc: 0.555 Test Loss: 1.063 Test Acc: 0.555
Validation loss decreased (-0.369928 --> -0.554903).  Saving model ...
Epoch: 3 cost time: 6.160071849822998
Epoch: 3, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.894 Vali Acc: 0.694 Test Loss: 0.894 Test Acc: 0.694
Validation loss decreased (-0.554903 --> -0.693633).  Saving model ...
Epoch: 4 cost time: 5.94366717338562
Epoch: 4, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
Validation loss decreased (-0.693633 --> -0.803462).  Saving model ...
Epoch: 5 cost time: 5.876744031906128
Epoch: 5, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.474 Vali Acc: 0.798 Test Loss: 0.474 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.482842206954956
Epoch: 6, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.431 Vali Acc: 0.838 Test Loss: 0.431 Test Acc: 0.838
Validation loss decreased (-0.803462 --> -0.838146).  Saving model ...
Epoch: 7 cost time: 5.865044355392456
Epoch: 7, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
Validation loss decreased (-0.838146 --> -0.855487).  Saving model ...
Epoch: 8 cost time: 5.747419595718384
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.425 Vali Acc: 0.838 Test Loss: 0.425 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.502265930175781
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.477 Vali Acc: 0.798 Test Loss: 0.477 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.332187175750732
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.428 Vali Acc: 0.838 Test Loss: 0.428 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.5805299282073975
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.815 Test Loss: 0.448 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.7808215618133545
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.827 Test Loss: 0.444 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.688000202178955
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.827 Test Loss: 0.444 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.793841123580933
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.837450265884399
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.75311541557312
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.827 Test Loss: 0.454 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.504129648208618
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.821 Test Loss: 0.456 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.13247036933899
Epoch: 1, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.478 Vali Acc: 0.376 Test Loss: 1.478 Test Acc: 0.376
Validation loss decreased (inf --> -0.375708).  Saving model ...
Epoch: 2 cost time: 6.294153213500977
Epoch: 2, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.068 Vali Acc: 0.601 Test Loss: 1.068 Test Acc: 0.601
Validation loss decreased (-0.375708 --> -0.601145).  Saving model ...
Epoch: 3 cost time: 6.183726787567139
Epoch: 3, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.867 Vali Acc: 0.659 Test Loss: 0.867 Test Acc: 0.659
Validation loss decreased (-0.601145 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 5.783170938491821
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
Validation loss decreased (-0.658951 --> -0.803462).  Saving model ...
Epoch: 5 cost time: 5.919402837753296
Epoch: 5, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.470 Vali Acc: 0.798 Test Loss: 0.470 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.5137083530426025
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.427 Vali Acc: 0.827 Test Loss: 0.427 Test Acc: 0.827
Validation loss decreased (-0.803462 --> -0.826585).  Saving model ...
Epoch: 7 cost time: 6.341064691543579
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.815 Test Loss: 0.466 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.873720645904541
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
Validation loss decreased (-0.826585 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 5.696960210800171
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.439 Vali Acc: 0.821 Test Loss: 0.439 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.213069915771484
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.821 Test Loss: 0.443 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.472692012786865
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.809 Test Loss: 0.448 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.5498576164245605
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.821 Test Loss: 0.451 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.242759943008423
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.821 Test Loss: 0.451 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.933023929595947
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.827 Test Loss: 0.448 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.988596200942993
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.827 Test Loss: 0.454 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.951757431030273
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.611624002456665
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.821 Test Loss: 0.463 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.568575382232666
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.827 Test Loss: 0.468 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.610685586929321
Epoch: 1, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.538 Vali Acc: 0.376 Test Loss: 1.538 Test Acc: 0.376
Validation loss decreased (inf --> -0.375707).  Saving model ...
Epoch: 2 cost time: 6.665038108825684
Epoch: 2, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.057 Vali Acc: 0.624 Test Loss: 1.057 Test Acc: 0.624
Validation loss decreased (-0.375707 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 5.672642946243286
Epoch: 3, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.840 Vali Acc: 0.665 Test Loss: 0.840 Test Acc: 0.665
Validation loss decreased (-0.624267 --> -0.664731).  Saving model ...
Epoch: 4 cost time: 6.121647119522095
Epoch: 4, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.590 Vali Acc: 0.798 Test Loss: 0.590 Test Acc: 0.798
Validation loss decreased (-0.664731 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 5.9527587890625
Epoch: 5, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
Validation loss decreased (-0.797682 --> -0.849706).  Saving model ...
Epoch: 6 cost time: 5.348976135253906
Epoch: 6, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.434 Vali Acc: 0.832 Test Loss: 0.434 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.342438697814941
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.457 Vali Acc: 0.827 Test Loss: 0.457 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.86549186706543
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.425 Vali Acc: 0.821 Test Loss: 0.425 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.4918622970581055
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.838 Test Loss: 0.416 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.0552098751068115
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.821 Test Loss: 0.419 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.576804876327515
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.827 Test Loss: 0.424 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.0034685134887695
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.827 Test Loss: 0.426 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.045351266860962
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.821 Test Loss: 0.424 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.0650551319122314
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.821 Test Loss: 0.423 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.723649978637695
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.821 Test Loss: 0.423 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.60195779800415
Epoch: 1, Steps: 17 | Train Loss: 1.923 Vali Loss: 1.696 Vali Acc: 0.335 Test Loss: 1.696 Test Acc: 0.335
Validation loss decreased (inf --> -0.335243).  Saving model ...
Epoch: 2 cost time: 6.3658037185668945
Epoch: 2, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.156 Vali Acc: 0.642 Test Loss: 1.156 Test Acc: 0.642
Validation loss decreased (-0.335243 --> -0.641607).  Saving model ...
Epoch: 3 cost time: 6.79385781288147
Epoch: 3, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.869 Vali Acc: 0.717 Test Loss: 0.869 Test Acc: 0.717
Validation loss decreased (-0.641607 --> -0.716754).  Saving model ...
Epoch: 4 cost time: 6.205964803695679
Epoch: 4, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.591 Vali Acc: 0.798 Test Loss: 0.591 Test Acc: 0.798
Validation loss decreased (-0.716754 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 6.126210927963257
Epoch: 5, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.520 Vali Acc: 0.832 Test Loss: 0.520 Test Acc: 0.832
Validation loss decreased (-0.797682 --> -0.832365).  Saving model ...
Epoch: 6 cost time: 6.21153712272644
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.439 Vali Acc: 0.838 Test Loss: 0.439 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 7 cost time: 6.4065842628479
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.481 Vali Acc: 0.815 Test Loss: 0.481 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.946416139602661
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.447 Vali Acc: 0.827 Test Loss: 0.447 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.3252294063568115
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
Validation loss decreased (-0.838146 --> -0.855487).  Saving model ...
Epoch: 10 cost time: 6.451211929321289
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.832 Test Loss: 0.420 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.917567253112793
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.472200393676758
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.921412706375122
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.844 Test Loss: 0.418 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.9178571701049805
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.838 Test Loss: 0.418 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.026936292648315
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.844 Test Loss: 0.415 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.412965774536133
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.838 Test Loss: 0.419 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.817057847976685
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.31806755065918
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.50164532661438
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.354975700378418
Epoch: 1, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.844 Vali Acc: 0.260 Test Loss: 1.844 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 5.964824438095093
Epoch: 2, Steps: 17 | Train Loss: 1.580 Vali Loss: 1.436 Vali Acc: 0.572 Test Loss: 1.436 Test Acc: 0.572
Validation loss decreased (-0.260097 --> -0.572240).  Saving model ...
Epoch: 3 cost time: 5.441396713256836
Epoch: 3, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.165 Vali Acc: 0.584 Test Loss: 1.165 Test Acc: 0.584
Validation loss decreased (-0.572240 --> -0.583803).  Saving model ...
Epoch: 4 cost time: 5.8252904415130615
Epoch: 4, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.820 Vali Acc: 0.728 Test Loss: 0.820 Test Acc: 0.728
Validation loss decreased (-0.583803 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 6.394531726837158
Epoch: 5, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.728316 --> -0.809242).  Saving model ...
Epoch: 6 cost time: 6.036245346069336
Epoch: 6, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 7 cost time: 6.170483589172363
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.565 Vali Acc: 0.769 Test Loss: 0.565 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.708395004272461
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.516 Vali Acc: 0.815 Test Loss: 0.516 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 9 cost time: 5.962646007537842
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.523 Vali Acc: 0.792 Test Loss: 0.523 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.406392335891724
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.496 Vali Acc: 0.832 Test Loss: 0.496 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 5.913310766220093
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.496 Vali Acc: 0.815 Test Loss: 0.496 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.616649389266968
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.832 Test Loss: 0.485 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 6.123731374740601
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 14 cost time: 6.292636394500732
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.432024002075195
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 16 cost time: 6.451263666152954
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.815 Test Loss: 0.473 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.216804265975952
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 18 cost time: 6.587646961212158
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.821 Test Loss: 0.468 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.480901718139648
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.855699062347412
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 21 cost time: 6.27379035949707
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.838 Test Loss: 0.456 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 22 cost time: 6.009653091430664
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.1516149044036865
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.832 Test Loss: 0.456 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.739585638046265
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.832 Test Loss: 0.455 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.49237322807312
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.832 Test Loss: 0.451 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.5854010581970215
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 27 cost time: 5.729146718978882
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.447 Vali Acc: 0.838 Test Loss: 0.447 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.5338194370269775
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.719123125076294
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.135912179946899
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.838 Test Loss: 0.444 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.103802680969238
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 32 cost time: 6.328018665313721
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.844 Test Loss: 0.443 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 33 cost time: 5.810322999954224
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.844 Test Loss: 0.440 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 34 cost time: 5.455946207046509
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.844 Test Loss: 0.438 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 35 cost time: 5.233919858932495
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.844 Test Loss: 0.437 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 36 cost time: 6.140793561935425
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 37 cost time: 6.557649850845337
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 38 cost time: 5.648496389389038
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.0644941329956055
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.6863720417022705
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.22283673286438
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 42 cost time: 5.849365234375
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 43 cost time: 5.911597728729248
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 44 cost time: 5.879166126251221
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.844 Test Loss: 0.430 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 45 cost time: 5.611013889312744
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.703831434249878
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.844 Test Loss: 0.432 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.875748872756958
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.844 Test Loss: 0.429 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 48 cost time: 6.209869146347046
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 49 cost time: 6.255220890045166
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 50 cost time: 6.404810428619385
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 51 cost time: 6.355456590652466
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.942005157470703
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.40043830871582
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.844 Test Loss: 0.426 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 5.692842721939087
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.844 Test Loss: 0.427 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 5.672017335891724
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 56 cost time: 5.807985544204712
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 57 cost time: 5.429490327835083
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 5.843212127685547
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 5.925478935241699
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 5.78370475769043
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 6.663567781448364
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 6.202138900756836
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 6.303679704666138
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 6.360802173614502
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 65 cost time: 5.792242527008057
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 66 cost time: 5.6597206592559814
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 67 cost time: 5.293760538101196
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 68 cost time: 6.126647233963013
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.844 Test Loss: 0.420 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 69 cost time: 6.191186428070068
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 70 cost time: 6.366554021835327
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 71 cost time: 6.426427364349365
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 6.585577487945557
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 6.138812303543091
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.844 Test Loss: 0.420 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 5.770567417144775
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.844 Test Loss: 0.420 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 5.75744891166687
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 5.805468559265137
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.844 Test Loss: 0.420 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 6.290372371673584
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.844 Test Loss: 0.420 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 6.3933799266815186
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 6.20121693611145
Epoch: 79, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 6.445409297943115
Epoch: 80, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.844 Test Loss: 0.420 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.073446273803711
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.875 Vali Acc: 0.191 Test Loss: 1.875 Test Acc: 0.191
Validation loss decreased (inf --> -0.190733).  Saving model ...
Epoch: 2 cost time: 5.676746129989624
Epoch: 2, Steps: 17 | Train Loss: 1.662 Vali Loss: 1.571 Vali Acc: 0.514 Test Loss: 1.571 Test Acc: 0.514
Validation loss decreased (-0.190733 --> -0.514435).  Saving model ...
Epoch: 3 cost time: 6.072504281997681
Epoch: 3, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.313 Vali Acc: 0.543 Test Loss: 1.313 Test Acc: 0.543
Validation loss decreased (-0.514435 --> -0.543339).  Saving model ...
Epoch: 4 cost time: 5.965096473693848
Epoch: 4, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.965 Vali Acc: 0.711 Test Loss: 0.965 Test Acc: 0.711
Validation loss decreased (-0.543339 --> -0.710973).  Saving model ...
Epoch: 5 cost time: 5.729864835739136
Epoch: 5, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.755 Vali Acc: 0.734 Test Loss: 0.755 Test Acc: 0.734
Validation loss decreased (-0.710973 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 5.354448080062866
Epoch: 6, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.674 Vali Acc: 0.740 Test Loss: 0.674 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739878).  Saving model ...
Epoch: 7 cost time: 5.62030816078186
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751439).  Saving model ...
Epoch: 8 cost time: 5.902544260025024
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 9 cost time: 5.858431100845337
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.578 Vali Acc: 0.798 Test Loss: 0.578 Test Acc: 0.798
Validation loss decreased (-0.757219 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 5.9653000831604
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.567 Vali Acc: 0.792 Test Loss: 0.567 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.226524591445923
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.143404960632324
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 6.100356578826904
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.798 Test Loss: 0.546 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.804514169692993
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 5.91243839263916
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.049127578735352
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 17 cost time: 5.923217535018921
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.564612150192261
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.051672697067261
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.862346410751343
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.40313720703125
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.2454564571380615
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.36791467666626
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 24 cost time: 5.818365573883057
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 25 cost time: 6.16451358795166
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 26 cost time: 6.433605670928955
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 27 cost time: 6.418701171875
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.688215255737305
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 29 cost time: 6.044342994689941
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.8666136264801025
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 31 cost time: 5.434670686721802
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 32 cost time: 5.858048915863037
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.866258144378662
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.790149688720703
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.792 Test Loss: 0.521 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.9651854038238525
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.949979305267334
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.821 Test Loss: 0.510 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 37 cost time: 5.540895700454712
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.821 Test Loss: 0.506 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 38 cost time: 5.715932130813599
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.815 Test Loss: 0.508 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.407397508621216
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.101219654083252
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.924545526504517
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.464501619338989
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 6.105282545089722
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.130958557128906
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.792 Test Loss: 0.505 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 5.961536645889282
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.792 Test Loss: 0.509 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 5.607356071472168
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 5.739647388458252
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.21330714225769
Epoch: 1, Steps: 17 | Train Loss: 2.028 Vali Loss: 1.926 Vali Acc: 0.197 Test Loss: 1.926 Test Acc: 0.197
Validation loss decreased (inf --> -0.196513).  Saving model ...
Epoch: 2 cost time: 6.60191535949707
Epoch: 2, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.692 Vali Acc: 0.382 Test Loss: 1.692 Test Acc: 0.382
Validation loss decreased (-0.196513 --> -0.381486).  Saving model ...
Epoch: 3 cost time: 6.855793714523315
Epoch: 3, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.452 Vali Acc: 0.572 Test Loss: 1.452 Test Acc: 0.572
Validation loss decreased (-0.381486 --> -0.572240).  Saving model ...
Epoch: 4 cost time: 6.4127044677734375
Epoch: 4, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.144 Vali Acc: 0.618 Test Loss: 1.144 Test Acc: 0.618
Validation loss decreased (-0.572240 --> -0.618486).  Saving model ...
Epoch: 5 cost time: 6.210596561431885
Epoch: 5, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.007 Vali Acc: 0.636 Test Loss: 1.007 Test Acc: 0.636
Validation loss decreased (-0.618486 --> -0.635828).  Saving model ...
Epoch: 6 cost time: 6.224419593811035
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.785 Vali Acc: 0.671 Test Loss: 0.785 Test Acc: 0.671
Validation loss decreased (-0.635828 --> -0.670512).  Saving model ...
Epoch: 7 cost time: 6.041736364364624
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.664 Vali Acc: 0.705 Test Loss: 0.664 Test Acc: 0.705
Validation loss decreased (-0.670512 --> -0.705196).  Saving model ...
Epoch: 8 cost time: 5.917372465133667
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.676 Vali Acc: 0.688 Test Loss: 0.676 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.007901430130005
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.769 Test Loss: 0.585 Test Acc: 0.769
Validation loss decreased (-0.705196 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 6.509181022644043
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.723 Test Loss: 0.604 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.940162181854248
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.600 Vali Acc: 0.723 Test Loss: 0.600 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.813096523284912
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.578 Vali Acc: 0.751 Test Loss: 0.578 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.265077352523804
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.033998012542725
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.13931131362915
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774561).  Saving model ...
Epoch: 16 cost time: 6.029601097106934
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.786743879318237
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.8107805252075195
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.8298821449279785
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.775 Test Loss: 0.555 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.177692890167236
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.769 Test Loss: 0.542 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.226905822753906
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.769 Test Loss: 0.557 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.49978232383728
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.780 Test Loss: 0.535 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 23 cost time: 6.404491662979126
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.780 Test Loss: 0.537 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.248986482620239
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.2174599170684814
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.780 Test Loss: 0.537 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.313568353652954
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791902).  Saving model ...
Epoch: 27 cost time: 6.5067033767700195
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.786 Test Loss: 0.534 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.738773822784424
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.775 Test Loss: 0.527 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.799055337905884
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.025280237197876
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.769 Test Loss: 0.538 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.906411170959473
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.957876443862915
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.5847461223602295
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.775 Test Loss: 0.525 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.729774713516235
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.775 Test Loss: 0.527 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.785076379776001
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.859851360321045
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.000168085098267
Epoch: 1, Steps: 17 | Train Loss: 2.024 Vali Loss: 1.921 Vali Acc: 0.185 Test Loss: 1.921 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 5.86955714225769
Epoch: 2, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.703 Vali Acc: 0.387 Test Loss: 1.703 Test Acc: 0.387
Validation loss decreased (-0.184952 --> -0.387266).  Saving model ...
Epoch: 3 cost time: 6.3619561195373535
Epoch: 3, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.466 Vali Acc: 0.526 Test Loss: 1.466 Test Acc: 0.526
Validation loss decreased (-0.387266 --> -0.525997).  Saving model ...
Epoch: 4 cost time: 6.7935333251953125
Epoch: 4, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.177 Vali Acc: 0.665 Test Loss: 1.177 Test Acc: 0.665
Validation loss decreased (-0.525997 --> -0.664728).  Saving model ...
Epoch: 5 cost time: 5.822364330291748
Epoch: 5, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.989 Vali Acc: 0.636 Test Loss: 0.989 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.280977249145508
Epoch: 6, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.781 Vali Acc: 0.699 Test Loss: 0.781 Test Acc: 0.699
Validation loss decreased (-0.664728 --> -0.699414).  Saving model ...
Epoch: 7 cost time: 5.991352319717407
Epoch: 7, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.661 Vali Acc: 0.734 Test Loss: 0.661 Test Acc: 0.734
Validation loss decreased (-0.699414 --> -0.734097).  Saving model ...
Epoch: 8 cost time: 5.714087963104248
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.603 Vali Acc: 0.780 Test Loss: 0.603 Test Acc: 0.780
Validation loss decreased (-0.734097 --> -0.780341).  Saving model ...
Epoch: 9 cost time: 6.233154296875
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.603 Vali Acc: 0.757 Test Loss: 0.603 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.371761083602905
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.549277305603027
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.780 Test Loss: 0.598 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 5.363964080810547
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.574 Vali Acc: 0.775 Test Loss: 0.574 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.269917964935303
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.786 Test Loss: 0.565 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 14 cost time: 5.444600343704224
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
Validation loss decreased (-0.786122 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 5.871731758117676
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.4854736328125
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.378806829452515
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.815 Test Loss: 0.546 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 18 cost time: 6.049183368682861
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.031796455383301
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.815 Test Loss: 0.543 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 20 cost time: 5.666754961013794
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.798 Test Loss: 0.541 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.607812881469727
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.106510162353516
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.798 Test Loss: 0.531 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.182398319244385
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.482686758041382
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.898223876953125
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.843717098236084
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.780 Test Loss: 0.534 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.749966621398926
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.792 Test Loss: 0.527 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.7188684940338135
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.792 Test Loss: 0.506 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.681230068206787
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.5144476890563965
Epoch: 1, Steps: 17 | Train Loss: 1.987 Vali Loss: 1.889 Vali Acc: 0.295 Test Loss: 1.889 Test Acc: 0.295
Validation loss decreased (inf --> -0.294779).  Saving model ...
Epoch: 2 cost time: 5.579915285110474
Epoch: 2, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.668 Vali Acc: 0.457 Test Loss: 1.668 Test Acc: 0.457
Validation loss decreased (-0.294779 --> -0.456631).  Saving model ...
Epoch: 3 cost time: 6.309335470199585
Epoch: 3, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.431 Vali Acc: 0.561 Test Loss: 1.431 Test Acc: 0.561
Validation loss decreased (-0.456631 --> -0.560679).  Saving model ...
Epoch: 4 cost time: 5.943348169326782
Epoch: 4, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.143 Vali Acc: 0.659 Test Loss: 1.143 Test Acc: 0.659
Validation loss decreased (-0.560679 --> -0.658948).  Saving model ...
Epoch: 5 cost time: 5.767236232757568
Epoch: 5, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.953 Vali Acc: 0.682 Test Loss: 0.953 Test Acc: 0.682
Validation loss decreased (-0.658948 --> -0.682071).  Saving model ...
Epoch: 6 cost time: 5.431424379348755
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.744 Vali Acc: 0.699 Test Loss: 0.744 Test Acc: 0.699
Validation loss decreased (-0.682071 --> -0.699415).  Saving model ...
Epoch: 7 cost time: 5.876980304718018
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.657 Vali Acc: 0.688 Test Loss: 0.657 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.710821866989136
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.612 Vali Acc: 0.746 Test Loss: 0.612 Test Acc: 0.746
Validation loss decreased (-0.699415 --> -0.745659).  Saving model ...
Epoch: 9 cost time: 5.880342721939087
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
Validation loss decreased (-0.745659 --> -0.745659).  Saving model ...
Epoch: 10 cost time: 6.394012212753296
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
Validation loss decreased (-0.745659 --> -0.757220).  Saving model ...
Epoch: 11 cost time: 6.4062089920043945
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.571 Vali Acc: 0.757 Test Loss: 0.571 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 12 cost time: 5.795665979385376
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.540 Vali Acc: 0.775 Test Loss: 0.540 Test Acc: 0.775
Validation loss decreased (-0.757220 --> -0.774561).  Saving model ...
Epoch: 13 cost time: 5.479595422744751
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.769 Test Loss: 0.555 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.709998607635498
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.27494478225708
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.769 Test Loss: 0.534 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.387106657028198
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.786 Test Loss: 0.526 Test Acc: 0.786
Validation loss decreased (-0.774561 --> -0.786122).  Saving model ...
Epoch: 17 cost time: 5.861783266067505
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.236114740371704
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 19 cost time: 6.010946750640869
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.792 Test Loss: 0.521 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 20 cost time: 5.842576026916504
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.780 Test Loss: 0.522 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.552659511566162
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.792 Test Loss: 0.508 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 22 cost time: 5.841124773025513
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809243).  Saving model ...
Epoch: 23 cost time: 5.621728420257568
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.688552618026733
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.052431344985962
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.56570291519165
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.769 Test Loss: 0.512 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.709989309310913
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.780 Test Loss: 0.503 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.653886795043945
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838145).  Saving model ...
Epoch: 29 cost time: 5.810970067977905
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.92483377456665
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.046091794967651
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.133949279785156
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.963133335113525
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.821 Test Loss: 0.483 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.945836782455444
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.460687875747681
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.815 Test Loss: 0.484 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 5.617972373962402
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 5.585274934768677
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.832 Test Loss: 0.478 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.5491228103637695
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.832 Test Loss: 0.470 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.104256629943848
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
Validation loss decreased (inf --> -0.150270).  Saving model ...
Epoch: 2 cost time: 6.501227855682373
Epoch: 2, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.223206043243408
Epoch: 3, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.27452540397644
Epoch: 4, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.0378499031066895
Epoch: 5, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.308971166610718
Epoch: 6, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.215181112289429
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.772843360900879
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.892315864562988
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.83324670791626
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.239095211029053
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15028901734104047
model parameter : 1553671
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.973181247711182
Epoch: 1, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.467 Vali Acc: 0.335 Test Loss: 1.467 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 5.9548845291137695
Epoch: 2, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.100 Vali Acc: 0.566 Test Loss: 1.100 Test Acc: 0.566
Validation loss decreased (-0.335245 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 6.062995195388794
Epoch: 3, Steps: 17 | Train Loss: 0.790 Vali Loss: 0.920 Vali Acc: 0.705 Test Loss: 0.920 Test Acc: 0.705
Validation loss decreased (-0.566463 --> -0.705193).  Saving model ...
Epoch: 4 cost time: 6.1212029457092285
Epoch: 4, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.733 Vali Acc: 0.740 Test Loss: 0.733 Test Acc: 0.740
Validation loss decreased (-0.705193 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 5.870684862136841
Epoch: 5, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.687 Vali Acc: 0.682 Test Loss: 0.687 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.020618915557861
Epoch: 6, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.541 Vali Acc: 0.798 Test Loss: 0.541 Test Acc: 0.798
Validation loss decreased (-0.739877 --> -0.797682).  Saving model ...
Epoch: 7 cost time: 5.95304012298584
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
Validation loss decreased (-0.797682 --> -0.815024).  Saving model ...
Epoch: 8 cost time: 6.608572721481323
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.509959697723389
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.319275140762329
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.821 Test Loss: 0.465 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820805).  Saving model ...
Epoch: 11 cost time: 6.058006286621094
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.786 Test Loss: 0.458 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.877396106719971
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.798 Test Loss: 0.469 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.45497727394104
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.786 Test Loss: 0.479 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.848702430725098
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.786 Test Loss: 0.475 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.9705586433410645
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.780 Test Loss: 0.490 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.9716715812683105
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.775 Test Loss: 0.495 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.615428924560547
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.780 Test Loss: 0.493 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.321037769317627
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.780 Test Loss: 0.494 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.041568040847778
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.786 Test Loss: 0.498 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.9012980461120605
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.780 Test Loss: 0.496 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.903703451156616
Epoch: 1, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.488 Vali Acc: 0.341 Test Loss: 1.488 Test Acc: 0.341
Validation loss decreased (inf --> -0.341026).  Saving model ...
Epoch: 2 cost time: 5.954200029373169
Epoch: 2, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.097 Vali Acc: 0.555 Test Loss: 1.097 Test Acc: 0.555
Validation loss decreased (-0.341026 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 6.24233078956604
Epoch: 3, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.870 Vali Acc: 0.740 Test Loss: 0.870 Test Acc: 0.740
Validation loss decreased (-0.554902 --> -0.739876).  Saving model ...
Epoch: 4 cost time: 5.397323846817017
Epoch: 4, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
Validation loss decreased (-0.739876 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 5.337687730789185
Epoch: 5, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.621 Vali Acc: 0.723 Test Loss: 0.621 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.414794445037842
Epoch: 6, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
Validation loss decreased (-0.762999 --> -0.763001).  Saving model ...
Epoch: 7 cost time: 5.892393112182617
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.421 Vali Acc: 0.832 Test Loss: 0.421 Test Acc: 0.832
Validation loss decreased (-0.763001 --> -0.832366).  Saving model ...
Epoch: 8 cost time: 5.9312050342559814
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.422 Vali Acc: 0.827 Test Loss: 0.422 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.223499774932861
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.438 Vali Acc: 0.821 Test Loss: 0.438 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.280368328094482
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.425 Vali Acc: 0.815 Test Loss: 0.425 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.605786085128784
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.078402996063232
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.821 Test Loss: 0.442 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.5604987144470215
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.813770771026611
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.821 Test Loss: 0.450 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.535414934158325
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.382529258728027
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.815 Test Loss: 0.462 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.58789849281311
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.90820837020874
Epoch: 1, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.519 Vali Acc: 0.410 Test Loss: 1.519 Test Acc: 0.410
Validation loss decreased (inf --> -0.410389).  Saving model ...
Epoch: 2 cost time: 6.13581109046936
Epoch: 2, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.086 Vali Acc: 0.636 Test Loss: 1.086 Test Acc: 0.636
Validation loss decreased (-0.410389 --> -0.635827).  Saving model ...
Epoch: 3 cost time: 5.739465713500977
Epoch: 3, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.833 Vali Acc: 0.728 Test Loss: 0.833 Test Acc: 0.728
Validation loss decreased (-0.635827 --> -0.728315).  Saving model ...
Epoch: 4 cost time: 6.235779762268066
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.678 Vali Acc: 0.757 Test Loss: 0.678 Test Acc: 0.757
Validation loss decreased (-0.728315 --> -0.757219).  Saving model ...
Epoch: 5 cost time: 6.104945182800293
Epoch: 5, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.622 Vali Acc: 0.717 Test Loss: 0.622 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.467281341552734
Epoch: 6, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.503 Vali Acc: 0.786 Test Loss: 0.503 Test Acc: 0.786
Validation loss decreased (-0.757219 --> -0.786122).  Saving model ...
Epoch: 7 cost time: 5.420497179031372
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
Validation loss decreased (-0.786122 --> -0.843926).  Saving model ...
Epoch: 8 cost time: 5.275232553482056
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.838 Test Loss: 0.446 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.546659469604492
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.809 Test Loss: 0.433 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.732487440109253
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.827 Test Loss: 0.424 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.897939205169678
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.429 Vali Acc: 0.827 Test Loss: 0.429 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.692991733551025
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.821 Test Loss: 0.428 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.595978736877441
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.827 Test Loss: 0.432 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.604748249053955
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.821 Test Loss: 0.428 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.978705406188965
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.827 Test Loss: 0.435 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.954991817474365
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.821 Test Loss: 0.433 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.2680909633636475
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.821 Test Loss: 0.435 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.958980560302734
Epoch: 1, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.716 Vali Acc: 0.312 Test Loss: 1.716 Test Acc: 0.312
Validation loss decreased (inf --> -0.312122).  Saving model ...
Epoch: 2 cost time: 5.925818920135498
Epoch: 2, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.249 Vali Acc: 0.566 Test Loss: 1.249 Test Acc: 0.566
Validation loss decreased (-0.312122 --> -0.566462).  Saving model ...
Epoch: 3 cost time: 5.749087810516357
Epoch: 3, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.872 Vali Acc: 0.734 Test Loss: 0.872 Test Acc: 0.734
Validation loss decreased (-0.566462 --> -0.734095).  Saving model ...
Epoch: 4 cost time: 5.613194942474365
Epoch: 4, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.683 Vali Acc: 0.792 Test Loss: 0.683 Test Acc: 0.792
Validation loss decreased (-0.734095 --> -0.791901).  Saving model ...
Epoch: 5 cost time: 5.7147016525268555
Epoch: 5, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.682 Vali Acc: 0.694 Test Loss: 0.682 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.711071491241455
Epoch: 6, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.564 Vali Acc: 0.711 Test Loss: 0.564 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.505121231079102
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.450 Vali Acc: 0.803 Test Loss: 0.450 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803464).  Saving model ...
Epoch: 8 cost time: 6.486061334609985
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.462 Vali Acc: 0.821 Test Loss: 0.462 Test Acc: 0.821
Validation loss decreased (-0.803464 --> -0.820805).  Saving model ...
Epoch: 9 cost time: 5.740726947784424
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.780 Test Loss: 0.461 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.662724018096924
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.780 Test Loss: 0.450 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.323454141616821
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.798 Test Loss: 0.456 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.864798307418823
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.798 Test Loss: 0.454 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.11051344871521
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.803 Test Loss: 0.459 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.348526954650879
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.803 Test Loss: 0.453 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.894775867462158
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.792 Test Loss: 0.455 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.954571962356567
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.700452089309692
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.792 Test Loss: 0.457 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.019412517547607
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.308182716369629
Epoch: 1, Steps: 17 | Train Loss: 1.944 Vali Loss: 1.819 Vali Acc: 0.295 Test Loss: 1.819 Test Acc: 0.295
Validation loss decreased (inf --> -0.294779).  Saving model ...
Epoch: 2 cost time: 5.231155157089233
Epoch: 2, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.480 Vali Acc: 0.491 Test Loss: 1.480 Test Acc: 0.491
Validation loss decreased (-0.294779 --> -0.491315).  Saving model ...
Epoch: 3 cost time: 5.363706111907959
Epoch: 3, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.089 Vali Acc: 0.688 Test Loss: 1.089 Test Acc: 0.688
Validation loss decreased (-0.491315 --> -0.687850).  Saving model ...
Epoch: 4 cost time: 6.000692367553711
Epoch: 4, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.820 Vali Acc: 0.717 Test Loss: 0.820 Test Acc: 0.717
Validation loss decreased (-0.687850 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 6.1950929164886475
Epoch: 5, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.814 Vali Acc: 0.682 Test Loss: 0.814 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.586048364639282
Epoch: 6, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.741 Vali Acc: 0.647 Test Loss: 0.741 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.4919819831848145
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
Validation loss decreased (-0.716755 --> -0.849706).  Saving model ...
Epoch: 8 cost time: 5.758840799331665
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.535 Vali Acc: 0.780 Test Loss: 0.535 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.211073637008667
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.486 Vali Acc: 0.827 Test Loss: 0.486 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.159991502761841
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.950138092041016
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.478 Vali Acc: 0.815 Test Loss: 0.478 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.375272274017334
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.2778239250183105
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.827 Test Loss: 0.464 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.360538721084595
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.827 Test Loss: 0.461 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.69408106803894
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.91071629524231
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.832 Test Loss: 0.452 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.060551643371582
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.837080001831055
Epoch: 1, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.876 Vali Acc: 0.272 Test Loss: 1.876 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 6.5010058879852295
Epoch: 2, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.594 Vali Acc: 0.509 Test Loss: 1.594 Test Acc: 0.509
Validation loss decreased (-0.271658 --> -0.508655).  Saving model ...
Epoch: 3 cost time: 6.4675133228302
Epoch: 3, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.259 Vali Acc: 0.607 Test Loss: 1.259 Test Acc: 0.607
Validation loss decreased (-0.508655 --> -0.606924).  Saving model ...
Epoch: 4 cost time: 5.653931617736816
Epoch: 4, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.978 Vali Acc: 0.647 Test Loss: 0.978 Test Acc: 0.647
Validation loss decreased (-0.606924 --> -0.647389).  Saving model ...
Epoch: 5 cost time: 5.49037766456604
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.906 Vali Acc: 0.618 Test Loss: 0.906 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.581545114517212
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.744 Vali Acc: 0.630 Test Loss: 0.744 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.5155723094940186
Epoch: 7, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.637 Vali Acc: 0.734 Test Loss: 0.637 Test Acc: 0.734
Validation loss decreased (-0.647389 --> -0.734098).  Saving model ...
Epoch: 8 cost time: 5.4055399894714355
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
Validation loss decreased (-0.734098 --> -0.745659).  Saving model ...
Epoch: 9 cost time: 5.627224445343018
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.577 Vali Acc: 0.775 Test Loss: 0.577 Test Acc: 0.775
Validation loss decreased (-0.745659 --> -0.774561).  Saving model ...
Epoch: 10 cost time: 6.350429534912109
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.575 Vali Acc: 0.769 Test Loss: 0.575 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.039130449295044
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.574 Vali Acc: 0.775 Test Loss: 0.574 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 12 cost time: 6.2885048389434814
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
Validation loss decreased (-0.774561 --> -0.797682).  Saving model ...
Epoch: 13 cost time: 6.019399404525757
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.786 Test Loss: 0.564 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.557445287704468
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.815 Test Loss: 0.552 Test Acc: 0.815
Validation loss decreased (-0.797682 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 5.968842506408691
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.973617792129517
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.752506256103516
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.821 Test Loss: 0.553 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820804).  Saving model ...
Epoch: 18 cost time: 5.440219402313232
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.550 Vali Acc: 0.827 Test Loss: 0.550 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 19 cost time: 5.398004770278931
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.798 Test Loss: 0.548 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.341078996658325
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.798 Test Loss: 0.546 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.341779470443726
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.809021711349487
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.780 Test Loss: 0.545 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.09005069732666
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.915093421936035
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.345978498458862
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.798 Test Loss: 0.540 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.485406160354614
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.786 Test Loss: 0.538 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.492066860198975
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.827 Test Loss: 0.535 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 28 cost time: 5.754507780075073
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.931464910507202
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 6.138375520706177
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.792 Test Loss: 0.535 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.464012145996094
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.780 Test Loss: 0.534 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.972900629043579
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.60532283782959
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.798 Test Loss: 0.534 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.852402210235596
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.115625619888306
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.194419860839844
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 5.9256908893585205
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.17341661453247
Epoch: 1, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.935 Vali Acc: 0.162 Test Loss: 1.935 Test Acc: 0.162
Validation loss decreased (inf --> -0.161830).  Saving model ...
Epoch: 2 cost time: 6.664919137954712
Epoch: 2, Steps: 17 | Train Loss: 1.678 Vali Loss: 1.713 Vali Acc: 0.439 Test Loss: 1.713 Test Acc: 0.439
Validation loss decreased (-0.161830 --> -0.439289).  Saving model ...
Epoch: 3 cost time: 5.5379369258880615
Epoch: 3, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.404 Vali Acc: 0.607 Test Loss: 1.404 Test Acc: 0.607
Validation loss decreased (-0.439289 --> -0.606922).  Saving model ...
Epoch: 4 cost time: 5.58912205696106
Epoch: 4, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.160 Vali Acc: 0.566 Test Loss: 1.160 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.573612213134766
Epoch: 5, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.057 Vali Acc: 0.590 Test Loss: 1.057 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.935303211212158
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.812 Vali Acc: 0.618 Test Loss: 0.812 Test Acc: 0.618
Validation loss decreased (-0.606922 --> -0.618489).  Saving model ...
Epoch: 7 cost time: 5.843345403671265
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.703 Vali Acc: 0.665 Test Loss: 0.703 Test Acc: 0.665
Validation loss decreased (-0.618489 --> -0.664733).  Saving model ...
Epoch: 8 cost time: 5.184837818145752
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.707 Vali Acc: 0.647 Test Loss: 0.707 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.206368684768677
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.654 Vali Acc: 0.676 Test Loss: 0.654 Test Acc: 0.676
Validation loss decreased (-0.664733 --> -0.676294).  Saving model ...
Epoch: 10 cost time: 6.086228132247925
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.688 Test Loss: 0.655 Test Acc: 0.688
Validation loss decreased (-0.676294 --> -0.687855).  Saving model ...
Epoch: 11 cost time: 6.295851469039917
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.688 Test Loss: 0.658 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.90473484992981
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.650 Vali Acc: 0.682 Test Loss: 0.650 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.482210636138916
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.676 Test Loss: 0.655 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.6811535358428955
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.699 Test Loss: 0.625 Test Acc: 0.699
Validation loss decreased (-0.687855 --> -0.699416).  Saving model ...
Epoch: 15 cost time: 6.111478567123413
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.694 Test Loss: 0.640 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.100647926330566
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.682 Test Loss: 0.629 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.366173982620239
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.717 Test Loss: 0.622 Test Acc: 0.717
Validation loss decreased (-0.699416 --> -0.716757).  Saving model ...
Epoch: 18 cost time: 5.2429420948028564
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.705 Test Loss: 0.642 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.376230716705322
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.694 Test Loss: 0.638 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.891601800918579
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.723 Test Loss: 0.615 Test Acc: 0.723
Validation loss decreased (-0.716757 --> -0.722537).  Saving model ...
Epoch: 21 cost time: 6.090637445449829
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.52690052986145
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.756676197052002
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.723 Test Loss: 0.614 Test Acc: 0.723
Validation loss decreased (-0.722537 --> -0.722537).  Saving model ...
Epoch: 24 cost time: 5.681818962097168
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.343576669692993
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.728 Test Loss: 0.610 Test Acc: 0.728
Validation loss decreased (-0.722537 --> -0.728318).  Saving model ...
Epoch: 26 cost time: 6.393183469772339
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.711 Test Loss: 0.614 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.627069711685181
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.734 Test Loss: 0.612 Test Acc: 0.734
Validation loss decreased (-0.728318 --> -0.734098).  Saving model ...
Epoch: 28 cost time: 5.446733236312866
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.734 Test Loss: 0.606 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 29 cost time: 5.27499794960022
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.757 Test Loss: 0.592 Test Acc: 0.757
Validation loss decreased (-0.734098 --> -0.757220).  Saving model ...
Epoch: 30 cost time: 5.915177345275879
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.887390613555908
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.578125238418579
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.740 Test Loss: 0.612 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.455519676208496
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.728 Test Loss: 0.606 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.7547242641448975
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.983125448226929
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.746 Test Loss: 0.598 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.8992698192596436
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.798523664474487
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 38 cost time: 5.729748010635376
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.457113027572632
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.751 Test Loss: 0.588 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.20555853843689
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.597903251647949
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 5.694381952285767
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 6.37984299659729
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.786 Test Loss: 0.570 Test Acc: 0.786
Validation loss decreased (-0.757220 --> -0.786121).  Saving model ...
Epoch: 44 cost time: 5.7344841957092285
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.775 Test Loss: 0.572 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.855094909667969
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.3997581005096436
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 6.126337051391602
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.780 Test Loss: 0.574 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 5.721130132675171
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.769 Test Loss: 0.579 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 5.737513303756714
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.780 Test Loss: 0.584 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 6.331188917160034
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.769 Test Loss: 0.580 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 6.324428081512451
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.780 Test Loss: 0.576 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 5.319589614868164
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 5.523433446884155
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 54 cost time: 6.098324537277222
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.792 Test Loss: 0.567 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 55 cost time: 6.34846568107605
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.786 Test Loss: 0.564 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.181888103485107
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.780 Test Loss: 0.571 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.160812616348267
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.780 Test Loss: 0.573 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.163748025894165
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.780 Test Loss: 0.569 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 6.356634855270386
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.780 Test Loss: 0.575 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 6.265486240386963
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.792 Test Loss: 0.569 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 5.925901889801025
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.780 Test Loss: 0.569 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 6.0441083908081055
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 6.270466566085815
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.780 Test Loss: 0.557 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 5.915541410446167
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.780 Test Loss: 0.560 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.310633659362793
Epoch: 1, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.977 Vali Acc: 0.214 Test Loss: 1.977 Test Acc: 0.214
Validation loss decreased (inf --> -0.213853).  Saving model ...
Epoch: 2 cost time: 6.259010314941406
Epoch: 2, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.754 Vali Acc: 0.405 Test Loss: 1.754 Test Acc: 0.405
Validation loss decreased (-0.213853 --> -0.404607).  Saving model ...
Epoch: 3 cost time: 5.934818506240845
Epoch: 3, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.465 Vali Acc: 0.532 Test Loss: 1.465 Test Acc: 0.532
Validation loss decreased (-0.404607 --> -0.531777).  Saving model ...
Epoch: 4 cost time: 5.748387575149536
Epoch: 4, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.218 Vali Acc: 0.595 Test Loss: 1.218 Test Acc: 0.595
Validation loss decreased (-0.531777 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 6.2789695262908936
Epoch: 5, Steps: 17 | Train Loss: 0.677 Vali Loss: 1.065 Vali Acc: 0.601 Test Loss: 1.065 Test Acc: 0.601
Validation loss decreased (-0.595364 --> -0.601145).  Saving model ...
Epoch: 6 cost time: 6.311893701553345
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.836 Vali Acc: 0.665 Test Loss: 0.836 Test Acc: 0.665
Validation loss decreased (-0.601145 --> -0.664732).  Saving model ...
Epoch: 7 cost time: 5.365865707397461
Epoch: 7, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
Validation loss decreased (-0.664732 --> -0.716756).  Saving model ...
Epoch: 8 cost time: 5.436274290084839
Epoch: 8, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
Validation loss decreased (-0.716756 --> -0.716757).  Saving model ...
Epoch: 9 cost time: 5.77473783493042
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.633 Vali Acc: 0.734 Test Loss: 0.633 Test Acc: 0.734
Validation loss decreased (-0.716757 --> -0.734098).  Saving model ...
Epoch: 10 cost time: 6.282308340072632
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.616 Vali Acc: 0.740 Test Loss: 0.616 Test Acc: 0.740
Validation loss decreased (-0.734098 --> -0.739878).  Saving model ...
Epoch: 11 cost time: 5.889604091644287
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.610 Vali Acc: 0.740 Test Loss: 0.610 Test Acc: 0.740
Validation loss decreased (-0.739878 --> -0.739878).  Saving model ...
Epoch: 12 cost time: 5.394461154937744
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
Validation loss decreased (-0.739878 --> -0.745659).  Saving model ...
Epoch: 13 cost time: 5.974472522735596
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.0902159214019775
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
Validation loss decreased (-0.745659 --> -0.774561).  Saving model ...
Epoch: 15 cost time: 5.990403890609741
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.751 Test Loss: 0.585 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.595089912414551
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.792 Test Loss: 0.559 Test Acc: 0.792
Validation loss decreased (-0.774561 --> -0.791902).  Saving model ...
Epoch: 17 cost time: 5.645821571350098
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.315824747085571
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.792 Test Loss: 0.555 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 19 cost time: 5.7930707931518555
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.775 Test Loss: 0.545 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.494548320770264
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.769 Test Loss: 0.542 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.374419689178467
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.780 Test Loss: 0.546 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.084549427032471
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.769 Test Loss: 0.550 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.262338876724243
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.769 Test Loss: 0.541 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.150834560394287
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.780 Test Loss: 0.528 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.502297639846802
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.786 Test Loss: 0.522 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.088641881942749
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.769 Test Loss: 0.534 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.616422176361084
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.775 Test Loss: 0.531 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.171696186065674
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.769 Test Loss: 0.520 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.064112424850464
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.991 Vali Acc: 0.179 Test Loss: 1.991 Test Acc: 0.179
Validation loss decreased (inf --> -0.179171).  Saving model ...
Epoch: 2 cost time: 6.108007431030273
Epoch: 2, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.765 Vali Acc: 0.364 Test Loss: 1.765 Test Acc: 0.364
Validation loss decreased (-0.179171 --> -0.364144).  Saving model ...
Epoch: 3 cost time: 5.59579610824585
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.472 Vali Acc: 0.584 Test Loss: 1.472 Test Acc: 0.584
Validation loss decreased (-0.364144 --> -0.583800).  Saving model ...
Epoch: 4 cost time: 5.159297943115234
Epoch: 4, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.227 Vali Acc: 0.584 Test Loss: 1.227 Test Acc: 0.584
Validation loss decreased (-0.583800 --> -0.583803).  Saving model ...
Epoch: 5 cost time: 5.889416456222534
Epoch: 5, Steps: 17 | Train Loss: 0.672 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
Validation loss decreased (-0.583803 --> -0.595365).  Saving model ...
Epoch: 6 cost time: 5.636263132095337
Epoch: 6, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.820 Vali Acc: 0.653 Test Loss: 0.820 Test Acc: 0.653
Validation loss decreased (-0.595365 --> -0.653171).  Saving model ...
Epoch: 7 cost time: 6.188997983932495
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.666 Vali Acc: 0.723 Test Loss: 0.666 Test Acc: 0.723
Validation loss decreased (-0.653171 --> -0.722537).  Saving model ...
Epoch: 8 cost time: 6.037362337112427
Epoch: 8, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.637 Vali Acc: 0.751 Test Loss: 0.637 Test Acc: 0.751
Validation loss decreased (-0.722537 --> -0.751439).  Saving model ...
Epoch: 9 cost time: 6.507183074951172
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.605 Vali Acc: 0.740 Test Loss: 0.605 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.833677768707275
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.592 Vali Acc: 0.792 Test Loss: 0.592 Test Acc: 0.792
Validation loss decreased (-0.751439 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 5.666984796524048
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.565730094909668
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.555 Vali Acc: 0.780 Test Loss: 0.555 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.176413297653198
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.490647315979004
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.127288579940796
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.780 Test Loss: 0.550 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.30491304397583
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.792 Test Loss: 0.535 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 17 cost time: 5.375694513320923
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.792 Test Loss: 0.532 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 18 cost time: 5.882985591888428
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 19 cost time: 6.211455821990967
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 20 cost time: 6.101547956466675
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.798 Test Loss: 0.520 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.915101766586304
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.406187534332275
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.775 Test Loss: 0.519 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.528872013092041
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.73127555847168
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.786 Test Loss: 0.505 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.494116306304932
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.488816022872925
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.792 Test Loss: 0.514 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.722238779067993
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.786 Test Loss: 0.501 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.155835151672363
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.786 Test Loss: 0.494 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.743156671524048
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809244).  Saving model ...
Epoch: 30 cost time: 6.882408857345581
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.057462930679321
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.786 Test Loss: 0.505 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.414318323135376
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.495 Vali Acc: 0.786 Test Loss: 0.495 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.792182683944702
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 34 cost time: 6.9805052280426025
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.798 Test Loss: 0.486 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.1404500007629395
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.798 Test Loss: 0.483 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.506918668746948
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.798 Test Loss: 0.473 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.53558874130249
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.798 Test Loss: 0.473 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 5.9701056480407715
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 39 cost time: 7.04876184463501
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.488 Vali Acc: 0.821 Test Loss: 0.488 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820804).  Saving model ...
Epoch: 40 cost time: 6.751917839050293
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.821 Test Loss: 0.484 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 41 cost time: 6.223327875137329
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.629051208496094
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820805).  Saving model ...
Epoch: 43 cost time: 6.949488639831543
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.4510486125946045
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.815 Test Loss: 0.473 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.216996908187866
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.801015138626099
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 6.08136248588562
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.815 Test Loss: 0.481 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 5.539442300796509
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
Validation loss decreased (-0.820805 --> -0.832365).  Saving model ...
Epoch: 49 cost time: 6.687655687332153
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.832 Test Loss: 0.481 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 6.5008392333984375
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.485 Vali Acc: 0.832 Test Loss: 0.485 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 6.291327476501465
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.832 Test Loss: 0.484 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 7.1634840965271
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.832 Test Loss: 0.481 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 6.963805198669434
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.832 Test Loss: 0.476 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 54 cost time: 6.618290901184082
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 55 cost time: 6.23465371131897
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 56 cost time: 7.246390104293823
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.832 Test Loss: 0.473 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 57 cost time: 7.044614791870117
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.832 Test Loss: 0.473 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 58 cost time: 6.0189597606658936
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 59 cost time: 6.489206552505493
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 6.900604248046875
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.821 Test Loss: 0.476 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.746511697769165
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.821 Test Loss: 0.478 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 6.1418962478637695
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 6.8720293045043945
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.827 Test Loss: 0.479 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 6.940326690673828
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 6.285664319992065
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.821 Test Loss: 0.476 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 6.298771381378174
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.821 Test Loss: 0.478 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 6.534515380859375
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.832 Test Loss: 0.478 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 5.771609544754028
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.827 Test Loss: 0.477 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.422925233840942
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
Validation loss decreased (inf --> -0.127148).  Saving model ...
Epoch: 2 cost time: 5.766946792602539
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.142579078674316
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.558295011520386
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.651917457580566
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.616259574890137
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.209936857223511
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.448845386505127
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.11479115486145
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.3505353927612305
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.134734869003296
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.12716763005780346
model parameter : 1357063
model size : 10.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.097989320755005
Epoch: 1, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.471 Vali Acc: 0.347 Test Loss: 1.471 Test Acc: 0.347
Validation loss decreased (inf --> -0.346806).  Saving model ...
Epoch: 2 cost time: 6.578022241592407
Epoch: 2, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.060 Vali Acc: 0.671 Test Loss: 1.060 Test Acc: 0.671
Validation loss decreased (-0.346806 --> -0.670510).  Saving model ...
Epoch: 3 cost time: 6.087989807128906
Epoch: 3, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.883 Vali Acc: 0.659 Test Loss: 0.883 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.127444744110107
Epoch: 4, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
Validation loss decreased (-0.670510 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 6.615253925323486
Epoch: 5, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.666 Vali Acc: 0.780 Test Loss: 0.666 Test Acc: 0.780
Validation loss decreased (-0.762999 --> -0.780340).  Saving model ...
Epoch: 6 cost time: 6.8566975593566895
Epoch: 6, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.501 Vali Acc: 0.827 Test Loss: 0.501 Test Acc: 0.827
Validation loss decreased (-0.780340 --> -0.826585).  Saving model ...
Epoch: 7 cost time: 6.1349334716796875
Epoch: 7, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.464 Vali Acc: 0.838 Test Loss: 0.464 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838146).  Saving model ...
Epoch: 8 cost time: 6.419545650482178
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.131684303283691
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849707).  Saving model ...
Epoch: 10 cost time: 5.595219135284424
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.449 Vali Acc: 0.844 Test Loss: 0.449 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.783224821090698
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.844 Test Loss: 0.447 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.286053419113159
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
Validation loss decreased (-0.849707 --> -0.855487).  Saving model ...
Epoch: 13 cost time: 5.9425108432769775
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.838 Test Loss: 0.454 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.175715684890747
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.815295696258545
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.860569715499878
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.457 Vali Acc: 0.867 Test Loss: 0.457 Test Acc: 0.867
Validation loss decreased (-0.855487 --> -0.867047).  Saving model ...
Epoch: 17 cost time: 6.16736626625061
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.832 Test Loss: 0.467 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.842890024185181
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.996887922286987
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.923037052154541
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.448064804077148
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.867 Test Loss: 0.467 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.673326253890991
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.75182318687439
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.844 Test Loss: 0.474 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.145281791687012
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.607932806015015
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.746981143951416
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.861 Test Loss: 0.476 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.235825061798096
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.512 Vali Acc: 0.358 Test Loss: 1.512 Test Acc: 0.358
Validation loss decreased (inf --> -0.358366).  Saving model ...
Epoch: 2 cost time: 6.334508657455444
Epoch: 2, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.056 Vali Acc: 0.636 Test Loss: 1.056 Test Acc: 0.636
Validation loss decreased (-0.358366 --> -0.635828).  Saving model ...
Epoch: 3 cost time: 5.557663440704346
Epoch: 3, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.845 Vali Acc: 0.682 Test Loss: 0.845 Test Acc: 0.682
Validation loss decreased (-0.635828 --> -0.682072).  Saving model ...
Epoch: 4 cost time: 5.866227388381958
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
Validation loss decreased (-0.682072 --> -0.803462).  Saving model ...
Epoch: 5 cost time: 6.238965034484863
Epoch: 5, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.573 Vali Acc: 0.798 Test Loss: 0.573 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.797888278961182
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.529 Vali Acc: 0.844 Test Loss: 0.529 Test Acc: 0.844
Validation loss decreased (-0.803462 --> -0.843925).  Saving model ...
Epoch: 7 cost time: 6.0035400390625
Epoch: 7, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.422 Vali Acc: 0.821 Test Loss: 0.422 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.3532514572143555
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.295406818389893
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.821 Test Loss: 0.434 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.334964990615845
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.838 Test Loss: 0.438 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.09569787979126
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.441 Vali Acc: 0.832 Test Loss: 0.441 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.695098638534546
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.437 Vali Acc: 0.827 Test Loss: 0.437 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.3522560596466064
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.821 Test Loss: 0.439 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.984228134155273
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.821 Test Loss: 0.445 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.682576894760132
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.219353675842285
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.827 Test Loss: 0.444 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.036198854446411
Epoch: 1, Steps: 17 | Train Loss: 1.862 Vali Loss: 1.592 Vali Acc: 0.376 Test Loss: 1.592 Test Acc: 0.376
Validation loss decreased (inf --> -0.375707).  Saving model ...
Epoch: 2 cost time: 6.246176719665527
Epoch: 2, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.083 Vali Acc: 0.659 Test Loss: 1.083 Test Acc: 0.659
Validation loss decreased (-0.375707 --> -0.658949).  Saving model ...
Epoch: 3 cost time: 6.0950846672058105
Epoch: 3, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.854 Vali Acc: 0.659 Test Loss: 0.854 Test Acc: 0.659
Validation loss decreased (-0.658949 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 6.4943461418151855
Epoch: 4, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.625 Vali Acc: 0.792 Test Loss: 0.625 Test Acc: 0.792
Validation loss decreased (-0.658951 --> -0.791901).  Saving model ...
Epoch: 5 cost time: 6.399248361587524
Epoch: 5, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.531 Vali Acc: 0.792 Test Loss: 0.531 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 6 cost time: 6.111748218536377
Epoch: 6, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
Validation loss decreased (-0.791902 --> -0.838146).  Saving model ...
Epoch: 7 cost time: 6.134133815765381
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.932823181152344
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.419 Vali Acc: 0.844 Test Loss: 0.419 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 5.70711874961853
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.427 Vali Acc: 0.838 Test Loss: 0.427 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.7423059940338135
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.428 Vali Acc: 0.844 Test Loss: 0.428 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.485569715499878
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.838 Test Loss: 0.424 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.774551153182983
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.838 Test Loss: 0.424 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.868571043014526
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.838 Test Loss: 0.425 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.965505599975586
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.0646185874938965
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.194586277008057
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.838 Test Loss: 0.432 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.585103988647461
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.838 Test Loss: 0.432 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.396081209182739
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.838 Test Loss: 0.435 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.169146060943604
Epoch: 1, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.692 Vali Acc: 0.353 Test Loss: 1.692 Test Acc: 0.353
Validation loss decreased (inf --> -0.352584).  Saving model ...
Epoch: 2 cost time: 6.949759006500244
Epoch: 2, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.191 Vali Acc: 0.630 Test Loss: 1.191 Test Acc: 0.630
Validation loss decreased (-0.352584 --> -0.630046).  Saving model ...
Epoch: 3 cost time: 5.885655403137207
Epoch: 3, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.911 Vali Acc: 0.671 Test Loss: 0.911 Test Acc: 0.671
Validation loss decreased (-0.630046 --> -0.670511).  Saving model ...
Epoch: 4 cost time: 5.932944297790527
Epoch: 4, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
Validation loss decreased (-0.670511 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 6.187489032745361
Epoch: 5, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.022222280502319
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
Validation loss decreased (-0.751438 --> -0.791902).  Saving model ...
Epoch: 7 cost time: 6.600021839141846
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.510 Vali Acc: 0.815 Test Loss: 0.510 Test Acc: 0.815
Validation loss decreased (-0.791902 --> -0.815024).  Saving model ...
Epoch: 8 cost time: 6.246932029724121
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.490 Vali Acc: 0.815 Test Loss: 0.490 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 9 cost time: 6.0049378871917725
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.484 Vali Acc: 0.815 Test Loss: 0.484 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 5.993663787841797
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.588708877563477
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.229949474334717
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.815 Test Loss: 0.477 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 13 cost time: 5.239947319030762
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5104475021362305
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.798 Test Loss: 0.483 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.360747575759888
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.743098735809326
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.048917531967163
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.798 Test Loss: 0.479 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.9674482345581055
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.798 Test Loss: 0.481 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.0178797245025635
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.798 Test Loss: 0.481 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.5947911739349365
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.798 Test Loss: 0.485 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.971535921096802
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.798 Test Loss: 0.481 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.855684995651245
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.798 Test Loss: 0.484 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.877394676208496
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.795 Vali Acc: 0.254 Test Loss: 1.795 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 5.8975207805633545
Epoch: 2, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.423 Vali Acc: 0.584 Test Loss: 1.423 Test Acc: 0.584
Validation loss decreased (-0.254317 --> -0.583801).  Saving model ...
Epoch: 3 cost time: 6.162918329238892
Epoch: 3, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.143 Vali Acc: 0.642 Test Loss: 1.143 Test Acc: 0.642
Validation loss decreased (-0.583801 --> -0.641607).  Saving model ...
Epoch: 4 cost time: 5.805323362350464
Epoch: 4, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.834 Vali Acc: 0.711 Test Loss: 0.834 Test Acc: 0.711
Validation loss decreased (-0.641607 --> -0.710974).  Saving model ...
Epoch: 5 cost time: 5.851170778274536
Epoch: 5, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.666 Vali Acc: 0.786 Test Loss: 0.666 Test Acc: 0.786
Validation loss decreased (-0.710974 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 5.840259075164795
Epoch: 6, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.566 Vali Acc: 0.821 Test Loss: 0.566 Test Acc: 0.821
Validation loss decreased (-0.786121 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 6.213184833526611
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.516 Vali Acc: 0.821 Test Loss: 0.516 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 5.763684034347534
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.97430157661438
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.0641093254089355
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.472 Vali Acc: 0.844 Test Loss: 0.472 Test Acc: 0.844
Validation loss decreased (-0.820804 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 5.7840118408203125
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.477 Vali Acc: 0.832 Test Loss: 0.477 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.7910850048065186
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.844 Test Loss: 0.460 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 13 cost time: 5.914157867431641
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.838 Test Loss: 0.458 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.662459850311279
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.453 Vali Acc: 0.827 Test Loss: 0.453 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.400717258453369
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.838 Test Loss: 0.450 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.138792991638184
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.446 Vali Acc: 0.832 Test Loss: 0.446 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.539082288742065
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.838 Test Loss: 0.442 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.697271347045898
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 19 cost time: 5.710376977920532
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.838 Test Loss: 0.435 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.699575662612915
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.838 Test Loss: 0.436 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.224921941757202
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.838 Test Loss: 0.432 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.1066131591796875
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.832 Test Loss: 0.432 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.035449981689453
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.832 Test Loss: 0.428 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.7085981369018555
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.844 Test Loss: 0.424 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.61381983757019
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.832 Test Loss: 0.422 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.1156182289123535
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.832 Test Loss: 0.422 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.31963038444519
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.421 Vali Acc: 0.844 Test Loss: 0.421 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.168708324432373
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.844 Test Loss: 0.420 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.50702428817749
Epoch: 1, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.855 Vali Acc: 0.272 Test Loss: 1.855 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 6.0978844165802
Epoch: 2, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.557 Vali Acc: 0.491 Test Loss: 1.557 Test Acc: 0.491
Validation loss decreased (-0.271658 --> -0.491314).  Saving model ...
Epoch: 3 cost time: 6.590362787246704
Epoch: 3, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.340 Vali Acc: 0.549 Test Loss: 1.340 Test Acc: 0.549
Validation loss decreased (-0.491314 --> -0.549120).  Saving model ...
Epoch: 4 cost time: 5.741499185562134
Epoch: 4, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.972 Vali Acc: 0.676 Test Loss: 0.972 Test Acc: 0.676
Validation loss decreased (-0.549120 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 5.680466175079346
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.771 Vali Acc: 0.734 Test Loss: 0.771 Test Acc: 0.734
Validation loss decreased (-0.676291 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 5.622914552688599
Epoch: 6, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.734 Vali Acc: 0.694 Test Loss: 0.734 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.774590492248535
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.635 Vali Acc: 0.723 Test Loss: 0.635 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.702897071838379
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.642 Vali Acc: 0.699 Test Loss: 0.642 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.631766080856323
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.763000).  Saving model ...
Epoch: 10 cost time: 6.483790636062622
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.567944049835205
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.581 Vali Acc: 0.728 Test Loss: 0.581 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.823054552078247
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.447356939315796
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.723 Test Loss: 0.571 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.139515399932861
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.309494733810425
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.717 Test Loss: 0.567 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.354069948196411
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.723 Test Loss: 0.559 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.1165452003479
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.751 Test Loss: 0.552 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.91560435295105
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.734 Test Loss: 0.552 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.903515338897705
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.813159227371216
Epoch: 1, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.891 Vali Acc: 0.202 Test Loss: 1.891 Test Acc: 0.202
Validation loss decreased (inf --> -0.202293).  Saving model ...
Epoch: 2 cost time: 5.909259796142578
Epoch: 2, Steps: 17 | Train Loss: 1.718 Vali Loss: 1.646 Vali Acc: 0.462 Test Loss: 1.646 Test Acc: 0.462
Validation loss decreased (-0.202293 --> -0.462411).  Saving model ...
Epoch: 3 cost time: 5.851153135299683
Epoch: 3, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.477 Vali Acc: 0.497 Test Loss: 1.477 Test Acc: 0.497
Validation loss decreased (-0.462411 --> -0.497095).  Saving model ...
Epoch: 4 cost time: 5.831727981567383
Epoch: 4, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.126 Vali Acc: 0.624 Test Loss: 1.126 Test Acc: 0.624
Validation loss decreased (-0.497095 --> -0.624266).  Saving model ...
Epoch: 5 cost time: 5.742446184158325
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.858 Vali Acc: 0.676 Test Loss: 0.858 Test Acc: 0.676
Validation loss decreased (-0.624266 --> -0.676292).  Saving model ...
Epoch: 6 cost time: 5.579005002975464
Epoch: 6, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.780 Vali Acc: 0.676 Test Loss: 0.780 Test Acc: 0.676
Validation loss decreased (-0.676292 --> -0.676293).  Saving model ...
Epoch: 7 cost time: 6.193576812744141
Epoch: 7, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.647 Vali Acc: 0.705 Test Loss: 0.647 Test Acc: 0.705
Validation loss decreased (-0.676293 --> -0.705196).  Saving model ...
Epoch: 8 cost time: 5.939007043838501
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.724 Vali Acc: 0.613 Test Loss: 0.724 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.112799644470215
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.626 Vali Acc: 0.699 Test Loss: 0.626 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.830827474594116
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.723 Test Loss: 0.630 Test Acc: 0.723
Validation loss decreased (-0.705196 --> -0.722537).  Saving model ...
Epoch: 11 cost time: 5.95579719543457
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.705 Test Loss: 0.609 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.396091938018799
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.597 Vali Acc: 0.734 Test Loss: 0.597 Test Acc: 0.734
Validation loss decreased (-0.722537 --> -0.734098).  Saving model ...
Epoch: 13 cost time: 6.032430171966553
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.601 Vali Acc: 0.734 Test Loss: 0.601 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.227097511291504
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.734 Test Loss: 0.591 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 15 cost time: 6.2404584884643555
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.734 Test Loss: 0.595 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.109538316726685
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.711 Test Loss: 0.613 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.174443483352661
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
Validation loss decreased (-0.734098 --> -0.745659).  Saving model ...
Epoch: 18 cost time: 6.014275550842285
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.740 Test Loss: 0.582 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.987311601638794
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.740 Test Loss: 0.587 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.551231622695923
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.734 Test Loss: 0.601 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.267396450042725
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.740 Test Loss: 0.582 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.497618198394775
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.740 Test Loss: 0.602 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.95677924156189
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.746 Test Loss: 0.583 Test Acc: 0.746
Validation loss decreased (-0.745659 --> -0.745659).  Saving model ...
Epoch: 24 cost time: 6.118367910385132
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
Validation loss decreased (-0.745659 --> -0.751439).  Saving model ...
Epoch: 25 cost time: 6.0417115688323975
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.662144184112549
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.740 Test Loss: 0.575 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.0529115200042725
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.751439 --> -0.763000).  Saving model ...
Epoch: 28 cost time: 6.0981292724609375
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.859161376953125
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.746 Test Loss: 0.578 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.785308361053467
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.456993103027344
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.158607482910156
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.649231910705566
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.740 Test Loss: 0.586 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.120835065841675
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 35 cost time: 6.138668060302734
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 36 cost time: 6.037075996398926
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.726500511169434
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.953346252441406
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 6.3858349323272705
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 6.129812717437744
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.308732032775879
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.769 Test Loss: 0.557 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768781).  Saving model ...
Epoch: 42 cost time: 5.6148200035095215
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.769 Test Loss: 0.561 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.589197397232056
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 6.038288593292236
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 6.028149366378784
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 5.976747035980225
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 6.784762620925903
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.769 Test Loss: 0.555 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 48 cost time: 6.243074655532837
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.401234149932861
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 5.847191095352173
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.583411693572998
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.769 Test Loss: 0.561 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 5.586846590042114
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.769 Test Loss: 0.559 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 5.588406085968018
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.769 Test Loss: 0.563 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 5.448910713195801
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.769 Test Loss: 0.561 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 5.815973997116089
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 6.171281099319458
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.769 Test Loss: 0.565 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 6.5274388790130615
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.763 Test Loss: 0.565 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.292330265045166
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.926 Vali Acc: 0.168 Test Loss: 1.926 Test Acc: 0.168
Validation loss decreased (inf --> -0.167611).  Saving model ...
Epoch: 2 cost time: 5.611465215682983
Epoch: 2, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.685 Vali Acc: 0.416 Test Loss: 1.685 Test Acc: 0.416
Validation loss decreased (-0.167611 --> -0.416168).  Saving model ...
Epoch: 3 cost time: 5.780644178390503
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.519 Vali Acc: 0.474 Test Loss: 1.519 Test Acc: 0.474
Validation loss decreased (-0.416168 --> -0.473973).  Saving model ...
Epoch: 4 cost time: 6.024967193603516
Epoch: 4, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.172 Vali Acc: 0.607 Test Loss: 1.172 Test Acc: 0.607
Validation loss decreased (-0.473973 --> -0.606925).  Saving model ...
Epoch: 5 cost time: 5.93302059173584
Epoch: 5, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.934 Vali Acc: 0.647 Test Loss: 0.934 Test Acc: 0.647
Validation loss decreased (-0.606925 --> -0.647390).  Saving model ...
Epoch: 6 cost time: 5.577024221420288
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.819 Vali Acc: 0.618 Test Loss: 0.819 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.436843633651733
Epoch: 7, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.683 Vali Acc: 0.723 Test Loss: 0.683 Test Acc: 0.723
Validation loss decreased (-0.647390 --> -0.722537).  Saving model ...
Epoch: 8 cost time: 5.330329656600952
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.633 Vali Acc: 0.734 Test Loss: 0.633 Test Acc: 0.734
Validation loss decreased (-0.722537 --> -0.734098).  Saving model ...
Epoch: 9 cost time: 5.381423711776733
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.624 Vali Acc: 0.734 Test Loss: 0.624 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 10 cost time: 5.656075716018677
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
Validation loss decreased (-0.734098 --> -0.751439).  Saving model ...
Epoch: 11 cost time: 6.046306610107422
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.751439 --> -0.763000).  Saving model ...
Epoch: 12 cost time: 6.272832632064819
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.575 Vali Acc: 0.751 Test Loss: 0.575 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.997915744781494
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.728 Test Loss: 0.597 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.381141424179077
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.565 Vali Acc: 0.763 Test Loss: 0.565 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 15 cost time: 6.074888467788696
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.0411882400512695
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.751 Test Loss: 0.584 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.496762990951538
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.731084823608398
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.769 Test Loss: 0.565 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 19 cost time: 6.049501895904541
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.23381233215332
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.128467798233032
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.087040424346924
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.769 Test Loss: 0.566 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.5157310962677
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.769 Test Loss: 0.568 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.535890340805054
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
Validation loss decreased (-0.768780 --> -0.780341).  Saving model ...
Epoch: 25 cost time: 5.498016119003296
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.653476238250732
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.786 Test Loss: 0.565 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 27 cost time: 5.713406562805176
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.769 Test Loss: 0.579 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.993585109710693
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.775 Test Loss: 0.572 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.142354488372803
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.775 Test Loss: 0.574 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.062941312789917
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.780 Test Loss: 0.577 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.887390851974487
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.386580228805542
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.786 Test Loss: 0.572 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.177000999450684
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.425320863723755
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.792 Test Loss: 0.570 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 35 cost time: 5.383968830108643
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.786 Test Loss: 0.563 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.859450578689575
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.798 Test Loss: 0.577 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 37 cost time: 5.927915811538696
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.792 Test Loss: 0.586 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 6.131162166595459
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803462).  Saving model ...
Epoch: 39 cost time: 5.667323589324951
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809243).  Saving model ...
Epoch: 40 cost time: 5.801326274871826
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.792 Test Loss: 0.582 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.631265640258789
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.332978010177612
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.5081562995910645
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 6.070134162902832
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.815 Test Loss: 0.574 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 45 cost time: 5.885308265686035
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.815 Test Loss: 0.580 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 6.07651424407959
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.815 Test Loss: 0.578 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.671729326248169
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.815 Test Loss: 0.572 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 48 cost time: 5.80554986000061
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.815 Test Loss: 0.577 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 6.415897607803345
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.815 Test Loss: 0.576 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 6.332155227661133
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.815 Test Loss: 0.590 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 6.363299369812012
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.815 Test Loss: 0.590 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 6.6710734367370605
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.815 Test Loss: 0.581 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 6.539628028869629
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 6.6135265827178955
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.815 Test Loss: 0.589 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 5.892531633377075
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.815 Test Loss: 0.579 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 5.654648303985596
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.815 Test Loss: 0.589 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 6.156352758407593
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.815 Test Loss: 0.589 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.06363320350647
Epoch: 1, Steps: 17 | Train Loss: 1.999 Vali Loss: 1.928 Vali Acc: 0.254 Test Loss: 1.928 Test Acc: 0.254
Validation loss decreased (inf --> -0.254316).  Saving model ...
Epoch: 2 cost time: 6.262205600738525
Epoch: 2, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.690 Vali Acc: 0.393 Test Loss: 1.690 Test Acc: 0.393
Validation loss decreased (-0.254316 --> -0.393047).  Saving model ...
Epoch: 3 cost time: 6.013699293136597
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.485 Vali Acc: 0.561 Test Loss: 1.485 Test Acc: 0.561
Validation loss decreased (-0.393047 --> -0.560679).  Saving model ...
Epoch: 4 cost time: 5.56219482421875
Epoch: 4, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.177 Vali Acc: 0.659 Test Loss: 1.177 Test Acc: 0.659
Validation loss decreased (-0.560679 --> -0.658948).  Saving model ...
Epoch: 5 cost time: 5.542459964752197
Epoch: 5, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.921 Vali Acc: 0.665 Test Loss: 0.921 Test Acc: 0.665
Validation loss decreased (-0.658948 --> -0.664731).  Saving model ...
Epoch: 6 cost time: 5.875086307525635
Epoch: 6, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.805 Vali Acc: 0.647 Test Loss: 0.805 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.620009183883667
Epoch: 7, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.678 Vali Acc: 0.763 Test Loss: 0.678 Test Acc: 0.763
Validation loss decreased (-0.664731 --> -0.762999).  Saving model ...
Epoch: 8 cost time: 5.61327052116394
Epoch: 8, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.000819444656372
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.618 Vali Acc: 0.740 Test Loss: 0.618 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.565863132476807
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.581 Vali Acc: 0.769 Test Loss: 0.581 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768780).  Saving model ...
Epoch: 11 cost time: 5.628005743026733
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.605136156082153
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.70713996887207
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.585 Vali Acc: 0.751 Test Loss: 0.585 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.815454721450806
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.574 Vali Acc: 0.769 Test Loss: 0.574 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 15 cost time: 6.013769149780273
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.293214797973633
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.5554563999176025
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.786 Test Loss: 0.556 Test Acc: 0.786
Validation loss decreased (-0.768780 --> -0.786122).  Saving model ...
Epoch: 18 cost time: 6.108658790588379
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.769 Test Loss: 0.560 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.935048818588257
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.769 Test Loss: 0.574 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.672203302383423
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.585634469985962
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.7252397537231445
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.775 Test Loss: 0.544 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.654975652694702
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.786 Test Loss: 0.557 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.050394773483276
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.780 Test Loss: 0.551 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.60336709022522
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.780 Test Loss: 0.546 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.060909986495972
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.775 Test Loss: 0.545 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.657087564468384
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.786 Test Loss: 0.559 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.721529006958008
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
Validation loss decreased (inf --> -0.127148).  Saving model ...
Epoch: 2 cost time: 5.622357368469238
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.8205952644348145
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.049803256988525
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.714661598205566
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.07008171081543
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.324669122695923
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.968959331512451
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.838277578353882
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.001705169677734
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.803717851638794
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.12716763005780346
model parameter : 1258759
model size : 9.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.131024599075317
Epoch: 1, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.550 Vali Acc: 0.318 Test Loss: 1.550 Test Acc: 0.318
Validation loss decreased (inf --> -0.317904).  Saving model ...
Epoch: 2 cost time: 5.815380811691284
Epoch: 2, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.187 Vali Acc: 0.543 Test Loss: 1.187 Test Acc: 0.543
Validation loss decreased (-0.317904 --> -0.543341).  Saving model ...
Epoch: 3 cost time: 6.103352069854736
Epoch: 3, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.162 Vali Acc: 0.468 Test Loss: 1.162 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.389256715774536
Epoch: 4, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.840 Vali Acc: 0.746 Test Loss: 0.840 Test Acc: 0.746
Validation loss decreased (-0.543341 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 6.6582465171813965
Epoch: 5, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
Validation loss decreased (-0.745656 --> -0.803462).  Saving model ...
Epoch: 6 cost time: 6.606945991516113
Epoch: 6, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.558 Vali Acc: 0.821 Test Loss: 0.558 Test Acc: 0.821
Validation loss decreased (-0.803462 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 6.68030571937561
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838146).  Saving model ...
Epoch: 8 cost time: 6.32137393951416
Epoch: 8, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.488 Vali Acc: 0.827 Test Loss: 0.488 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.719515085220337
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.056705713272095
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.480 Vali Acc: 0.815 Test Loss: 0.480 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.051975250244141
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.743759632110596
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.481 Vali Acc: 0.815 Test Loss: 0.481 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.554027080535889
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.955772638320923
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.087210416793823
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.2132673263549805
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.236593246459961
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.523 Vali Acc: 0.798 Test Loss: 0.523 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.672069311141968
Epoch: 1, Steps: 17 | Train Loss: 1.871 Vali Loss: 1.608 Vali Acc: 0.318 Test Loss: 1.608 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
Epoch: 2 cost time: 5.813266038894653
Epoch: 2, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.222 Vali Acc: 0.555 Test Loss: 1.222 Test Acc: 0.555
Validation loss decreased (-0.317903 --> -0.554901).  Saving model ...
Epoch: 3 cost time: 5.7817137241363525
Epoch: 3, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.123 Vali Acc: 0.526 Test Loss: 1.123 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.7023985385894775
Epoch: 4, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.799 Vali Acc: 0.740 Test Loss: 0.799 Test Acc: 0.740
Validation loss decreased (-0.554901 --> -0.739876).  Saving model ...
Epoch: 5 cost time: 6.445276737213135
Epoch: 5, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
Validation loss decreased (-0.739876 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 6.296055316925049
Epoch: 6, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.501 Vali Acc: 0.798 Test Loss: 0.501 Test Acc: 0.798
Validation loss decreased (-0.757219 --> -0.797683).  Saving model ...
Epoch: 7 cost time: 6.059577226638794
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.506 Vali Acc: 0.798 Test Loss: 0.506 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.899635314941406
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.029366731643677
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.460 Vali Acc: 0.798 Test Loss: 0.460 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 10 cost time: 6.065582036972046
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.815 Test Loss: 0.440 Test Acc: 0.815
Validation loss decreased (-0.797683 --> -0.815025).  Saving model ...
Epoch: 11 cost time: 6.089934587478638
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.848410129547119
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.448 Vali Acc: 0.815 Test Loss: 0.448 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.246122121810913
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.803 Test Loss: 0.469 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.929013967514038
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.55879282951355
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.730166673660278
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.107832670211792
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.792 Test Loss: 0.486 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.5455217361450195
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.620204210281372
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.6246349811553955
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.051774024963379
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.674 Vali Acc: 0.382 Test Loss: 1.674 Test Acc: 0.382
Validation loss decreased (inf --> -0.381486).  Saving model ...
Epoch: 2 cost time: 5.876694679260254
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.282 Vali Acc: 0.468 Test Loss: 1.282 Test Acc: 0.468
Validation loss decreased (-0.381486 --> -0.468195).  Saving model ...
Epoch: 3 cost time: 6.065629720687866
Epoch: 3, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.121 Vali Acc: 0.538 Test Loss: 1.121 Test Acc: 0.538
Validation loss decreased (-0.468195 --> -0.537561).  Saving model ...
Epoch: 4 cost time: 6.086137294769287
Epoch: 4, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.831 Vali Acc: 0.682 Test Loss: 0.831 Test Acc: 0.682
Validation loss decreased (-0.537561 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 6.315603971481323
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.689 Vali Acc: 0.751 Test Loss: 0.689 Test Acc: 0.751
Validation loss decreased (-0.682073 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 5.7506749629974365
Epoch: 6, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757220).  Saving model ...
Epoch: 7 cost time: 6.340603351593018
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
Validation loss decreased (-0.757220 --> -0.774561).  Saving model ...
Epoch: 8 cost time: 6.068047523498535
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.490 Vali Acc: 0.780 Test Loss: 0.490 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780342).  Saving model ...
Epoch: 9 cost time: 6.180431365966797
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.491 Vali Acc: 0.792 Test Loss: 0.491 Test Acc: 0.792
Validation loss decreased (-0.780342 --> -0.791903).  Saving model ...
Epoch: 10 cost time: 6.0296714305877686
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.486 Vali Acc: 0.775 Test Loss: 0.486 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.648589849472046
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.479 Vali Acc: 0.769 Test Loss: 0.479 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.18518328666687
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.786 Test Loss: 0.475 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.480719804763794
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.481 Vali Acc: 0.786 Test Loss: 0.481 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.008974075317383
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.786 Test Loss: 0.485 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.346515655517578
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.798 Test Loss: 0.483 Test Acc: 0.798
Validation loss decreased (-0.791903 --> -0.797683).  Saving model ...
Epoch: 16 cost time: 6.27765965461731
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.798 Test Loss: 0.482 Test Acc: 0.798
Validation loss decreased (-0.797683 --> -0.797683).  Saving model ...
Epoch: 17 cost time: 6.290789365768433
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.786 Test Loss: 0.494 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.0646653175354
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.786 Test Loss: 0.501 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.18046498298645
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.792 Test Loss: 0.502 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.2572572231292725
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.775 Test Loss: 0.505 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.086377859115601
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.775 Test Loss: 0.502 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.318496465682983
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.786 Test Loss: 0.498 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.754181146621704
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.46247935295105
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.780 Test Loss: 0.511 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.360257863998413
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.155294179916382
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.786 Test Loss: 0.507 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.04578948020935
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.769 Vali Acc: 0.312 Test Loss: 1.769 Test Acc: 0.312
Validation loss decreased (inf --> -0.312121).  Saving model ...
Epoch: 2 cost time: 6.009746789932251
Epoch: 2, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.394 Vali Acc: 0.486 Test Loss: 1.394 Test Acc: 0.486
Validation loss decreased (-0.312121 --> -0.485535).  Saving model ...
Epoch: 3 cost time: 6.422102451324463
Epoch: 3, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.102 Vali Acc: 0.618 Test Loss: 1.102 Test Acc: 0.618
Validation loss decreased (-0.485535 --> -0.618486).  Saving model ...
Epoch: 4 cost time: 5.7777533531188965
Epoch: 4, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.847 Vali Acc: 0.705 Test Loss: 0.847 Test Acc: 0.705
Validation loss decreased (-0.618486 --> -0.705194).  Saving model ...
Epoch: 5 cost time: 5.503439664840698
Epoch: 5, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
Validation loss decreased (-0.705194 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 5.58494234085083
Epoch: 6, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.510 Vali Acc: 0.786 Test Loss: 0.510 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786122).  Saving model ...
Epoch: 7 cost time: 5.674581289291382
Epoch: 7, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
Validation loss decreased (-0.786122 --> -0.803464).  Saving model ...
Epoch: 8 cost time: 5.652986764907837
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.420 Vali Acc: 0.832 Test Loss: 0.420 Test Acc: 0.832
Validation loss decreased (-0.803464 --> -0.832366).  Saving model ...
Epoch: 9 cost time: 5.8375563621521
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.443 Vali Acc: 0.827 Test Loss: 0.443 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.044380187988281
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.425 Vali Acc: 0.838 Test Loss: 0.425 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 5.713794469833374
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.821 Test Loss: 0.441 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.639026403427124
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.827 Test Loss: 0.439 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.872298002243042
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.445 Vali Acc: 0.827 Test Loss: 0.445 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.66577935218811
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.719826936721802
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.281739711761475
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.078567028045654
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.821 Test Loss: 0.455 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.669224500656128
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.455 Vali Acc: 0.821 Test Loss: 0.455 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.654924154281616
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.827 Test Loss: 0.454 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.402703523635864
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.456 Vali Acc: 0.827 Test Loss: 0.456 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.690998077392578
Epoch: 1, Steps: 17 | Train Loss: 1.956 Vali Loss: 1.878 Vali Acc: 0.283 Test Loss: 1.878 Test Acc: 0.283
Validation loss decreased (inf --> -0.283218).  Saving model ...
Epoch: 2 cost time: 6.411008596420288
Epoch: 2, Steps: 17 | Train Loss: 1.669 Vali Loss: 1.635 Vali Acc: 0.451 Test Loss: 1.635 Test Acc: 0.451
Validation loss decreased (-0.283218 --> -0.450851).  Saving model ...
Epoch: 3 cost time: 5.90164041519165
Epoch: 3, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.395 Vali Acc: 0.566 Test Loss: 1.395 Test Acc: 0.566
Validation loss decreased (-0.450851 --> -0.566460).  Saving model ...
Epoch: 4 cost time: 6.194792747497559
Epoch: 4, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.138 Vali Acc: 0.595 Test Loss: 1.138 Test Acc: 0.595
Validation loss decreased (-0.566460 --> -0.595364).  Saving model ...
Epoch: 5 cost time: 5.91143012046814
Epoch: 5, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.912 Vali Acc: 0.705 Test Loss: 0.912 Test Acc: 0.705
Validation loss decreased (-0.595364 --> -0.705193).  Saving model ...
Epoch: 6 cost time: 5.834096670150757
Epoch: 6, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.705193 --> -0.716756).  Saving model ...
Epoch: 7 cost time: 5.311979055404663
Epoch: 7, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
Validation loss decreased (-0.716756 --> -0.757219).  Saving model ...
Epoch: 8 cost time: 6.297785520553589
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757220).  Saving model ...
Epoch: 9 cost time: 6.521198987960815
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.521 Vali Acc: 0.821 Test Loss: 0.521 Test Acc: 0.821
Validation loss decreased (-0.757220 --> -0.820804).  Saving model ...
Epoch: 10 cost time: 6.72904372215271
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.0649025440216064
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.792 Test Loss: 0.521 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.290828704833984
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.499 Vali Acc: 0.827 Test Loss: 0.499 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 13 cost time: 6.503924608230591
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.500 Vali Acc: 0.827 Test Loss: 0.500 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.480478525161743
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.494 Vali Acc: 0.821 Test Loss: 0.494 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.644235610961914
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.827 Test Loss: 0.491 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 16 cost time: 6.867979526519775
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.827 Test Loss: 0.490 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 5.984802722930908
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.832 Test Loss: 0.486 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 18 cost time: 5.7013561725616455
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.489 Vali Acc: 0.838 Test Loss: 0.489 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 19 cost time: 5.81226110458374
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.827 Test Loss: 0.486 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.347367286682129
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 21 cost time: 6.272934436798096
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.838 Test Loss: 0.485 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.493474245071411
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 23 cost time: 6.335137605667114
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.915553331375122
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.832 Test Loss: 0.481 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.182633876800537
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838146).  Saving model ...
Epoch: 26 cost time: 6.777591943740845
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.832 Test Loss: 0.478 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.538876056671143
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.821 Test Loss: 0.479 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.258974552154541
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.878516912460327
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.832 Test Loss: 0.471 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.806920766830444
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.994372129440308
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.832 Test Loss: 0.473 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.4534337520599365
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 33 cost time: 6.790076971054077
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.832 Test Loss: 0.472 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.201890468597412
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.832 Test Loss: 0.470 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.280300140380859
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.832 Test Loss: 0.468 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.394379377365112
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.789398670196533
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.739550828933716
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.832 Test Loss: 0.470 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.817178964614868
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 40 cost time: 6.403182506561279
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.832 Test Loss: 0.467 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 6.231603622436523
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 42 cost time: 6.079206705093384
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 43 cost time: 7.103713750839233
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.832 Test Loss: 0.467 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.315786361694336
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.682485342025757
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.838 Test Loss: 0.471 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.146886825561523
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 6.617183208465576
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 6.546880006790161
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 6.789302349090576
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 5.878953695297241
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
Validation loss decreased (-0.838146 --> -0.838146).  Saving model ...
Epoch: 51 cost time: 5.886444330215454
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.838 Test Loss: 0.466 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.89799165725708
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.827 Test Loss: 0.467 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.699432134628296
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.838 Test Loss: 0.466 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.6766979694366455
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849706).  Saving model ...
Epoch: 55 cost time: 5.61962103843689
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.154526233673096
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.046655893325806
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 7.004506826400757
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.850 Test Loss: 0.467 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 7.425455093383789
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.838 Test Loss: 0.465 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 6.342926502227783
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 6.790918827056885
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 6.541842222213745
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.855 Test Loss: 0.464 Test Acc: 0.855
Validation loss decreased (-0.849706 --> -0.855487).  Saving model ...
Epoch: 63 cost time: 6.151278972625732
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.465 Vali Acc: 0.844 Test Loss: 0.465 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 6.150367736816406
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 7.247951030731201
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 6.7651591300964355
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 6.098811626434326
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.844 Test Loss: 0.468 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 6.711810111999512
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 6.787414312362671
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 6.805478096008301
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 7.077939987182617
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 6.083673715591431
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.804076433181763
Epoch: 1, Steps: 17 | Train Loss: 1.966 Vali Loss: 1.925 Vali Acc: 0.191 Test Loss: 1.925 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 5.96221399307251
Epoch: 2, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.749 Vali Acc: 0.341 Test Loss: 1.749 Test Acc: 0.341
Validation loss decreased (-0.190732 --> -0.341023).  Saving model ...
Epoch: 3 cost time: 5.517768144607544
Epoch: 3, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.540 Vali Acc: 0.526 Test Loss: 1.540 Test Acc: 0.526
Validation loss decreased (-0.341023 --> -0.525996).  Saving model ...
Epoch: 4 cost time: 5.3973658084869385
Epoch: 4, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.338 Vali Acc: 0.555 Test Loss: 1.338 Test Acc: 0.555
Validation loss decreased (-0.525996 --> -0.554900).  Saving model ...
Epoch: 5 cost time: 6.177732944488525
Epoch: 5, Steps: 17 | Train Loss: 0.776 Vali Loss: 1.123 Vali Acc: 0.601 Test Loss: 1.123 Test Acc: 0.601
Validation loss decreased (-0.554900 --> -0.601145).  Saving model ...
Epoch: 6 cost time: 5.978453159332275
Epoch: 6, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.917 Vali Acc: 0.647 Test Loss: 0.917 Test Acc: 0.647
Validation loss decreased (-0.601145 --> -0.647390).  Saving model ...
Epoch: 7 cost time: 6.27222466468811
Epoch: 7, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.847 Vali Acc: 0.613 Test Loss: 0.847 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.80200719833374
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.779 Vali Acc: 0.630 Test Loss: 0.779 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.871118783950806
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.697 Vali Acc: 0.699 Test Loss: 0.697 Test Acc: 0.699
Validation loss decreased (-0.647390 --> -0.699415).  Saving model ...
Epoch: 10 cost time: 6.518030166625977
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.675 Vali Acc: 0.688 Test Loss: 0.675 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.031684398651123
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.654 Vali Acc: 0.711 Test Loss: 0.654 Test Acc: 0.711
Validation loss decreased (-0.699415 --> -0.710976).  Saving model ...
Epoch: 12 cost time: 6.115873336791992
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.652 Vali Acc: 0.723 Test Loss: 0.652 Test Acc: 0.723
Validation loss decreased (-0.710976 --> -0.722537).  Saving model ...
Epoch: 13 cost time: 5.3291916847229
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.657 Vali Acc: 0.711 Test Loss: 0.657 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5347208976745605
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.643 Vali Acc: 0.699 Test Loss: 0.643 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.679015874862671
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.705 Test Loss: 0.642 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.179479122161865
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.637 Vali Acc: 0.717 Test Loss: 0.637 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.240028142929077
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.723 Test Loss: 0.630 Test Acc: 0.723
Validation loss decreased (-0.722537 --> -0.722537).  Saving model ...
Epoch: 18 cost time: 5.804049491882324
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.636 Vali Acc: 0.723 Test Loss: 0.636 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.7305908203125
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.641 Vali Acc: 0.728 Test Loss: 0.641 Test Acc: 0.728
Validation loss decreased (-0.722537 --> -0.728317).  Saving model ...
Epoch: 20 cost time: 6.215648889541626
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.740 Test Loss: 0.625 Test Acc: 0.740
Validation loss decreased (-0.728317 --> -0.739878).  Saving model ...
Epoch: 21 cost time: 6.34763503074646
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.629 Vali Acc: 0.723 Test Loss: 0.629 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.126802444458008
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
Validation loss decreased (-0.739878 --> -0.745659).  Saving model ...
Epoch: 23 cost time: 5.413942813873291
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.734 Test Loss: 0.626 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.448119401931763
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.798019647598267
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.626 Vali Acc: 0.717 Test Loss: 0.626 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.052336692810059
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.734 Test Loss: 0.616 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.253354787826538
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
Validation loss decreased (-0.745659 --> -0.745659).  Saving model ...
Epoch: 28 cost time: 5.650956153869629
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.728 Test Loss: 0.610 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.7432756423950195
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.734 Test Loss: 0.613 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.968276262283325
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.746 Test Loss: 0.612 Test Acc: 0.746
Validation loss decreased (-0.745659 --> -0.745659).  Saving model ...
Epoch: 31 cost time: 6.64092493057251
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
Validation loss decreased (-0.745659 --> -0.745659).  Saving model ...
Epoch: 32 cost time: 6.0373735427856445
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.728 Test Loss: 0.609 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.792606592178345
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.734 Test Loss: 0.606 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.661513805389404
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
Validation loss decreased (-0.745659 --> -0.751439).  Saving model ...
Epoch: 35 cost time: 5.934313535690308
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 36 cost time: 6.424873113632202
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.12414813041687
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.746 Test Loss: 0.601 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.403452396392822
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 39 cost time: 5.492559432983398
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.769 Test Loss: 0.593 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 40 cost time: 5.6654181480407715
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.780 Test Loss: 0.595 Test Acc: 0.780
Validation loss decreased (-0.768780 --> -0.780341).  Saving model ...
Epoch: 41 cost time: 6.643699645996094
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.734 Test Loss: 0.600 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.5182530879974365
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.751 Test Loss: 0.601 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 6.204638481140137
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 5.935070276260376
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 5.720704793930054
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.746 Test Loss: 0.591 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 6.457209348678589
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 6.075088977813721
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 5.975593566894531
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 5.649034738540649
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 5.4328391551971436
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.364595174789429
Epoch: 1, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.983 Vali Acc: 0.179 Test Loss: 1.983 Test Acc: 0.179
Validation loss decreased (inf --> -0.179171).  Saving model ...
Epoch: 2 cost time: 5.597825527191162
Epoch: 2, Steps: 17 | Train Loss: 1.810 Vali Loss: 1.850 Vali Acc: 0.289 Test Loss: 1.850 Test Acc: 0.289
Validation loss decreased (-0.179171 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 5.662723541259766
Epoch: 3, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.657 Vali Acc: 0.474 Test Loss: 1.657 Test Acc: 0.474
Validation loss decreased (-0.288999 --> -0.473972).  Saving model ...
Epoch: 4 cost time: 6.720789432525635
Epoch: 4, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.455 Vali Acc: 0.572 Test Loss: 1.455 Test Acc: 0.572
Validation loss decreased (-0.473972 --> -0.572240).  Saving model ...
Epoch: 5 cost time: 7.024972200393677
Epoch: 5, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.239 Vali Acc: 0.618 Test Loss: 1.239 Test Acc: 0.618
Validation loss decreased (-0.572240 --> -0.618485).  Saving model ...
Epoch: 6 cost time: 6.491683483123779
Epoch: 6, Steps: 17 | Train Loss: 0.657 Vali Loss: 1.047 Vali Acc: 0.630 Test Loss: 1.047 Test Acc: 0.630
Validation loss decreased (-0.618485 --> -0.630047).  Saving model ...
Epoch: 7 cost time: 5.737331390380859
Epoch: 7, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.983 Vali Acc: 0.607 Test Loss: 0.983 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.321019411087036
Epoch: 8, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.836 Vali Acc: 0.665 Test Loss: 0.836 Test Acc: 0.665
Validation loss decreased (-0.630047 --> -0.664732).  Saving model ...
Epoch: 9 cost time: 5.561410427093506
Epoch: 9, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.751 Vali Acc: 0.694 Test Loss: 0.751 Test Acc: 0.694
Validation loss decreased (-0.664732 --> -0.693634).  Saving model ...
Epoch: 10 cost time: 5.708317041397095
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.716 Vali Acc: 0.694 Test Loss: 0.716 Test Acc: 0.694
Validation loss decreased (-0.693634 --> -0.693634).  Saving model ...
Epoch: 11 cost time: 6.345176458358765
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
Validation loss decreased (-0.693634 --> -0.716756).  Saving model ...
Epoch: 12 cost time: 6.361483573913574
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.654 Vali Acc: 0.757 Test Loss: 0.654 Test Acc: 0.757
Validation loss decreased (-0.716756 --> -0.757219).  Saving model ...
Epoch: 13 cost time: 6.298492670059204
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.651 Vali Acc: 0.711 Test Loss: 0.651 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.873980522155762
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.641 Vali Acc: 0.699 Test Loss: 0.641 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.284918308258057
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.629 Vali Acc: 0.711 Test Loss: 0.629 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.474807500839233
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.728 Test Loss: 0.619 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.296095609664917
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.751 Test Loss: 0.606 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.276130676269531
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.775 Test Loss: 0.596 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774561).  Saving model ...
Epoch: 19 cost time: 5.406993389129639
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.746 Test Loss: 0.598 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.853959798812866
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.740 Test Loss: 0.584 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.763736248016357
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.734 Test Loss: 0.583 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.466315984725952
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.691266298294067
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.740 Test Loss: 0.571 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.211191654205322
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.746 Test Loss: 0.576 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.216297626495361
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.618904113769531
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.757 Test Loss: 0.555 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.599677324295044
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.284109830856323
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.769 Test Loss: 0.551 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.0373828411102295
Epoch: 1, Steps: 17 | Train Loss: 1.978 Vali Loss: 1.940 Vali Acc: 0.202 Test Loss: 1.940 Test Acc: 0.202
Validation loss decreased (inf --> -0.202293).  Saving model ...
Epoch: 2 cost time: 6.281472444534302
Epoch: 2, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.816 Vali Acc: 0.277 Test Loss: 1.816 Test Acc: 0.277
Validation loss decreased (-0.202293 --> -0.277438).  Saving model ...
Epoch: 3 cost time: 6.198957920074463
Epoch: 3, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.633 Vali Acc: 0.457 Test Loss: 1.633 Test Acc: 0.457
Validation loss decreased (-0.277438 --> -0.456631).  Saving model ...
Epoch: 4 cost time: 5.570878505706787
Epoch: 4, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.416 Vali Acc: 0.624 Test Loss: 1.416 Test Acc: 0.624
Validation loss decreased (-0.456631 --> -0.624263).  Saving model ...
Epoch: 5 cost time: 5.7207818031311035
Epoch: 5, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.209 Vali Acc: 0.642 Test Loss: 1.209 Test Acc: 0.642
Validation loss decreased (-0.624263 --> -0.641606).  Saving model ...
Epoch: 6 cost time: 6.388821363449097
Epoch: 6, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.016 Vali Acc: 0.705 Test Loss: 1.016 Test Acc: 0.705
Validation loss decreased (-0.641606 --> -0.705192).  Saving model ...
Epoch: 7 cost time: 6.49116063117981
Epoch: 7, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.855 Vali Acc: 0.682 Test Loss: 0.855 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.161006927490234
Epoch: 8, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.701 Vali Acc: 0.751 Test Loss: 0.701 Test Acc: 0.751
Validation loss decreased (-0.705192 --> -0.751438).  Saving model ...
Epoch: 9 cost time: 5.879160642623901
Epoch: 9, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757219).  Saving model ...
Epoch: 10 cost time: 5.6692376136779785
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 11 cost time: 6.66480827331543
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.193984270095825
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
Validation loss decreased (-0.757219 --> -0.763000).  Saving model ...
Epoch: 13 cost time: 5.886143207550049
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.528 Vali Acc: 0.769 Test Loss: 0.528 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768781).  Saving model ...
Epoch: 14 cost time: 5.786012887954712
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.534 Vali Acc: 0.775 Test Loss: 0.534 Test Acc: 0.775
Validation loss decreased (-0.768781 --> -0.774561).  Saving model ...
Epoch: 15 cost time: 6.221390247344971
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.537 Vali Acc: 0.780 Test Loss: 0.537 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 16 cost time: 6.414580345153809
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.523 Vali Acc: 0.769 Test Loss: 0.523 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.320293188095093
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.518 Vali Acc: 0.763 Test Loss: 0.518 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.290383577346802
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.775 Test Loss: 0.522 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.147857189178467
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.357243776321411
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.769 Test Loss: 0.525 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.3927764892578125
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.786 Test Loss: 0.520 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 22 cost time: 5.936795234680176
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.780 Test Loss: 0.513 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.723359823226929
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.516 Vali Acc: 0.786 Test Loss: 0.516 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 24 cost time: 6.017606973648071
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.780 Test Loss: 0.514 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.319831848144531
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.786 Test Loss: 0.505 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 26 cost time: 5.5150628089904785
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.792 Test Loss: 0.507 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 27 cost time: 5.759470462799072
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.786 Test Loss: 0.517 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.6244096755981445
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.265621185302734
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.786 Test Loss: 0.507 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.9949305057525635
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.792 Test Loss: 0.508 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.933564901351929
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.786 Test Loss: 0.519 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.146296501159668
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.792 Test Loss: 0.516 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.400578737258911
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.786 Test Loss: 0.515 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.5122270584106445
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.792 Test Loss: 0.513 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.458324193954468
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.792 Test Loss: 0.516 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.670262336730957
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 37 cost time: 6.535291433334351
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 38 cost time: 6.636056184768677
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.798 Test Loss: 0.516 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.475672006607056
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 7.164735794067383
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809244).  Saving model ...
Epoch: 41 cost time: 6.996615409851074
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.810520648956299
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 6.830768585205078
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 6.981351852416992
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 7.284198522567749
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.821 Test Loss: 0.504 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820804).  Saving model ...
Epoch: 46 cost time: 6.3812925815582275
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.821 Test Loss: 0.504 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.927862167358398
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.815 Test Loss: 0.504 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.312675476074219
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.815 Test Loss: 0.508 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 6.267567157745361
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.815 Test Loss: 0.511 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 6.853150367736816
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.815 Test Loss: 0.511 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 6.969348430633545
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.815 Test Loss: 0.515 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 6.297144174575806
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.815 Test Loss: 0.512 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 6.49381422996521
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.815 Test Loss: 0.515 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 7.175298452377319
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 6.452091693878174
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.821 Test Loss: 0.517 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.655256032943726
Epoch: 1, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.951 Vali Acc: 0.197 Test Loss: 1.951 Test Acc: 0.197
Validation loss decreased (inf --> -0.196512).  Saving model ...
Epoch: 2 cost time: 5.652432441711426
Epoch: 2, Steps: 17 | Train Loss: 1.858 Vali Loss: 1.831 Vali Acc: 0.306 Test Loss: 1.831 Test Acc: 0.306
Validation loss decreased (-0.196512 --> -0.306340).  Saving model ...
Epoch: 3 cost time: 6.477410078048706
Epoch: 3, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.645 Vali Acc: 0.491 Test Loss: 1.645 Test Acc: 0.491
Validation loss decreased (-0.306340 --> -0.491313).  Saving model ...
Epoch: 4 cost time: 6.150236129760742
Epoch: 4, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.431 Vali Acc: 0.618 Test Loss: 1.431 Test Acc: 0.618
Validation loss decreased (-0.491313 --> -0.618483).  Saving model ...
Epoch: 5 cost time: 5.7426438331604
Epoch: 5, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.220 Vali Acc: 0.630 Test Loss: 1.220 Test Acc: 0.630
Validation loss decreased (-0.618483 --> -0.630046).  Saving model ...
Epoch: 6 cost time: 5.439690113067627
Epoch: 6, Steps: 17 | Train Loss: 0.787 Vali Loss: 1.021 Vali Acc: 0.682 Test Loss: 1.021 Test Acc: 0.682
Validation loss decreased (-0.630046 --> -0.682071).  Saving model ...
Epoch: 7 cost time: 6.18890905380249
Epoch: 7, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.850 Vali Acc: 0.705 Test Loss: 0.850 Test Acc: 0.705
Validation loss decreased (-0.682071 --> -0.705194).  Saving model ...
Epoch: 8 cost time: 6.3406760692596436
Epoch: 8, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.723 Vali Acc: 0.734 Test Loss: 0.723 Test Acc: 0.734
Validation loss decreased (-0.705194 --> -0.734097).  Saving model ...
Epoch: 9 cost time: 5.721501350402832
Epoch: 9, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
Validation loss decreased (-0.734097 --> -0.763000).  Saving model ...
Epoch: 10 cost time: 5.891836166381836
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.4858691692352295
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.514422178268433
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.552 Vali Acc: 0.763 Test Loss: 0.552 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 13 cost time: 5.996051549911499
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
Validation loss decreased (-0.763000 --> -0.774561).  Saving model ...
Epoch: 14 cost time: 6.270220518112183
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.532 Vali Acc: 0.769 Test Loss: 0.532 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.237025737762451
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.217679500579834
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.535 Vali Acc: 0.769 Test Loss: 0.535 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.705143213272095
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.520 Vali Acc: 0.775 Test Loss: 0.520 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 18 cost time: 6.088871955871582
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.462967157363892
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.763 Test Loss: 0.534 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.894229888916016
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.518 Vali Acc: 0.786 Test Loss: 0.518 Test Acc: 0.786
Validation loss decreased (-0.774561 --> -0.786122).  Saving model ...
Epoch: 21 cost time: 5.8388543128967285
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.775 Test Loss: 0.519 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.397594213485718
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.775 Test Loss: 0.519 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.6613781452178955
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.792 Test Loss: 0.520 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 24 cost time: 5.964825630187988
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.792 Test Loss: 0.514 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 25 cost time: 5.479269981384277
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.798 Test Loss: 0.504 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 26 cost time: 6.168384790420532
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.786 Test Loss: 0.505 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.418264150619507
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
Validation loss decreased (-0.797683 --> -0.803463).  Saving model ...
Epoch: 28 cost time: 5.566309928894043
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.792 Test Loss: 0.505 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.298234701156616
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.786 Test Loss: 0.506 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.9618823528289795
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.792 Test Loss: 0.510 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.994520425796509
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.786 Test Loss: 0.517 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.179804801940918
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.792 Test Loss: 0.512 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.554074048995972
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.792 Test Loss: 0.511 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.986191272735596
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.792 Test Loss: 0.512 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.03427267074585
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.792 Test Loss: 0.509 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.716802358627319
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.792 Test Loss: 0.511 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.064352512359619
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.022621870040894
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 6.6931116580963135
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.283030033111572
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.089584112167358
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.737521648406982
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.052320241928101
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.154757261276245
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.746904134750366
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.947 Vali Acc: 0.133 Test Loss: 1.947 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.849757671356201
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.137938499450684
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.495500564575195
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15606936416184972
model parameter : 1202823
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.821650266647339
Epoch: 1, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.643 Vali Acc: 0.277 Test Loss: 1.643 Test Acc: 0.277
Validation loss decreased (inf --> -0.277440).  Saving model ...
Epoch: 2 cost time: 6.2481889724731445
Epoch: 2, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.210 Vali Acc: 0.630 Test Loss: 1.210 Test Acc: 0.630
Validation loss decreased (-0.277440 --> -0.630046).  Saving model ...
Epoch: 3 cost time: 5.758727550506592
Epoch: 3, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.105 Vali Acc: 0.601 Test Loss: 1.105 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.02210545539856
Epoch: 4, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.828 Vali Acc: 0.792 Test Loss: 0.828 Test Acc: 0.792
Validation loss decreased (-0.630046 --> -0.791899).  Saving model ...
Epoch: 5 cost time: 6.453138828277588
Epoch: 5, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
Validation loss decreased (-0.791899 --> -0.815022).  Saving model ...
Epoch: 6 cost time: 6.833441495895386
Epoch: 6, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.481 Vali Acc: 0.838 Test Loss: 0.481 Test Acc: 0.838
Validation loss decreased (-0.815022 --> -0.838145).  Saving model ...
Epoch: 7 cost time: 6.695078372955322
Epoch: 7, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.457 Vali Acc: 0.838 Test Loss: 0.457 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838146).  Saving model ...
Epoch: 8 cost time: 6.200040340423584
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.457 Vali Acc: 0.832 Test Loss: 0.457 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.5547990798950195
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
Validation loss decreased (-0.838146 --> -0.855487).  Saving model ...
Epoch: 10 cost time: 6.257952690124512
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.178067207336426
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.998894691467285
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.446425437927246
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.440 Vali Acc: 0.838 Test Loss: 0.440 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.900020122528076
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.832 Test Loss: 0.433 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.570961236953735
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.652176380157471
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.838 Test Loss: 0.438 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.654646158218384
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.922120571136475
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.92259955406189
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.844 Test Loss: 0.448 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.733497619628906
Epoch: 1, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.671 Vali Acc: 0.306 Test Loss: 1.671 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 6.397118806838989
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.232 Vali Acc: 0.584 Test Loss: 1.232 Test Acc: 0.584
Validation loss decreased (-0.306342 --> -0.583803).  Saving model ...
Epoch: 3 cost time: 5.861485481262207
Epoch: 3, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.076 Vali Acc: 0.613 Test Loss: 1.076 Test Acc: 0.613
Validation loss decreased (-0.583803 --> -0.612706).  Saving model ...
Epoch: 4 cost time: 6.411753416061401
Epoch: 4, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.820 Vali Acc: 0.728 Test Loss: 0.820 Test Acc: 0.728
Validation loss decreased (-0.612706 --> -0.728315).  Saving model ...
Epoch: 5 cost time: 6.550331115722656
Epoch: 5, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.601 Vali Acc: 0.792 Test Loss: 0.601 Test Acc: 0.792
Validation loss decreased (-0.728315 --> -0.791902).  Saving model ...
Epoch: 6 cost time: 6.694555997848511
Epoch: 6, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
Validation loss decreased (-0.791902 --> -0.843926).  Saving model ...
Epoch: 7 cost time: 6.565999269485474
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 8 cost time: 6.7742109298706055
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.443 Vali Acc: 0.850 Test Loss: 0.443 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.798607349395752
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.260251522064209
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.437 Vali Acc: 0.844 Test Loss: 0.437 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.90120792388916
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.453 Vali Acc: 0.850 Test Loss: 0.453 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.598312616348267
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.195577383041382
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.543541193008423
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.467 Vali Acc: 0.844 Test Loss: 0.467 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.13506293296814
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.273810386657715
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.932023048400879
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.651684761047363
Epoch: 1, Steps: 17 | Train Loss: 1.987 Vali Loss: 1.785 Vali Acc: 0.254 Test Loss: 1.785 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 6.525614500045776
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.340 Vali Acc: 0.520 Test Loss: 1.340 Test Acc: 0.520
Validation loss decreased (-0.254317 --> -0.520218).  Saving model ...
Epoch: 3 cost time: 5.912243843078613
Epoch: 3, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.082 Vali Acc: 0.618 Test Loss: 1.082 Test Acc: 0.618
Validation loss decreased (-0.520218 --> -0.618486).  Saving model ...
Epoch: 4 cost time: 6.201075553894043
Epoch: 4, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.869 Vali Acc: 0.688 Test Loss: 0.869 Test Acc: 0.688
Validation loss decreased (-0.618486 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 6.811858177185059
Epoch: 5, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.627 Vali Acc: 0.769 Test Loss: 0.627 Test Acc: 0.769
Validation loss decreased (-0.687853 --> -0.768780).  Saving model ...
Epoch: 6 cost time: 5.534011363983154
Epoch: 6, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.551 Vali Acc: 0.798 Test Loss: 0.551 Test Acc: 0.798
Validation loss decreased (-0.768780 --> -0.797682).  Saving model ...
Epoch: 7 cost time: 6.448053359985352
Epoch: 7, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.475 Vali Acc: 0.798 Test Loss: 0.475 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797683).  Saving model ...
Epoch: 8 cost time: 6.794374704360962
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.464 Vali Acc: 0.792 Test Loss: 0.464 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.950460195541382
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.443 Vali Acc: 0.821 Test Loss: 0.443 Test Acc: 0.821
Validation loss decreased (-0.797683 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 6.428920269012451
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.685193061828613
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.456 Vali Acc: 0.815 Test Loss: 0.456 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.542771100997925
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.450 Vali Acc: 0.815 Test Loss: 0.450 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.262218236923218
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.457 Vali Acc: 0.798 Test Loss: 0.457 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.8424155712127686
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.023923397064209
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.815 Test Loss: 0.459 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.171292066574097
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.388304948806763
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.738302707672119
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.299386978149414
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.271871328353882
Epoch: 1, Steps: 17 | Train Loss: 2.019 Vali Loss: 1.853 Vali Acc: 0.237 Test Loss: 1.853 Test Acc: 0.237
Validation loss decreased (inf --> -0.236976).  Saving model ...
Epoch: 2 cost time: 5.9808385372161865
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.480 Vali Acc: 0.526 Test Loss: 1.480 Test Acc: 0.526
Validation loss decreased (-0.236976 --> -0.525997).  Saving model ...
Epoch: 3 cost time: 5.8296120166778564
Epoch: 3, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.133 Vali Acc: 0.688 Test Loss: 1.133 Test Acc: 0.688
Validation loss decreased (-0.525997 --> -0.687850).  Saving model ...
Epoch: 4 cost time: 5.736508131027222
Epoch: 4, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.917 Vali Acc: 0.688 Test Loss: 0.917 Test Acc: 0.688
Validation loss decreased (-0.687850 --> -0.687852).  Saving model ...
Epoch: 5 cost time: 5.186047315597534
Epoch: 5, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
Validation loss decreased (-0.687852 --> -0.809242).  Saving model ...
Epoch: 6 cost time: 5.523448467254639
Epoch: 6, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.843051433563232
Epoch: 7, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.509 Vali Acc: 0.775 Test Loss: 0.509 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.735212326049805
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.618181467056274
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.482 Vali Acc: 0.821 Test Loss: 0.482 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820804).  Saving model ...
Epoch: 10 cost time: 5.541457653045654
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.360433578491211
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.473 Vali Acc: 0.815 Test Loss: 0.473 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.512551307678223
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.472 Vali Acc: 0.815 Test Loss: 0.472 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.045134782791138
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.815 Test Loss: 0.475 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.637410402297974
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.560441017150879
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.664917707443237
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.753646373748779
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.939733028411865
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.158951997756958
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.407797336578369
Epoch: 1, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.929 Vali Acc: 0.173 Test Loss: 1.929 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 5.583689212799072
Epoch: 2, Steps: 17 | Train Loss: 1.736 Vali Loss: 1.688 Vali Acc: 0.434 Test Loss: 1.688 Test Acc: 0.434
Validation loss decreased (-0.173391 --> -0.433509).  Saving model ...
Epoch: 3 cost time: 6.181218862533569
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.416 Vali Acc: 0.590 Test Loss: 1.416 Test Acc: 0.590
Validation loss decreased (-0.433509 --> -0.589581).  Saving model ...
Epoch: 4 cost time: 6.2362470626831055
Epoch: 4, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.193 Vali Acc: 0.624 Test Loss: 1.193 Test Acc: 0.624
Validation loss decreased (-0.589581 --> -0.624266).  Saving model ...
Epoch: 5 cost time: 5.870560884475708
Epoch: 5, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.931 Vali Acc: 0.699 Test Loss: 0.931 Test Acc: 0.699
Validation loss decreased (-0.624266 --> -0.699413).  Saving model ...
Epoch: 6 cost time: 6.095204830169678
Epoch: 6, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.744 Vali Acc: 0.751 Test Loss: 0.744 Test Acc: 0.751
Validation loss decreased (-0.699413 --> -0.751438).  Saving model ...
Epoch: 7 cost time: 5.634084224700928
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.656 Vali Acc: 0.751 Test Loss: 0.656 Test Acc: 0.751
Validation loss decreased (-0.751438 --> -0.751439).  Saving model ...
Epoch: 8 cost time: 5.6896748542785645
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.590 Vali Acc: 0.798 Test Loss: 0.590 Test Acc: 0.798
Validation loss decreased (-0.751439 --> -0.797682).  Saving model ...
Epoch: 9 cost time: 5.806436061859131
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.578 Vali Acc: 0.786 Test Loss: 0.578 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.680263042449951
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.562 Vali Acc: 0.821 Test Loss: 0.562 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820804).  Saving model ...
Epoch: 11 cost time: 5.681790590286255
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.556 Vali Acc: 0.792 Test Loss: 0.556 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.852469444274902
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.117851495742798
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.551 Vali Acc: 0.798 Test Loss: 0.551 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.995416879653931
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.177454710006714
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.798 Test Loss: 0.538 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.421072721481323
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.951906204223633
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.798 Test Loss: 0.534 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.469411849975586
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.68381404876709
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.728255748748779
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.530 Vali Acc: 0.798 Test Loss: 0.530 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.394491672515869
Epoch: 1, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.953 Vali Acc: 0.191 Test Loss: 1.953 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 6.071012258529663
Epoch: 2, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.789 Vali Acc: 0.358 Test Loss: 1.789 Test Acc: 0.358
Validation loss decreased (-0.190732 --> -0.358364).  Saving model ...
Epoch: 3 cost time: 5.815512180328369
Epoch: 3, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.584 Vali Acc: 0.538 Test Loss: 1.584 Test Acc: 0.538
Validation loss decreased (-0.358364 --> -0.537556).  Saving model ...
Epoch: 4 cost time: 5.976552486419678
Epoch: 4, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.381 Vali Acc: 0.590 Test Loss: 1.381 Test Acc: 0.590
Validation loss decreased (-0.537556 --> -0.589582).  Saving model ...
Epoch: 5 cost time: 5.852186441421509
Epoch: 5, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.147 Vali Acc: 0.665 Test Loss: 1.147 Test Acc: 0.665
Validation loss decreased (-0.589582 --> -0.664728).  Saving model ...
Epoch: 6 cost time: 5.6538190841674805
Epoch: 6, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.941 Vali Acc: 0.688 Test Loss: 0.941 Test Acc: 0.688
Validation loss decreased (-0.664728 --> -0.687852).  Saving model ...
Epoch: 7 cost time: 5.570681095123291
Epoch: 7, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.781 Vali Acc: 0.705 Test Loss: 0.781 Test Acc: 0.705
Validation loss decreased (-0.687852 --> -0.705194).  Saving model ...
Epoch: 8 cost time: 5.261167526245117
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.747 Vali Acc: 0.699 Test Loss: 0.747 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.032097101211548
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.707 Vali Acc: 0.728 Test Loss: 0.707 Test Acc: 0.728
Validation loss decreased (-0.705194 --> -0.728317).  Saving model ...
Epoch: 10 cost time: 5.59127950668335
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.685 Vali Acc: 0.734 Test Loss: 0.685 Test Acc: 0.734
Validation loss decreased (-0.728317 --> -0.734097).  Saving model ...
Epoch: 11 cost time: 5.659005641937256
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.734097 --> -0.762999).  Saving model ...
Epoch: 12 cost time: 5.4848809242248535
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.681 Vali Acc: 0.728 Test Loss: 0.681 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.594350099563599
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.673 Vali Acc: 0.723 Test Loss: 0.673 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.897681951522827
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.666 Vali Acc: 0.728 Test Loss: 0.666 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.880483150482178
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.670 Vali Acc: 0.723 Test Loss: 0.670 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.933662176132202
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.734 Test Loss: 0.660 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.028414487838745
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.734 Test Loss: 0.654 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.136740684509277
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.656 Vali Acc: 0.723 Test Loss: 0.656 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.719122409820557
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.657 Vali Acc: 0.723 Test Loss: 0.657 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.069108963012695
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.734 Test Loss: 0.654 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.653125047683716
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.740 Test Loss: 0.652 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.052841663360596
Epoch: 1, Steps: 17 | Train Loss: 2.021 Vali Loss: 1.943 Vali Acc: 0.168 Test Loss: 1.943 Test Acc: 0.168
Validation loss decreased (inf --> -0.167611).  Saving model ...
Epoch: 2 cost time: 6.313385248184204
Epoch: 2, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.816 Vali Acc: 0.306 Test Loss: 1.816 Test Acc: 0.306
Validation loss decreased (-0.167611 --> -0.306340).  Saving model ...
Epoch: 3 cost time: 6.854170083999634
Epoch: 3, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.635 Vali Acc: 0.462 Test Loss: 1.635 Test Acc: 0.462
Validation loss decreased (-0.306340 --> -0.462411).  Saving model ...
Epoch: 4 cost time: 7.137712001800537
Epoch: 4, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.450 Vali Acc: 0.578 Test Loss: 1.450 Test Acc: 0.578
Validation loss decreased (-0.462411 --> -0.578020).  Saving model ...
Epoch: 5 cost time: 6.996692180633545
Epoch: 5, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.243 Vali Acc: 0.624 Test Loss: 1.243 Test Acc: 0.624
Validation loss decreased (-0.578020 --> -0.624265).  Saving model ...
Epoch: 6 cost time: 6.383868217468262
Epoch: 6, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.055 Vali Acc: 0.659 Test Loss: 1.055 Test Acc: 0.659
Validation loss decreased (-0.624265 --> -0.658949).  Saving model ...
Epoch: 7 cost time: 6.065026760101318
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.909 Vali Acc: 0.694 Test Loss: 0.909 Test Acc: 0.694
Validation loss decreased (-0.658949 --> -0.693633).  Saving model ...
Epoch: 8 cost time: 6.097869873046875
Epoch: 8, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.805 Vali Acc: 0.699 Test Loss: 0.805 Test Acc: 0.699
Validation loss decreased (-0.693633 --> -0.699414).  Saving model ...
Epoch: 9 cost time: 5.955766201019287
Epoch: 9, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.712 Vali Acc: 0.728 Test Loss: 0.712 Test Acc: 0.728
Validation loss decreased (-0.699414 --> -0.728317).  Saving model ...
Epoch: 10 cost time: 5.909452199935913
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
Validation loss decreased (-0.728317 --> -0.745658).  Saving model ...
Epoch: 11 cost time: 6.798426151275635
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 12 cost time: 6.703039646148682
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 13 cost time: 6.350229740142822
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.643 Vali Acc: 0.734 Test Loss: 0.643 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.473406791687012
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.751 Test Loss: 0.608 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751439).  Saving model ...
Epoch: 15 cost time: 6.1445512771606445
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.610 Vali Acc: 0.746 Test Loss: 0.610 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.912050008773804
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 17 cost time: 5.795515060424805
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757220).  Saving model ...
Epoch: 18 cost time: 5.684311389923096
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 19 cost time: 5.9409050941467285
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.590 Vali Acc: 0.734 Test Loss: 0.590 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.007611274719238
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 21 cost time: 6.156334400177002
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
Validation loss decreased (-0.757220 --> -0.763000).  Saving model ...
Epoch: 22 cost time: 5.783353567123413
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 23 cost time: 6.160881280899048
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.769 Test Loss: 0.577 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 24 cost time: 5.978378057479858
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.769 Test Loss: 0.569 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 25 cost time: 6.027874231338501
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.769 Test Loss: 0.565 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 26 cost time: 6.384300470352173
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.769 Test Loss: 0.561 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768781).  Saving model ...
Epoch: 27 cost time: 6.122934818267822
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.769 Test Loss: 0.562 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.414426565170288
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.208621263504028
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.489088296890259
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.769 Test Loss: 0.553 Test Acc: 0.769
Validation loss decreased (-0.768781 --> -0.768781).  Saving model ...
Epoch: 31 cost time: 5.626383066177368
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.848565578460693
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.769 Test Loss: 0.554 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.9574949741363525
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.769 Test Loss: 0.553 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.065677642822266
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.780 Test Loss: 0.545 Test Acc: 0.780
Validation loss decreased (-0.768781 --> -0.780341).  Saving model ...
Epoch: 35 cost time: 6.138899564743042
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.780 Test Loss: 0.540 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 36 cost time: 6.821948528289795
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.15032434463501
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.775 Test Loss: 0.547 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 6.787214756011963
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.775 Test Loss: 0.545 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.905392408370972
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.780 Test Loss: 0.549 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.644222021102905
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 5.730223655700684
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.775 Test Loss: 0.546 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 6.029978513717651
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.786 Test Loss: 0.544 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 43 cost time: 5.663519382476807
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.780 Test Loss: 0.549 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.681227922439575
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.780 Test Loss: 0.553 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 6.511000871658325
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.786 Test Loss: 0.547 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 6.215574741363525
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.792 Test Loss: 0.544 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 47 cost time: 5.5756516456604
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.792 Test Loss: 0.543 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 48 cost time: 5.913650274276733
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.792 Test Loss: 0.546 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.99009108543396
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.792 Test Loss: 0.543 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 50 cost time: 5.909210681915283
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.792 Test Loss: 0.537 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 51 cost time: 5.576234579086304
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.792 Test Loss: 0.540 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.356898307800293
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.786 Test Loss: 0.543 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.392771005630493
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.798 Test Loss: 0.545 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 54 cost time: 6.694219350814819
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 55 cost time: 6.1409547328948975
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.792 Test Loss: 0.542 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 6.559128999710083
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.786 Test Loss: 0.543 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 6.414210557937622
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.786 Test Loss: 0.540 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 6.039119243621826
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.798 Test Loss: 0.538 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 6.782236814498901
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 60 cost time: 5.58459997177124
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 5.540107250213623
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.792 Test Loss: 0.540 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 5.892709255218506
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 6.502448797225952
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.798 Test Loss: 0.543 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 6.245846271514893
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 65 cost time: 5.922169208526611
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 66 cost time: 6.373991250991821
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 6.378271818161011
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.929209232330322
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.815 Test Loss: 0.545 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 69 cost time: 5.955634593963623
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 6.575208902359009
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 6.435083627700806
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.798 Test Loss: 0.550 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 5.928654193878174
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 5.97953462600708
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.792 Test Loss: 0.554 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 5.269585132598877
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 5.257406711578369
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 5.859485626220703
Epoch: 76, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 6.321065425872803
Epoch: 77, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 6.436541557312012
Epoch: 78, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.538178443908691
Epoch: 1, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.957 Vali Acc: 0.220 Test Loss: 1.957 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 6.120821475982666
Epoch: 2, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.840 Vali Acc: 0.289 Test Loss: 1.840 Test Acc: 0.289
Validation loss decreased (-0.219634 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 5.875861644744873
Epoch: 3, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.678 Vali Acc: 0.457 Test Loss: 1.678 Test Acc: 0.457
Validation loss decreased (-0.288999 --> -0.456631).  Saving model ...
Epoch: 4 cost time: 6.416580438613892
Epoch: 4, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.506 Vali Acc: 0.526 Test Loss: 1.506 Test Acc: 0.526
Validation loss decreased (-0.456631 --> -0.525996).  Saving model ...
Epoch: 5 cost time: 6.3273375034332275
Epoch: 5, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.284 Vali Acc: 0.595 Test Loss: 1.284 Test Acc: 0.595
Validation loss decreased (-0.525996 --> -0.595363).  Saving model ...
Epoch: 6 cost time: 6.164520025253296
Epoch: 6, Steps: 17 | Train Loss: 0.833 Vali Loss: 1.098 Vali Acc: 0.618 Test Loss: 1.098 Test Acc: 0.618
Validation loss decreased (-0.595363 --> -0.618486).  Saving model ...
Epoch: 7 cost time: 6.066007137298584
Epoch: 7, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.925 Vali Acc: 0.671 Test Loss: 0.925 Test Acc: 0.671
Validation loss decreased (-0.618486 --> -0.670511).  Saving model ...
Epoch: 8 cost time: 6.022772550582886
Epoch: 8, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.777 Vali Acc: 0.705 Test Loss: 0.777 Test Acc: 0.705
Validation loss decreased (-0.670511 --> -0.705195).  Saving model ...
Epoch: 9 cost time: 6.281530141830444
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.688 Vali Acc: 0.728 Test Loss: 0.688 Test Acc: 0.728
Validation loss decreased (-0.705195 --> -0.728317).  Saving model ...
Epoch: 10 cost time: 5.994903802871704
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.639 Vali Acc: 0.740 Test Loss: 0.639 Test Acc: 0.740
Validation loss decreased (-0.728317 --> -0.739878).  Saving model ...
Epoch: 11 cost time: 6.199286699295044
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.619 Vali Acc: 0.740 Test Loss: 0.619 Test Acc: 0.740
Validation loss decreased (-0.739878 --> -0.739878).  Saving model ...
Epoch: 12 cost time: 5.931601524353027
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.615 Vali Acc: 0.769 Test Loss: 0.615 Test Acc: 0.769
Validation loss decreased (-0.739878 --> -0.768780).  Saving model ...
Epoch: 13 cost time: 6.066324234008789
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.3687310218811035
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774561).  Saving model ...
Epoch: 15 cost time: 5.636937856674194
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.591 Vali Acc: 0.780 Test Loss: 0.591 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 16 cost time: 5.815016746520996
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.585 Vali Acc: 0.780 Test Loss: 0.585 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 17 cost time: 5.608260631561279
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.582 Vali Acc: 0.780 Test Loss: 0.582 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 18 cost time: 6.166239976882935
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.1894800662994385
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.303144216537476
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.575 Vali Acc: 0.769 Test Loss: 0.575 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.304641485214233
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.786 Test Loss: 0.579 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 22 cost time: 5.900728702545166
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.798 Test Loss: 0.576 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797682).  Saving model ...
Epoch: 23 cost time: 5.648446798324585
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.798 Test Loss: 0.572 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797682).  Saving model ...
Epoch: 24 cost time: 5.8422956466674805
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.714248895645142
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.792 Test Loss: 0.576 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.233980894088745
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.798 Test Loss: 0.573 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.051255941390991
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797682).  Saving model ...
Epoch: 28 cost time: 6.058921575546265
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.792 Test Loss: 0.578 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.774525880813599
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803462).  Saving model ...
Epoch: 30 cost time: 5.878667831420898
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.897103309631348
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.798 Test Loss: 0.574 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.703242063522339
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809243).  Saving model ...
Epoch: 33 cost time: 5.654416561126709
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.798 Test Loss: 0.582 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.00648832321167
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.798 Test Loss: 0.576 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.745850324630737
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.721957206726074
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.815 Test Loss: 0.575 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 37 cost time: 5.4401469230651855
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.537554502487183
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.798 Test Loss: 0.573 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.5916032791137695
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.798 Test Loss: 0.578 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 6.021098852157593
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.798 Test Loss: 0.581 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.9187986850738525
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.798 Test Loss: 0.584 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 6.403926134109497
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.786 Test Loss: 0.591 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 6.120999813079834
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.786 Test Loss: 0.589 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 6.38556432723999
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 5.436005592346191
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 5.4348485469818115
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.798 Test Loss: 0.593 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.006444692611694
Epoch: 1, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.942 Vali Acc: 0.214 Test Loss: 1.942 Test Acc: 0.214
Validation loss decreased (inf --> -0.213853).  Saving model ...
Epoch: 2 cost time: 5.918094635009766
Epoch: 2, Steps: 17 | Train Loss: 1.859 Vali Loss: 1.819 Vali Acc: 0.306 Test Loss: 1.819 Test Acc: 0.306
Validation loss decreased (-0.213853 --> -0.306340).  Saving model ...
Epoch: 3 cost time: 6.228384971618652
Epoch: 3, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.646 Vali Acc: 0.451 Test Loss: 1.646 Test Acc: 0.451
Validation loss decreased (-0.306340 --> -0.450851).  Saving model ...
Epoch: 4 cost time: 5.85343861579895
Epoch: 4, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.470 Vali Acc: 0.549 Test Loss: 1.470 Test Acc: 0.549
Validation loss decreased (-0.450851 --> -0.549118).  Saving model ...
Epoch: 5 cost time: 5.919239282608032
Epoch: 5, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.244 Vali Acc: 0.613 Test Loss: 1.244 Test Acc: 0.613
Validation loss decreased (-0.549118 --> -0.612704).  Saving model ...
Epoch: 6 cost time: 6.429524898529053
Epoch: 6, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.047 Vali Acc: 0.688 Test Loss: 1.047 Test Acc: 0.688
Validation loss decreased (-0.612704 --> -0.687851).  Saving model ...
Epoch: 7 cost time: 5.568920612335205
Epoch: 7, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.878 Vali Acc: 0.717 Test Loss: 0.878 Test Acc: 0.717
Validation loss decreased (-0.687851 --> -0.716754).  Saving model ...
Epoch: 8 cost time: 5.828786373138428
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
Validation loss decreased (-0.716754 --> -0.757218).  Saving model ...
Epoch: 9 cost time: 5.800906658172607
Epoch: 9, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
Validation loss decreased (-0.757218 --> -0.774560).  Saving model ...
Epoch: 10 cost time: 6.017751216888428
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.133800983428955
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803462).  Saving model ...
Epoch: 12 cost time: 5.9499311447143555
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.581 Vali Acc: 0.792 Test Loss: 0.581 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.45034646987915
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.563 Vali Acc: 0.792 Test Loss: 0.563 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.423650741577148
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.533811807632446
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 16 cost time: 5.55725359916687
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 17 cost time: 5.754647493362427
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.532 Vali Acc: 0.815 Test Loss: 0.532 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815024).  Saving model ...
Epoch: 18 cost time: 6.577687978744507
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.972766876220703
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.089993953704834
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.310790538787842
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 22 cost time: 5.648015260696411
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.667505979537964
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.840024471282959
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.798 Test Loss: 0.520 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.9562904834747314
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.786 Test Loss: 0.526 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.661903142929077
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.519 Vali Acc: 0.792 Test Loss: 0.519 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.135287761688232
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.798 Test Loss: 0.510 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 6.61584210395813
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.798 Test Loss: 0.516 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.229438066482544
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.01689338684082
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.008550643920898
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.798 Test Loss: 0.518 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.813889026641846
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.945 Vali Acc: 0.156 Test Loss: 1.945 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 5.560523986816406
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.7018091678619385
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.947356224060059
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.830381155014038
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.794930458068848
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.417494297027588
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.467764139175415
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.9169745445251465
Epoch: 9, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.662867546081543
Epoch: 10, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.484388828277588
Epoch: 11, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15606936416184972
model parameter : 809607
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.2726686000823975
Epoch: 1, Steps: 17 | Train Loss: 1.858 Vali Loss: 1.626 Vali Acc: 0.301 Test Loss: 1.626 Test Acc: 0.301
Validation loss decreased (inf --> -0.300562).  Saving model ...
Epoch: 2 cost time: 5.182204961776733
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.219 Vali Acc: 0.549 Test Loss: 1.219 Test Acc: 0.549
Validation loss decreased (-0.300562 --> -0.549121).  Saving model ...
Epoch: 3 cost time: 5.513796329498291
Epoch: 3, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.057 Vali Acc: 0.613 Test Loss: 1.057 Test Acc: 0.613
Validation loss decreased (-0.549121 --> -0.612706).  Saving model ...
Epoch: 4 cost time: 5.547066926956177
Epoch: 4, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.845 Vali Acc: 0.723 Test Loss: 0.845 Test Acc: 0.723
Validation loss decreased (-0.612706 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 6.1268696784973145
Epoch: 5, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.726 Vali Acc: 0.682 Test Loss: 0.726 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.769732475280762
Epoch: 6, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
Validation loss decreased (-0.722535 --> -0.832365).  Saving model ...
Epoch: 7 cost time: 5.926207542419434
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.496 Vali Acc: 0.827 Test Loss: 0.496 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.762622594833374
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.436 Vali Acc: 0.861 Test Loss: 0.436 Test Acc: 0.861
Validation loss decreased (-0.832365 --> -0.861267).  Saving model ...
Epoch: 9 cost time: 5.587071657180786
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.463 Vali Acc: 0.821 Test Loss: 0.463 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.213326454162598
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.399 Vali Acc: 0.861 Test Loss: 0.399 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861268).  Saving model ...
Epoch: 11 cost time: 5.340403079986572
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.408 Vali Acc: 0.838 Test Loss: 0.408 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.10202169418335
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.756777048110962
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.408 Vali Acc: 0.838 Test Loss: 0.408 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.995335340499878
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.6763856410980225
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.838 Test Loss: 0.417 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.765879154205322
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.844 Test Loss: 0.425 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.496187210083008
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.827 Test Loss: 0.426 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.496203660964966
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.945037126541138
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.838 Test Loss: 0.432 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.051812171936035
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.950953960418701
Epoch: 1, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.675 Vali Acc: 0.266 Test Loss: 1.675 Test Acc: 0.266
Validation loss decreased (inf --> -0.265879).  Saving model ...
Epoch: 2 cost time: 5.736956596374512
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.250 Vali Acc: 0.526 Test Loss: 1.250 Test Acc: 0.526
Validation loss decreased (-0.265879 --> -0.525999).  Saving model ...
Epoch: 3 cost time: 6.151219844818115
Epoch: 3, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.023 Vali Acc: 0.618 Test Loss: 1.023 Test Acc: 0.618
Validation loss decreased (-0.525999 --> -0.618487).  Saving model ...
Epoch: 4 cost time: 5.981006860733032
Epoch: 4, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.812 Vali Acc: 0.757 Test Loss: 0.812 Test Acc: 0.757
Validation loss decreased (-0.618487 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 6.510186433792114
Epoch: 5, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.808917284011841
Epoch: 6, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.504 Vali Acc: 0.827 Test Loss: 0.504 Test Acc: 0.827
Validation loss decreased (-0.757217 --> -0.826585).  Saving model ...
Epoch: 7 cost time: 5.7911882400512695
Epoch: 7, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.445 Vali Acc: 0.861 Test Loss: 0.445 Test Acc: 0.861
Validation loss decreased (-0.826585 --> -0.861267).  Saving model ...
Epoch: 8 cost time: 5.783275604248047
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.419 Vali Acc: 0.827 Test Loss: 0.419 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.211015462875366
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.400 Vali Acc: 0.855 Test Loss: 0.400 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.934499502182007
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.009061098098755
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.844 Test Loss: 0.405 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.480116128921509
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.490236282348633
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.410 Vali Acc: 0.844 Test Loss: 0.410 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.254746437072754
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.413 Vali Acc: 0.838 Test Loss: 0.413 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.055168151855469
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.851482391357422
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.967482805252075
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.844 Test Loss: 0.423 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.827826023101807
Epoch: 1, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.745 Vali Acc: 0.301 Test Loss: 1.745 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 5.976804733276367
Epoch: 2, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.319 Vali Acc: 0.520 Test Loss: 1.319 Test Acc: 0.520
Validation loss decreased (-0.300561 --> -0.520218).  Saving model ...
Epoch: 3 cost time: 6.586324691772461
Epoch: 3, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.049 Vali Acc: 0.647 Test Loss: 1.049 Test Acc: 0.647
Validation loss decreased (-0.520218 --> -0.647388).  Saving model ...
Epoch: 4 cost time: 6.724673748016357
Epoch: 4, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.820 Vali Acc: 0.757 Test Loss: 0.820 Test Acc: 0.757
Validation loss decreased (-0.647388 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 6.48112940788269
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.679 Vali Acc: 0.728 Test Loss: 0.679 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.011791229248047
Epoch: 6, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.518 Vali Acc: 0.798 Test Loss: 0.518 Test Acc: 0.798
Validation loss decreased (-0.757217 --> -0.797683).  Saving model ...
Epoch: 7 cost time: 6.234365701675415
Epoch: 7, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.493 Vali Acc: 0.775 Test Loss: 0.493 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.656165361404419
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.458 Vali Acc: 0.832 Test Loss: 0.458 Test Acc: 0.832
Validation loss decreased (-0.797683 --> -0.832365).  Saving model ...
Epoch: 9 cost time: 6.079786777496338
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.449 Vali Acc: 0.792 Test Loss: 0.449 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.212250709533691
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.455 Vali Acc: 0.815 Test Loss: 0.455 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.354155778884888
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 5.483440160751343
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.452 Vali Acc: 0.803 Test Loss: 0.452 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.769023895263672
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.452 Vali Acc: 0.803 Test Loss: 0.452 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.732568264007568
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.815 Test Loss: 0.455 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.360592365264893
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.0821380615234375
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.466 Vali Acc: 0.798 Test Loss: 0.466 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.068133354187012
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.798 Test Loss: 0.471 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.905709981918335
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.468 Vali Acc: 0.798 Test Loss: 0.468 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.749356031417847
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.558233261108398
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.194532155990601
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.574775695800781
Epoch: 1, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.817 Vali Acc: 0.272 Test Loss: 1.817 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 6.001517057418823
Epoch: 2, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.451 Vali Acc: 0.497 Test Loss: 1.451 Test Acc: 0.497
Validation loss decreased (-0.271658 --> -0.497095).  Saving model ...
Epoch: 3 cost time: 6.115192174911499
Epoch: 3, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.133 Vali Acc: 0.618 Test Loss: 1.133 Test Acc: 0.618
Validation loss decreased (-0.497095 --> -0.618486).  Saving model ...
Epoch: 4 cost time: 6.140638828277588
Epoch: 4, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.853 Vali Acc: 0.780 Test Loss: 0.853 Test Acc: 0.780
Validation loss decreased (-0.618486 --> -0.780338).  Saving model ...
Epoch: 5 cost time: 6.1841881275177
Epoch: 5, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.672 Vali Acc: 0.775 Test Loss: 0.672 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.747661590576172
Epoch: 6, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
Validation loss decreased (-0.780338 --> -0.849706).  Saving model ...
Epoch: 7 cost time: 6.0397584438323975
Epoch: 7, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.457 Vali Acc: 0.873 Test Loss: 0.457 Test Acc: 0.873
Validation loss decreased (-0.849706 --> -0.872828).  Saving model ...
Epoch: 8 cost time: 5.646306276321411
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.425 Vali Acc: 0.838 Test Loss: 0.425 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.407878637313843
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.408 Vali Acc: 0.873 Test Loss: 0.408 Test Acc: 0.873
Validation loss decreased (-0.872828 --> -0.872828).  Saving model ...
Epoch: 10 cost time: 6.147213697433472
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.407 Vali Acc: 0.850 Test Loss: 0.407 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.980871200561523
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.873 Test Loss: 0.400 Test Acc: 0.873
Validation loss decreased (-0.872828 --> -0.872828).  Saving model ...
Epoch: 12 cost time: 6.072686433792114
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.392 Vali Acc: 0.861 Test Loss: 0.392 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.858295202255249
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.391 Vali Acc: 0.867 Test Loss: 0.391 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.569488763809204
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.390 Vali Acc: 0.867 Test Loss: 0.390 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.719217777252197
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.873 Test Loss: 0.388 Test Acc: 0.873
Validation loss decreased (-0.872828 --> -0.872828).  Saving model ...
Epoch: 16 cost time: 5.652807950973511
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.8069422245025635
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.861 Test Loss: 0.385 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.548706293106079
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.873 Test Loss: 0.384 Test Acc: 0.873
Validation loss decreased (-0.872828 --> -0.872829).  Saving model ...
Epoch: 19 cost time: 5.959556341171265
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.873 Test Loss: 0.385 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.028080701828003
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.257973670959473
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.873 Test Loss: 0.386 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.332436800003052
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.383021354675293
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.37659764289856
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.873 Test Loss: 0.385 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.157039403915405
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.385 Vali Acc: 0.873 Test Loss: 0.385 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.965926885604858
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.873 Test Loss: 0.386 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.703253746032715
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.873 Test Loss: 0.387 Test Acc: 0.873
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.720779180526733
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.873 Test Loss: 0.388 Test Acc: 0.873
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.417807579040527
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.899 Vali Acc: 0.202 Test Loss: 1.899 Test Acc: 0.202
Validation loss decreased (inf --> -0.202293).  Saving model ...
Epoch: 2 cost time: 4.965953826904297
Epoch: 2, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.667 Vali Acc: 0.422 Test Loss: 1.667 Test Acc: 0.422
Validation loss decreased (-0.202293 --> -0.421949).  Saving model ...
Epoch: 3 cost time: 5.525990724563599
Epoch: 3, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.439 Vali Acc: 0.549 Test Loss: 1.439 Test Acc: 0.549
Validation loss decreased (-0.421949 --> -0.549119).  Saving model ...
Epoch: 4 cost time: 5.449390649795532
Epoch: 4, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.149 Vali Acc: 0.699 Test Loss: 1.149 Test Acc: 0.699
Validation loss decreased (-0.549119 --> -0.699410).  Saving model ...
Epoch: 5 cost time: 5.796931028366089
Epoch: 5, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.934 Vali Acc: 0.688 Test Loss: 0.934 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.895528793334961
Epoch: 6, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.747 Vali Acc: 0.763 Test Loss: 0.747 Test Acc: 0.763
Validation loss decreased (-0.699410 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 5.5248777866363525
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.639 Vali Acc: 0.780 Test Loss: 0.639 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780340).  Saving model ...
Epoch: 8 cost time: 5.344353199005127
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.581 Vali Acc: 0.821 Test Loss: 0.581 Test Acc: 0.821
Validation loss decreased (-0.780340 --> -0.820803).  Saving model ...
Epoch: 9 cost time: 5.428152322769165
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
Validation loss decreased (-0.820803 --> -0.838145).  Saving model ...
Epoch: 10 cost time: 5.944664478302002
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 11 cost time: 6.114285469055176
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.838 Test Loss: 0.524 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 12 cost time: 5.357415199279785
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 5.435326814651489
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.509 Vali Acc: 0.832 Test Loss: 0.509 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.180522918701172
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.498 Vali Acc: 0.838 Test Loss: 0.498 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 15 cost time: 5.976313829421997
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.832 Test Loss: 0.501 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.856264114379883
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.844 Test Loss: 0.491 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 5.826929330825806
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.838 Test Loss: 0.491 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.765381097793579
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
Validation loss decreased (-0.843926 --> -0.855486).  Saving model ...
Epoch: 19 cost time: 5.638258457183838
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.758060455322266
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.827 Test Loss: 0.481 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.059921026229858
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.299844980239868
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.827 Test Loss: 0.475 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.118863821029663
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.17151665687561
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.815 Test Loss: 0.475 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.0506250858306885
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.251369953155518
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.821 Test Loss: 0.470 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.708517789840698
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.832 Test Loss: 0.471 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.834925889968872
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.821 Test Loss: 0.469 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.670415878295898
Epoch: 1, Steps: 17 | Train Loss: 1.968 Vali Loss: 1.927 Vali Acc: 0.191 Test Loss: 1.927 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 6.0546555519104
Epoch: 2, Steps: 17 | Train Loss: 1.810 Vali Loss: 1.744 Vali Acc: 0.358 Test Loss: 1.744 Test Acc: 0.358
Validation loss decreased (-0.190732 --> -0.358364).  Saving model ...
Epoch: 3 cost time: 5.756752014160156
Epoch: 3, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.586 Vali Acc: 0.405 Test Loss: 1.586 Test Acc: 0.405
Validation loss decreased (-0.358364 --> -0.404608).  Saving model ...
Epoch: 4 cost time: 5.429316997528076
Epoch: 4, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.345 Vali Acc: 0.688 Test Loss: 1.345 Test Acc: 0.688
Validation loss decreased (-0.404608 --> -0.687848).  Saving model ...
Epoch: 5 cost time: 5.093621015548706
Epoch: 5, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.158 Vali Acc: 0.665 Test Loss: 1.158 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.445823431015015
Epoch: 6, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.965 Vali Acc: 0.705 Test Loss: 0.965 Test Acc: 0.705
Validation loss decreased (-0.687848 --> -0.705193).  Saving model ...
Epoch: 7 cost time: 5.802740573883057
Epoch: 7, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
Validation loss decreased (-0.705193 --> -0.728316).  Saving model ...
Epoch: 8 cost time: 5.566170930862427
Epoch: 8, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.780 Vali Acc: 0.699 Test Loss: 0.780 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.065111875534058
Epoch: 9, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.677 Vali Acc: 0.763 Test Loss: 0.677 Test Acc: 0.763
Validation loss decreased (-0.728316 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 5.146561861038208
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.705 Vali Acc: 0.728 Test Loss: 0.705 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.9729132652282715
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.648 Vali Acc: 0.740 Test Loss: 0.648 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.2595603466033936
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.639 Vali Acc: 0.763 Test Loss: 0.639 Test Acc: 0.763
Validation loss decreased (-0.762999 --> -0.762999).  Saving model ...
Epoch: 13 cost time: 6.302778959274292
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.747035026550293
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
Validation loss decreased (-0.762999 --> -0.762999).  Saving model ...
Epoch: 15 cost time: 5.595043420791626
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.80605673789978
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.780 Test Loss: 0.618 Test Acc: 0.780
Validation loss decreased (-0.762999 --> -0.780341).  Saving model ...
Epoch: 17 cost time: 5.9119954109191895
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.617 Vali Acc: 0.769 Test Loss: 0.617 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.982370138168335
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 19 cost time: 5.9034411907196045
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.604 Vali Acc: 0.780 Test Loss: 0.604 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 20 cost time: 5.34341835975647
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.769 Test Loss: 0.608 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.412857532501221
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.780 Test Loss: 0.603 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 22 cost time: 6.072292804718018
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.598 Vali Acc: 0.780 Test Loss: 0.598 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 23 cost time: 6.3882975578308105
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
Validation loss decreased (-0.780341 --> -0.809243).  Saving model ...
Epoch: 24 cost time: 6.3696393966674805
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 25 cost time: 6.128213882446289
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.798 Test Loss: 0.581 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.265711069107056
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.786 Test Loss: 0.582 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.542682886123657
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.584 Vali Acc: 0.786 Test Loss: 0.584 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.5091753005981445
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.286581039428711
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.798 Test Loss: 0.574 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.207265853881836
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.798 Test Loss: 0.573 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.776870489120483
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.798 Test Loss: 0.571 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.063201904296875
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.798 Test Loss: 0.567 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.262495994567871
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.798 Test Loss: 0.564 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.223257064819336
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.815 Test Loss: 0.559 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 35 cost time: 6.883234024047852
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.234992027282715
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.792 Test Loss: 0.563 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.6394877433776855
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 6.176053047180176
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.792 Test Loss: 0.555 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 6.0942418575286865
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.866288900375366
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.698123455047607
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.786 Test Loss: 0.551 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.20671534538269
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.786 Test Loss: 0.550 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 5.8152854442596436
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.786 Test Loss: 0.547 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 6.149614095687866
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.798 Test Loss: 0.547 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.940832614898682
Epoch: 1, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.967 Vali Acc: 0.150 Test Loss: 1.967 Test Acc: 0.150
Validation loss decreased (inf --> -0.150269).  Saving model ...
Epoch: 2 cost time: 6.295476675033569
Epoch: 2, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.836 Vali Acc: 0.312 Test Loss: 1.836 Test Acc: 0.312
Validation loss decreased (-0.150269 --> -0.312120).  Saving model ...
Epoch: 3 cost time: 6.122263193130493
Epoch: 3, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.671 Vali Acc: 0.422 Test Loss: 1.671 Test Acc: 0.422
Validation loss decreased (-0.312120 --> -0.421949).  Saving model ...
Epoch: 4 cost time: 5.764345169067383
Epoch: 4, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.480 Vali Acc: 0.566 Test Loss: 1.480 Test Acc: 0.566
Validation loss decreased (-0.421949 --> -0.566459).  Saving model ...
Epoch: 5 cost time: 6.231802463531494
Epoch: 5, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.290 Vali Acc: 0.601 Test Loss: 1.290 Test Acc: 0.601
Validation loss decreased (-0.566459 --> -0.601143).  Saving model ...
Epoch: 6 cost time: 5.956806421279907
Epoch: 6, Steps: 17 | Train Loss: 0.689 Vali Loss: 1.113 Vali Acc: 0.595 Test Loss: 1.113 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.4772467613220215
Epoch: 7, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.960 Vali Acc: 0.624 Test Loss: 0.960 Test Acc: 0.624
Validation loss decreased (-0.601143 --> -0.624268).  Saving model ...
Epoch: 8 cost time: 5.437325477600098
Epoch: 8, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.886 Vali Acc: 0.630 Test Loss: 0.886 Test Acc: 0.630
Validation loss decreased (-0.624268 --> -0.630049).  Saving model ...
Epoch: 9 cost time: 5.825120449066162
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.743 Vali Acc: 0.746 Test Loss: 0.743 Test Acc: 0.746
Validation loss decreased (-0.630049 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 6.1030800342559814
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.754 Vali Acc: 0.676 Test Loss: 0.754 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.238157749176025
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.678 Vali Acc: 0.751 Test Loss: 0.678 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751438).  Saving model ...
Epoch: 12 cost time: 5.903149127960205
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.683 Vali Acc: 0.740 Test Loss: 0.683 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.851513385772705
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.659 Vali Acc: 0.746 Test Loss: 0.659 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.432693958282471
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.28183913230896
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.653 Vali Acc: 0.717 Test Loss: 0.653 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.7262585163116455
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.636 Vali Acc: 0.763 Test Loss: 0.636 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 17 cost time: 5.866960048675537
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.769 Test Loss: 0.632 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 5.8934166431427
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.327589988708496
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.603 Vali Acc: 0.792 Test Loss: 0.603 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791901).  Saving model ...
Epoch: 20 cost time: 5.360612392425537
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.786 Test Loss: 0.609 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.533544540405273
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.687997102737427
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.931227207183838
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.786 Test Loss: 0.588 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.055426836013794
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.786 Test Loss: 0.592 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.6558592319488525
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.786 Test Loss: 0.589 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.587130069732666
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.792 Test Loss: 0.589 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 27 cost time: 6.1272337436676025
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.297478437423706
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.893761873245239
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803462).  Saving model ...
Epoch: 30 cost time: 5.58128023147583
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.792 Test Loss: 0.569 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.4692301750183105
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.780 Test Loss: 0.573 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.551973581314087
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.792 Test Loss: 0.565 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.148219347000122
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809243).  Saving model ...
Epoch: 34 cost time: 5.772633790969849
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 35 cost time: 6.363685131072998
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.798 Test Loss: 0.561 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 6.4339375495910645
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 6.387526512145996
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.803 Test Loss: 0.558 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 6.709974765777588
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 39 cost time: 7.026445627212524
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 6.391933441162109
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 41 cost time: 5.81121039390564
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 6.565383195877075
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.798 Test Loss: 0.553 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 6.585306882858276
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 6.213434934616089
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815023).  Saving model ...
Epoch: 45 cost time: 6.522298336029053
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.827 Test Loss: 0.541 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 46 cost time: 6.556279182434082
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.821 Test Loss: 0.540 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 6.511304140090942
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.821 Test Loss: 0.541 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 6.335941553115845
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 6.700303792953491
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.827 Test Loss: 0.536 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 50 cost time: 6.097101211547852
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.827 Test Loss: 0.529 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 51 cost time: 5.9299094676971436
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.827 Test Loss: 0.530 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 6.442432641983032
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.827 Test Loss: 0.532 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 6.19756293296814
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.827 Test Loss: 0.529 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 5.7526936531066895
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.827 Test Loss: 0.527 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 55 cost time: 6.761693716049194
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.827 Test Loss: 0.526 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 56 cost time: 6.521252632141113
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.827 Test Loss: 0.524 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 57 cost time: 5.80241060256958
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.827 Test Loss: 0.522 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 58 cost time: 6.940831661224365
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.827 Test Loss: 0.522 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826584).  Saving model ...
Epoch: 59 cost time: 7.2349793910980225
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.832 Test Loss: 0.521 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832365).  Saving model ...
Epoch: 60 cost time: 6.232923746109009
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.827 Test Loss: 0.528 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 6.689000129699707
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 6.757720947265625
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.827 Test Loss: 0.528 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 6.114685297012329
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.827 Test Loss: 0.525 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 5.851010322570801
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.821 Test Loss: 0.525 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 6.8280017375946045
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.821 Test Loss: 0.524 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 6.613689422607422
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.827 Test Loss: 0.522 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 6.031652927398682
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.827 Test Loss: 0.520 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 6.909465789794922
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.821 Test Loss: 0.522 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 7.002444505691528
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.827 Test Loss: 0.520 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.52177882194519
Epoch: 1, Steps: 17 | Train Loss: 2.020 Vali Loss: 1.982 Vali Acc: 0.150 Test Loss: 1.982 Test Acc: 0.150
Validation loss decreased (inf --> -0.150269).  Saving model ...
Epoch: 2 cost time: 6.85293984413147
Epoch: 2, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.866 Vali Acc: 0.249 Test Loss: 1.866 Test Acc: 0.249
Validation loss decreased (-0.150269 --> -0.248536).  Saving model ...
Epoch: 3 cost time: 6.501728773117065
Epoch: 3, Steps: 17 | Train Loss: 1.645 Vali Loss: 1.702 Vali Acc: 0.387 Test Loss: 1.702 Test Acc: 0.387
Validation loss decreased (-0.248536 --> -0.387266).  Saving model ...
Epoch: 4 cost time: 5.724553823471069
Epoch: 4, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.516 Vali Acc: 0.561 Test Loss: 1.516 Test Acc: 0.561
Validation loss decreased (-0.387266 --> -0.560678).  Saving model ...
Epoch: 5 cost time: 6.474819660186768
Epoch: 5, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.310 Vali Acc: 0.624 Test Loss: 1.310 Test Acc: 0.624
Validation loss decreased (-0.560678 --> -0.624264).  Saving model ...
Epoch: 6 cost time: 6.7321953773498535
Epoch: 6, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.112 Vali Acc: 0.636 Test Loss: 1.112 Test Acc: 0.636
Validation loss decreased (-0.624264 --> -0.635827).  Saving model ...
Epoch: 7 cost time: 5.3602821826934814
Epoch: 7, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.931 Vali Acc: 0.636 Test Loss: 0.931 Test Acc: 0.636
Validation loss decreased (-0.635827 --> -0.635829).  Saving model ...
Epoch: 8 cost time: 5.4100987911224365
Epoch: 8, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.797 Vali Acc: 0.705 Test Loss: 0.797 Test Acc: 0.705
Validation loss decreased (-0.635829 --> -0.705194).  Saving model ...
Epoch: 9 cost time: 5.638788938522339
Epoch: 9, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.687 Vali Acc: 0.723 Test Loss: 0.687 Test Acc: 0.723
Validation loss decreased (-0.705194 --> -0.722536).  Saving model ...
Epoch: 10 cost time: 5.627641201019287
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.3260862827301025
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.617 Vali Acc: 0.740 Test Loss: 0.617 Test Acc: 0.740
Validation loss decreased (-0.722536 --> -0.739878).  Saving model ...
Epoch: 12 cost time: 6.295814275741577
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.620 Vali Acc: 0.734 Test Loss: 0.620 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.643390655517578
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.607 Vali Acc: 0.734 Test Loss: 0.607 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.171342611312866
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.604 Vali Acc: 0.740 Test Loss: 0.604 Test Acc: 0.740
Validation loss decreased (-0.739878 --> -0.739878).  Saving model ...
Epoch: 15 cost time: 5.820699453353882
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.588 Vali Acc: 0.751 Test Loss: 0.588 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751439).  Saving model ...
Epoch: 16 cost time: 5.385621786117554
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.598 Vali Acc: 0.734 Test Loss: 0.598 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.2011401653289795
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.605 Vali Acc: 0.751 Test Loss: 0.605 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.823788166046143
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.608 Vali Acc: 0.740 Test Loss: 0.608 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.193743467330933
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.2296812534332275
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.585 Vali Acc: 0.751 Test Loss: 0.585 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 21 cost time: 6.104217529296875
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.584 Vali Acc: 0.751 Test Loss: 0.584 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 22 cost time: 5.65570855140686
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.359191179275513
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.233443737030029
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.999201059341431
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
Validation loss decreased (-0.751439 --> -0.763000).  Saving model ...
Epoch: 26 cost time: 5.895374059677124
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.769 Test Loss: 0.580 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 27 cost time: 6.359753608703613
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.063037633895874
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.424625396728516
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.104161262512207
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.011213779449463
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.763 Test Loss: 0.588 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.261636972427368
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.091626405715942
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.769 Test Loss: 0.601 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.637395143508911
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.780 Test Loss: 0.596 Test Acc: 0.780
Validation loss decreased (-0.768780 --> -0.780341).  Saving model ...
Epoch: 35 cost time: 5.762182712554932
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.780 Test Loss: 0.592 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 36 cost time: 5.764941453933716
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.1000165939331055
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.933826446533203
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.786 Test Loss: 0.585 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 39 cost time: 6.092485189437866
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.786 Test Loss: 0.580 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 40 cost time: 6.1619367599487305
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.587 Vali Acc: 0.769 Test Loss: 0.587 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.45276665687561
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.780 Test Loss: 0.590 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.27360987663269
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.769 Test Loss: 0.603 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 6.202639818191528
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.780 Test Loss: 0.596 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.75602650642395
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.691203355789185
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 6.228317022323608
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.780 Test Loss: 0.614 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 5.907592535018921
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.775 Test Loss: 0.611 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 5.558218240737915
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 6.194678783416748
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.36124849319458
Epoch: 1, Steps: 17 | Train Loss: 2.016 Vali Loss: 1.969 Vali Acc: 0.116 Test Loss: 1.969 Test Acc: 0.116
Validation loss decreased (inf --> -0.115587).  Saving model ...
Epoch: 2 cost time: 5.309922933578491
Epoch: 2, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.848 Vali Acc: 0.260 Test Loss: 1.848 Test Acc: 0.260
Validation loss decreased (-0.115587 --> -0.260097).  Saving model ...
Epoch: 3 cost time: 4.887183427810669
Epoch: 3, Steps: 17 | Train Loss: 1.643 Vali Loss: 1.690 Vali Acc: 0.445 Test Loss: 1.690 Test Acc: 0.445
Validation loss decreased (-0.260097 --> -0.445070).  Saving model ...
Epoch: 4 cost time: 5.256491184234619
Epoch: 4, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.499 Vali Acc: 0.578 Test Loss: 1.499 Test Acc: 0.578
Validation loss decreased (-0.445070 --> -0.578020).  Saving model ...
Epoch: 5 cost time: 5.2134528160095215
Epoch: 5, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.291 Vali Acc: 0.618 Test Loss: 1.291 Test Acc: 0.618
Validation loss decreased (-0.578020 --> -0.618484).  Saving model ...
Epoch: 6 cost time: 5.734547138214111
Epoch: 6, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.080 Vali Acc: 0.653 Test Loss: 1.080 Test Acc: 0.653
Validation loss decreased (-0.618484 --> -0.653168).  Saving model ...
Epoch: 7 cost time: 5.929559946060181
Epoch: 7, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.898 Vali Acc: 0.682 Test Loss: 0.898 Test Acc: 0.682
Validation loss decreased (-0.653168 --> -0.682072).  Saving model ...
Epoch: 8 cost time: 5.6709513664245605
Epoch: 8, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.774 Vali Acc: 0.734 Test Loss: 0.774 Test Acc: 0.734
Validation loss decreased (-0.682072 --> -0.734096).  Saving model ...
Epoch: 9 cost time: 6.2669594287872314
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
Validation loss decreased (-0.734096 --> -0.751438).  Saving model ...
Epoch: 10 cost time: 6.49278712272644
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.632 Vali Acc: 0.705 Test Loss: 0.632 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.729300260543823
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.36767578125
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.601 Vali Acc: 0.751 Test Loss: 0.601 Test Acc: 0.751
Validation loss decreased (-0.751438 --> -0.751439).  Saving model ...
Epoch: 13 cost time: 6.278414726257324
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.734 Test Loss: 0.599 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.747810363769531
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.576 Vali Acc: 0.734 Test Loss: 0.576 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.027253866195679
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 16 cost time: 6.1981353759765625
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.734 Test Loss: 0.581 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.478166580200195
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.852306127548218
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.969883918762207
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.277215003967285
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.323502779006958
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.967988014221191
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 23 cost time: 5.488486051559448
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 24 cost time: 6.129859685897827
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.646753311157227
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.042037487030029
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.012782096862793
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.734 Test Loss: 0.570 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.137104272842407
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.728 Test Loss: 0.570 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.882593154907227
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.734 Test Loss: 0.569 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.101983308792114
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.734 Test Loss: 0.572 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.228508472442627
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.734 Test Loss: 0.571 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.070488214492798
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.740 Test Loss: 0.569 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.50113320350647
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.740 Test Loss: 0.580 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.294293642044067
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 6.558576583862305
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.309535503387451
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.173 Test Loss: 1.946 Test Acc: 0.173
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.7192230224609375
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.502552032470703
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.206975936889648
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.424389600753784
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.895371913909912
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.323178768157959
Epoch: 9, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.692000865936279
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.994304895401001
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.17341040462427745
model parameter : 612999
model size : 4.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.961029529571533
Epoch: 1, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.699 Vali Acc: 0.249 Test Loss: 1.699 Test Acc: 0.249
Validation loss decreased (inf --> -0.248538).  Saving model ...
Epoch: 2 cost time: 5.619839668273926
Epoch: 2, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.238 Vali Acc: 0.538 Test Loss: 1.238 Test Acc: 0.538
Validation loss decreased (-0.248538 --> -0.537560).  Saving model ...
Epoch: 3 cost time: 5.7052271366119385
Epoch: 3, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.030 Vali Acc: 0.653 Test Loss: 1.030 Test Acc: 0.653
Validation loss decreased (-0.537560 --> -0.653169).  Saving model ...
Epoch: 4 cost time: 5.475459575653076
Epoch: 4, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.872 Vali Acc: 0.688 Test Loss: 0.872 Test Acc: 0.688
Validation loss decreased (-0.653169 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 5.36983585357666
Epoch: 5, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.674 Vali Acc: 0.792 Test Loss: 0.674 Test Acc: 0.792
Validation loss decreased (-0.687853 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 5.01286244392395
Epoch: 6, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 5.000760078430176
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.149163484573364
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.517 Vali Acc: 0.815 Test Loss: 0.517 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815024).  Saving model ...
Epoch: 9 cost time: 5.574628114700317
Epoch: 9, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.795744180679321
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.504 Vali Acc: 0.798 Test Loss: 0.504 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.476612567901611
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.487 Vali Acc: 0.798 Test Loss: 0.487 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.623816013336182
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.489 Vali Acc: 0.803 Test Loss: 0.489 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.515344619750977
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.5836122035980225
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.827 Test Loss: 0.489 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826585).  Saving model ...
Epoch: 15 cost time: 5.418619632720947
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.238621234893799
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838145).  Saving model ...
Epoch: 17 cost time: 5.331426620483398
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.1434431076049805
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.991430282592773
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.520975351333618
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.512 Vali Acc: 0.827 Test Loss: 0.512 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.505822420120239
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.815 Test Loss: 0.507 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.423398971557617
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.821 Test Loss: 0.505 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.422652721405029
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.326685190200806
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.815 Test Loss: 0.516 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.44033408164978
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.821 Test Loss: 0.519 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.614602088928223
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.821 Test Loss: 0.525 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.005664587020874
Epoch: 1, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.732 Vali Acc: 0.237 Test Loss: 1.732 Test Acc: 0.237
Validation loss decreased (inf --> -0.236977).  Saving model ...
Epoch: 2 cost time: 5.667815446853638
Epoch: 2, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.277 Vali Acc: 0.520 Test Loss: 1.277 Test Acc: 0.520
Validation loss decreased (-0.236977 --> -0.520218).  Saving model ...
Epoch: 3 cost time: 5.4640793800354
Epoch: 3, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.023 Vali Acc: 0.688 Test Loss: 1.023 Test Acc: 0.688
Validation loss decreased (-0.520218 --> -0.687851).  Saving model ...
Epoch: 4 cost time: 5.795982122421265
Epoch: 4, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.865 Vali Acc: 0.647 Test Loss: 0.865 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.802775621414185
Epoch: 5, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
Validation loss decreased (-0.687851 --> -0.803461).  Saving model ...
Epoch: 6 cost time: 5.707207202911377
Epoch: 6, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 5.703544616699219
Epoch: 7, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.468 Vali Acc: 0.827 Test Loss: 0.468 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826585).  Saving model ...
Epoch: 8 cost time: 5.910336017608643
Epoch: 8, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.74266791343689
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.249365568161011
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.426 Vali Acc: 0.821 Test Loss: 0.426 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.23134970664978
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.423 Vali Acc: 0.815 Test Loss: 0.423 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.147089004516602
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.432 Vali Acc: 0.821 Test Loss: 0.432 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.419387578964233
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.436 Vali Acc: 0.821 Test Loss: 0.436 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.573427438735962
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.437 Vali Acc: 0.832 Test Loss: 0.437 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832366).  Saving model ...
Epoch: 15 cost time: 5.33034348487854
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.832 Test Loss: 0.436 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 16 cost time: 5.231178283691406
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.838 Test Loss: 0.437 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 17 cost time: 5.340523958206177
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.798 Test Loss: 0.445 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.1994054317474365
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.446 Vali Acc: 0.815 Test Loss: 0.446 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.139182806015015
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.827 Test Loss: 0.440 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.6555540561676025
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.815 Test Loss: 0.446 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.356205463409424
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.827 Test Loss: 0.442 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.42198920249939
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.838 Test Loss: 0.446 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.47580099105835
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.815 Test Loss: 0.451 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.343310117721558
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.815 Test Loss: 0.450 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.357450723648071
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.827 Test Loss: 0.454 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.4116387367248535
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.459 Vali Acc: 0.827 Test Loss: 0.459 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.673226594924927
Epoch: 1, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.782 Vali Acc: 0.260 Test Loss: 1.782 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 5.389944314956665
Epoch: 2, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.355 Vali Acc: 0.514 Test Loss: 1.355 Test Acc: 0.514
Validation loss decreased (-0.260098 --> -0.514437).  Saving model ...
Epoch: 3 cost time: 5.311146259307861
Epoch: 3, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.068 Vali Acc: 0.671 Test Loss: 1.068 Test Acc: 0.671
Validation loss decreased (-0.514437 --> -0.670510).  Saving model ...
Epoch: 4 cost time: 5.7097766399383545
Epoch: 4, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.898 Vali Acc: 0.659 Test Loss: 0.898 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.396390438079834
Epoch: 5, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
Validation loss decreased (-0.670510 --> -0.797681).  Saving model ...
Epoch: 6 cost time: 5.576486110687256
Epoch: 6, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.762446165084839
Epoch: 7, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.495 Vali Acc: 0.763 Test Loss: 0.495 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.691036224365234
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.518 Vali Acc: 0.775 Test Loss: 0.518 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.978497743606567
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.508 Vali Acc: 0.763 Test Loss: 0.508 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.3436479568481445
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.493 Vali Acc: 0.780 Test Loss: 0.493 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.397011756896973
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.503 Vali Acc: 0.769 Test Loss: 0.503 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.301805019378662
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.763 Test Loss: 0.501 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.47027063369751
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.769 Test Loss: 0.502 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.197306156158447
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.506 Vali Acc: 0.763 Test Loss: 0.506 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.610304355621338
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.769 Test Loss: 0.507 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.019579172134399
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.835 Vali Acc: 0.225 Test Loss: 1.835 Test Acc: 0.225
Validation loss decreased (inf --> -0.225415).  Saving model ...
Epoch: 2 cost time: 5.807436227798462
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.465 Vali Acc: 0.503 Test Loss: 1.465 Test Acc: 0.503
Validation loss decreased (-0.225415 --> -0.502876).  Saving model ...
Epoch: 3 cost time: 5.255900144577026
Epoch: 3, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.161 Vali Acc: 0.613 Test Loss: 1.161 Test Acc: 0.613
Validation loss decreased (-0.502876 --> -0.612705).  Saving model ...
Epoch: 4 cost time: 5.004335403442383
Epoch: 4, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.903 Vali Acc: 0.717 Test Loss: 0.903 Test Acc: 0.717
Validation loss decreased (-0.612705 --> -0.716754).  Saving model ...
Epoch: 5 cost time: 5.358176231384277
Epoch: 5, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.707 Vali Acc: 0.792 Test Loss: 0.707 Test Acc: 0.792
Validation loss decreased (-0.716754 --> -0.791900).  Saving model ...
Epoch: 6 cost time: 5.359712839126587
Epoch: 6, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.568 Vali Acc: 0.832 Test Loss: 0.568 Test Acc: 0.832
Validation loss decreased (-0.791900 --> -0.832364).  Saving model ...
Epoch: 7 cost time: 5.586969375610352
Epoch: 7, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.490 Vali Acc: 0.815 Test Loss: 0.490 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.192731618881226
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.461 Vali Acc: 0.815 Test Loss: 0.461 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.582886457443237
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.444 Vali Acc: 0.832 Test Loss: 0.444 Test Acc: 0.832
Validation loss decreased (-0.832364 --> -0.832365).  Saving model ...
Epoch: 10 cost time: 5.646796226501465
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.439 Vali Acc: 0.821 Test Loss: 0.439 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.528939962387085
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.441 Vali Acc: 0.815 Test Loss: 0.441 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.67865514755249
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.436 Vali Acc: 0.821 Test Loss: 0.436 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.184273958206177
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.821 Test Loss: 0.431 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.759286403656006
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.428 Vali Acc: 0.821 Test Loss: 0.428 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.493602275848389
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.430 Vali Acc: 0.832 Test Loss: 0.430 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832366).  Saving model ...
Epoch: 16 cost time: 5.556867837905884
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.832 Test Loss: 0.431 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.445529460906982
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.429 Vali Acc: 0.827 Test Loss: 0.429 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.205861568450928
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.832 Test Loss: 0.430 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 19 cost time: 5.516402244567871
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.832 Test Loss: 0.426 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 20 cost time: 6.082857608795166
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.832 Test Loss: 0.428 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.94211745262146
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.424 Vali Acc: 0.832 Test Loss: 0.424 Test Acc: 0.832
Validation loss decreased (-0.832366 --> -0.832366).  Saving model ...
Epoch: 22 cost time: 6.362687349319458
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.832 Test Loss: 0.425 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.512116432189941
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.832 Test Loss: 0.428 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.002077102661133
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.832 Test Loss: 0.429 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.893721342086792
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.838 Test Loss: 0.428 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 26 cost time: 5.814417600631714
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.838 Test Loss: 0.428 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.5505211353302
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.832 Test Loss: 0.430 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.908191680908203
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.832 Test Loss: 0.432 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.4897730350494385
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.832 Test Loss: 0.434 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.522007465362549
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.832 Test Loss: 0.434 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.537534713745117
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 32 cost time: 6.036831855773926
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849707).  Saving model ...
Epoch: 33 cost time: 5.849151611328125
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.259734869003296
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 5.607162714004517
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.43269157409668
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.844 Test Loss: 0.436 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 5.586443662643433
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 5.798514366149902
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 5.3320417404174805
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.850 Test Loss: 0.437 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 5.6943678855896
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.850 Test Loss: 0.435 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 5.612205743789673
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.844 Test Loss: 0.438 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 6.08495831489563
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.844 Test Loss: 0.441 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.581533670425415
Epoch: 1, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.935 Vali Acc: 0.237 Test Loss: 1.935 Test Acc: 0.237
Validation loss decreased (inf --> -0.236975).  Saving model ...
Epoch: 2 cost time: 6.436955690383911
Epoch: 2, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.685 Vali Acc: 0.382 Test Loss: 1.685 Test Acc: 0.382
Validation loss decreased (-0.236975 --> -0.381486).  Saving model ...
Epoch: 3 cost time: 5.683274745941162
Epoch: 3, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.444 Vali Acc: 0.514 Test Loss: 1.444 Test Acc: 0.514
Validation loss decreased (-0.381486 --> -0.514436).  Saving model ...
Epoch: 4 cost time: 5.301739931106567
Epoch: 4, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.183 Vali Acc: 0.647 Test Loss: 1.183 Test Acc: 0.647
Validation loss decreased (-0.514436 --> -0.647387).  Saving model ...
Epoch: 5 cost time: 5.705589532852173
Epoch: 5, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.931 Vali Acc: 0.717 Test Loss: 0.931 Test Acc: 0.717
Validation loss decreased (-0.647387 --> -0.716754).  Saving model ...
Epoch: 6 cost time: 5.579604387283325
Epoch: 6, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.785 Vali Acc: 0.723 Test Loss: 0.785 Test Acc: 0.723
Validation loss decreased (-0.716754 --> -0.722536).  Saving model ...
Epoch: 7 cost time: 5.6941680908203125
Epoch: 7, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.655 Vali Acc: 0.792 Test Loss: 0.655 Test Acc: 0.792
Validation loss decreased (-0.722536 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 6.503030061721802
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.595 Vali Acc: 0.775 Test Loss: 0.595 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.200834035873413
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809243).  Saving model ...
Epoch: 10 cost time: 6.129701137542725
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.558 Vali Acc: 0.798 Test Loss: 0.558 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.142903566360474
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.554 Vali Acc: 0.798 Test Loss: 0.554 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.596223831176758
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 5.769026041030884
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 14 cost time: 5.4329304695129395
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 5.915205478668213
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 16 cost time: 5.571205139160156
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 17 cost time: 5.600767374038696
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 18 cost time: 5.429529190063477
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 19 cost time: 5.536241292953491
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809243).  Saving model ...
Epoch: 20 cost time: 5.861604928970337
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809244).  Saving model ...
Epoch: 21 cost time: 5.931037902832031
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.815 Test Loss: 0.500 Test Acc: 0.815
Validation loss decreased (-0.809244 --> -0.815024).  Saving model ...
Epoch: 22 cost time: 5.862014532089233
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.821 Test Loss: 0.496 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 23 cost time: 5.8609278202056885
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.967299461364746
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.158493518829346
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.815 Test Loss: 0.493 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.950176954269409
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.815 Test Loss: 0.491 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.39331579208374
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.815 Test Loss: 0.489 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.222106218338013
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.815 Test Loss: 0.488 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.413125991821289
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.815 Test Loss: 0.488 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.098812580108643
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.815 Test Loss: 0.487 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.931863307952881
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.821 Test Loss: 0.485 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 32 cost time: 5.7686004638671875
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.815 Test Loss: 0.483 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.7970874309539795
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.815 Test Loss: 0.483 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.9091105461120605
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.688652992248535
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.815 Test Loss: 0.481 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 6.018120050430298
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.815 Test Loss: 0.481 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.3815672397613525
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.815 Test Loss: 0.480 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 5.513767957687378
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.815 Test Loss: 0.478 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.855814695358276
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.815 Test Loss: 0.476 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 5.744511365890503
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.815 Test Loss: 0.475 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 5.979779958724976
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.821 Test Loss: 0.476 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 42 cost time: 6.18470025062561
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.821 Test Loss: 0.477 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 6.253504753112793
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.821 Test Loss: 0.475 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820805).  Saving model ...
Epoch: 44 cost time: 5.911626815795898
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.821 Test Loss: 0.475 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 6.191131114959717
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.821 Test Loss: 0.475 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 6.364382266998291
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
Validation loss decreased (-0.820805 --> -0.820805).  Saving model ...
Epoch: 47 cost time: 6.479419469833374
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 6.242509603500366
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.821 Test Loss: 0.474 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 6.280013561248779
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
Validation loss decreased (-0.820805 --> -0.820805).  Saving model ...
Epoch: 50 cost time: 5.802915573120117
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
Validation loss decreased (-0.820805 --> -0.820805).  Saving model ...
Epoch: 51 cost time: 5.774700403213501
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.815 Test Loss: 0.472 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.49232029914856
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.815 Test Loss: 0.471 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.515183925628662
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.821 Test Loss: 0.471 Test Acc: 0.821
Validation loss decreased (-0.820805 --> -0.820805).  Saving model ...
Epoch: 54 cost time: 5.261367559432983
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.821 Test Loss: 0.471 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 5.645947456359863
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.815 Test Loss: 0.470 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 5.764614582061768
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.815 Test Loss: 0.471 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 5.846012353897095
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.815 Test Loss: 0.472 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 5.754909992218018
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.815 Test Loss: 0.470 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 5.924933195114136
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.815 Test Loss: 0.469 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 6.140258550643921
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.815 Test Loss: 0.471 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 5.872089624404907
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.815 Test Loss: 0.470 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 5.779168128967285
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.815 Test Loss: 0.470 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 5.870931148529053
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.815 Test Loss: 0.469 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.797771215438843
Epoch: 1, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.952 Vali Acc: 0.173 Test Loss: 1.952 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 5.695863962173462
Epoch: 2, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.782 Vali Acc: 0.318 Test Loss: 1.782 Test Acc: 0.318
Validation loss decreased (-0.173391 --> -0.317901).  Saving model ...
Epoch: 3 cost time: 5.44491720199585
Epoch: 3, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.589 Vali Acc: 0.486 Test Loss: 1.589 Test Acc: 0.486
Validation loss decreased (-0.317901 --> -0.485533).  Saving model ...
Epoch: 4 cost time: 5.609589099884033
Epoch: 4, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.376 Vali Acc: 0.590 Test Loss: 1.376 Test Acc: 0.590
Validation loss decreased (-0.485533 --> -0.589582).  Saving model ...
Epoch: 5 cost time: 5.413062334060669
Epoch: 5, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.143 Vali Acc: 0.647 Test Loss: 1.143 Test Acc: 0.647
Validation loss decreased (-0.589582 --> -0.647387).  Saving model ...
Epoch: 6 cost time: 5.565309047698975
Epoch: 6, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.983 Vali Acc: 0.636 Test Loss: 0.983 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.8884971141815186
Epoch: 7, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.820 Vali Acc: 0.699 Test Loss: 0.820 Test Acc: 0.699
Validation loss decreased (-0.647387 --> -0.699414).  Saving model ...
Epoch: 8 cost time: 5.419161081314087
Epoch: 8, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.723 Vali Acc: 0.694 Test Loss: 0.723 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.024555683135986
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.707 Vali Acc: 0.659 Test Loss: 0.707 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.0943827629089355
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.685 Vali Acc: 0.688 Test Loss: 0.685 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.195349931716919
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.672 Vali Acc: 0.705 Test Loss: 0.672 Test Acc: 0.705
Validation loss decreased (-0.699414 --> -0.705196).  Saving model ...
Epoch: 12 cost time: 5.628160238265991
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.661 Vali Acc: 0.699 Test Loss: 0.661 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.392963647842407
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.660 Vali Acc: 0.694 Test Loss: 0.660 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.466672658920288
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.644 Vali Acc: 0.699 Test Loss: 0.644 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.5389063358306885
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.644 Vali Acc: 0.699 Test Loss: 0.644 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.768207550048828
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.699 Test Loss: 0.640 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.412465333938599
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.699 Test Loss: 0.628 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.534369230270386
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.636 Vali Acc: 0.694 Test Loss: 0.636 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.475162506103516
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.631 Vali Acc: 0.699 Test Loss: 0.631 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.169301748275757
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.622 Vali Acc: 0.694 Test Loss: 0.622 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.0621373653411865
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.694 Test Loss: 0.616 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7052023121387283
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.6285974979400635
Epoch: 1, Steps: 17 | Train Loss: 2.000 Vali Loss: 2.004 Vali Acc: 0.145 Test Loss: 2.004 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 5.206387996673584
Epoch: 2, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.881 Vali Acc: 0.225 Test Loss: 1.881 Test Acc: 0.225
Validation loss decreased (-0.144489 --> -0.225415).  Saving model ...
Epoch: 3 cost time: 5.733148813247681
Epoch: 3, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.703 Vali Acc: 0.434 Test Loss: 1.703 Test Acc: 0.434
Validation loss decreased (-0.225415 --> -0.433509).  Saving model ...
Epoch: 4 cost time: 5.881867408752441
Epoch: 4, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.525 Vali Acc: 0.532 Test Loss: 1.525 Test Acc: 0.532
Validation loss decreased (-0.433509 --> -0.531777).  Saving model ...
Epoch: 5 cost time: 6.200665712356567
Epoch: 5, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.318 Vali Acc: 0.624 Test Loss: 1.318 Test Acc: 0.624
Validation loss decreased (-0.531777 --> -0.624264).  Saving model ...
Epoch: 6 cost time: 5.8161962032318115
Epoch: 6, Steps: 17 | Train Loss: 0.732 Vali Loss: 1.114 Vali Acc: 0.647 Test Loss: 1.114 Test Acc: 0.647
Validation loss decreased (-0.624264 --> -0.647388).  Saving model ...
Epoch: 7 cost time: 5.645511150360107
Epoch: 7, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.956 Vali Acc: 0.671 Test Loss: 0.956 Test Acc: 0.671
Validation loss decreased (-0.647388 --> -0.670511).  Saving model ...
Epoch: 8 cost time: 5.541056871414185
Epoch: 8, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.844 Vali Acc: 0.671 Test Loss: 0.844 Test Acc: 0.671
Validation loss decreased (-0.670511 --> -0.670512).  Saving model ...
Epoch: 9 cost time: 5.51760721206665
Epoch: 9, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.746 Vali Acc: 0.694 Test Loss: 0.746 Test Acc: 0.694
Validation loss decreased (-0.670512 --> -0.693634).  Saving model ...
Epoch: 10 cost time: 5.569242000579834
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.720 Vali Acc: 0.688 Test Loss: 0.720 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.233415842056274
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.678 Vali Acc: 0.705 Test Loss: 0.678 Test Acc: 0.705
Validation loss decreased (-0.693634 --> -0.705196).  Saving model ...
Epoch: 12 cost time: 5.1627113819122314
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.635 Vali Acc: 0.734 Test Loss: 0.635 Test Acc: 0.734
Validation loss decreased (-0.705196 --> -0.734098).  Saving model ...
Epoch: 13 cost time: 5.113957166671753
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.639 Vali Acc: 0.728 Test Loss: 0.639 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.073870658874512
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
Validation loss decreased (-0.734098 --> -0.745658).  Saving model ...
Epoch: 15 cost time: 5.586549758911133
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.613 Vali Acc: 0.751 Test Loss: 0.613 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751439).  Saving model ...
Epoch: 16 cost time: 5.587980031967163
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 17 cost time: 5.489385604858398
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 18 cost time: 5.933778524398804
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.99044394493103
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.751 Test Loss: 0.582 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.871292591094971
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757220).  Saving model ...
Epoch: 21 cost time: 5.893979549407959
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.865721225738525
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 23 cost time: 5.499714612960815
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.757 Test Loss: 0.574 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 24 cost time: 5.617985486984253
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.939130783081055
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
Validation loss decreased (-0.757220 --> -0.757220).  Saving model ...
Epoch: 26 cost time: 5.650039196014404
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.757 Test Loss: 0.571 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.4203948974609375
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.757220 --> -0.763000).  Saving model ...
Epoch: 28 cost time: 5.831773996353149
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
Validation loss decreased (-0.763000 --> -0.780341).  Saving model ...
Epoch: 29 cost time: 5.7998528480529785
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 30 cost time: 5.9862961769104
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.491928339004517
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.769 Test Loss: 0.552 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.799849510192871
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.775 Test Loss: 0.551 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.5728209018707275
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.769 Test Loss: 0.554 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.331019639968872
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.763 Test Loss: 0.552 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.535073280334473
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.769 Test Loss: 0.548 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.4473512172698975
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.780 Test Loss: 0.551 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.09285306930542
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.769 Test Loss: 0.554 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.073629140853882
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.167455196380615
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.865451812744141
Epoch: 1, Steps: 17 | Train Loss: 2.020 Vali Loss: 2.026 Vali Acc: 0.139 Test Loss: 2.026 Test Acc: 0.139
Validation loss decreased (inf --> -0.138708).  Saving model ...
Epoch: 2 cost time: 5.516499042510986
Epoch: 2, Steps: 17 | Train Loss: 1.859 Vali Loss: 1.904 Vali Acc: 0.185 Test Loss: 1.904 Test Acc: 0.185
Validation loss decreased (-0.138708 --> -0.184952).  Saving model ...
Epoch: 3 cost time: 5.638903379440308
Epoch: 3, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.752 Vali Acc: 0.370 Test Loss: 1.752 Test Acc: 0.370
Validation loss decreased (-0.184952 --> -0.369925).  Saving model ...
Epoch: 4 cost time: 5.346863508224487
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.583 Vali Acc: 0.514 Test Loss: 1.583 Test Acc: 0.514
Validation loss decreased (-0.369925 --> -0.514435).  Saving model ...
Epoch: 5 cost time: 5.289872884750366
Epoch: 5, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.376 Vali Acc: 0.572 Test Loss: 1.376 Test Acc: 0.572
Validation loss decreased (-0.514435 --> -0.572241).  Saving model ...
Epoch: 6 cost time: 5.164845943450928
Epoch: 6, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.198 Vali Acc: 0.590 Test Loss: 1.198 Test Acc: 0.590
Validation loss decreased (-0.572241 --> -0.589583).  Saving model ...
Epoch: 7 cost time: 5.426545143127441
Epoch: 7, Steps: 17 | Train Loss: 0.625 Vali Loss: 1.006 Vali Acc: 0.618 Test Loss: 1.006 Test Acc: 0.618
Validation loss decreased (-0.589583 --> -0.618487).  Saving model ...
Epoch: 8 cost time: 5.390082359313965
Epoch: 8, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.871 Vali Acc: 0.653 Test Loss: 0.871 Test Acc: 0.653
Validation loss decreased (-0.618487 --> -0.653170).  Saving model ...
Epoch: 9 cost time: 5.198162078857422
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.782 Vali Acc: 0.665 Test Loss: 0.782 Test Acc: 0.665
Validation loss decreased (-0.653170 --> -0.664732).  Saving model ...
Epoch: 10 cost time: 5.464820861816406
Epoch: 10, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.743 Vali Acc: 0.665 Test Loss: 0.743 Test Acc: 0.665
Validation loss decreased (-0.664732 --> -0.664732).  Saving model ...
Epoch: 11 cost time: 5.57518196105957
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.689 Vali Acc: 0.699 Test Loss: 0.689 Test Acc: 0.699
Validation loss decreased (-0.664732 --> -0.699415).  Saving model ...
Epoch: 12 cost time: 5.844598770141602
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.694 Vali Acc: 0.694 Test Loss: 0.694 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.539124250411987
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.678 Vali Acc: 0.694 Test Loss: 0.678 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.401658058166504
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.672 Vali Acc: 0.699 Test Loss: 0.672 Test Acc: 0.699
Validation loss decreased (-0.699415 --> -0.699415).  Saving model ...
Epoch: 15 cost time: 5.766338348388672
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.648 Vali Acc: 0.711 Test Loss: 0.648 Test Acc: 0.711
Validation loss decreased (-0.699415 --> -0.710976).  Saving model ...
Epoch: 16 cost time: 5.632910966873169
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.705 Test Loss: 0.653 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.511635065078735
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.650 Vali Acc: 0.699 Test Loss: 0.650 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.473355770111084
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.688 Test Loss: 0.650 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.318079471588135
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.705 Test Loss: 0.656 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.402718782424927
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.711 Test Loss: 0.654 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.388200044631958
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.640 Vali Acc: 0.728 Test Loss: 0.640 Test Acc: 0.728
Validation loss decreased (-0.710976 --> -0.728317).  Saving model ...
Epoch: 22 cost time: 5.157278060913086
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.640 Vali Acc: 0.734 Test Loss: 0.640 Test Acc: 0.734
Validation loss decreased (-0.728317 --> -0.734098).  Saving model ...
Epoch: 23 cost time: 5.403947830200195
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.645 Vali Acc: 0.728 Test Loss: 0.645 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.608319520950317
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.723 Test Loss: 0.651 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.69733190536499
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.723 Test Loss: 0.644 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.560760021209717
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.649 Vali Acc: 0.723 Test Loss: 0.649 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.276731967926025
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.734 Test Loss: 0.656 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.165142297744751
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.723 Test Loss: 0.654 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.206701755523682
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.667 Vali Acc: 0.728 Test Loss: 0.667 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.3801350593566895
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.728 Test Loss: 0.654 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.132134914398193
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.728 Test Loss: 0.652 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.2081382274627686
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.723 Test Loss: 0.650 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7341040462427746
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.242646932601929
Epoch: 1, Steps: 17 | Train Loss: 2.046 Vali Loss: 2.014 Vali Acc: 0.150 Test Loss: 2.014 Test Acc: 0.150
Validation loss decreased (inf --> -0.150269).  Saving model ...
Epoch: 2 cost time: 5.456061363220215
Epoch: 2, Steps: 17 | Train Loss: 1.847 Vali Loss: 1.891 Vali Acc: 0.249 Test Loss: 1.891 Test Acc: 0.249
Validation loss decreased (-0.150269 --> -0.248536).  Saving model ...
Epoch: 3 cost time: 5.361741542816162
Epoch: 3, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.742 Vali Acc: 0.399 Test Loss: 1.742 Test Acc: 0.399
Validation loss decreased (-0.248536 --> -0.398827).  Saving model ...
Epoch: 4 cost time: 5.761769771575928
Epoch: 4, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.566 Vali Acc: 0.543 Test Loss: 1.566 Test Acc: 0.543
Validation loss decreased (-0.398827 --> -0.543337).  Saving model ...
Epoch: 5 cost time: 5.322238922119141
Epoch: 5, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.346 Vali Acc: 0.618 Test Loss: 1.346 Test Acc: 0.618
Validation loss decreased (-0.543337 --> -0.618484).  Saving model ...
Epoch: 6 cost time: 5.351694822311401
Epoch: 6, Steps: 17 | Train Loss: 0.827 Vali Loss: 1.175 Vali Acc: 0.607 Test Loss: 1.175 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.158781051635742
Epoch: 7, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.971 Vali Acc: 0.624 Test Loss: 0.971 Test Acc: 0.624
Validation loss decreased (-0.618484 --> -0.624268).  Saving model ...
Epoch: 8 cost time: 5.12750244140625
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.849 Vali Acc: 0.676 Test Loss: 0.849 Test Acc: 0.676
Validation loss decreased (-0.624268 --> -0.676292).  Saving model ...
Epoch: 9 cost time: 5.173358678817749
Epoch: 9, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.767 Vali Acc: 0.688 Test Loss: 0.767 Test Acc: 0.688
Validation loss decreased (-0.676292 --> -0.687854).  Saving model ...
Epoch: 10 cost time: 5.380605220794678
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.702 Vali Acc: 0.711 Test Loss: 0.702 Test Acc: 0.711
Validation loss decreased (-0.687854 --> -0.710976).  Saving model ...
Epoch: 11 cost time: 5.318761825561523
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
Validation loss decreased (-0.710976 --> -0.716756).  Saving model ...
Epoch: 12 cost time: 5.673407316207886
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.645 Vali Acc: 0.699 Test Loss: 0.645 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.676297426223755
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.630 Vali Acc: 0.705 Test Loss: 0.630 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.589942932128906
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.626 Vali Acc: 0.711 Test Loss: 0.626 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.3820860385894775
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.705 Test Loss: 0.616 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.991586446762085
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.622 Vali Acc: 0.699 Test Loss: 0.622 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.657146453857422
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.610 Vali Acc: 0.711 Test Loss: 0.610 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.63681697845459
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.608 Vali Acc: 0.711 Test Loss: 0.608 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.50232720375061
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.615 Vali Acc: 0.711 Test Loss: 0.615 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.424915313720703
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (-0.716756 --> -0.716757).  Saving model ...
Epoch: 21 cost time: 5.410965919494629
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
Validation loss decreased (-0.716757 --> -0.716757).  Saving model ...
Epoch: 22 cost time: 5.094314098358154
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.711 Test Loss: 0.599 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.335153579711914
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.861497163772583
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.270884037017822
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.705 Test Loss: 0.599 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.394463777542114
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.594 Vali Acc: 0.711 Test Loss: 0.594 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.545022964477539
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
Validation loss decreased (-0.716757 --> -0.716757).  Saving model ...
Epoch: 28 cost time: 5.787614107131958
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.705 Test Loss: 0.597 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.672686338424683
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.2297751903533936
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.728 Test Loss: 0.599 Test Acc: 0.728
Validation loss decreased (-0.716757 --> -0.728318).  Saving model ...
Epoch: 31 cost time: 5.2511796951293945
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.723 Test Loss: 0.595 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.5430662631988525
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.723 Test Loss: 0.596 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.586994886398315
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.734 Test Loss: 0.607 Test Acc: 0.734
Validation loss decreased (-0.728318 --> -0.734098).  Saving model ...
Epoch: 34 cost time: 5.400182723999023
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 35 cost time: 5.095166206359863
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.734 Test Loss: 0.605 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.309268236160278
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.728 Test Loss: 0.605 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.646868705749512
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.728 Test Loss: 0.604 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.426520824432373
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.728 Test Loss: 0.608 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.39442777633667
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.728 Test Loss: 0.613 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.245020627975464
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.734 Test Loss: 0.619 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.5065343379974365
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.734 Test Loss: 0.607 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.973249912261963
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 43 cost time: 5.201679468154907
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.734 Test Loss: 0.600 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 44 cost time: 5.643090009689331
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.734 Test Loss: 0.603 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.664662837982178
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.734 Test Loss: 0.598 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 46 cost time: 5.292304515838623
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.734 Test Loss: 0.598 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.189594268798828
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.734 Test Loss: 0.605 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.755099773406982
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.734 Test Loss: 0.612 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 5.572168350219727
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.734 Test Loss: 0.615 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 5.703857183456421
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.734 Test Loss: 0.616 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 5.658767938613892
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.734 Test Loss: 0.620 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 5.585170030593872
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.734 Test Loss: 0.619 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 5.802192211151123
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.734 Test Loss: 0.619 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 5.493443965911865
Epoch: 54, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.734 Test Loss: 0.621 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 5.692075729370117
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.734 Test Loss: 0.630 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7341040462427746
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.259896993637085
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 6.240462779998779
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.615957975387573
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
Validation loss decreased (-0.144489 --> -0.150270).  Saving model ...
Epoch: 4 cost time: 5.588437080383301
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.538976192474365
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.345716238021851
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.150 Test Loss: 1.946 Test Acc: 0.150
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.725678443908691
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.493622541427612
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.186036109924316
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.199643850326538
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.431085109710693
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.101371765136719
Epoch: 12, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.148315191268921
Epoch: 13, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15028901734104047
model parameter : 514695
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.891709327697754
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.589 Vali Acc: 0.382 Test Loss: 1.589 Test Acc: 0.382
Validation loss decreased (inf --> -0.381487).  Saving model ...
Epoch: 2 cost time: 5.349625110626221
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.223 Vali Acc: 0.584 Test Loss: 1.223 Test Acc: 0.584
Validation loss decreased (-0.381487 --> -0.583803).  Saving model ...
Epoch: 3 cost time: 5.758124113082886
Epoch: 3, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.069 Vali Acc: 0.618 Test Loss: 1.069 Test Acc: 0.618
Validation loss decreased (-0.583803 --> -0.618486).  Saving model ...
Epoch: 4 cost time: 5.3484132289886475
Epoch: 4, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.868 Vali Acc: 0.676 Test Loss: 0.868 Test Acc: 0.676
Validation loss decreased (-0.618486 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 5.343631029129028
Epoch: 5, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.717 Vali Acc: 0.757 Test Loss: 0.717 Test Acc: 0.757
Validation loss decreased (-0.676292 --> -0.757218).  Saving model ...
Epoch: 6 cost time: 5.389976739883423
Epoch: 6, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.578 Vali Acc: 0.780 Test Loss: 0.578 Test Acc: 0.780
Validation loss decreased (-0.757218 --> -0.780341).  Saving model ...
Epoch: 7 cost time: 5.645401954650879
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
Validation loss decreased (-0.780341 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 5.493433475494385
Epoch: 8, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.37120795249939
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.495 Vali Acc: 0.798 Test Loss: 0.495 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.576982021331787
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.466 Vali Acc: 0.832 Test Loss: 0.466 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 5.450900554656982
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.466 Vali Acc: 0.832 Test Loss: 0.466 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 5.619504928588867
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.486 Vali Acc: 0.815 Test Loss: 0.486 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.8692004680633545
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.497 Vali Acc: 0.827 Test Loss: 0.497 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.640614748001099
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.472 Vali Acc: 0.821 Test Loss: 0.472 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.867438077926636
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.827 Test Loss: 0.489 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.286756753921509
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 17 cost time: 5.24392557144165
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.815 Test Loss: 0.505 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.202796220779419
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.489 Vali Acc: 0.827 Test Loss: 0.489 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.325941562652588
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.815 Test Loss: 0.507 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.393068313598633
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.974803924560547
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.821 Test Loss: 0.511 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.618853569030762
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.798 Test Loss: 0.521 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.63518214225769
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.821 Test Loss: 0.510 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.559640407562256
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.827 Test Loss: 0.520 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.8554558753967285
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.450065612792969
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.827 Test Loss: 0.522 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.241350173950195
Epoch: 1, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.649 Vali Acc: 0.376 Test Loss: 1.649 Test Acc: 0.376
Validation loss decreased (inf --> -0.375706).  Saving model ...
Epoch: 2 cost time: 5.300941705703735
Epoch: 2, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.248 Vali Acc: 0.584 Test Loss: 1.248 Test Acc: 0.584
Validation loss decreased (-0.375706 --> -0.583803).  Saving model ...
Epoch: 3 cost time: 5.203434467315674
Epoch: 3, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.057 Vali Acc: 0.647 Test Loss: 1.057 Test Acc: 0.647
Validation loss decreased (-0.583803 --> -0.647388).  Saving model ...
Epoch: 4 cost time: 5.300866603851318
Epoch: 4, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.839 Vali Acc: 0.746 Test Loss: 0.839 Test Acc: 0.746
Validation loss decreased (-0.647388 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 5.787440538406372
Epoch: 5, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.725 Vali Acc: 0.746 Test Loss: 0.725 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745657).  Saving model ...
Epoch: 6 cost time: 5.439938545227051
Epoch: 6, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.745657 --> -0.809243).  Saving model ...
Epoch: 7 cost time: 5.043047189712524
Epoch: 7, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.497 Vali Acc: 0.792 Test Loss: 0.497 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.610069751739502
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.475 Vali Acc: 0.798 Test Loss: 0.475 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.602383852005005
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.454 Vali Acc: 0.798 Test Loss: 0.454 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.418009281158447
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.449 Vali Acc: 0.809 Test Loss: 0.449 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809244).  Saving model ...
Epoch: 11 cost time: 5.401254415512085
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.452 Vali Acc: 0.815 Test Loss: 0.452 Test Acc: 0.815
Validation loss decreased (-0.809244 --> -0.815024).  Saving model ...
Epoch: 12 cost time: 5.107764720916748
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.459 Vali Acc: 0.803 Test Loss: 0.459 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.155402660369873
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.815 Test Loss: 0.459 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.437013149261475
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.453 Vali Acc: 0.815 Test Loss: 0.453 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.210912704467773
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.821 Test Loss: 0.464 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820805).  Saving model ...
Epoch: 16 cost time: 5.5073466300964355
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.803 Test Loss: 0.461 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.2574310302734375
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.798 Test Loss: 0.473 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.6301915645599365
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.939099550247192
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.815 Test Loss: 0.470 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.641246318817139
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.821 Test Loss: 0.476 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.850519180297852
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.480722904205322
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.827 Test Loss: 0.484 Test Acc: 0.827
Validation loss decreased (-0.820805 --> -0.826585).  Saving model ...
Epoch: 23 cost time: 5.245485544204712
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.815 Test Loss: 0.484 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.065759658813477
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.1388561725616455
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.827 Test Loss: 0.485 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.122736930847168
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.815 Test Loss: 0.485 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.904778957366943
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.821 Test Loss: 0.487 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.251657485961914
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.827 Test Loss: 0.486 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.376377820968628
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838145).  Saving model ...
Epoch: 30 cost time: 5.414886713027954
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.132024526596069
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.827 Test Loss: 0.499 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.502000570297241
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.827 Test Loss: 0.503 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.190855264663696
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.827 Test Loss: 0.503 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.178520679473877
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.403001070022583
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.273846864700317
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.827 Test Loss: 0.512 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.054142713546753
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.821 Test Loss: 0.507 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.171041250228882
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.827 Test Loss: 0.513 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.11532187461853
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.821 Test Loss: 0.512 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.199273586273193
Epoch: 1, Steps: 17 | Train Loss: 1.951 Vali Loss: 1.748 Vali Acc: 0.341 Test Loss: 1.748 Test Acc: 0.341
Validation loss decreased (inf --> -0.341023).  Saving model ...
Epoch: 2 cost time: 5.558864116668701
Epoch: 2, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.322 Vali Acc: 0.543 Test Loss: 1.322 Test Acc: 0.543
Validation loss decreased (-0.341023 --> -0.543339).  Saving model ...
Epoch: 3 cost time: 5.538038969039917
Epoch: 3, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
Validation loss decreased (-0.543339 --> -0.595365).  Saving model ...
Epoch: 4 cost time: 5.352666139602661
Epoch: 4, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.855 Vali Acc: 0.723 Test Loss: 0.855 Test Acc: 0.723
Validation loss decreased (-0.595365 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 5.282147407531738
Epoch: 5, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745657).  Saving model ...
Epoch: 6 cost time: 5.318828582763672
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.577 Vali Acc: 0.740 Test Loss: 0.577 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.651392936706543
Epoch: 7, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751440).  Saving model ...
Epoch: 8 cost time: 5.329721689224243
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.478 Vali Acc: 0.786 Test Loss: 0.478 Test Acc: 0.786
Validation loss decreased (-0.751440 --> -0.786122).  Saving model ...
Epoch: 9 cost time: 5.216237783432007
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.497 Vali Acc: 0.775 Test Loss: 0.497 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.188433885574341
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.470 Vali Acc: 0.780 Test Loss: 0.470 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.952240705490112
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.476 Vali Acc: 0.780 Test Loss: 0.476 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.9621686935424805
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.464 Vali Acc: 0.763 Test Loss: 0.464 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.287525415420532
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.474 Vali Acc: 0.775 Test Loss: 0.474 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.371705770492554
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.467 Vali Acc: 0.775 Test Loss: 0.467 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.456996917724609
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.769 Test Loss: 0.471 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.389643669128418
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.763 Test Loss: 0.473 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.35270881652832
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.763 Test Loss: 0.478 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.5534749031066895
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.763 Test Loss: 0.481 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.092924118041992
Epoch: 1, Steps: 17 | Train Loss: 1.922 Vali Loss: 1.778 Vali Acc: 0.324 Test Loss: 1.778 Test Acc: 0.324
Validation loss decreased (inf --> -0.323682).  Saving model ...
Epoch: 2 cost time: 5.984285831451416
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.436 Vali Acc: 0.555 Test Loss: 1.436 Test Acc: 0.555
Validation loss decreased (-0.323682 --> -0.554899).  Saving model ...
Epoch: 3 cost time: 5.719600677490234
Epoch: 3, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.147 Vali Acc: 0.636 Test Loss: 1.147 Test Acc: 0.636
Validation loss decreased (-0.554899 --> -0.635827).  Saving model ...
Epoch: 4 cost time: 5.787731647491455
Epoch: 4, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.882 Vali Acc: 0.792 Test Loss: 0.882 Test Acc: 0.792
Validation loss decreased (-0.635827 --> -0.791899).  Saving model ...
Epoch: 5 cost time: 6.109638690948486
Epoch: 5, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.747 Vali Acc: 0.751 Test Loss: 0.747 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.230601072311401
Epoch: 6, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
Validation loss decreased (-0.791899 --> -0.820803).  Saving model ...
Epoch: 7 cost time: 5.935604095458984
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.517 Vali Acc: 0.827 Test Loss: 0.517 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 8 cost time: 6.428946256637573
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.478 Vali Acc: 0.827 Test Loss: 0.478 Test Acc: 0.827
Validation loss decreased (-0.826584 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 5.968739986419678
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.465 Vali Acc: 0.821 Test Loss: 0.465 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.8918280601501465
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.455 Vali Acc: 0.850 Test Loss: 0.455 Test Acc: 0.850
Validation loss decreased (-0.826585 --> -0.849706).  Saving model ...
Epoch: 11 cost time: 5.600291967391968
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.453 Vali Acc: 0.832 Test Loss: 0.453 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.52608847618103
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.449 Vali Acc: 0.838 Test Loss: 0.449 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.980907440185547
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.773186683654785
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.092265844345093
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.447 Vali Acc: 0.827 Test Loss: 0.447 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.74849009513855
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.827 Test Loss: 0.447 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.570572376251221
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.827 Test Loss: 0.450 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.106212139129639
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.827 Test Loss: 0.450 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.405673027038574
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.832 Test Loss: 0.447 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.856845855712891
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.827 Test Loss: 0.449 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.113402366638184
Epoch: 1, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.907 Vali Acc: 0.220 Test Loss: 1.907 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 5.663201332092285
Epoch: 2, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.684 Vali Acc: 0.428 Test Loss: 1.684 Test Acc: 0.428
Validation loss decreased (-0.219634 --> -0.427729).  Saving model ...
Epoch: 3 cost time: 5.625529766082764
Epoch: 3, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.460 Vali Acc: 0.549 Test Loss: 1.460 Test Acc: 0.549
Validation loss decreased (-0.427729 --> -0.549118).  Saving model ...
Epoch: 4 cost time: 5.131818771362305
Epoch: 4, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.218 Vali Acc: 0.647 Test Loss: 1.218 Test Acc: 0.647
Validation loss decreased (-0.549118 --> -0.647387).  Saving model ...
Epoch: 5 cost time: 5.012054681777954
Epoch: 5, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.996 Vali Acc: 0.671 Test Loss: 0.996 Test Acc: 0.671
Validation loss decreased (-0.647387 --> -0.670510).  Saving model ...
Epoch: 6 cost time: 5.252296209335327
Epoch: 6, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.819 Vali Acc: 0.694 Test Loss: 0.819 Test Acc: 0.694
Validation loss decreased (-0.670510 --> -0.693633).  Saving model ...
Epoch: 7 cost time: 5.145521402359009
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
Validation loss decreased (-0.693633 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 5.138440370559692
Epoch: 8, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745659).  Saving model ...
Epoch: 9 cost time: 5.8311686515808105
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.606 Vali Acc: 0.751 Test Loss: 0.606 Test Acc: 0.751
Validation loss decreased (-0.745659 --> -0.751439).  Saving model ...
Epoch: 10 cost time: 5.099809169769287
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.571 Vali Acc: 0.775 Test Loss: 0.571 Test Acc: 0.775
Validation loss decreased (-0.751439 --> -0.774561).  Saving model ...
Epoch: 11 cost time: 5.9416890144348145
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 5.765378475189209
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.554 Vali Acc: 0.780 Test Loss: 0.554 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 13 cost time: 5.875640630722046
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.550 Vali Acc: 0.780 Test Loss: 0.550 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 14 cost time: 5.719831943511963
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.546 Vali Acc: 0.780 Test Loss: 0.546 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 15 cost time: 5.435689926147461
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.544 Vali Acc: 0.780 Test Loss: 0.544 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 16 cost time: 5.0791566371917725
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.780 Test Loss: 0.539 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 17 cost time: 5.128264665603638
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.780 Test Loss: 0.532 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780342).  Saving model ...
Epoch: 18 cost time: 5.357748746871948
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.792 Test Loss: 0.531 Test Acc: 0.792
Validation loss decreased (-0.780342 --> -0.791902).  Saving model ...
Epoch: 19 cost time: 5.077252388000488
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.780 Test Loss: 0.526 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.466498374938965
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.666844606399536
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.524 Vali Acc: 0.780 Test Loss: 0.524 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.763530015945435
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.780 Test Loss: 0.523 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.426600933074951
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.786 Test Loss: 0.523 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.723976135253906
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.520 Vali Acc: 0.780 Test Loss: 0.520 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.465345144271851
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.780 Test Loss: 0.518 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.881702661514282
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.780 Test Loss: 0.517 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.512079954147339
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.775 Test Loss: 0.516 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.450206518173218
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.769 Test Loss: 0.515 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.720008611679077
Epoch: 1, Steps: 17 | Train Loss: 1.968 Vali Loss: 1.923 Vali Acc: 0.173 Test Loss: 1.923 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 5.294053316116333
Epoch: 2, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.769 Vali Acc: 0.382 Test Loss: 1.769 Test Acc: 0.382
Validation loss decreased (-0.173391 --> -0.381485).  Saving model ...
Epoch: 3 cost time: 5.592825174331665
Epoch: 3, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.583 Vali Acc: 0.532 Test Loss: 1.583 Test Acc: 0.532
Validation loss decreased (-0.381485 --> -0.531776).  Saving model ...
Epoch: 4 cost time: 5.83245325088501
Epoch: 4, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.375 Vali Acc: 0.601 Test Loss: 1.375 Test Acc: 0.601
Validation loss decreased (-0.531776 --> -0.601142).  Saving model ...
Epoch: 5 cost time: 5.664185285568237
Epoch: 5, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.178 Vali Acc: 0.624 Test Loss: 1.178 Test Acc: 0.624
Validation loss decreased (-0.601142 --> -0.624266).  Saving model ...
Epoch: 6 cost time: 5.64398193359375
Epoch: 6, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.994 Vali Acc: 0.694 Test Loss: 0.994 Test Acc: 0.694
Validation loss decreased (-0.624266 --> -0.693632).  Saving model ...
Epoch: 7 cost time: 5.350245475769043
Epoch: 7, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.829 Vali Acc: 0.723 Test Loss: 0.829 Test Acc: 0.723
Validation loss decreased (-0.693632 --> -0.722535).  Saving model ...
Epoch: 8 cost time: 5.4847633838653564
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.739 Vali Acc: 0.746 Test Loss: 0.739 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 5.164845705032349
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.746 Vali Acc: 0.699 Test Loss: 0.746 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.038385629653931
Epoch: 10, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.680 Vali Acc: 0.740 Test Loss: 0.680 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.128596782684326
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745658).  Saving model ...
Epoch: 12 cost time: 5.499933242797852
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.670 Vali Acc: 0.728 Test Loss: 0.670 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.202005386352539
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.661 Vali Acc: 0.751 Test Loss: 0.661 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751438).  Saving model ...
Epoch: 14 cost time: 5.658241271972656
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.654 Vali Acc: 0.763 Test Loss: 0.654 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 15 cost time: 5.421049356460571
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.757 Test Loss: 0.647 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.348906993865967
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.644 Vali Acc: 0.751 Test Loss: 0.644 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.326669931411743
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.769 Test Loss: 0.637 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768780).  Saving model ...
Epoch: 18 cost time: 5.369033575057983
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.519742012023926
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.052315950393677
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.259317874908447
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.751 Test Loss: 0.624 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.1248016357421875
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.757 Test Loss: 0.626 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.331868410110474
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.769 Test Loss: 0.622 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 24 cost time: 5.388330459594727
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.332536697387695
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.532409429550171
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.751 Test Loss: 0.610 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.400851488113403
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.608202219009399
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.746 Test Loss: 0.605 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.576253890991211
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.68481969833374
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.6968443393707275
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.763 Test Loss: 0.598 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.4612343311309814
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.191610336303711
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.757 Test Loss: 0.592 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.958895683288574
Epoch: 1, Steps: 17 | Train Loss: 1.994 Vali Loss: 1.945 Vali Acc: 0.173 Test Loss: 1.945 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 6.075429677963257
Epoch: 2, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.823 Vali Acc: 0.283 Test Loss: 1.823 Test Acc: 0.283
Validation loss decreased (-0.173391 --> -0.283219).  Saving model ...
Epoch: 3 cost time: 6.055745363235474
Epoch: 3, Steps: 17 | Train Loss: 1.594 Vali Loss: 1.676 Vali Acc: 0.491 Test Loss: 1.676 Test Acc: 0.491
Validation loss decreased (-0.283219 --> -0.491313).  Saving model ...
Epoch: 4 cost time: 5.633629560470581
Epoch: 4, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.490 Vali Acc: 0.555 Test Loss: 1.490 Test Acc: 0.555
Validation loss decreased (-0.491313 --> -0.554898).  Saving model ...
Epoch: 5 cost time: 5.771167278289795
Epoch: 5, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.322 Vali Acc: 0.584 Test Loss: 1.322 Test Acc: 0.584
Validation loss decreased (-0.554898 --> -0.583802).  Saving model ...
Epoch: 6 cost time: 5.634939432144165
Epoch: 6, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.114 Vali Acc: 0.647 Test Loss: 1.114 Test Acc: 0.647
Validation loss decreased (-0.583802 --> -0.647388).  Saving model ...
Epoch: 7 cost time: 5.053969621658325
Epoch: 7, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.971 Vali Acc: 0.647 Test Loss: 0.971 Test Acc: 0.647
Validation loss decreased (-0.647388 --> -0.647389).  Saving model ...
Epoch: 8 cost time: 5.185699224472046
Epoch: 8, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.820 Vali Acc: 0.705 Test Loss: 0.820 Test Acc: 0.705
Validation loss decreased (-0.647389 --> -0.705194).  Saving model ...
Epoch: 9 cost time: 5.2949769496917725
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.796 Vali Acc: 0.682 Test Loss: 0.796 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.262525796890259
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.723 Vali Acc: 0.705 Test Loss: 0.723 Test Acc: 0.705
Validation loss decreased (-0.705194 --> -0.705195).  Saving model ...
Epoch: 11 cost time: 5.405025243759155
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.694 Vali Acc: 0.699 Test Loss: 0.694 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.624238014221191
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.665 Vali Acc: 0.705 Test Loss: 0.665 Test Acc: 0.705
Validation loss decreased (-0.705195 --> -0.705196).  Saving model ...
Epoch: 13 cost time: 5.633418083190918
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.662 Vali Acc: 0.694 Test Loss: 0.662 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.74706506729126
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.658 Vali Acc: 0.723 Test Loss: 0.658 Test Acc: 0.723
Validation loss decreased (-0.705196 --> -0.722537).  Saving model ...
Epoch: 15 cost time: 5.714218616485596
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.648 Vali Acc: 0.723 Test Loss: 0.648 Test Acc: 0.723
Validation loss decreased (-0.722537 --> -0.722537).  Saving model ...
Epoch: 16 cost time: 5.658691883087158
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.653 Vali Acc: 0.717 Test Loss: 0.653 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.042683839797974
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.723 Test Loss: 0.642 Test Acc: 0.723
Validation loss decreased (-0.722537 --> -0.722537).  Saving model ...
Epoch: 18 cost time: 5.847344875335693
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.723 Test Loss: 0.639 Test Acc: 0.723
Validation loss decreased (-0.722537 --> -0.722537).  Saving model ...
Epoch: 19 cost time: 5.389037847518921
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.639 Vali Acc: 0.723 Test Loss: 0.639 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.274446487426758
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.629 Vali Acc: 0.723 Test Loss: 0.629 Test Acc: 0.723
Validation loss decreased (-0.722537 --> -0.722537).  Saving model ...
Epoch: 21 cost time: 5.159529685974121
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.728 Test Loss: 0.626 Test Acc: 0.728
Validation loss decreased (-0.722537 --> -0.728317).  Saving model ...
Epoch: 22 cost time: 5.423676013946533
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.723 Test Loss: 0.625 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.47962498664856
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.618 Vali Acc: 0.728 Test Loss: 0.618 Test Acc: 0.728
Validation loss decreased (-0.728317 --> -0.728318).  Saving model ...
Epoch: 24 cost time: 5.778414487838745
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.620 Vali Acc: 0.728 Test Loss: 0.620 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.167544603347778
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.723 Test Loss: 0.621 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.048560857772827
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.723 Test Loss: 0.621 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.07242226600647
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.723 Test Loss: 0.616 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.740568161010742
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.614 Vali Acc: 0.728 Test Loss: 0.614 Test Acc: 0.728
Validation loss decreased (-0.728318 --> -0.728318).  Saving model ...
Epoch: 29 cost time: 6.008460283279419
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.723 Test Loss: 0.613 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.8614466190338135
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.620 Vali Acc: 0.734 Test Loss: 0.620 Test Acc: 0.734
Validation loss decreased (-0.728318 --> -0.734098).  Saving model ...
Epoch: 31 cost time: 5.515913724899292
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.617 Vali Acc: 0.728 Test Loss: 0.617 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.705303907394409
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.614 Vali Acc: 0.723 Test Loss: 0.614 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.013385772705078
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.610 Vali Acc: 0.734 Test Loss: 0.610 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 34 cost time: 5.4470579624176025
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 35 cost time: 5.446710109710693
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
Validation loss decreased (-0.734098 --> -0.751439).  Saving model ...
Epoch: 36 cost time: 5.5030505657196045
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.746 Test Loss: 0.601 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 6.119847774505615
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.8587610721588135
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.746 Test Loss: 0.601 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.745072364807129
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.740 Test Loss: 0.594 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.920619964599609
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.740 Test Loss: 0.601 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 5.3649585247039795
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.740 Test Loss: 0.604 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 5.707825422286987
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.734 Test Loss: 0.601 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 5.941564559936523
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.734 Test Loss: 0.599 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.517715692520142
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.734 Test Loss: 0.596 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 5.147487640380859
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.734 Test Loss: 0.598 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.042497158050537
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.916 Vali Acc: 0.225 Test Loss: 1.916 Test Acc: 0.225
Validation loss decreased (inf --> -0.225414).  Saving model ...
Epoch: 2 cost time: 5.938732624053955
Epoch: 2, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.808 Vali Acc: 0.341 Test Loss: 1.808 Test Acc: 0.341
Validation loss decreased (-0.225414 --> -0.341022).  Saving model ...
Epoch: 3 cost time: 5.686406850814819
Epoch: 3, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.676 Vali Acc: 0.439 Test Loss: 1.676 Test Acc: 0.439
Validation loss decreased (-0.341022 --> -0.439290).  Saving model ...
Epoch: 4 cost time: 5.581057786941528
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.487 Vali Acc: 0.572 Test Loss: 1.487 Test Acc: 0.572
Validation loss decreased (-0.439290 --> -0.572239).  Saving model ...
Epoch: 5 cost time: 5.51242470741272
Epoch: 5, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.320 Vali Acc: 0.607 Test Loss: 1.320 Test Acc: 0.607
Validation loss decreased (-0.572239 --> -0.606923).  Saving model ...
Epoch: 6 cost time: 5.158533811569214
Epoch: 6, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.130 Vali Acc: 0.636 Test Loss: 1.130 Test Acc: 0.636
Validation loss decreased (-0.606923 --> -0.635827).  Saving model ...
Epoch: 7 cost time: 5.64232325553894
Epoch: 7, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.974 Vali Acc: 0.636 Test Loss: 0.974 Test Acc: 0.636
Validation loss decreased (-0.635827 --> -0.635828).  Saving model ...
Epoch: 8 cost time: 5.516597032546997
Epoch: 8, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.807 Vali Acc: 0.665 Test Loss: 0.807 Test Acc: 0.665
Validation loss decreased (-0.635828 --> -0.664732).  Saving model ...
Epoch: 9 cost time: 5.816362142562866
Epoch: 9, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.736 Vali Acc: 0.699 Test Loss: 0.736 Test Acc: 0.699
Validation loss decreased (-0.664732 --> -0.699415).  Saving model ...
Epoch: 10 cost time: 5.317220449447632
Epoch: 10, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.669 Vali Acc: 0.705 Test Loss: 0.669 Test Acc: 0.705
Validation loss decreased (-0.699415 --> -0.705196).  Saving model ...
Epoch: 11 cost time: 5.845773696899414
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.642 Vali Acc: 0.734 Test Loss: 0.642 Test Acc: 0.734
Validation loss decreased (-0.705196 --> -0.734098).  Saving model ...
Epoch: 12 cost time: 6.517448663711548
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.624 Vali Acc: 0.711 Test Loss: 0.624 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.150449275970459
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.628 Vali Acc: 0.734 Test Loss: 0.628 Test Acc: 0.734
Validation loss decreased (-0.734098 --> -0.734098).  Saving model ...
Epoch: 14 cost time: 6.305737257003784
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.613 Vali Acc: 0.740 Test Loss: 0.613 Test Acc: 0.740
Validation loss decreased (-0.734098 --> -0.739878).  Saving model ...
Epoch: 15 cost time: 5.786557912826538
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.603 Vali Acc: 0.751 Test Loss: 0.603 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751439).  Saving model ...
Epoch: 16 cost time: 5.837651968002319
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 17 cost time: 5.4379355907440186
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.372910022735596
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.734 Test Loss: 0.609 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.254479885101318
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.603 Vali Acc: 0.740 Test Loss: 0.603 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.9691383838653564
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
Validation loss decreased (-0.757219 --> -0.763000).  Saving model ...
Epoch: 21 cost time: 5.5750892162323
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.533028602600098
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.751 Test Loss: 0.596 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.040411710739136
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.392900705337524
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.740 Test Loss: 0.590 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.340539932250977
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.90545392036438
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.719196796417236
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.757 Test Loss: 0.585 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.034650802612305
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.91154670715332
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.300731182098389
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.992467403411865
Epoch: 1, Steps: 17 | Train Loss: 1.968 Vali Loss: 1.911 Vali Acc: 0.202 Test Loss: 1.911 Test Acc: 0.202
Validation loss decreased (inf --> -0.202293).  Saving model ...
Epoch: 2 cost time: 5.687036991119385
Epoch: 2, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.798 Vali Acc: 0.318 Test Loss: 1.798 Test Acc: 0.318
Validation loss decreased (-0.202293 --> -0.317901).  Saving model ...
Epoch: 3 cost time: 5.56549596786499
Epoch: 3, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.676 Vali Acc: 0.416 Test Loss: 1.676 Test Acc: 0.416
Validation loss decreased (-0.317901 --> -0.416168).  Saving model ...
Epoch: 4 cost time: 5.620060682296753
Epoch: 4, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.487 Vali Acc: 0.549 Test Loss: 1.487 Test Acc: 0.549
Validation loss decreased (-0.416168 --> -0.549118).  Saving model ...
Epoch: 5 cost time: 5.40533185005188
Epoch: 5, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.303 Vali Acc: 0.630 Test Loss: 1.303 Test Acc: 0.630
Validation loss decreased (-0.549118 --> -0.630045).  Saving model ...
Epoch: 6 cost time: 5.415246963500977
Epoch: 6, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.128 Vali Acc: 0.613 Test Loss: 1.128 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.476319789886475
Epoch: 7, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.949 Vali Acc: 0.653 Test Loss: 0.949 Test Acc: 0.653
Validation loss decreased (-0.630045 --> -0.653170).  Saving model ...
Epoch: 8 cost time: 6.049286365509033
Epoch: 8, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.780 Vali Acc: 0.711 Test Loss: 0.780 Test Acc: 0.711
Validation loss decreased (-0.653170 --> -0.710975).  Saving model ...
Epoch: 9 cost time: 5.62048077583313
Epoch: 9, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.694 Vali Acc: 0.728 Test Loss: 0.694 Test Acc: 0.728
Validation loss decreased (-0.710975 --> -0.728317).  Saving model ...
Epoch: 10 cost time: 5.622016429901123
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.636 Vali Acc: 0.734 Test Loss: 0.636 Test Acc: 0.734
Validation loss decreased (-0.728317 --> -0.734098).  Saving model ...
Epoch: 11 cost time: 5.619706869125366
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
Validation loss decreased (-0.734098 --> -0.768780).  Saving model ...
Epoch: 12 cost time: 5.748146295547485
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.422736167907715
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.584 Vali Acc: 0.734 Test Loss: 0.584 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.603427171707153
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.329803943634033
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.570 Vali Acc: 0.775 Test Loss: 0.570 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774561).  Saving model ...
Epoch: 16 cost time: 5.894466400146484
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.576 Vali Acc: 0.728 Test Loss: 0.576 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.9438817501068115
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.577 Vali Acc: 0.728 Test Loss: 0.577 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.273116827011108
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.728 Test Loss: 0.579 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.897161245346069
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.576 Vali Acc: 0.751 Test Loss: 0.576 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.316487789154053
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.071880340576172
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.422277450561523
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.680437088012695
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.751 Test Loss: 0.559 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.608726978302002
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.560 Vali Acc: 0.769 Test Loss: 0.560 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.505592107772827
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.780 Test Loss: 0.559 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 26 cost time: 5.642376184463501
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.775 Test Loss: 0.548 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.813672780990601
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.769 Test Loss: 0.549 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.358410596847534
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.548 Vali Acc: 0.769 Test Loss: 0.548 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.943556785583496
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.775 Test Loss: 0.544 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.84322714805603
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.542 Vali Acc: 0.786 Test Loss: 0.542 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 31 cost time: 6.04037070274353
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.786 Test Loss: 0.548 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.403527736663818
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.769 Test Loss: 0.551 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.398400783538818
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.769 Test Loss: 0.551 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.47812032699585
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.786 Test Loss: 0.549 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.6772496700286865
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.786 Test Loss: 0.549 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.152381896972656
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.786 Test Loss: 0.553 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 5.785199403762817
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.786 Test Loss: 0.551 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.116848945617676
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.10181188583374
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.786 Test Loss: 0.556 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.043609380722046
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.9831929206848145
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
Validation loss decreased (inf --> -0.156050).  Saving model ...
Epoch: 2 cost time: 5.684799432754517
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.827240705490112
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.533544063568115
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.156 Test Loss: 1.946 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.087108612060547
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.314663648605347
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.805214881896973
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.921156644821167
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.603091239929199
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.116 Test Loss: 1.946 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.266337871551514
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.406990051269531
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15606936416184972
model parameter : 465543
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.075227499008179
Epoch: 1, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.682 Vali Acc: 0.295 Test Loss: 1.682 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 4.960233211517334
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.294 Vali Acc: 0.526 Test Loss: 1.294 Test Acc: 0.526
Validation loss decreased (-0.294781 --> -0.525999).  Saving model ...
Epoch: 3 cost time: 4.819316148757935
Epoch: 3, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.090 Vali Acc: 0.653 Test Loss: 1.090 Test Acc: 0.653
Validation loss decreased (-0.525999 --> -0.653168).  Saving model ...
Epoch: 4 cost time: 4.803268909454346
Epoch: 4, Steps: 17 | Train Loss: 0.963 Vali Loss: 0.966 Vali Acc: 0.653 Test Loss: 0.966 Test Acc: 0.653
Validation loss decreased (-0.653168 --> -0.653170).  Saving model ...
Epoch: 5 cost time: 4.99101185798645
Epoch: 5, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.846 Vali Acc: 0.694 Test Loss: 0.846 Test Acc: 0.694
Validation loss decreased (-0.653170 --> -0.693633).  Saving model ...
Epoch: 6 cost time: 5.001847505569458
Epoch: 6, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.754 Vali Acc: 0.688 Test Loss: 0.754 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.822722434997559
Epoch: 7, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.529 Vali Acc: 0.821 Test Loss: 0.529 Test Acc: 0.821
Validation loss decreased (-0.693633 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 5.275045394897461
Epoch: 8, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.483 Vali Acc: 0.821 Test Loss: 0.483 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 9 cost time: 5.197420597076416
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.415 Vali Acc: 0.832 Test Loss: 0.415 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832366).  Saving model ...
Epoch: 10 cost time: 5.12117338180542
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.436 Vali Acc: 0.809 Test Loss: 0.436 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.4890077114105225
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.458 Vali Acc: 0.832 Test Loss: 0.458 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.535449266433716
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.438 Vali Acc: 0.832 Test Loss: 0.438 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.678695917129517
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.469 Vali Acc: 0.827 Test Loss: 0.469 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.393737316131592
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.458 Vali Acc: 0.838 Test Loss: 0.458 Test Acc: 0.838
Validation loss decreased (-0.832366 --> -0.838146).  Saving model ...
Epoch: 15 cost time: 5.517810106277466
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.481 Vali Acc: 0.821 Test Loss: 0.481 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.797874689102173
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.710869073867798
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.454677581787109
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.509 Vali Acc: 0.821 Test Loss: 0.509 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.948839426040649
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.832 Test Loss: 0.487 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.9784088134765625
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.832 Test Loss: 0.507 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.233531713485718
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.821 Test Loss: 0.508 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.082199573516846
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.507 Vali Acc: 0.821 Test Loss: 0.507 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.814539909362793
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.821 Test Loss: 0.527 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.823054552078247
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.821 Test Loss: 0.523 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.186719655990601
Epoch: 1, Steps: 17 | Train Loss: 1.930 Vali Loss: 1.780 Vali Acc: 0.272 Test Loss: 1.780 Test Acc: 0.272
Validation loss decreased (inf --> -0.271659).  Saving model ...
Epoch: 2 cost time: 5.925967216491699
Epoch: 2, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.378 Vali Acc: 0.468 Test Loss: 1.378 Test Acc: 0.468
Validation loss decreased (-0.271659 --> -0.468194).  Saving model ...
Epoch: 3 cost time: 5.5312206745147705
Epoch: 3, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.131 Vali Acc: 0.613 Test Loss: 1.131 Test Acc: 0.613
Validation loss decreased (-0.468194 --> -0.612705).  Saving model ...
Epoch: 4 cost time: 6.0420591831207275
Epoch: 4, Steps: 17 | Train Loss: 0.940 Vali Loss: 0.964 Vali Acc: 0.705 Test Loss: 0.964 Test Acc: 0.705
Validation loss decreased (-0.612705 --> -0.705193).  Saving model ...
Epoch: 5 cost time: 6.135261058807373
Epoch: 5, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.831 Vali Acc: 0.728 Test Loss: 0.831 Test Acc: 0.728
Validation loss decreased (-0.705193 --> -0.728315).  Saving model ...
Epoch: 6 cost time: 5.920679807662964
Epoch: 6, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.730 Vali Acc: 0.705 Test Loss: 0.730 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.237569093704224
Epoch: 7, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.534 Vali Acc: 0.821 Test Loss: 0.534 Test Acc: 0.821
Validation loss decreased (-0.728315 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 5.7452473640441895
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.511 Vali Acc: 0.798 Test Loss: 0.511 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.654407739639282
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.463 Vali Acc: 0.832 Test Loss: 0.463 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 10 cost time: 5.6754844188690186
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.514 Vali Acc: 0.815 Test Loss: 0.514 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.430222034454346
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.506 Vali Acc: 0.815 Test Loss: 0.506 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.702732563018799
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.516 Vali Acc: 0.815 Test Loss: 0.516 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.51786470413208
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.31355619430542
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.815 Test Loss: 0.522 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.662039518356323
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.560 Vali Acc: 0.821 Test Loss: 0.560 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.296018362045288
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.551 Vali Acc: 0.815 Test Loss: 0.551 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.024597406387329
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.556 Vali Acc: 0.821 Test Loss: 0.556 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.126856565475464
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.576 Vali Acc: 0.821 Test Loss: 0.576 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.036046028137207
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.569 Vali Acc: 0.815 Test Loss: 0.569 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.932074069976807
Epoch: 1, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.887 Vali Acc: 0.237 Test Loss: 1.887 Test Acc: 0.237
Validation loss decreased (inf --> -0.236975).  Saving model ...
Epoch: 2 cost time: 4.960503101348877
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.506 Vali Acc: 0.451 Test Loss: 1.506 Test Acc: 0.451
Validation loss decreased (-0.236975 --> -0.450852).  Saving model ...
Epoch: 3 cost time: 5.295387029647827
Epoch: 3, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.179 Vali Acc: 0.618 Test Loss: 1.179 Test Acc: 0.618
Validation loss decreased (-0.450852 --> -0.618485).  Saving model ...
Epoch: 4 cost time: 5.1614830493927
Epoch: 4, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.974 Vali Acc: 0.659 Test Loss: 0.974 Test Acc: 0.659
Validation loss decreased (-0.618485 --> -0.658950).  Saving model ...
Epoch: 5 cost time: 5.652440547943115
Epoch: 5, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.812 Vali Acc: 0.699 Test Loss: 0.812 Test Acc: 0.699
Validation loss decreased (-0.658950 --> -0.699414).  Saving model ...
Epoch: 6 cost time: 5.307735204696655
Epoch: 6, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
Validation loss decreased (-0.699414 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 5.4932122230529785
Epoch: 7, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
Validation loss decreased (-0.745658 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 5.646276235580444
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809244).  Saving model ...
Epoch: 9 cost time: 5.6984946727752686
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.431 Vali Acc: 0.844 Test Loss: 0.431 Test Acc: 0.844
Validation loss decreased (-0.809244 --> -0.843926).  Saving model ...
Epoch: 10 cost time: 5.589129209518433
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.124503135681152
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.457 Vali Acc: 0.832 Test Loss: 0.457 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.151947021484375
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.452 Vali Acc: 0.844 Test Loss: 0.452 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.916625261306763
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.303943157196045
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.454 Vali Acc: 0.838 Test Loss: 0.454 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.471241235733032
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.488 Vali Acc: 0.838 Test Loss: 0.488 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.118205547332764
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.477 Vali Acc: 0.844 Test Loss: 0.477 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.3288257122039795
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849706).  Saving model ...
Epoch: 18 cost time: 5.264580726623535
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.832 Test Loss: 0.483 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.346471786499023
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.850 Test Loss: 0.492 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.61345911026001
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.566406488418579
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.832 Test Loss: 0.492 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.232987642288208
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.333323240280151
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.335299253463745
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.406529903411865
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.4287426471710205
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.850 Test Loss: 0.504 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.6340296268463135
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.838 Test Loss: 0.520 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.206745386123657
Epoch: 1, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.951 Vali Acc: 0.191 Test Loss: 1.951 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 5.470787286758423
Epoch: 2, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.658 Vali Acc: 0.329 Test Loss: 1.658 Test Acc: 0.329
Validation loss decreased (-0.190732 --> -0.329463).  Saving model ...
Epoch: 3 cost time: 5.470752000808716
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.345 Vali Acc: 0.526 Test Loss: 1.345 Test Acc: 0.526
Validation loss decreased (-0.329463 --> -0.525998).  Saving model ...
Epoch: 4 cost time: 5.389043807983398
Epoch: 4, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.069 Vali Acc: 0.665 Test Loss: 1.069 Test Acc: 0.665
Validation loss decreased (-0.525998 --> -0.664729).  Saving model ...
Epoch: 5 cost time: 5.201648473739624
Epoch: 5, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.888 Vali Acc: 0.676 Test Loss: 0.888 Test Acc: 0.676
Validation loss decreased (-0.664729 --> -0.676292).  Saving model ...
Epoch: 6 cost time: 5.157317638397217
Epoch: 6, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.719 Vali Acc: 0.757 Test Loss: 0.719 Test Acc: 0.757
Validation loss decreased (-0.676292 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 5.017584800720215
Epoch: 7, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.648 Vali Acc: 0.769 Test Loss: 0.648 Test Acc: 0.769
Validation loss decreased (-0.757218 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 4.826810121536255
Epoch: 8, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 5.39162802696228
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.439 Vali Acc: 0.827 Test Loss: 0.439 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826585).  Saving model ...
Epoch: 10 cost time: 4.891777753829956
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.467 Vali Acc: 0.815 Test Loss: 0.467 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.523702621459961
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.446 Vali Acc: 0.821 Test Loss: 0.446 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.67912220954895
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.452 Vali Acc: 0.832 Test Loss: 0.452 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 13 cost time: 5.423249006271362
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.449 Vali Acc: 0.809 Test Loss: 0.449 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.4514946937561035
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.457 Vali Acc: 0.815 Test Loss: 0.457 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.367460012435913
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.454 Vali Acc: 0.809 Test Loss: 0.454 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.222323417663574
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.456 Vali Acc: 0.815 Test Loss: 0.456 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.418777227401733
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.453 Vali Acc: 0.815 Test Loss: 0.453 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.123215675354004
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.457 Vali Acc: 0.821 Test Loss: 0.457 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.050720930099487
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.815 Test Loss: 0.464 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.921117305755615
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.465 Vali Acc: 0.815 Test Loss: 0.465 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.01009726524353
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.815 Test Loss: 0.464 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.947457551956177
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.821 Test Loss: 0.471 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.22967004776001
Epoch: 1, Steps: 17 | Train Loss: 1.985 Vali Loss: 1.975 Vali Acc: 0.214 Test Loss: 1.975 Test Acc: 0.214
Validation loss decreased (inf --> -0.213853).  Saving model ...
Epoch: 2 cost time: 5.892033100128174
Epoch: 2, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.792 Vali Acc: 0.289 Test Loss: 1.792 Test Acc: 0.289
Validation loss decreased (-0.213853 --> -0.288999).  Saving model ...
Epoch: 3 cost time: 6.407668828964233
Epoch: 3, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.610 Vali Acc: 0.399 Test Loss: 1.610 Test Acc: 0.399
Validation loss decreased (-0.288999 --> -0.398828).  Saving model ...
Epoch: 4 cost time: 5.789579629898071
Epoch: 4, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.390 Vali Acc: 0.566 Test Loss: 1.390 Test Acc: 0.566
Validation loss decreased (-0.398828 --> -0.566460).  Saving model ...
Epoch: 5 cost time: 5.130181312561035
Epoch: 5, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.176 Vali Acc: 0.618 Test Loss: 1.176 Test Acc: 0.618
Validation loss decreased (-0.566460 --> -0.618485).  Saving model ...
Epoch: 6 cost time: 5.231257200241089
Epoch: 6, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.936 Vali Acc: 0.728 Test Loss: 0.936 Test Acc: 0.728
Validation loss decreased (-0.618485 --> -0.728314).  Saving model ...
Epoch: 7 cost time: 5.942296743392944
Epoch: 7, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.815 Vali Acc: 0.751 Test Loss: 0.815 Test Acc: 0.751
Validation loss decreased (-0.728314 --> -0.751437).  Saving model ...
Epoch: 8 cost time: 5.708367347717285
Epoch: 8, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.668 Vali Acc: 0.769 Test Loss: 0.668 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768779).  Saving model ...
Epoch: 9 cost time: 5.774496555328369
Epoch: 9, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.617 Vali Acc: 0.780 Test Loss: 0.617 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 5.810023784637451
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.563 Vali Acc: 0.775 Test Loss: 0.563 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.431065082550049
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.575 Vali Acc: 0.780 Test Loss: 0.575 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 12 cost time: 5.80305027961731
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.548 Vali Acc: 0.786 Test Loss: 0.548 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786122).  Saving model ...
Epoch: 13 cost time: 5.96970009803772
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.538 Vali Acc: 0.786 Test Loss: 0.538 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 14 cost time: 6.011901140213013
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.220718145370483
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.533 Vali Acc: 0.780 Test Loss: 0.533 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.286240816116333
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.9885313510894775
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.537 Vali Acc: 0.786 Test Loss: 0.537 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 18 cost time: 5.163377285003662
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.539 Vali Acc: 0.769 Test Loss: 0.539 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.448826313018799
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.03923487663269
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.545 Vali Acc: 0.775 Test Loss: 0.545 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.857335329055786
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.537 Vali Acc: 0.775 Test Loss: 0.537 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.6834797859191895
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.769 Test Loss: 0.539 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.826794624328613
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.769 Test Loss: 0.542 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.898123025894165
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.769 Test Loss: 0.544 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.759856462478638
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.769 Test Loss: 0.544 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.607151985168457
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.539 Vali Acc: 0.780 Test Loss: 0.539 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.369942665100098
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.537 Vali Acc: 0.769 Test Loss: 0.537 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.474380731582642
Epoch: 1, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.968 Vali Acc: 0.185 Test Loss: 1.968 Test Acc: 0.185
Validation loss decreased (inf --> -0.184951).  Saving model ...
Epoch: 2 cost time: 5.3151466846466064
Epoch: 2, Steps: 17 | Train Loss: 1.842 Vali Loss: 1.841 Vali Acc: 0.243 Test Loss: 1.841 Test Acc: 0.243
Validation loss decreased (-0.184951 --> -0.242756).  Saving model ...
Epoch: 3 cost time: 5.425715208053589
Epoch: 3, Steps: 17 | Train Loss: 1.672 Vali Loss: 1.698 Vali Acc: 0.387 Test Loss: 1.698 Test Acc: 0.387
Validation loss decreased (-0.242756 --> -0.387266).  Saving model ...
Epoch: 4 cost time: 6.035065650939941
Epoch: 4, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.552 Vali Acc: 0.497 Test Loss: 1.552 Test Acc: 0.497
Validation loss decreased (-0.387266 --> -0.497094).  Saving model ...
Epoch: 5 cost time: 6.059100151062012
Epoch: 5, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.354 Vali Acc: 0.613 Test Loss: 1.354 Test Acc: 0.613
Validation loss decreased (-0.497094 --> -0.612703).  Saving model ...
Epoch: 6 cost time: 5.584702253341675
Epoch: 6, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.174 Vali Acc: 0.699 Test Loss: 1.174 Test Acc: 0.699
Validation loss decreased (-0.612703 --> -0.699410).  Saving model ...
Epoch: 7 cost time: 6.246849775314331
Epoch: 7, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.978 Vali Acc: 0.682 Test Loss: 0.978 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.261897325515747
Epoch: 8, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.852 Vali Acc: 0.717 Test Loss: 0.852 Test Acc: 0.717
Validation loss decreased (-0.699410 --> -0.716754).  Saving model ...
Epoch: 9 cost time: 5.584380388259888
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.770 Vali Acc: 0.705 Test Loss: 0.770 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.6284308433532715
Epoch: 10, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.696 Vali Acc: 0.723 Test Loss: 0.696 Test Acc: 0.723
Validation loss decreased (-0.716754 --> -0.722536).  Saving model ...
Epoch: 11 cost time: 5.779162168502808
Epoch: 11, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.655 Vali Acc: 0.740 Test Loss: 0.655 Test Acc: 0.740
Validation loss decreased (-0.722536 --> -0.739878).  Saving model ...
Epoch: 12 cost time: 5.277420997619629
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.639 Vali Acc: 0.728 Test Loss: 0.639 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.2860658168792725
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.641 Vali Acc: 0.728 Test Loss: 0.641 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.188652753829956
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.625 Vali Acc: 0.740 Test Loss: 0.625 Test Acc: 0.740
Validation loss decreased (-0.739878 --> -0.739878).  Saving model ...
Epoch: 15 cost time: 5.153772354125977
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.623 Vali Acc: 0.728 Test Loss: 0.623 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.16781210899353
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.625 Vali Acc: 0.723 Test Loss: 0.625 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.978553295135498
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.612 Vali Acc: 0.751 Test Loss: 0.612 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751439).  Saving model ...
Epoch: 18 cost time: 5.430114030838013
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.734 Test Loss: 0.616 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.366254091262817
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.740 Test Loss: 0.615 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.455204486846924
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.607 Vali Acc: 0.734 Test Loss: 0.607 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.5940842628479
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.728 Test Loss: 0.609 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.3336169719696045
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.610 Vali Acc: 0.734 Test Loss: 0.610 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.092127084732056
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.609 Vali Acc: 0.734 Test Loss: 0.609 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.841462135314941
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.605 Vali Acc: 0.746 Test Loss: 0.605 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.1220622062683105
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.605 Vali Acc: 0.740 Test Loss: 0.605 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.103058338165283
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.740 Test Loss: 0.607 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.384406089782715
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 28 cost time: 5.188445091247559
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.746 Test Loss: 0.604 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.300448656082153
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.604 Vali Acc: 0.746 Test Loss: 0.604 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.408849239349365
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 31 cost time: 5.807171583175659
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.751 Test Loss: 0.602 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.344863176345825
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.734 Test Loss: 0.607 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.766104459762573
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.503973007202148
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 35 cost time: 5.531056642532349
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.116780519485474
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.769 Test Loss: 0.600 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.421616077423096
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.153660774230957
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.746 Test Loss: 0.599 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.1362364292144775
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.740 Test Loss: 0.601 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.360791206359863
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.740 Test Loss: 0.601 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.714771032333374
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.740 Test Loss: 0.602 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.70259952545166
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.740 Test Loss: 0.601 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 5.610888957977295
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 5.7263007164001465
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.751 Test Loss: 0.602 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.573668956756592
Epoch: 1, Steps: 17 | Train Loss: 2.017 Vali Loss: 1.988 Vali Acc: 0.133 Test Loss: 1.988 Test Acc: 0.133
Validation loss decreased (inf --> -0.132928).  Saving model ...
Epoch: 2 cost time: 5.293447971343994
Epoch: 2, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.912 Vali Acc: 0.179 Test Loss: 1.912 Test Acc: 0.179
Validation loss decreased (-0.132928 --> -0.179172).  Saving model ...
Epoch: 3 cost time: 5.222170829772949
Epoch: 3, Steps: 17 | Train Loss: 1.743 Vali Loss: 1.801 Vali Acc: 0.318 Test Loss: 1.801 Test Acc: 0.318
Validation loss decreased (-0.179172 --> -0.317901).  Saving model ...
Epoch: 4 cost time: 5.495806694030762
Epoch: 4, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.677 Vali Acc: 0.468 Test Loss: 1.677 Test Acc: 0.468
Validation loss decreased (-0.317901 --> -0.468191).  Saving model ...
Epoch: 5 cost time: 5.304702997207642
Epoch: 5, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.538 Vali Acc: 0.555 Test Loss: 1.538 Test Acc: 0.555
Validation loss decreased (-0.468191 --> -0.554898).  Saving model ...
Epoch: 6 cost time: 5.552925109863281
Epoch: 6, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.385 Vali Acc: 0.595 Test Loss: 1.385 Test Acc: 0.595
Validation loss decreased (-0.554898 --> -0.595362).  Saving model ...
Epoch: 7 cost time: 5.332752227783203
Epoch: 7, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.197 Vali Acc: 0.647 Test Loss: 1.197 Test Acc: 0.647
Validation loss decreased (-0.595362 --> -0.647387).  Saving model ...
Epoch: 8 cost time: 5.346820116043091
Epoch: 8, Steps: 17 | Train Loss: 0.715 Vali Loss: 1.073 Vali Acc: 0.659 Test Loss: 1.073 Test Acc: 0.659
Validation loss decreased (-0.647387 --> -0.658949).  Saving model ...
Epoch: 9 cost time: 5.427545547485352
Epoch: 9, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.934 Vali Acc: 0.705 Test Loss: 0.934 Test Acc: 0.705
Validation loss decreased (-0.658949 --> -0.705193).  Saving model ...
Epoch: 10 cost time: 5.783217430114746
Epoch: 10, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.841 Vali Acc: 0.699 Test Loss: 0.841 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.299060106277466
Epoch: 11, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.759 Vali Acc: 0.740 Test Loss: 0.759 Test Acc: 0.740
Validation loss decreased (-0.705193 --> -0.739877).  Saving model ...
Epoch: 12 cost time: 5.586461782455444
Epoch: 12, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
Validation loss decreased (-0.739877 --> -0.774559).  Saving model ...
Epoch: 13 cost time: 5.3187620639801025
Epoch: 13, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.687 Vali Acc: 0.746 Test Loss: 0.687 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5209784507751465
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.674 Vali Acc: 0.734 Test Loss: 0.674 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.165554046630859
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.657 Vali Acc: 0.740 Test Loss: 0.657 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.196259498596191
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.652 Vali Acc: 0.751 Test Loss: 0.652 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.749020099639893
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.620 Vali Acc: 0.786 Test Loss: 0.620 Test Acc: 0.786
Validation loss decreased (-0.774559 --> -0.786121).  Saving model ...
Epoch: 18 cost time: 5.76316237449646
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.616 Vali Acc: 0.775 Test Loss: 0.616 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.937131881713867
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.657120943069458
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.736783027648926
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.278732776641846
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.588 Vali Acc: 0.786 Test Loss: 0.588 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 23 cost time: 5.3541014194488525
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.602 Vali Acc: 0.775 Test Loss: 0.602 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.5448689460754395
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.593 Vali Acc: 0.769 Test Loss: 0.593 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.523883581161499
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.586 Vali Acc: 0.775 Test Loss: 0.586 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.1390650272369385
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.589 Vali Acc: 0.780 Test Loss: 0.589 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.080363750457764
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.579 Vali Acc: 0.775 Test Loss: 0.579 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.580326080322266
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.569 Vali Acc: 0.780 Test Loss: 0.569 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.0579304695129395
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.569 Vali Acc: 0.775 Test Loss: 0.569 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.436374187469482
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.566 Vali Acc: 0.786 Test Loss: 0.566 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786122).  Saving model ...
Epoch: 31 cost time: 5.6089653968811035
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.562 Vali Acc: 0.780 Test Loss: 0.562 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.06652045249939
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.7357337474823
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 34 cost time: 5.610171318054199
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.438220977783203
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.309962272644043
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.780 Test Loss: 0.560 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.120103359222412
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.775 Test Loss: 0.561 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 5.2436723709106445
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 5.652769327163696
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.775 Test Loss: 0.559 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 5.980499029159546
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.780 Test Loss: 0.562 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.529506206512451
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.780 Test Loss: 0.560 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 5.653534889221191
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.786 Test Loss: 0.556 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 43 cost time: 6.1204211711883545
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.780 Test Loss: 0.557 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 6.0656187534332275
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.780 Test Loss: 0.552 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 5.521952867507935
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.780 Test Loss: 0.543 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 5.924473762512207
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.542 Vali Acc: 0.780 Test Loss: 0.542 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 5.572027683258057
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.780 Test Loss: 0.535 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 5.449628591537476
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.780 Test Loss: 0.534 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 4.939596652984619
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.780 Test Loss: 0.534 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 5.148221731185913
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.780 Test Loss: 0.536 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 5.715815305709839
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 52 cost time: 5.845872163772583
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.535 Vali Acc: 0.786 Test Loss: 0.535 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 53 cost time: 6.136716842651367
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.786 Test Loss: 0.536 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 6.049609661102295
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.786 Test Loss: 0.534 Test Acc: 0.786
Validation loss decreased (-0.786122 --> -0.786122).  Saving model ...
Epoch: 55 cost time: 5.655961036682129
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.786 Test Loss: 0.538 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 5.269854307174683
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.792 Test Loss: 0.545 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791902).  Saving model ...
Epoch: 57 cost time: 5.447935581207275
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.798 Test Loss: 0.543 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 58 cost time: 5.904584169387817
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.536 Vali Acc: 0.792 Test Loss: 0.536 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 5.976442813873291
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 5.254367828369141
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.792 Test Loss: 0.538 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 5.825016975402832
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.792 Test Loss: 0.537 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 5.3649303913116455
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.792 Test Loss: 0.536 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 5.7232725620269775
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 5.58684515953064
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.792 Test Loss: 0.539 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 5.662153482437134
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.792 Test Loss: 0.535 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 5.806504011154175
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.792 Test Loss: 0.534 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 4.8825085163116455
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.792 Test Loss: 0.530 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.17013955116272
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.961 Vali Acc: 0.185 Test Loss: 1.961 Test Acc: 0.185
Validation loss decreased (inf --> -0.184951).  Saving model ...
Epoch: 2 cost time: 5.233398914337158
Epoch: 2, Steps: 17 | Train Loss: 1.934 Vali Loss: 1.898 Vali Acc: 0.185 Test Loss: 1.898 Test Acc: 0.185
Validation loss decreased (-0.184951 --> -0.184952).  Saving model ...
Epoch: 3 cost time: 4.654150009155273
Epoch: 3, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.800 Vali Acc: 0.301 Test Loss: 1.800 Test Acc: 0.301
Validation loss decreased (-0.184952 --> -0.300560).  Saving model ...
Epoch: 4 cost time: 5.816760301589966
Epoch: 4, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.693 Vali Acc: 0.428 Test Loss: 1.693 Test Acc: 0.428
Validation loss decreased (-0.300560 --> -0.427729).  Saving model ...
Epoch: 5 cost time: 5.959407329559326
Epoch: 5, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.572 Vali Acc: 0.543 Test Loss: 1.572 Test Acc: 0.543
Validation loss decreased (-0.427729 --> -0.543337).  Saving model ...
Epoch: 6 cost time: 5.48888373374939
Epoch: 6, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.419 Vali Acc: 0.572 Test Loss: 1.419 Test Acc: 0.572
Validation loss decreased (-0.543337 --> -0.572240).  Saving model ...
Epoch: 7 cost time: 5.854671239852905
Epoch: 7, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.266 Vali Acc: 0.613 Test Loss: 1.266 Test Acc: 0.613
Validation loss decreased (-0.572240 --> -0.612704).  Saving model ...
Epoch: 8 cost time: 5.653452396392822
Epoch: 8, Steps: 17 | Train Loss: 0.891 Vali Loss: 1.119 Vali Acc: 0.630 Test Loss: 1.119 Test Acc: 0.630
Validation loss decreased (-0.612704 --> -0.630047).  Saving model ...
Epoch: 9 cost time: 5.372004985809326
Epoch: 9, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.993 Vali Acc: 0.659 Test Loss: 0.993 Test Acc: 0.659
Validation loss decreased (-0.630047 --> -0.658950).  Saving model ...
Epoch: 10 cost time: 5.234018325805664
Epoch: 10, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.898 Vali Acc: 0.682 Test Loss: 0.898 Test Acc: 0.682
Validation loss decreased (-0.658950 --> -0.682072).  Saving model ...
Epoch: 11 cost time: 5.387070417404175
Epoch: 11, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.826 Vali Acc: 0.688 Test Loss: 0.826 Test Acc: 0.688
Validation loss decreased (-0.682072 --> -0.687853).  Saving model ...
Epoch: 12 cost time: 5.262796401977539
Epoch: 12, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.761 Vali Acc: 0.699 Test Loss: 0.761 Test Acc: 0.699
Validation loss decreased (-0.687853 --> -0.699414).  Saving model ...
Epoch: 13 cost time: 5.6037917137146
Epoch: 13, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.767 Vali Acc: 0.671 Test Loss: 0.767 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.1191771030426025
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.752 Vali Acc: 0.694 Test Loss: 0.752 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.578838109970093
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.733 Vali Acc: 0.682 Test Loss: 0.733 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.721686601638794
Epoch: 16, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.742 Vali Acc: 0.688 Test Loss: 0.742 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.703765392303467
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.727 Vali Acc: 0.688 Test Loss: 0.727 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.6058549880981445
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.746 Vali Acc: 0.688 Test Loss: 0.746 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.566374063491821
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.741 Vali Acc: 0.694 Test Loss: 0.741 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.560687780380249
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.699 Test Loss: 0.735 Test Acc: 0.699
Validation loss decreased (-0.699414 --> -0.699415).  Saving model ...
Epoch: 21 cost time: 6.104831695556641
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.729 Vali Acc: 0.699 Test Loss: 0.729 Test Acc: 0.699
Validation loss decreased (-0.699415 --> -0.699415).  Saving model ...
Epoch: 22 cost time: 5.804150104522705
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.718 Vali Acc: 0.699 Test Loss: 0.718 Test Acc: 0.699
Validation loss decreased (-0.699415 --> -0.699415).  Saving model ...
Epoch: 23 cost time: 4.942512035369873
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.724 Vali Acc: 0.699 Test Loss: 0.724 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.067032098770142
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.715 Vali Acc: 0.699 Test Loss: 0.715 Test Acc: 0.699
Validation loss decreased (-0.699415 --> -0.699415).  Saving model ...
Epoch: 25 cost time: 4.595297336578369
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
Validation loss decreased (-0.699415 --> -0.716756).  Saving model ...
Epoch: 26 cost time: 4.870342016220093
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.705 Test Loss: 0.721 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.4996418952941895
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.311503887176514
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.712 Vali Acc: 0.711 Test Loss: 0.712 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.431344509124756
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.723 Test Loss: 0.712 Test Acc: 0.723
Validation loss decreased (-0.716756 --> -0.722536).  Saving model ...
Epoch: 30 cost time: 5.216567754745483
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.694 Test Loss: 0.723 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.373037815093994
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.694 Test Loss: 0.718 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.584315538406372
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.717 Test Loss: 0.720 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.194943904876709
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.705 Test Loss: 0.720 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.105153560638428
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.705 Test Loss: 0.718 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.7681355476379395
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.058151721954346
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.694 Test Loss: 0.737 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.218880891799927
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.694 Test Loss: 0.742 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.153566837310791
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.699 Test Loss: 0.726 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.432571887969971
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.699 Test Loss: 0.720 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7225433526011561
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.623599529266357
Epoch: 1, Steps: 17 | Train Loss: 1.998 Vali Loss: 1.926 Vali Acc: 0.168 Test Loss: 1.926 Test Acc: 0.168
Validation loss decreased (inf --> -0.167611).  Saving model ...
Epoch: 2 cost time: 5.779295444488525
Epoch: 2, Steps: 17 | Train Loss: 1.900 Vali Loss: 1.857 Vali Acc: 0.220 Test Loss: 1.857 Test Acc: 0.220
Validation loss decreased (-0.167611 --> -0.219635).  Saving model ...
Epoch: 3 cost time: 5.23865532875061
Epoch: 3, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.763 Vali Acc: 0.318 Test Loss: 1.763 Test Acc: 0.318
Validation loss decreased (-0.219635 --> -0.317901).  Saving model ...
Epoch: 4 cost time: 5.154605150222778
Epoch: 4, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.652 Vali Acc: 0.474 Test Loss: 1.652 Test Acc: 0.474
Validation loss decreased (-0.317901 --> -0.473972).  Saving model ...
Epoch: 5 cost time: 4.988849639892578
Epoch: 5, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.525 Vali Acc: 0.526 Test Loss: 1.525 Test Acc: 0.526
Validation loss decreased (-0.473972 --> -0.525996).  Saving model ...
Epoch: 6 cost time: 5.158448696136475
Epoch: 6, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.380 Vali Acc: 0.584 Test Loss: 1.380 Test Acc: 0.584
Validation loss decreased (-0.525996 --> -0.583801).  Saving model ...
Epoch: 7 cost time: 5.045450210571289
Epoch: 7, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.224 Vali Acc: 0.659 Test Loss: 1.224 Test Acc: 0.659
Validation loss decreased (-0.583801 --> -0.658947).  Saving model ...
Epoch: 8 cost time: 5.240723133087158
Epoch: 8, Steps: 17 | Train Loss: 0.833 Vali Loss: 1.085 Vali Acc: 0.694 Test Loss: 1.085 Test Acc: 0.694
Validation loss decreased (-0.658947 --> -0.693631).  Saving model ...
Epoch: 9 cost time: 5.300337791442871
Epoch: 9, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.968 Vali Acc: 0.671 Test Loss: 0.968 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.345425367355347
Epoch: 10, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.874 Vali Acc: 0.671 Test Loss: 0.874 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.529247522354126
Epoch: 11, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.813 Vali Acc: 0.711 Test Loss: 0.813 Test Acc: 0.711
Validation loss decreased (-0.693631 --> -0.710975).  Saving model ...
Epoch: 12 cost time: 5.5057692527771
Epoch: 12, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.751 Vali Acc: 0.711 Test Loss: 0.751 Test Acc: 0.711
Validation loss decreased (-0.710975 --> -0.710975).  Saving model ...
Epoch: 13 cost time: 5.4604527950286865
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.745 Vali Acc: 0.694 Test Loss: 0.745 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.669794082641602
Epoch: 14, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.742 Vali Acc: 0.682 Test Loss: 0.742 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.146656513214111
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
Validation loss decreased (-0.710975 --> -0.716756).  Saving model ...
Epoch: 16 cost time: 5.1416335105896
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.716 Vali Acc: 0.705 Test Loss: 0.716 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.734135866165161
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.695 Vali Acc: 0.705 Test Loss: 0.695 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.997608184814453
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
Validation loss decreased (-0.716756 --> -0.716756).  Saving model ...
Epoch: 19 cost time: 4.920902729034424
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.721 Vali Acc: 0.705 Test Loss: 0.721 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.735918998718262
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.706 Vali Acc: 0.723 Test Loss: 0.706 Test Acc: 0.723
Validation loss decreased (-0.716756 --> -0.722536).  Saving model ...
Epoch: 21 cost time: 5.083812952041626
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.694 Vali Acc: 0.728 Test Loss: 0.694 Test Acc: 0.728
Validation loss decreased (-0.722536 --> -0.728317).  Saving model ...
Epoch: 22 cost time: 5.776247978210449
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.386445760726929
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.692 Vali Acc: 0.711 Test Loss: 0.692 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.578580856323242
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.689 Vali Acc: 0.711 Test Loss: 0.689 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.390432834625244
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.461452960968018
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.678 Vali Acc: 0.723 Test Loss: 0.678 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.452968120574951
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.0060389041900635
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.007545232772827
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.368672847747803
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.723 Test Loss: 0.671 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.006798982620239
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.723 Test Loss: 0.671 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7283236994219653
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.904687881469727
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 5.858979225158691
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.6736273765563965
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.1950647830963135
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.056981563568115
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.538471698760986
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.785166501998901
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.453387260437012
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.156749248504639
Epoch: 9, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.145 Test Loss: 1.946 Test Acc: 0.145
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.656294822692871
Epoch: 10, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.947 Vali Acc: 0.150 Test Loss: 1.947 Test Acc: 0.150
Validation loss decreased (-0.144489 --> -0.150270).  Saving model ...
Epoch: 11 cost time: 4.923111915588379
Epoch: 11, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.947 Vali Acc: 0.150 Test Loss: 1.947 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.7213029861450195
Epoch: 12, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.150 Test Loss: 1.947 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.624733924865723
Epoch: 13, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.114879846572876
Epoch: 14, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.446060419082642
Epoch: 15, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.684292793273926
Epoch: 16, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.753559589385986
Epoch: 17, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.786438941955566
Epoch: 18, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.948 Vali Acc: 0.127 Test Loss: 1.948 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.509099245071411
Epoch: 19, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.948 Vali Acc: 0.127 Test Loss: 1.948 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.043402910232544
Epoch: 20, Steps: 17 | Train Loss: 1.944 Vali Loss: 1.948 Vali Acc: 0.127 Test Loss: 1.948 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.15028901734104047
model parameter : 560455
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.305959224700928
Epoch: 1, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.685 Vali Acc: 0.329 Test Loss: 1.685 Test Acc: 0.329
Validation loss decreased (inf --> -0.329463).  Saving model ...
Epoch: 2 cost time: 5.442495822906494
Epoch: 2, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.362 Vali Acc: 0.428 Test Loss: 1.362 Test Acc: 0.428
Validation loss decreased (-0.329463 --> -0.427732).  Saving model ...
Epoch: 3 cost time: 5.362614631652832
Epoch: 3, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.141 Vali Acc: 0.572 Test Loss: 1.141 Test Acc: 0.572
Validation loss decreased (-0.427732 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 5.944527626037598
Epoch: 4, Steps: 17 | Train Loss: 0.964 Vali Loss: 0.963 Vali Acc: 0.694 Test Loss: 0.963 Test Acc: 0.694
Validation loss decreased (-0.572243 --> -0.693632).  Saving model ...
Epoch: 5 cost time: 6.225670576095581
Epoch: 5, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.841 Vali Acc: 0.665 Test Loss: 0.841 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.13727331161499
Epoch: 6, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
Validation loss decreased (-0.693632 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 5.937419652938843
Epoch: 7, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.538 Vali Acc: 0.821 Test Loss: 0.538 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 5.916811227798462
Epoch: 8, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.464 Vali Acc: 0.844 Test Loss: 0.464 Test Acc: 0.844
Validation loss decreased (-0.820804 --> -0.843926).  Saving model ...
Epoch: 9 cost time: 6.307673454284668
Epoch: 9, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.457 Vali Acc: 0.827 Test Loss: 0.457 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.418126344680786
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.486 Vali Acc: 0.821 Test Loss: 0.486 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.774438858032227
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.433 Vali Acc: 0.861 Test Loss: 0.433 Test Acc: 0.861
Validation loss decreased (-0.843926 --> -0.861267).  Saving model ...
Epoch: 12 cost time: 5.990645885467529
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
Validation loss decreased (-0.861267 --> -0.867047).  Saving model ...
Epoch: 13 cost time: 5.936724901199341
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.264768838882446
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.455 Vali Acc: 0.838 Test Loss: 0.455 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.972625970840454
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.783589124679565
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.457 Vali Acc: 0.861 Test Loss: 0.457 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.855390310287476
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.201902151107788
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.515004396438599
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.850 Test Loss: 0.495 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.841214418411255
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.412964582443237
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.658501863479614
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.527 Vali Acc: 0.838 Test Loss: 0.527 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.611443281173706
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.734 Vali Acc: 0.324 Test Loss: 1.734 Test Acc: 0.324
Validation loss decreased (inf --> -0.323682).  Saving model ...
Epoch: 2 cost time: 5.4459757804870605
Epoch: 2, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.404 Vali Acc: 0.491 Test Loss: 1.404 Test Acc: 0.491
Validation loss decreased (-0.323682 --> -0.491315).  Saving model ...
Epoch: 3 cost time: 5.028498888015747
Epoch: 3, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.171 Vali Acc: 0.601 Test Loss: 1.171 Test Acc: 0.601
Validation loss decreased (-0.491315 --> -0.601144).  Saving model ...
Epoch: 4 cost time: 5.4791224002838135
Epoch: 4, Steps: 17 | Train Loss: 0.956 Vali Loss: 0.989 Vali Acc: 0.676 Test Loss: 0.989 Test Acc: 0.676
Validation loss decreased (-0.601144 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 5.56528115272522
Epoch: 5, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.834 Vali Acc: 0.699 Test Loss: 0.834 Test Acc: 0.699
Validation loss decreased (-0.676291 --> -0.699414).  Saving model ...
Epoch: 6 cost time: 5.110090494155884
Epoch: 6, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.699414 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 4.895966291427612
Epoch: 7, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 4.958304405212402
Epoch: 8, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
Validation loss decreased (-0.809243 --> -0.849706).  Saving model ...
Epoch: 9 cost time: 5.03420615196228
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.232615232467651
Epoch: 10, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.497 Vali Acc: 0.838 Test Loss: 0.497 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.905988931655884
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.463 Vali Acc: 0.844 Test Loss: 0.463 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.2752320766448975
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.537 Vali Acc: 0.815 Test Loss: 0.537 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.511245489120483
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.504 Vali Acc: 0.832 Test Loss: 0.504 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.304027795791626
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.519 Vali Acc: 0.827 Test Loss: 0.519 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.497748374938965
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.526 Vali Acc: 0.827 Test Loss: 0.526 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.468189001083374
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.517 Vali Acc: 0.832 Test Loss: 0.517 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.425396203994751
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.821 Test Loss: 0.531 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.390460014343262
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.821 Test Loss: 0.536 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.709968090057373
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.777 Vali Acc: 0.249 Test Loss: 1.777 Test Acc: 0.249
Validation loss decreased (inf --> -0.248537).  Saving model ...
Epoch: 2 cost time: 5.707091808319092
Epoch: 2, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.457 Vali Acc: 0.451 Test Loss: 1.457 Test Acc: 0.451
Validation loss decreased (-0.248537 --> -0.450852).  Saving model ...
Epoch: 3 cost time: 5.439107894897461
Epoch: 3, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.190 Vali Acc: 0.543 Test Loss: 1.190 Test Acc: 0.543
Validation loss decreased (-0.450852 --> -0.543341).  Saving model ...
Epoch: 4 cost time: 5.504201173782349
Epoch: 4, Steps: 17 | Train Loss: 0.958 Vali Loss: 0.982 Vali Acc: 0.682 Test Loss: 0.982 Test Acc: 0.682
Validation loss decreased (-0.543341 --> -0.682071).  Saving model ...
Epoch: 5 cost time: 5.382263898849487
Epoch: 5, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.797 Vali Acc: 0.740 Test Loss: 0.797 Test Acc: 0.740
Validation loss decreased (-0.682071 --> -0.739876).  Saving model ...
Epoch: 6 cost time: 5.497286796569824
Epoch: 6, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.647 Vali Acc: 0.780 Test Loss: 0.647 Test Acc: 0.780
Validation loss decreased (-0.739876 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 5.496561050415039
Epoch: 7, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
Validation loss decreased (-0.780340 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 5.9217352867126465
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.499 Vali Acc: 0.821 Test Loss: 0.499 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 9 cost time: 5.695800065994263
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.548060178756714
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.486 Vali Acc: 0.827 Test Loss: 0.486 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 11 cost time: 5.533830642700195
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.479 Vali Acc: 0.832 Test Loss: 0.479 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 5.3184404373168945
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.493 Vali Acc: 0.821 Test Loss: 0.493 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.102098703384399
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.499 Vali Acc: 0.832 Test Loss: 0.499 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.177049160003662
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 15 cost time: 5.354599952697754
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.510 Vali Acc: 0.827 Test Loss: 0.510 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.434214115142822
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.502 Vali Acc: 0.821 Test Loss: 0.502 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.317555904388428
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.512 Vali Acc: 0.821 Test Loss: 0.512 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.4007439613342285
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.521 Vali Acc: 0.827 Test Loss: 0.521 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.214186668395996
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.827 Test Loss: 0.527 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.241503953933716
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.821 Test Loss: 0.531 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.836504936218262
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.534 Vali Acc: 0.827 Test Loss: 0.534 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.2510881423950195
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.827 Test Loss: 0.544 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.16299033164978
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.821 Test Loss: 0.540 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.354941368103027
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.821 Test Loss: 0.544 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.82642126083374
Epoch: 1, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.847 Vali Acc: 0.272 Test Loss: 1.847 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 5.5422375202178955
Epoch: 2, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.638 Vali Acc: 0.434 Test Loss: 1.638 Test Acc: 0.434
Validation loss decreased (-0.271658 --> -0.433510).  Saving model ...
Epoch: 3 cost time: 5.745565176010132
Epoch: 3, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.373 Vali Acc: 0.543 Test Loss: 1.373 Test Acc: 0.543
Validation loss decreased (-0.433510 --> -0.543339).  Saving model ...
Epoch: 4 cost time: 5.5437328815460205
Epoch: 4, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.118 Vali Acc: 0.665 Test Loss: 1.118 Test Acc: 0.665
Validation loss decreased (-0.543339 --> -0.664729).  Saving model ...
Epoch: 5 cost time: 5.362685203552246
Epoch: 5, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.896 Vali Acc: 0.746 Test Loss: 0.896 Test Acc: 0.746
Validation loss decreased (-0.664729 --> -0.745656).  Saving model ...
Epoch: 6 cost time: 5.196577310562134
Epoch: 6, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.728 Vali Acc: 0.769 Test Loss: 0.728 Test Acc: 0.769
Validation loss decreased (-0.745656 --> -0.768779).  Saving model ...
Epoch: 7 cost time: 5.358657121658325
Epoch: 7, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
Validation loss decreased (-0.768779 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 5.466116666793823
Epoch: 8, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.411458492279053
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.504 Vali Acc: 0.775 Test Loss: 0.504 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.456764221191406
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.469 Vali Acc: 0.798 Test Loss: 0.469 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.941895246505737
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.458 Vali Acc: 0.792 Test Loss: 0.458 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.5633385181427
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.456 Vali Acc: 0.792 Test Loss: 0.456 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.765189170837402
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.462 Vali Acc: 0.798 Test Loss: 0.462 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.439457654953003
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.461 Vali Acc: 0.809 Test Loss: 0.461 Test Acc: 0.809
Validation loss decreased (-0.809243 --> -0.809244).  Saving model ...
Epoch: 15 cost time: 5.405083179473877
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
Validation loss decreased (-0.809244 --> -0.809244).  Saving model ...
Epoch: 16 cost time: 5.768318176269531
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.798 Test Loss: 0.453 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.5090789794921875
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.456 Vali Acc: 0.803 Test Loss: 0.456 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.430938482284546
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.457 Vali Acc: 0.798 Test Loss: 0.457 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.2315850257873535
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.803 Test Loss: 0.458 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.10841965675354
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.803 Test Loss: 0.462 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.323124647140503
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.465 Vali Acc: 0.798 Test Loss: 0.465 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.428595542907715
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.809 Test Loss: 0.464 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.4750213623046875
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.798 Test Loss: 0.463 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.600603818893433
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.798 Test Loss: 0.464 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.631291389465332
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.803 Test Loss: 0.465 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.283636569976807
Epoch: 1, Steps: 17 | Train Loss: 1.959 Vali Loss: 1.893 Vali Acc: 0.185 Test Loss: 1.893 Test Acc: 0.185
Validation loss decreased (inf --> -0.184952).  Saving model ...
Epoch: 2 cost time: 5.460559844970703
Epoch: 2, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.773 Vali Acc: 0.277 Test Loss: 1.773 Test Acc: 0.277
Validation loss decreased (-0.184952 --> -0.277439).  Saving model ...
Epoch: 3 cost time: 5.5305397510528564
Epoch: 3, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.610 Vali Acc: 0.445 Test Loss: 1.610 Test Acc: 0.445
Validation loss decreased (-0.277439 --> -0.445071).  Saving model ...
Epoch: 4 cost time: 5.213897943496704
Epoch: 4, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.406 Vali Acc: 0.595 Test Loss: 1.406 Test Acc: 0.595
Validation loss decreased (-0.445071 --> -0.595362).  Saving model ...
Epoch: 5 cost time: 5.44306206703186
Epoch: 5, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.173 Vali Acc: 0.676 Test Loss: 1.173 Test Acc: 0.676
Validation loss decreased (-0.595362 --> -0.676289).  Saving model ...
Epoch: 6 cost time: 5.648088693618774
Epoch: 6, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.959 Vali Acc: 0.746 Test Loss: 0.959 Test Acc: 0.746
Validation loss decreased (-0.676289 --> -0.745655).  Saving model ...
Epoch: 7 cost time: 6.078516244888306
Epoch: 7, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
Validation loss decreased (-0.745655 --> -0.762998).  Saving model ...
Epoch: 8 cost time: 5.783900260925293
Epoch: 8, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.629 Vali Acc: 0.821 Test Loss: 0.629 Test Acc: 0.821
Validation loss decreased (-0.762998 --> -0.820803).  Saving model ...
Epoch: 9 cost time: 6.362152814865112
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.763735055923462
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.542 Vali Acc: 0.827 Test Loss: 0.542 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 11 cost time: 5.706747055053711
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838145).  Saving model ...
Epoch: 12 cost time: 5.671646356582642
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.509 Vali Acc: 0.832 Test Loss: 0.509 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.789096117019653
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.512 Vali Acc: 0.844 Test Loss: 0.512 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843926).  Saving model ...
Epoch: 14 cost time: 5.553413152694702
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.503 Vali Acc: 0.827 Test Loss: 0.503 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.479119062423706
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.498 Vali Acc: 0.827 Test Loss: 0.498 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.375443935394287
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.495 Vali Acc: 0.827 Test Loss: 0.495 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.151369333267212
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.285846948623657
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.486 Vali Acc: 0.850 Test Loss: 0.486 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849706).  Saving model ...
Epoch: 19 cost time: 5.54990291595459
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.2148277759552
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.477 Vali Acc: 0.832 Test Loss: 0.477 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.442951440811157
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.471 Vali Acc: 0.844 Test Loss: 0.471 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.890336513519287
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.475 Vali Acc: 0.832 Test Loss: 0.475 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.039510011672974
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 24 cost time: 5.092382192611694
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.008241653442383
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 26 cost time: 5.379621267318726
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 27 cost time: 5.315928220748901
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 28 cost time: 6.028045415878296
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.125634431838989
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.623594284057617
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.499659776687622
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.847822427749634
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.6915059089660645
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.747554779052734
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.838 Test Loss: 0.477 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.773612022399902
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.328042268753052
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.207407236099243
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.473 Vali Acc: 0.861 Test Loss: 0.473 Test Acc: 0.861
Validation loss decreased (-0.849706 --> -0.861267).  Saving model ...
Epoch: 38 cost time: 6.027247667312622
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.838 Test Loss: 0.474 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.702812671661377
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.58260440826416
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.319136381149292
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.240967273712158
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 6.1395485401153564
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.005738973617554
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 5.793524980545044
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 5.642352104187012
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 4.958759069442749
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.838 Test Loss: 0.487 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.445929527282715
Epoch: 1, Steps: 17 | Train Loss: 1.970 Vali Loss: 1.941 Vali Acc: 0.208 Test Loss: 1.941 Test Acc: 0.208
Validation loss decreased (inf --> -0.208073).  Saving model ...
Epoch: 2 cost time: 5.700583219528198
Epoch: 2, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.850 Vali Acc: 0.266 Test Loss: 1.850 Test Acc: 0.266
Validation loss decreased (-0.208073 --> -0.265877).  Saving model ...
Epoch: 3 cost time: 5.445138692855835
Epoch: 3, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.724 Vali Acc: 0.399 Test Loss: 1.724 Test Acc: 0.399
Validation loss decreased (-0.265877 --> -0.398827).  Saving model ...
Epoch: 4 cost time: 5.559195041656494
Epoch: 4, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.571 Vali Acc: 0.509 Test Loss: 1.571 Test Acc: 0.509
Validation loss decreased (-0.398827 --> -0.508655).  Saving model ...
Epoch: 5 cost time: 5.6964333057403564
Epoch: 5, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.391 Vali Acc: 0.624 Test Loss: 1.391 Test Acc: 0.624
Validation loss decreased (-0.508655 --> -0.624264).  Saving model ...
Epoch: 6 cost time: 6.006711483001709
Epoch: 6, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.234 Vali Acc: 0.659 Test Loss: 1.234 Test Acc: 0.659
Validation loss decreased (-0.624264 --> -0.658947).  Saving model ...
Epoch: 7 cost time: 5.760751485824585
Epoch: 7, Steps: 17 | Train Loss: 0.757 Vali Loss: 1.065 Vali Acc: 0.647 Test Loss: 1.065 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.447390794754028
Epoch: 8, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.911 Vali Acc: 0.682 Test Loss: 0.911 Test Acc: 0.682
Validation loss decreased (-0.658947 --> -0.682072).  Saving model ...
Epoch: 9 cost time: 5.276731967926025
Epoch: 9, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.838 Vali Acc: 0.671 Test Loss: 0.838 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.845128536224365
Epoch: 10, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.682072 --> -0.716756).  Saving model ...
Epoch: 11 cost time: 5.207422494888306
Epoch: 11, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.746 Vali Acc: 0.711 Test Loss: 0.746 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.106298446655273
Epoch: 12, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.716756 --> -0.716756).  Saving model ...
Epoch: 13 cost time: 5.084280252456665
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.714 Vali Acc: 0.711 Test Loss: 0.714 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.518855810165405
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.684 Vali Acc: 0.723 Test Loss: 0.684 Test Acc: 0.723
Validation loss decreased (-0.716756 --> -0.722537).  Saving model ...
Epoch: 15 cost time: 6.047990322113037
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.708 Vali Acc: 0.711 Test Loss: 0.708 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.057911157608032
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.701 Vali Acc: 0.711 Test Loss: 0.701 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.362907409667969
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.691 Vali Acc: 0.723 Test Loss: 0.691 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.559408664703369
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.695 Vali Acc: 0.723 Test Loss: 0.695 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.894092321395874
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.686 Vali Acc: 0.723 Test Loss: 0.686 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.653120517730713
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.685 Vali Acc: 0.723 Test Loss: 0.685 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.339059591293335
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.685 Vali Acc: 0.728 Test Loss: 0.685 Test Acc: 0.728
Validation loss decreased (-0.722537 --> -0.728317).  Saving model ...
Epoch: 22 cost time: 5.487449407577515
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.683 Vali Acc: 0.723 Test Loss: 0.683 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.90020227432251
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.723 Test Loss: 0.691 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.709733724594116
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.723 Test Loss: 0.689 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.110132455825806
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
Validation loss decreased (-0.728317 --> -0.728317).  Saving model ...
Epoch: 26 cost time: 5.9144980907440186
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
Validation loss decreased (-0.728317 --> -0.728317).  Saving model ...
Epoch: 27 cost time: 6.015958786010742
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.728 Test Loss: 0.680 Test Acc: 0.728
Validation loss decreased (-0.728317 --> -0.728317).  Saving model ...
Epoch: 28 cost time: 5.814838171005249
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.728 Test Loss: 0.681 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.7469518184661865
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.678 Vali Acc: 0.734 Test Loss: 0.678 Test Acc: 0.734
Validation loss decreased (-0.728317 --> -0.734097).  Saving model ...
Epoch: 30 cost time: 5.865318059921265
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.734 Test Loss: 0.681 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.659278869628906
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.734 Test Loss: 0.684 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.172756671905518
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.734 Test Loss: 0.683 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.269112825393677
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
Validation loss decreased (-0.734097 --> -0.745658).  Saving model ...
Epoch: 34 cost time: 5.28557014465332
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 35 cost time: 5.836949110031128
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.345571041107178
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 37 cost time: 5.339088201522827
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.734 Test Loss: 0.683 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.985449552536011
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.728 Test Loss: 0.680 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.6168084144592285
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.723 Test Loss: 0.680 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 5.954013109207153
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.734261989593506
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.740 Test Loss: 0.688 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 5.856405735015869
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.734 Test Loss: 0.680 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 5.213132619857788
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 44 cost time: 5.510072708129883
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 45 cost time: 5.834592342376709
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.746 Test Loss: 0.676 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 46 cost time: 5.565418004989624
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.836214065551758
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 48 cost time: 5.6504576206207275
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 49 cost time: 5.781423568725586
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 50 cost time: 5.984532833099365
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.672 Vali Acc: 0.740 Test Loss: 0.672 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 5.990126132965088
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 6.029550313949585
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.9926066398620605
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 5.324078559875488
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 5.4484052658081055
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.746 Test Loss: 0.674 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 5.581659555435181
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.746 Test Loss: 0.675 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 5.341063976287842
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.740 Test Loss: 0.675 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 5.102142572402954
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.740 Test Loss: 0.674 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 5.297910690307617
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.740 Test Loss: 0.680 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.501707077026367
Epoch: 1, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.973 Vali Acc: 0.168 Test Loss: 1.973 Test Acc: 0.168
Validation loss decreased (inf --> -0.167610).  Saving model ...
Epoch: 2 cost time: 5.241024494171143
Epoch: 2, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.910 Vali Acc: 0.208 Test Loss: 1.910 Test Acc: 0.208
Validation loss decreased (-0.167610 --> -0.208073).  Saving model ...
Epoch: 3 cost time: 5.3490095138549805
Epoch: 3, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.812 Vali Acc: 0.312 Test Loss: 1.812 Test Acc: 0.312
Validation loss decreased (-0.208073 --> -0.312121).  Saving model ...
Epoch: 4 cost time: 5.140732765197754
Epoch: 4, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.663 Vali Acc: 0.439 Test Loss: 1.663 Test Acc: 0.439
Validation loss decreased (-0.312121 --> -0.439290).  Saving model ...
Epoch: 5 cost time: 4.90752387046814
Epoch: 5, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.526 Vali Acc: 0.561 Test Loss: 1.526 Test Acc: 0.561
Validation loss decreased (-0.439290 --> -0.560678).  Saving model ...
Epoch: 6 cost time: 5.2974255084991455
Epoch: 6, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.390 Vali Acc: 0.555 Test Loss: 1.390 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.301817893981934
Epoch: 7, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.230 Vali Acc: 0.642 Test Loss: 1.230 Test Acc: 0.642
Validation loss decreased (-0.560678 --> -0.641606).  Saving model ...
Epoch: 8 cost time: 4.98085618019104
Epoch: 8, Steps: 17 | Train Loss: 0.672 Vali Loss: 1.070 Vali Acc: 0.653 Test Loss: 1.070 Test Acc: 0.653
Validation loss decreased (-0.641606 --> -0.653168).  Saving model ...
Epoch: 9 cost time: 5.134033203125
Epoch: 9, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.958 Vali Acc: 0.665 Test Loss: 0.958 Test Acc: 0.665
Validation loss decreased (-0.653168 --> -0.664730).  Saving model ...
Epoch: 10 cost time: 5.104244232177734
Epoch: 10, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.856 Vali Acc: 0.694 Test Loss: 0.856 Test Acc: 0.694
Validation loss decreased (-0.664730 --> -0.693633).  Saving model ...
Epoch: 11 cost time: 5.296370267868042
Epoch: 11, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.800 Vali Acc: 0.723 Test Loss: 0.800 Test Acc: 0.723
Validation loss decreased (-0.693633 --> -0.722535).  Saving model ...
Epoch: 12 cost time: 5.4656219482421875
Epoch: 12, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.744 Vali Acc: 0.746 Test Loss: 0.744 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745657).  Saving model ...
Epoch: 13 cost time: 5.239690542221069
Epoch: 13, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.712 Vali Acc: 0.751 Test Loss: 0.712 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751438).  Saving model ...
Epoch: 14 cost time: 5.2055885791778564
Epoch: 14, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.691 Vali Acc: 0.734 Test Loss: 0.691 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.253176689147949
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.683 Vali Acc: 0.740 Test Loss: 0.683 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.321029424667358
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.666 Vali Acc: 0.740 Test Loss: 0.666 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.271094083786011
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.656 Vali Acc: 0.746 Test Loss: 0.656 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.064727783203125
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.645 Vali Acc: 0.780 Test Loss: 0.645 Test Acc: 0.780
Validation loss decreased (-0.751438 --> -0.780340).  Saving model ...
Epoch: 19 cost time: 5.179084300994873
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.630 Vali Acc: 0.757 Test Loss: 0.630 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.1956610679626465
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.627 Vali Acc: 0.746 Test Loss: 0.627 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.26822829246521
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.751 Test Loss: 0.618 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.953916549682617
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.615 Vali Acc: 0.763 Test Loss: 0.615 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.471063613891602
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.780 Test Loss: 0.618 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780341).  Saving model ...
Epoch: 24 cost time: 5.408706188201904
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.615 Vali Acc: 0.746 Test Loss: 0.615 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.1504905223846436
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.611 Vali Acc: 0.769 Test Loss: 0.611 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.176860809326172
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.769 Test Loss: 0.607 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.390995740890503
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.290859937667847
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.1954662799835205
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.729254484176636
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.589505672454834
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.769 Test Loss: 0.596 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.932234287261963
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.886851072311401
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.775 Test Loss: 0.591 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.79377818107605
Epoch: 1, Steps: 17 | Train Loss: 1.976 Vali Loss: 2.010 Vali Acc: 0.145 Test Loss: 2.010 Test Acc: 0.145
Validation loss decreased (inf --> -0.144489).  Saving model ...
Epoch: 2 cost time: 5.947016716003418
Epoch: 2, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.954 Vali Acc: 0.179 Test Loss: 1.954 Test Acc: 0.179
Validation loss decreased (-0.144489 --> -0.179171).  Saving model ...
Epoch: 3 cost time: 5.598319053649902
Epoch: 3, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.874 Vali Acc: 0.237 Test Loss: 1.874 Test Acc: 0.237
Validation loss decreased (-0.179171 --> -0.236975).  Saving model ...
Epoch: 4 cost time: 5.524626731872559
Epoch: 4, Steps: 17 | Train Loss: 1.639 Vali Loss: 1.741 Vali Acc: 0.353 Test Loss: 1.741 Test Acc: 0.353
Validation loss decreased (-0.236975 --> -0.352584).  Saving model ...
Epoch: 5 cost time: 5.421046257019043
Epoch: 5, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.615 Vali Acc: 0.486 Test Loss: 1.615 Test Acc: 0.486
Validation loss decreased (-0.352584 --> -0.485533).  Saving model ...
Epoch: 6 cost time: 5.369464874267578
Epoch: 6, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.471 Vali Acc: 0.549 Test Loss: 1.471 Test Acc: 0.549
Validation loss decreased (-0.485533 --> -0.549118).  Saving model ...
Epoch: 7 cost time: 5.060291051864624
Epoch: 7, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.299 Vali Acc: 0.636 Test Loss: 1.299 Test Acc: 0.636
Validation loss decreased (-0.549118 --> -0.635825).  Saving model ...
Epoch: 8 cost time: 5.228972434997559
Epoch: 8, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.131 Vali Acc: 0.647 Test Loss: 1.131 Test Acc: 0.647
Validation loss decreased (-0.635825 --> -0.647388).  Saving model ...
Epoch: 9 cost time: 4.9419286251068115
Epoch: 9, Steps: 17 | Train Loss: 0.624 Vali Loss: 1.031 Vali Acc: 0.665 Test Loss: 1.031 Test Acc: 0.665
Validation loss decreased (-0.647388 --> -0.664730).  Saving model ...
Epoch: 10 cost time: 5.326364040374756
Epoch: 10, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.894 Vali Acc: 0.676 Test Loss: 0.894 Test Acc: 0.676
Validation loss decreased (-0.664730 --> -0.676292).  Saving model ...
Epoch: 11 cost time: 6.200307607650757
Epoch: 11, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.818 Vali Acc: 0.688 Test Loss: 0.818 Test Acc: 0.688
Validation loss decreased (-0.676292 --> -0.687853).  Saving model ...
Epoch: 12 cost time: 5.721338987350464
Epoch: 12, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.778 Vali Acc: 0.699 Test Loss: 0.778 Test Acc: 0.699
Validation loss decreased (-0.687853 --> -0.699414).  Saving model ...
Epoch: 13 cost time: 5.80774712562561
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.761 Vali Acc: 0.682 Test Loss: 0.761 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.0116589069366455
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.745 Vali Acc: 0.671 Test Loss: 0.745 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.210968732833862
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.720 Vali Acc: 0.734 Test Loss: 0.720 Test Acc: 0.734
Validation loss decreased (-0.699414 --> -0.734097).  Saving model ...
Epoch: 16 cost time: 6.206798553466797
Epoch: 16, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.724 Vali Acc: 0.723 Test Loss: 0.724 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.039067983627319
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.724 Vali Acc: 0.711 Test Loss: 0.724 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.219228506088257
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.725 Vali Acc: 0.717 Test Loss: 0.725 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.233798027038574
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.765359401702881
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.721 Vali Acc: 0.723 Test Loss: 0.721 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.722511529922485
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.715 Vali Acc: 0.728 Test Loss: 0.715 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.766362190246582
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.710 Vali Acc: 0.723 Test Loss: 0.710 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.947921991348267
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.710 Vali Acc: 0.723 Test Loss: 0.710 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.505241394042969
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.869462966918945
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7341040462427746
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.1183388233184814
Epoch: 1, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.959 Vali Acc: 0.162 Test Loss: 1.959 Test Acc: 0.162
Validation loss decreased (inf --> -0.161830).  Saving model ...
Epoch: 2 cost time: 5.791964054107666
Epoch: 2, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.901 Vali Acc: 0.202 Test Loss: 1.901 Test Acc: 0.202
Validation loss decreased (-0.161830 --> -0.202293).  Saving model ...
Epoch: 3 cost time: 5.403766393661499
Epoch: 3, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.829 Vali Acc: 0.272 Test Loss: 1.829 Test Acc: 0.272
Validation loss decreased (-0.202293 --> -0.271658).  Saving model ...
Epoch: 4 cost time: 5.51865553855896
Epoch: 4, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.686 Vali Acc: 0.410 Test Loss: 1.686 Test Acc: 0.410
Validation loss decreased (-0.271658 --> -0.410388).  Saving model ...
Epoch: 5 cost time: 5.174231767654419
Epoch: 5, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.556 Vali Acc: 0.532 Test Loss: 1.556 Test Acc: 0.532
Validation loss decreased (-0.410388 --> -0.531776).  Saving model ...
Epoch: 6 cost time: 5.552757024765015
Epoch: 6, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.428 Vali Acc: 0.561 Test Loss: 1.428 Test Acc: 0.561
Validation loss decreased (-0.531776 --> -0.560679).  Saving model ...
Epoch: 7 cost time: 5.7566399574279785
Epoch: 7, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.264 Vali Acc: 0.624 Test Loss: 1.264 Test Acc: 0.624
Validation loss decreased (-0.560679 --> -0.624265).  Saving model ...
Epoch: 8 cost time: 5.713484287261963
Epoch: 8, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.098 Vali Acc: 0.647 Test Loss: 1.098 Test Acc: 0.647
Validation loss decreased (-0.624265 --> -0.647388).  Saving model ...
Epoch: 9 cost time: 5.6488823890686035
Epoch: 9, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.982 Vali Acc: 0.647 Test Loss: 0.982 Test Acc: 0.647
Validation loss decreased (-0.647388 --> -0.647389).  Saving model ...
Epoch: 10 cost time: 5.535672187805176
Epoch: 10, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.864 Vali Acc: 0.699 Test Loss: 0.864 Test Acc: 0.699
Validation loss decreased (-0.647389 --> -0.699413).  Saving model ...
Epoch: 11 cost time: 5.189584970474243
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
Validation loss decreased (-0.699413 --> -0.710975).  Saving model ...
Epoch: 12 cost time: 5.255661964416504
Epoch: 12, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.727 Vali Acc: 0.751 Test Loss: 0.727 Test Acc: 0.751
Validation loss decreased (-0.710975 --> -0.751438).  Saving model ...
Epoch: 13 cost time: 5.244314908981323
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.711 Vali Acc: 0.723 Test Loss: 0.711 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.6392903327941895
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.689 Vali Acc: 0.740 Test Loss: 0.689 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.950777530670166
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.666 Vali Acc: 0.751 Test Loss: 0.666 Test Acc: 0.751
Validation loss decreased (-0.751438 --> -0.751438).  Saving model ...
Epoch: 16 cost time: 5.19733190536499
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.660 Vali Acc: 0.751 Test Loss: 0.660 Test Acc: 0.751
Validation loss decreased (-0.751438 --> -0.751438).  Saving model ...
Epoch: 17 cost time: 5.905337572097778
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.655 Vali Acc: 0.751 Test Loss: 0.655 Test Acc: 0.751
Validation loss decreased (-0.751438 --> -0.751439).  Saving model ...
Epoch: 18 cost time: 5.7507243156433105
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 19 cost time: 5.379658222198486
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 20 cost time: 5.76324200630188
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.785688400268555
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.638 Vali Acc: 0.751 Test Loss: 0.638 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 22 cost time: 5.8411805629730225
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.633 Vali Acc: 0.746 Test Loss: 0.633 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.907182693481445
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.728181838989258
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.622 Vali Acc: 0.751 Test Loss: 0.622 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 25 cost time: 5.148480415344238
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.751 Test Loss: 0.619 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 26 cost time: 5.614498853683472
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.616 Vali Acc: 0.751 Test Loss: 0.616 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 27 cost time: 5.5028908252716064
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 28 cost time: 5.461726903915405
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.616 Vali Acc: 0.751 Test Loss: 0.616 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.026169538497925
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
Validation loss decreased (-0.751439 --> -0.763000).  Saving model ...
Epoch: 30 cost time: 5.844283819198608
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.603 Vali Acc: 0.769 Test Loss: 0.603 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 31 cost time: 5.733034133911133
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.769 Test Loss: 0.602 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 32 cost time: 5.904632568359375
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.022644281387329
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.81571626663208
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.402085542678833
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.044711589813232
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.930745363235474
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.978348255157471
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 39 cost time: 5.051374912261963
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.775 Test Loss: 0.582 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774561).  Saving model ...
Epoch: 40 cost time: 5.017700910568237
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.577 Vali Acc: 0.769 Test Loss: 0.577 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.14460563659668
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.310229063034058
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.769 Test Loss: 0.578 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.401981592178345
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.590253829956055
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.574 Vali Acc: 0.769 Test Loss: 0.574 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.583327293395996
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.786 Test Loss: 0.574 Test Acc: 0.786
Validation loss decreased (-0.774561 --> -0.786121).  Saving model ...
Epoch: 46 cost time: 5.723116636276245
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.792 Test Loss: 0.572 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 47 cost time: 4.743596076965332
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.786 Test Loss: 0.567 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 5.5138022899627686
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.786 Test Loss: 0.566 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 5.496129989624023
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.786 Test Loss: 0.566 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 5.398501873016357
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.792 Test Loss: 0.564 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 51 cost time: 5.508664131164551
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.792 Test Loss: 0.561 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 52 cost time: 5.4992451667785645
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.792 Test Loss: 0.563 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 5.818460702896118
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.786 Test Loss: 0.566 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 5.7587645053863525
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.786 Test Loss: 0.565 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 5.80053448677063
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.792 Test Loss: 0.562 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 5.64701509475708
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.792 Test Loss: 0.561 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 5.871484994888306
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.792 Test Loss: 0.561 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 5.952446699142456
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.792 Test Loss: 0.560 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 59 cost time: 5.371424198150635
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.786 Test Loss: 0.564 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.3860907554626465
Epoch: 60, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.792 Test Loss: 0.563 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.312683820724487
Epoch: 61, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.792 Test Loss: 0.557 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 62 cost time: 5.452566862106323
Epoch: 62, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.792 Test Loss: 0.555 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 63 cost time: 5.150834798812866
Epoch: 63, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.792 Test Loss: 0.554 Test Acc: 0.792
Validation loss decreased (-0.791902 --> -0.791902).  Saving model ...
Epoch: 64 cost time: 5.730272054672241
Epoch: 64, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 65 cost time: 5.698279142379761
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
Validation loss decreased (-0.803463 --> -0.803463).  Saving model ...
Epoch: 66 cost time: 5.701557636260986
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 5.929174184799194
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.803 Test Loss: 0.552 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 5.223446369171143
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 5.6326987743377686
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 5.8418800830841064
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 5.480950593948364
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 5.563966274261475
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 5.097447395324707
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 5.202211618423462
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 5.326952934265137
Epoch: 75, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.978602647781372
Epoch: 1, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
Validation loss decreased (inf --> -0.115587).  Saving model ...
Epoch: 2 cost time: 5.759441614151001
Epoch: 2, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.614515542984009
Epoch: 3, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.459553956985474
Epoch: 4, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.2846996784210205
Epoch: 5, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.171685695648193
Epoch: 6, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.0792741775512695
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.038080930709839
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.88925838470459
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.86496639251709
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.5803282260894775
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.948 Vali Acc: 0.116 Test Loss: 1.948 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.11560693641618497
model parameter : 363847
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.0495524406433105
Epoch: 1, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.677 Vali Acc: 0.335 Test Loss: 1.677 Test Acc: 0.335
Validation loss decreased (inf --> -0.335243).  Saving model ...
Epoch: 2 cost time: 5.776917934417725
Epoch: 2, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.387 Vali Acc: 0.399 Test Loss: 1.387 Test Acc: 0.399
Validation loss decreased (-0.335243 --> -0.398830).  Saving model ...
Epoch: 3 cost time: 5.516148567199707
Epoch: 3, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.185 Vali Acc: 0.566 Test Loss: 1.185 Test Acc: 0.566
Validation loss decreased (-0.398830 --> -0.566462).  Saving model ...
Epoch: 4 cost time: 5.487818241119385
Epoch: 4, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.054 Vali Acc: 0.711 Test Loss: 1.054 Test Acc: 0.711
Validation loss decreased (-0.566462 --> -0.710972).  Saving model ...
Epoch: 5 cost time: 5.2272844314575195
Epoch: 5, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.910 Vali Acc: 0.717 Test Loss: 0.910 Test Acc: 0.717
Validation loss decreased (-0.710972 --> -0.716754).  Saving model ...
Epoch: 6 cost time: 5.389772653579712
Epoch: 6, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.794 Vali Acc: 0.723 Test Loss: 0.794 Test Acc: 0.723
Validation loss decreased (-0.716754 --> -0.722535).  Saving model ...
Epoch: 7 cost time: 5.321180582046509
Epoch: 7, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.722535 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 5.087208271026611
Epoch: 8, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.546 Vali Acc: 0.798 Test Loss: 0.546 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.593224048614502
Epoch: 9, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.526 Vali Acc: 0.827 Test Loss: 0.526 Test Acc: 0.827
Validation loss decreased (-0.803462 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 5.564687967300415
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.463 Vali Acc: 0.838 Test Loss: 0.463 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 5.212147951126099
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.585 Vali Acc: 0.798 Test Loss: 0.585 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.315810203552246
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.496 Vali Acc: 0.827 Test Loss: 0.496 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.655142784118652
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
Validation loss decreased (-0.838146 --> -0.843926).  Saving model ...
Epoch: 14 cost time: 5.481025695800781
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.524 Vali Acc: 0.815 Test Loss: 0.524 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.620776891708374
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.512 Vali Acc: 0.838 Test Loss: 0.512 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.315209627151489
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.968640565872192
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.533 Vali Acc: 0.827 Test Loss: 0.533 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.491674900054932
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.827 Test Loss: 0.538 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.591912508010864
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.827 Test Loss: 0.531 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.219468593597412
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.821 Test Loss: 0.564 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.775710821151733
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.838 Test Loss: 0.547 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.984830141067505
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.572 Vali Acc: 0.827 Test Loss: 0.572 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.767016410827637
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.827 Test Loss: 0.557 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.19926118850708
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.718 Vali Acc: 0.306 Test Loss: 1.718 Test Acc: 0.306
Validation loss decreased (inf --> -0.306341).  Saving model ...
Epoch: 2 cost time: 5.765725612640381
Epoch: 2, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.439 Vali Acc: 0.422 Test Loss: 1.439 Test Acc: 0.422
Validation loss decreased (-0.306341 --> -0.421951).  Saving model ...
Epoch: 3 cost time: 5.428680896759033
Epoch: 3, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.189 Vali Acc: 0.613 Test Loss: 1.189 Test Acc: 0.613
Validation loss decreased (-0.421951 --> -0.612705).  Saving model ...
Epoch: 4 cost time: 5.634338140487671
Epoch: 4, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.057 Vali Acc: 0.671 Test Loss: 1.057 Test Acc: 0.671
Validation loss decreased (-0.612705 --> -0.670510).  Saving model ...
Epoch: 5 cost time: 5.7800986766815186
Epoch: 5, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.905 Vali Acc: 0.734 Test Loss: 0.905 Test Acc: 0.734
Validation loss decreased (-0.670510 --> -0.734095).  Saving model ...
Epoch: 6 cost time: 5.55528450012207
Epoch: 6, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
Validation loss decreased (-0.734095 --> -0.774559).  Saving model ...
Epoch: 7 cost time: 5.159734010696411
Epoch: 7, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.589 Vali Acc: 0.821 Test Loss: 0.589 Test Acc: 0.821
Validation loss decreased (-0.774559 --> -0.820803).  Saving model ...
Epoch: 8 cost time: 4.84081768989563
Epoch: 8, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.545 Vali Acc: 0.821 Test Loss: 0.545 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820804).  Saving model ...
Epoch: 9 cost time: 5.487357139587402
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838145).  Saving model ...
Epoch: 10 cost time: 5.53914475440979
Epoch: 10, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.494 Vali Acc: 0.815 Test Loss: 0.494 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.51123571395874
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.507 Vali Acc: 0.838 Test Loss: 0.507 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 12 cost time: 5.795622825622559
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.493 Vali Acc: 0.821 Test Loss: 0.493 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.230736017227173
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.507 Vali Acc: 0.827 Test Loss: 0.507 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.284283876419067
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.531 Vali Acc: 0.832 Test Loss: 0.531 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.253640413284302
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.509 Vali Acc: 0.832 Test Loss: 0.509 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.425570726394653
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.827 Test Loss: 0.536 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.29620361328125
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.537 Vali Acc: 0.827 Test Loss: 0.537 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.472474098205566
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.541 Vali Acc: 0.827 Test Loss: 0.541 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.193326473236084
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.078861951828003
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.561 Vali Acc: 0.832 Test Loss: 0.561 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.252403259277344
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.563 Vali Acc: 0.838 Test Loss: 0.563 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.768873929977417
Epoch: 1, Steps: 17 | Train Loss: 1.932 Vali Loss: 1.793 Vali Acc: 0.289 Test Loss: 1.793 Test Acc: 0.289
Validation loss decreased (inf --> -0.288999).  Saving model ...
Epoch: 2 cost time: 5.523097276687622
Epoch: 2, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.527 Vali Acc: 0.393 Test Loss: 1.527 Test Acc: 0.393
Validation loss decreased (-0.288999 --> -0.393048).  Saving model ...
Epoch: 3 cost time: 5.17101788520813
Epoch: 3, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.234 Vali Acc: 0.590 Test Loss: 1.234 Test Acc: 0.590
Validation loss decreased (-0.393048 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 5.205569505691528
Epoch: 4, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.064 Vali Acc: 0.630 Test Loss: 1.064 Test Acc: 0.630
Validation loss decreased (-0.589583 --> -0.630047).  Saving model ...
Epoch: 5 cost time: 5.551598310470581
Epoch: 5, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.907 Vali Acc: 0.699 Test Loss: 0.907 Test Acc: 0.699
Validation loss decreased (-0.630047 --> -0.699413).  Saving model ...
Epoch: 6 cost time: 5.305100440979004
Epoch: 6, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.727 Vali Acc: 0.780 Test Loss: 0.727 Test Acc: 0.780
Validation loss decreased (-0.699413 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 4.713038921356201
Epoch: 7, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.561 Vali Acc: 0.815 Test Loss: 0.561 Test Acc: 0.815
Validation loss decreased (-0.780340 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 4.7911272048950195
Epoch: 8, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.496 Vali Acc: 0.815 Test Loss: 0.496 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815024).  Saving model ...
Epoch: 9 cost time: 5.107675790786743
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.486 Vali Acc: 0.798 Test Loss: 0.486 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.632253408432007
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.471 Vali Acc: 0.803 Test Loss: 0.471 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.781468629837036
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.495 Vali Acc: 0.815 Test Loss: 0.495 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 12 cost time: 5.4406726360321045
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.821 Test Loss: 0.480 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 5.210353374481201
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.482 Vali Acc: 0.832 Test Loss: 0.482 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832365).  Saving model ...
Epoch: 14 cost time: 5.745894432067871
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.496 Vali Acc: 0.815 Test Loss: 0.496 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.592844486236572
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.1098034381866455
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.496 Vali Acc: 0.815 Test Loss: 0.496 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.2312376499176025
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.815 Test Loss: 0.499 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.86551308631897
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.827 Test Loss: 0.508 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.056091785430908
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.507 Vali Acc: 0.821 Test Loss: 0.507 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.368674039840698
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.827 Test Loss: 0.509 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.157727003097534
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.838 Test Loss: 0.510 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 22 cost time: 4.967680931091309
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.514 Vali Acc: 0.827 Test Loss: 0.514 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.249975681304932
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.827 Test Loss: 0.515 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.210647106170654
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.523 Vali Acc: 0.832 Test Loss: 0.523 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.177655220031738
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.832 Test Loss: 0.535 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.2276811599731445
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.827 Test Loss: 0.529 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.125276565551758
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.988075017929077
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.537 Vali Acc: 0.832 Test Loss: 0.537 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.928524732589722
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.832 Test Loss: 0.544 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.899653196334839
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.832 Test Loss: 0.540 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.725301504135132
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843925).  Saving model ...
Epoch: 32 cost time: 4.889835357666016
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.832 Test Loss: 0.553 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.585615396499634
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.832 Test Loss: 0.553 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.875795125961304
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.152399063110352
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.832 Test Loss: 0.560 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.3580002784729
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.832 Test Loss: 0.564 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.485550165176392
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.832 Test Loss: 0.569 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 5.229250431060791
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.832 Test Loss: 0.564 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.052814722061157
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.838 Test Loss: 0.566 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 5.418412923812866
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.838 Test Loss: 0.567 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 5.013505697250366
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.832 Test Loss: 0.570 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.074936866760254
Epoch: 1, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.875 Vali Acc: 0.162 Test Loss: 1.875 Test Acc: 0.162
Validation loss decreased (inf --> -0.161831).  Saving model ...
Epoch: 2 cost time: 5.413470029830933
Epoch: 2, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.659 Vali Acc: 0.399 Test Loss: 1.659 Test Acc: 0.399
Validation loss decreased (-0.161831 --> -0.398827).  Saving model ...
Epoch: 3 cost time: 5.7195985317230225
Epoch: 3, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.367 Vali Acc: 0.613 Test Loss: 1.367 Test Acc: 0.613
Validation loss decreased (-0.398827 --> -0.612703).  Saving model ...
Epoch: 4 cost time: 5.660160541534424
Epoch: 4, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.137 Vali Acc: 0.694 Test Loss: 1.137 Test Acc: 0.694
Validation loss decreased (-0.612703 --> -0.693630).  Saving model ...
Epoch: 5 cost time: 6.0401787757873535
Epoch: 5, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.955 Vali Acc: 0.711 Test Loss: 0.955 Test Acc: 0.711
Validation loss decreased (-0.693630 --> -0.710973).  Saving model ...
Epoch: 6 cost time: 5.786839485168457
Epoch: 6, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.710973 --> -0.774559).  Saving model ...
Epoch: 7 cost time: 5.6945390701293945
Epoch: 7, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
Validation loss decreased (-0.774559 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 5.668670654296875
Epoch: 8, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 6.464339256286621
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.507 Vali Acc: 0.815 Test Loss: 0.507 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 5.3438451290130615
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.498 Vali Acc: 0.798 Test Loss: 0.498 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.370134115219116
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.499 Vali Acc: 0.786 Test Loss: 0.499 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.232399225234985
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.491 Vali Acc: 0.798 Test Loss: 0.491 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.8566412925720215
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.484 Vali Acc: 0.815 Test Loss: 0.484 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 14 cost time: 5.589978933334351
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.492 Vali Acc: 0.809 Test Loss: 0.492 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.649998188018799
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.936956167221069
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.495 Vali Acc: 0.821 Test Loss: 0.495 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820804).  Saving model ...
Epoch: 17 cost time: 6.119569778442383
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.496 Vali Acc: 0.821 Test Loss: 0.496 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.464699983596802
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.495 Vali Acc: 0.815 Test Loss: 0.495 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.360555410385132
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.963715553283691
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.809 Test Loss: 0.499 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.675349950790405
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.1766979694366455
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.464860916137695
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.500 Vali Acc: 0.815 Test Loss: 0.500 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.876793384552002
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.501 Vali Acc: 0.815 Test Loss: 0.501 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.563642740249634
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.342248916625977
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.505 Vali Acc: 0.815 Test Loss: 0.505 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.150721788406372
Epoch: 1, Steps: 17 | Train Loss: 1.978 Vali Loss: 1.907 Vali Acc: 0.191 Test Loss: 1.907 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 5.703051805496216
Epoch: 2, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.803 Vali Acc: 0.260 Test Loss: 1.803 Test Acc: 0.260
Validation loss decreased (-0.190732 --> -0.260098).  Saving model ...
Epoch: 3 cost time: 5.929853916168213
Epoch: 3, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.605 Vali Acc: 0.474 Test Loss: 1.605 Test Acc: 0.474
Validation loss decreased (-0.260098 --> -0.473972).  Saving model ...
Epoch: 4 cost time: 6.137742280960083
Epoch: 4, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.426 Vali Acc: 0.613 Test Loss: 1.426 Test Acc: 0.613
Validation loss decreased (-0.473972 --> -0.612702).  Saving model ...
Epoch: 5 cost time: 6.025022506713867
Epoch: 5, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.226 Vali Acc: 0.711 Test Loss: 1.226 Test Acc: 0.711
Validation loss decreased (-0.612702 --> -0.710970).  Saving model ...
Epoch: 6 cost time: 5.05128288269043
Epoch: 6, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.006 Vali Acc: 0.780 Test Loss: 1.006 Test Acc: 0.780
Validation loss decreased (-0.710970 --> -0.780337).  Saving model ...
Epoch: 7 cost time: 5.263759613037109
Epoch: 7, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.812 Vali Acc: 0.809 Test Loss: 0.812 Test Acc: 0.809
Validation loss decreased (-0.780337 --> -0.809240).  Saving model ...
Epoch: 8 cost time: 5.341417551040649
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
Validation loss decreased (-0.809240 --> -0.849704).  Saving model ...
Epoch: 9 cost time: 5.341057777404785
Epoch: 9, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.576 Vali Acc: 0.832 Test Loss: 0.576 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.788673639297485
Epoch: 10, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
Validation loss decreased (-0.849704 --> -0.867047).  Saving model ...
Epoch: 11 cost time: 6.0050647258758545
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.985581636428833
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.0861945152282715
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.786486625671387
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.562469959259033
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.906087160110474
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.629823923110962
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.429486036300659
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.134753465652466
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.738954305648804
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.335634469985962
Epoch: 1, Steps: 17 | Train Loss: 1.965 Vali Loss: 1.893 Vali Acc: 0.191 Test Loss: 1.893 Test Acc: 0.191
Validation loss decreased (inf --> -0.190733).  Saving model ...
Epoch: 2 cost time: 5.867981910705566
Epoch: 2, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.835 Vali Acc: 0.243 Test Loss: 1.835 Test Acc: 0.243
Validation loss decreased (-0.190733 --> -0.242756).  Saving model ...
Epoch: 3 cost time: 5.99097466468811
Epoch: 3, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.673 Vali Acc: 0.428 Test Loss: 1.673 Test Acc: 0.428
Validation loss decreased (-0.242756 --> -0.427729).  Saving model ...
Epoch: 4 cost time: 5.703428745269775
Epoch: 4, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.530 Vali Acc: 0.607 Test Loss: 1.530 Test Acc: 0.607
Validation loss decreased (-0.427729 --> -0.606921).  Saving model ...
Epoch: 5 cost time: 5.884486675262451
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.377 Vali Acc: 0.601 Test Loss: 1.377 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.78496241569519
Epoch: 6, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.202 Vali Acc: 0.694 Test Loss: 1.202 Test Acc: 0.694
Validation loss decreased (-0.606921 --> -0.693630).  Saving model ...
Epoch: 7 cost time: 5.171056509017944
Epoch: 7, Steps: 17 | Train Loss: 0.753 Vali Loss: 1.026 Vali Acc: 0.705 Test Loss: 1.026 Test Acc: 0.705
Validation loss decreased (-0.693630 --> -0.705192).  Saving model ...
Epoch: 8 cost time: 5.378835916519165
Epoch: 8, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.889 Vali Acc: 0.711 Test Loss: 0.889 Test Acc: 0.711
Validation loss decreased (-0.705192 --> -0.710974).  Saving model ...
Epoch: 9 cost time: 5.246444463729858
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.759 Vali Acc: 0.740 Test Loss: 0.759 Test Acc: 0.740
Validation loss decreased (-0.710974 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 5.850216388702393
Epoch: 10, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.9760284423828125
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.657 Vali Acc: 0.723 Test Loss: 0.657 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.389713764190674
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.633 Vali Acc: 0.751 Test Loss: 0.633 Test Acc: 0.751
Validation loss decreased (-0.739877 --> -0.751439).  Saving model ...
Epoch: 13 cost time: 5.96938681602478
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.622 Vali Acc: 0.734 Test Loss: 0.622 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.47502326965332
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.618 Vali Acc: 0.734 Test Loss: 0.618 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.743753671646118
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.609 Vali Acc: 0.723 Test Loss: 0.609 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.255849361419678
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 17 cost time: 5.652246713638306
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
Validation loss decreased (-0.757219 --> -0.763000).  Saving model ...
Epoch: 18 cost time: 4.930105209350586
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.4427900314331055
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.050308465957642
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 21 cost time: 4.976330518722534
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.600 Vali Acc: 0.711 Test Loss: 0.600 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.343138933181763
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.268299341201782
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.751 Test Loss: 0.597 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.758620977401733
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.93405294418335
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.7440338134765625
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.970893144607544
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.501085519790649
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.763000 --> -0.763000).  Saving model ...
Epoch: 29 cost time: 5.198551654815674
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.769 Test Loss: 0.590 Test Acc: 0.769
Validation loss decreased (-0.763000 --> -0.768780).  Saving model ...
Epoch: 30 cost time: 5.006493091583252
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.775 Test Loss: 0.591 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774561).  Saving model ...
Epoch: 31 cost time: 5.31678032875061
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.775 Test Loss: 0.591 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.456578254699707
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.478715181350708
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.187688589096069
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.328949689865112
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.585 Vali Acc: 0.775 Test Loss: 0.585 Test Acc: 0.775
Validation loss decreased (-0.774561 --> -0.774561).  Saving model ...
Epoch: 36 cost time: 5.472716331481934
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.512057781219482
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.511862277984619
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.769 Test Loss: 0.585 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.260059356689453
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.360761880874634
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 5.529768943786621
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.763 Test Loss: 0.586 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 5.133527040481567
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 5.39309024810791
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.763 Test Loss: 0.588 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.339360475540161
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.769 Test Loss: 0.590 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 5.265944242477417
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.067079782485962
Epoch: 1, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.940 Vali Acc: 0.191 Test Loss: 1.940 Test Acc: 0.191
Validation loss decreased (inf --> -0.190732).  Saving model ...
Epoch: 2 cost time: 5.419475317001343
Epoch: 2, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.894 Vali Acc: 0.249 Test Loss: 1.894 Test Acc: 0.249
Validation loss decreased (-0.190732 --> -0.248536).  Saving model ...
Epoch: 3 cost time: 5.298567295074463
Epoch: 3, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.776 Vali Acc: 0.405 Test Loss: 1.776 Test Acc: 0.405
Validation loss decreased (-0.248536 --> -0.404607).  Saving model ...
Epoch: 4 cost time: 5.22843337059021
Epoch: 4, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.664 Vali Acc: 0.486 Test Loss: 1.664 Test Acc: 0.486
Validation loss decreased (-0.404607 --> -0.485532).  Saving model ...
Epoch: 5 cost time: 5.308558225631714
Epoch: 5, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.549 Vali Acc: 0.595 Test Loss: 1.549 Test Acc: 0.595
Validation loss decreased (-0.485532 --> -0.595360).  Saving model ...
Epoch: 6 cost time: 5.3666932582855225
Epoch: 6, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.400 Vali Acc: 0.642 Test Loss: 1.400 Test Acc: 0.642
Validation loss decreased (-0.595360 --> -0.641604).  Saving model ...
Epoch: 7 cost time: 4.823774576187134
Epoch: 7, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.256 Vali Acc: 0.630 Test Loss: 1.256 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.814807176589966
Epoch: 8, Steps: 17 | Train Loss: 0.712 Vali Loss: 1.119 Vali Acc: 0.636 Test Loss: 1.119 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.837443590164185
Epoch: 9, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.978 Vali Acc: 0.682 Test Loss: 0.978 Test Acc: 0.682
Validation loss decreased (-0.641604 --> -0.682071).  Saving model ...
Epoch: 10 cost time: 4.918055534362793
Epoch: 10, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.897 Vali Acc: 0.682 Test Loss: 0.897 Test Acc: 0.682
Validation loss decreased (-0.682071 --> -0.682072).  Saving model ...
Epoch: 11 cost time: 4.880842447280884
Epoch: 11, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.806 Vali Acc: 0.705 Test Loss: 0.806 Test Acc: 0.705
Validation loss decreased (-0.682072 --> -0.705194).  Saving model ...
Epoch: 12 cost time: 4.528467178344727
Epoch: 12, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
Validation loss decreased (-0.705194 --> -0.710975).  Saving model ...
Epoch: 13 cost time: 4.820488691329956
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.737 Vali Acc: 0.705 Test Loss: 0.737 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.196677923202515
Epoch: 14, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.733 Vali Acc: 0.711 Test Loss: 0.733 Test Acc: 0.711
Validation loss decreased (-0.710975 --> -0.710975).  Saving model ...
Epoch: 15 cost time: 5.003139972686768
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.716 Vali Acc: 0.728 Test Loss: 0.716 Test Acc: 0.728
Validation loss decreased (-0.710975 --> -0.728317).  Saving model ...
Epoch: 16 cost time: 5.658365488052368
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.697 Vali Acc: 0.723 Test Loss: 0.697 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.3203301429748535
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.690 Vali Acc: 0.723 Test Loss: 0.690 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.117520809173584
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.684 Vali Acc: 0.711 Test Loss: 0.684 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.335574626922607
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.070530414581299
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.673 Vali Acc: 0.740 Test Loss: 0.673 Test Acc: 0.740
Validation loss decreased (-0.728317 --> -0.739878).  Saving model ...
Epoch: 21 cost time: 5.173677206039429
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.661 Vali Acc: 0.740 Test Loss: 0.661 Test Acc: 0.740
Validation loss decreased (-0.739878 --> -0.739878).  Saving model ...
Epoch: 22 cost time: 5.0246686935424805
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.659 Vali Acc: 0.728 Test Loss: 0.659 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.582496166229248
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.651 Vali Acc: 0.734 Test Loss: 0.651 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.509763717651367
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
Validation loss decreased (-0.739878 --> -0.762999).  Saving model ...
Epoch: 25 cost time: 5.068825721740723
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.746 Test Loss: 0.646 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.490071773529053
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.646 Vali Acc: 0.728 Test Loss: 0.646 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.700378894805908
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.690737247467041
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.548889636993408
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.6707775592803955
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.740 Test Loss: 0.630 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.480136394500732
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.746 Test Loss: 0.626 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.913804531097412
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.966177463531494
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.617 Vali Acc: 0.751 Test Loss: 0.617 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.117398977279663
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.393527269363403
Epoch: 1, Steps: 17 | Train Loss: 2.039 Vali Loss: 1.962 Vali Acc: 0.173 Test Loss: 1.962 Test Acc: 0.173
Validation loss decreased (inf --> -0.173391).  Saving model ...
Epoch: 2 cost time: 5.2000086307525635
Epoch: 2, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.920 Vali Acc: 0.197 Test Loss: 1.920 Test Acc: 0.197
Validation loss decreased (-0.173391 --> -0.196513).  Saving model ...
Epoch: 3 cost time: 5.220318794250488
Epoch: 3, Steps: 17 | Train Loss: 1.817 Vali Loss: 1.816 Vali Acc: 0.306 Test Loss: 1.816 Test Acc: 0.306
Validation loss decreased (-0.196513 --> -0.306340).  Saving model ...
Epoch: 4 cost time: 5.349307060241699
Epoch: 4, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.720 Vali Acc: 0.387 Test Loss: 1.720 Test Acc: 0.387
Validation loss decreased (-0.306340 --> -0.387266).  Saving model ...
Epoch: 5 cost time: 5.464092254638672
Epoch: 5, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.617 Vali Acc: 0.468 Test Loss: 1.617 Test Acc: 0.468
Validation loss decreased (-0.387266 --> -0.468192).  Saving model ...
Epoch: 6 cost time: 5.592512607574463
Epoch: 6, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.480 Vali Acc: 0.555 Test Loss: 1.480 Test Acc: 0.555
Validation loss decreased (-0.468192 --> -0.554898).  Saving model ...
Epoch: 7 cost time: 5.569612503051758
Epoch: 7, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.361 Vali Acc: 0.572 Test Loss: 1.361 Test Acc: 0.572
Validation loss decreased (-0.554898 --> -0.572241).  Saving model ...
Epoch: 8 cost time: 5.524978876113892
Epoch: 8, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.205 Vali Acc: 0.584 Test Loss: 1.205 Test Acc: 0.584
Validation loss decreased (-0.572241 --> -0.583803).  Saving model ...
Epoch: 9 cost time: 5.6108717918396
Epoch: 9, Steps: 17 | Train Loss: 0.703 Vali Loss: 1.091 Vali Acc: 0.618 Test Loss: 1.091 Test Acc: 0.618
Validation loss decreased (-0.583803 --> -0.618486).  Saving model ...
Epoch: 10 cost time: 5.037776947021484
Epoch: 10, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.985 Vali Acc: 0.607 Test Loss: 0.985 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.890086650848389
Epoch: 11, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.891 Vali Acc: 0.630 Test Loss: 0.891 Test Acc: 0.630
Validation loss decreased (-0.618486 --> -0.630049).  Saving model ...
Epoch: 12 cost time: 5.351930379867554
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.816 Vali Acc: 0.705 Test Loss: 0.816 Test Acc: 0.705
Validation loss decreased (-0.630049 --> -0.705194).  Saving model ...
Epoch: 13 cost time: 5.514770746231079
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.786 Vali Acc: 0.659 Test Loss: 0.786 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.925397634506226
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.769 Vali Acc: 0.676 Test Loss: 0.769 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.052746772766113
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.752 Vali Acc: 0.705 Test Loss: 0.752 Test Acc: 0.705
Validation loss decreased (-0.705194 --> -0.705195).  Saving model ...
Epoch: 16 cost time: 5.298410415649414
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.750 Vali Acc: 0.723 Test Loss: 0.750 Test Acc: 0.723
Validation loss decreased (-0.705195 --> -0.722536).  Saving model ...
Epoch: 17 cost time: 5.6914167404174805
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.734 Vali Acc: 0.734 Test Loss: 0.734 Test Acc: 0.734
Validation loss decreased (-0.722536 --> -0.734097).  Saving model ...
Epoch: 18 cost time: 5.883106470108032
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.723 Vali Acc: 0.734 Test Loss: 0.723 Test Acc: 0.734
Validation loss decreased (-0.734097 --> -0.734097).  Saving model ...
Epoch: 19 cost time: 5.387906789779663
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.717 Vali Acc: 0.740 Test Loss: 0.717 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739877).  Saving model ...
Epoch: 20 cost time: 5.474710941314697
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.719 Vali Acc: 0.746 Test Loss: 0.719 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745658).  Saving model ...
Epoch: 21 cost time: 5.456705570220947
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.718 Vali Acc: 0.746 Test Loss: 0.718 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 22 cost time: 5.78641676902771
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.705 Vali Acc: 0.746 Test Loss: 0.705 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 23 cost time: 5.54104471206665
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 24 cost time: 5.233418226242065
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.692 Vali Acc: 0.751 Test Loss: 0.692 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751438).  Saving model ...
Epoch: 25 cost time: 5.418099641799927
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.751 Test Loss: 0.694 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.969457626342773
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.769 Test Loss: 0.692 Test Acc: 0.769
Validation loss decreased (-0.751438 --> -0.768779).  Saving model ...
Epoch: 27 cost time: 5.758274555206299
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.689 Vali Acc: 0.763 Test Loss: 0.689 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.5978684425354
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.866602182388306
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.672 Vali Acc: 0.757 Test Loss: 0.672 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.200739145278931
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.757 Test Loss: 0.671 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.071403980255127
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.775 Test Loss: 0.671 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774560).  Saving model ...
Epoch: 32 cost time: 5.59716796875
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.769 Test Loss: 0.666 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.730566024780273
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.769 Test Loss: 0.661 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.977300643920898
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.757 Test Loss: 0.655 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.546175956726074
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.530259609222412
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.376753091812134
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.763 Test Loss: 0.652 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.854898452758789
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.839686870574951
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.769 Test Loss: 0.644 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 5.686944484710693
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 5.612830638885498
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.842470645904541
Epoch: 1, Steps: 17 | Train Loss: 2.019 Vali Loss: 1.961 Vali Acc: 0.197 Test Loss: 1.961 Test Acc: 0.197
Validation loss decreased (inf --> -0.196512).  Saving model ...
Epoch: 2 cost time: 5.07856559753418
Epoch: 2, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.912 Vali Acc: 0.220 Test Loss: 1.912 Test Acc: 0.220
Validation loss decreased (-0.196512 --> -0.219634).  Saving model ...
Epoch: 3 cost time: 5.089651346206665
Epoch: 3, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.795 Vali Acc: 0.399 Test Loss: 1.795 Test Acc: 0.399
Validation loss decreased (-0.219634 --> -0.398826).  Saving model ...
Epoch: 4 cost time: 5.402660369873047
Epoch: 4, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.688 Vali Acc: 0.486 Test Loss: 1.688 Test Acc: 0.486
Validation loss decreased (-0.398826 --> -0.485532).  Saving model ...
Epoch: 5 cost time: 5.788026571273804
Epoch: 5, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.568 Vali Acc: 0.555 Test Loss: 1.568 Test Acc: 0.555
Validation loss decreased (-0.485532 --> -0.554898).  Saving model ...
Epoch: 6 cost time: 5.622886419296265
Epoch: 6, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.411 Vali Acc: 0.642 Test Loss: 1.411 Test Acc: 0.642
Validation loss decreased (-0.554898 --> -0.641604).  Saving model ...
Epoch: 7 cost time: 5.740569591522217
Epoch: 7, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.272 Vali Acc: 0.676 Test Loss: 1.272 Test Acc: 0.676
Validation loss decreased (-0.641604 --> -0.676288).  Saving model ...
Epoch: 8 cost time: 5.872859477996826
Epoch: 8, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.128 Vali Acc: 0.694 Test Loss: 1.128 Test Acc: 0.694
Validation loss decreased (-0.676288 --> -0.693630).  Saving model ...
Epoch: 9 cost time: 5.728510856628418
Epoch: 9, Steps: 17 | Train Loss: 0.660 Vali Loss: 1.002 Vali Acc: 0.734 Test Loss: 1.002 Test Acc: 0.734
Validation loss decreased (-0.693630 --> -0.734094).  Saving model ...
Epoch: 10 cost time: 5.074151277542114
Epoch: 10, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.897 Vali Acc: 0.705 Test Loss: 0.897 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.4006147384643555
Epoch: 11, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.805 Vali Acc: 0.699 Test Loss: 0.805 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.424164772033691
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.734 Vali Acc: 0.775 Test Loss: 0.734 Test Acc: 0.775
Validation loss decreased (-0.734094 --> -0.774559).  Saving model ...
Epoch: 13 cost time: 5.077694892883301
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.702 Vali Acc: 0.780 Test Loss: 0.702 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780340).  Saving model ...
Epoch: 14 cost time: 4.989677429199219
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.684 Vali Acc: 0.798 Test Loss: 0.684 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797681).  Saving model ...
Epoch: 15 cost time: 5.246187448501587
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.237315893173218
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.716376066207886
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.650 Vali Acc: 0.780 Test Loss: 0.650 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.500147819519043
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.630 Vali Acc: 0.792 Test Loss: 0.630 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.151803493499756
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809242).  Saving model ...
Epoch: 20 cost time: 5.172599792480469
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.354499578475952
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.630 Vali Acc: 0.786 Test Loss: 0.630 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.964004278182983
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 23 cost time: 4.717981576919556
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.5002760887146
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.548070192337036
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.792 Test Loss: 0.606 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.808006763458252
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.606 Vali Acc: 0.798 Test Loss: 0.606 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.138188362121582
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.786 Test Loss: 0.603 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.180479288101196
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.598 Vali Acc: 0.798 Test Loss: 0.598 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.704514026641846
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.595 Vali Acc: 0.780 Test Loss: 0.595 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.313616514205933
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.780 Test Loss: 0.591 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.139630079269409
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.591 Vali Acc: 0.792 Test Loss: 0.591 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.298316955566406
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.589 Vali Acc: 0.792 Test Loss: 0.589 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.133589506149292
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
Validation loss decreased (inf --> -0.115587).  Saving model ...
Epoch: 2 cost time: 5.246094226837158
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.121745347976685
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.070672273635864
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.118498802185059
Epoch: 5, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.041168451309204
Epoch: 6, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.831458568572998
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.058581352233887
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.363993167877197
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.7442944049835205
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.742941617965698
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.116 Test Loss: 1.947 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.11560693641618497
model parameter : 265543
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.839566707611084
Epoch: 1, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.706 Vali Acc: 0.329 Test Loss: 1.706 Test Acc: 0.329
Validation loss decreased (inf --> -0.329463).  Saving model ...
Epoch: 2 cost time: 5.466363191604614
Epoch: 2, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.374 Vali Acc: 0.509 Test Loss: 1.374 Test Acc: 0.509
Validation loss decreased (-0.329463 --> -0.508657).  Saving model ...
Epoch: 3 cost time: 5.267335891723633
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.162 Vali Acc: 0.607 Test Loss: 1.162 Test Acc: 0.607
Validation loss decreased (-0.508657 --> -0.606925).  Saving model ...
Epoch: 4 cost time: 5.106943368911743
Epoch: 4, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.035 Vali Acc: 0.665 Test Loss: 1.035 Test Acc: 0.665
Validation loss decreased (-0.606925 --> -0.664730).  Saving model ...
Epoch: 5 cost time: 5.2894392013549805
Epoch: 5, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.899 Vali Acc: 0.734 Test Loss: 0.899 Test Acc: 0.734
Validation loss decreased (-0.664730 --> -0.734095).  Saving model ...
Epoch: 6 cost time: 5.66643762588501
Epoch: 6, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.815 Vali Acc: 0.705 Test Loss: 0.815 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.2013208866119385
Epoch: 7, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.630 Vali Acc: 0.803 Test Loss: 0.630 Test Acc: 0.803
Validation loss decreased (-0.734095 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 5.333427667617798
Epoch: 8, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.512 Vali Acc: 0.832 Test Loss: 0.512 Test Acc: 0.832
Validation loss decreased (-0.803462 --> -0.832365).  Saving model ...
Epoch: 9 cost time: 5.636819362640381
Epoch: 9, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.566 Vali Acc: 0.786 Test Loss: 0.566 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.401845693588257
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.471 Vali Acc: 0.832 Test Loss: 0.471 Test Acc: 0.832
Validation loss decreased (-0.832365 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 5.431769132614136
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838146).  Saving model ...
Epoch: 12 cost time: 5.637179851531982
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.481 Vali Acc: 0.827 Test Loss: 0.481 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.745093822479248
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.496 Vali Acc: 0.838 Test Loss: 0.496 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.910821914672852
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.962450265884399
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.994204759597778
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.705893039703369
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.538 Vali Acc: 0.821 Test Loss: 0.538 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.667520761489868
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
Validation loss decreased (-0.838146 --> -0.849706).  Saving model ...
Epoch: 19 cost time: 4.8025946617126465
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.504 Vali Acc: 0.838 Test Loss: 0.504 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.199226379394531
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.838 Test Loss: 0.536 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.774503707885742
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.641794681549072
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.3030805587768555
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.844 Test Loss: 0.538 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.886380910873413
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.83169960975647
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.844 Test Loss: 0.544 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.178067922592163
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.860213279724121
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.3760292530059814
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.770142078399658
Epoch: 1, Steps: 17 | Train Loss: 1.978 Vali Loss: 1.755 Vali Acc: 0.277 Test Loss: 1.755 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 5.428532361984253
Epoch: 2, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.407 Vali Acc: 0.543 Test Loss: 1.407 Test Acc: 0.543
Validation loss decreased (-0.277439 --> -0.543339).  Saving model ...
Epoch: 3 cost time: 5.499459505081177
Epoch: 3, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.161 Vali Acc: 0.624 Test Loss: 1.161 Test Acc: 0.624
Validation loss decreased (-0.543339 --> -0.624266).  Saving model ...
Epoch: 4 cost time: 5.448990345001221
Epoch: 4, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.018 Vali Acc: 0.682 Test Loss: 1.018 Test Acc: 0.682
Validation loss decreased (-0.624266 --> -0.682071).  Saving model ...
Epoch: 5 cost time: 5.725642204284668
Epoch: 5, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.873 Vali Acc: 0.705 Test Loss: 0.873 Test Acc: 0.705
Validation loss decreased (-0.682071 --> -0.705194).  Saving model ...
Epoch: 6 cost time: 5.632779121398926
Epoch: 6, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.750 Vali Acc: 0.751 Test Loss: 0.750 Test Acc: 0.751
Validation loss decreased (-0.705194 --> -0.751438).  Saving model ...
Epoch: 7 cost time: 5.617719411849976
Epoch: 7, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.751438 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 4.756568908691406
Epoch: 8, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.126906871795654
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
Validation loss decreased (-0.815023 --> -0.843926).  Saving model ...
Epoch: 10 cost time: 5.389094829559326
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
Validation loss decreased (-0.843926 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 4.913036108016968
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.448 Vali Acc: 0.832 Test Loss: 0.448 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.0039918422698975
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.343580961227417
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.469 Vali Acc: 0.832 Test Loss: 0.469 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.321964979171753
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.377984523773193
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.477 Vali Acc: 0.832 Test Loss: 0.477 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.722412109375
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.489 Vali Acc: 0.832 Test Loss: 0.489 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.516479253768921
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.482 Vali Acc: 0.850 Test Loss: 0.482 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.530886888504028
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.335363864898682
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.832 Test Loss: 0.492 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.974523305892944
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.493 Vali Acc: 0.844 Test Loss: 0.493 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.160144805908203
Epoch: 1, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.825 Vali Acc: 0.249 Test Loss: 1.825 Test Acc: 0.249
Validation loss decreased (inf --> -0.248537).  Saving model ...
Epoch: 2 cost time: 5.370343923568726
Epoch: 2, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.527 Vali Acc: 0.451 Test Loss: 1.527 Test Acc: 0.451
Validation loss decreased (-0.248537 --> -0.450852).  Saving model ...
Epoch: 3 cost time: 5.5545690059661865
Epoch: 3, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.235 Vali Acc: 0.595 Test Loss: 1.235 Test Acc: 0.595
Validation loss decreased (-0.450852 --> -0.595363).  Saving model ...
Epoch: 4 cost time: 6.022228717803955
Epoch: 4, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.043 Vali Acc: 0.665 Test Loss: 1.043 Test Acc: 0.665
Validation loss decreased (-0.595363 --> -0.664729).  Saving model ...
Epoch: 5 cost time: 6.126318693161011
Epoch: 5, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.886 Vali Acc: 0.705 Test Loss: 0.886 Test Acc: 0.705
Validation loss decreased (-0.664729 --> -0.705193).  Saving model ...
Epoch: 6 cost time: 6.08691668510437
Epoch: 6, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.754 Vali Acc: 0.757 Test Loss: 0.754 Test Acc: 0.757
Validation loss decreased (-0.705193 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 5.799726486206055
Epoch: 7, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.621 Vali Acc: 0.775 Test Loss: 0.621 Test Acc: 0.775
Validation loss decreased (-0.757218 --> -0.774560).  Saving model ...
Epoch: 8 cost time: 6.277718782424927
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.532 Vali Acc: 0.769 Test Loss: 0.532 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.946986198425293
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.526 Vali Acc: 0.775 Test Loss: 0.526 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774561).  Saving model ...
Epoch: 10 cost time: 5.706491470336914
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.476 Vali Acc: 0.792 Test Loss: 0.476 Test Acc: 0.792
Validation loss decreased (-0.774561 --> -0.791903).  Saving model ...
Epoch: 11 cost time: 5.996078968048096
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.485 Vali Acc: 0.798 Test Loss: 0.485 Test Acc: 0.798
Validation loss decreased (-0.791903 --> -0.797683).  Saving model ...
Epoch: 12 cost time: 5.36601996421814
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.498 Vali Acc: 0.786 Test Loss: 0.498 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.394721031188965
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.798 Test Loss: 0.500 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.323807954788208
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.505 Vali Acc: 0.792 Test Loss: 0.505 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.028357982635498
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
Validation loss decreased (-0.797683 --> -0.809244).  Saving model ...
Epoch: 16 cost time: 5.694684028625488
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.509 Vali Acc: 0.798 Test Loss: 0.509 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.4771106243133545
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.505 Vali Acc: 0.798 Test Loss: 0.505 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.4100868701934814
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.003810405731201
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.513 Vali Acc: 0.821 Test Loss: 0.513 Test Acc: 0.821
Validation loss decreased (-0.809244 --> -0.820804).  Saving model ...
Epoch: 20 cost time: 5.600990295410156
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.815 Test Loss: 0.523 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.651224136352539
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.815 Test Loss: 0.525 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.295799732208252
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.520 Vali Acc: 0.827 Test Loss: 0.520 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 23 cost time: 5.5935962200164795
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.821 Test Loss: 0.533 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.6146650314331055
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.832 Test Loss: 0.532 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832365).  Saving model ...
Epoch: 25 cost time: 5.941324234008789
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.529 Vali Acc: 0.815 Test Loss: 0.529 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.033026456832886
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.821 Test Loss: 0.535 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.104998588562012
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.821 Test Loss: 0.539 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.325918197631836
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.542 Vali Acc: 0.821 Test Loss: 0.542 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.7661004066467285
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.832 Test Loss: 0.548 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.667518138885498
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.821 Test Loss: 0.547 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.105255126953125
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.547 Vali Acc: 0.832 Test Loss: 0.547 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.143239974975586
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.550 Vali Acc: 0.832 Test Loss: 0.550 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.964992523193359
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.548 Vali Acc: 0.832 Test Loss: 0.548 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.759943723678589
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.832 Test Loss: 0.559 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.819302082061768
Epoch: 1, Steps: 17 | Train Loss: 2.007 Vali Loss: 1.881 Vali Acc: 0.231 Test Loss: 1.881 Test Acc: 0.231
Validation loss decreased (inf --> -0.231195).  Saving model ...
Epoch: 2 cost time: 5.5379393100738525
Epoch: 2, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.687 Vali Acc: 0.405 Test Loss: 1.687 Test Acc: 0.405
Validation loss decreased (-0.231195 --> -0.404607).  Saving model ...
Epoch: 3 cost time: 5.666378736495972
Epoch: 3, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.405 Vali Acc: 0.624 Test Loss: 1.405 Test Acc: 0.624
Validation loss decreased (-0.404607 --> -0.624263).  Saving model ...
Epoch: 4 cost time: 5.81665825843811
Epoch: 4, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.163 Vali Acc: 0.723 Test Loss: 1.163 Test Acc: 0.723
Validation loss decreased (-0.624263 --> -0.722532).  Saving model ...
Epoch: 5 cost time: 5.59592080116272
Epoch: 5, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.956 Vali Acc: 0.757 Test Loss: 0.956 Test Acc: 0.757
Validation loss decreased (-0.722532 --> -0.757216).  Saving model ...
Epoch: 6 cost time: 5.426738977432251
Epoch: 6, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.767 Vali Acc: 0.798 Test Loss: 0.767 Test Acc: 0.798
Validation loss decreased (-0.757216 --> -0.797680).  Saving model ...
Epoch: 7 cost time: 5.33923077583313
Epoch: 7, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.616 Vali Acc: 0.821 Test Loss: 0.616 Test Acc: 0.821
Validation loss decreased (-0.797680 --> -0.820803).  Saving model ...
Epoch: 8 cost time: 5.462151050567627
Epoch: 8, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
Validation loss decreased (-0.820803 --> -0.843925).  Saving model ...
Epoch: 9 cost time: 5.0201942920684814
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.040419101715088
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.466 Vali Acc: 0.861 Test Loss: 0.466 Test Acc: 0.861
Validation loss decreased (-0.843925 --> -0.861267).  Saving model ...
Epoch: 11 cost time: 5.07438325881958
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.464 Vali Acc: 0.861 Test Loss: 0.464 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861267).  Saving model ...
Epoch: 12 cost time: 5.299322128295898
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
Validation loss decreased (-0.861267 --> -0.867048).  Saving model ...
Epoch: 13 cost time: 5.123721361160278
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.448 Vali Acc: 0.867 Test Loss: 0.448 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.388673543930054
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.450 Vali Acc: 0.867 Test Loss: 0.450 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.262912750244141
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.449 Vali Acc: 0.867 Test Loss: 0.449 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.503762722015381
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.450 Vali Acc: 0.867 Test Loss: 0.450 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.246271371841431
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.351757764816284
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.548757791519165
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.453 Vali Acc: 0.861 Test Loss: 0.453 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.272953510284424
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.652923345565796
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.457312345504761
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.979875802993774
Epoch: 1, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.919 Vali Acc: 0.179 Test Loss: 1.919 Test Acc: 0.179
Validation loss decreased (inf --> -0.179172).  Saving model ...
Epoch: 2 cost time: 5.5199058055877686
Epoch: 2, Steps: 17 | Train Loss: 1.827 Vali Loss: 1.817 Vali Acc: 0.260 Test Loss: 1.817 Test Acc: 0.260
Validation loss decreased (-0.179172 --> -0.260097).  Saving model ...
Epoch: 3 cost time: 5.841707706451416
Epoch: 3, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.645 Vali Acc: 0.393 Test Loss: 1.645 Test Acc: 0.393
Validation loss decreased (-0.260097 --> -0.393047).  Saving model ...
Epoch: 4 cost time: 5.675858736038208
Epoch: 4, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.458 Vali Acc: 0.543 Test Loss: 1.458 Test Acc: 0.543
Validation loss decreased (-0.393047 --> -0.543338).  Saving model ...
Epoch: 5 cost time: 5.604984283447266
Epoch: 5, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.257 Vali Acc: 0.630 Test Loss: 1.257 Test Acc: 0.630
Validation loss decreased (-0.543338 --> -0.630045).  Saving model ...
Epoch: 6 cost time: 5.694546461105347
Epoch: 6, Steps: 17 | Train Loss: 0.793 Vali Loss: 1.026 Vali Acc: 0.717 Test Loss: 1.026 Test Acc: 0.717
Validation loss decreased (-0.630045 --> -0.716753).  Saving model ...
Epoch: 7 cost time: 5.18256402015686
Epoch: 7, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.833 Vali Acc: 0.751 Test Loss: 0.833 Test Acc: 0.751
Validation loss decreased (-0.716753 --> -0.751437).  Saving model ...
Epoch: 8 cost time: 5.328922986984253
Epoch: 8, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.685 Vali Acc: 0.798 Test Loss: 0.685 Test Acc: 0.798
Validation loss decreased (-0.751437 --> -0.797681).  Saving model ...
Epoch: 9 cost time: 4.85245680809021
Epoch: 9, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.586 Vali Acc: 0.821 Test Loss: 0.586 Test Acc: 0.821
Validation loss decreased (-0.797681 --> -0.820803).  Saving model ...
Epoch: 10 cost time: 4.714262247085571
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.86445164680481
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.894778728485107
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.504 Vali Acc: 0.821 Test Loss: 0.504 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 5.3521013259887695
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.187714338302612
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.495 Vali Acc: 0.827 Test Loss: 0.495 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826585).  Saving model ...
Epoch: 15 cost time: 5.41586709022522
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.488 Vali Acc: 0.827 Test Loss: 0.488 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 16 cost time: 5.318328619003296
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.483 Vali Acc: 0.827 Test Loss: 0.483 Test Acc: 0.827
Validation loss decreased (-0.826585 --> -0.826585).  Saving model ...
Epoch: 17 cost time: 5.521250486373901
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
Validation loss decreased (-0.826585 --> -0.849706).  Saving model ...
Epoch: 18 cost time: 5.338895797729492
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.92439341545105
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.473 Vali Acc: 0.838 Test Loss: 0.473 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.995880126953125
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.470 Vali Acc: 0.838 Test Loss: 0.470 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.857187032699585
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.838 Test Loss: 0.467 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.858838081359863
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.838 Test Loss: 0.469 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.7451395988464355
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.7589430809021
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.468 Vali Acc: 0.838 Test Loss: 0.468 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.1394569873809814
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.838 Test Loss: 0.462 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.4701831340789795
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 27 cost time: 5.366569519042969
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.849706 --> -0.855487).  Saving model ...
Epoch: 28 cost time: 5.4572882652282715
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.850 Test Loss: 0.459 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.545337200164795
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.850 Test Loss: 0.460 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.539902925491333
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.086079120635986
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.2225189208984375
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.074019432067871
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.844 Test Loss: 0.458 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.231575012207031
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.844 Test Loss: 0.459 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.358680963516235
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.432857990264893
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 5.514454364776611
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.460 Vali Acc: 0.838 Test Loss: 0.460 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.639934539794922
Epoch: 1, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.912 Vali Acc: 0.162 Test Loss: 1.912 Test Acc: 0.162
Validation loss decreased (inf --> -0.161831).  Saving model ...
Epoch: 2 cost time: 4.972707748413086
Epoch: 2, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.840 Vali Acc: 0.208 Test Loss: 1.840 Test Acc: 0.208
Validation loss decreased (-0.161831 --> -0.208074).  Saving model ...
Epoch: 3 cost time: 4.572880268096924
Epoch: 3, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.707 Vali Acc: 0.474 Test Loss: 1.707 Test Acc: 0.474
Validation loss decreased (-0.208074 --> -0.473971).  Saving model ...
Epoch: 4 cost time: 4.556260108947754
Epoch: 4, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.557 Vali Acc: 0.595 Test Loss: 1.557 Test Acc: 0.595
Validation loss decreased (-0.473971 --> -0.595360).  Saving model ...
Epoch: 5 cost time: 5.10986065864563
Epoch: 5, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.417 Vali Acc: 0.578 Test Loss: 1.417 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.992856740951538
Epoch: 6, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.233 Vali Acc: 0.694 Test Loss: 1.233 Test Acc: 0.694
Validation loss decreased (-0.595360 --> -0.693629).  Saving model ...
Epoch: 7 cost time: 5.1663758754730225
Epoch: 7, Steps: 17 | Train Loss: 0.802 Vali Loss: 1.069 Vali Acc: 0.682 Test Loss: 1.069 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.6079161167144775
Epoch: 8, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.915 Vali Acc: 0.711 Test Loss: 0.915 Test Acc: 0.711
Validation loss decreased (-0.693629 --> -0.710974).  Saving model ...
Epoch: 9 cost time: 5.135721683502197
Epoch: 9, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.815 Vali Acc: 0.711 Test Loss: 0.815 Test Acc: 0.711
Validation loss decreased (-0.710974 --> -0.710975).  Saving model ...
Epoch: 10 cost time: 5.265767574310303
Epoch: 10, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
Validation loss decreased (-0.710975 --> -0.716756).  Saving model ...
Epoch: 11 cost time: 4.504253149032593
Epoch: 11, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.677 Vali Acc: 0.740 Test Loss: 0.677 Test Acc: 0.740
Validation loss decreased (-0.716756 --> -0.739878).  Saving model ...
Epoch: 12 cost time: 4.914037704467773
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.656 Vali Acc: 0.728 Test Loss: 0.656 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.908311128616333
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751439).  Saving model ...
Epoch: 14 cost time: 5.053090333938599
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.635 Vali Acc: 0.751 Test Loss: 0.635 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 15 cost time: 4.824084758758545
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 16 cost time: 4.819254636764526
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.901183366775513
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 18 cost time: 5.155972003936768
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.623 Vali Acc: 0.769 Test Loss: 0.623 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 19 cost time: 5.3312811851501465
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.531550168991089
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.351096868515015
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.325603246688843
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.249208688735962
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.010861158370972
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.614 Vali Acc: 0.763 Test Loss: 0.614 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.127122640609741
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.3896942138671875
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.611 Vali Acc: 0.751 Test Loss: 0.611 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.352786540985107
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.611 Vali Acc: 0.769 Test Loss: 0.611 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 28 cost time: 4.972920894622803
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.611 Vali Acc: 0.769 Test Loss: 0.611 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 29 cost time: 5.327153205871582
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.775 Test Loss: 0.611 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774560).  Saving model ...
Epoch: 30 cost time: 5.1202073097229
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.769 Test Loss: 0.608 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.54346227645874
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.407639503479004
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.775 Test Loss: 0.611 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774560).  Saving model ...
Epoch: 33 cost time: 5.049941301345825
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774560).  Saving model ...
Epoch: 34 cost time: 5.134865760803223
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.675794363021851
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.974619388580322
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 5.008255243301392
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.534274578094482
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.743366241455078
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.608 Vali Acc: 0.763 Test Loss: 0.608 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.8051228523254395
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.769 Test Loss: 0.607 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.1771509647369385
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 5.332601308822632
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 5.238788843154907
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.769 Test Loss: 0.609 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.124240875244141
Epoch: 1, Steps: 17 | Train Loss: 2.028 Vali Loss: 1.933 Vali Acc: 0.208 Test Loss: 1.933 Test Acc: 0.208
Validation loss decreased (inf --> -0.208073).  Saving model ...
Epoch: 2 cost time: 4.9753172397613525
Epoch: 2, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.884 Vali Acc: 0.214 Test Loss: 1.884 Test Acc: 0.214
Validation loss decreased (-0.208073 --> -0.213854).  Saving model ...
Epoch: 3 cost time: 4.868415355682373
Epoch: 3, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.789 Vali Acc: 0.318 Test Loss: 1.789 Test Acc: 0.318
Validation loss decreased (-0.213854 --> -0.317901).  Saving model ...
Epoch: 4 cost time: 4.948498487472534
Epoch: 4, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.665 Vali Acc: 0.480 Test Loss: 1.665 Test Acc: 0.480
Validation loss decreased (-0.317901 --> -0.479752).  Saving model ...
Epoch: 5 cost time: 4.827889680862427
Epoch: 5, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.550 Vali Acc: 0.520 Test Loss: 1.550 Test Acc: 0.520
Validation loss decreased (-0.479752 --> -0.520216).  Saving model ...
Epoch: 6 cost time: 5.501845836639404
Epoch: 6, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.406 Vali Acc: 0.584 Test Loss: 1.406 Test Acc: 0.584
Validation loss decreased (-0.520216 --> -0.583801).  Saving model ...
Epoch: 7 cost time: 5.499292612075806
Epoch: 7, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.244 Vali Acc: 0.613 Test Loss: 1.244 Test Acc: 0.613
Validation loss decreased (-0.583801 --> -0.612704).  Saving model ...
Epoch: 8 cost time: 5.124125003814697
Epoch: 8, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.114 Vali Acc: 0.647 Test Loss: 1.114 Test Acc: 0.647
Validation loss decreased (-0.612704 --> -0.647388).  Saving model ...
Epoch: 9 cost time: 5.654346466064453
Epoch: 9, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.990 Vali Acc: 0.671 Test Loss: 0.990 Test Acc: 0.671
Validation loss decreased (-0.647388 --> -0.670510).  Saving model ...
Epoch: 10 cost time: 5.534561395645142
Epoch: 10, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.888 Vali Acc: 0.659 Test Loss: 0.888 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.307939767837524
Epoch: 11, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.815 Vali Acc: 0.682 Test Loss: 0.815 Test Acc: 0.682
Validation loss decreased (-0.670510 --> -0.682073).  Saving model ...
Epoch: 12 cost time: 5.114067792892456
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.757 Vali Acc: 0.694 Test Loss: 0.757 Test Acc: 0.694
Validation loss decreased (-0.682073 --> -0.693634).  Saving model ...
Epoch: 13 cost time: 5.36432671546936
Epoch: 13, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.747 Vali Acc: 0.699 Test Loss: 0.747 Test Acc: 0.699
Validation loss decreased (-0.693634 --> -0.699414).  Saving model ...
Epoch: 14 cost time: 5.055025339126587
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.723 Vali Acc: 0.711 Test Loss: 0.723 Test Acc: 0.711
Validation loss decreased (-0.699414 --> -0.710975).  Saving model ...
Epoch: 15 cost time: 5.391467809677124
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.695 Vali Acc: 0.723 Test Loss: 0.695 Test Acc: 0.723
Validation loss decreased (-0.710975 --> -0.722536).  Saving model ...
Epoch: 16 cost time: 5.061616897583008
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.682 Vali Acc: 0.734 Test Loss: 0.682 Test Acc: 0.734
Validation loss decreased (-0.722536 --> -0.734097).  Saving model ...
Epoch: 17 cost time: 5.419771671295166
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.505395889282227
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.673 Vali Acc: 0.711 Test Loss: 0.673 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.570396661758423
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.664 Vali Acc: 0.734 Test Loss: 0.664 Test Acc: 0.734
Validation loss decreased (-0.734097 --> -0.734097).  Saving model ...
Epoch: 20 cost time: 5.531401872634888
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.662 Vali Acc: 0.728 Test Loss: 0.662 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.285840749740601
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.663 Vali Acc: 0.711 Test Loss: 0.663 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.215035438537598
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.653 Vali Acc: 0.728 Test Loss: 0.653 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.905834913253784
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
Validation loss decreased (-0.734097 --> -0.751439).  Saving model ...
Epoch: 24 cost time: 4.892963171005249
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.734 Test Loss: 0.641 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.944335460662842
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.635 Vali Acc: 0.746 Test Loss: 0.635 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.991814613342285
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.751 Test Loss: 0.634 Test Acc: 0.751
Validation loss decreased (-0.751439 --> -0.751439).  Saving model ...
Epoch: 27 cost time: 5.531338930130005
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.751439 --> -0.757219).  Saving model ...
Epoch: 28 cost time: 5.466977119445801
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.630 Vali Acc: 0.757 Test Loss: 0.630 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 29 cost time: 6.021410703659058
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.626 Vali Acc: 0.746 Test Loss: 0.626 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.945523023605347
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.757219 --> -0.757219).  Saving model ...
Epoch: 31 cost time: 6.012234687805176
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.613 Vali Acc: 0.769 Test Loss: 0.613 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 32 cost time: 6.010070562362671
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.616 Vali Acc: 0.769 Test Loss: 0.616 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 6.23975682258606
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.614 Vali Acc: 0.751 Test Loss: 0.614 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.283729553222656
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.623 Vali Acc: 0.751 Test Loss: 0.623 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.830046892166138
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.916585683822632
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.611 Vali Acc: 0.769 Test Loss: 0.611 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 37 cost time: 5.14124059677124
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.769 Test Loss: 0.607 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 38 cost time: 5.1501243114471436
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774560).  Saving model ...
Epoch: 39 cost time: 5.343492746353149
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.775 Test Loss: 0.601 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774560).  Saving model ...
Epoch: 40 cost time: 5.243520021438599
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.769 Test Loss: 0.597 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.148599624633789
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.21795129776001
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.332880735397339
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.751 Test Loss: 0.603 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.46695351600647
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.769 Test Loss: 0.601 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.105615854263306
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.705415725708008
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.769 Test Loss: 0.595 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 4.755000114440918
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.786 Test Loss: 0.590 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786121).  Saving model ...
Epoch: 48 cost time: 4.814318895339966
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.780 Test Loss: 0.588 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 5.108255624771118
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.769 Test Loss: 0.588 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 4.967559099197388
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.590 Vali Acc: 0.769 Test Loss: 0.590 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 5.167468309402466
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.757 Test Loss: 0.592 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 5.459073543548584
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.775 Test Loss: 0.595 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 5.274545669555664
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 5.508731842041016
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.769 Test Loss: 0.586 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 5.453717947006226
Epoch: 55, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.584 Vali Acc: 0.769 Test Loss: 0.584 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 5.157848596572876
Epoch: 56, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.769 Test Loss: 0.585 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 5.22711443901062
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.769 Test Loss: 0.589 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.376235485076904
Epoch: 1, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.928 Vali Acc: 0.231 Test Loss: 1.928 Test Acc: 0.231
Validation loss decreased (inf --> -0.231195).  Saving model ...
Epoch: 2 cost time: 5.0328528881073
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.882 Vali Acc: 0.283 Test Loss: 1.882 Test Acc: 0.283
Validation loss decreased (-0.231195 --> -0.283218).  Saving model ...
Epoch: 3 cost time: 5.292084455490112
Epoch: 3, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.794 Vali Acc: 0.353 Test Loss: 1.794 Test Acc: 0.353
Validation loss decreased (-0.283218 --> -0.352583).  Saving model ...
Epoch: 4 cost time: 5.428109884262085
Epoch: 4, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.680 Vali Acc: 0.434 Test Loss: 1.680 Test Acc: 0.434
Validation loss decreased (-0.352583 --> -0.433509).  Saving model ...
Epoch: 5 cost time: 5.438987493515015
Epoch: 5, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.570 Vali Acc: 0.503 Test Loss: 1.570 Test Acc: 0.503
Validation loss decreased (-0.433509 --> -0.502874).  Saving model ...
Epoch: 6 cost time: 5.501472473144531
Epoch: 6, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.429 Vali Acc: 0.566 Test Loss: 1.429 Test Acc: 0.566
Validation loss decreased (-0.502874 --> -0.566460).  Saving model ...
Epoch: 7 cost time: 5.0393290519714355
Epoch: 7, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.257 Vali Acc: 0.630 Test Loss: 1.257 Test Acc: 0.630
Validation loss decreased (-0.566460 --> -0.630045).  Saving model ...
Epoch: 8 cost time: 5.4468629360198975
Epoch: 8, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.123 Vali Acc: 0.647 Test Loss: 1.123 Test Acc: 0.647
Validation loss decreased (-0.630045 --> -0.647388).  Saving model ...
Epoch: 9 cost time: 4.948928356170654
Epoch: 9, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.999 Vali Acc: 0.636 Test Loss: 0.999 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.7859838008880615
Epoch: 10, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.854 Vali Acc: 0.699 Test Loss: 0.854 Test Acc: 0.699
Validation loss decreased (-0.647388 --> -0.699413).  Saving model ...
Epoch: 11 cost time: 4.646675109863281
Epoch: 11, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.788 Vali Acc: 0.688 Test Loss: 0.788 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.397559642791748
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.731 Vali Acc: 0.711 Test Loss: 0.731 Test Acc: 0.711
Validation loss decreased (-0.699413 --> -0.710975).  Saving model ...
Epoch: 13 cost time: 4.640852689743042
Epoch: 13, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.674 Vali Acc: 0.786 Test Loss: 0.674 Test Acc: 0.786
Validation loss decreased (-0.710975 --> -0.786120).  Saving model ...
Epoch: 14 cost time: 4.601719856262207
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.669 Vali Acc: 0.757 Test Loss: 0.669 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.081704378128052
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.274724245071411
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.149984121322632
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.635 Vali Acc: 0.769 Test Loss: 0.635 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.1993088722229
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.629 Vali Acc: 0.780 Test Loss: 0.629 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.252439260482788
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.621 Vali Acc: 0.775 Test Loss: 0.621 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.283459186553955
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.616 Vali Acc: 0.798 Test Loss: 0.616 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797682).  Saving model ...
Epoch: 21 cost time: 4.755282878875732
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.618 Vali Acc: 0.792 Test Loss: 0.618 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.622270345687866
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.798 Test Loss: 0.618 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.76569390296936
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.613 Vali Acc: 0.769 Test Loss: 0.613 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.1732563972473145
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.612 Vali Acc: 0.798 Test Loss: 0.612 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797682).  Saving model ...
Epoch: 25 cost time: 5.051051378250122
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803462).  Saving model ...
Epoch: 26 cost time: 4.958063364028931
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 27 cost time: 5.3461902141571045
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 28 cost time: 5.508645534515381
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.465161323547363
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 30 cost time: 5.519664764404297
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.592 Vali Acc: 0.798 Test Loss: 0.592 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.769512414932251
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.798 Test Loss: 0.586 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.456758737564087
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.792 Test Loss: 0.586 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.453672885894775
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 34 cost time: 5.4075562953948975
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 35 cost time: 5.12562370300293
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.586 Vali Acc: 0.786 Test Loss: 0.586 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.081338882446289
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.780 Test Loss: 0.585 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.84332013130188
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.579 Vali Acc: 0.792 Test Loss: 0.579 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.107701063156128
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.792 Test Loss: 0.578 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.499341249465942
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.786 Test Loss: 0.578 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.415566444396973
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.574 Vali Acc: 0.798 Test Loss: 0.574 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.837795972824097
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.792 Test Loss: 0.576 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.3979198932647705
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.578 Vali Acc: 0.792 Test Loss: 0.578 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 5.282069683074951
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.573 Vali Acc: 0.792 Test Loss: 0.573 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 5.248610258102417
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.798 Test Loss: 0.576 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.010635137557983
Epoch: 1, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.962 Vali Acc: 0.162 Test Loss: 1.962 Test Acc: 0.162
Validation loss decreased (inf --> -0.161830).  Saving model ...
Epoch: 2 cost time: 4.534048080444336
Epoch: 2, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.913 Vali Acc: 0.202 Test Loss: 1.913 Test Acc: 0.202
Validation loss decreased (-0.161830 --> -0.202293).  Saving model ...
Epoch: 3 cost time: 4.7917561531066895
Epoch: 3, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.815 Vali Acc: 0.283 Test Loss: 1.815 Test Acc: 0.283
Validation loss decreased (-0.202293 --> -0.283219).  Saving model ...
Epoch: 4 cost time: 5.412420749664307
Epoch: 4, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.687 Vali Acc: 0.439 Test Loss: 1.687 Test Acc: 0.439
Validation loss decreased (-0.283219 --> -0.439289).  Saving model ...
Epoch: 5 cost time: 5.206441640853882
Epoch: 5, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.568 Vali Acc: 0.561 Test Loss: 1.568 Test Acc: 0.561
Validation loss decreased (-0.439289 --> -0.560678).  Saving model ...
Epoch: 6 cost time: 5.114663124084473
Epoch: 6, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.410 Vali Acc: 0.578 Test Loss: 1.410 Test Acc: 0.578
Validation loss decreased (-0.560678 --> -0.578021).  Saving model ...
Epoch: 7 cost time: 5.241198301315308
Epoch: 7, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.244 Vali Acc: 0.624 Test Loss: 1.244 Test Acc: 0.624
Validation loss decreased (-0.578021 --> -0.624265).  Saving model ...
Epoch: 8 cost time: 5.396061897277832
Epoch: 8, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.104 Vali Acc: 0.630 Test Loss: 1.104 Test Acc: 0.630
Validation loss decreased (-0.624265 --> -0.630047).  Saving model ...
Epoch: 9 cost time: 5.275259256362915
Epoch: 9, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.967 Vali Acc: 0.676 Test Loss: 0.967 Test Acc: 0.676
Validation loss decreased (-0.630047 --> -0.676291).  Saving model ...
Epoch: 10 cost time: 5.264226675033569
Epoch: 10, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.833 Vali Acc: 0.757 Test Loss: 0.833 Test Acc: 0.757
Validation loss decreased (-0.676291 --> -0.757217).  Saving model ...
Epoch: 11 cost time: 5.155858516693115
Epoch: 11, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.781 Vali Acc: 0.723 Test Loss: 0.781 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.229126691818237
Epoch: 12, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.325320720672607
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
Validation loss decreased (-0.757217 --> -0.774560).  Saving model ...
Epoch: 14 cost time: 5.670189619064331
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.654 Vali Acc: 0.775 Test Loss: 0.654 Test Acc: 0.775
Validation loss decreased (-0.774560 --> -0.774560).  Saving model ...
Epoch: 15 cost time: 5.9211626052856445
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.481010675430298
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.620 Vali Acc: 0.786 Test Loss: 0.620 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786121).  Saving model ...
Epoch: 17 cost time: 5.56185245513916
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.618 Vali Acc: 0.786 Test Loss: 0.618 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 18 cost time: 5.490491151809692
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.606 Vali Acc: 0.792 Test Loss: 0.606 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791901).  Saving model ...
Epoch: 19 cost time: 5.569413661956787
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.601 Vali Acc: 0.798 Test Loss: 0.601 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797682).  Saving model ...
Epoch: 20 cost time: 5.443819046020508
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803462).  Saving model ...
Epoch: 21 cost time: 5.325459957122803
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803462).  Saving model ...
Epoch: 22 cost time: 4.951414346694946
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.580 Vali Acc: 0.798 Test Loss: 0.580 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.021243095397949
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.577 Vali Acc: 0.792 Test Loss: 0.577 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.7934324741363525
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.572 Vali Acc: 0.780 Test Loss: 0.572 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.415990829467773
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.4995598793029785
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.786 Test Loss: 0.565 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.796757459640503
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 28 cost time: 5.415364742279053
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.554 Vali Acc: 0.798 Test Loss: 0.554 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.442568778991699
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.549 Vali Acc: 0.792 Test Loss: 0.549 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.372037172317505
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.547 Vali Acc: 0.775 Test Loss: 0.547 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.392056465148926
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.538 Vali Acc: 0.786 Test Loss: 0.538 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.156448602676392
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.786 Test Loss: 0.532 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.5460333824157715
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.798 Test Loss: 0.527 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.224420785903931
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.12126898765564
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.2471208572387695
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.792 Test Loss: 0.523 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 5.025369167327881
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.798 Test Loss: 0.516 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.442275285720825
Epoch: 1, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
Validation loss decreased (inf --> -0.127148).  Saving model ...
Epoch: 2 cost time: 5.262479543685913
Epoch: 2, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.389259576797485
Epoch: 3, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.5906031131744385
Epoch: 4, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.127 Test Loss: 1.946 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.5488293170928955
Epoch: 5, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.279394626617432
Epoch: 6, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.2421650886535645
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.7675604820251465
Epoch: 8, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.390740156173706
Epoch: 9, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.44340705871582
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.4191625118255615
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.127 Test Loss: 1.947 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.12716763005780346
model parameter : 216391
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         72                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.189708948135376
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.689 Vali Acc: 0.370 Test Loss: 1.689 Test Acc: 0.370
Validation loss decreased (inf --> -0.369925).  Saving model ...
Epoch: 2 cost time: 5.182569980621338
Epoch: 2, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.408 Vali Acc: 0.462 Test Loss: 1.408 Test Acc: 0.462
Validation loss decreased (-0.369925 --> -0.462414).  Saving model ...
Epoch: 3 cost time: 4.951970338821411
Epoch: 3, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.162 Vali Acc: 0.653 Test Loss: 1.162 Test Acc: 0.653
Validation loss decreased (-0.462414 --> -0.653168).  Saving model ...
Epoch: 4 cost time: 4.6699676513671875
Epoch: 4, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.058 Vali Acc: 0.624 Test Loss: 1.058 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.634432554244995
Epoch: 5, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
Validation loss decreased (-0.653168 --> -0.710974).  Saving model ...
Epoch: 6 cost time: 5.01743221282959
Epoch: 6, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.758 Vali Acc: 0.763 Test Loss: 0.758 Test Acc: 0.763
Validation loss decreased (-0.710974 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 5.186506271362305
Epoch: 7, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.627 Vali Acc: 0.786 Test Loss: 0.627 Test Acc: 0.786
Validation loss decreased (-0.762998 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 4.621411561965942
Epoch: 8, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
Validation loss decreased (-0.786121 --> -0.838145).  Saving model ...
Epoch: 9 cost time: 4.5018627643585205
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.484 Vali Acc: 0.844 Test Loss: 0.484 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843926).  Saving model ...
Epoch: 10 cost time: 4.731403827667236
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.456 Vali Acc: 0.832 Test Loss: 0.456 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.152538537979126
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.262184381484985
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.472 Vali Acc: 0.838 Test Loss: 0.472 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.438320875167847
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.484 Vali Acc: 0.827 Test Loss: 0.484 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.5262603759765625
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.476 Vali Acc: 0.838 Test Loss: 0.476 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.154636859893799
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.472 Vali Acc: 0.873 Test Loss: 0.472 Test Acc: 0.873
Validation loss decreased (-0.843926 --> -0.872828).  Saving model ...
Epoch: 16 cost time: 5.099740028381348
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.483 Vali Acc: 0.844 Test Loss: 0.483 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.155222654342651
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.921156406402588
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.498 Vali Acc: 0.850 Test Loss: 0.498 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.911096811294556
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.495 Vali Acc: 0.873 Test Loss: 0.495 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.064578294754028
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.171875715255737
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.504 Vali Acc: 0.873 Test Loss: 0.504 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.215823411941528
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.873 Test Loss: 0.505 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.693099498748779
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.518 Vali Acc: 0.827 Test Loss: 0.518 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.38653564453125
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.861 Test Loss: 0.514 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.578715085983276
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.537 Vali Acc: 0.827 Test Loss: 0.537 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         58                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.362572908401489
Epoch: 1, Steps: 17 | Train Loss: 1.924 Vali Loss: 1.729 Vali Acc: 0.387 Test Loss: 1.729 Test Acc: 0.387
Validation loss decreased (inf --> -0.387266).  Saving model ...
Epoch: 2 cost time: 5.101551055908203
Epoch: 2, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.456 Vali Acc: 0.416 Test Loss: 1.456 Test Acc: 0.416
Validation loss decreased (-0.387266 --> -0.416170).  Saving model ...
Epoch: 3 cost time: 4.95430588722229
Epoch: 3, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.194 Vali Acc: 0.595 Test Loss: 1.194 Test Acc: 0.595
Validation loss decreased (-0.416170 --> -0.595364).  Saving model ...
Epoch: 4 cost time: 5.208438396453857
Epoch: 4, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.069 Vali Acc: 0.642 Test Loss: 1.069 Test Acc: 0.642
Validation loss decreased (-0.595364 --> -0.641608).  Saving model ...
Epoch: 5 cost time: 5.177177906036377
Epoch: 5, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.902 Vali Acc: 0.734 Test Loss: 0.902 Test Acc: 0.734
Validation loss decreased (-0.641608 --> -0.734095).  Saving model ...
Epoch: 6 cost time: 5.246459007263184
Epoch: 6, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
Validation loss decreased (-0.734095 --> -0.751437).  Saving model ...
Epoch: 7 cost time: 5.235067367553711
Epoch: 7, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.619 Vali Acc: 0.815 Test Loss: 0.619 Test Acc: 0.815
Validation loss decreased (-0.751437 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 5.359730005264282
Epoch: 8, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.535 Vali Acc: 0.798 Test Loss: 0.535 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.331740379333496
Epoch: 9, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.493 Vali Acc: 0.838 Test Loss: 0.493 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838145).  Saving model ...
Epoch: 10 cost time: 5.278229236602783
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.394541025161743
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.193789958953857
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.489 Vali Acc: 0.815 Test Loss: 0.489 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.042494773864746
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.480 Vali Acc: 0.827 Test Loss: 0.480 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.7562456130981445
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.500 Vali Acc: 0.827 Test Loss: 0.500 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.01681923866272
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.493 Vali Acc: 0.827 Test Loss: 0.493 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.237971305847168
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.510 Vali Acc: 0.821 Test Loss: 0.510 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.907261610031128
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.827 Test Loss: 0.501 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.0629682540893555
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.515 Vali Acc: 0.827 Test Loss: 0.515 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.1555187702178955
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.510 Vali Acc: 0.827 Test Loss: 0.510 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         44                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma44_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.452120780944824
Epoch: 1, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.799 Vali Acc: 0.410 Test Loss: 1.799 Test Acc: 0.410
Validation loss decreased (inf --> -0.410387).  Saving model ...
Epoch: 2 cost time: 5.369333505630493
Epoch: 2, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.543 Vali Acc: 0.457 Test Loss: 1.543 Test Acc: 0.457
Validation loss decreased (-0.410387 --> -0.456632).  Saving model ...
Epoch: 3 cost time: 5.883493423461914
Epoch: 3, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.251 Vali Acc: 0.590 Test Loss: 1.251 Test Acc: 0.590
Validation loss decreased (-0.456632 --> -0.589583).  Saving model ...
Epoch: 4 cost time: 6.482822418212891
Epoch: 4, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.076 Vali Acc: 0.653 Test Loss: 1.076 Test Acc: 0.653
Validation loss decreased (-0.589583 --> -0.653168).  Saving model ...
Epoch: 5 cost time: 6.185003042221069
Epoch: 5, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.894 Vali Acc: 0.740 Test Loss: 0.894 Test Acc: 0.740
Validation loss decreased (-0.653168 --> -0.739875).  Saving model ...
Epoch: 6 cost time: 6.185843467712402
Epoch: 6, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
Validation loss decreased (-0.739875 --> -0.774559).  Saving model ...
Epoch: 7 cost time: 5.536306858062744
Epoch: 7, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 5.777034521102905
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.531 Vali Acc: 0.821 Test Loss: 0.531 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 9 cost time: 5.824997425079346
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.468 Vali Acc: 0.821 Test Loss: 0.468 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820805).  Saving model ...
Epoch: 10 cost time: 5.985206604003906
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.478 Vali Acc: 0.838 Test Loss: 0.478 Test Acc: 0.838
Validation loss decreased (-0.820805 --> -0.838146).  Saving model ...
Epoch: 11 cost time: 5.6226725578308105
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.455 Vali Acc: 0.803 Test Loss: 0.455 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.8129563331604
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.446 Vali Acc: 0.832 Test Loss: 0.446 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.311023235321045
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.433 Vali Acc: 0.832 Test Loss: 0.433 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.952383756637573
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.445 Vali Acc: 0.821 Test Loss: 0.445 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.157983064651489
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.442 Vali Acc: 0.821 Test Loss: 0.442 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.961435317993164
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.450 Vali Acc: 0.832 Test Loss: 0.450 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.1350672245025635
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.827 Test Loss: 0.445 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.910072088241577
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.458 Vali Acc: 0.832 Test Loss: 0.458 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.773534297943115
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.832 Test Loss: 0.449 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.45226526260376
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.832 Test Loss: 0.456 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma44_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         29                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.527995824813843
Epoch: 1, Steps: 17 | Train Loss: 1.987 Vali Loss: 1.886 Vali Acc: 0.260 Test Loss: 1.886 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 4.713509559631348
Epoch: 2, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.692 Vali Acc: 0.439 Test Loss: 1.692 Test Acc: 0.439
Validation loss decreased (-0.260097 --> -0.439289).  Saving model ...
Epoch: 3 cost time: 5.462970733642578
Epoch: 3, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.420 Vali Acc: 0.618 Test Loss: 1.420 Test Acc: 0.618
Validation loss decreased (-0.439289 --> -0.618483).  Saving model ...
Epoch: 4 cost time: 5.90819239616394
Epoch: 4, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.187 Vali Acc: 0.653 Test Loss: 1.187 Test Acc: 0.653
Validation loss decreased (-0.618483 --> -0.653167).  Saving model ...
Epoch: 5 cost time: 6.066553831100464
Epoch: 5, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.978 Vali Acc: 0.763 Test Loss: 0.978 Test Acc: 0.763
Validation loss decreased (-0.653167 --> -0.762996).  Saving model ...
Epoch: 6 cost time: 5.553648948669434
Epoch: 6, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.792 Vali Acc: 0.763 Test Loss: 0.792 Test Acc: 0.763
Validation loss decreased (-0.762996 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 5.875912427902222
Epoch: 7, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.651 Vali Acc: 0.786 Test Loss: 0.651 Test Acc: 0.786
Validation loss decreased (-0.762998 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 5.220316171646118
Epoch: 8, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
Validation loss decreased (-0.786121 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 5.395511150360107
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.514510631561279
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.502 Vali Acc: 0.815 Test Loss: 0.502 Test Acc: 0.815
Validation loss decreased (-0.815023 --> -0.815024).  Saving model ...
Epoch: 11 cost time: 5.235455751419067
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.209488153457642
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.983558654785156
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 14 cost time: 5.3485801219940186
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.482 Vali Acc: 0.815 Test Loss: 0.482 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 15 cost time: 5.5118567943573
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.479 Vali Acc: 0.815 Test Loss: 0.479 Test Acc: 0.815
Validation loss decreased (-0.815024 --> -0.815024).  Saving model ...
Epoch: 16 cost time: 5.395460605621338
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.481 Vali Acc: 0.803 Test Loss: 0.481 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.571194410324097
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.535555601119995
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.482 Vali Acc: 0.792 Test Loss: 0.482 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.103672027587891
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.189311742782593
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.232028007507324
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.484 Vali Acc: 0.792 Test Loss: 0.484 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.316793441772461
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.792 Test Loss: 0.482 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.465872287750244
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.798 Test Loss: 0.483 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.1965718269348145
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.792 Test Loss: 0.482 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.4949421882629395
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.486 Vali Acc: 0.803 Test Loss: 0.486 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.674855709075928
Epoch: 1, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.894 Vali Acc: 0.231 Test Loss: 1.894 Test Acc: 0.231
Validation loss decreased (inf --> -0.231195).  Saving model ...
Epoch: 2 cost time: 5.729017496109009
Epoch: 2, Steps: 17 | Train Loss: 1.816 Vali Loss: 1.785 Vali Acc: 0.329 Test Loss: 1.785 Test Acc: 0.329
Validation loss decreased (-0.231195 --> -0.329462).  Saving model ...
Epoch: 3 cost time: 4.7945473194122314
Epoch: 3, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.625 Vali Acc: 0.434 Test Loss: 1.625 Test Acc: 0.434
Validation loss decreased (-0.329462 --> -0.433510).  Saving model ...
Epoch: 4 cost time: 4.991340637207031
Epoch: 4, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.454 Vali Acc: 0.549 Test Loss: 1.454 Test Acc: 0.549
Validation loss decreased (-0.433510 --> -0.549118).  Saving model ...
Epoch: 5 cost time: 4.976795434951782
Epoch: 5, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.282 Vali Acc: 0.613 Test Loss: 1.282 Test Acc: 0.613
Validation loss decreased (-0.549118 --> -0.612704).  Saving model ...
Epoch: 6 cost time: 4.848021030426025
Epoch: 6, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.073 Vali Acc: 0.723 Test Loss: 1.073 Test Acc: 0.723
Validation loss decreased (-0.612704 --> -0.722533).  Saving model ...
Epoch: 7 cost time: 5.08169412612915
Epoch: 7, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.886 Vali Acc: 0.763 Test Loss: 0.886 Test Acc: 0.763
Validation loss decreased (-0.722533 --> -0.762997).  Saving model ...
Epoch: 8 cost time: 4.942160129547119
Epoch: 8, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.716 Vali Acc: 0.844 Test Loss: 0.716 Test Acc: 0.844
Validation loss decreased (-0.762997 --> -0.843923).  Saving model ...
Epoch: 9 cost time: 5.552644968032837
Epoch: 9, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.551833868026733
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.550 Vali Acc: 0.861 Test Loss: 0.550 Test Acc: 0.861
Validation loss decreased (-0.843923 --> -0.861266).  Saving model ...
Epoch: 11 cost time: 5.42454981803894
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.522 Vali Acc: 0.861 Test Loss: 0.522 Test Acc: 0.861
Validation loss decreased (-0.861266 --> -0.861266).  Saving model ...
Epoch: 12 cost time: 5.489607572555542
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.659712791442871
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.486 Vali Acc: 0.867 Test Loss: 0.486 Test Acc: 0.867
Validation loss decreased (-0.861266 --> -0.867047).  Saving model ...
Epoch: 14 cost time: 5.277135610580444
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.0727317333221436
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
Validation loss decreased (-0.867047 --> -0.867047).  Saving model ...
Epoch: 16 cost time: 5.130883693695068
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
Validation loss decreased (-0.867047 --> -0.867047).  Saving model ...
Epoch: 17 cost time: 4.926055431365967
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.456 Vali Acc: 0.879 Test Loss: 0.456 Test Acc: 0.879
Validation loss decreased (-0.867047 --> -0.878608).  Saving model ...
Epoch: 18 cost time: 4.992859601974487
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.455 Vali Acc: 0.879 Test Loss: 0.455 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 19 cost time: 5.11467981338501
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.446 Vali Acc: 0.879 Test Loss: 0.446 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 20 cost time: 5.27758002281189
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.879 Test Loss: 0.445 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 21 cost time: 5.619634628295898
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.441 Vali Acc: 0.879 Test Loss: 0.441 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 22 cost time: 5.269212007522583
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.879 Test Loss: 0.439 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 23 cost time: 5.395426511764526
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.436 Vali Acc: 0.879 Test Loss: 0.436 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 24 cost time: 5.336374998092651
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.879 Test Loss: 0.434 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 25 cost time: 5.664583921432495
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.879 Test Loss: 0.433 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 26 cost time: 5.2900097370147705
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.430 Vali Acc: 0.879 Test Loss: 0.430 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 27 cost time: 5.25258994102478
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.879 Test Loss: 0.432 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.083164215087891
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.429 Vali Acc: 0.879 Test Loss: 0.429 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 29 cost time: 5.045529365539551
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.879 Test Loss: 0.427 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 30 cost time: 5.151677370071411
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.879 Test Loss: 0.423 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 31 cost time: 5.350942373275757
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.879 Test Loss: 0.423 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878608).  Saving model ...
Epoch: 32 cost time: 5.215832233428955
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.879 Test Loss: 0.421 Test Acc: 0.879
Validation loss decreased (-0.878608 --> -0.878609).  Saving model ...
Epoch: 33 cost time: 5.19226861000061
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.422 Vali Acc: 0.879 Test Loss: 0.422 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.245398283004761
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.879 Test Loss: 0.420 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 35 cost time: 5.556595087051392
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.879 Test Loss: 0.420 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 36 cost time: 5.528562545776367
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.419 Vali Acc: 0.879 Test Loss: 0.419 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 37 cost time: 5.155494928359985
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.879 Test Loss: 0.418 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 38 cost time: 5.223750829696655
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.879 Test Loss: 0.417 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 39 cost time: 5.266234636306763
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.879 Test Loss: 0.416 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 40 cost time: 5.332294225692749
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.879 Test Loss: 0.415 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 41 cost time: 5.3089282512664795
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.879 Test Loss: 0.414 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 42 cost time: 4.942813158035278
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.879 Test Loss: 0.414 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.095294713973999
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.879 Test Loss: 0.412 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 44 cost time: 5.0276103019714355
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.879 Test Loss: 0.411 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 45 cost time: 5.336662530899048
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.879 Test Loss: 0.411 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 46 cost time: 5.130121946334839
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.879 Test Loss: 0.412 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 5.587380886077881
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.879 Test Loss: 0.412 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 5.459985017776489
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.879 Test Loss: 0.411 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 49 cost time: 5.2959089279174805
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.879 Test Loss: 0.412 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 5.335955381393433
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.411 Vali Acc: 0.879 Test Loss: 0.411 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 51 cost time: 5.488273620605469
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.879 Test Loss: 0.410 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 52 cost time: 5.591043710708618
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.879 Test Loss: 0.409 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 53 cost time: 5.03539514541626
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.879 Test Loss: 0.409 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.151411771774292
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.410 Vali Acc: 0.879 Test Loss: 0.410 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 5.352635383605957
Epoch: 55, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.879 Test Loss: 0.409 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 56 cost time: 4.849355220794678
Epoch: 56, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.410 Vali Acc: 0.879 Test Loss: 0.410 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.593153715133667
Epoch: 57, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.879 Test Loss: 0.409 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 58 cost time: 5.499477386474609
Epoch: 58, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.879 Test Loss: 0.408 Test Acc: 0.879
Validation loss decreased (-0.878609 --> -0.878609).  Saving model ...
Epoch: 59 cost time: 5.19011664390564
Epoch: 59, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.879 Test Loss: 0.408 Test Acc: 0.879
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 5.319302082061768
Epoch: 60, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.879 Test Loss: 0.409 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 5.338014602661133
Epoch: 61, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.879 Test Loss: 0.409 Test Acc: 0.879
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 5.6304590702056885
Epoch: 62, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.409 Vali Acc: 0.884 Test Loss: 0.409 Test Acc: 0.884
Validation loss decreased (-0.878609 --> -0.884389).  Saving model ...
Epoch: 63 cost time: 5.103060722351074
Epoch: 63, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
Validation loss decreased (-0.884389 --> -0.884389).  Saving model ...
Epoch: 64 cost time: 5.214332342147827
Epoch: 64, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
Validation loss decreased (-0.884389 --> -0.884389).  Saving model ...
Epoch: 65 cost time: 4.640086889266968
Epoch: 65, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 4.693618297576904
Epoch: 66, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.879 Test Loss: 0.408 Test Acc: 0.879
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 4.706867456436157
Epoch: 67, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.879 Test Loss: 0.408 Test Acc: 0.879
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 5.4766271114349365
Epoch: 68, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.879 Test Loss: 0.408 Test Acc: 0.879
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 5.766686916351318
Epoch: 69, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.879 Test Loss: 0.407 Test Acc: 0.879
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 5.5859527587890625
Epoch: 70, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.879 Test Loss: 0.406 Test Acc: 0.879
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 5.23080039024353
Epoch: 71, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.406 Vali Acc: 0.879 Test Loss: 0.406 Test Acc: 0.879
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 5.357922792434692
Epoch: 72, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.879 Test Loss: 0.407 Test Acc: 0.879
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 5.3022119998931885
Epoch: 73, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.407 Vali Acc: 0.879 Test Loss: 0.407 Test Acc: 0.879
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 5.181277751922607
Epoch: 74, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.879 Test Loss: 0.408 Test Acc: 0.879
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.506967544555664
Epoch: 1, Steps: 17 | Train Loss: 2.012 Vali Loss: 1.903 Vali Acc: 0.168 Test Loss: 1.903 Test Acc: 0.168
Validation loss decreased (inf --> -0.167611).  Saving model ...
Epoch: 2 cost time: 5.147876024246216
Epoch: 2, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.833 Vali Acc: 0.277 Test Loss: 1.833 Test Acc: 0.277
Validation loss decreased (-0.167611 --> -0.277438).  Saving model ...
Epoch: 3 cost time: 5.6635918617248535
Epoch: 3, Steps: 17 | Train Loss: 1.713 Vali Loss: 1.698 Vali Acc: 0.451 Test Loss: 1.698 Test Acc: 0.451
Validation loss decreased (-0.277438 --> -0.450850).  Saving model ...
Epoch: 4 cost time: 6.646706819534302
Epoch: 4, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.562 Vali Acc: 0.543 Test Loss: 1.562 Test Acc: 0.543
Validation loss decreased (-0.450850 --> -0.543337).  Saving model ...
Epoch: 5 cost time: 5.755141973495483
Epoch: 5, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.425 Vali Acc: 0.595 Test Loss: 1.425 Test Acc: 0.595
Validation loss decreased (-0.543337 --> -0.595361).  Saving model ...
Epoch: 6 cost time: 6.696651220321655
Epoch: 6, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.254 Vali Acc: 0.676 Test Loss: 1.254 Test Acc: 0.676
Validation loss decreased (-0.595361 --> -0.676288).  Saving model ...
Epoch: 7 cost time: 6.012547492980957
Epoch: 7, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.101 Vali Acc: 0.671 Test Loss: 1.101 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.610663414001465
Epoch: 8, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.935 Vali Acc: 0.705 Test Loss: 0.935 Test Acc: 0.705
Validation loss decreased (-0.676288 --> -0.705193).  Saving model ...
Epoch: 9 cost time: 5.63298225402832
Epoch: 9, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.839 Vali Acc: 0.682 Test Loss: 0.839 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.461258172988892
Epoch: 10, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.731 Vali Acc: 0.728 Test Loss: 0.731 Test Acc: 0.728
Validation loss decreased (-0.705193 --> -0.728316).  Saving model ...
Epoch: 11 cost time: 5.5458009243011475
Epoch: 11, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.711 Vali Acc: 0.699 Test Loss: 0.711 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.163341522216797
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.672 Vali Acc: 0.711 Test Loss: 0.672 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.006909370422363
Epoch: 13, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.651 Vali Acc: 0.717 Test Loss: 0.651 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.776344299316406
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.807310104370117
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.635 Vali Acc: 0.728 Test Loss: 0.635 Test Acc: 0.728
Validation loss decreased (-0.728316 --> -0.728317).  Saving model ...
Epoch: 16 cost time: 5.876357555389404
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.639 Vali Acc: 0.705 Test Loss: 0.639 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.763880491256714
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.660211563110352
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.634 Vali Acc: 0.728 Test Loss: 0.634 Test Acc: 0.728
Validation loss decreased (-0.728317 --> -0.728317).  Saving model ...
Epoch: 19 cost time: 5.399858713150024
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.740 Test Loss: 0.624 Test Acc: 0.740
Validation loss decreased (-0.728317 --> -0.739878).  Saving model ...
Epoch: 20 cost time: 5.317801475524902
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.622 Vali Acc: 0.734 Test Loss: 0.622 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.184985399246216
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
Validation loss decreased (-0.739878 --> -0.745659).  Saving model ...
Epoch: 22 cost time: 5.162384748458862
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.623 Vali Acc: 0.734 Test Loss: 0.623 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.098627805709839
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.723 Test Loss: 0.623 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.595929145812988
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.734 Test Loss: 0.622 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.460410833358765
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.623 Vali Acc: 0.734 Test Loss: 0.623 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.456656455993652
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.616 Vali Acc: 0.734 Test Loss: 0.616 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.850019454956055
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.740 Test Loss: 0.617 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.732579946517944
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.740 Test Loss: 0.616 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.574631214141846
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.728 Test Loss: 0.623 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.910444974899292
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.626 Vali Acc: 0.728 Test Loss: 0.626 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.1452085971832275
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.622 Vali Acc: 0.734 Test Loss: 0.622 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.210546970367432
Epoch: 1, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.952 Vali Acc: 0.220 Test Loss: 1.952 Test Acc: 0.220
Validation loss decreased (inf --> -0.219634).  Saving model ...
Epoch: 2 cost time: 4.646751165390015
Epoch: 2, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.896 Vali Acc: 0.243 Test Loss: 1.896 Test Acc: 0.243
Validation loss decreased (-0.219634 --> -0.242756).  Saving model ...
Epoch: 3 cost time: 4.886596202850342
Epoch: 3, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.784 Vali Acc: 0.370 Test Loss: 1.784 Test Acc: 0.370
Validation loss decreased (-0.242756 --> -0.369924).  Saving model ...
Epoch: 4 cost time: 5.962866544723511
Epoch: 4, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.683 Vali Acc: 0.439 Test Loss: 1.683 Test Acc: 0.439
Validation loss decreased (-0.369924 --> -0.439290).  Saving model ...
Epoch: 5 cost time: 5.742401361465454
Epoch: 5, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.551 Vali Acc: 0.561 Test Loss: 1.551 Test Acc: 0.561
Validation loss decreased (-0.439290 --> -0.560678).  Saving model ...
Epoch: 6 cost time: 5.8007652759552
Epoch: 6, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.404 Vali Acc: 0.607 Test Loss: 1.404 Test Acc: 0.607
Validation loss decreased (-0.560678 --> -0.606922).  Saving model ...
Epoch: 7 cost time: 6.087536096572876
Epoch: 7, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.269 Vali Acc: 0.636 Test Loss: 1.269 Test Acc: 0.636
Validation loss decreased (-0.606922 --> -0.635825).  Saving model ...
Epoch: 8 cost time: 5.963414430618286
Epoch: 8, Steps: 17 | Train Loss: 0.715 Vali Loss: 1.102 Vali Acc: 0.711 Test Loss: 1.102 Test Acc: 0.711
Validation loss decreased (-0.635825 --> -0.710972).  Saving model ...
Epoch: 9 cost time: 5.815542459487915
Epoch: 9, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.970 Vali Acc: 0.705 Test Loss: 0.970 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.466068983078003
Epoch: 10, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.857 Vali Acc: 0.740 Test Loss: 0.857 Test Acc: 0.740
Validation loss decreased (-0.710972 --> -0.739876).  Saving model ...
Epoch: 11 cost time: 5.38628077507019
Epoch: 11, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
Validation loss decreased (-0.739876 --> -0.774559).  Saving model ...
Epoch: 12 cost time: 5.399489641189575
Epoch: 12, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.700 Vali Acc: 0.780 Test Loss: 0.700 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780340).  Saving model ...
Epoch: 13 cost time: 5.385237216949463
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.658 Vali Acc: 0.780 Test Loss: 0.658 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 14 cost time: 5.095939874649048
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.637 Vali Acc: 0.792 Test Loss: 0.637 Test Acc: 0.792
Validation loss decreased (-0.780340 --> -0.791901).  Saving model ...
Epoch: 15 cost time: 5.4634010791778564
Epoch: 15, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.616 Vali Acc: 0.792 Test Loss: 0.616 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791901).  Saving model ...
Epoch: 16 cost time: 5.554909706115723
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.607 Vali Acc: 0.792 Test Loss: 0.607 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791901).  Saving model ...
Epoch: 17 cost time: 5.377598285675049
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.603 Vali Acc: 0.792 Test Loss: 0.603 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791901).  Saving model ...
Epoch: 18 cost time: 5.341402053833008
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.590 Vali Acc: 0.792 Test Loss: 0.590 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 19 cost time: 5.402792930603027
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803462).  Saving model ...
Epoch: 20 cost time: 5.009435653686523
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.587 Vali Acc: 0.780 Test Loss: 0.587 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.99979829788208
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.780 Test Loss: 0.579 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.951814651489258
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.574 Vali Acc: 0.786 Test Loss: 0.574 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.014294862747192
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.577 Vali Acc: 0.780 Test Loss: 0.577 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.9799792766571045
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.578 Vali Acc: 0.769 Test Loss: 0.578 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.046871185302734
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.573 Vali Acc: 0.780 Test Loss: 0.573 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.387423276901245
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.569 Vali Acc: 0.786 Test Loss: 0.569 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.580978631973267
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.573 Vali Acc: 0.786 Test Loss: 0.573 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.437844276428223
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.780 Test Loss: 0.565 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.392911195755005
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.565 Vali Acc: 0.786 Test Loss: 0.565 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.36716890335083
Epoch: 1, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.951 Vali Acc: 0.168 Test Loss: 1.951 Test Acc: 0.168
Validation loss decreased (inf --> -0.167611).  Saving model ...
Epoch: 2 cost time: 5.18506646156311
Epoch: 2, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.908 Vali Acc: 0.191 Test Loss: 1.908 Test Acc: 0.191
Validation loss decreased (-0.167611 --> -0.190732).  Saving model ...
Epoch: 3 cost time: 5.417803525924683
Epoch: 3, Steps: 17 | Train Loss: 1.825 Vali Loss: 1.806 Vali Acc: 0.243 Test Loss: 1.806 Test Acc: 0.243
Validation loss decreased (-0.190732 --> -0.242757).  Saving model ...
Epoch: 4 cost time: 5.12725830078125
Epoch: 4, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.708 Vali Acc: 0.335 Test Loss: 1.708 Test Acc: 0.335
Validation loss decreased (-0.242757 --> -0.335243).  Saving model ...
Epoch: 5 cost time: 4.802080869674683
Epoch: 5, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.592 Vali Acc: 0.486 Test Loss: 1.592 Test Acc: 0.486
Validation loss decreased (-0.335243 --> -0.485533).  Saving model ...
Epoch: 6 cost time: 5.393263101577759
Epoch: 6, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.451 Vali Acc: 0.590 Test Loss: 1.451 Test Acc: 0.590
Validation loss decreased (-0.485533 --> -0.589581).  Saving model ...
Epoch: 7 cost time: 5.834211111068726
Epoch: 7, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.328 Vali Acc: 0.630 Test Loss: 1.328 Test Acc: 0.630
Validation loss decreased (-0.589581 --> -0.630045).  Saving model ...
Epoch: 8 cost time: 5.493216514587402
Epoch: 8, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.170 Vali Acc: 0.665 Test Loss: 1.170 Test Acc: 0.665
Validation loss decreased (-0.630045 --> -0.664728).  Saving model ...
Epoch: 9 cost time: 5.257850170135498
Epoch: 9, Steps: 17 | Train Loss: 0.697 Vali Loss: 1.034 Vali Acc: 0.676 Test Loss: 1.034 Test Acc: 0.676
Validation loss decreased (-0.664728 --> -0.676290).  Saving model ...
Epoch: 10 cost time: 5.586946249008179
Epoch: 10, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.919 Vali Acc: 0.665 Test Loss: 0.919 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.884010314941406
Epoch: 11, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.828 Vali Acc: 0.751 Test Loss: 0.828 Test Acc: 0.751
Validation loss decreased (-0.676290 --> -0.751437).  Saving model ...
Epoch: 12 cost time: 5.368078231811523
Epoch: 12, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.768 Vali Acc: 0.711 Test Loss: 0.768 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.483520746231079
Epoch: 13, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.719 Vali Acc: 0.740 Test Loss: 0.719 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.573693037033081
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.674 Vali Acc: 0.757 Test Loss: 0.674 Test Acc: 0.757
Validation loss decreased (-0.751437 --> -0.757219).  Saving model ...
Epoch: 15 cost time: 5.599708557128906
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.997340202331543
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
Validation loss decreased (-0.757219 --> -0.762999).  Saving model ...
Epoch: 17 cost time: 5.396306276321411
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 18 cost time: 5.736846208572388
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.641 Vali Acc: 0.786 Test Loss: 0.641 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786121).  Saving model ...
Epoch: 19 cost time: 5.693573713302612
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 20 cost time: 6.292178392410278
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.632 Vali Acc: 0.780 Test Loss: 0.632 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.994568109512329
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.625 Vali Acc: 0.798 Test Loss: 0.625 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797682).  Saving model ...
Epoch: 22 cost time: 5.634836196899414
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.621 Vali Acc: 0.798 Test Loss: 0.621 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797682).  Saving model ...
Epoch: 23 cost time: 5.978809833526611
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.616 Vali Acc: 0.792 Test Loss: 0.616 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.250289440155029
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.80022668838501
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.085151433944702
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.0754075050354
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.491576671600342
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.600 Vali Acc: 0.769 Test Loss: 0.600 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.558134317398071
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.528002023696899
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.601 Vali Acc: 0.769 Test Loss: 0.601 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.42091703414917
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.531699895858765
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.593 Vali Acc: 0.769 Test Loss: 0.593 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.236476421356201
Epoch: 1, Steps: 17 | Train Loss: 2.044 Vali Loss: 2.004 Vali Acc: 0.150 Test Loss: 2.004 Test Acc: 0.150
Validation loss decreased (inf --> -0.150269).  Saving model ...
Epoch: 2 cost time: 5.491704702377319
Epoch: 2, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.961 Vali Acc: 0.225 Test Loss: 1.961 Test Acc: 0.225
Validation loss decreased (-0.150269 --> -0.225414).  Saving model ...
Epoch: 3 cost time: 5.656207323074341
Epoch: 3, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.862 Vali Acc: 0.283 Test Loss: 1.862 Test Acc: 0.283
Validation loss decreased (-0.225414 --> -0.283218).  Saving model ...
Epoch: 4 cost time: 5.502876043319702
Epoch: 4, Steps: 17 | Train Loss: 1.718 Vali Loss: 1.753 Vali Acc: 0.393 Test Loss: 1.753 Test Acc: 0.393
Validation loss decreased (-0.283218 --> -0.393046).  Saving model ...
Epoch: 5 cost time: 5.403379678726196
Epoch: 5, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.630 Vali Acc: 0.514 Test Loss: 1.630 Test Acc: 0.514
Validation loss decreased (-0.393046 --> -0.514435).  Saving model ...
Epoch: 6 cost time: 6.029019355773926
Epoch: 6, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.483 Vali Acc: 0.595 Test Loss: 1.483 Test Acc: 0.595
Validation loss decreased (-0.514435 --> -0.595361).  Saving model ...
Epoch: 7 cost time: 5.802085876464844
Epoch: 7, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.338 Vali Acc: 0.624 Test Loss: 1.338 Test Acc: 0.624
Validation loss decreased (-0.595361 --> -0.624264).  Saving model ...
Epoch: 8 cost time: 6.155986547470093
Epoch: 8, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.169 Vali Acc: 0.642 Test Loss: 1.169 Test Acc: 0.642
Validation loss decreased (-0.624264 --> -0.641607).  Saving model ...
Epoch: 9 cost time: 5.971540689468384
Epoch: 9, Steps: 17 | Train Loss: 0.667 Vali Loss: 1.034 Vali Acc: 0.711 Test Loss: 1.034 Test Acc: 0.711
Validation loss decreased (-0.641607 --> -0.710972).  Saving model ...
Epoch: 10 cost time: 5.904433727264404
Epoch: 10, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.914 Vali Acc: 0.705 Test Loss: 0.914 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.9594666957855225
Epoch: 11, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.827 Vali Acc: 0.740 Test Loss: 0.827 Test Acc: 0.740
Validation loss decreased (-0.710972 --> -0.739876).  Saving model ...
Epoch: 12 cost time: 5.437931776046753
Epoch: 12, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.752 Vali Acc: 0.723 Test Loss: 0.752 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.134463787078857
Epoch: 13, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
Validation loss decreased (-0.739876 --> -0.745658).  Saving model ...
Epoch: 14 cost time: 5.3689799308776855
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.676 Vali Acc: 0.757 Test Loss: 0.676 Test Acc: 0.757
Validation loss decreased (-0.745658 --> -0.757219).  Saving model ...
Epoch: 15 cost time: 5.539906978607178
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
Validation loss decreased (-0.757219 --> -0.762999).  Saving model ...
Epoch: 16 cost time: 5.193729400634766
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.664 Vali Acc: 0.751 Test Loss: 0.664 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.302659273147583
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 18 cost time: 5.638666152954102
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.50321364402771
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.639 Vali Acc: 0.763 Test Loss: 0.639 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.907207250595093
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.628 Vali Acc: 0.763 Test Loss: 0.628 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.631604194641113
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.621 Vali Acc: 0.780 Test Loss: 0.621 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780341).  Saving model ...
Epoch: 22 cost time: 5.807925462722778
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.622 Vali Acc: 0.780 Test Loss: 0.622 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.221142292022705
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.615 Vali Acc: 0.786 Test Loss: 0.615 Test Acc: 0.786
Validation loss decreased (-0.780341 --> -0.786121).  Saving model ...
Epoch: 24 cost time: 5.149462461471558
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.482825517654419
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.275460243225098
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.946288824081421
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.613 Vali Acc: 0.780 Test Loss: 0.613 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.901912689208984
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.340748071670532
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.342761993408203
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.605 Vali Acc: 0.769 Test Loss: 0.605 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.356826543807983
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.604 Vali Acc: 0.769 Test Loss: 0.604 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.558014392852783
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.522939682006836
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.602 Vali Acc: 0.769 Test Loss: 0.602 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 191815
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
fourier enhanced block used!
modes=32, index=[3, 4, 8, 9, 11, 13, 17, 20, 22, 23, 27, 28, 30, 31, 32, 34, 39, 40, 43, 45, 47, 49, 50, 51, 53, 55, 56, 63, 64, 65, 69, 70]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 33, 35]
modes_kv=32, index_kv=[0, 1, 8, 9, 11, 13, 15, 17, 18, 19, 21, 23, 24, 26, 30, 32, 35, 38, 42, 44, 47, 56, 57, 58, 59, 60, 61, 62, 63, 65, 68, 71]
>>>>>>>start training : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.77721095085144
Epoch: 1, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
Validation loss decreased (inf --> -0.132929).  Saving model ...
Epoch: 2 cost time: 5.428137302398682
Epoch: 2, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.426127910614014
Epoch: 3, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.401487350463867
Epoch: 4, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.726448059082031
Epoch: 5, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.673689126968384
Epoch: 6, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.80126690864563
Epoch: 7, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.971905946731567
Epoch: 8, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.224918365478516
Epoch: 9, Steps: 17 | Train Loss: 1.946 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.705743312835693
Epoch: 10, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.946 Vali Acc: 0.133 Test Loss: 1.946 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.035729646682739
Epoch: 11, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.947 Vali Acc: 0.133 Test Loss: 1.947 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_FEDformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.1329479768786127
model parameter : 191815
model size : 1.98MB
