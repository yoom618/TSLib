Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 9.690766334533691
Epoch: 1, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 7.095101356506348
Epoch: 2, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 7.712405204772949
Epoch: 3, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 6.349505424499512
Epoch: 4, Steps: 1 | Train Loss: 0.526 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.830758333206177
Epoch: 5, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.013 Vali Acc: 0.333 Test Loss: 1.013 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.732714653015137
Epoch: 6, Steps: 1 | Train Loss: 0.294 Vali Loss: 2.026 Vali Acc: 0.333 Test Loss: 2.026 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.024254322052002
Epoch: 7, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.824 Vali Acc: 0.200 Test Loss: 1.824 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.976234197616577
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.283 Vali Acc: 0.333 Test Loss: 2.283 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.477777004241943
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.364 Vali Acc: 0.333 Test Loss: 3.364 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.750328063964844
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.644 Vali Acc: 0.333 Test Loss: 4.644 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.610342741012573
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.969 Vali Acc: 0.333 Test Loss: 5.969 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.014927625656128
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.304 Vali Acc: 0.333 Test Loss: 7.304 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.253667593002319
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.627 Vali Acc: 0.333 Test Loss: 8.627 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 8.006042242050171
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 6.466686248779297
Epoch: 2, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 6.456754684448242
Epoch: 3, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.149549722671509
Epoch: 4, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.397531509399414
Epoch: 5, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.097336292266846
Epoch: 6, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.857 Vali Acc: 0.333 Test Loss: 1.857 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.80399489402771
Epoch: 7, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.794 Vali Acc: 0.200 Test Loss: 1.794 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.7524731159210205
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.384 Vali Acc: 0.267 Test Loss: 2.384 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.6507978439331055
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.293 Vali Acc: 0.333 Test Loss: 3.293 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.321732044219971
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.340 Vali Acc: 0.400 Test Loss: 4.340 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.124776124954224
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.431 Vali Acc: 0.400 Test Loss: 5.431 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.676598072052002
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.525 Vali Acc: 0.333 Test Loss: 6.525 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 6.2989654541015625
Epoch: 1, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 4.665091037750244
Epoch: 2, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 6.159036636352539
Epoch: 3, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 5.028042554855347
Epoch: 4, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.1157450675964355
Epoch: 5, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.353068828582764
Epoch: 6, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.686 Vali Acc: 0.333 Test Loss: 1.686 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.039236545562744
Epoch: 7, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.458 Vali Acc: 0.467 Test Loss: 1.458 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466652).  Saving model ...
Epoch: 8 cost time: 5.5036232471466064
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.016 Vali Acc: 0.400 Test Loss: 2.016 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.573829174041748
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.810 Vali Acc: 0.467 Test Loss: 2.810 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.933454751968384
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.701 Vali Acc: 0.400 Test Loss: 3.701 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.907591819763184
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.621 Vali Acc: 0.400 Test Loss: 4.621 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.652660131454468
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.538 Vali Acc: 0.400 Test Loss: 5.538 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.877732038497925
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.436 Vali Acc: 0.400 Test Loss: 6.436 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.594895362854004
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.306 Vali Acc: 0.400 Test Loss: 7.306 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.027357816696167
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.142 Vali Acc: 0.400 Test Loss: 8.142 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.3854005336761475
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.944 Vali Acc: 0.400 Test Loss: 8.944 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.48917293548584
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.708 Vali Acc: 0.400 Test Loss: 9.708 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 6.15704870223999
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 4.130274534225464
Epoch: 2, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 5.070136785507202
Epoch: 3, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 3.660987615585327
Epoch: 4, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 4.41288423538208
Epoch: 5, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.463789224624634
Epoch: 6, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.894 Vali Acc: 0.333 Test Loss: 1.894 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5411317348480225
Epoch: 7, Steps: 1 | Train Loss: 0.036 Vali Loss: 2.488 Vali Acc: 0.467 Test Loss: 2.488 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.098965167999268
Epoch: 8, Steps: 1 | Train Loss: 0.002 Vali Loss: 3.545 Vali Acc: 0.467 Test Loss: 3.545 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.529640197753906
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.677 Vali Acc: 0.467 Test Loss: 4.677 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.55540132522583
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.820 Vali Acc: 0.467 Test Loss: 5.820 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.1556806564331055
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.945 Vali Acc: 0.467 Test Loss: 6.945 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.0620081424713135
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.038 Vali Acc: 0.467 Test Loss: 8.038 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.340381622314453
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.090 Vali Acc: 0.467 Test Loss: 9.090 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.3334853649139404
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.097 Vali Acc: 0.467 Test Loss: 10.097 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.7160868644714355
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 3.2720437049865723
Epoch: 2, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 3.156107187271118
Epoch: 3, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.194 Vali Acc: 0.133 Test Loss: 1.194 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.874575614929199
Epoch: 4, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0271575450897217
Epoch: 5, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.593698024749756
Epoch: 6, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.929 Vali Acc: 0.333 Test Loss: 1.929 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.6022934913635254
Epoch: 7, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.575 Vali Acc: 0.467 Test Loss: 2.575 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466641).  Saving model ...
Epoch: 8 cost time: 3.1205925941467285
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.764 Vali Acc: 0.467 Test Loss: 3.764 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5571670532226562
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.182 Vali Acc: 0.467 Test Loss: 5.182 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1567320823669434
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.651 Vali Acc: 0.400 Test Loss: 6.651 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.705054759979248
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.111 Vali Acc: 0.400 Test Loss: 8.111 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.171968936920166
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.539 Vali Acc: 0.400 Test Loss: 9.539 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.343045711517334
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.921 Vali Acc: 0.400 Test Loss: 10.921 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5473506450653076
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.247 Vali Acc: 0.400 Test Loss: 12.247 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.148371458053589
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 13.513 Vali Acc: 0.400 Test Loss: 13.513 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.128145694732666
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 14.717 Vali Acc: 0.400 Test Loss: 14.717 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7921369075775146
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 15.858 Vali Acc: 0.400 Test Loss: 15.858 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.117383003234863
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.0141420364379883
Epoch: 2, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.657426357269287
Epoch: 3, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 2.8354294300079346
Epoch: 4, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.596384048461914
Epoch: 5, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 2.5584685802459717
Epoch: 6, Steps: 1 | Train Loss: 0.217 Vali Loss: 2.121 Vali Acc: 0.400 Test Loss: 2.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.499553918838501
Epoch: 7, Steps: 1 | Train Loss: 0.010 Vali Loss: 2.626 Vali Acc: 0.533 Test Loss: 2.626 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8469583988189697
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.626 Vali Acc: 0.467 Test Loss: 3.626 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3748562335968018
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.842 Vali Acc: 0.333 Test Loss: 4.842 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.808236837387085
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.144 Vali Acc: 0.333 Test Loss: 6.144 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.675595998764038
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.470 Vali Acc: 0.267 Test Loss: 7.470 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6787269115448
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.784 Vali Acc: 0.267 Test Loss: 8.784 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.57785701751709
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.066 Vali Acc: 0.267 Test Loss: 10.066 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5227696895599365
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.304 Vali Acc: 0.267 Test Loss: 11.304 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.463653564453125
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.490 Vali Acc: 0.267 Test Loss: 12.490 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.888722658157349
Epoch: 1, Steps: 1 | Train Loss: 1.258 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 2.65348219871521
Epoch: 2, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4275615215301514
Epoch: 3, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.508978843688965
Epoch: 4, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.011 Vali Acc: 0.333 Test Loss: 1.011 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.468604326248169
Epoch: 5, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.013 Vali Acc: 0.333 Test Loss: 1.013 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.337650775909424
Epoch: 6, Steps: 1 | Train Loss: 0.275 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.184384822845459
Epoch: 7, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6991305351257324
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.467 Test Loss: 1.482 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6500425338745117
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.533 Test Loss: 2.098 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.711648464202881
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.800 Vali Acc: 0.600 Test Loss: 2.800 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599972).  Saving model ...
Epoch: 11 cost time: 2.4961583614349365
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.520 Vali Acc: 0.600 Test Loss: 3.520 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5621256828308105
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.233 Vali Acc: 0.600 Test Loss: 4.233 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.835127115249634
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.928 Vali Acc: 0.600 Test Loss: 4.928 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.581301212310791
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.599 Vali Acc: 0.533 Test Loss: 5.599 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5719501972198486
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.245 Vali Acc: 0.533 Test Loss: 6.245 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.613328218460083
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.863 Vali Acc: 0.467 Test Loss: 6.863 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6176271438598633
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.451 Vali Acc: 0.467 Test Loss: 7.451 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.022508382797241
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.010 Vali Acc: 0.467 Test Loss: 8.010 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.208996057510376
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.540 Vali Acc: 0.467 Test Loss: 8.540 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7366116046905518
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.040 Vali Acc: 0.467 Test Loss: 9.040 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.396404981613159
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.264531135559082
Epoch: 2, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 2.4210493564605713
Epoch: 3, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 2.332422971725464
Epoch: 4, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 2.2768445014953613
Epoch: 5, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.979318618774414
Epoch: 6, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.332 Vali Acc: 0.467 Test Loss: 1.332 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3508853912353516
Epoch: 7, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2203941345214844
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.219 Vali Acc: 0.533 Test Loss: 1.219 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.56897234916687
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.533 Test Loss: 1.449 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2392003536224365
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.533 Test Loss: 1.734 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.643887996673584
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.042 Vali Acc: 0.467 Test Loss: 2.042 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6489744186401367
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.467 Test Loss: 2.355 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.652872323989868
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.665 Vali Acc: 0.467 Test Loss: 2.665 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.646521806716919
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.967 Vali Acc: 0.467 Test Loss: 2.967 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3048152923583984
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.258 Vali Acc: 0.467 Test Loss: 3.258 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.336534023284912
Epoch: 1, Steps: 1 | Train Loss: 1.257 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 2.32796311378479
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.8185105323791504
Epoch: 3, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 2.6173064708709717
Epoch: 4, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5007572174072266
Epoch: 5, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 2.4021804332733154
Epoch: 6, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.441 Vali Acc: 0.333 Test Loss: 1.441 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0697715282440186
Epoch: 7, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0639724731445312
Epoch: 8, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.720 Vali Acc: 0.533 Test Loss: 1.720 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533316).  Saving model ...
Epoch: 9 cost time: 2.352449893951416
Epoch: 9, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.708 Vali Acc: 0.533 Test Loss: 1.708 Test Acc: 0.533
Validation loss decreased (-0.533316 --> -0.533316).  Saving model ...
Epoch: 10 cost time: 2.6237645149230957
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.400 Test Loss: 1.727 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3894388675689697
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.467 Test Loss: 1.945 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2734601497650146
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.260 Vali Acc: 0.400 Test Loss: 2.260 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1560566425323486
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.612 Vali Acc: 0.400 Test Loss: 2.612 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2500436305999756
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.978 Vali Acc: 0.400 Test Loss: 2.978 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4369218349456787
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.348 Vali Acc: 0.400 Test Loss: 3.348 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0975427627563477
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.714 Vali Acc: 0.467 Test Loss: 3.714 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.18122935295105
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.072 Vali Acc: 0.467 Test Loss: 4.072 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4854791164398193
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.419 Vali Acc: 0.467 Test Loss: 4.419 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.569197654724121
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.751 Vali Acc: 0.467 Test Loss: 4.751 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.298120975494385
Epoch: 1, Steps: 1 | Train Loss: 1.296 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.4415526390075684
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.6499786376953125
Epoch: 3, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8624484539031982
Epoch: 4, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.013207197189331
Epoch: 5, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1645164489746094
Epoch: 6, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.002704381942749
Epoch: 7, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.673 Vali Acc: 0.400 Test Loss: 1.673 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.038296937942505
Epoch: 8, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.754 Vali Acc: 0.467 Test Loss: 1.754 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466649).  Saving model ...
Epoch: 9 cost time: 2.194803237915039
Epoch: 9, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.874 Vali Acc: 0.467 Test Loss: 1.874 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5241589546203613
Epoch: 10, Steps: 1 | Train Loss: 0.042 Vali Loss: 2.520 Vali Acc: 0.400 Test Loss: 2.520 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5109994411468506
Epoch: 11, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.722 Vali Acc: 0.467 Test Loss: 2.722 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3183162212371826
Epoch: 12, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.733 Vali Acc: 0.400 Test Loss: 2.733 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.451425790786743
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.885 Vali Acc: 0.467 Test Loss: 2.885 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.198279857635498
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.151 Vali Acc: 0.467 Test Loss: 3.151 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3461203575134277
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.484 Vali Acc: 0.467 Test Loss: 3.484 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2249062061309814
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.866 Vali Acc: 0.467 Test Loss: 3.866 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1015939712524414
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.278 Vali Acc: 0.467 Test Loss: 4.278 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2438738346099854
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.702 Vali Acc: 0.467 Test Loss: 4.702 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 20648451
model size : 98.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 9.696947574615479
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 6.576394081115723
Epoch: 2, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 7.077098846435547
Epoch: 3, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.614097833633423
Epoch: 4, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.346738576889038
Epoch: 5, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.514289379119873
Epoch: 6, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.365 Vali Acc: 0.333 Test Loss: 1.365 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.33551549911499
Epoch: 7, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.488 Vali Acc: 0.333 Test Loss: 1.488 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.081890821456909
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.944 Vali Acc: 0.333 Test Loss: 1.944 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.544673442840576
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.484 Vali Acc: 0.333 Test Loss: 2.484 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.156261682510376
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.052 Vali Acc: 0.333 Test Loss: 3.052 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.173261404037476
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.625 Vali Acc: 0.333 Test Loss: 3.625 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.438462257385254
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.188 Vali Acc: 0.333 Test Loss: 4.188 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 6.7038962841033936
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.054 Vali Acc: 0.600 Test Loss: 1.054 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 6.479482889175415
Epoch: 2, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.114424705505371
Epoch: 3, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.643209218978882
Epoch: 4, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.795332193374634
Epoch: 5, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.4786553382873535
Epoch: 6, Steps: 1 | Train Loss: 0.262 Vali Loss: 1.342 Vali Acc: 0.267 Test Loss: 1.342 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.038702964782715
Epoch: 7, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.144 Vali Acc: 0.267 Test Loss: 2.144 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.235005140304565
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.275 Vali Acc: 0.400 Test Loss: 3.275 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.094694375991821
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.464 Vali Acc: 0.400 Test Loss: 4.464 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.842281818389893
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.669 Vali Acc: 0.400 Test Loss: 5.669 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.630687475204468
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.865 Vali Acc: 0.400 Test Loss: 6.865 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.909041881561279
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 3.5109825134277344
Epoch: 2, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 5.449807167053223
Epoch: 3, Steps: 1 | Train Loss: 0.661 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 4.985336542129517
Epoch: 4, Steps: 1 | Train Loss: 0.529 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.769498825073242
Epoch: 5, Steps: 1 | Train Loss: 0.376 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.3061089515686035
Epoch: 6, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.46088433265686
Epoch: 7, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.898 Vali Acc: 0.467 Test Loss: 1.898 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.027230262756348
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.467 Test Loss: 2.888 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.8139870166778564
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.937 Vali Acc: 0.467 Test Loss: 3.937 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.668022871017456
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.998 Vali Acc: 0.467 Test Loss: 4.998 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.15979790687561
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.048 Vali Acc: 0.467 Test Loss: 6.048 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.418507814407349
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.071 Vali Acc: 0.467 Test Loss: 7.071 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.119101285934448
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.060 Vali Acc: 0.467 Test Loss: 8.060 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.5754618644714355
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 3.9265666007995605
Epoch: 2, Steps: 1 | Train Loss: 0.856 Vali Loss: 0.985 Vali Acc: 0.600 Test Loss: 0.985 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 4.220106601715088
Epoch: 3, Steps: 1 | Train Loss: 0.659 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7796123027801514
Epoch: 4, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.014 Vali Acc: 0.533 Test Loss: 1.014 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7235472202301025
Epoch: 5, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.782005786895752
Epoch: 6, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.844 Vali Acc: 0.467 Test Loss: 1.844 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.535198926925659
Epoch: 7, Steps: 1 | Train Loss: 0.017 Vali Loss: 2.768 Vali Acc: 0.333 Test Loss: 2.768 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.263095378875732
Epoch: 8, Steps: 1 | Train Loss: 0.002 Vali Loss: 3.668 Vali Acc: 0.333 Test Loss: 3.668 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.413109540939331
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.602 Vali Acc: 0.333 Test Loss: 4.602 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.057856798171997
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.542 Vali Acc: 0.333 Test Loss: 5.542 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.9482529163360596
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.469 Vali Acc: 0.333 Test Loss: 6.469 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.264430046081543
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.373 Vali Acc: 0.400 Test Loss: 7.373 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.450627326965332
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 2.8912158012390137
Epoch: 2, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 2.904853343963623
Epoch: 3, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8515939712524414
Epoch: 4, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6096432209014893
Epoch: 5, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.374727487564087
Epoch: 6, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.835 Vali Acc: 0.333 Test Loss: 1.835 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9334561824798584
Epoch: 7, Steps: 1 | Train Loss: 0.014 Vali Loss: 2.345 Vali Acc: 0.467 Test Loss: 2.345 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8071060180664062
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.123 Vali Acc: 0.400 Test Loss: 3.123 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1288063526153564
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.053 Vali Acc: 0.200 Test Loss: 4.053 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.036412477493286
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.099 Vali Acc: 0.200 Test Loss: 5.099 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4730093479156494
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.204 Vali Acc: 0.133 Test Loss: 6.204 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5995044708251953
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.318 Vali Acc: 0.133 Test Loss: 7.318 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.267996072769165
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 2.5013880729675293
Epoch: 2, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1927907466888428
Epoch: 3, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8337335586547852
Epoch: 4, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.036943197250366
Epoch: 5, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0396480560302734
Epoch: 6, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.867 Vali Acc: 0.333 Test Loss: 1.867 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0460612773895264
Epoch: 7, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.743 Vali Acc: 0.400 Test Loss: 2.743 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8942046165466309
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.874 Vali Acc: 0.533 Test Loss: 3.874 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533295).  Saving model ...
Epoch: 9 cost time: 2.4681923389434814
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.121 Vali Acc: 0.467 Test Loss: 5.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.561648368835449
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.412 Vali Acc: 0.467 Test Loss: 6.412 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.52994704246521
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.702 Vali Acc: 0.467 Test Loss: 7.702 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6145262718200684
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.966 Vali Acc: 0.467 Test Loss: 8.966 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.245331048965454
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.190 Vali Acc: 0.467 Test Loss: 10.190 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.564134359359741
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.367 Vali Acc: 0.467 Test Loss: 11.367 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3362505435943604
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.491 Vali Acc: 0.467 Test Loss: 12.491 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3653149604797363
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 13.563 Vali Acc: 0.467 Test Loss: 13.563 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0711216926574707
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 14.579 Vali Acc: 0.467 Test Loss: 14.579 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.162346601486206
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 15.542 Vali Acc: 0.467 Test Loss: 15.542 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.224395275115967
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.1871933937072754
Epoch: 2, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.021 Vali Acc: 0.467 Test Loss: 1.021 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 2.2716586589813232
Epoch: 3, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 2.3205440044403076
Epoch: 4, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1140658855438232
Epoch: 5, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.321324110031128
Epoch: 6, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.412 Vali Acc: 0.467 Test Loss: 1.412 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9572243690490723
Epoch: 7, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.313 Vali Acc: 0.467 Test Loss: 1.313 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0652832984924316
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.333 Test Loss: 1.531 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4938039779663086
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.333 Test Loss: 1.944 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.062493085861206
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.438 Vali Acc: 0.400 Test Loss: 2.438 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.192208766937256
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.964 Vali Acc: 0.333 Test Loss: 2.964 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8879094123840332
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.503 Vali Acc: 0.333 Test Loss: 3.503 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.327852725982666
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.041 Vali Acc: 0.333 Test Loss: 4.041 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.033520221710205
Epoch: 1, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 2.134152412414551
Epoch: 2, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 2.0425021648406982
Epoch: 3, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 2.2201919555664062
Epoch: 4, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.163573980331421
Epoch: 5, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 2.1164121627807617
Epoch: 6, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.078165054321289
Epoch: 7, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.343 Vali Acc: 0.467 Test Loss: 1.343 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.020772933959961
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.189 Vali Acc: 0.400 Test Loss: 2.189 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9552888870239258
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.194 Vali Acc: 0.400 Test Loss: 3.194 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0132298469543457
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.223 Vali Acc: 0.400 Test Loss: 4.223 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.141796827316284
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.248 Vali Acc: 0.400 Test Loss: 5.248 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3649656772613525
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.254 Vali Acc: 0.400 Test Loss: 6.254 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3624863624572754
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.232 Vali Acc: 0.333 Test Loss: 7.232 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3819706439971924
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.175 Vali Acc: 0.333 Test Loss: 8.175 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.039266347885132
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.080 Vali Acc: 0.333 Test Loss: 9.080 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.020493507385254
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
Validation loss decreased (inf --> -0.599988).  Saving model ...
Epoch: 2 cost time: 2.021296739578247
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 2.276564836502075
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1549510955810547
Epoch: 4, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.051234483718872
Epoch: 5, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.795301914215088
Epoch: 6, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.453 Vali Acc: 0.333 Test Loss: 1.453 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1632931232452393
Epoch: 7, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0237021446228027
Epoch: 8, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.594 Vali Acc: 0.333 Test Loss: 1.594 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9300744533538818
Epoch: 9, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.631 Vali Acc: 0.333 Test Loss: 1.631 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7999703884124756
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.616 Vali Acc: 0.467 Test Loss: 1.616 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.106858730316162
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.533 Vali Acc: 0.467 Test Loss: 2.533 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7855448722839355
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.654 Vali Acc: 0.467 Test Loss: 3.654 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4023401737213135
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.6926450729370117
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.3253228664398193
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7670021057128906
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.4336988925933838
Epoch: 5, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6069729328155518
Epoch: 6, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.382 Vali Acc: 0.400 Test Loss: 1.382 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0570807456970215
Epoch: 7, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.404 Vali Acc: 0.467 Test Loss: 1.404 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 8 cost time: 2.2032039165496826
Epoch: 8, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.702 Vali Acc: 0.467 Test Loss: 1.702 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8833417892456055
Epoch: 9, Steps: 1 | Train Loss: 0.072 Vali Loss: 2.428 Vali Acc: 0.400 Test Loss: 2.428 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8282930850982666
Epoch: 10, Steps: 1 | Train Loss: 0.049 Vali Loss: 2.304 Vali Acc: 0.467 Test Loss: 2.304 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8413515090942383
Epoch: 11, Steps: 1 | Train Loss: 0.010 Vali Loss: 3.153 Vali Acc: 0.400 Test Loss: 3.153 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.042457103729248
Epoch: 12, Steps: 1 | Train Loss: 0.009 Vali Loss: 3.218 Vali Acc: 0.400 Test Loss: 3.218 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2787609100341797
Epoch: 13, Steps: 1 | Train Loss: 0.002 Vali Loss: 3.120 Vali Acc: 0.467 Test Loss: 3.120 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9495086669921875
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.304 Vali Acc: 0.400 Test Loss: 3.304 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8837296962738037
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.770 Vali Acc: 0.400 Test Loss: 3.770 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6839652061462402
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.417 Vali Acc: 0.400 Test Loss: 4.417 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1627275943756104
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.122 Vali Acc: 0.400 Test Loss: 5.122 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 17502723
model size : 86.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 8.48965573310852
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.060 Vali Acc: 0.667 Test Loss: 1.060 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 6.913827180862427
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.614653587341309
Epoch: 3, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.311513900756836
Epoch: 4, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.305979490280151
Epoch: 5, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.207500457763672
Epoch: 6, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.199 Vali Acc: 0.533 Test Loss: 1.199 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.493267774581909
Epoch: 7, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.544 Vali Acc: 0.333 Test Loss: 1.544 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.134380340576172
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.683 Vali Acc: 0.533 Test Loss: 2.683 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.2475104331970215
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.044 Vali Acc: 0.533 Test Loss: 4.044 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.3844404220581055
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.469 Vali Acc: 0.467 Test Loss: 5.469 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.20015287399292
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.894 Vali Acc: 0.400 Test Loss: 6.894 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 7.461857080459595
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 5.635010004043579
Epoch: 2, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.397244215011597
Epoch: 3, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.9060773849487305
Epoch: 4, Steps: 1 | Train Loss: 0.560 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2009963989257812
Epoch: 5, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9995932579040527
Epoch: 6, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.512 Vali Acc: 0.333 Test Loss: 1.512 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.960497617721558
Epoch: 7, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.665 Vali Acc: 0.267 Test Loss: 1.665 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.710823059082031
Epoch: 8, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.822 Vali Acc: 0.267 Test Loss: 2.822 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.245788812637329
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.506 Vali Acc: 0.267 Test Loss: 4.506 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.127010822296143
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.326 Vali Acc: 0.267 Test Loss: 6.326 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.322462797164917
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.195 Vali Acc: 0.267 Test Loss: 8.195 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 6.604894399642944
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 4.9318695068359375
Epoch: 2, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 4.925304412841797
Epoch: 3, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.5332350730896
Epoch: 4, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.334547281265259
Epoch: 5, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.273640394210815
Epoch: 6, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.091365814208984
Epoch: 7, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.390 Vali Acc: 0.467 Test Loss: 1.390 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.93121862411499
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.618 Vali Acc: 0.467 Test Loss: 2.618 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.1540539264678955
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.024 Vali Acc: 0.400 Test Loss: 4.024 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.9034552574157715
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.477 Vali Acc: 0.333 Test Loss: 5.477 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.462187051773071
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.935 Vali Acc: 0.333 Test Loss: 6.935 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.035770654678345
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.369 Vali Acc: 0.333 Test Loss: 8.369 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.6914966106414795
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 0.978 Vali Acc: 0.600 Test Loss: 0.978 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 2.9824678897857666
Epoch: 2, Steps: 1 | Train Loss: 0.986 Vali Loss: 0.958 Vali Acc: 0.533 Test Loss: 0.958 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4812471866607666
Epoch: 3, Steps: 1 | Train Loss: 0.745 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5378401279449463
Epoch: 4, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.523237943649292
Epoch: 5, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.928375244140625
Epoch: 6, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.442 Vali Acc: 0.467 Test Loss: 1.442 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.273187875747681
Epoch: 7, Steps: 1 | Train Loss: 0.022 Vali Loss: 2.743 Vali Acc: 0.467 Test Loss: 2.743 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6340415477752686
Epoch: 8, Steps: 1 | Train Loss: 0.002 Vali Loss: 4.030 Vali Acc: 0.533 Test Loss: 4.030 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.120373010635376
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.380 Vali Acc: 0.533 Test Loss: 5.380 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.10503625869751
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.751 Vali Acc: 0.533 Test Loss: 6.751 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.7460439205169678
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.111 Vali Acc: 0.533 Test Loss: 8.111 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.532507419586182
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 2.570634126663208
Epoch: 2, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4952356815338135
Epoch: 3, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8082826137542725
Epoch: 4, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7964329719543457
Epoch: 5, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.237 Vali Acc: 0.467 Test Loss: 1.237 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.563790798187256
Epoch: 6, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.865 Vali Acc: 0.400 Test Loss: 1.865 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.516543388366699
Epoch: 7, Steps: 1 | Train Loss: 0.014 Vali Loss: 2.678 Vali Acc: 0.333 Test Loss: 2.678 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.1112194061279297
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.990 Vali Acc: 0.400 Test Loss: 3.990 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.768218755722046
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.454 Vali Acc: 0.400 Test Loss: 5.454 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.571626663208008
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.952 Vali Acc: 0.400 Test Loss: 6.952 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4894049167633057
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.433 Vali Acc: 0.400 Test Loss: 8.433 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.822659730911255
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.008253812789917
Epoch: 2, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.6196088790893555
Epoch: 3, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8355841636657715
Epoch: 4, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4998483657836914
Epoch: 5, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.154723644256592
Epoch: 6, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.703 Vali Acc: 0.267 Test Loss: 1.703 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7991774082183838
Epoch: 7, Steps: 1 | Train Loss: 0.009 Vali Loss: 2.838 Vali Acc: 0.333 Test Loss: 2.838 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1848607063293457
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.581 Vali Acc: 0.267 Test Loss: 4.581 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.894763469696045
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.519 Vali Acc: 0.267 Test Loss: 6.519 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2071352005004883
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.496 Vali Acc: 0.267 Test Loss: 8.496 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7623982429504395
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.449 Vali Acc: 0.267 Test Loss: 10.449 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5346746444702148
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.347 Vali Acc: 0.267 Test Loss: 12.347 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8909878730773926
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.074794292449951
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.7591001987457275
Epoch: 3, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 1.9868600368499756
Epoch: 4, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.8711771965026855
Epoch: 5, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.051 Vali Acc: 0.600 Test Loss: 1.051 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 2.139665126800537
Epoch: 6, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0721371173858643
Epoch: 7, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.524 Vali Acc: 0.400 Test Loss: 1.524 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9858839511871338
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.580 Vali Acc: 0.400 Test Loss: 2.580 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8078014850616455
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.792 Vali Acc: 0.400 Test Loss: 3.792 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0799672603607178
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.032 Vali Acc: 0.400 Test Loss: 5.032 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.264496326446533
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.258 Vali Acc: 0.400 Test Loss: 6.258 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.06767201423645
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.452 Vali Acc: 0.400 Test Loss: 7.452 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9870357513427734
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.605 Vali Acc: 0.400 Test Loss: 8.605 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1209635734558105
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.712 Vali Acc: 0.400 Test Loss: 9.712 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9458856582641602
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.768 Vali Acc: 0.400 Test Loss: 10.768 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6405210494995117
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.9884312152862549
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2547452449798584
Epoch: 3, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.013104200363159
Epoch: 4, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.7657220363616943
Epoch: 5, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.9998562335968018
Epoch: 6, Steps: 1 | Train Loss: 0.361 Vali Loss: 0.988 Vali Acc: 0.533 Test Loss: 0.988 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 2.188856840133667
Epoch: 7, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.341 Vali Acc: 0.400 Test Loss: 1.341 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9642281532287598
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.161 Vali Acc: 0.400 Test Loss: 2.161 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9869742393493652
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.065 Vali Acc: 0.400 Test Loss: 3.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8580467700958252
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.978 Vali Acc: 0.400 Test Loss: 3.978 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9343769550323486
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.876 Vali Acc: 0.400 Test Loss: 4.876 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.858830213546753
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.750 Vali Acc: 0.400 Test Loss: 5.750 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9450428485870361
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.593 Vali Acc: 0.400 Test Loss: 6.593 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.170933485031128
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.403 Vali Acc: 0.400 Test Loss: 7.403 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.049370527267456
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.177 Vali Acc: 0.400 Test Loss: 8.177 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9877281188964844
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.913 Vali Acc: 0.400 Test Loss: 8.913 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.6368210315704346
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.7341060638427734
Epoch: 2, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7916862964630127
Epoch: 3, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.008 Vali Acc: 0.533 Test Loss: 1.008 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 2.272313356399536
Epoch: 4, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.023 Vali Acc: 0.467 Test Loss: 1.023 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.922973394393921
Epoch: 5, Steps: 1 | Train Loss: 0.657 Vali Loss: 0.997 Vali Acc: 0.467 Test Loss: 0.997 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5914947986602783
Epoch: 6, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8309214115142822
Epoch: 7, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9853928089141846
Epoch: 8, Steps: 1 | Train Loss: 0.043 Vali Loss: 2.441 Vali Acc: 0.333 Test Loss: 2.441 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.081402063369751
Epoch: 9, Steps: 1 | Train Loss: 0.029 Vali Loss: 2.827 Vali Acc: 0.333 Test Loss: 2.827 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7342538833618164
Epoch: 10, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.494 Vali Acc: 0.467 Test Loss: 1.494 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5580379962921143
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.467 Test Loss: 1.444 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6983695030212402
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.400 Test Loss: 2.204 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8984687328338623
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.086 Vali Acc: 0.400 Test Loss: 3.086 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.355572462081909
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.7874248027801514
Epoch: 2, Steps: 1 | Train Loss: 1.246 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.6987693309783936
Epoch: 3, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.7812473773956299
Epoch: 4, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6634795665740967
Epoch: 5, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8692007064819336
Epoch: 6, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.76786208152771
Epoch: 7, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.522 Vali Acc: 0.400 Test Loss: 1.522 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7946288585662842
Epoch: 8, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.589 Vali Acc: 0.400 Test Loss: 1.589 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9417102336883545
Epoch: 9, Steps: 1 | Train Loss: 0.115 Vali Loss: 2.020 Vali Acc: 0.467 Test Loss: 2.020 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9308295249938965
Epoch: 10, Steps: 1 | Train Loss: 0.024 Vali Loss: 2.826 Vali Acc: 0.400 Test Loss: 2.826 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9072520732879639
Epoch: 11, Steps: 1 | Train Loss: 0.018 Vali Loss: 2.739 Vali Acc: 0.467 Test Loss: 2.739 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7923710346221924
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.758 Vali Acc: 0.467 Test Loss: 2.758 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4664959907531738
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.029 Vali Acc: 0.467 Test Loss: 3.029 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15929859
model size : 80.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.999974727630615
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 6.975606441497803
Epoch: 2, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.6864330768585205
Epoch: 3, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.199988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 6.911585807800293
Epoch: 4, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.705164194107056
Epoch: 5, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.052064418792725
Epoch: 6, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.497 Vali Acc: 0.133 Test Loss: 1.497 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.564830541610718
Epoch: 7, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.951 Vali Acc: 0.333 Test Loss: 1.951 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.328095436096191
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.086 Vali Acc: 0.333 Test Loss: 3.086 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.040931463241577
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.305 Vali Acc: 0.333 Test Loss: 4.305 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.928470849990845
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.333 Test Loss: 5.546 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.394471645355225
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.784 Vali Acc: 0.333 Test Loss: 6.784 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.25331711769104
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.996 Vali Acc: 0.333 Test Loss: 7.996 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.066854476928711
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.171 Vali Acc: 0.333 Test Loss: 9.171 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 7.839328765869141
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 5.998793363571167
Epoch: 2, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 5.674925088882446
Epoch: 3, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 5.8485376834869385
Epoch: 4, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 4.16789174079895
Epoch: 5, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.368890762329102
Epoch: 6, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.764 Vali Acc: 0.267 Test Loss: 1.764 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.320165634155273
Epoch: 7, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.852 Vali Acc: 0.200 Test Loss: 1.852 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.555370092391968
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.468 Vali Acc: 0.267 Test Loss: 2.468 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.52752423286438
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.371 Vali Acc: 0.333 Test Loss: 3.371 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.030686616897583
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.373 Vali Acc: 0.333 Test Loss: 4.373 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.8499531745910645
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.397 Vali Acc: 0.333 Test Loss: 5.397 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.06207537651062
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.411 Vali Acc: 0.400 Test Loss: 6.411 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.007582426071167
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.401 Vali Acc: 0.400 Test Loss: 7.401 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.095062494277954
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.358 Vali Acc: 0.400 Test Loss: 8.358 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.42896294593811
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 4.8836352825164795
Epoch: 2, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.199989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 4.8597118854522705
Epoch: 3, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 4.6007726192474365
Epoch: 4, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4654617309570312
Epoch: 5, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9885141849517822
Epoch: 6, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.609924554824829
Epoch: 7, Steps: 1 | Train Loss: 0.020 Vali Loss: 2.402 Vali Acc: 0.467 Test Loss: 2.402 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.4767186641693115
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.862 Vali Acc: 0.400 Test Loss: 3.862 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.577209234237671
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.250 Vali Acc: 0.400 Test Loss: 5.250 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.410032510757446
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.585 Vali Acc: 0.400 Test Loss: 6.585 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.832115888595581
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.888 Vali Acc: 0.400 Test Loss: 7.888 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.961493253707886
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.152 Vali Acc: 0.400 Test Loss: 9.152 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.1488780975341797
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.370 Vali Acc: 0.400 Test Loss: 10.370 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.016139030456543
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 3.6807186603546143
Epoch: 2, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 3.8898751735687256
Epoch: 3, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6521377563476562
Epoch: 4, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 3.505754232406616
Epoch: 5, Steps: 1 | Train Loss: 0.368 Vali Loss: 1.145 Vali Acc: 0.533 Test Loss: 1.145 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4145236015319824
Epoch: 6, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.534 Vali Acc: 0.400 Test Loss: 1.534 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.63100004196167
Epoch: 7, Steps: 1 | Train Loss: 0.019 Vali Loss: 3.062 Vali Acc: 0.467 Test Loss: 3.062 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.511435031890869
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.842 Vali Acc: 0.467 Test Loss: 4.842 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.953421115875244
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.659 Vali Acc: 0.467 Test Loss: 6.659 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.019850730895996
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.464 Vali Acc: 0.467 Test Loss: 8.464 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2700111865997314
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.235 Vali Acc: 0.467 Test Loss: 10.235 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.419062376022339
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.954 Vali Acc: 0.467 Test Loss: 11.954 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.8646979331970215
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 13.611 Vali Acc: 0.467 Test Loss: 13.611 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8754007816314697
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 15.200 Vali Acc: 0.467 Test Loss: 15.200 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.190613031387329
Epoch: 1, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 2.4991424083709717
Epoch: 2, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 2.3538644313812256
Epoch: 3, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8020362854003906
Epoch: 4, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6661267280578613
Epoch: 5, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7224197387695312
Epoch: 6, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.778 Vali Acc: 0.333 Test Loss: 1.778 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6481518745422363
Epoch: 7, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.577 Vali Acc: 0.333 Test Loss: 2.577 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0685272216796875
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.515 Vali Acc: 0.333 Test Loss: 3.515 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.8230762481689453
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.504 Vali Acc: 0.400 Test Loss: 4.504 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399955).  Saving model ...
Epoch: 10 cost time: 2.612359046936035
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.506 Vali Acc: 0.333 Test Loss: 5.506 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.860199451446533
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.503 Vali Acc: 0.333 Test Loss: 6.503 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5563876628875732
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.481 Vali Acc: 0.333 Test Loss: 7.481 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.125025987625122
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.431 Vali Acc: 0.333 Test Loss: 8.431 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.632168769836426
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.347 Vali Acc: 0.333 Test Loss: 9.347 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6714770793914795
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.225 Vali Acc: 0.333 Test Loss: 10.225 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.864629030227661
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.062 Vali Acc: 0.333 Test Loss: 11.062 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.9452004432678223
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.859 Vali Acc: 0.333 Test Loss: 11.859 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7619616985321045
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.613 Vali Acc: 0.333 Test Loss: 12.613 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.4818115234375
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 13.326 Vali Acc: 0.333 Test Loss: 13.326 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.036792516708374
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.849151372909546
Epoch: 2, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8991162776947021
Epoch: 3, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1971936225891113
Epoch: 4, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.038639783859253
Epoch: 5, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4430999755859375
Epoch: 6, Steps: 1 | Train Loss: 0.186 Vali Loss: 2.065 Vali Acc: 0.467 Test Loss: 2.065 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466646).  Saving model ...
Epoch: 7 cost time: 2.0299313068389893
Epoch: 7, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.760 Vali Acc: 0.267 Test Loss: 2.760 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.960852861404419
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.741 Vali Acc: 0.200 Test Loss: 3.741 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1047353744506836
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.861 Vali Acc: 0.200 Test Loss: 4.861 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2257232666015625
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.032 Vali Acc: 0.200 Test Loss: 6.032 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3176395893096924
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.211 Vali Acc: 0.200 Test Loss: 7.211 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0905697345733643
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.377 Vali Acc: 0.133 Test Loss: 8.377 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1389801502227783
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.516 Vali Acc: 0.133 Test Loss: 9.516 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8515961170196533
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.617 Vali Acc: 0.133 Test Loss: 10.617 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3920135498046875
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.675 Vali Acc: 0.133 Test Loss: 11.675 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.517735481262207
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.684 Vali Acc: 0.133 Test Loss: 12.684 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.910754680633545
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.7805805206298828
Epoch: 2, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 1.955249547958374
Epoch: 3, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1688573360443115
Epoch: 4, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8501038551330566
Epoch: 5, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0890653133392334
Epoch: 6, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.440 Vali Acc: 0.400 Test Loss: 1.440 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1141366958618164
Epoch: 7, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0707201957702637
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.267 Test Loss: 1.687 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7362093925476074
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.162 Vali Acc: 0.267 Test Loss: 2.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9249074459075928
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.717 Vali Acc: 0.267 Test Loss: 2.717 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5984303951263428
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.293 Vali Acc: 0.267 Test Loss: 3.293 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.660771369934082
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.867 Vali Acc: 0.267 Test Loss: 3.867 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.022030591964722
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 2.0011115074157715
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.9704110622406006
Epoch: 3, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 2.0535836219787598
Epoch: 4, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.286475896835327
Epoch: 5, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0661604404449463
Epoch: 6, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.588 Vali Acc: 0.467 Test Loss: 1.588 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466651).  Saving model ...
Epoch: 7 cost time: 2.145460844039917
Epoch: 7, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.463 Vali Acc: 0.400 Test Loss: 1.463 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8913896083831787
Epoch: 8, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.467 Test Loss: 1.850 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8964192867279053
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.486 Vali Acc: 0.467 Test Loss: 2.486 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.168091058731079
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.210 Vali Acc: 0.467 Test Loss: 3.210 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1107406616210938
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.959 Vali Acc: 0.467 Test Loss: 3.959 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9280264377593994
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.699 Vali Acc: 0.467 Test Loss: 4.699 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0349931716918945
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.418 Vali Acc: 0.467 Test Loss: 5.418 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.192718505859375
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.108 Vali Acc: 0.467 Test Loss: 6.108 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8958923816680908
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.767 Vali Acc: 0.467 Test Loss: 6.767 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7567059993743896
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.394 Vali Acc: 0.467 Test Loss: 7.394 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7606542110443115
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.86798095703125
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.8232438564300537
Epoch: 3, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 2.0010640621185303
Epoch: 4, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8868017196655273
Epoch: 5, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9520292282104492
Epoch: 6, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7296903133392334
Epoch: 7, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6160619258880615
Epoch: 8, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.230 Vali Acc: 0.467 Test Loss: 1.230 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 1.7660534381866455
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.286 Vali Acc: 0.467 Test Loss: 1.286 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7403531074523926
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.376 Vali Acc: 0.400 Test Loss: 1.376 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1391735076904297
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.400 Test Loss: 1.482 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.929964303970337
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.400 Test Loss: 1.596 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9522497653961182
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.467 Test Loss: 1.715 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9712409973144531
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.467 Test Loss: 1.834 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9145984649658203
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.467 Test Loss: 1.953 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0220746994018555
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.467 Test Loss: 2.069 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.095028877258301
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.181 Vali Acc: 0.467 Test Loss: 2.181 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.943047285079956
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.289 Vali Acc: 0.467 Test Loss: 2.289 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.558166742324829
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.8831346035003662
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.8924999237060547
Epoch: 3, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.9722392559051514
Epoch: 4, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6946074962615967
Epoch: 5, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6168675422668457
Epoch: 6, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8088502883911133
Epoch: 7, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.437 Vali Acc: 0.400 Test Loss: 1.437 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9328782558441162
Epoch: 8, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.564 Vali Acc: 0.467 Test Loss: 1.564 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9234237670898438
Epoch: 9, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.949 Vali Acc: 0.467 Test Loss: 1.949 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.055152177810669
Epoch: 10, Steps: 1 | Train Loss: 0.020 Vali Loss: 3.224 Vali Acc: 0.333 Test Loss: 3.224 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9384136199951172
Epoch: 11, Steps: 1 | Train Loss: 0.028 Vali Loss: 3.176 Vali Acc: 0.333 Test Loss: 3.176 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.634049654006958
Epoch: 12, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.755 Vali Acc: 0.467 Test Loss: 2.755 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6739914417266846
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.733 Vali Acc: 0.467 Test Loss: 3.733 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 15143427
model size : 77.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 7.76962423324585
Epoch: 1, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 6.93001914024353
Epoch: 2, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 7.2488250732421875
Epoch: 3, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.025 Vali Acc: 0.400 Test Loss: 1.025 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 4.703786134719849
Epoch: 4, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.278611898422241
Epoch: 5, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.482507705688477
Epoch: 6, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.505 Vali Acc: 0.467 Test Loss: 1.505 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466652).  Saving model ...
Epoch: 7 cost time: 7.675406455993652
Epoch: 7, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.518 Vali Acc: 0.400 Test Loss: 1.518 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.254452466964722
Epoch: 8, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.292 Vali Acc: 0.400 Test Loss: 2.292 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.452708005905151
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.269 Vali Acc: 0.400 Test Loss: 3.269 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.153393030166626
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.304 Vali Acc: 0.467 Test Loss: 4.304 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.499607086181641
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.358 Vali Acc: 0.400 Test Loss: 5.358 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.67120623588562
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.410 Vali Acc: 0.333 Test Loss: 6.410 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.097928285598755
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.444 Vali Acc: 0.333 Test Loss: 7.444 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.965026140213013
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.449 Vali Acc: 0.333 Test Loss: 8.449 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.6452484130859375
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.417 Vali Acc: 0.333 Test Loss: 9.417 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.451468229293823
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.342 Vali Acc: 0.333 Test Loss: 10.342 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 6.621821880340576
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 6.2441935539245605
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 5.60499382019043
Epoch: 3, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 6.407240629196167
Epoch: 4, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 5.362887620925903
Epoch: 5, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 6.122583866119385
Epoch: 6, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.563 Vali Acc: 0.467 Test Loss: 1.563 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.613210916519165
Epoch: 7, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.635 Vali Acc: 0.267 Test Loss: 1.635 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.504761695861816
Epoch: 8, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.322 Vali Acc: 0.267 Test Loss: 2.322 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.054137468338013
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.115 Vali Acc: 0.267 Test Loss: 3.115 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.373296737670898
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.932 Vali Acc: 0.267 Test Loss: 3.932 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.591220378875732
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.743 Vali Acc: 0.267 Test Loss: 4.743 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.0080742835998535
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.536 Vali Acc: 0.267 Test Loss: 5.536 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.856125831604004
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.304 Vali Acc: 0.333 Test Loss: 6.304 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.200653791427612
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.041 Vali Acc: 0.333 Test Loss: 7.041 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.329108953475952
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.746 Vali Acc: 0.333 Test Loss: 7.746 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 6.35599684715271
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 4.499875783920288
Epoch: 2, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 4.268991947174072
Epoch: 3, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 4.0801355838775635
Epoch: 4, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.883623123168945
Epoch: 5, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.945621728897095
Epoch: 6, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.529 Vali Acc: 0.333 Test Loss: 1.529 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.257616281509399
Epoch: 7, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.405 Vali Acc: 0.467 Test Loss: 1.405 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.559731960296631
Epoch: 8, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.891 Vali Acc: 0.467 Test Loss: 1.891 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.824308633804321
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.550 Vali Acc: 0.400 Test Loss: 2.550 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.7273008823394775
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.257 Vali Acc: 0.400 Test Loss: 3.257 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.9180476665496826
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.976 Vali Acc: 0.400 Test Loss: 3.976 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.287032604217529
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.689 Vali Acc: 0.333 Test Loss: 4.689 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9118661880493164
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.388 Vali Acc: 0.400 Test Loss: 5.388 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.920012712478638
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 3.77522611618042
Epoch: 2, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
Validation loss decreased (-0.266655 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 3.049118995666504
Epoch: 3, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.027 Vali Acc: 0.600 Test Loss: 1.027 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 3.416555643081665
Epoch: 4, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6244444847106934
Epoch: 5, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3521416187286377
Epoch: 6, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.546 Vali Acc: 0.400 Test Loss: 1.546 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.668454647064209
Epoch: 7, Steps: 1 | Train Loss: 0.026 Vali Loss: 2.552 Vali Acc: 0.467 Test Loss: 2.552 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5632519721984863
Epoch: 8, Steps: 1 | Train Loss: 0.002 Vali Loss: 3.773 Vali Acc: 0.467 Test Loss: 3.773 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.835205078125
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.068 Vali Acc: 0.467 Test Loss: 5.068 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.566650867462158
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.375 Vali Acc: 0.467 Test Loss: 6.375 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6093597412109375
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.663 Vali Acc: 0.467 Test Loss: 7.663 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.47845196723938
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.917 Vali Acc: 0.467 Test Loss: 8.917 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8947534561157227
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.127 Vali Acc: 0.467 Test Loss: 10.127 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.842638731002808
Epoch: 1, Steps: 1 | Train Loss: 1.245 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 2.754798412322998
Epoch: 2, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 2.747065544128418
Epoch: 3, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 2.7038397789001465
Epoch: 4, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.660921812057495
Epoch: 5, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.174 Vali Acc: 0.533 Test Loss: 1.174 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 2.6796085834503174
Epoch: 6, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.857 Vali Acc: 0.400 Test Loss: 1.857 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0437324047088623
Epoch: 7, Steps: 1 | Train Loss: 0.015 Vali Loss: 2.528 Vali Acc: 0.400 Test Loss: 2.528 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1632397174835205
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.422 Vali Acc: 0.400 Test Loss: 3.422 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.38885760307312
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.426 Vali Acc: 0.400 Test Loss: 4.426 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9614179134368896
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.479 Vali Acc: 0.333 Test Loss: 5.479 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6992063522338867
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.542 Vali Acc: 0.333 Test Loss: 6.542 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.678551435470581
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.594 Vali Acc: 0.333 Test Loss: 7.594 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9452998638153076
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.625 Vali Acc: 0.267 Test Loss: 8.625 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2169907093048096
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.624 Vali Acc: 0.267 Test Loss: 9.624 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9703471660614014
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 10.587 Vali Acc: 0.267 Test Loss: 10.587 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.161879062652588
Epoch: 1, Steps: 1 | Train Loss: 1.270 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 2.003793478012085
Epoch: 2, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 1.9746248722076416
Epoch: 3, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 2.2591371536254883
Epoch: 4, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2431981563568115
Epoch: 5, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7361805438995361
Epoch: 6, Steps: 1 | Train Loss: 0.228 Vali Loss: 2.007 Vali Acc: 0.267 Test Loss: 2.007 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.654886245727539
Epoch: 7, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.799 Vali Acc: 0.467 Test Loss: 2.799 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466639).  Saving model ...
Epoch: 8 cost time: 2.095630645751953
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.026 Vali Acc: 0.467 Test Loss: 4.026 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0663340091705322
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.449 Vali Acc: 0.467 Test Loss: 5.449 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.578275203704834
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.932 Vali Acc: 0.400 Test Loss: 6.932 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9170172214508057
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.415 Vali Acc: 0.400 Test Loss: 8.415 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1085546016693115
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.871 Vali Acc: 0.400 Test Loss: 9.871 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9709601402282715
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 11.284 Vali Acc: 0.400 Test Loss: 11.284 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2253997325897217
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 12.645 Vali Acc: 0.400 Test Loss: 12.645 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.005859851837158
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 13.948 Vali Acc: 0.400 Test Loss: 13.948 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3613386154174805
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 15.190 Vali Acc: 0.400 Test Loss: 15.190 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5335888862609863
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 16.369 Vali Acc: 0.333 Test Loss: 16.369 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7779793739318848
Epoch: 1, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.930934190750122
Epoch: 2, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 2.2126338481903076
Epoch: 3, Steps: 1 | Train Loss: 0.627 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 1.8977701663970947
Epoch: 4, Steps: 1 | Train Loss: 0.488 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 5 cost time: 1.769303560256958
Epoch: 5, Steps: 1 | Train Loss: 0.343 Vali Loss: 0.965 Vali Acc: 0.533 Test Loss: 0.965 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533324).  Saving model ...
Epoch: 6 cost time: 1.9064526557922363
Epoch: 6, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2202579975128174
Epoch: 7, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.365 Vali Acc: 0.467 Test Loss: 1.365 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9820563793182373
Epoch: 8, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.400 Test Loss: 2.206 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7779953479766846
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.259 Vali Acc: 0.400 Test Loss: 3.259 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8447542190551758
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.386 Vali Acc: 0.400 Test Loss: 4.386 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9527509212493896
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.522 Vali Acc: 0.400 Test Loss: 5.522 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.475172758102417
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.637 Vali Acc: 0.400 Test Loss: 6.637 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.506655216217041
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.716 Vali Acc: 0.400 Test Loss: 7.716 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5505554676055908
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.753 Vali Acc: 0.400 Test Loss: 8.753 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7659931182861328
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 9.743 Vali Acc: 0.400 Test Loss: 9.743 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.651829242706299
Epoch: 1, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.970977544784546
Epoch: 2, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 2.0641281604766846
Epoch: 3, Steps: 1 | Train Loss: 0.654 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8471980094909668
Epoch: 4, Steps: 1 | Train Loss: 0.511 Vali Loss: 0.969 Vali Acc: 0.400 Test Loss: 0.969 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7324554920196533
Epoch: 5, Steps: 1 | Train Loss: 0.412 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 1.6048154830932617
Epoch: 6, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8195881843566895
Epoch: 7, Steps: 1 | Train Loss: 0.026 Vali Loss: 0.942 Vali Acc: 0.400 Test Loss: 0.942 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2379379272460938
Epoch: 8, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8174309730529785
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.533 Test Loss: 1.197 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5760138034820557
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.533 Test Loss: 1.402 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.166771411895752
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.533 Test Loss: 1.626 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9051129817962646
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.533 Test Loss: 1.856 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0105388164520264
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.533 Test Loss: 2.086 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7156834602355957
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.311 Vali Acc: 0.533 Test Loss: 2.311 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3036742210388184
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.529 Vali Acc: 0.467 Test Loss: 2.529 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5523629188537598
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.7651920318603516
Epoch: 2, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.820371389389038
Epoch: 3, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.715038776397705
Epoch: 4, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.8483421802520752
Epoch: 5, Steps: 1 | Train Loss: 0.678 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0503504276275635
Epoch: 6, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6870453357696533
Epoch: 7, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.276 Vali Acc: 0.467 Test Loss: 1.276 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5990779399871826
Epoch: 8, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.249 Vali Acc: 0.467 Test Loss: 1.249 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6976368427276611
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.612 Vali Acc: 0.533 Test Loss: 1.612 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8180029392242432
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.067 Vali Acc: 0.467 Test Loss: 2.067 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.660106897354126
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.527 Vali Acc: 0.467 Test Loss: 2.527 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3602094650268555
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.985 Vali Acc: 0.467 Test Loss: 2.985 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3636560440063477
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.435 Vali Acc: 0.467 Test Loss: 3.435 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8553171157836914
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.871 Vali Acc: 0.533 Test Loss: 3.871 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.8253495693206787
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.6540443897247314
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6393609046936035
Epoch: 3, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.8191702365875244
Epoch: 4, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 1.7806057929992676
Epoch: 5, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5749189853668213
Epoch: 6, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2471582889556885
Epoch: 7, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.333 Vali Acc: 0.600 Test Loss: 1.333 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3928418159484863
Epoch: 8, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.913 Vali Acc: 0.400 Test Loss: 1.913 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6837308406829834
Epoch: 9, Steps: 1 | Train Loss: 0.074 Vali Loss: 2.165 Vali Acc: 0.400 Test Loss: 2.165 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.61332106590271
Epoch: 10, Steps: 1 | Train Loss: 0.028 Vali Loss: 2.596 Vali Acc: 0.400 Test Loss: 2.596 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6514711380004883
Epoch: 11, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.741 Vali Acc: 0.467 Test Loss: 2.741 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6315393447875977
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 3.146 Vali Acc: 0.467 Test Loss: 3.146 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.720719575881958
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.567 Vali Acc: 0.467 Test Loss: 3.567 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.84140944480896
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.970 Vali Acc: 0.467 Test Loss: 3.970 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 14750211
model size : 75.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.666964292526245
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 4.035511016845703
Epoch: 2, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 3.5620195865631104
Epoch: 3, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7453274726867676
Epoch: 4, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3556435108184814
Epoch: 5, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.720602512359619
Epoch: 6, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.295 Vali Acc: 0.467 Test Loss: 1.295 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.965120792388916
Epoch: 7, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8500959873199463
Epoch: 8, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.606 Vali Acc: 0.467 Test Loss: 1.606 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.654956817626953
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.048 Vali Acc: 0.400 Test Loss: 2.048 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.4370718002319336
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.527 Vali Acc: 0.400 Test Loss: 2.527 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.0785698890686035
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.021 Vali Acc: 0.400 Test Loss: 3.021 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.6987528800964355
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.514 Vali Acc: 0.400 Test Loss: 3.514 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.65003514289856
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.7446513175964355
Epoch: 2, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 3.1484711170196533
Epoch: 3, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 3.388667345046997
Epoch: 4, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 2.795313596725464
Epoch: 5, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2683401107788086
Epoch: 6, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.013373613357544
Epoch: 7, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2901670932769775
Epoch: 8, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.548 Vali Acc: 0.267 Test Loss: 1.548 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8681447505950928
Epoch: 9, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.007 Vali Acc: 0.267 Test Loss: 2.007 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4406051635742188
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.267 Test Loss: 2.528 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2675557136535645
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.070 Vali Acc: 0.267 Test Loss: 3.070 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6748721599578857
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.610 Vali Acc: 0.267 Test Loss: 3.610 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.612236261367798
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.138 Vali Acc: 0.267 Test Loss: 4.138 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.879462718963623
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.649 Vali Acc: 0.267 Test Loss: 4.649 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.365926504135132
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 2.4900968074798584
Epoch: 2, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 3.003340721130371
Epoch: 3, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 2.735468626022339
Epoch: 4, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1962385177612305
Epoch: 5, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0581603050231934
Epoch: 6, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.689452648162842
Epoch: 7, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.597259044647217
Epoch: 8, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.485 Vali Acc: 0.400 Test Loss: 1.485 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.071951150894165
Epoch: 9, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.048 Vali Acc: 0.400 Test Loss: 2.048 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.539217233657837
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.657 Vali Acc: 0.400 Test Loss: 2.657 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5533454418182373
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.274 Vali Acc: 0.400 Test Loss: 3.274 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.810182571411133
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.883 Vali Acc: 0.400 Test Loss: 3.883 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.853635311126709
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.476 Vali Acc: 0.400 Test Loss: 4.476 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.399846076965332
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.7108964920043945
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.6464805603027344
Epoch: 3, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.207747459411621
Epoch: 4, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.3308327198028564
Epoch: 5, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 1.6868560314178467
Epoch: 6, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.320 Vali Acc: 0.533 Test Loss: 1.320 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9911763668060303
Epoch: 7, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.726 Vali Acc: 0.400 Test Loss: 1.726 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7899084091186523
Epoch: 8, Steps: 1 | Train Loss: 0.028 Vali Loss: 2.022 Vali Acc: 0.400 Test Loss: 2.022 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0935442447662354
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.566 Vali Acc: 0.400 Test Loss: 2.566 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4873056411743164
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.179 Vali Acc: 0.400 Test Loss: 3.179 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0407140254974365
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.801 Vali Acc: 0.400 Test Loss: 3.801 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.719639778137207
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.410 Vali Acc: 0.467 Test Loss: 4.410 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3532402515411377
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.002 Vali Acc: 0.467 Test Loss: 5.002 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8378159999847412
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.573 Vali Acc: 0.467 Test Loss: 5.573 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7774829864501953
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.121 Vali Acc: 0.467 Test Loss: 6.121 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4391539096832275
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.67533278465271
Epoch: 2, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.6102864742279053
Epoch: 3, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 1.8634576797485352
Epoch: 4, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8907585144042969
Epoch: 5, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6690094470977783
Epoch: 6, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.360 Vali Acc: 0.267 Test Loss: 1.360 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6622226238250732
Epoch: 7, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.674 Vali Acc: 0.333 Test Loss: 1.674 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0331270694732666
Epoch: 8, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.066 Vali Acc: 0.333 Test Loss: 2.066 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.926980972290039
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.519 Vali Acc: 0.400 Test Loss: 2.519 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6134238243103027
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.994 Vali Acc: 0.400 Test Loss: 2.994 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.542266607284546
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.472 Vali Acc: 0.400 Test Loss: 3.472 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.803467035293579
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.944 Vali Acc: 0.400 Test Loss: 3.944 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8895514011383057
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.404 Vali Acc: 0.400 Test Loss: 4.404 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.151073932647705
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.517953634262085
Epoch: 2, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.743882656097412
Epoch: 3, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4861743450164795
Epoch: 4, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3341643810272217
Epoch: 5, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8829309940338135
Epoch: 6, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 1.387608289718628
Epoch: 7, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.784 Vali Acc: 0.333 Test Loss: 1.784 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.24428129196167
Epoch: 8, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.309 Vali Acc: 0.333 Test Loss: 2.309 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5661916732788086
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.897 Vali Acc: 0.333 Test Loss: 2.897 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4649386405944824
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.507 Vali Acc: 0.333 Test Loss: 3.507 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5276179313659668
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.118 Vali Acc: 0.333 Test Loss: 4.118 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.249553918838501
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.717 Vali Acc: 0.333 Test Loss: 4.717 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1871247291564941
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.297 Vali Acc: 0.333 Test Loss: 5.297 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.706733226776123
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.856 Vali Acc: 0.333 Test Loss: 5.856 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5621328353881836
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.390 Vali Acc: 0.400 Test Loss: 6.390 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2821457386016846
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.899 Vali Acc: 0.400 Test Loss: 6.899 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1465647220611572
Epoch: 1, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.3098881244659424
Epoch: 2, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.2855546474456787
Epoch: 3, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.209568977355957
Epoch: 4, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2371199131011963
Epoch: 5, Steps: 1 | Train Loss: 0.460 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.164271593093872
Epoch: 6, Steps: 1 | Train Loss: 0.344 Vali Loss: 0.981 Vali Acc: 0.400 Test Loss: 0.981 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2447798252105713
Epoch: 7, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.009 Vali Acc: 0.533 Test Loss: 1.009 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0330872535705566
Epoch: 8, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9508085250854492
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.333 Test Loss: 1.617 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3288874626159668
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.959 Vali Acc: 0.333 Test Loss: 1.959 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3296504020690918
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.309 Vali Acc: 0.333 Test Loss: 2.309 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0284664630889893
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.333 Test Loss: 2.658 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8643319606781006
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.452862024307251
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.409614086151123
Epoch: 3, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 1.407226800918579
Epoch: 4, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3793408870697021
Epoch: 5, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3646090030670166
Epoch: 6, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3445429801940918
Epoch: 7, Steps: 1 | Train Loss: 0.160 Vali Loss: 0.918 Vali Acc: 0.400 Test Loss: 0.918 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2981336116790771
Epoch: 8, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4339280128479004
Epoch: 9, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.603 Vali Acc: 0.333 Test Loss: 1.603 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3791379928588867
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.333 Test Loss: 1.860 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5346877574920654
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.103 Vali Acc: 0.333 Test Loss: 2.103 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.292069673538208
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.345 Vali Acc: 0.333 Test Loss: 2.345 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3581154346466064
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.583 Vali Acc: 0.400 Test Loss: 2.583 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.012399435043335
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.4847638607025146
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.400428056716919
Epoch: 3, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.042 Vali Acc: 0.267 Test Loss: 1.042 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1692461967468262
Epoch: 4, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.050994873046875
Epoch: 5, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.1869945526123047
Epoch: 6, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1582973003387451
Epoch: 7, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0984647274017334
Epoch: 8, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1156280040740967
Epoch: 9, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0758652687072754
Epoch: 10, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5050926208496094
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.423 Vali Acc: 0.467 Test Loss: 1.423 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4613823890686035
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.400 Test Loss: 1.623 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1000316143035889
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.400 Test Loss: 1.823 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1635301113128662
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.400 Test Loss: 2.020 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2859456539154053
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.216 Vali Acc: 0.400 Test Loss: 2.216 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9938135147094727
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.167680263519287
Epoch: 2, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.190368413925171
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 1.241164207458496
Epoch: 4, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.2529282569885254
Epoch: 5, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 1.1705694198608398
Epoch: 6, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.1273748874664307
Epoch: 7, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3846774101257324
Epoch: 8, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.478 Vali Acc: 0.333 Test Loss: 1.478 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2275817394256592
Epoch: 9, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.428 Vali Acc: 0.400 Test Loss: 1.428 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2454609870910645
Epoch: 10, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.605 Vali Acc: 0.400 Test Loss: 1.605 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2514407634735107
Epoch: 11, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.797 Vali Acc: 0.467 Test Loss: 1.797 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3431947231292725
Epoch: 12, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.964 Vali Acc: 0.467 Test Loss: 1.964 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3672616481781006
Epoch: 13, Steps: 1 | Train Loss: 0.023 Vali Loss: 2.069 Vali Acc: 0.467 Test Loss: 2.069 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2360522747039795
Epoch: 14, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.399 Vali Acc: 0.400 Test Loss: 2.399 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3467655181884766
Epoch: 15, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.579 Vali Acc: 0.400 Test Loss: 2.579 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2731447219848633
Epoch: 16, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.671 Vali Acc: 0.400 Test Loss: 2.671 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 7702787
model size : 39.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.069720268249512
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 3.3756914138793945
Epoch: 2, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 3.4869537353515625
Epoch: 3, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 3.1999082565307617
Epoch: 4, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 3.678264856338501
Epoch: 5, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 3.7275290489196777
Epoch: 6, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.387155771255493
Epoch: 7, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.651 Vali Acc: 0.333 Test Loss: 1.651 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7765214443206787
Epoch: 8, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.711 Vali Acc: 0.400 Test Loss: 1.711 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7168850898742676
Epoch: 9, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.940 Vali Acc: 0.333 Test Loss: 1.940 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.406348466873169
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.217 Vali Acc: 0.333 Test Loss: 2.217 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7115302085876465
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.333 Test Loss: 2.509 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.020329713821411
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.267 Test Loss: 2.802 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.932692766189575
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.090 Vali Acc: 0.267 Test Loss: 3.090 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.455801010131836
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.371 Vali Acc: 0.267 Test Loss: 3.371 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0889694690704346
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.642 Vali Acc: 0.267 Test Loss: 3.642 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.14355993270874
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.6709823608398438
Epoch: 2, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.849083423614502
Epoch: 3, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 2.48842716217041
Epoch: 4, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.032839775085449
Epoch: 5, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.844264268875122
Epoch: 6, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0580577850341797
Epoch: 7, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.674 Vali Acc: 0.333 Test Loss: 1.674 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.916736364364624
Epoch: 8, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.761 Vali Acc: 0.267 Test Loss: 1.761 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.963894844055176
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.007 Vali Acc: 0.200 Test Loss: 2.007 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4147183895111084
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.304 Vali Acc: 0.200 Test Loss: 2.304 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.614793300628662
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.617 Vali Acc: 0.200 Test Loss: 2.617 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4723756313323975
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.932 Vali Acc: 0.200 Test Loss: 2.932 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8485219478607178
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.243 Vali Acc: 0.200 Test Loss: 3.243 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.9076173305511475
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 2.611290216445923
Epoch: 2, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.225 Vali Acc: 0.133 Test Loss: 1.225 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2158865928649902
Epoch: 3, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 2.626943349838257
Epoch: 4, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 2.534215211868286
Epoch: 5, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 2.5132572650909424
Epoch: 6, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 2.013204336166382
Epoch: 7, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.583 Vali Acc: 0.333 Test Loss: 1.583 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4677209854125977
Epoch: 8, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.588 Vali Acc: 0.467 Test Loss: 1.588 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466651).  Saving model ...
Epoch: 9 cost time: 2.359524965286255
Epoch: 9, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.748 Vali Acc: 0.467 Test Loss: 1.748 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1825475692749023
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.467 Test Loss: 1.953 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5871083736419678
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.467 Test Loss: 2.174 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8468263149261475
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.400 Vali Acc: 0.467 Test Loss: 2.400 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5457522869110107
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.624 Vali Acc: 0.467 Test Loss: 2.624 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7389442920684814
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.844 Vali Acc: 0.467 Test Loss: 2.844 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.396071195602417
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.057 Vali Acc: 0.467 Test Loss: 3.057 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.605860710144043
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.262 Vali Acc: 0.467 Test Loss: 3.262 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.39644455909729
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.457 Vali Acc: 0.467 Test Loss: 3.457 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.249216318130493
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.644 Vali Acc: 0.467 Test Loss: 3.644 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1587812900543213
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.6332876682281494
Epoch: 2, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.5946598052978516
Epoch: 3, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 2.0569045543670654
Epoch: 4, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 2.1441032886505127
Epoch: 5, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 2.1493096351623535
Epoch: 6, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.271 Vali Acc: 0.533 Test Loss: 1.271 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 7 cost time: 2.1176750659942627
Epoch: 7, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.849 Vali Acc: 0.400 Test Loss: 1.849 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.286011219024658
Epoch: 8, Steps: 1 | Train Loss: 0.027 Vali Loss: 2.331 Vali Acc: 0.467 Test Loss: 2.331 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9816551208496094
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.913 Vali Acc: 0.467 Test Loss: 2.913 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.265961170196533
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.526 Vali Acc: 0.467 Test Loss: 3.526 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.152534246444702
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.141 Vali Acc: 0.467 Test Loss: 4.141 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9805147647857666
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.743 Vali Acc: 0.467 Test Loss: 4.743 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.334984064102173
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.326 Vali Acc: 0.467 Test Loss: 5.326 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2437233924865723
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.886 Vali Acc: 0.467 Test Loss: 5.886 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9706265926361084
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.422 Vali Acc: 0.467 Test Loss: 6.422 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2953009605407715
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.932 Vali Acc: 0.467 Test Loss: 6.932 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.001795530319214
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.3459837436676025
Epoch: 2, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.722158432006836
Epoch: 3, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.763019323348999
Epoch: 4, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3346517086029053
Epoch: 5, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5367043018341064
Epoch: 6, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4970934391021729
Epoch: 7, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.809 Vali Acc: 0.400 Test Loss: 1.809 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3241233825683594
Epoch: 8, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.312 Vali Acc: 0.400 Test Loss: 2.312 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4302048683166504
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.858 Vali Acc: 0.400 Test Loss: 2.858 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4596617221832275
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.426 Vali Acc: 0.400 Test Loss: 3.426 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5384902954101562
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.997 Vali Acc: 0.400 Test Loss: 3.997 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4244911670684814
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.559 Vali Acc: 0.400 Test Loss: 4.559 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0578455924987793
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.377577543258667
Epoch: 2, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.32537841796875
Epoch: 3, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3205480575561523
Epoch: 4, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.422043800354004
Epoch: 5, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3184964656829834
Epoch: 6, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.474 Vali Acc: 0.333 Test Loss: 1.474 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.476902723312378
Epoch: 7, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.925 Vali Acc: 0.333 Test Loss: 1.925 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4303452968597412
Epoch: 8, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.410 Vali Acc: 0.267 Test Loss: 2.410 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.380399465560913
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.929 Vali Acc: 0.267 Test Loss: 2.929 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1452105045318604
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.464 Vali Acc: 0.267 Test Loss: 3.464 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3365421295166016
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.998 Vali Acc: 0.267 Test Loss: 3.998 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.86069917678833
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.2577660083770752
Epoch: 2, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.4571201801300049
Epoch: 3, Steps: 1 | Train Loss: 0.772 Vali Loss: 0.979 Vali Acc: 0.600 Test Loss: 0.979 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 1.3518645763397217
Epoch: 4, Steps: 1 | Train Loss: 0.582 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.462376356124878
Epoch: 5, Steps: 1 | Train Loss: 0.531 Vali Loss: 0.981 Vali Acc: 0.400 Test Loss: 0.981 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3811542987823486
Epoch: 6, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.34401535987854
Epoch: 7, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.24485445022583
Epoch: 8, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.237 Vali Acc: 0.467 Test Loss: 1.237 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4164557456970215
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.400 Test Loss: 1.507 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.579296588897705
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.333 Test Loss: 1.807 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3875524997711182
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.333 Test Loss: 2.122 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4034409523010254
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.333 Test Loss: 2.442 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4677112102508545
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.760 Vali Acc: 0.333 Test Loss: 2.760 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1807775497436523
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.3665764331817627
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 1.364224910736084
Epoch: 3, Steps: 1 | Train Loss: 0.847 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.4050252437591553
Epoch: 4, Steps: 1 | Train Loss: 0.696 Vali Loss: 0.986 Vali Acc: 0.533 Test Loss: 0.986 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.3667986392974854
Epoch: 5, Steps: 1 | Train Loss: 0.640 Vali Loss: 0.983 Vali Acc: 0.467 Test Loss: 0.983 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1042497158050537
Epoch: 6, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4496018886566162
Epoch: 7, Steps: 1 | Train Loss: 0.123 Vali Loss: 0.993 Vali Acc: 0.400 Test Loss: 0.993 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8852028846740723
Epoch: 8, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.279 Vali Acc: 0.533 Test Loss: 1.279 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1824078559875488
Epoch: 9, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.511 Vali Acc: 0.467 Test Loss: 1.511 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3203082084655762
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.467 Test Loss: 1.737 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3175063133239746
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.467 Test Loss: 1.964 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2605130672454834
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.192 Vali Acc: 0.467 Test Loss: 2.192 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3400442600250244
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.416 Vali Acc: 0.467 Test Loss: 2.416 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.390439510345459
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.634 Vali Acc: 0.467 Test Loss: 2.634 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7468719482421875
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.1669530868530273
Epoch: 2, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0802443027496338
Epoch: 3, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.139786958694458
Epoch: 4, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.240548849105835
Epoch: 5, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.31931734085083
Epoch: 6, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3781969547271729
Epoch: 7, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3542296886444092
Epoch: 8, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.317483901977539
Epoch: 9, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2479655742645264
Epoch: 10, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2861170768737793
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.379 Vali Acc: 0.467 Test Loss: 1.379 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3732812404632568
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.470 Vali Acc: 0.467 Test Loss: 1.470 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4736230373382568
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.467 Test Loss: 1.566 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.060976266860962
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.235558032989502
Epoch: 2, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 1.079763650894165
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 1.2061152458190918
Epoch: 4, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.092834711074829
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.205307960510254
Epoch: 6, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.2278711795806885
Epoch: 7, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2169609069824219
Epoch: 8, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.560 Vali Acc: 0.333 Test Loss: 1.560 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3276703357696533
Epoch: 9, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.425 Vali Acc: 0.333 Test Loss: 1.425 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2564308643341064
Epoch: 10, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.545 Vali Acc: 0.467 Test Loss: 1.545 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466651).  Saving model ...
Epoch: 11 cost time: 1.0053813457489014
Epoch: 11, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.866 Vali Acc: 0.333 Test Loss: 1.866 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0088469982147217
Epoch: 12, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.982 Vali Acc: 0.400 Test Loss: 1.982 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2434055805206299
Epoch: 13, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.874 Vali Acc: 0.467 Test Loss: 1.874 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.089651107788086
Epoch: 14, Steps: 1 | Train Loss: 0.011 Vali Loss: 2.116 Vali Acc: 0.400 Test Loss: 2.116 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.217696189880371
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.567 Vali Acc: 0.400 Test Loss: 2.567 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0809130668640137
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 3.018 Vali Acc: 0.400 Test Loss: 3.018 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2368605136871338
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.400 Vali Acc: 0.400 Test Loss: 3.400 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1933784484863281
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.661 Vali Acc: 0.400 Test Loss: 3.661 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1285197734832764
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.854 Vali Acc: 0.400 Test Loss: 3.854 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.311689853668213
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.021 Vali Acc: 0.333 Test Loss: 4.021 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6129923
model size : 33.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.9965221881866455
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 3.643817186355591
Epoch: 2, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2388434410095215
Epoch: 3, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.368213415145874
Epoch: 4, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 3.576472520828247
Epoch: 5, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.878345012664795
Epoch: 6, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 3.2610273361206055
Epoch: 7, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.288 Vali Acc: 0.467 Test Loss: 1.288 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466654).  Saving model ...
Epoch: 8 cost time: 2.3017630577087402
Epoch: 8, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.936 Vali Acc: 0.400 Test Loss: 1.936 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5884461402893066
Epoch: 9, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.961 Vali Acc: 0.467 Test Loss: 1.961 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.130047559738159
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.185 Vali Acc: 0.333 Test Loss: 2.185 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4920012950897217
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.515 Vali Acc: 0.333 Test Loss: 2.515 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.376244306564331
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.886 Vali Acc: 0.333 Test Loss: 2.886 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.626169204711914
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.267 Vali Acc: 0.333 Test Loss: 3.267 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7804512977600098
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.639 Vali Acc: 0.333 Test Loss: 3.639 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.669588565826416
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.998 Vali Acc: 0.333 Test Loss: 3.998 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.717479944229126
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.341 Vali Acc: 0.333 Test Loss: 4.341 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.41634202003479
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.669 Vali Acc: 0.333 Test Loss: 4.669 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.76222825050354
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 3.3117644786834717
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.185657262802124
Epoch: 3, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8902575969696045
Epoch: 4, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9359233379364014
Epoch: 5, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 2.9118902683258057
Epoch: 6, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 3.3090977668762207
Epoch: 7, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2921509742736816
Epoch: 8, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.848 Vali Acc: 0.333 Test Loss: 1.848 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9697141647338867
Epoch: 9, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.986 Vali Acc: 0.333 Test Loss: 1.986 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1479992866516113
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.213 Vali Acc: 0.200 Test Loss: 2.213 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6178505420684814
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.507 Vali Acc: 0.200 Test Loss: 2.507 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.847998857498169
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.834 Vali Acc: 0.267 Test Loss: 2.834 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.253082513809204
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.174 Vali Acc: 0.267 Test Loss: 3.174 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7924246788024902
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.516 Vali Acc: 0.333 Test Loss: 3.516 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.380295991897583
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.853 Vali Acc: 0.333 Test Loss: 3.853 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.176706075668335
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.180 Vali Acc: 0.333 Test Loss: 4.180 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.944258689880371
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.467808246612549
Epoch: 2, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1364057064056396
Epoch: 3, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 2.5875277519226074
Epoch: 4, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6273446083068848
Epoch: 5, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 2.2548255920410156
Epoch: 6, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.667299509048462
Epoch: 7, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.325 Vali Acc: 0.467 Test Loss: 1.325 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.564146041870117
Epoch: 8, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.487 Vali Acc: 0.400 Test Loss: 1.487 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0547871589660645
Epoch: 9, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.543 Vali Acc: 0.467 Test Loss: 1.543 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9468843936920166
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.647 Vali Acc: 0.467 Test Loss: 1.647 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.637484073638916
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.774 Vali Acc: 0.467 Test Loss: 1.774 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.6496541500091553
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.467 Test Loss: 1.908 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6670515537261963
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.045 Vali Acc: 0.467 Test Loss: 2.045 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.680832624435425
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.467 Test Loss: 2.182 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.731248617172241
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.315 Vali Acc: 0.467 Test Loss: 2.315 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.7311296463012695
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.9101207256317139
Epoch: 2, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9033455848693848
Epoch: 3, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1906144618988037
Epoch: 4, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 2.244635581970215
Epoch: 5, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 1.8957452774047852
Epoch: 6, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9656424522399902
Epoch: 7, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.453 Vali Acc: 0.600 Test Loss: 1.453 Test Acc: 0.600
Validation loss decreased (-0.399990 --> -0.599985).  Saving model ...
Epoch: 8 cost time: 2.367357015609741
Epoch: 8, Steps: 1 | Train Loss: 0.031 Vali Loss: 2.173 Vali Acc: 0.600 Test Loss: 2.173 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.408890962600708
Epoch: 9, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.855 Vali Acc: 0.467 Test Loss: 2.855 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0854573249816895
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.548 Vali Acc: 0.467 Test Loss: 3.548 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.955272912979126
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.249 Vali Acc: 0.467 Test Loss: 4.249 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1587979793548584
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.942 Vali Acc: 0.467 Test Loss: 4.942 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1384005546569824
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.618 Vali Acc: 0.467 Test Loss: 5.618 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2118923664093018
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.268 Vali Acc: 0.467 Test Loss: 6.268 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.918287754058838
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.891 Vali Acc: 0.467 Test Loss: 6.891 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0243654251098633
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.485 Vali Acc: 0.467 Test Loss: 7.485 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.016296863555908
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.049 Vali Acc: 0.467 Test Loss: 8.049 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.964468002319336
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.4665846824645996
Epoch: 2, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8167848587036133
Epoch: 3, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.8036925792694092
Epoch: 4, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.565699577331543
Epoch: 5, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 1.2629926204681396
Epoch: 6, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.288 Vali Acc: 0.467 Test Loss: 1.288 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.791588544845581
Epoch: 7, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.665 Vali Acc: 0.400 Test Loss: 1.665 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7743959426879883
Epoch: 8, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.226 Vali Acc: 0.400 Test Loss: 2.226 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.681117057800293
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.825 Vali Acc: 0.400 Test Loss: 2.825 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6279773712158203
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.442 Vali Acc: 0.400 Test Loss: 3.442 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7514688968658447
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.059 Vali Acc: 0.400 Test Loss: 4.059 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5945603847503662
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.667 Vali Acc: 0.400 Test Loss: 4.667 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.59185791015625
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.257 Vali Acc: 0.400 Test Loss: 5.257 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7408833503723145
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.826 Vali Acc: 0.400 Test Loss: 5.826 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7493774890899658
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.371 Vali Acc: 0.400 Test Loss: 6.371 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8169076442718506
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.396240234375
Epoch: 2, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4184153079986572
Epoch: 3, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2558767795562744
Epoch: 4, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.470726728439331
Epoch: 5, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1986987590789795
Epoch: 6, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2980308532714844
Epoch: 7, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.752 Vali Acc: 0.400 Test Loss: 1.752 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3694441318511963
Epoch: 8, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.351 Vali Acc: 0.333 Test Loss: 2.351 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3811922073364258
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.991 Vali Acc: 0.333 Test Loss: 2.991 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5319240093231201
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.646 Vali Acc: 0.333 Test Loss: 3.646 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.41683030128479
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.297 Vali Acc: 0.333 Test Loss: 4.297 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.0001728534698486
Epoch: 1, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.268993854522705
Epoch: 2, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.3683526515960693
Epoch: 3, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1214945316314697
Epoch: 4, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2136204242706299
Epoch: 5, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2534117698669434
Epoch: 6, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2003350257873535
Epoch: 7, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1275508403778076
Epoch: 8, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.414 Vali Acc: 0.467 Test Loss: 1.414 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0544805526733398
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.644 Vali Acc: 0.400 Test Loss: 1.644 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3273906707763672
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.333 Test Loss: 1.888 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0184030532836914
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.333 Test Loss: 2.140 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2075541019439697
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.394 Vali Acc: 0.333 Test Loss: 2.394 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.036581039428711
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.098452091217041
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.136584997177124
Epoch: 3, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.2395975589752197
Epoch: 4, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.1966159343719482
Epoch: 5, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.248094081878662
Epoch: 6, Steps: 1 | Train Loss: 0.571 Vali Loss: 0.953 Vali Acc: 0.533 Test Loss: 0.953 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533324).  Saving model ...
Epoch: 7 cost time: 1.072873592376709
Epoch: 7, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1048903465270996
Epoch: 8, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2117886543273926
Epoch: 9, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.209892988204956
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.894989013671875
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1758768558502197
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2235019207000732
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.273 Vali Acc: 0.400 Test Loss: 1.273 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3160762786865234
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3344359397888184
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4299390316009521
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.400 Test Loss: 1.419 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8578710556030273
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.2073948383331299
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.1640255451202393
Epoch: 3, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.0994255542755127
Epoch: 4, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.185732364654541
Epoch: 5, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2662043571472168
Epoch: 6, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.2154552936553955
Epoch: 7, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1943004131317139
Epoch: 8, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2353293895721436
Epoch: 9, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 1.262613296508789
Epoch: 10, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2635705471038818
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.417 Vali Acc: 0.467 Test Loss: 1.417 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1104204654693604
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.467 Test Loss: 1.620 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2572672367095947
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.467 Test Loss: 1.812 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1003942489624023
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.400 Test Loss: 2.000 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1944231986999512
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.400 Test Loss: 2.182 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2678754329681396
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.359 Vali Acc: 0.400 Test Loss: 2.359 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.193507432937622
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.530 Vali Acc: 0.400 Test Loss: 2.530 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2160327434539795
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.693 Vali Acc: 0.400 Test Loss: 2.693 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.199211597442627
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.850 Vali Acc: 0.400 Test Loss: 2.850 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.804774522781372
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.0344719886779785
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.030625820159912
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.026334524154663
Epoch: 4, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9675569534301758
Epoch: 5, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0810186862945557
Epoch: 6, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.975501298904419
Epoch: 7, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.001664161682129
Epoch: 8, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9816265106201172
Epoch: 9, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.533 Vali Acc: 0.400 Test Loss: 1.533 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1401796340942383
Epoch: 10, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.587 Vali Acc: 0.467 Test Loss: 1.587 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1328296661376953
Epoch: 11, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.990 Vali Acc: 0.333 Test Loss: 1.990 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5343491
model size : 30.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.9575042724609375
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 3.595163583755493
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 3.904165029525757
Epoch: 3, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 3.7136807441711426
Epoch: 4, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.875544309616089
Epoch: 5, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9155397415161133
Epoch: 6, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.781801700592041
Epoch: 7, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.437 Vali Acc: 0.533 Test Loss: 1.437 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533319).  Saving model ...
Epoch: 8 cost time: 3.5847816467285156
Epoch: 8, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.616 Vali Acc: 0.467 Test Loss: 1.616 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.82177996635437
Epoch: 9, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.922 Vali Acc: 0.333 Test Loss: 1.922 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9389169216156006
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.333 Test Loss: 2.256 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8632450103759766
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.601 Vali Acc: 0.333 Test Loss: 2.601 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6937639713287354
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.947 Vali Acc: 0.333 Test Loss: 2.947 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.013038158416748
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.287 Vali Acc: 0.333 Test Loss: 3.287 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.481121778488159
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.618 Vali Acc: 0.333 Test Loss: 3.618 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2974634170532227
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.936 Vali Acc: 0.200 Test Loss: 3.936 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.746349334716797
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.242 Vali Acc: 0.200 Test Loss: 4.242 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.728581428527832
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.533 Vali Acc: 0.267 Test Loss: 4.533 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 5.017691135406494
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 2.8360061645507812
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 2.9116017818450928
Epoch: 3, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.070 Vali Acc: 0.667 Test Loss: 1.070 Test Acc: 0.667
Validation loss decreased (-0.533322 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 3.453681707382202
Epoch: 4, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.140127182006836
Epoch: 5, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9570722579956055
Epoch: 6, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9422051906585693
Epoch: 7, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.442 Vali Acc: 0.467 Test Loss: 1.442 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2316226959228516
Epoch: 8, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.521 Vali Acc: 0.267 Test Loss: 1.521 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9857606887817383
Epoch: 9, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.778 Vali Acc: 0.267 Test Loss: 1.778 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.928110361099243
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.267 Test Loss: 2.083 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1107683181762695
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.267 Test Loss: 2.407 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.074432373046875
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.736 Vali Acc: 0.333 Test Loss: 2.736 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.2296831607818604
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.061 Vali Acc: 0.333 Test Loss: 3.061 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.251558780670166
Epoch: 1, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 2.6702046394348145
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 2.893322229385376
Epoch: 3, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
Validation loss decreased (-0.266656 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 2.6314966678619385
Epoch: 4, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 2.424769639968872
Epoch: 5, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 2.7425472736358643
Epoch: 6, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.81146240234375
Epoch: 7, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.300 Vali Acc: 0.533 Test Loss: 1.300 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5403215885162354
Epoch: 8, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.295 Vali Acc: 0.467 Test Loss: 1.295 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.414987325668335
Epoch: 9, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.403 Vali Acc: 0.467 Test Loss: 1.403 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6383023262023926
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.467 Test Loss: 1.547 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.797854423522949
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.467 Test Loss: 1.705 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.958270788192749
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.467 Test Loss: 1.868 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.649874687194824
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.031 Vali Acc: 0.400 Test Loss: 2.031 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.61513614654541
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.400 Test Loss: 2.191 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2563745975494385
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.347 Vali Acc: 0.400 Test Loss: 2.347 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.524737596511841
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.1425342559814453
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1259853839874268
Epoch: 3, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 2.224006414413452
Epoch: 4, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 1.662607192993164
Epoch: 5, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3815114498138428
Epoch: 6, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1225244998931885
Epoch: 7, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.617 Vali Acc: 0.600 Test Loss: 1.617 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1289801597595215
Epoch: 8, Steps: 1 | Train Loss: 0.029 Vali Loss: 2.215 Vali Acc: 0.400 Test Loss: 2.215 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1811559200286865
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.912 Vali Acc: 0.333 Test Loss: 2.912 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2142293453216553
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.628 Vali Acc: 0.333 Test Loss: 3.628 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8896117210388184
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.343 Vali Acc: 0.333 Test Loss: 4.343 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0380256175994873
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.044 Vali Acc: 0.333 Test Loss: 5.044 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.984771966934204
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.725 Vali Acc: 0.333 Test Loss: 5.725 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7836389541625977
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.381 Vali Acc: 0.333 Test Loss: 6.381 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3453359603881836
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.6318519115447998
Epoch: 2, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.415156602859497
Epoch: 3, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.4130454063415527
Epoch: 4, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6541454792022705
Epoch: 5, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7081012725830078
Epoch: 6, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6532223224639893
Epoch: 7, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.651 Vali Acc: 0.400 Test Loss: 1.651 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.311140537261963
Epoch: 8, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.135 Vali Acc: 0.400 Test Loss: 2.135 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5999383926391602
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.653 Vali Acc: 0.333 Test Loss: 2.653 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5914478302001953
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.187 Vali Acc: 0.333 Test Loss: 3.187 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4714536666870117
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.725 Vali Acc: 0.333 Test Loss: 3.725 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5593972206115723
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.255 Vali Acc: 0.333 Test Loss: 4.255 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6963605880737305
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.772 Vali Acc: 0.333 Test Loss: 4.772 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.322639226913452
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.2823150157928467
Epoch: 2, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.2682664394378662
Epoch: 3, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2106916904449463
Epoch: 4, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3504505157470703
Epoch: 5, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4626471996307373
Epoch: 6, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.335 Vali Acc: 0.333 Test Loss: 1.335 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 1.1781768798828125
Epoch: 7, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.780 Vali Acc: 0.400 Test Loss: 1.780 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399982).  Saving model ...
Epoch: 8 cost time: 1.1233747005462646
Epoch: 8, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.457 Vali Acc: 0.333 Test Loss: 2.457 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3619201183319092
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.209 Vali Acc: 0.267 Test Loss: 3.209 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.327211856842041
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.990 Vali Acc: 0.267 Test Loss: 3.990 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3435630798339844
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.772 Vali Acc: 0.267 Test Loss: 4.772 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3144469261169434
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.542 Vali Acc: 0.267 Test Loss: 5.542 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1934237480163574
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.289 Vali Acc: 0.267 Test Loss: 6.289 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.073819637298584
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.008 Vali Acc: 0.267 Test Loss: 7.008 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2459583282470703
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.696 Vali Acc: 0.267 Test Loss: 7.696 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.262296438217163
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.351 Vali Acc: 0.267 Test Loss: 8.351 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.492065668106079
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 8.973 Vali Acc: 0.267 Test Loss: 8.973 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9742352962493896
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.1193232536315918
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1947367191314697
Epoch: 3, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.247107982635498
Epoch: 4, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.108 Vali Acc: 0.533 Test Loss: 1.108 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 1.1051044464111328
Epoch: 5, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 1.0351006984710693
Epoch: 6, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.010 Vali Acc: 0.400 Test Loss: 1.010 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.124514102935791
Epoch: 7, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 1.2009787559509277
Epoch: 8, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.296 Vali Acc: 0.467 Test Loss: 1.296 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1118950843811035
Epoch: 9, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.467 Test Loss: 1.552 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0739872455596924
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.467 Test Loss: 1.819 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9071304798126221
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.093 Vali Acc: 0.467 Test Loss: 2.093 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0193946361541748
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.368 Vali Acc: 0.467 Test Loss: 2.368 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1574084758758545
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.639 Vali Acc: 0.467 Test Loss: 2.639 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1819233894348145
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.904 Vali Acc: 0.400 Test Loss: 2.904 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3257408142089844
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.400 Test Loss: 3.159 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1348512172698975
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.404 Vali Acc: 0.400 Test Loss: 3.404 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1781728267669678
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.638 Vali Acc: 0.400 Test Loss: 3.638 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1141207218170166
Epoch: 1, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.2437794208526611
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.0084428787231445
Epoch: 3, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.078 Vali Acc: 0.200 Test Loss: 1.078 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8479025363922119
Epoch: 4, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 1.1419336795806885
Epoch: 5, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 1.0039308071136475
Epoch: 6, Steps: 1 | Train Loss: 0.590 Vali Loss: 0.982 Vali Acc: 0.400 Test Loss: 0.982 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0637590885162354
Epoch: 7, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.021484375
Epoch: 8, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.267 Vali Acc: 0.400 Test Loss: 1.267 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1470630168914795
Epoch: 9, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1901888847351074
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.400 Test Loss: 1.505 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1153955459594727
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.400 Test Loss: 1.617 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1777472496032715
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.400 Test Loss: 1.735 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3046977519989014
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.467 Test Loss: 1.854 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1860454082489014
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.467 Test Loss: 1.973 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1303672790527344
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.467 Test Loss: 2.090 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6222078800201416
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0777323246002197
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9821467399597168
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1012043952941895
Epoch: 4, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1511850357055664
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1898419857025146
Epoch: 6, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8911864757537842
Epoch: 7, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.9173374176025391
Epoch: 8, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.394 Vali Acc: 0.333 Test Loss: 1.394 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.963719367980957
Epoch: 9, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0100133419036865
Epoch: 10, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7805023193359375
Epoch: 11, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8705813884735107
Epoch: 12, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.250 Vali Acc: 0.467 Test Loss: 1.250 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0589313507080078
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.533 Test Loss: 1.402 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0450832843780518
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.400 Test Loss: 1.637 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0682861804962158
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.333 Test Loss: 1.922 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1667752265930176
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.400 Test Loss: 2.233 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.80269455909729
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.555 Vali Acc: 0.467 Test Loss: 2.555 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.796964406967163
Epoch: 1, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8718681335449219
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.210526466369629
Epoch: 3, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.142226219177246
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1113808155059814
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.067 Vali Acc: 0.200 Test Loss: 1.067 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0464422702789307
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.245347261428833
Epoch: 7, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.293 Vali Acc: 0.467 Test Loss: 1.293 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0791051387786865
Epoch: 8, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0373241901397705
Epoch: 9, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.369 Vali Acc: 0.467 Test Loss: 1.369 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0833544731140137
Epoch: 10, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.505 Vali Acc: 0.467 Test Loss: 1.505 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.985069990158081
Epoch: 11, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.964 Vali Acc: 0.400 Test Loss: 1.964 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4950275
model size : 28.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.620752334594727
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 3.212125062942505
Epoch: 2, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 3.732006072998047
Epoch: 3, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8343095779418945
Epoch: 4, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 3.0140488147735596
Epoch: 5, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 3.6257400512695312
Epoch: 6, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4561686515808105
Epoch: 7, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.321 Vali Acc: 0.533 Test Loss: 1.321 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.776744842529297
Epoch: 8, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.723 Vali Acc: 0.533 Test Loss: 1.723 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.318575620651245
Epoch: 9, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.102 Vali Acc: 0.533 Test Loss: 2.102 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7770190238952637
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.463 Vali Acc: 0.467 Test Loss: 2.463 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.444269895553589
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.821 Vali Acc: 0.467 Test Loss: 2.821 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8390095233917236
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.175 Vali Acc: 0.467 Test Loss: 3.175 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.392286539077759
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.520 Vali Acc: 0.467 Test Loss: 3.520 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1962900161743164
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.855 Vali Acc: 0.467 Test Loss: 3.855 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5258450508117676
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.177 Vali Acc: 0.467 Test Loss: 4.177 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.788252353668213
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.864767074584961
Epoch: 2, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 2.1773180961608887
Epoch: 3, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 3.0169758796691895
Epoch: 4, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6171648502349854
Epoch: 5, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.870198965072632
Epoch: 6, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0524795055389404
Epoch: 7, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.327 Vali Acc: 0.333 Test Loss: 1.327 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9970057010650635
Epoch: 8, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.733 Vali Acc: 0.267 Test Loss: 1.733 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3073997497558594
Epoch: 9, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.237 Vali Acc: 0.267 Test Loss: 2.237 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5603785514831543
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.764 Vali Acc: 0.267 Test Loss: 2.764 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.958312511444092
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.296 Vali Acc: 0.267 Test Loss: 3.296 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9781267642974854
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.822 Vali Acc: 0.267 Test Loss: 3.822 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.364203691482544
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.333 Vali Acc: 0.267 Test Loss: 4.333 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.346008777618408
Epoch: 1, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 2.5788416862487793
Epoch: 2, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 2.183858871459961
Epoch: 3, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 2.695523977279663
Epoch: 4, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 2.5488972663879395
Epoch: 5, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 2.666947603225708
Epoch: 6, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.686220169067383
Epoch: 7, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.290 Vali Acc: 0.533 Test Loss: 1.290 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.369396209716797
Epoch: 8, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.595 Vali Acc: 0.533 Test Loss: 1.595 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9796102046966553
Epoch: 9, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.981 Vali Acc: 0.467 Test Loss: 1.981 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7429473400115967
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.381 Vali Acc: 0.467 Test Loss: 2.381 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.374586820602417
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.782 Vali Acc: 0.467 Test Loss: 2.782 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.37290358543396
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.179 Vali Acc: 0.467 Test Loss: 3.179 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.630312442779541
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.568 Vali Acc: 0.467 Test Loss: 3.568 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3887391090393066
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.944 Vali Acc: 0.467 Test Loss: 3.944 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6131889820098877
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.306 Vali Acc: 0.467 Test Loss: 4.306 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.4789698123931885
Epoch: 1, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 1.951873540878296
Epoch: 2, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 1.846191644668579
Epoch: 3, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.8363265991210938
Epoch: 4, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1429178714752197
Epoch: 5, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6020724773406982
Epoch: 6, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6838982105255127
Epoch: 7, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.666 Vali Acc: 0.533 Test Loss: 1.666 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.021130323410034
Epoch: 8, Steps: 1 | Train Loss: 0.017 Vali Loss: 2.312 Vali Acc: 0.467 Test Loss: 2.312 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.891521692276001
Epoch: 9, Steps: 1 | Train Loss: 0.002 Vali Loss: 3.053 Vali Acc: 0.467 Test Loss: 3.053 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1871800422668457
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.812 Vali Acc: 0.467 Test Loss: 3.812 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.188814401626587
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.564 Vali Acc: 0.467 Test Loss: 4.564 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.864015817642212
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.299 Vali Acc: 0.467 Test Loss: 5.299 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.062695026397705
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.010 Vali Acc: 0.467 Test Loss: 6.010 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.448421001434326
Epoch: 1, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.6703214645385742
Epoch: 2, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.3005876541137695
Epoch: 3, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3333613872528076
Epoch: 4, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.123565912246704
Epoch: 5, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3725616931915283
Epoch: 6, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.352 Vali Acc: 0.333 Test Loss: 1.352 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3192431926727295
Epoch: 7, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.751 Vali Acc: 0.400 Test Loss: 1.751 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399982).  Saving model ...
Epoch: 8 cost time: 1.3698036670684814
Epoch: 8, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.318 Vali Acc: 0.333 Test Loss: 2.318 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8587687015533447
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.948 Vali Acc: 0.333 Test Loss: 2.948 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6563591957092285
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.601 Vali Acc: 0.333 Test Loss: 3.601 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5385465621948242
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.256 Vali Acc: 0.400 Test Loss: 4.256 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4830787181854248
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.900 Vali Acc: 0.400 Test Loss: 4.900 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6606171131134033
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.524 Vali Acc: 0.400 Test Loss: 5.524 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.577399730682373
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.126 Vali Acc: 0.400 Test Loss: 6.126 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4973726272583008
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.703 Vali Acc: 0.400 Test Loss: 6.703 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6958022117614746
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.252 Vali Acc: 0.400 Test Loss: 7.252 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.629624843597412
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 7.774 Vali Acc: 0.400 Test Loss: 7.774 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7927184104919434
Epoch: 1, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.2300660610198975
Epoch: 2, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0623512268066406
Epoch: 3, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.357677698135376
Epoch: 4, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.227278470993042
Epoch: 5, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.250723123550415
Epoch: 6, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.422 Vali Acc: 0.200 Test Loss: 1.422 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2550127506256104
Epoch: 7, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.761 Vali Acc: 0.333 Test Loss: 1.761 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.281503438949585
Epoch: 8, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.396 Vali Acc: 0.333 Test Loss: 2.396 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9510536193847656
Epoch: 9, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.153 Vali Acc: 0.267 Test Loss: 3.153 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0012309551239014
Epoch: 10, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.958 Vali Acc: 0.267 Test Loss: 3.958 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3118278980255127
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.778 Vali Acc: 0.267 Test Loss: 4.778 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9880337715148926
Epoch: 1, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.07808518409729
Epoch: 2, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.003 Vali Acc: 0.533 Test Loss: 1.003 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 1.1339030265808105
Epoch: 3, Steps: 1 | Train Loss: 0.783 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.2790617942810059
Epoch: 4, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0386738777160645
Epoch: 5, Steps: 1 | Train Loss: 0.548 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 1.1427428722381592
Epoch: 6, Steps: 1 | Train Loss: 0.418 Vali Loss: 0.950 Vali Acc: 0.400 Test Loss: 0.950 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1996715068817139
Epoch: 7, Steps: 1 | Train Loss: 0.095 Vali Loss: 0.942 Vali Acc: 0.400 Test Loss: 0.942 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2649481296539307
Epoch: 8, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.432 Vali Acc: 0.467 Test Loss: 1.432 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2405891418457031
Epoch: 9, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.070 Vali Acc: 0.400 Test Loss: 2.070 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2546541690826416
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.651 Vali Acc: 0.400 Test Loss: 2.651 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1932082176208496
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.189 Vali Acc: 0.400 Test Loss: 3.189 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1586670875549316
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.701 Vali Acc: 0.400 Test Loss: 3.701 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9829583168029785
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.193 Vali Acc: 0.400 Test Loss: 4.193 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0799922943115234
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.666 Vali Acc: 0.400 Test Loss: 4.666 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1182045936584473
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.117 Vali Acc: 0.400 Test Loss: 5.117 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6979317665100098
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.1641919612884521
Epoch: 2, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.147256851196289
Epoch: 3, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.1991820335388184
Epoch: 4, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.2330777645111084
Epoch: 5, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.1272563934326172
Epoch: 6, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0751216411590576
Epoch: 7, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0361952781677246
Epoch: 8, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0125949382781982
Epoch: 9, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.462 Vali Acc: 0.400 Test Loss: 1.462 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1392743587493896
Epoch: 10, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.400 Test Loss: 1.619 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9425323009490967
Epoch: 11, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.400 Test Loss: 1.782 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.039384365081787
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.947 Vali Acc: 0.400 Test Loss: 1.947 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9711413383483887
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.112 Vali Acc: 0.400 Test Loss: 2.112 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9568564891815186
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.273 Vali Acc: 0.400 Test Loss: 2.273 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9351546764373779
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.430 Vali Acc: 0.400 Test Loss: 2.430 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5360219478607178
Epoch: 1, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.969498872756958
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.872643232345581
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9195845127105713
Epoch: 4, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9523880481719971
Epoch: 5, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8560364246368408
Epoch: 6, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9270172119140625
Epoch: 7, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9204144477844238
Epoch: 8, Steps: 1 | Train Loss: 0.214 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 1.1258783340454102
Epoch: 9, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 1.0821959972381592
Epoch: 10, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.205 Vali Acc: 0.467 Test Loss: 1.205 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 1.1321680545806885
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1890931129455566
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.400 Test Loss: 1.441 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0224087238311768
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.467 Test Loss: 1.643 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0314176082611084
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.467 Test Loss: 1.854 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0704903602600098
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.467 Test Loss: 2.064 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9992878437042236
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.467 Test Loss: 2.271 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0912361145019531
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.470 Vali Acc: 0.467 Test Loss: 2.470 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0319716930389404
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.662 Vali Acc: 0.467 Test Loss: 2.662 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0994255542755127
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.467 Test Loss: 2.845 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0393600463867188
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.019 Vali Acc: 0.467 Test Loss: 3.019 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6764190196990967
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.007028341293335
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1243159770965576
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.050105094909668
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0437450408935547
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.1932902336120605
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0872032642364502
Epoch: 7, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.18925142288208
Epoch: 8, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.324 Vali Acc: 0.333 Test Loss: 1.324 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.110077142715454
Epoch: 9, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.341 Vali Acc: 0.467 Test Loss: 1.341 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 10 cost time: 1.158344030380249
Epoch: 10, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.408 Vali Acc: 0.533 Test Loss: 1.408 Test Acc: 0.533
Validation loss decreased (-0.466653 --> -0.533319).  Saving model ...
Epoch: 11 cost time: 1.2593352794647217
Epoch: 11, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.754 Vali Acc: 0.467 Test Loss: 1.754 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1340346336364746
Epoch: 12, Steps: 1 | Train Loss: 0.052 Vali Loss: 2.254 Vali Acc: 0.400 Test Loss: 2.254 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.198913335800171
Epoch: 13, Steps: 1 | Train Loss: 0.041 Vali Loss: 2.345 Vali Acc: 0.400 Test Loss: 2.345 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9560856819152832
Epoch: 14, Steps: 1 | Train Loss: 0.016 Vali Loss: 2.037 Vali Acc: 0.467 Test Loss: 2.037 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1012616157531738
Epoch: 15, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.182 Vali Acc: 0.467 Test Loss: 2.182 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2172114849090576
Epoch: 16, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.493 Vali Acc: 0.400 Test Loss: 2.493 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0166041851043701
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.888 Vali Acc: 0.400 Test Loss: 2.888 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2142159938812256
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.285 Vali Acc: 0.400 Test Loss: 3.285 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1392440795898438
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.649 Vali Acc: 0.400 Test Loss: 3.649 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1385018825531006
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.981 Vali Acc: 0.400 Test Loss: 3.981 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 4753667
model size : 27.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 4.102146863937378
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.9591546058654785
Epoch: 2, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0009987354278564
Epoch: 3, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.045412540435791
Epoch: 4, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 2.3688771724700928
Epoch: 5, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 1.9658191204071045
Epoch: 6, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.8320074081420898
Epoch: 7, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 2.5313491821289062
Epoch: 8, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.508 Vali Acc: 0.267 Test Loss: 1.508 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2078373432159424
Epoch: 9, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.605 Vali Acc: 0.400 Test Loss: 1.605 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7565984725952148
Epoch: 10, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.637 Vali Acc: 0.400 Test Loss: 1.637 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3965463638305664
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.765 Vali Acc: 0.333 Test Loss: 1.765 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2759149074554443
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.923 Vali Acc: 0.333 Test Loss: 1.923 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.138747215270996
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.086 Vali Acc: 0.333 Test Loss: 2.086 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2985177040100098
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.248 Vali Acc: 0.333 Test Loss: 2.248 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0639359951019287
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.409 Vali Acc: 0.333 Test Loss: 2.409 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7035284042358398
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.566 Vali Acc: 0.333 Test Loss: 2.566 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2861876487731934
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.718 Vali Acc: 0.333 Test Loss: 2.718 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1508233547210693
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 1.544050693511963
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
Validation loss decreased (-0.133321 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 2.1842050552368164
Epoch: 3, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.007228374481201
Epoch: 4, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8266851902008057
Epoch: 5, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7641856670379639
Epoch: 6, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.191 Vali Acc: 0.133 Test Loss: 1.191 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.555666446685791
Epoch: 7, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.268 Vali Acc: 0.267 Test Loss: 1.268 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.477102279663086
Epoch: 8, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.565 Vali Acc: 0.267 Test Loss: 1.565 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6187891960144043
Epoch: 9, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.664 Vali Acc: 0.200 Test Loss: 1.664 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7152996063232422
Epoch: 10, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.770 Vali Acc: 0.200 Test Loss: 1.770 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2849092483520508
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.944 Vali Acc: 0.267 Test Loss: 1.944 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.770402431488037
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.147 Vali Acc: 0.267 Test Loss: 2.147 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2012693881988525
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 2.029367446899414
Epoch: 2, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.7193398475646973
Epoch: 3, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 1.8072271347045898
Epoch: 4, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.470968246459961
Epoch: 5, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7732491493225098
Epoch: 6, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7822885513305664
Epoch: 7, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 1.577772617340088
Epoch: 8, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.455 Vali Acc: 0.400 Test Loss: 1.455 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8955214023590088
Epoch: 9, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.537 Vali Acc: 0.533 Test Loss: 1.537 Test Acc: 0.533
Validation loss decreased (-0.399988 --> -0.533318).  Saving model ...
Epoch: 10 cost time: 1.7293634414672852
Epoch: 10, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.578 Vali Acc: 0.467 Test Loss: 1.578 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8176674842834473
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.657 Vali Acc: 0.467 Test Loss: 1.657 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6562626361846924
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.400 Test Loss: 1.762 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1039252281188965
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.400 Test Loss: 1.875 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8706238269805908
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.400 Test Loss: 1.993 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6304543018341064
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.333 Test Loss: 2.111 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6871023178100586
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.227 Vali Acc: 0.333 Test Loss: 2.227 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0139479637145996
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.333 Test Loss: 2.340 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5230095386505127
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.448 Vali Acc: 0.333 Test Loss: 2.448 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0407042503356934
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.552 Vali Acc: 0.333 Test Loss: 2.552 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5399465560913086
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0439403057098389
Epoch: 2, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1159846782684326
Epoch: 3, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3098666667938232
Epoch: 4, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4438858032226562
Epoch: 5, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.7299952507019043
Epoch: 6, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.5676932334899902
Epoch: 7, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.260 Vali Acc: 0.467 Test Loss: 1.260 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4574546813964844
Epoch: 8, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.592 Vali Acc: 0.600 Test Loss: 1.592 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599984).  Saving model ...
Epoch: 9 cost time: 1.508493423461914
Epoch: 9, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.930 Vali Acc: 0.533 Test Loss: 1.930 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6482999324798584
Epoch: 10, Steps: 1 | Train Loss: 0.008 Vali Loss: 2.295 Vali Acc: 0.467 Test Loss: 2.295 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6680126190185547
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.654 Vali Acc: 0.467 Test Loss: 2.654 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7259180545806885
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.009 Vali Acc: 0.467 Test Loss: 3.009 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.660003662109375
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.355 Vali Acc: 0.400 Test Loss: 3.355 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.379429578781128
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.689 Vali Acc: 0.400 Test Loss: 3.689 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3025972843170166
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.009 Vali Acc: 0.400 Test Loss: 4.009 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5090556144714355
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.314 Vali Acc: 0.400 Test Loss: 4.314 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5159213542938232
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.603 Vali Acc: 0.400 Test Loss: 4.603 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5807504653930664
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.877 Vali Acc: 0.400 Test Loss: 4.877 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8463046550750732
Epoch: 1, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.273613691329956
Epoch: 2, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.1182379722595215
Epoch: 3, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2591114044189453
Epoch: 4, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1956567764282227
Epoch: 5, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.374286413192749
Epoch: 6, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466654).  Saving model ...
Epoch: 7 cost time: 1.31172776222229
Epoch: 7, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2875409126281738
Epoch: 8, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.627 Vali Acc: 0.267 Test Loss: 1.627 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3563261032104492
Epoch: 9, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.913 Vali Acc: 0.267 Test Loss: 1.913 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1432929039001465
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.216 Vali Acc: 0.267 Test Loss: 2.216 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2587883472442627
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.523 Vali Acc: 0.267 Test Loss: 2.523 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3141436576843262
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.831 Vali Acc: 0.267 Test Loss: 2.831 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8912761211395264
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.133 Vali Acc: 0.267 Test Loss: 3.133 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.349275827407837
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.427 Vali Acc: 0.267 Test Loss: 3.427 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0504555702209473
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.711 Vali Acc: 0.267 Test Loss: 3.711 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1483569145202637
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.983 Vali Acc: 0.267 Test Loss: 3.983 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6316797733306885
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0417466163635254
Epoch: 2, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0260076522827148
Epoch: 3, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9894089698791504
Epoch: 4, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1022417545318604
Epoch: 5, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1759188175201416
Epoch: 6, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0985417366027832
Epoch: 7, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.329 Vali Acc: 0.267 Test Loss: 1.329 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1538927555084229
Epoch: 8, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.635 Vali Acc: 0.333 Test Loss: 1.635 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1357135772705078
Epoch: 9, Steps: 1 | Train Loss: 0.017 Vali Loss: 2.050 Vali Acc: 0.333 Test Loss: 2.050 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9809410572052002
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.473 Vali Acc: 0.267 Test Loss: 2.473 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0020291805267334
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.894 Vali Acc: 0.267 Test Loss: 2.894 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4780983924865723
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.0053942203521729
Epoch: 2, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 1.0309512615203857
Epoch: 3, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.1005384922027588
Epoch: 4, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9244852066040039
Epoch: 5, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.0970289707183838
Epoch: 6, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.9505414962768555
Epoch: 7, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0185866355895996
Epoch: 8, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.064802646636963
Epoch: 9, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.313 Vali Acc: 0.467 Test Loss: 1.313 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0138676166534424
Epoch: 10, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.477 Vali Acc: 0.400 Test Loss: 1.477 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0790562629699707
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.400 Test Loss: 1.631 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9213354587554932
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.400 Test Loss: 1.787 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0318362712860107
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.946 Vali Acc: 0.400 Test Loss: 1.946 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1686813831329346
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.400 Test Loss: 2.106 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0332310199737549
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.264 Vali Acc: 0.400 Test Loss: 2.264 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0226194858551025
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.419 Vali Acc: 0.400 Test Loss: 2.419 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.848629951477051
Epoch: 1, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9976446628570557
Epoch: 2, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.9047667980194092
Epoch: 3, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.0767602920532227
Epoch: 4, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.0875260829925537
Epoch: 5, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.0301170349121094
Epoch: 6, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.03019118309021
Epoch: 7, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.0933594703674316
Epoch: 8, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.159 Vali Acc: 0.533 Test Loss: 1.159 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.9989204406738281
Epoch: 9, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.826115608215332
Epoch: 10, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.053715705871582
Epoch: 11, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.295 Vali Acc: 0.467 Test Loss: 1.295 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0471436977386475
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.074256420135498
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.015052080154419
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0707557201385498
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.467 Test Loss: 1.433 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.015519618988037
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.467 Test Loss: 1.467 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.941889762878418
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.467 Test Loss: 1.502 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1315093040466309
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.467 Test Loss: 1.536 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6484084129333496
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9589686393737793
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0292561054229736
Epoch: 3, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0113279819488525
Epoch: 4, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.0808424949645996
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0344533920288086
Epoch: 6, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0492186546325684
Epoch: 7, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0098490715026855
Epoch: 8, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.9552655220031738
Epoch: 9, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.970557451248169
Epoch: 10, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9842360019683838
Epoch: 11, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0101146697998047
Epoch: 12, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9849069118499756
Epoch: 13, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9858624935150146
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.434 Vali Acc: 0.467 Test Loss: 1.434 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9956727027893066
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.581 Vali Acc: 0.467 Test Loss: 1.581 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8114192485809326
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.703 Vali Acc: 0.467 Test Loss: 1.703 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8630361557006836
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.467 Test Loss: 1.802 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0050654411315918
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.467 Test Loss: 1.887 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6256377696990967
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9722437858581543
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.0152513980865479
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8824453353881836
Epoch: 4, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.888178825378418
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9519929885864258
Epoch: 6, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8881168365478516
Epoch: 7, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.739692211151123
Epoch: 8, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8719816207885742
Epoch: 9, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.316 Vali Acc: 0.467 Test Loss: 1.316 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 10 cost time: 0.9128067493438721
Epoch: 10, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.938755989074707
Epoch: 11, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.354 Vali Acc: 0.467 Test Loss: 1.354 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8731288909912109
Epoch: 12, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.395 Vali Acc: 0.533 Test Loss: 1.395 Test Acc: 0.533
Validation loss decreased (-0.466654 --> -0.533319).  Saving model ...
Epoch: 13 cost time: 0.8990590572357178
Epoch: 13, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.576 Vali Acc: 0.467 Test Loss: 1.576 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9231851100921631
Epoch: 14, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.806 Vali Acc: 0.400 Test Loss: 1.806 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.942108154296875
Epoch: 15, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.799 Vali Acc: 0.467 Test Loss: 1.799 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8283610343933105
Epoch: 16, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.708 Vali Acc: 0.400 Test Loss: 1.708 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9608213901519775
Epoch: 17, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.825 Vali Acc: 0.400 Test Loss: 1.825 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.891122579574585
Epoch: 18, Steps: 1 | Train Loss: 0.015 Vali Loss: 2.053 Vali Acc: 0.400 Test Loss: 2.053 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9566287994384766
Epoch: 19, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.303 Vali Acc: 0.400 Test Loss: 2.303 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8905572891235352
Epoch: 20, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.476 Vali Acc: 0.400 Test Loss: 2.476 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9256846904754639
Epoch: 21, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.545 Vali Acc: 0.400 Test Loss: 2.545 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8953523635864258
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.592 Vali Acc: 0.400 Test Loss: 2.592 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 3196035
model size : 17.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.775383949279785
Epoch: 1, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.7789218425750732
Epoch: 2, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 2.1377112865448
Epoch: 3, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 2.183863639831543
Epoch: 4, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 2.0454182624816895
Epoch: 5, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1835556030273438
Epoch: 6, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2004239559173584
Epoch: 7, Steps: 1 | Train Loss: 0.294 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.06101393699646
Epoch: 8, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.357 Vali Acc: 0.267 Test Loss: 1.357 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0712900161743164
Epoch: 9, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.662 Vali Acc: 0.267 Test Loss: 1.662 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.093820095062256
Epoch: 10, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.799 Vali Acc: 0.267 Test Loss: 1.799 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.349008798599243
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.032 Vali Acc: 0.333 Test Loss: 2.032 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9909305572509766
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.314 Vali Acc: 0.333 Test Loss: 2.314 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6114437580108643
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.607 Vali Acc: 0.400 Test Loss: 2.607 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399974).  Saving model ...
Epoch: 14 cost time: 1.809473991394043
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.893 Vali Acc: 0.400 Test Loss: 2.893 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.381685733795166
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.170 Vali Acc: 0.333 Test Loss: 3.170 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0124454498291016
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.433 Vali Acc: 0.333 Test Loss: 3.433 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9067339897155762
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.684 Vali Acc: 0.333 Test Loss: 3.684 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.660188913345337
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.922 Vali Acc: 0.333 Test Loss: 3.922 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7997980117797852
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.147 Vali Acc: 0.333 Test Loss: 4.147 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2917261123657227
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.360 Vali Acc: 0.333 Test Loss: 4.360 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.947777509689331
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.560 Vali Acc: 0.333 Test Loss: 4.560 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5636112689971924
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.749 Vali Acc: 0.333 Test Loss: 4.749 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8976960182189941
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.926 Vali Acc: 0.333 Test Loss: 4.926 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2341530323028564
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.5675196647644043
Epoch: 2, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2465643882751465
Epoch: 3, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7796895503997803
Epoch: 4, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7124159336090088
Epoch: 5, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4171679019927979
Epoch: 6, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.88218355178833
Epoch: 7, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.289 Vali Acc: 0.200 Test Loss: 1.289 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9054512977600098
Epoch: 8, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.444 Vali Acc: 0.133 Test Loss: 1.444 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2018637657165527
Epoch: 9, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.674 Vali Acc: 0.133 Test Loss: 1.674 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7879581451416016
Epoch: 10, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.896 Vali Acc: 0.200 Test Loss: 1.896 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8182125091552734
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.162 Vali Acc: 0.267 Test Loss: 2.162 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1500344276428223
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.6084611415863037
Epoch: 2, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7345030307769775
Epoch: 3, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5108277797698975
Epoch: 4, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.5755846500396729
Epoch: 5, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7253990173339844
Epoch: 6, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.804074764251709
Epoch: 7, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3864507675170898
Epoch: 8, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4768972396850586
Epoch: 9, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.494 Vali Acc: 0.400 Test Loss: 1.494 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4929039478302002
Epoch: 10, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.628 Vali Acc: 0.467 Test Loss: 1.628 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466650).  Saving model ...
Epoch: 11 cost time: 1.4357240200042725
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.793 Vali Acc: 0.400 Test Loss: 1.793 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4934823513031006
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.986 Vali Acc: 0.400 Test Loss: 1.986 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3201913833618164
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.190 Vali Acc: 0.400 Test Loss: 2.190 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.453298568725586
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.395 Vali Acc: 0.400 Test Loss: 2.395 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4419283866882324
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.598 Vali Acc: 0.400 Test Loss: 2.598 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7133805751800537
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.796 Vali Acc: 0.400 Test Loss: 2.796 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5987012386322021
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.987 Vali Acc: 0.333 Test Loss: 2.987 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6316955089569092
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.170 Vali Acc: 0.333 Test Loss: 3.170 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6350209712982178
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.344 Vali Acc: 0.333 Test Loss: 3.344 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5844244956970215
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.510 Vali Acc: 0.333 Test Loss: 3.510 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8220417499542236
Epoch: 1, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.2754037380218506
Epoch: 2, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.2031970024108887
Epoch: 3, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2533395290374756
Epoch: 4, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.257200002670288
Epoch: 5, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.305762529373169
Epoch: 6, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.2041738033294678
Epoch: 7, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.401 Vali Acc: 0.267 Test Loss: 1.401 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1740927696228027
Epoch: 8, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.597 Vali Acc: 0.400 Test Loss: 1.597 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0912418365478516
Epoch: 9, Steps: 1 | Train Loss: 0.034 Vali Loss: 2.024 Vali Acc: 0.267 Test Loss: 2.024 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.33247709274292
Epoch: 10, Steps: 1 | Train Loss: 0.011 Vali Loss: 2.459 Vali Acc: 0.400 Test Loss: 2.459 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.325662612915039
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.885 Vali Acc: 0.467 Test Loss: 2.885 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466638).  Saving model ...
Epoch: 12 cost time: 1.226792812347412
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.316 Vali Acc: 0.467 Test Loss: 3.316 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3823561668395996
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.749 Vali Acc: 0.467 Test Loss: 3.749 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1223008632659912
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.175 Vali Acc: 0.467 Test Loss: 4.175 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1793134212493896
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.589 Vali Acc: 0.467 Test Loss: 4.589 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4760475158691406
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.987 Vali Acc: 0.467 Test Loss: 4.987 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3631558418273926
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.368 Vali Acc: 0.467 Test Loss: 5.368 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1867835521697998
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.730 Vali Acc: 0.467 Test Loss: 5.730 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.396167516708374
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.073 Vali Acc: 0.467 Test Loss: 6.073 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4219119548797607
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.396 Vali Acc: 0.467 Test Loss: 6.396 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2732527256011963
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.701 Vali Acc: 0.467 Test Loss: 6.701 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.8023486137390137
Epoch: 1, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0940706729888916
Epoch: 2, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1586816310882568
Epoch: 3, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.008392572402954
Epoch: 4, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1415297985076904
Epoch: 5, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.177725076675415
Epoch: 6, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1537160873413086
Epoch: 7, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.328 Vali Acc: 0.267 Test Loss: 1.328 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0371184349060059
Epoch: 8, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.547 Vali Acc: 0.333 Test Loss: 1.547 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.043485164642334
Epoch: 9, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.809 Vali Acc: 0.333 Test Loss: 1.809 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0865039825439453
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.098 Vali Acc: 0.333 Test Loss: 2.098 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0237090587615967
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.400 Vali Acc: 0.333 Test Loss: 2.400 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5414083003997803
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.0363080501556396
Epoch: 2, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9395110607147217
Epoch: 3, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0076136589050293
Epoch: 4, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9655942916870117
Epoch: 5, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.8599209785461426
Epoch: 6, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.312 Vali Acc: 0.267 Test Loss: 1.312 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9471704959869385
Epoch: 7, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.441 Vali Acc: 0.333 Test Loss: 1.441 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9764137268066406
Epoch: 8, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.650 Vali Acc: 0.267 Test Loss: 1.650 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9686896800994873
Epoch: 9, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.949 Vali Acc: 0.267 Test Loss: 1.949 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9864435195922852
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.291 Vali Acc: 0.333 Test Loss: 2.291 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0385370254516602
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.650 Vali Acc: 0.400 Test Loss: 2.650 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0302233695983887
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.016 Vali Acc: 0.400 Test Loss: 3.016 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7731859683990479
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.379 Vali Acc: 0.467 Test Loss: 3.379 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466633).  Saving model ...
Epoch: 14 cost time: 0.9482076168060303
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.735 Vali Acc: 0.467 Test Loss: 3.735 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9680337905883789
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.080 Vali Acc: 0.467 Test Loss: 4.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0626096725463867
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.411 Vali Acc: 0.467 Test Loss: 4.411 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0165295600891113
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.728 Vali Acc: 0.467 Test Loss: 4.728 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0268025398254395
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.031 Vali Acc: 0.467 Test Loss: 5.031 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.983912467956543
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.318 Vali Acc: 0.467 Test Loss: 5.318 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0162932872772217
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.590 Vali Acc: 0.467 Test Loss: 5.590 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9271860122680664
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.847 Vali Acc: 0.467 Test Loss: 5.847 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8719172477722168
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.089 Vali Acc: 0.467 Test Loss: 6.089 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9141373634338379
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 6.316 Vali Acc: 0.467 Test Loss: 6.316 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.425145149230957
Epoch: 1, Steps: 1 | Train Loss: 1.269 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.8694539070129395
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8035731315612793
Epoch: 3, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.691864013671875
Epoch: 4, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8796613216400146
Epoch: 5, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9421443939208984
Epoch: 6, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9977600574493408
Epoch: 7, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8110044002532959
Epoch: 8, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.875244140625
Epoch: 9, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9306683540344238
Epoch: 10, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7716245651245117
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.333 Test Loss: 1.387 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8916170597076416
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.400 Test Loss: 1.535 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7160305976867676
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.692 Vali Acc: 0.400 Test Loss: 1.692 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9519894123077393
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.400 Test Loss: 1.852 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.774901866912842
Epoch: 1, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9258484840393066
Epoch: 2, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8271448612213135
Epoch: 3, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8493514060974121
Epoch: 4, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8885762691497803
Epoch: 5, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8761661052703857
Epoch: 6, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.8745818138122559
Epoch: 7, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.9306519031524658
Epoch: 8, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.894873857498169
Epoch: 9, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.013 Vali Acc: 0.333 Test Loss: 1.013 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8815414905548096
Epoch: 10, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.125 Vali Acc: 0.533 Test Loss: 1.125 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.9143092632293701
Epoch: 11, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.352 Vali Acc: 0.467 Test Loss: 1.352 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9382081031799316
Epoch: 12, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.579 Vali Acc: 0.467 Test Loss: 1.579 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9093425273895264
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.467 Test Loss: 1.796 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9145965576171875
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.467 Test Loss: 2.003 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9437298774719238
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.467 Test Loss: 2.196 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9180681705474854
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.381 Vali Acc: 0.467 Test Loss: 2.381 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8175644874572754
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.557 Vali Acc: 0.467 Test Loss: 2.557 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.89900803565979
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.724 Vali Acc: 0.467 Test Loss: 2.724 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8856327533721924
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.883 Vali Acc: 0.467 Test Loss: 2.883 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9625129699707031
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.033 Vali Acc: 0.467 Test Loss: 3.033 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.574885845184326
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8547906875610352
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.7891783714294434
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8156614303588867
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.7162790298461914
Epoch: 5, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8082478046417236
Epoch: 6, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9031891822814941
Epoch: 7, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9859364032745361
Epoch: 8, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8943228721618652
Epoch: 9, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 10 cost time: 0.8826181888580322
Epoch: 10, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8462920188903809
Epoch: 11, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8265860080718994
Epoch: 12, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7677671909332275
Epoch: 13, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.729179859161377
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8166155815124512
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7313299179077148
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7232728004455566
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7522399425506592
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7377560138702393
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3636600971221924
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7406222820281982
Epoch: 2, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8252639770507812
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8558757305145264
Epoch: 4, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.9023911952972412
Epoch: 5, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8722348213195801
Epoch: 6, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8619952201843262
Epoch: 7, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7433254718780518
Epoch: 8, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8523807525634766
Epoch: 9, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9021809101104736
Epoch: 10, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8152651786804199
Epoch: 11, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.327 Vali Acc: 0.533 Test Loss: 1.327 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533320).  Saving model ...
Epoch: 12 cost time: 0.8359682559967041
Epoch: 12, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7083027362823486
Epoch: 13, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.529 Vali Acc: 0.467 Test Loss: 1.529 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7706263065338135
Epoch: 14, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.593 Vali Acc: 0.533 Test Loss: 1.593 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8916738033294678
Epoch: 15, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.607 Vali Acc: 0.600 Test Loss: 1.607 Test Acc: 0.600
Validation loss decreased (-0.533320 --> -0.599984).  Saving model ...
Epoch: 16 cost time: 0.7695331573486328
Epoch: 16, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.754 Vali Acc: 0.467 Test Loss: 1.754 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8956780433654785
Epoch: 17, Steps: 1 | Train Loss: 0.031 Vali Loss: 2.005 Vali Acc: 0.400 Test Loss: 2.005 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.827218770980835
Epoch: 18, Steps: 1 | Train Loss: 0.029 Vali Loss: 2.084 Vali Acc: 0.333 Test Loss: 2.084 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7719423770904541
Epoch: 19, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.069 Vali Acc: 0.400 Test Loss: 2.069 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8377487659454346
Epoch: 20, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.109 Vali Acc: 0.400 Test Loss: 2.109 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7436826229095459
Epoch: 21, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.239 Vali Acc: 0.533 Test Loss: 2.239 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.793560266494751
Epoch: 22, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.397 Vali Acc: 0.533 Test Loss: 2.397 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7968878746032715
Epoch: 23, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.552 Vali Acc: 0.400 Test Loss: 2.552 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.825810432434082
Epoch: 24, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.686 Vali Acc: 0.400 Test Loss: 2.686 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8178918361663818
Epoch: 25, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.801 Vali Acc: 0.400 Test Loss: 2.801 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 2409603
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5258796215057373
Epoch: 1, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 2.1230688095092773
Epoch: 2, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8002731800079346
Epoch: 3, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9191699028015137
Epoch: 4, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8341853618621826
Epoch: 5, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4320430755615234
Epoch: 6, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5824885368347168
Epoch: 7, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.676992654800415
Epoch: 8, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.378 Vali Acc: 0.467 Test Loss: 1.378 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466653).  Saving model ...
Epoch: 9 cost time: 2.429107904434204
Epoch: 9, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.698 Vali Acc: 0.467 Test Loss: 1.698 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8725316524505615
Epoch: 10, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.748 Vali Acc: 0.400 Test Loss: 1.748 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8322081565856934
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.809 Vali Acc: 0.267 Test Loss: 1.809 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.017561912536621
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.890 Vali Acc: 0.267 Test Loss: 1.890 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.046515703201294
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.989 Vali Acc: 0.333 Test Loss: 1.989 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.214293956756592
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.103 Vali Acc: 0.267 Test Loss: 2.103 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6420989036560059
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.227 Vali Acc: 0.267 Test Loss: 2.227 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8321852684020996
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.267 Test Loss: 2.355 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.163637161254883
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.483 Vali Acc: 0.267 Test Loss: 2.483 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0862936973571777
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.610 Vali Acc: 0.267 Test Loss: 2.610 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9596967697143555
Epoch: 1, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.8313770294189453
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.98356032371521
Epoch: 3, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.474726915359497
Epoch: 4, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.3564918041229248
Epoch: 5, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.8277273178100586
Epoch: 6, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9478623867034912
Epoch: 7, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6644079685211182
Epoch: 8, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.380 Vali Acc: 0.267 Test Loss: 1.380 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7849218845367432
Epoch: 9, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.647 Vali Acc: 0.200 Test Loss: 1.647 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5462017059326172
Epoch: 10, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.796 Vali Acc: 0.200 Test Loss: 1.796 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.014587879180908
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.972 Vali Acc: 0.133 Test Loss: 1.972 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8889033794403076
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.156 Vali Acc: 0.133 Test Loss: 2.156 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.821894884109497
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.342 Vali Acc: 0.133 Test Loss: 2.342 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4538507461547852
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.526 Vali Acc: 0.133 Test Loss: 2.526 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7189350128173828
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.707 Vali Acc: 0.133 Test Loss: 2.707 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.2465755939483643
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.5424764156341553
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4127106666564941
Epoch: 3, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.5149405002593994
Epoch: 4, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.8823676109313965
Epoch: 5, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.3634438514709473
Epoch: 6, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6576409339904785
Epoch: 7, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5820720195770264
Epoch: 8, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.294 Vali Acc: 0.467 Test Loss: 1.294 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466654).  Saving model ...
Epoch: 9 cost time: 1.7185745239257812
Epoch: 9, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.573 Vali Acc: 0.467 Test Loss: 1.573 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6379735469818115
Epoch: 10, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.782 Vali Acc: 0.400 Test Loss: 1.782 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.622441291809082
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.941 Vali Acc: 0.333 Test Loss: 1.941 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.489997148513794
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.070 Vali Acc: 0.400 Test Loss: 2.070 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6561365127563477
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.185 Vali Acc: 0.467 Test Loss: 2.185 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6698389053344727
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.296 Vali Acc: 0.467 Test Loss: 2.296 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.478813886642456
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.407 Vali Acc: 0.467 Test Loss: 2.407 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3510053157806396
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.467 Test Loss: 2.516 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2956230640411377
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.623 Vali Acc: 0.467 Test Loss: 2.623 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5545141696929932
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.726 Vali Acc: 0.467 Test Loss: 2.726 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4602110385894775
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.008934497833252
Epoch: 2, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.914313793182373
Epoch: 3, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8793497085571289
Epoch: 4, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1020090579986572
Epoch: 5, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.129056453704834
Epoch: 6, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1314737796783447
Epoch: 7, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.262 Vali Acc: 0.400 Test Loss: 1.262 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2603981494903564
Epoch: 8, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.529 Vali Acc: 0.467 Test Loss: 1.529 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466651).  Saving model ...
Epoch: 9 cost time: 1.165156364440918
Epoch: 9, Steps: 1 | Train Loss: 0.038 Vali Loss: 2.000 Vali Acc: 0.467 Test Loss: 2.000 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0510900020599365
Epoch: 10, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.413 Vali Acc: 0.333 Test Loss: 2.413 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1719095706939697
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.751 Vali Acc: 0.467 Test Loss: 2.751 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.325138807296753
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.062 Vali Acc: 0.467 Test Loss: 3.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1439998149871826
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.362 Vali Acc: 0.467 Test Loss: 3.362 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.034449577331543
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.654 Vali Acc: 0.467 Test Loss: 3.654 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4453725814819336
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.939 Vali Acc: 0.467 Test Loss: 3.939 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3631501197814941
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.214 Vali Acc: 0.467 Test Loss: 4.214 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2104251384735107
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.479 Vali Acc: 0.467 Test Loss: 4.479 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2079768180847168
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.731 Vali Acc: 0.467 Test Loss: 4.731 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.684032917022705
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0605568885803223
Epoch: 2, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9072823524475098
Epoch: 3, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9068105220794678
Epoch: 4, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9972090721130371
Epoch: 5, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9003088474273682
Epoch: 6, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9495067596435547
Epoch: 7, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0134713649749756
Epoch: 8, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.564 Vali Acc: 0.400 Test Loss: 1.564 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0744476318359375
Epoch: 9, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.849 Vali Acc: 0.400 Test Loss: 1.849 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0753707885742188
Epoch: 10, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.136 Vali Acc: 0.400 Test Loss: 2.136 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9314954280853271
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.432 Vali Acc: 0.400 Test Loss: 2.432 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3453969955444336
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.8668053150177002
Epoch: 2, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7590920925140381
Epoch: 3, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.278 Vali Acc: 0.267 Test Loss: 1.278 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7768833637237549
Epoch: 4, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9029526710510254
Epoch: 5, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9118225574493408
Epoch: 6, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.417 Vali Acc: 0.267 Test Loss: 1.417 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9621062278747559
Epoch: 7, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.546 Vali Acc: 0.267 Test Loss: 1.546 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8473658561706543
Epoch: 8, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.802 Vali Acc: 0.467 Test Loss: 1.802 Test Acc: 0.467
Validation loss decreased (-0.266654 --> -0.466649).  Saving model ...
Epoch: 9 cost time: 0.7989048957824707
Epoch: 9, Steps: 1 | Train Loss: 0.017 Vali Loss: 2.145 Vali Acc: 0.467 Test Loss: 2.145 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9299867153167725
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.501 Vali Acc: 0.533 Test Loss: 2.501 Test Acc: 0.533
Validation loss decreased (-0.466649 --> -0.533308).  Saving model ...
Epoch: 11 cost time: 0.8569130897521973
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.870 Vali Acc: 0.533 Test Loss: 2.870 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0500705242156982
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.240 Vali Acc: 0.533 Test Loss: 3.240 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.84761643409729
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.606 Vali Acc: 0.400 Test Loss: 3.606 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.870957612991333
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.962 Vali Acc: 0.333 Test Loss: 3.962 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.799309253692627
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.306 Vali Acc: 0.333 Test Loss: 4.306 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.896904706954956
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.637 Vali Acc: 0.333 Test Loss: 4.637 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6890342235565186
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.952 Vali Acc: 0.333 Test Loss: 4.952 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6173264980316162
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.253 Vali Acc: 0.333 Test Loss: 5.253 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9008975028991699
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.537 Vali Acc: 0.333 Test Loss: 5.537 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8377060890197754
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 5.806 Vali Acc: 0.333 Test Loss: 5.806 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0941338539123535
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.6761617660522461
Epoch: 2, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.730823278427124
Epoch: 3, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6876811981201172
Epoch: 4, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6948273181915283
Epoch: 5, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.914482593536377
Epoch: 6, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8671822547912598
Epoch: 7, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8633980751037598
Epoch: 8, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8133730888366699
Epoch: 9, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7384369373321533
Epoch: 10, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8628592491149902
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.471 Vali Acc: 0.400 Test Loss: 1.471 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5241072177886963
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8571817874908447
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8987619876861572
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8798651695251465
Epoch: 4, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8666708469390869
Epoch: 5, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8591508865356445
Epoch: 6, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.8603086471557617
Epoch: 7, Steps: 1 | Train Loss: 0.421 Vali Loss: 0.999 Vali Acc: 0.533 Test Loss: 0.999 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.9021093845367432
Epoch: 8, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8715369701385498
Epoch: 9, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9905786514282227
Epoch: 10, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.216 Vali Acc: 0.467 Test Loss: 1.216 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8896973133087158
Epoch: 11, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.253 Vali Acc: 0.467 Test Loss: 1.253 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8473432064056396
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.274 Vali Acc: 0.467 Test Loss: 1.274 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.798926830291748
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.467 Test Loss: 1.292 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8681590557098389
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.467 Test Loss: 1.315 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8530778884887695
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.533 Test Loss: 1.340 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8800368309020996
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.367 Vali Acc: 0.533 Test Loss: 1.367 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9428372383117676
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.533 Test Loss: 1.394 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.442713975906372
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8197872638702393
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.774430513381958
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7794201374053955
Epoch: 4, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.8573803901672363
Epoch: 5, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.84293532371521
Epoch: 6, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7367911338806152
Epoch: 7, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7822723388671875
Epoch: 8, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8232085704803467
Epoch: 9, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7274713516235352
Epoch: 10, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8444952964782715
Epoch: 11, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8353066444396973
Epoch: 12, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8441605567932129
Epoch: 13, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8212921619415283
Epoch: 14, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.360 Vali Acc: 0.467 Test Loss: 1.360 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7967708110809326
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.595 Vali Acc: 0.467 Test Loss: 1.595 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2896947860717773
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6516964435577393
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6705942153930664
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.781376838684082
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6402883529663086
Epoch: 5, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6844983100891113
Epoch: 6, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6044440269470215
Epoch: 7, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6257936954498291
Epoch: 8, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7355377674102783
Epoch: 9, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7609784603118896
Epoch: 10, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.389 Vali Acc: 0.333 Test Loss: 1.389 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7594394683837891
Epoch: 11, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.773169994354248
Epoch: 12, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.738811731338501
Epoch: 13, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.468 Vali Acc: 0.533 Test Loss: 1.468 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533319).  Saving model ...
Epoch: 14 cost time: 0.7585749626159668
Epoch: 14, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.560 Vali Acc: 0.533 Test Loss: 1.560 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7877144813537598
Epoch: 15, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.788 Vali Acc: 0.400 Test Loss: 1.788 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.788386344909668
Epoch: 16, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.827 Vali Acc: 0.400 Test Loss: 1.827 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7224714756011963
Epoch: 17, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.818 Vali Acc: 0.467 Test Loss: 1.818 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8092529773712158
Epoch: 18, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.925 Vali Acc: 0.467 Test Loss: 1.925 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7202897071838379
Epoch: 19, Steps: 1 | Train Loss: 0.012 Vali Loss: 2.206 Vali Acc: 0.400 Test Loss: 2.206 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6039137840270996
Epoch: 20, Steps: 1 | Train Loss: 0.007 Vali Loss: 2.533 Vali Acc: 0.333 Test Loss: 2.533 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6389758586883545
Epoch: 21, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.777 Vali Acc: 0.400 Test Loss: 2.777 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8858315944671631
Epoch: 22, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.912 Vali Acc: 0.400 Test Loss: 2.912 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7426557540893555
Epoch: 23, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.955 Vali Acc: 0.400 Test Loss: 2.955 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2016387
model size : 12.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.5675039291381836
Epoch: 1, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.0626282691955566
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8706028461456299
Epoch: 3, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.8486511707305908
Epoch: 4, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2886905670166016
Epoch: 5, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7967009544372559
Epoch: 6, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.551243782043457
Epoch: 7, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.02272367477417
Epoch: 8, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.324 Vali Acc: 0.467 Test Loss: 1.324 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 9 cost time: 2.1621899604797363
Epoch: 9, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.448 Vali Acc: 0.400 Test Loss: 1.448 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8054478168487549
Epoch: 10, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.703 Vali Acc: 0.400 Test Loss: 1.703 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.930879831314087
Epoch: 11, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.023 Vali Acc: 0.267 Test Loss: 2.023 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9900095462799072
Epoch: 12, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.270 Vali Acc: 0.267 Test Loss: 2.270 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4427149295806885
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.453 Vali Acc: 0.200 Test Loss: 2.453 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7657477855682373
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.610 Vali Acc: 0.267 Test Loss: 2.610 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6407208442687988
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.762 Vali Acc: 0.333 Test Loss: 2.762 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.023137331008911
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.912 Vali Acc: 0.333 Test Loss: 2.912 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.984557867050171
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.060 Vali Acc: 0.333 Test Loss: 3.060 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5247802734375
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.206 Vali Acc: 0.333 Test Loss: 3.206 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.1979353427886963
Epoch: 1, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.881490707397461
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.5970849990844727
Epoch: 3, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.4662742614746094
Epoch: 4, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.883331060409546
Epoch: 5, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.569366455078125
Epoch: 6, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4361255168914795
Epoch: 7, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7971251010894775
Epoch: 8, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.320 Vali Acc: 0.200 Test Loss: 1.320 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7697629928588867
Epoch: 9, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.474 Vali Acc: 0.200 Test Loss: 1.474 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7403819561004639
Epoch: 10, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.750 Vali Acc: 0.267 Test Loss: 1.750 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.225663661956787
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.108 Vali Acc: 0.267 Test Loss: 2.108 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5817832946777344
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.412 Vali Acc: 0.267 Test Loss: 2.412 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4136524200439453
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.658 Vali Acc: 0.267 Test Loss: 2.658 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5479700565338135
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.875 Vali Acc: 0.267 Test Loss: 2.875 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.226280689239502
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.4691097736358643
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 1.532294511795044
Epoch: 3, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.5642890930175781
Epoch: 4, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5214512348175049
Epoch: 5, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.3769457340240479
Epoch: 6, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3130829334259033
Epoch: 7, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6980538368225098
Epoch: 8, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.233 Vali Acc: 0.467 Test Loss: 1.233 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7945878505706787
Epoch: 9, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.331 Vali Acc: 0.467 Test Loss: 1.331 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5649726390838623
Epoch: 10, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.653 Vali Acc: 0.400 Test Loss: 1.653 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5860819816589355
Epoch: 11, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.021 Vali Acc: 0.333 Test Loss: 2.021 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7649712562561035
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.302 Vali Acc: 0.333 Test Loss: 2.302 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5948588848114014
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.505 Vali Acc: 0.333 Test Loss: 2.505 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6122856140136719
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.678 Vali Acc: 0.333 Test Loss: 2.678 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4997408390045166
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.839 Vali Acc: 0.333 Test Loss: 2.839 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9355456829071045
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 1.0189404487609863
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1971921920776367
Epoch: 3, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4109256267547607
Epoch: 4, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 1.3250062465667725
Epoch: 5, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.1754124164581299
Epoch: 6, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2996132373809814
Epoch: 7, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2837915420532227
Epoch: 8, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.460 Vali Acc: 0.467 Test Loss: 1.460 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466652).  Saving model ...
Epoch: 9 cost time: 1.2179875373840332
Epoch: 9, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.860 Vali Acc: 0.467 Test Loss: 1.860 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2341513633728027
Epoch: 10, Steps: 1 | Train Loss: 0.014 Vali Loss: 2.225 Vali Acc: 0.467 Test Loss: 2.225 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1144237518310547
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.612 Vali Acc: 0.400 Test Loss: 2.612 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2924375534057617
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.990 Vali Acc: 0.400 Test Loss: 2.990 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.275566816329956
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.350 Vali Acc: 0.400 Test Loss: 3.350 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2604782581329346
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.693 Vali Acc: 0.400 Test Loss: 3.693 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2597744464874268
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.022 Vali Acc: 0.400 Test Loss: 4.022 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1266331672668457
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.335 Vali Acc: 0.400 Test Loss: 4.335 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.125894546508789
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.400 Test Loss: 4.634 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3456730842590332
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.918 Vali Acc: 0.400 Test Loss: 4.918 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.138716459274292
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8941528797149658
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.0147390365600586
Epoch: 3, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9953145980834961
Epoch: 4, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9752645492553711
Epoch: 5, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.0380704402923584
Epoch: 6, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0245842933654785
Epoch: 7, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.258 Vali Acc: 0.400 Test Loss: 1.258 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9635627269744873
Epoch: 8, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.472 Vali Acc: 0.333 Test Loss: 1.472 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0466206073760986
Epoch: 9, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.707 Vali Acc: 0.333 Test Loss: 1.707 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0134310722351074
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.975 Vali Acc: 0.400 Test Loss: 1.975 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0624346733093262
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.262 Vali Acc: 0.400 Test Loss: 2.262 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0836424827575684
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.555 Vali Acc: 0.333 Test Loss: 2.555 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.033360242843628
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.846 Vali Acc: 0.333 Test Loss: 2.846 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8892307281494141
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.132 Vali Acc: 0.333 Test Loss: 3.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9229023456573486
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.410 Vali Acc: 0.333 Test Loss: 3.410 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.445592164993286
Epoch: 1, Steps: 1 | Train Loss: 1.255 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.9482853412628174
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9812178611755371
Epoch: 3, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.224 Vali Acc: 0.133 Test Loss: 1.224 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8961031436920166
Epoch: 4, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9181909561157227
Epoch: 5, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8945319652557373
Epoch: 6, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.314 Vali Acc: 0.333 Test Loss: 1.314 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.835411548614502
Epoch: 7, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.457 Vali Acc: 0.267 Test Loss: 1.457 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.935025691986084
Epoch: 8, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.711 Vali Acc: 0.267 Test Loss: 1.711 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9656972885131836
Epoch: 9, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.980 Vali Acc: 0.333 Test Loss: 1.980 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8731305599212646
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.269 Vali Acc: 0.333 Test Loss: 2.269 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8693726062774658
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.579 Vali Acc: 0.333 Test Loss: 2.579 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6078691482543945
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7278411388397217
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7814443111419678
Epoch: 3, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.8615996837615967
Epoch: 4, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8981654644012451
Epoch: 5, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.879150390625
Epoch: 6, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8169879913330078
Epoch: 7, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9313268661499023
Epoch: 8, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8267652988433838
Epoch: 9, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9241602420806885
Epoch: 10, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.288 Vali Acc: 0.467 Test Loss: 1.288 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8393979072570801
Epoch: 11, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.303 Vali Acc: 0.533 Test Loss: 1.303 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533320).  Saving model ...
Epoch: 12 cost time: 0.7843475341796875
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.533 Test Loss: 1.333 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8673112392425537
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.372 Vali Acc: 0.533 Test Loss: 1.372 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8200392723083496
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.533 Test Loss: 1.417 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7346372604370117
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.467 Test Loss: 1.467 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7669775485992432
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.467 Test Loss: 1.519 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8031072616577148
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.467 Test Loss: 1.573 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7568418979644775
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.467 Test Loss: 1.627 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.841233491897583
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.467 Test Loss: 1.680 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8402321338653564
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.733 Vali Acc: 0.467 Test Loss: 1.733 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7640402317047119
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.783 Vali Acc: 0.467 Test Loss: 1.783 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.368109703063965
Epoch: 1, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6846144199371338
Epoch: 2, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.7831554412841797
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7849330902099609
Epoch: 4, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7306408882141113
Epoch: 5, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8292529582977295
Epoch: 6, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7922003269195557
Epoch: 7, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7042136192321777
Epoch: 8, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7399866580963135
Epoch: 9, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7141323089599609
Epoch: 10, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7348818778991699
Epoch: 11, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7049598693847656
Epoch: 12, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.44114089012146
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7199833393096924
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7282912731170654
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.7587149143218994
Epoch: 4, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.776547908782959
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7744457721710205
Epoch: 6, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7918665409088135
Epoch: 7, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.804473876953125
Epoch: 8, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.7932448387145996
Epoch: 9, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7757306098937988
Epoch: 10, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8139183521270752
Epoch: 11, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8248875141143799
Epoch: 12, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7230908870697021
Epoch: 13, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8184559345245361
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.256 Vali Acc: 0.467 Test Loss: 1.256 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7580161094665527
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.344 Vali Acc: 0.467 Test Loss: 1.344 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.91690993309021
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.439 Vali Acc: 0.467 Test Loss: 1.439 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.869896411895752
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.467 Test Loss: 1.529 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8965468406677246
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.467 Test Loss: 1.614 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6513986587524414
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.816730260848999
Epoch: 2, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8270766735076904
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.9177606105804443
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8197219371795654
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7682623863220215
Epoch: 6, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.822739839553833
Epoch: 7, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8990554809570312
Epoch: 8, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7767333984375
Epoch: 9, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7864408493041992
Epoch: 10, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.205 Vali Acc: 0.533 Test Loss: 1.205 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533321).  Saving model ...
Epoch: 11 cost time: 0.7904655933380127
Epoch: 11, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.322 Vali Acc: 0.467 Test Loss: 1.322 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7997660636901855
Epoch: 12, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.489 Vali Acc: 0.467 Test Loss: 1.489 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7344310283660889
Epoch: 13, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.595 Vali Acc: 0.467 Test Loss: 1.595 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7820930480957031
Epoch: 14, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.610 Vali Acc: 0.533 Test Loss: 1.610 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.735917329788208
Epoch: 15, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.637 Vali Acc: 0.533 Test Loss: 1.637 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7835874557495117
Epoch: 16, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.845 Vali Acc: 0.400 Test Loss: 1.845 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7831709384918213
Epoch: 17, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.903 Vali Acc: 0.400 Test Loss: 1.903 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.699455738067627
Epoch: 18, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.965 Vali Acc: 0.400 Test Loss: 1.965 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8261687755584717
Epoch: 19, Steps: 1 | Train Loss: 0.010 Vali Loss: 2.064 Vali Acc: 0.400 Test Loss: 2.064 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8119900226593018
Epoch: 20, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.196 Vali Acc: 0.400 Test Loss: 2.196 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1819779
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.61763858795166
Epoch: 1, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.9882628917694092
Epoch: 2, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1805007457733154
Epoch: 3, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.984762191772461
Epoch: 4, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 2.0419816970825195
Epoch: 5, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7889163494110107
Epoch: 6, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6816449165344238
Epoch: 7, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1280593872070312
Epoch: 8, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.031764268875122
Epoch: 9, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.683 Vali Acc: 0.533 Test Loss: 1.683 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7577075958251953
Epoch: 10, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.738 Vali Acc: 0.400 Test Loss: 1.738 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7742724418640137
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.817 Vali Acc: 0.333 Test Loss: 1.817 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.619697093963623
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.946 Vali Acc: 0.333 Test Loss: 1.946 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8417518138885498
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.105 Vali Acc: 0.333 Test Loss: 2.105 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8064181804656982
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.273 Vali Acc: 0.333 Test Loss: 2.273 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.073690176010132
Epoch: 1, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 1.8697419166564941
Epoch: 2, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7760279178619385
Epoch: 3, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 1.42136812210083
Epoch: 4, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4586670398712158
Epoch: 5, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.356173038482666
Epoch: 6, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.371598243713379
Epoch: 7, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2941839694976807
Epoch: 8, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.350 Vali Acc: 0.200 Test Loss: 1.350 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2502679824829102
Epoch: 9, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.719 Vali Acc: 0.267 Test Loss: 1.719 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6816329956054688
Epoch: 10, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.960 Vali Acc: 0.200 Test Loss: 1.960 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9969260692596436
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.173 Vali Acc: 0.267 Test Loss: 2.173 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.950598955154419
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.396 Vali Acc: 0.200 Test Loss: 2.396 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.551292896270752
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.628 Vali Acc: 0.200 Test Loss: 2.628 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.844740629196167
Epoch: 1, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.2374749183654785
Epoch: 2, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6380524635314941
Epoch: 3, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5728390216827393
Epoch: 4, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3298802375793457
Epoch: 5, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 1.5065126419067383
Epoch: 6, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.6511733531951904
Epoch: 7, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.317826747894287
Epoch: 8, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.358 Vali Acc: 0.467 Test Loss: 1.358 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466653).  Saving model ...
Epoch: 9 cost time: 1.2800116539001465
Epoch: 9, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.551 Vali Acc: 0.467 Test Loss: 1.551 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4631562232971191
Epoch: 10, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.617 Vali Acc: 0.467 Test Loss: 1.617 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2879469394683838
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.700 Vali Acc: 0.467 Test Loss: 1.700 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6409928798675537
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.400 Test Loss: 1.807 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6623225212097168
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.333 Test Loss: 1.930 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5946040153503418
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.333 Test Loss: 2.056 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2148516178131104
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.184 Vali Acc: 0.333 Test Loss: 2.184 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3744642734527588
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.309 Vali Acc: 0.267 Test Loss: 2.309 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4422671794891357
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.432 Vali Acc: 0.267 Test Loss: 2.432 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5772967338562012
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.267 Test Loss: 2.549 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.626391887664795
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.193615436553955
Epoch: 2, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.3525245189666748
Epoch: 3, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.329941749572754
Epoch: 4, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.273247480392456
Epoch: 5, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2992396354675293
Epoch: 6, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.142716884613037
Epoch: 7, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.276 Vali Acc: 0.533 Test Loss: 1.276 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9897286891937256
Epoch: 8, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.603 Vali Acc: 0.467 Test Loss: 1.603 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2729332447052002
Epoch: 9, Steps: 1 | Train Loss: 0.030 Vali Loss: 2.034 Vali Acc: 0.467 Test Loss: 2.034 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2759346961975098
Epoch: 10, Steps: 1 | Train Loss: 0.010 Vali Loss: 2.411 Vali Acc: 0.467 Test Loss: 2.411 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2967090606689453
Epoch: 11, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.770 Vali Acc: 0.467 Test Loss: 2.770 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.246800184249878
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 3.126 Vali Acc: 0.467 Test Loss: 3.126 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.288778305053711
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.476 Vali Acc: 0.400 Test Loss: 3.476 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1987049579620361
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.818 Vali Acc: 0.400 Test Loss: 3.818 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.191772222518921
Epoch: 1, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8310134410858154
Epoch: 2, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8503904342651367
Epoch: 3, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9137461185455322
Epoch: 4, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9480326175689697
Epoch: 5, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9165267944335938
Epoch: 6, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9067642688751221
Epoch: 7, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.423 Vali Acc: 0.267 Test Loss: 1.423 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9643809795379639
Epoch: 8, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.648 Vali Acc: 0.333 Test Loss: 1.648 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.120929479598999
Epoch: 9, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.929 Vali Acc: 0.333 Test Loss: 1.929 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0499706268310547
Epoch: 10, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.226 Vali Acc: 0.267 Test Loss: 2.226 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.014693260192871
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.526 Vali Acc: 0.267 Test Loss: 2.526 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.691089391708374
Epoch: 1, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9068090915679932
Epoch: 2, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9573085308074951
Epoch: 3, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8704595565795898
Epoch: 4, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9126596450805664
Epoch: 5, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8785891532897949
Epoch: 6, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9355175495147705
Epoch: 7, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8592565059661865
Epoch: 8, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.582 Vali Acc: 0.467 Test Loss: 1.582 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8744971752166748
Epoch: 9, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.883 Vali Acc: 0.467 Test Loss: 1.883 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7214879989624023
Epoch: 10, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.222 Vali Acc: 0.467 Test Loss: 2.222 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8653326034545898
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.576 Vali Acc: 0.467 Test Loss: 2.576 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.363842248916626
Epoch: 1, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7389943599700928
Epoch: 2, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8374645709991455
Epoch: 3, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8292045593261719
Epoch: 4, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8799271583557129
Epoch: 5, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8613924980163574
Epoch: 6, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.9059159755706787
Epoch: 7, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.865966796875
Epoch: 8, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8509840965270996
Epoch: 9, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9214317798614502
Epoch: 10, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7747983932495117
Epoch: 11, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.333 Test Loss: 1.422 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9033541679382324
Epoch: 12, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.333 Test Loss: 1.530 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.835087776184082
Epoch: 13, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.400 Test Loss: 1.640 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8761143684387207
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.400 Test Loss: 1.750 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8987760543823242
Epoch: 15, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.400 Test Loss: 1.858 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9558522701263428
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.400 Test Loss: 1.963 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6108665466308594
Epoch: 1, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.007 Vali Acc: 0.533 Test Loss: 1.007 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.8101699352264404
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 0.993 Vali Acc: 0.600 Test Loss: 0.993 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.8306500911712646
Epoch: 3, Steps: 1 | Train Loss: 0.943 Vali Loss: 0.980 Vali Acc: 0.600 Test Loss: 0.980 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.8685398101806641
Epoch: 4, Steps: 1 | Train Loss: 0.795 Vali Loss: 0.973 Vali Acc: 0.600 Test Loss: 0.973 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.8540141582489014
Epoch: 5, Steps: 1 | Train Loss: 0.743 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8523991107940674
Epoch: 6, Steps: 1 | Train Loss: 0.604 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9422075748443604
Epoch: 7, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7225713729858398
Epoch: 8, Steps: 1 | Train Loss: 0.172 Vali Loss: 0.971 Vali Acc: 0.533 Test Loss: 0.971 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8869578838348389
Epoch: 9, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.77736496925354
Epoch: 10, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8495676517486572
Epoch: 11, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8866596221923828
Epoch: 12, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.280 Vali Acc: 0.467 Test Loss: 1.280 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8582053184509277
Epoch: 13, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9103295803070068
Epoch: 14, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.400 Test Loss: 1.493 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.32361102104187
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7178287506103516
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7905023097991943
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6956841945648193
Epoch: 4, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7526793479919434
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7852082252502441
Epoch: 6, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7629365921020508
Epoch: 7, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.8333892822265625
Epoch: 8, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.73447585105896
Epoch: 9, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.787773609161377
Epoch: 10, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7810559272766113
Epoch: 11, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7896926403045654
Epoch: 12, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.259 Vali Acc: 0.467 Test Loss: 1.259 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7806611061096191
Epoch: 13, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.317 Vali Acc: 0.467 Test Loss: 1.317 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6759865283966064
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.353 Vali Acc: 0.467 Test Loss: 1.353 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7147550582885742
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.393 Vali Acc: 0.467 Test Loss: 1.393 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6918199062347412
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.436 Vali Acc: 0.467 Test Loss: 1.436 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6967184543609619
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.467 Test Loss: 1.480 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7048280239105225
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.467 Test Loss: 1.526 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7205488681793213
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.036 Vali Acc: 0.667 Test Loss: 1.036 Test Acc: 0.667
Validation loss decreased (inf --> -0.666656).  Saving model ...
Epoch: 2 cost time: 0.8150606155395508
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8308155536651611
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8822777271270752
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8387837409973145
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.042 Vali Acc: 0.333 Test Loss: 1.042 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.881507396697998
Epoch: 6, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7918691635131836
Epoch: 7, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8686690330505371
Epoch: 8, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7409675121307373
Epoch: 9, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6970419883728027
Epoch: 10, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.391 Vali Acc: 0.400 Test Loss: 1.391 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7077000141143799
Epoch: 11, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.355 Vali Acc: 0.467 Test Loss: 1.355 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 1721475
model size : 11.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.338460922241211
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.62062406539917
Epoch: 2, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.535628318786621
Epoch: 3, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5301058292388916
Epoch: 4, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.5320641994476318
Epoch: 5, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 1.1929881572723389
Epoch: 6, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.2920136451721191
Epoch: 7, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4430584907531738
Epoch: 8, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1537411212921143
Epoch: 9, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0237455368041992
Epoch: 10, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.289 Vali Acc: 0.533 Test Loss: 1.289 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533320).  Saving model ...
Epoch: 11 cost time: 0.9960098266601562
Epoch: 11, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.372 Vali Acc: 0.533 Test Loss: 1.372 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0555822849273682
Epoch: 12, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.400 Vali Acc: 0.467 Test Loss: 1.400 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.071913480758667
Epoch: 13, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.449 Vali Acc: 0.333 Test Loss: 1.449 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.190256118774414
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.509 Vali Acc: 0.333 Test Loss: 1.509 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.29306960105896
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.600 Vali Acc: 0.333 Test Loss: 1.600 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6630456447601318
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.333 Test Loss: 1.702 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5469169616699219
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.810 Vali Acc: 0.333 Test Loss: 1.810 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4175047874450684
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.333 Test Loss: 1.919 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4223887920379639
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.028 Vali Acc: 0.333 Test Loss: 2.028 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.411360502243042
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.134 Vali Acc: 0.400 Test Loss: 2.134 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.115589141845703
Epoch: 1, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.304480791091919
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.3208582401275635
Epoch: 3, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.305884838104248
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2383861541748047
Epoch: 5, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.193 Vali Acc: 0.467 Test Loss: 1.193 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 1.340233564376831
Epoch: 6, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2701449394226074
Epoch: 7, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.258561134338379
Epoch: 8, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3584587574005127
Epoch: 9, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3345646858215332
Epoch: 10, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.343 Vali Acc: 0.267 Test Loss: 1.343 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2854766845703125
Epoch: 11, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.432 Vali Acc: 0.267 Test Loss: 1.432 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4050984382629395
Epoch: 12, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.476 Vali Acc: 0.333 Test Loss: 1.476 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.425180196762085
Epoch: 13, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.539 Vali Acc: 0.333 Test Loss: 1.539 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0801398754119873
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.607 Vali Acc: 0.333 Test Loss: 1.607 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1305859088897705
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.691 Vali Acc: 0.333 Test Loss: 1.691 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.9167449474334717
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.2563166618347168
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.2571580410003662
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3304352760314941
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3792195320129395
Epoch: 5, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.058936357498169
Epoch: 6, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.2423522472381592
Epoch: 7, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.2123680114746094
Epoch: 8, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 1.2836940288543701
Epoch: 9, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3337304592132568
Epoch: 10, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.281 Vali Acc: 0.467 Test Loss: 1.281 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2445337772369385
Epoch: 11, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.360 Vali Acc: 0.467 Test Loss: 1.360 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3187925815582275
Epoch: 12, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.346 Vali Acc: 0.400 Test Loss: 1.346 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1544373035430908
Epoch: 13, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.245511531829834
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.330 Vali Acc: 0.400 Test Loss: 1.330 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.194821834564209
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4204926490783691
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.391 Vali Acc: 0.400 Test Loss: 1.391 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2514634132385254
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.437 Vali Acc: 0.467 Test Loss: 1.437 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2081184387207031
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.467 Test Loss: 1.489 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5421102046966553
Epoch: 1, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.081761121749878
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.2977430820465088
Epoch: 3, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.1049714088439941
Epoch: 4, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.205 Vali Acc: 0.467 Test Loss: 1.205 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9846198558807373
Epoch: 5, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.205 Vali Acc: 0.467 Test Loss: 1.205 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2329297065734863
Epoch: 6, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 1.2005345821380615
Epoch: 7, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0951189994812012
Epoch: 8, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0276482105255127
Epoch: 9, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9965970516204834
Epoch: 10, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.463 Vali Acc: 0.467 Test Loss: 1.463 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2586045265197754
Epoch: 11, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.686 Vali Acc: 0.400 Test Loss: 1.686 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2194898128509521
Epoch: 12, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.879 Vali Acc: 0.400 Test Loss: 1.879 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.072892665863037
Epoch: 13, Steps: 1 | Train Loss: 0.011 Vali Loss: 2.045 Vali Acc: 0.400 Test Loss: 2.045 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.243964433670044
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.197 Vali Acc: 0.467 Test Loss: 2.197 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.149519443511963
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.356 Vali Acc: 0.467 Test Loss: 2.356 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1260595321655273
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.515 Vali Acc: 0.467 Test Loss: 2.515 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7397544384002686
Epoch: 1, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.986762523651123
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9361164569854736
Epoch: 3, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.099320411682129
Epoch: 4, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0057826042175293
Epoch: 5, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9216945171356201
Epoch: 6, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9062268733978271
Epoch: 7, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8791227340698242
Epoch: 8, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.337 Vali Acc: 0.267 Test Loss: 1.337 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9603869915008545
Epoch: 9, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.454 Vali Acc: 0.267 Test Loss: 1.454 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9386656284332275
Epoch: 10, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.630 Vali Acc: 0.333 Test Loss: 1.630 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9011666774749756
Epoch: 11, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.824 Vali Acc: 0.400 Test Loss: 1.824 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3090076446533203
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.729017972946167
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.8425242900848389
Epoch: 3, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.696721076965332
Epoch: 4, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7706341743469238
Epoch: 5, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7524182796478271
Epoch: 6, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8990554809570312
Epoch: 7, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9277129173278809
Epoch: 8, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9238615036010742
Epoch: 9, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9066393375396729
Epoch: 10, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.463 Vali Acc: 0.467 Test Loss: 1.463 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9856579303741455
Epoch: 11, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.647 Vali Acc: 0.467 Test Loss: 1.647 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8251910209655762
Epoch: 12, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.834 Vali Acc: 0.467 Test Loss: 1.834 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7086257934570312
Epoch: 1, Steps: 1 | Train Loss: 1.286 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8952312469482422
Epoch: 2, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8474228382110596
Epoch: 3, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9561653137207031
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9785566329956055
Epoch: 5, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9664855003356934
Epoch: 6, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 1.0007319450378418
Epoch: 7, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.9837758541107178
Epoch: 8, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.9332942962646484
Epoch: 9, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7765243053436279
Epoch: 10, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9145808219909668
Epoch: 11, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.189 Vali Acc: 0.467 Test Loss: 1.189 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.9335205554962158
Epoch: 12, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9243307113647461
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.95263671875
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9387788772583008
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.333 Test Loss: 1.317 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.944155216217041
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.333 Test Loss: 1.354 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9018452167510986
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.333 Test Loss: 1.393 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.022897481918335
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.333 Test Loss: 1.431 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8312857151031494
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.267 Test Loss: 1.469 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8942945003509521
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.267 Test Loss: 1.506 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9591705799102783
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.267 Test Loss: 1.542 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5439255237579346
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9546329975128174
Epoch: 2, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9402484893798828
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8310515880584717
Epoch: 4, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8240153789520264
Epoch: 5, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.8930490016937256
Epoch: 6, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8356168270111084
Epoch: 7, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9285969734191895
Epoch: 8, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.055 Vali Acc: 0.333 Test Loss: 1.055 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.9231195449829102
Epoch: 9, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.93259596824646
Epoch: 10, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9993383884429932
Epoch: 11, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8878276348114014
Epoch: 12, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 13 cost time: 0.7932388782501221
Epoch: 13, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.738267183303833
Epoch: 14, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9892153739929199
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7652559280395508
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9261488914489746
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9619894027709961
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9889349937438965
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.333 Test Loss: 1.308 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.906257152557373
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9687070846557617
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8164660930633545
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.467 Test Loss: 1.389 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.287707567214966
Epoch: 1, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.9010238647460938
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9276618957519531
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9427964687347412
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.88777756690979
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8774547576904297
Epoch: 6, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8684432506561279
Epoch: 7, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.9074251651763916
Epoch: 8, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9011921882629395
Epoch: 9, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.8787400722503662
Epoch: 10, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.867816686630249
Epoch: 11, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9201197624206543
Epoch: 12, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8503117561340332
Epoch: 13, Steps: 1 | Train Loss: 0.120 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9139416217803955
Epoch: 14, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.9478018283843994
Epoch: 15, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7482860088348389
Epoch: 16, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9518208503723145
Epoch: 17, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9026162624359131
Epoch: 18, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.521 Vali Acc: 0.400 Test Loss: 1.521 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8504238128662109
Epoch: 19, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.585 Vali Acc: 0.400 Test Loss: 1.585 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8926196098327637
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.608 Vali Acc: 0.400 Test Loss: 1.608 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8592982292175293
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.400 Test Loss: 1.617 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8821136951446533
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.400 Test Loss: 1.619 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8333690166473389
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.467 Test Loss: 1.618 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8706679344177246
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.467 Test Loss: 1.619 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2212014198303223
Epoch: 1, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8553600311279297
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8651382923126221
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8323004245758057
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8230750560760498
Epoch: 5, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8031880855560303
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8567757606506348
Epoch: 7, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.8601465225219727
Epoch: 8, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9367978572845459
Epoch: 9, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.897813081741333
Epoch: 10, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.9015140533447266
Epoch: 11, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9112763404846191
Epoch: 12, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.897601842880249
Epoch: 13, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.281 Vali Acc: 0.467 Test Loss: 1.281 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 14 cost time: 0.9153621196746826
Epoch: 14, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.306 Vali Acc: 0.467 Test Loss: 1.306 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7293603420257568
Epoch: 15, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.377 Vali Acc: 0.400 Test Loss: 1.377 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8648276329040527
Epoch: 16, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.482 Vali Acc: 0.467 Test Loss: 1.482 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8206691741943359
Epoch: 17, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.568 Vali Acc: 0.467 Test Loss: 1.568 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8566093444824219
Epoch: 18, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.587 Vali Acc: 0.400 Test Loss: 1.587 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7882814407348633
Epoch: 19, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.532 Vali Acc: 0.467 Test Loss: 1.532 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9148349761962891
Epoch: 20, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.529 Vali Acc: 0.400 Test Loss: 1.529 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8684744834899902
Epoch: 21, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.622 Vali Acc: 0.400 Test Loss: 1.622 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7557473182678223
Epoch: 22, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.767 Vali Acc: 0.400 Test Loss: 1.767 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7234687805175781
Epoch: 23, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.818 Vali Acc: 0.400 Test Loss: 1.818 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1434179
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7094740867614746
Epoch: 1, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.215839147567749
Epoch: 2, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.4576714038848877
Epoch: 3, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 1.1914398670196533
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 1.4039206504821777
Epoch: 5, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.355506181716919
Epoch: 6, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1213886737823486
Epoch: 7, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.148386001586914
Epoch: 8, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4312002658843994
Epoch: 9, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1915369033813477
Epoch: 10, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.282 Vali Acc: 0.467 Test Loss: 1.282 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1935372352600098
Epoch: 11, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.415 Vali Acc: 0.467 Test Loss: 1.415 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2335009574890137
Epoch: 12, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.509 Vali Acc: 0.467 Test Loss: 1.509 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1033556461334229
Epoch: 13, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.558 Vali Acc: 0.467 Test Loss: 1.558 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1332166194915771
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.615 Vali Acc: 0.467 Test Loss: 1.615 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.595954656600952
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
Validation loss decreased (inf --> -0.466657).  Saving model ...
Epoch: 2 cost time: 1.1085290908813477
Epoch: 2, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.003 Vali Acc: 0.467 Test Loss: 1.003 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 1.1137120723724365
Epoch: 3, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.9660632610321045
Epoch: 4, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.025216817855835
Epoch: 5, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1931235790252686
Epoch: 6, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.270463466644287
Epoch: 7, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2257585525512695
Epoch: 8, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1614415645599365
Epoch: 9, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1561133861541748
Epoch: 10, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1391832828521729
Epoch: 11, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2929630279541016
Epoch: 12, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.526 Vali Acc: 0.400 Test Loss: 1.526 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3281233310699463
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.606 Vali Acc: 0.400 Test Loss: 1.606 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.471931219100952
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.11055326461792
Epoch: 2, Steps: 1 | Train Loss: 0.989 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 1.0254549980163574
Epoch: 3, Steps: 1 | Train Loss: 0.939 Vali Loss: 0.988 Vali Acc: 0.600 Test Loss: 0.988 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 1.1799743175506592
Epoch: 4, Steps: 1 | Train Loss: 0.891 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.06378173828125
Epoch: 5, Steps: 1 | Train Loss: 0.765 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1695027351379395
Epoch: 6, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1274487972259521
Epoch: 7, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0795741081237793
Epoch: 8, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1691617965698242
Epoch: 9, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.018 Vali Acc: 0.533 Test Loss: 1.018 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3267912864685059
Epoch: 10, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3012518882751465
Epoch: 11, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.317 Vali Acc: 0.467 Test Loss: 1.317 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0761651992797852
Epoch: 12, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.419 Vali Acc: 0.467 Test Loss: 1.419 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1674010753631592
Epoch: 13, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.450 Vali Acc: 0.467 Test Loss: 1.450 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.773125648498535
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7690696716308594
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
Validation loss decreased (-0.333323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7891395092010498
Epoch: 3, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.013 Vali Acc: 0.533 Test Loss: 1.013 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.8759536743164062
Epoch: 4, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9433982372283936
Epoch: 5, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8262660503387451
Epoch: 6, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8616094589233398
Epoch: 7, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.9412481784820557
Epoch: 8, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0090253353118896
Epoch: 9, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9543704986572266
Epoch: 10, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.386 Vali Acc: 0.533 Test Loss: 1.386 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.915651798248291
Epoch: 11, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.630 Vali Acc: 0.533 Test Loss: 1.630 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9016158580780029
Epoch: 12, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.826 Vali Acc: 0.533 Test Loss: 1.826 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9745745658874512
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.993 Vali Acc: 0.467 Test Loss: 1.993 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1024632453918457
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.149 Vali Acc: 0.467 Test Loss: 2.149 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9585883617401123
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.303 Vali Acc: 0.467 Test Loss: 2.303 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7719321250915527
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.452 Vali Acc: 0.467 Test Loss: 2.452 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9545981884002686
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.467 Test Loss: 2.597 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3119771480560303
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.070 Vali Acc: 0.200 Test Loss: 1.070 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7868602275848389
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.066 Vali Acc: 0.267 Test Loss: 1.066 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.7204551696777344
Epoch: 3, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7922053337097168
Epoch: 4, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.7307016849517822
Epoch: 5, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8290770053863525
Epoch: 6, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.8463485240936279
Epoch: 7, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7494785785675049
Epoch: 8, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7618861198425293
Epoch: 9, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8087706565856934
Epoch: 10, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.515 Vali Acc: 0.400 Test Loss: 1.515 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7985177040100098
Epoch: 11, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.716 Vali Acc: 0.400 Test Loss: 1.716 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8053998947143555
Epoch: 12, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.917 Vali Acc: 0.400 Test Loss: 1.917 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9060428142547607
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.109 Vali Acc: 0.400 Test Loss: 2.109 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9406430721282959
Epoch: 14, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.292 Vali Acc: 0.400 Test Loss: 2.292 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8172991275787354
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.469 Vali Acc: 0.400 Test Loss: 2.469 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8500299453735352
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.641 Vali Acc: 0.400 Test Loss: 2.641 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2064809799194336
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7425308227539062
Epoch: 2, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8219096660614014
Epoch: 3, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7383801937103271
Epoch: 4, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8256261348724365
Epoch: 5, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7818007469177246
Epoch: 6, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7908415794372559
Epoch: 7, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.8628866672515869
Epoch: 8, Steps: 1 | Train Loss: 0.248 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8212206363677979
Epoch: 9, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.344 Vali Acc: 0.267 Test Loss: 1.344 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8146803379058838
Epoch: 10, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.504 Vali Acc: 0.333 Test Loss: 1.504 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8337244987487793
Epoch: 11, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.693 Vali Acc: 0.333 Test Loss: 1.693 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8300259113311768
Epoch: 12, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.889 Vali Acc: 0.333 Test Loss: 1.889 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8300583362579346
Epoch: 13, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.080 Vali Acc: 0.400 Test Loss: 2.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8435966968536377
Epoch: 14, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.269 Vali Acc: 0.467 Test Loss: 2.269 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466644).  Saving model ...
Epoch: 15 cost time: 0.9411821365356445
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.454 Vali Acc: 0.467 Test Loss: 2.454 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8933889865875244
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.634 Vali Acc: 0.467 Test Loss: 2.634 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9191992282867432
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.807 Vali Acc: 0.467 Test Loss: 2.807 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8024513721466064
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.974 Vali Acc: 0.467 Test Loss: 2.974 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.801734447479248
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.132 Vali Acc: 0.467 Test Loss: 3.132 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8083364963531494
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.283 Vali Acc: 0.467 Test Loss: 3.283 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.762887716293335
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.426 Vali Acc: 0.467 Test Loss: 3.426 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7850217819213867
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.562 Vali Acc: 0.467 Test Loss: 3.562 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8105666637420654
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.689 Vali Acc: 0.533 Test Loss: 3.689 Test Acc: 0.533
Validation loss decreased (-0.466644 --> -0.533296).  Saving model ...
Epoch: 24 cost time: 0.7201199531555176
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.809 Vali Acc: 0.533 Test Loss: 3.809 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7589051723480225
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.922 Vali Acc: 0.533 Test Loss: 3.922 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7600748538970947
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.027 Vali Acc: 0.533 Test Loss: 4.027 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7574303150177002
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.126 Vali Acc: 0.533 Test Loss: 4.126 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7728939056396484
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.218 Vali Acc: 0.533 Test Loss: 4.218 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8195774555206299
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.305 Vali Acc: 0.533 Test Loss: 4.305 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7692615985870361
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.385 Vali Acc: 0.533 Test Loss: 4.385 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8181688785552979
Epoch: 31, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.460 Vali Acc: 0.533 Test Loss: 4.460 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7475228309631348
Epoch: 32, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.530 Vali Acc: 0.533 Test Loss: 4.530 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7949776649475098
Epoch: 33, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.595 Vali Acc: 0.533 Test Loss: 4.595 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.241325855255127
Epoch: 1, Steps: 1 | Train Loss: 1.294 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7455048561096191
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.9455831050872803
Epoch: 3, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7886219024658203
Epoch: 4, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7848167419433594
Epoch: 5, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7147762775421143
Epoch: 6, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6858277320861816
Epoch: 7, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.7001605033874512
Epoch: 8, Steps: 1 | Train Loss: 0.342 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7506928443908691
Epoch: 9, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6633193492889404
Epoch: 10, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7060885429382324
Epoch: 11, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6765828132629395
Epoch: 12, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6137678623199463
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6085069179534912
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6616659164428711
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.68243408203125
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8101820945739746
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7851190567016602
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3912343978881836
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7246372699737549
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.7604343891143799
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.7364294528961182
Epoch: 4, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7714598178863525
Epoch: 5, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7677116394042969
Epoch: 6, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8151521682739258
Epoch: 7, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.75380539894104
Epoch: 8, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.7395141124725342
Epoch: 9, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7382171154022217
Epoch: 10, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8687961101531982
Epoch: 11, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.762570858001709
Epoch: 12, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7925117015838623
Epoch: 13, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.7968041896820068
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7926380634307861
Epoch: 15, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.713374137878418
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7552237510681152
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7028379440307617
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7405908107757568
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7883341312408447
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7713093757629395
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.467 Test Loss: 1.209 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7610445022583008
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.242 Vali Acc: 0.467 Test Loss: 1.242 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7999575138092041
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.467 Test Loss: 1.275 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0312039852142334
Epoch: 1, Steps: 1 | Train Loss: 1.429 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.6753671169281006
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6783649921417236
Epoch: 3, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8396251201629639
Epoch: 4, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7991580963134766
Epoch: 5, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7009291648864746
Epoch: 6, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7316277027130127
Epoch: 7, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.787621021270752
Epoch: 8, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.821296215057373
Epoch: 9, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7778420448303223
Epoch: 10, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7403342723846436
Epoch: 11, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7091748714447021
Epoch: 12, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7221662998199463
Epoch: 13, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7354311943054199
Epoch: 14, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8557252883911133
Epoch: 15, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7545700073242188
Epoch: 16, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7283103466033936
Epoch: 17, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.262 Vali Acc: 0.467 Test Loss: 1.262 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7308039665222168
Epoch: 18, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8038749694824219
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7253098487854004
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.230 Vali Acc: 0.467 Test Loss: 1.230 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.191617488861084
Epoch: 1, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7091429233551025
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7199857234954834
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7629222869873047
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7215132713317871
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.706005334854126
Epoch: 6, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7397308349609375
Epoch: 7, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.333322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.770000696182251
Epoch: 8, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7240877151489258
Epoch: 9, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7269771099090576
Epoch: 10, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8350648880004883
Epoch: 11, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.193 Vali Acc: 0.467 Test Loss: 1.193 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6653668880462646
Epoch: 12, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.815971851348877
Epoch: 13, Steps: 1 | Train Loss: 0.373 Vali Loss: 1.265 Vali Acc: 0.467 Test Loss: 1.265 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7524721622467041
Epoch: 14, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.853585958480835
Epoch: 15, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.308 Vali Acc: 0.533 Test Loss: 1.308 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.819753885269165
Epoch: 16, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.347 Vali Acc: 0.467 Test Loss: 1.347 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8591728210449219
Epoch: 17, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.414 Vali Acc: 0.467 Test Loss: 1.414 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1040963
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 3.3426458835601807
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.3020210266113281
Epoch: 2, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.008854627609253
Epoch: 3, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2765910625457764
Epoch: 4, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.314408779144287
Epoch: 5, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.2476556301116943
Epoch: 6, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 1.4686658382415771
Epoch: 7, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3194770812988281
Epoch: 8, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1122944355010986
Epoch: 9, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1869828701019287
Epoch: 10, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.224 Vali Acc: 0.467 Test Loss: 1.224 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3785321712493896
Epoch: 11, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.332 Vali Acc: 0.467 Test Loss: 1.332 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2932584285736084
Epoch: 12, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.394 Vali Acc: 0.533 Test Loss: 1.394 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.133918285369873
Epoch: 13, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.475 Vali Acc: 0.467 Test Loss: 1.475 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1179821491241455
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.570 Vali Acc: 0.467 Test Loss: 1.570 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0924251079559326
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.467 Test Loss: 1.675 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.254652976989746
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.781 Vali Acc: 0.400 Test Loss: 1.781 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.683701276779175
Epoch: 1, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0783698558807373
Epoch: 2, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8031392097473145
Epoch: 3, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.033097267150879
Epoch: 4, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0301854610443115
Epoch: 5, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.150430679321289
Epoch: 6, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.1254847049713135
Epoch: 7, Steps: 1 | Train Loss: 0.546 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.260709524154663
Epoch: 8, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1068143844604492
Epoch: 9, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0304126739501953
Epoch: 10, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.340 Vali Acc: 0.267 Test Loss: 1.340 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9652647972106934
Epoch: 11, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.467 Vali Acc: 0.267 Test Loss: 1.467 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0998506546020508
Epoch: 12, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.509 Vali Acc: 0.333 Test Loss: 1.509 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1354188919067383
Epoch: 13, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.577 Vali Acc: 0.267 Test Loss: 1.577 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.059645652770996
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.665 Vali Acc: 0.267 Test Loss: 1.665 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2891783714294434
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.763 Vali Acc: 0.267 Test Loss: 1.763 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1424670219421387
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.861 Vali Acc: 0.267 Test Loss: 1.861 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3096020221710205
Epoch: 1, Steps: 1 | Train Loss: 1.226 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.861677885055542
Epoch: 2, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8997766971588135
Epoch: 3, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9734926223754883
Epoch: 4, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7647769451141357
Epoch: 5, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7404732704162598
Epoch: 6, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7586121559143066
Epoch: 7, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.947415828704834
Epoch: 8, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 1.0666570663452148
Epoch: 9, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.214923620223999
Epoch: 10, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9788284301757812
Epoch: 11, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.304 Vali Acc: 0.467 Test Loss: 1.304 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1108660697937012
Epoch: 12, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.318 Vali Acc: 0.467 Test Loss: 1.318 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0872797966003418
Epoch: 13, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.340 Vali Acc: 0.533 Test Loss: 1.340 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.978792667388916
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.407 Vali Acc: 0.400 Test Loss: 1.407 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9028654098510742
Epoch: 15, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.495 Vali Acc: 0.400 Test Loss: 1.495 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.157618761062622
Epoch: 16, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.582 Vali Acc: 0.400 Test Loss: 1.582 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9710063934326172
Epoch: 17, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.400 Test Loss: 1.669 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2590408325195312
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.400 Test Loss: 1.755 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3339028358459473
Epoch: 1, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8848011493682861
Epoch: 2, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9748237133026123
Epoch: 3, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9245214462280273
Epoch: 4, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9534423351287842
Epoch: 5, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.9914548397064209
Epoch: 6, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.017 Vali Acc: 0.533 Test Loss: 1.017 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.911297082901001
Epoch: 7, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.9667763710021973
Epoch: 8, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.084 Vali Acc: 0.600 Test Loss: 1.084 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9507813453674316
Epoch: 9, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.169 Vali Acc: 0.600 Test Loss: 1.169 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.931755542755127
Epoch: 10, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.380 Vali Acc: 0.600 Test Loss: 1.380 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9596586227416992
Epoch: 11, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.598 Vali Acc: 0.600 Test Loss: 1.598 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9612586498260498
Epoch: 12, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.790 Vali Acc: 0.533 Test Loss: 1.790 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9508047103881836
Epoch: 13, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.971 Vali Acc: 0.467 Test Loss: 1.971 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9261176586151123
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.147 Vali Acc: 0.467 Test Loss: 2.147 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.929650068283081
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.322 Vali Acc: 0.467 Test Loss: 2.322 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9795546531677246
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.488 Vali Acc: 0.467 Test Loss: 2.488 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9171404838562012
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.649 Vali Acc: 0.467 Test Loss: 2.649 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5879573822021484
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.797356128692627
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8756122589111328
Epoch: 3, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.884674072265625
Epoch: 4, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8673958778381348
Epoch: 5, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.823033332824707
Epoch: 6, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7788949012756348
Epoch: 7, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7857387065887451
Epoch: 8, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8167331218719482
Epoch: 9, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7571907043457031
Epoch: 10, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.462 Vali Acc: 0.400 Test Loss: 1.462 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7176077365875244
Epoch: 11, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.649 Vali Acc: 0.400 Test Loss: 1.649 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8183643817901611
Epoch: 12, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.827 Vali Acc: 0.400 Test Loss: 1.827 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8189325332641602
Epoch: 13, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.991 Vali Acc: 0.400 Test Loss: 1.991 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0450448989868164
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6864645481109619
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6898601055145264
Epoch: 3, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6892685890197754
Epoch: 4, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6582560539245605
Epoch: 5, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6054244041442871
Epoch: 6, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6795163154602051
Epoch: 7, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6988873481750488
Epoch: 8, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.690760612487793
Epoch: 9, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6474695205688477
Epoch: 10, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.468 Vali Acc: 0.333 Test Loss: 1.468 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6809000968933105
Epoch: 11, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.681 Vali Acc: 0.333 Test Loss: 1.681 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6847898960113525
Epoch: 12, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.884 Vali Acc: 0.333 Test Loss: 1.884 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4085471630096436
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7740559577941895
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.798469066619873
Epoch: 3, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.7954626083374023
Epoch: 4, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7555112838745117
Epoch: 5, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7484283447265625
Epoch: 6, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7834649085998535
Epoch: 7, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8372912406921387
Epoch: 8, Steps: 1 | Train Loss: 0.392 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7697112560272217
Epoch: 9, Steps: 1 | Train Loss: 0.186 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6346862316131592
Epoch: 10, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.6613457202911377
Epoch: 11, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.220 Vali Acc: 0.533 Test Loss: 1.220 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 12 cost time: 0.8612415790557861
Epoch: 12, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.191 Vali Acc: 0.467 Test Loss: 1.191 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6951901912689209
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7030017375946045
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7484791278839111
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7169594764709473
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.533 Test Loss: 1.243 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.679297685623169
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.533 Test Loss: 1.288 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6763720512390137
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.533 Test Loss: 1.337 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6713333129882812
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.387 Vali Acc: 0.533 Test Loss: 1.387 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6795482635498047
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.533 Test Loss: 1.436 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6748170852661133
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.533 Test Loss: 1.485 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.496131181716919
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6923596858978271
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6834466457366943
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.7680115699768066
Epoch: 4, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.7704980373382568
Epoch: 5, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.7542531490325928
Epoch: 6, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7022175788879395
Epoch: 7, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7129063606262207
Epoch: 8, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8187487125396729
Epoch: 9, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7775514125823975
Epoch: 10, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6698691844940186
Epoch: 11, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7603034973144531
Epoch: 12, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6533329486846924
Epoch: 13, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6542863845825195
Epoch: 14, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6626389026641846
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6849782466888428
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6723718643188477
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6494660377502441
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7282364368438721
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.349623441696167
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.119 Vali Acc: 0.533 Test Loss: 1.119 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.7102930545806885
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7196710109710693
Epoch: 3, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7311432361602783
Epoch: 4, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6830265522003174
Epoch: 5, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7412331104278564
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7051513195037842
Epoch: 7, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6984348297119141
Epoch: 8, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6961536407470703
Epoch: 9, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7113354206085205
Epoch: 10, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.805506706237793
Epoch: 11, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.158609628677368
Epoch: 1, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6707792282104492
Epoch: 2, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6592488288879395
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6292011737823486
Epoch: 4, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6258862018585205
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7142748832702637
Epoch: 6, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7282660007476807
Epoch: 7, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.7132830619812012
Epoch: 8, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.764040470123291
Epoch: 9, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7829461097717285
Epoch: 10, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7781112194061279
Epoch: 11, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7568356990814209
Epoch: 12, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7756059169769287
Epoch: 13, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8380777835845947
Epoch: 14, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7366483211517334
Epoch: 15, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.189 Vali Acc: 0.400 Test Loss: 1.189 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.68515944480896
Epoch: 16, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7262706756591797
Epoch: 17, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7732071876525879
Epoch: 18, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 844355
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3819799423217773
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 1.0039494037628174
Epoch: 2, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3638696670532227
Epoch: 3, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2526614665985107
Epoch: 4, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.245126485824585
Epoch: 5, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 1.09010648727417
Epoch: 6, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.9314897060394287
Epoch: 7, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 1.2317991256713867
Epoch: 8, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2344343662261963
Epoch: 9, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.169 Vali Acc: 0.533 Test Loss: 1.169 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.151386022567749
Epoch: 10, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.320 Vali Acc: 0.467 Test Loss: 1.320 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.006000280380249
Epoch: 11, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.411 Vali Acc: 0.533 Test Loss: 1.411 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.095313310623169
Epoch: 12, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.410 Vali Acc: 0.533 Test Loss: 1.410 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2052640914916992
Epoch: 13, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.445 Vali Acc: 0.533 Test Loss: 1.445 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1905410289764404
Epoch: 14, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.513 Vali Acc: 0.467 Test Loss: 1.513 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1165151596069336
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.597 Vali Acc: 0.467 Test Loss: 1.597 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9978303909301758
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.467 Test Loss: 1.688 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0566117763519287
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.785 Vali Acc: 0.467 Test Loss: 1.785 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.238858461380005
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0358643531799316
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.226405143737793
Epoch: 3, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0964198112487793
Epoch: 4, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.083 Vali Acc: 0.533 Test Loss: 1.083 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.9672486782073975
Epoch: 5, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0203471183776855
Epoch: 6, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9322323799133301
Epoch: 7, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0106217861175537
Epoch: 8, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.969365119934082
Epoch: 9, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.074753999710083
Epoch: 10, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9148411750793457
Epoch: 11, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.430 Vali Acc: 0.400 Test Loss: 1.430 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.057612657546997
Epoch: 12, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9943325519561768
Epoch: 13, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.584 Vali Acc: 0.400 Test Loss: 1.584 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2489633560180664
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.672 Vali Acc: 0.400 Test Loss: 1.672 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.6796622276306152
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9125068187713623
Epoch: 2, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0493826866149902
Epoch: 3, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.067056655883789
Epoch: 4, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.0669615268707275
Epoch: 5, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.09110689163208
Epoch: 6, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9944095611572266
Epoch: 7, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.9896335601806641
Epoch: 8, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0447874069213867
Epoch: 9, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9792969226837158
Epoch: 10, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.202 Vali Acc: 0.467 Test Loss: 1.202 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9694840908050537
Epoch: 11, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.292 Vali Acc: 0.533 Test Loss: 1.292 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533320).  Saving model ...
Epoch: 12 cost time: 1.0857419967651367
Epoch: 12, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.349 Vali Acc: 0.467 Test Loss: 1.349 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1829631328582764
Epoch: 13, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.409 Vali Acc: 0.467 Test Loss: 1.409 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0031688213348389
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.486 Vali Acc: 0.467 Test Loss: 1.486 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.012239694595337
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.565 Vali Acc: 0.467 Test Loss: 1.565 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9594180583953857
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.467 Test Loss: 1.646 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0185551643371582
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.467 Test Loss: 1.727 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.93656325340271
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.467 Test Loss: 1.806 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9189872741699219
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.467 Test Loss: 1.882 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7899751663208008
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.467 Test Loss: 1.956 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9241411685943604
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.467 Test Loss: 2.026 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2564094066619873
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8394927978515625
Epoch: 2, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9244513511657715
Epoch: 3, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8410460948944092
Epoch: 4, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.8176710605621338
Epoch: 5, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8819024562835693
Epoch: 6, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8462367057800293
Epoch: 7, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.927645206451416
Epoch: 8, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.216 Vali Acc: 0.533 Test Loss: 1.216 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9548907279968262
Epoch: 9, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.329 Vali Acc: 0.533 Test Loss: 1.329 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.884192705154419
Epoch: 10, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.497 Vali Acc: 0.533 Test Loss: 1.497 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9023330211639404
Epoch: 11, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.683 Vali Acc: 0.533 Test Loss: 1.683 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9046313762664795
Epoch: 12, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.856 Vali Acc: 0.533 Test Loss: 1.856 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9270734786987305
Epoch: 13, Steps: 1 | Train Loss: 0.009 Vali Loss: 2.025 Vali Acc: 0.467 Test Loss: 2.025 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9260942935943604
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.193 Vali Acc: 0.467 Test Loss: 2.193 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.090120315551758
Epoch: 1, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.755084753036499
Epoch: 2, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7565772533416748
Epoch: 3, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8243350982666016
Epoch: 4, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8096468448638916
Epoch: 5, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7771627902984619
Epoch: 6, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7892682552337646
Epoch: 7, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.826042652130127
Epoch: 8, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.242 Vali Acc: 0.400 Test Loss: 1.242 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8252978324890137
Epoch: 9, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.364 Vali Acc: 0.467 Test Loss: 1.364 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.813173770904541
Epoch: 10, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.516 Vali Acc: 0.333 Test Loss: 1.516 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8051497936248779
Epoch: 11, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.696 Vali Acc: 0.333 Test Loss: 1.696 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8936190605163574
Epoch: 12, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.885 Vali Acc: 0.333 Test Loss: 1.885 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3187830448150635
Epoch: 1, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8178901672363281
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7929573059082031
Epoch: 3, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.7454969882965088
Epoch: 4, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7683901786804199
Epoch: 5, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7146186828613281
Epoch: 6, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6595273017883301
Epoch: 7, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6851358413696289
Epoch: 8, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7411613464355469
Epoch: 9, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.333 Vali Acc: 0.400 Test Loss: 1.333 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7866075038909912
Epoch: 10, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.455 Vali Acc: 0.267 Test Loss: 1.455 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7427308559417725
Epoch: 11, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.613 Vali Acc: 0.333 Test Loss: 1.613 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.67291259765625
Epoch: 12, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.779 Vali Acc: 0.333 Test Loss: 1.779 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6615707874298096
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.951 Vali Acc: 0.333 Test Loss: 1.951 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3989717960357666
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.012 Vali Acc: 0.333 Test Loss: 1.012 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7291533946990967
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 0.992 Vali Acc: 0.400 Test Loss: 0.992 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.7082533836364746
Epoch: 3, Steps: 1 | Train Loss: 0.899 Vali Loss: 0.980 Vali Acc: 0.467 Test Loss: 0.980 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.7619237899780273
Epoch: 4, Steps: 1 | Train Loss: 0.888 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 5 cost time: 0.6989266872406006
Epoch: 5, Steps: 1 | Train Loss: 0.881 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 0.6898324489593506
Epoch: 6, Steps: 1 | Train Loss: 0.703 Vali Loss: 0.978 Vali Acc: 0.467 Test Loss: 0.978 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7317764759063721
Epoch: 7, Steps: 1 | Train Loss: 0.549 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6874053478240967
Epoch: 8, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7350521087646484
Epoch: 9, Steps: 1 | Train Loss: 0.175 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7043097019195557
Epoch: 10, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7598628997802734
Epoch: 11, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6112315654754639
Epoch: 12, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6885206699371338
Epoch: 13, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6980342864990234
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7157809734344482
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7243344783782959
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.400 Test Loss: 1.278 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6923873424530029
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6694285869598389
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.6749999523162842
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.400 Test Loss: 1.403 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1174216270446777
Epoch: 1, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7399005889892578
Epoch: 2, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.8298680782318115
Epoch: 3, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.7684547901153564
Epoch: 4, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.9089539051055908
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.026 Vali Acc: 0.400 Test Loss: 1.026 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.8203995227813721
Epoch: 6, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.8356091976165771
Epoch: 7, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.011 Vali Acc: 0.333 Test Loss: 1.011 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7401952743530273
Epoch: 8, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.7828919887542725
Epoch: 9, Steps: 1 | Train Loss: 0.241 Vali Loss: 0.995 Vali Acc: 0.533 Test Loss: 0.995 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.7684929370880127
Epoch: 10, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7565431594848633
Epoch: 11, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7499890327453613
Epoch: 12, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7308659553527832
Epoch: 13, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7782790660858154
Epoch: 14, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.822070837020874
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.73581862449646
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7789571285247803
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6731679439544678
Epoch: 18, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.400 Test Loss: 1.043 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.679725170135498
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9672703742980957
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6875331401824951
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.092 Vali Acc: 0.200 Test Loss: 1.092 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.7820024490356445
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.199989 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.7729647159576416
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7205078601837158
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7458252906799316
Epoch: 6, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7895383834838867
Epoch: 7, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.749807596206665
Epoch: 8, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.7370681762695312
Epoch: 9, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6119067668914795
Epoch: 10, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.7499275207519531
Epoch: 11, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7126877307891846
Epoch: 12, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7094335556030273
Epoch: 13, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8207299709320068
Epoch: 14, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.029 Vali Acc: 0.400 Test Loss: 1.029 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7599465847015381
Epoch: 15, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7001636028289795
Epoch: 16, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6387948989868164
Epoch: 17, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6555221080780029
Epoch: 18, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7181577682495117
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7076592445373535
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0381603240966797
Epoch: 1, Steps: 1 | Train Loss: 1.235 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.6791505813598633
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.59197998046875
Epoch: 3, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.680133581161499
Epoch: 4, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6830275058746338
Epoch: 5, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.072 Vali Acc: 0.267 Test Loss: 1.072 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7369935512542725
Epoch: 6, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7260432243347168
Epoch: 7, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6768429279327393
Epoch: 8, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6376147270202637
Epoch: 9, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6822047233581543
Epoch: 10, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.787327766418457
Epoch: 11, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 746051
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.474419355392456
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0345211029052734
Epoch: 2, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.3090991973876953
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.3847742080688477
Epoch: 4, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.1081597805023193
Epoch: 5, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 1.2682788372039795
Epoch: 6, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.2356319427490234
Epoch: 7, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3401596546173096
Epoch: 8, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.278670072555542
Epoch: 9, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2990868091583252
Epoch: 10, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 1.4339587688446045
Epoch: 11, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.333 Vali Acc: 0.467 Test Loss: 1.333 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.089128017425537
Epoch: 12, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.476 Vali Acc: 0.467 Test Loss: 1.476 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1822223663330078
Epoch: 13, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.587 Vali Acc: 0.467 Test Loss: 1.587 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1748716831207275
Epoch: 14, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.667 Vali Acc: 0.467 Test Loss: 1.667 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3973653316497803
Epoch: 15, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.734 Vali Acc: 0.467 Test Loss: 1.734 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.407120704650879
Epoch: 16, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.467 Test Loss: 1.799 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.122445821762085
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.467 Test Loss: 1.862 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.222219705581665
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.925 Vali Acc: 0.467 Test Loss: 1.925 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1256017684936523
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.467 Test Loss: 1.987 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2986624240875244
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.467 Test Loss: 2.049 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.650968313217163
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.2602198123931885
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.200 Vali Acc: 0.067 Test Loss: 1.200 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0120398998260498
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.195 Vali Acc: 0.067 Test Loss: 1.195 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1284880638122559
Epoch: 4, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.9798643589019775
Epoch: 5, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9783101081848145
Epoch: 6, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.206394910812378
Epoch: 7, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0406336784362793
Epoch: 8, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9701199531555176
Epoch: 9, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9489901065826416
Epoch: 10, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.035611629486084
Epoch: 11, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.459 Vali Acc: 0.333 Test Loss: 1.459 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333319).  Saving model ...
Epoch: 12 cost time: 1.2773070335388184
Epoch: 12, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.624 Vali Acc: 0.267 Test Loss: 1.624 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1523590087890625
Epoch: 13, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.732 Vali Acc: 0.267 Test Loss: 1.732 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1255452632904053
Epoch: 14, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.816 Vali Acc: 0.267 Test Loss: 1.816 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3126037120819092
Epoch: 15, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.893 Vali Acc: 0.267 Test Loss: 1.893 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1439459323883057
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.971 Vali Acc: 0.267 Test Loss: 1.971 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.233130693435669
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.200 Test Loss: 2.047 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3050596714019775
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.200 Test Loss: 2.122 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9644806385040283
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.200 Test Loss: 2.194 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.129986047744751
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.264 Vali Acc: 0.200 Test Loss: 2.264 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3012914657592773
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.330 Vali Acc: 0.267 Test Loss: 2.330 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.524494171142578
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.9876673221588135
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 1.1348953247070312
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 1.1293470859527588
Epoch: 4, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.9384415149688721
Epoch: 5, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7804732322692871
Epoch: 6, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.0475363731384277
Epoch: 7, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 1.024169683456421
Epoch: 8, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.191812515258789
Epoch: 9, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.206528663635254
Epoch: 10, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0263166427612305
Epoch: 11, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.334 Vali Acc: 0.533 Test Loss: 1.334 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533320).  Saving model ...
Epoch: 12 cost time: 1.0783162117004395
Epoch: 12, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.497 Vali Acc: 0.533 Test Loss: 1.497 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8557300567626953
Epoch: 13, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.569 Vali Acc: 0.533 Test Loss: 1.569 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0459554195404053
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.605 Vali Acc: 0.533 Test Loss: 1.605 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0087776184082031
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.634 Vali Acc: 0.467 Test Loss: 1.634 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9376075267791748
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.467 Test Loss: 1.666 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9172065258026123
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.467 Test Loss: 1.699 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1192593574523926
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.467 Test Loss: 1.734 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0414464473724365
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.467 Test Loss: 1.770 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9819273948669434
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.467 Test Loss: 1.806 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2295536994934082
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.467 Test Loss: 1.841 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.5973317623138428
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9529385566711426
Epoch: 2, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9299132823944092
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.8542845249176025
Epoch: 4, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.0034325122833252
Epoch: 5, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.9926455020904541
Epoch: 6, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9239184856414795
Epoch: 7, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9860877990722656
Epoch: 8, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.8501570224761963
Epoch: 9, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.209 Vali Acc: 0.600 Test Loss: 1.209 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 0.8567531108856201
Epoch: 10, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.331 Vali Acc: 0.533 Test Loss: 1.331 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8920137882232666
Epoch: 11, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.572 Vali Acc: 0.533 Test Loss: 1.572 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8895108699798584
Epoch: 12, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.858 Vali Acc: 0.467 Test Loss: 1.858 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7899556159973145
Epoch: 13, Steps: 1 | Train Loss: 0.011 Vali Loss: 2.117 Vali Acc: 0.467 Test Loss: 2.117 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8445332050323486
Epoch: 14, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.336 Vali Acc: 0.467 Test Loss: 2.336 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8694562911987305
Epoch: 15, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.528 Vali Acc: 0.467 Test Loss: 2.528 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8246848583221436
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.706 Vali Acc: 0.467 Test Loss: 2.706 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8170580863952637
Epoch: 17, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.872 Vali Acc: 0.467 Test Loss: 2.872 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7556612491607666
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.031 Vali Acc: 0.467 Test Loss: 3.031 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9175856113433838
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.182 Vali Acc: 0.467 Test Loss: 3.182 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.344005584716797
Epoch: 1, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.198 Vali Acc: 0.133 Test Loss: 1.198 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.752770185470581
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.198 Vali Acc: 0.133 Test Loss: 1.198 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7203428745269775
Epoch: 3, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.8431441783905029
Epoch: 4, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.205 Vali Acc: 0.133 Test Loss: 1.205 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7378497123718262
Epoch: 5, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.209 Vali Acc: 0.200 Test Loss: 1.209 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8199374675750732
Epoch: 6, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.8494515419006348
Epoch: 7, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.7485382556915283
Epoch: 8, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7989242076873779
Epoch: 9, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.518 Vali Acc: 0.400 Test Loss: 1.518 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7825982570648193
Epoch: 10, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.649 Vali Acc: 0.333 Test Loss: 1.649 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.788856029510498
Epoch: 11, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.799 Vali Acc: 0.333 Test Loss: 1.799 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7748579978942871
Epoch: 12, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.975 Vali Acc: 0.333 Test Loss: 1.975 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7906818389892578
Epoch: 13, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.159 Vali Acc: 0.333 Test Loss: 2.159 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8491106033325195
Epoch: 14, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.343 Vali Acc: 0.333 Test Loss: 2.343 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8600876331329346
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.523 Vali Acc: 0.333 Test Loss: 2.523 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8289811611175537
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.698 Vali Acc: 0.333 Test Loss: 2.698 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8516373634338379
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.866 Vali Acc: 0.333 Test Loss: 2.866 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2339980602264404
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.273 Vali Acc: 0.133 Test Loss: 1.273 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.7055206298828125
Epoch: 2, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.272 Vali Acc: 0.133 Test Loss: 1.272 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.6102509498596191
Epoch: 3, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.273 Vali Acc: 0.133 Test Loss: 1.273 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7684268951416016
Epoch: 4, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.277 Vali Acc: 0.133 Test Loss: 1.277 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.705193281173706
Epoch: 5, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.283 Vali Acc: 0.133 Test Loss: 1.283 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7129254341125488
Epoch: 6, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.311 Vali Acc: 0.133 Test Loss: 1.311 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7500131130218506
Epoch: 7, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.362 Vali Acc: 0.200 Test Loss: 1.362 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199986).  Saving model ...
Epoch: 8 cost time: 0.6971402168273926
Epoch: 8, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.414 Vali Acc: 0.200 Test Loss: 1.414 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7696678638458252
Epoch: 9, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.484 Vali Acc: 0.200 Test Loss: 1.484 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8169517517089844
Epoch: 10, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.601 Vali Acc: 0.200 Test Loss: 1.601 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7795677185058594
Epoch: 11, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.768 Vali Acc: 0.267 Test Loss: 1.768 Test Acc: 0.267
Validation loss decreased (-0.199986 --> -0.266649).  Saving model ...
Epoch: 12 cost time: 0.7363712787628174
Epoch: 12, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.967 Vali Acc: 0.333 Test Loss: 1.967 Test Acc: 0.333
Validation loss decreased (-0.266649 --> -0.333314).  Saving model ...
Epoch: 13 cost time: 0.8385937213897705
Epoch: 13, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.176 Vali Acc: 0.267 Test Loss: 2.176 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7405586242675781
Epoch: 14, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.387 Vali Acc: 0.333 Test Loss: 2.387 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8473215103149414
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.594 Vali Acc: 0.400 Test Loss: 2.594 Test Acc: 0.400
Validation loss decreased (-0.333314 --> -0.399974).  Saving model ...
Epoch: 16 cost time: 0.8028788566589355
Epoch: 16, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.794 Vali Acc: 0.400 Test Loss: 2.794 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.820744514465332
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.986 Vali Acc: 0.400 Test Loss: 2.986 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8182346820831299
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.169 Vali Acc: 0.400 Test Loss: 3.169 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6552371978759766
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.343 Vali Acc: 0.400 Test Loss: 3.343 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7907941341400146
Epoch: 20, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.509 Vali Acc: 0.467 Test Loss: 3.509 Test Acc: 0.467
Validation loss decreased (-0.399974 --> -0.466632).  Saving model ...
Epoch: 21 cost time: 0.713407039642334
Epoch: 21, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.665 Vali Acc: 0.467 Test Loss: 3.665 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7549912929534912
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.813 Vali Acc: 0.467 Test Loss: 3.813 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7363591194152832
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 3.953 Vali Acc: 0.467 Test Loss: 3.953 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.695803165435791
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.084 Vali Acc: 0.467 Test Loss: 4.084 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.701066255569458
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.206 Vali Acc: 0.467 Test Loss: 4.206 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7577321529388428
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.322 Vali Acc: 0.467 Test Loss: 4.322 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7355926036834717
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.429 Vali Acc: 0.467 Test Loss: 4.429 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8301997184753418
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.530 Vali Acc: 0.467 Test Loss: 4.530 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7751336097717285
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.624 Vali Acc: 0.467 Test Loss: 4.624 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8521623611450195
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 4.711 Vali Acc: 0.467 Test Loss: 4.711 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.394991397857666
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7748928070068359
Epoch: 2, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8063337802886963
Epoch: 3, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8249959945678711
Epoch: 4, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8060870170593262
Epoch: 5, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7047266960144043
Epoch: 6, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6558248996734619
Epoch: 7, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7605695724487305
Epoch: 8, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9096903800964355
Epoch: 9, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7772390842437744
Epoch: 10, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7557992935180664
Epoch: 11, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6899795532226562
Epoch: 12, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7162034511566162
Epoch: 13, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.368 Vali Acc: 0.333 Test Loss: 1.368 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.668205976486206
Epoch: 14, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.459 Vali Acc: 0.400 Test Loss: 1.459 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8287990093231201
Epoch: 15, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.400 Test Loss: 1.543 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8151562213897705
Epoch: 16, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.400 Test Loss: 1.622 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.768467903137207
Epoch: 17, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.400 Test Loss: 1.697 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8593947887420654
Epoch: 18, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.400 Test Loss: 1.767 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8468434810638428
Epoch: 19, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.400 Test Loss: 1.834 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2786593437194824
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8017048835754395
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.66866135597229
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7265410423278809
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.704613447189331
Epoch: 5, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6768109798431396
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7225799560546875
Epoch: 7, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.025 Vali Acc: 0.333 Test Loss: 1.025 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6864488124847412
Epoch: 8, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.005 Vali Acc: 0.333 Test Loss: 1.005 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6933956146240234
Epoch: 9, Steps: 1 | Train Loss: 0.301 Vali Loss: 0.972 Vali Acc: 0.333 Test Loss: 0.972 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6921660900115967
Epoch: 10, Steps: 1 | Train Loss: 0.164 Vali Loss: 0.970 Vali Acc: 0.400 Test Loss: 0.970 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7103927135467529
Epoch: 11, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6865770816802979
Epoch: 12, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6402726173400879
Epoch: 13, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7071905136108398
Epoch: 14, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.187755823135376
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.7447812557220459
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.8730330467224121
Epoch: 3, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.8368921279907227
Epoch: 4, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.7324178218841553
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7436847686767578
Epoch: 6, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.738854169845581
Epoch: 7, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.735283374786377
Epoch: 8, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6984395980834961
Epoch: 9, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.6960017681121826
Epoch: 10, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.7965741157531738
Epoch: 11, Steps: 1 | Train Loss: 0.277 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.706326961517334
Epoch: 12, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.003 Vali Acc: 0.333 Test Loss: 1.003 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7641415596008301
Epoch: 13, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6890974044799805
Epoch: 14, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6794698238372803
Epoch: 15, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6811912059783936
Epoch: 16, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7274348735809326
Epoch: 17, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7247233390808105
Epoch: 18, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7358160018920898
Epoch: 19, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8370819091796875
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.206092357635498
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7786839008331299
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7621538639068604
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7403991222381592
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6808445453643799
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.6911797523498535
Epoch: 6, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7069692611694336
Epoch: 7, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6518595218658447
Epoch: 8, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6698098182678223
Epoch: 9, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6685361862182617
Epoch: 10, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7406265735626221
Epoch: 11, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.693103551864624
Epoch: 12, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5854465961456299
Epoch: 13, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.218 Vali Acc: 0.533 Test Loss: 1.218 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533321).  Saving model ...
Epoch: 14 cost time: 0.7286472320556641
Epoch: 14, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6425669193267822
Epoch: 15, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.279 Vali Acc: 0.467 Test Loss: 1.279 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.79298996925354
Epoch: 16, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.298 Vali Acc: 0.467 Test Loss: 1.298 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7392215728759766
Epoch: 17, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.294 Vali Acc: 0.467 Test Loss: 1.294 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.810497522354126
Epoch: 18, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.326 Vali Acc: 0.467 Test Loss: 1.326 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7304823398590088
Epoch: 19, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.364 Vali Acc: 0.467 Test Loss: 1.364 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8238694667816162
Epoch: 20, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.408 Vali Acc: 0.400 Test Loss: 1.408 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8057465553283691
Epoch: 21, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.461 Vali Acc: 0.400 Test Loss: 1.461 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7143707275390625
Epoch: 22, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.529 Vali Acc: 0.400 Test Loss: 1.529 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6640453338623047
Epoch: 23, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.600 Vali Acc: 0.467 Test Loss: 1.600 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 696899
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4403765201568604
Epoch: 1, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9582633972167969
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9337623119354248
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.0076334476470947
Epoch: 4, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9421982765197754
Epoch: 5, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.863804817199707
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.1519739627838135
Epoch: 7, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 1.1338801383972168
Epoch: 8, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0914764404296875
Epoch: 9, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.102234125137329
Epoch: 10, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0398659706115723
Epoch: 11, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.119325876235962
Epoch: 12, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.204 Vali Acc: 0.467 Test Loss: 1.204 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.209207534790039
Epoch: 13, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.286 Vali Acc: 0.467 Test Loss: 1.286 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1243748664855957
Epoch: 14, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.345 Vali Acc: 0.467 Test Loss: 1.345 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.140535831451416
Epoch: 15, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0247149467468262
Epoch: 16, Steps: 1 | Train Loss: 0.021 Vali Loss: 1.431 Vali Acc: 0.400 Test Loss: 1.431 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0824899673461914
Epoch: 17, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.491 Vali Acc: 0.400 Test Loss: 1.491 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.395993947982788
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.0491876602172852
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1573681831359863
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.082604169845581
Epoch: 4, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.096175193786621
Epoch: 5, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.095489501953125
Epoch: 6, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0623486042022705
Epoch: 7, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1047334671020508
Epoch: 8, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0352225303649902
Epoch: 9, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9521925449371338
Epoch: 10, Steps: 1 | Train Loss: 0.292 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0149009227752686
Epoch: 11, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0808308124542236
Epoch: 12, Steps: 1 | Train Loss: 0.177 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9244852066040039
Epoch: 13, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.509471893310547
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9637315273284912
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.9560167789459229
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.9547557830810547
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.9302289485931396
Epoch: 5, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 1.072260856628418
Epoch: 6, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.266656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.9872293472290039
Epoch: 7, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9254734516143799
Epoch: 8, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0099761486053467
Epoch: 9, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.032421588897705
Epoch: 10, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0392568111419678
Epoch: 11, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.940234899520874
Epoch: 12, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8571805953979492
Epoch: 13, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8043594360351562
Epoch: 14, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.307 Vali Acc: 0.400 Test Loss: 1.307 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9882652759552002
Epoch: 15, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.355 Vali Acc: 0.400 Test Loss: 1.355 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0333735942840576
Epoch: 16, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.58949613571167
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.848381519317627
Epoch: 2, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.069448471069336
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8598272800445557
Epoch: 4, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8163249492645264
Epoch: 5, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.909898042678833
Epoch: 6, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 1.0242314338684082
Epoch: 7, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.9301369190216064
Epoch: 8, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8995625972747803
Epoch: 9, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.154 Vali Acc: 0.533 Test Loss: 1.154 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8053328990936279
Epoch: 10, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.207 Vali Acc: 0.533 Test Loss: 1.207 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0269334316253662
Epoch: 11, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.936424970626831
Epoch: 12, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.339 Vali Acc: 0.467 Test Loss: 1.339 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8963184356689453
Epoch: 13, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.427 Vali Acc: 0.467 Test Loss: 1.427 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7609031200408936
Epoch: 14, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.509 Vali Acc: 0.400 Test Loss: 1.509 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6632075309753418
Epoch: 15, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.595 Vali Acc: 0.400 Test Loss: 1.595 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7877554893493652
Epoch: 16, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.689 Vali Acc: 0.400 Test Loss: 1.689 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7428922653198242
Epoch: 17, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.785 Vali Acc: 0.400 Test Loss: 1.785 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4636900424957275
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8401749134063721
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8679254055023193
Epoch: 3, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9533679485321045
Epoch: 4, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8431484699249268
Epoch: 5, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8327016830444336
Epoch: 6, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8756954669952393
Epoch: 7, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9697155952453613
Epoch: 8, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8308873176574707
Epoch: 9, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7605209350585938
Epoch: 10, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7032983303070068
Epoch: 11, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.311 Vali Acc: 0.267 Test Loss: 1.311 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7962794303894043
Epoch: 12, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.388 Vali Acc: 0.267 Test Loss: 1.388 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8388545513153076
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.473 Vali Acc: 0.267 Test Loss: 1.473 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8251104354858398
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.558 Vali Acc: 0.333 Test Loss: 1.558 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8513152599334717
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.644 Vali Acc: 0.333 Test Loss: 1.644 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.299046754837036
Epoch: 1, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9807806015014648
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8351271152496338
Epoch: 3, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8014118671417236
Epoch: 4, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7317790985107422
Epoch: 5, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8224236965179443
Epoch: 6, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6472687721252441
Epoch: 7, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8882749080657959
Epoch: 8, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8342759609222412
Epoch: 9, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9066662788391113
Epoch: 10, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.285 Vali Acc: 0.333 Test Loss: 1.285 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9332218170166016
Epoch: 11, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.350 Vali Acc: 0.333 Test Loss: 1.350 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2181508541107178
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6571450233459473
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.7103254795074463
Epoch: 3, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6883876323699951
Epoch: 4, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6438186168670654
Epoch: 5, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6970818042755127
Epoch: 6, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7100229263305664
Epoch: 7, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7122347354888916
Epoch: 8, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7492475509643555
Epoch: 9, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8165335655212402
Epoch: 10, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7179234027862549
Epoch: 11, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7874910831451416
Epoch: 12, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8379220962524414
Epoch: 13, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 14 cost time: 0.7792394161224365
Epoch: 14, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8590776920318604
Epoch: 15, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7259480953216553
Epoch: 16, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7754635810852051
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8399679660797119
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.300 Vali Acc: 0.333 Test Loss: 1.300 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8407347202301025
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7645502090454102
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.360 Vali Acc: 0.333 Test Loss: 1.360 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7017054557800293
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.333 Test Loss: 1.388 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7465300559997559
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.333 Test Loss: 1.416 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6831405162811279
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.333 Test Loss: 1.442 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2883474826812744
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.756354808807373
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8267838954925537
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8119547367095947
Epoch: 4, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9634304046630859
Epoch: 5, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.872767448425293
Epoch: 6, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.8351750373840332
Epoch: 7, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 0.8517231941223145
Epoch: 8, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8382875919342041
Epoch: 9, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.8377833366394043
Epoch: 10, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7679932117462158
Epoch: 11, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7920830249786377
Epoch: 12, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7863404750823975
Epoch: 13, Steps: 1 | Train Loss: 0.119 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7747254371643066
Epoch: 14, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.800220251083374
Epoch: 15, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7595357894897461
Epoch: 16, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.142 Vali Acc: 0.533 Test Loss: 1.142 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 17 cost time: 0.8734893798828125
Epoch: 17, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.167 Vali Acc: 0.533 Test Loss: 1.167 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8065195083618164
Epoch: 18, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.189 Vali Acc: 0.533 Test Loss: 1.189 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7015724182128906
Epoch: 19, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.210 Vali Acc: 0.533 Test Loss: 1.210 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8718440532684326
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.825178861618042
Epoch: 21, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8823297023773193
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.277 Vali Acc: 0.467 Test Loss: 1.277 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8910953998565674
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9237537384033203
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.467 Test Loss: 1.323 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.921278715133667
Epoch: 25, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.467 Test Loss: 1.345 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8550035953521729
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.467 Test Loss: 1.366 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9933884143829346
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7033572196960449
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6830902099609375
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7346184253692627
Epoch: 4, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6712493896484375
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7122483253479004
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.856558084487915
Epoch: 7, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8482780456542969
Epoch: 8, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8472738265991211
Epoch: 9, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8645689487457275
Epoch: 10, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.807511568069458
Epoch: 11, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.790661096572876
Epoch: 12, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.768571138381958
Epoch: 13, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8071482181549072
Epoch: 14, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8025600910186768
Epoch: 15, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.770395040512085
Epoch: 16, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7703819274902344
Epoch: 17, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7175047397613525
Epoch: 18, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.727426290512085
Epoch: 19, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7213208675384521
Epoch: 20, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.356172561645508
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8062479496002197
Epoch: 2, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8494365215301514
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8285043239593506
Epoch: 4, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.7502286434173584
Epoch: 5, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8237385749816895
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7567744255065918
Epoch: 7, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8736023902893066
Epoch: 8, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8309288024902344
Epoch: 9, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7696540355682373
Epoch: 10, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8141257762908936
Epoch: 11, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7036161422729492
Epoch: 12, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.802664041519165
Epoch: 13, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8271183967590332
Epoch: 14, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.796839714050293
Epoch: 15, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7737760543823242
Epoch: 16, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 676131
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.7884089946746826
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 1.0150506496429443
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1167840957641602
Epoch: 3, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 1.0253326892852783
Epoch: 4, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.083677053451538
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.1227142810821533
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 1.0022356510162354
Epoch: 7, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9760007858276367
Epoch: 8, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7993242740631104
Epoch: 9, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7537226676940918
Epoch: 10, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8991453647613525
Epoch: 11, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.819772481918335
Epoch: 12, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.8908412456512451
Epoch: 13, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9297680854797363
Epoch: 14, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.408 Vali Acc: 0.400 Test Loss: 1.408 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9654402732849121
Epoch: 15, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.481 Vali Acc: 0.333 Test Loss: 1.481 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0151927471160889
Epoch: 16, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.556 Vali Acc: 0.333 Test Loss: 1.556 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0407450199127197
Epoch: 17, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.617 Vali Acc: 0.267 Test Loss: 1.617 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0777583122253418
Epoch: 18, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.670 Vali Acc: 0.267 Test Loss: 1.670 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9478583335876465
Epoch: 19, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.724 Vali Acc: 0.267 Test Loss: 1.724 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9959516525268555
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.782 Vali Acc: 0.267 Test Loss: 1.782 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0163218975067139
Epoch: 21, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.843 Vali Acc: 0.267 Test Loss: 1.843 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.027080774307251
Epoch: 22, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.905 Vali Acc: 0.267 Test Loss: 1.905 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.474236488342285
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7899646759033203
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7987446784973145
Epoch: 3, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8876655101776123
Epoch: 4, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9567298889160156
Epoch: 5, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0056304931640625
Epoch: 6, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.8820242881774902
Epoch: 7, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9183735847473145
Epoch: 8, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9985933303833008
Epoch: 9, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1650311946868896
Epoch: 10, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8933091163635254
Epoch: 11, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.902684211730957
Epoch: 12, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.258 Vali Acc: 0.200 Test Loss: 1.258 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9885504245758057
Epoch: 13, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9273614883422852
Epoch: 14, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.422 Vali Acc: 0.267 Test Loss: 1.422 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.907677173614502
Epoch: 15, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.502 Vali Acc: 0.267 Test Loss: 1.502 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8383579254150391
Epoch: 16, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.576 Vali Acc: 0.200 Test Loss: 1.576 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.441812515258789
Epoch: 1, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.8411159515380859
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8115239143371582
Epoch: 3, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9366836547851562
Epoch: 4, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8289754390716553
Epoch: 5, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8906717300415039
Epoch: 6, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9193675518035889
Epoch: 7, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9076933860778809
Epoch: 8, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9146633148193359
Epoch: 9, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9194025993347168
Epoch: 10, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9066393375396729
Epoch: 11, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.138883352279663
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.7543704509735107
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8465583324432373
Epoch: 3, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.8556196689605713
Epoch: 4, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7744719982147217
Epoch: 5, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7766003608703613
Epoch: 6, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7689483165740967
Epoch: 7, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7829272747039795
Epoch: 8, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.820317268371582
Epoch: 9, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7574725151062012
Epoch: 10, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7290635108947754
Epoch: 11, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7715232372283936
Epoch: 12, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6995158195495605
Epoch: 13, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6809821128845215
Epoch: 14, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.488 Vali Acc: 0.400 Test Loss: 1.488 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6604173183441162
Epoch: 15, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.610 Vali Acc: 0.400 Test Loss: 1.610 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7436997890472412
Epoch: 16, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.731 Vali Acc: 0.400 Test Loss: 1.731 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6851754188537598
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.846 Vali Acc: 0.400 Test Loss: 1.846 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6461796760559082
Epoch: 18, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.950 Vali Acc: 0.333 Test Loss: 1.950 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.614025115966797
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.758843183517456
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7770793437957764
Epoch: 3, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8351593017578125
Epoch: 4, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8247244358062744
Epoch: 5, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.778266191482544
Epoch: 6, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.757697343826294
Epoch: 7, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7528834342956543
Epoch: 8, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6766841411590576
Epoch: 9, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7057969570159912
Epoch: 10, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.716388463973999
Epoch: 11, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8551325798034668
Epoch: 12, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7302436828613281
Epoch: 13, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.378 Vali Acc: 0.333 Test Loss: 1.378 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7528359889984131
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.477 Vali Acc: 0.333 Test Loss: 1.477 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.387446403503418
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8561687469482422
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7882709503173828
Epoch: 3, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7727622985839844
Epoch: 4, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7487020492553711
Epoch: 5, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8022670745849609
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8199753761291504
Epoch: 7, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7764625549316406
Epoch: 8, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6917250156402588
Epoch: 9, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6954922676086426
Epoch: 10, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7325727939605713
Epoch: 11, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.661785364151001
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.121 Vali Acc: 0.133 Test Loss: 1.121 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7130687236785889
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.7038428783416748
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7420299053192139
Epoch: 4, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.770054817199707
Epoch: 5, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7333071231842041
Epoch: 6, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6990218162536621
Epoch: 7, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.7342855930328369
Epoch: 8, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7240397930145264
Epoch: 9, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6359033584594727
Epoch: 10, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6290829181671143
Epoch: 11, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.683969259262085
Epoch: 12, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6664290428161621
Epoch: 13, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6467828750610352
Epoch: 14, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7490625381469727
Epoch: 15, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7914783954620361
Epoch: 16, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7374248504638672
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.413250207901001
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7060136795043945
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.133322 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.7300219535827637
Epoch: 3, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.167 Vali Acc: 0.533 Test Loss: 1.167 Test Acc: 0.533
Validation loss decreased (-0.399988 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.7279069423675537
Epoch: 4, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.177 Vali Acc: 0.600 Test Loss: 1.177 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.7195661067962646
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7266263961791992
Epoch: 6, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7246198654174805
Epoch: 7, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7923166751861572
Epoch: 8, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7395346164703369
Epoch: 9, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.075 Vali Acc: 0.267 Test Loss: 1.075 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.807459831237793
Epoch: 10, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.061 Vali Acc: 0.267 Test Loss: 1.061 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7175590991973877
Epoch: 11, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7889153957366943
Epoch: 12, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7696185111999512
Epoch: 13, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.808220624923706
Epoch: 14, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.367718458175659
Epoch: 1, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8499195575714111
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6785731315612793
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6758713722229004
Epoch: 4, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.679185152053833
Epoch: 5, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7817189693450928
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7701199054718018
Epoch: 7, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7889127731323242
Epoch: 8, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7225532531738281
Epoch: 9, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.7399015426635742
Epoch: 10, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.7978947162628174
Epoch: 11, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.6262156963348389
Epoch: 12, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.7357842922210693
Epoch: 13, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.019 Vali Acc: 0.400 Test Loss: 1.019 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7819175720214844
Epoch: 14, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.024 Vali Acc: 0.267 Test Loss: 1.024 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7333590984344482
Epoch: 15, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.029 Vali Acc: 0.267 Test Loss: 1.029 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7334730625152588
Epoch: 16, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7667171955108643
Epoch: 17, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7764053344726562
Epoch: 18, Steps: 1 | Train Loss: 0.109 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7209045886993408
Epoch: 19, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7728943824768066
Epoch: 20, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7757387161254883
Epoch: 21, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7881548404693604
Epoch: 22, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1696250438690186
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6714746952056885
Epoch: 2, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7826769351959229
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6635339260101318
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7149500846862793
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6918461322784424
Epoch: 6, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.684004545211792
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7128140926361084
Epoch: 8, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6637775897979736
Epoch: 9, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7128551006317139
Epoch: 10, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6439878940582275
Epoch: 11, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 479523
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.471956491470337
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.9121267795562744
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.0818867683410645
Epoch: 3, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0384442806243896
Epoch: 4, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0131793022155762
Epoch: 5, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0414862632751465
Epoch: 6, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9507267475128174
Epoch: 7, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8801405429840088
Epoch: 8, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 1.0248148441314697
Epoch: 9, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.9547536373138428
Epoch: 10, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9626200199127197
Epoch: 11, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.149522304534912
Epoch: 12, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0825066566467285
Epoch: 13, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9738409519195557
Epoch: 14, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9416236877441406
Epoch: 15, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.263 Vali Acc: 0.467 Test Loss: 1.263 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9099876880645752
Epoch: 16, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.353 Vali Acc: 0.467 Test Loss: 1.353 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0448682308197021
Epoch: 17, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.427 Vali Acc: 0.467 Test Loss: 1.427 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9772348403930664
Epoch: 18, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.489 Vali Acc: 0.467 Test Loss: 1.489 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9414620399475098
Epoch: 19, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.547 Vali Acc: 0.400 Test Loss: 1.547 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.362969160079956
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7900118827819824
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8808326721191406
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.791346549987793
Epoch: 4, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8069710731506348
Epoch: 5, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7813575267791748
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7516388893127441
Epoch: 7, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.8279018402099609
Epoch: 8, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7843878269195557
Epoch: 9, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7835376262664795
Epoch: 10, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9567165374755859
Epoch: 11, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.159048080444336
Epoch: 12, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9611098766326904
Epoch: 13, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8960151672363281
Epoch: 14, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8732852935791016
Epoch: 15, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9470212459564209
Epoch: 16, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.362 Vali Acc: 0.333 Test Loss: 1.362 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9573276042938232
Epoch: 17, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.431 Vali Acc: 0.333 Test Loss: 1.431 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.228663921356201
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.7493197917938232
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8780267238616943
Epoch: 3, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.9568769931793213
Epoch: 4, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9405882358551025
Epoch: 5, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9011015892028809
Epoch: 6, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7506306171417236
Epoch: 7, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8227994441986084
Epoch: 8, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.052 Vali Acc: 0.533 Test Loss: 1.052 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.8837323188781738
Epoch: 9, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8785088062286377
Epoch: 10, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.977292537689209
Epoch: 11, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8318929672241211
Epoch: 12, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8382360935211182
Epoch: 13, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8117237091064453
Epoch: 14, Steps: 1 | Train Loss: 0.067 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7971100807189941
Epoch: 15, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.244 Vali Acc: 0.467 Test Loss: 1.244 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9423739910125732
Epoch: 16, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.319 Vali Acc: 0.467 Test Loss: 1.319 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7948834896087646
Epoch: 17, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.382 Vali Acc: 0.467 Test Loss: 1.382 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8340516090393066
Epoch: 18, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.437 Vali Acc: 0.467 Test Loss: 1.437 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3641812801361084
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.198 Vali Acc: 0.467 Test Loss: 1.198 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.8271815776824951
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.8496723175048828
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.886887788772583
Epoch: 4, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7766509056091309
Epoch: 5, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7066617012023926
Epoch: 6, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.785088300704956
Epoch: 7, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8131544589996338
Epoch: 8, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7973232269287109
Epoch: 9, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.7708644866943359
Epoch: 10, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.196 Vali Acc: 0.600 Test Loss: 1.196 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.7914299964904785
Epoch: 11, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.271 Vali Acc: 0.533 Test Loss: 1.271 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7259645462036133
Epoch: 12, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.337 Vali Acc: 0.533 Test Loss: 1.337 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.901627779006958
Epoch: 13, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.404 Vali Acc: 0.467 Test Loss: 1.404 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.754530668258667
Epoch: 14, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.467 Vali Acc: 0.400 Test Loss: 1.467 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7613182067871094
Epoch: 15, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.548 Vali Acc: 0.400 Test Loss: 1.548 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8041417598724365
Epoch: 16, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.638 Vali Acc: 0.333 Test Loss: 1.638 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8583056926727295
Epoch: 17, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.737 Vali Acc: 0.333 Test Loss: 1.737 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8096232414245605
Epoch: 18, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.837 Vali Acc: 0.333 Test Loss: 1.837 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8156957626342773
Epoch: 19, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.934 Vali Acc: 0.333 Test Loss: 1.934 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9292745590209961
Epoch: 20, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.026 Vali Acc: 0.333 Test Loss: 2.026 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1801791191101074
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6964828968048096
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6692898273468018
Epoch: 3, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.7449648380279541
Epoch: 4, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8544137477874756
Epoch: 5, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.8047642707824707
Epoch: 6, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.8337757587432861
Epoch: 7, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7701780796051025
Epoch: 8, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.744140625
Epoch: 9, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7655014991760254
Epoch: 10, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7533838748931885
Epoch: 11, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7629852294921875
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.247 Vali Acc: 0.467 Test Loss: 1.247 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8261818885803223
Epoch: 13, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6830000877380371
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.399 Vali Acc: 0.333 Test Loss: 1.399 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7554032802581787
Epoch: 15, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.489 Vali Acc: 0.333 Test Loss: 1.489 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.742389440536499
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.582 Vali Acc: 0.333 Test Loss: 1.582 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.458512306213379
Epoch: 1, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.8027479648590088
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8717758655548096
Epoch: 3, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.791248083114624
Epoch: 4, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8112690448760986
Epoch: 5, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.905813455581665
Epoch: 6, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9006574153900146
Epoch: 7, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.188 Vali Acc: 0.133 Test Loss: 1.188 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8146076202392578
Epoch: 8, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.890596866607666
Epoch: 9, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.242 Vali Acc: 0.200 Test Loss: 1.242 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8138055801391602
Epoch: 10, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7685823440551758
Epoch: 11, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.375 Vali Acc: 0.333 Test Loss: 1.375 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7058041095733643
Epoch: 12, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.422 Vali Acc: 0.200 Test Loss: 1.422 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7436563968658447
Epoch: 13, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.484 Vali Acc: 0.200 Test Loss: 1.484 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.580470085144043
Epoch: 1, Steps: 1 | Train Loss: 1.330 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6972522735595703
Epoch: 2, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7751240730285645
Epoch: 3, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7293784618377686
Epoch: 4, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7812380790710449
Epoch: 5, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.7414450645446777
Epoch: 6, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7676475048065186
Epoch: 7, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6467640399932861
Epoch: 8, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6310288906097412
Epoch: 9, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6133878231048584
Epoch: 10, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.673487663269043
Epoch: 11, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6690859794616699
Epoch: 12, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6588904857635498
Epoch: 13, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6627545356750488
Epoch: 14, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6323826313018799
Epoch: 15, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6037960052490234
Epoch: 16, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6462109088897705
Epoch: 17, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7975528240203857
Epoch: 18, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.743511438369751
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7300481796264648
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.284 Vali Acc: 0.333 Test Loss: 1.284 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.117785930633545
Epoch: 1, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6640076637268066
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6198971271514893
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6969788074493408
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6588442325592041
Epoch: 5, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.6471993923187256
Epoch: 6, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6418037414550781
Epoch: 7, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.034 Vali Acc: 0.400 Test Loss: 1.034 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7443594932556152
Epoch: 8, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7127964496612549
Epoch: 9, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7997226715087891
Epoch: 10, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7778782844543457
Epoch: 11, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.016 Vali Acc: 0.467 Test Loss: 1.016 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7634313106536865
Epoch: 12, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7378904819488525
Epoch: 13, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.750079870223999
Epoch: 14, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.011 Vali Acc: 0.533 Test Loss: 1.011 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.720252513885498
Epoch: 15, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7395648956298828
Epoch: 16, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7702414989471436
Epoch: 17, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7975606918334961
Epoch: 18, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7298984527587891
Epoch: 19, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6231434345245361
Epoch: 20, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6781606674194336
Epoch: 21, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.156 Vali Acc: 0.533 Test Loss: 1.156 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6180746555328369
Epoch: 22, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.161 Vali Acc: 0.533 Test Loss: 1.161 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6546924114227295
Epoch: 23, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.165 Vali Acc: 0.533 Test Loss: 1.165 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7061665058135986
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.169 Vali Acc: 0.533 Test Loss: 1.169 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2205874919891357
Epoch: 1, Steps: 1 | Train Loss: 1.283 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7443575859069824
Epoch: 2, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.045 Vali Acc: 0.333 Test Loss: 1.045 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7143945693969727
Epoch: 3, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7764768600463867
Epoch: 4, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.755648136138916
Epoch: 5, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.7680883407592773
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.7884635925292969
Epoch: 7, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.024 Vali Acc: 0.400 Test Loss: 1.024 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6988191604614258
Epoch: 8, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.017 Vali Acc: 0.333 Test Loss: 1.017 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7670798301696777
Epoch: 9, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 10 cost time: 0.6778910160064697
Epoch: 10, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6428849697113037
Epoch: 11, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.003 Vali Acc: 0.400 Test Loss: 1.003 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6443932056427002
Epoch: 12, Steps: 1 | Train Loss: 0.452 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.466657 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 0.6345243453979492
Epoch: 13, Steps: 1 | Train Loss: 0.363 Vali Loss: 0.987 Vali Acc: 0.467 Test Loss: 0.987 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6340682506561279
Epoch: 14, Steps: 1 | Train Loss: 0.352 Vali Loss: 0.984 Vali Acc: 0.467 Test Loss: 0.984 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5971968173980713
Epoch: 15, Steps: 1 | Train Loss: 0.329 Vali Loss: 0.977 Vali Acc: 0.533 Test Loss: 0.977 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6501345634460449
Epoch: 16, Steps: 1 | Train Loss: 0.188 Vali Loss: 0.981 Vali Acc: 0.467 Test Loss: 0.981 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5835342407226562
Epoch: 17, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.007 Vali Acc: 0.467 Test Loss: 1.007 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6666369438171387
Epoch: 18, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.735184907913208
Epoch: 19, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.004 Vali Acc: 0.467 Test Loss: 1.004 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7400779724121094
Epoch: 20, Steps: 1 | Train Loss: 0.064 Vali Loss: 0.992 Vali Acc: 0.467 Test Loss: 0.992 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.741980791091919
Epoch: 21, Steps: 1 | Train Loss: 0.042 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7105057239532471
Epoch: 22, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.013 Vali Acc: 0.467 Test Loss: 1.013 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.117804527282715
Epoch: 1, Steps: 1 | Train Loss: 1.253 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5478360652923584
Epoch: 2, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.058 Vali Acc: 0.533 Test Loss: 1.058 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6260879039764404
Epoch: 3, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7673609256744385
Epoch: 4, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7005035877227783
Epoch: 5, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8229141235351562
Epoch: 6, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.668931245803833
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.778527021408081
Epoch: 8, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.041 Vali Acc: 0.400 Test Loss: 1.041 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7461340427398682
Epoch: 9, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.821831464767456
Epoch: 10, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8872830867767334
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9131875038146973
Epoch: 12, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 381219
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4503209590911865
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.8436455726623535
Epoch: 2, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8368659019470215
Epoch: 3, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9224154949188232
Epoch: 4, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9082763195037842
Epoch: 5, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.9270176887512207
Epoch: 6, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 1.0456993579864502
Epoch: 7, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.005 Vali Acc: 0.400 Test Loss: 1.005 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9521880149841309
Epoch: 8, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.002 Vali Acc: 0.400 Test Loss: 1.002 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.928898811340332
Epoch: 9, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8682990074157715
Epoch: 10, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.028 Vali Acc: 0.467 Test Loss: 1.028 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8502357006072998
Epoch: 11, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8748416900634766
Epoch: 12, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8997206687927246
Epoch: 13, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0220105648040771
Epoch: 14, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.185 Vali Acc: 0.467 Test Loss: 1.185 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9502718448638916
Epoch: 15, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.239 Vali Acc: 0.467 Test Loss: 1.239 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9471695423126221
Epoch: 16, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.309 Vali Acc: 0.467 Test Loss: 1.309 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4582324028015137
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.865241527557373
Epoch: 2, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9252369403839111
Epoch: 3, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.9407696723937988
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9024450778961182
Epoch: 5, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.8147242069244385
Epoch: 6, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.8772971630096436
Epoch: 7, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.9087851047515869
Epoch: 8, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8322100639343262
Epoch: 9, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8762011528015137
Epoch: 10, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8657464981079102
Epoch: 11, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8099017143249512
Epoch: 12, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8918147087097168
Epoch: 13, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8875961303710938
Epoch: 14, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8408067226409912
Epoch: 15, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8332829475402832
Epoch: 16, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.407 Vali Acc: 0.333 Test Loss: 1.407 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8727841377258301
Epoch: 17, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.472 Vali Acc: 0.333 Test Loss: 1.472 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8499770164489746
Epoch: 18, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.542 Vali Acc: 0.333 Test Loss: 1.542 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.580656051635742
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7695863246917725
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7757689952850342
Epoch: 3, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8069822788238525
Epoch: 4, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9129269123077393
Epoch: 5, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.947300910949707
Epoch: 6, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.903451681137085
Epoch: 7, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.9149737358093262
Epoch: 8, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.7418906688690186
Epoch: 9, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.775202751159668
Epoch: 10, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.748809814453125
Epoch: 11, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.842414379119873
Epoch: 12, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8169159889221191
Epoch: 13, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8321900367736816
Epoch: 14, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.246 Vali Acc: 0.400 Test Loss: 1.246 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8156702518463135
Epoch: 15, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8105058670043945
Epoch: 16, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8048887252807617
Epoch: 17, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.402 Vali Acc: 0.400 Test Loss: 1.402 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7256410121917725
Epoch: 18, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.464 Vali Acc: 0.400 Test Loss: 1.464 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3626506328582764
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.007 Vali Acc: 0.333 Test Loss: 1.007 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.7122700214385986
Epoch: 2, Steps: 1 | Train Loss: 0.998 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
Validation loss decreased (-0.333323 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.6758575439453125
Epoch: 3, Steps: 1 | Train Loss: 0.923 Vali Loss: 0.992 Vali Acc: 0.667 Test Loss: 0.992 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 0.7953863143920898
Epoch: 4, Steps: 1 | Train Loss: 0.845 Vali Loss: 0.987 Vali Acc: 0.667 Test Loss: 0.987 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 0.6972663402557373
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7742388248443604
Epoch: 6, Steps: 1 | Train Loss: 0.799 Vali Loss: 0.968 Vali Acc: 0.533 Test Loss: 0.968 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7534172534942627
Epoch: 7, Steps: 1 | Train Loss: 0.597 Vali Loss: 0.957 Vali Acc: 0.533 Test Loss: 0.957 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.763873815536499
Epoch: 8, Steps: 1 | Train Loss: 0.510 Vali Loss: 0.957 Vali Acc: 0.533 Test Loss: 0.957 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7190062999725342
Epoch: 9, Steps: 1 | Train Loss: 0.429 Vali Loss: 0.973 Vali Acc: 0.467 Test Loss: 0.973 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6687283515930176
Epoch: 10, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6839468479156494
Epoch: 11, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6864237785339355
Epoch: 12, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.189 Vali Acc: 0.533 Test Loss: 1.189 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7612290382385254
Epoch: 13, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.276 Vali Acc: 0.467 Test Loss: 1.276 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.711247444152832
Epoch: 14, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.367 Vali Acc: 0.467 Test Loss: 1.367 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2230443954467773
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7856705188751221
Epoch: 2, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.751957893371582
Epoch: 3, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7273697853088379
Epoch: 4, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6977212429046631
Epoch: 5, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7472689151763916
Epoch: 6, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7310371398925781
Epoch: 7, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6188209056854248
Epoch: 8, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.7314026355743408
Epoch: 9, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6630146503448486
Epoch: 10, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6744606494903564
Epoch: 11, Steps: 1 | Train Loss: 0.168 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7218031883239746
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7281551361083984
Epoch: 13, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7358672618865967
Epoch: 14, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.365 Vali Acc: 0.267 Test Loss: 1.365 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7048017978668213
Epoch: 15, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.437 Vali Acc: 0.267 Test Loss: 1.437 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7180325984954834
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.509 Vali Acc: 0.267 Test Loss: 1.509 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7326529026031494
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.581 Vali Acc: 0.267 Test Loss: 1.581 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7480456829071045
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.652 Vali Acc: 0.267 Test Loss: 1.652 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.266810178756714
Epoch: 1, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6132781505584717
Epoch: 2, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7162563800811768
Epoch: 3, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6734166145324707
Epoch: 4, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7119243144989014
Epoch: 5, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.224 Vali Acc: 0.333 Test Loss: 1.224 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.63222336769104
Epoch: 6, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.654536247253418
Epoch: 7, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7024497985839844
Epoch: 8, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6139421463012695
Epoch: 9, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6759321689605713
Epoch: 10, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.356 Vali Acc: 0.400 Test Loss: 1.356 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7011079788208008
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.424 Vali Acc: 0.333 Test Loss: 1.424 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.724696159362793
Epoch: 12, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.512 Vali Acc: 0.333 Test Loss: 1.512 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6261610984802246
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.601 Vali Acc: 0.333 Test Loss: 1.601 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7742254734039307
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.694 Vali Acc: 0.333 Test Loss: 1.694 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7532317638397217
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.793 Vali Acc: 0.400 Test Loss: 1.793 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6576156616210938
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.894 Vali Acc: 0.400 Test Loss: 1.894 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.025777816772461
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.183 Vali Acc: 0.133 Test Loss: 1.183 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.6945347785949707
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7139782905578613
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.670651912689209
Epoch: 4, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6852633953094482
Epoch: 5, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6842978000640869
Epoch: 6, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6229121685028076
Epoch: 7, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.718543529510498
Epoch: 8, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6579103469848633
Epoch: 9, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6476683616638184
Epoch: 10, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.714951753616333
Epoch: 11, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6677989959716797
Epoch: 12, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6795549392700195
Epoch: 13, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8059418201446533
Epoch: 14, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.6359407901763916
Epoch: 15, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7264900207519531
Epoch: 16, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.272 Vali Acc: 0.467 Test Loss: 1.272 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5859687328338623
Epoch: 17, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.299 Vali Acc: 0.467 Test Loss: 1.299 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6056559085845947
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.325 Vali Acc: 0.467 Test Loss: 1.325 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.624225378036499
Epoch: 19, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.350 Vali Acc: 0.467 Test Loss: 1.350 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6984302997589111
Epoch: 20, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6205697059631348
Epoch: 21, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.393 Vali Acc: 0.400 Test Loss: 1.393 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6469221115112305
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.617584228515625
Epoch: 23, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.400 Test Loss: 1.430 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7113058567047119
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.467 Test Loss: 1.447 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1931350231170654
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6064674854278564
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6730575561523438
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5879180431365967
Epoch: 4, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6360604763031006
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5842859745025635
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6661434173583984
Epoch: 7, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6648697853088379
Epoch: 8, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.622614860534668
Epoch: 9, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.5867078304290771
Epoch: 10, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.6261005401611328
Epoch: 11, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.5950789451599121
Epoch: 12, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6690654754638672
Epoch: 13, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.654548168182373
Epoch: 14, Steps: 1 | Train Loss: 0.114 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6890366077423096
Epoch: 15, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.70428466796875
Epoch: 16, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6559317111968994
Epoch: 17, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.740715742111206
Epoch: 18, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7335338592529297
Epoch: 19, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6940712928771973
Epoch: 20, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6558396816253662
Epoch: 21, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.505697250366211
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7295379638671875
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6266217231750488
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6348919868469238
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.693192720413208
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7676548957824707
Epoch: 6, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.7041323184967041
Epoch: 7, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5583162307739258
Epoch: 8, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.058 Vali Acc: 0.333 Test Loss: 1.058 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6509947776794434
Epoch: 9, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.6417899131774902
Epoch: 10, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.6668884754180908
Epoch: 11, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.021 Vali Acc: 0.400 Test Loss: 1.021 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.705613374710083
Epoch: 12, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.014 Vali Acc: 0.400 Test Loss: 1.014 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 13 cost time: 0.6193516254425049
Epoch: 13, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 14 cost time: 0.6566717624664307
Epoch: 14, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.020 Vali Acc: 0.400 Test Loss: 1.020 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7074127197265625
Epoch: 15, Steps: 1 | Train Loss: 0.252 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6589343547821045
Epoch: 16, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.682009220123291
Epoch: 17, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 18 cost time: 0.7090420722961426
Epoch: 18, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.025 Vali Acc: 0.467 Test Loss: 1.025 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6847677230834961
Epoch: 19, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7384154796600342
Epoch: 20, Steps: 1 | Train Loss: 0.070 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6331477165222168
Epoch: 21, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6855523586273193
Epoch: 22, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7558159828186035
Epoch: 23, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6306824684143066
Epoch: 24, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6375494003295898
Epoch: 25, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8196408748626709
Epoch: 26, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6096909046173096
Epoch: 27, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0715765953063965
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5931549072265625
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6976172924041748
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8711214065551758
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7234714031219482
Epoch: 5, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7728188037872314
Epoch: 6, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6508452892303467
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6560571193695068
Epoch: 8, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8094332218170166
Epoch: 9, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.399989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.7809152603149414
Epoch: 10, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.708320140838623
Epoch: 11, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.75978684425354
Epoch: 12, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7545068264007568
Epoch: 13, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6898722648620605
Epoch: 14, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.099 Vali Acc: 0.600 Test Loss: 1.099 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6779968738555908
Epoch: 15, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7277932167053223
Epoch: 16, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7654476165771484
Epoch: 17, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7471721172332764
Epoch: 18, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7878901958465576
Epoch: 19, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.221 Vali Acc: 0.467 Test Loss: 1.221 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 332067
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1250                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.375828981399536
Epoch: 1, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.9750714302062988
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.8140504360198975
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.8339407444000244
Epoch: 4, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9555306434631348
Epoch: 5, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9483673572540283
Epoch: 6, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.9300861358642578
Epoch: 7, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.938370943069458
Epoch: 8, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.7784979343414307
Epoch: 9, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.829470157623291
Epoch: 10, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7486648559570312
Epoch: 11, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7503902912139893
Epoch: 12, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 13 cost time: 0.7761619091033936
Epoch: 13, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.256 Vali Acc: 0.400 Test Loss: 1.256 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7876536846160889
Epoch: 14, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.327 Vali Acc: 0.467 Test Loss: 1.327 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466653).  Saving model ...
Epoch: 15 cost time: 0.7634406089782715
Epoch: 15, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.370 Vali Acc: 0.467 Test Loss: 1.370 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7323470115661621
Epoch: 16, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.410 Vali Acc: 0.333 Test Loss: 1.410 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7433056831359863
Epoch: 17, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.455 Vali Acc: 0.333 Test Loss: 1.455 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.811730146408081
Epoch: 18, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.511 Vali Acc: 0.267 Test Loss: 1.511 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9381906986236572
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.567 Vali Acc: 0.333 Test Loss: 1.567 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8669664859771729
Epoch: 20, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.626 Vali Acc: 0.333 Test Loss: 1.626 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8340930938720703
Epoch: 21, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.682 Vali Acc: 0.333 Test Loss: 1.682 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7152376174926758
Epoch: 22, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.735 Vali Acc: 0.333 Test Loss: 1.735 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8395416736602783
Epoch: 23, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.786 Vali Acc: 0.333 Test Loss: 1.786 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8921229839324951
Epoch: 24, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.333 Test Loss: 1.837 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1000                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.435455799102783
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7423341274261475
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7492787837982178
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8364667892456055
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7660191059112549
Epoch: 5, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8388659954071045
Epoch: 6, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7457375526428223
Epoch: 7, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8761301040649414
Epoch: 8, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8616876602172852
Epoch: 9, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9740681648254395
Epoch: 10, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8472731113433838
Epoch: 11, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7801721096038818
Epoch: 12, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7436730861663818
Epoch: 13, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         750                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.338491439819336
Epoch: 1, Steps: 1 | Train Loss: 1.231 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8008935451507568
Epoch: 2, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7281520366668701
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6880662441253662
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7905483245849609
Epoch: 5, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.744269847869873
Epoch: 6, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7673289775848389
Epoch: 7, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8230414390563965
Epoch: 8, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8435337543487549
Epoch: 9, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.787987470626831
Epoch: 10, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7390744686126709
Epoch: 11, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7633659839630127
Epoch: 12, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8254718780517578
Epoch: 13, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6927251815795898
Epoch: 14, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.244 Vali Acc: 0.467 Test Loss: 1.244 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7613797187805176
Epoch: 15, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.288 Vali Acc: 0.467 Test Loss: 1.288 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.853792667388916
Epoch: 16, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.338 Vali Acc: 0.467 Test Loss: 1.338 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7843227386474609
Epoch: 17, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.385 Vali Acc: 0.467 Test Loss: 1.385 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7767622470855713
Epoch: 18, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.441 Vali Acc: 0.467 Test Loss: 1.441 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8452944755554199
Epoch: 19, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.494 Vali Acc: 0.467 Test Loss: 1.494 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         500                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1308419704437256
Epoch: 1, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7615401744842529
Epoch: 2, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7747056484222412
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7851648330688477
Epoch: 4, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.6354849338531494
Epoch: 5, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8605644702911377
Epoch: 6, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.7132556438446045
Epoch: 7, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.7554736137390137
Epoch: 8, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7546744346618652
Epoch: 9, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6869721412658691
Epoch: 10, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.71297287940979
Epoch: 11, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6965627670288086
Epoch: 12, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8145256042480469
Epoch: 13, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.352 Vali Acc: 0.467 Test Loss: 1.352 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7209265232086182
Epoch: 14, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.470 Vali Acc: 0.467 Test Loss: 1.470 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7364773750305176
Epoch: 15, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.568 Vali Acc: 0.467 Test Loss: 1.568 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.732811689376831
Epoch: 16, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.664 Vali Acc: 0.400 Test Loss: 1.664 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8099813461303711
Epoch: 17, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.763 Vali Acc: 0.400 Test Loss: 1.763 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         250                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.139418601989746
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6745831966400146
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7340548038482666
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7096817493438721
Epoch: 4, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6608142852783203
Epoch: 5, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6555197238922119
Epoch: 6, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6657199859619141
Epoch: 7, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6639056205749512
Epoch: 8, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7504236698150635
Epoch: 9, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7710573673248291
Epoch: 10, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7364282608032227
Epoch: 11, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.690208911895752
Epoch: 12, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.331 Vali Acc: 0.267 Test Loss: 1.331 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7593648433685303
Epoch: 13, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.410 Vali Acc: 0.267 Test Loss: 1.410 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8051495552062988
Epoch: 14, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.497 Vali Acc: 0.267 Test Loss: 1.497 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6960067749023438
Epoch: 15, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.587 Vali Acc: 0.267 Test Loss: 1.587 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7933263778686523
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.678 Vali Acc: 0.267 Test Loss: 1.678 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7622208595275879
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.770 Vali Acc: 0.267 Test Loss: 1.770 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         125                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.4352822303771973
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6886131763458252
Epoch: 2, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.082 Vali Acc: 0.200 Test Loss: 1.082 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.771355152130127
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7426600456237793
Epoch: 4, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6181380748748779
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6970615386962891
Epoch: 6, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6740314960479736
Epoch: 7, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7143023014068604
Epoch: 8, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6553080081939697
Epoch: 9, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5975139141082764
Epoch: 10, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5777568817138672
Epoch: 11, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6103634834289551
Epoch: 12, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.368 Vali Acc: 0.400 Test Loss: 1.368 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7411565780639648
Epoch: 13, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.451 Vali Acc: 0.333 Test Loss: 1.451 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         75                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.272439956665039
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.031 Vali Acc: 0.333 Test Loss: 1.031 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.748429536819458
Epoch: 2, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.001 Vali Acc: 0.467 Test Loss: 1.001 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466657).  Saving model ...
Epoch: 3 cost time: 0.7013897895812988
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 0.986 Vali Acc: 0.600 Test Loss: 0.986 Test Acc: 0.600
Validation loss decreased (-0.466657 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.6276147365570068
Epoch: 4, Steps: 1 | Train Loss: 1.020 Vali Loss: 0.980 Vali Acc: 0.533 Test Loss: 0.980 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7030651569366455
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 0.979 Vali Acc: 0.533 Test Loss: 0.979 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6325588226318359
Epoch: 6, Steps: 1 | Train Loss: 0.803 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7128586769104004
Epoch: 7, Steps: 1 | Train Loss: 0.768 Vali Loss: 0.976 Vali Acc: 0.533 Test Loss: 0.976 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.756537914276123
Epoch: 8, Steps: 1 | Train Loss: 0.590 Vali Loss: 0.981 Vali Acc: 0.467 Test Loss: 0.981 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7598702907562256
Epoch: 9, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.001 Vali Acc: 0.400 Test Loss: 1.001 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6446962356567383
Epoch: 10, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.005 Vali Acc: 0.467 Test Loss: 1.005 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7321045398712158
Epoch: 11, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.856813907623291
Epoch: 12, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8333549499511719
Epoch: 13, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1685612201690674
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7220005989074707
Epoch: 2, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7223219871520996
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7093732357025146
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6934518814086914
Epoch: 5, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7515828609466553
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7871367931365967
Epoch: 7, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6999287605285645
Epoch: 8, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.008 Vali Acc: 0.467 Test Loss: 1.008 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.73691725730896
Epoch: 9, Steps: 1 | Train Loss: 0.534 Vali Loss: 0.994 Vali Acc: 0.467 Test Loss: 0.994 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8191556930541992
Epoch: 10, Steps: 1 | Train Loss: 0.421 Vali Loss: 0.976 Vali Acc: 0.400 Test Loss: 0.976 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6888406276702881
Epoch: 11, Steps: 1 | Train Loss: 0.285 Vali Loss: 0.966 Vali Acc: 0.467 Test Loss: 0.966 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7822225093841553
Epoch: 12, Steps: 1 | Train Loss: 0.248 Vali Loss: 0.980 Vali Acc: 0.400 Test Loss: 0.980 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.951951265335083
Epoch: 1, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6383073329925537
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7387888431549072
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6146938800811768
Epoch: 4, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6154148578643799
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.670661211013794
Epoch: 6, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.677809476852417
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5803120136260986
Epoch: 8, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6122572422027588
Epoch: 9, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.640084981918335
Epoch: 10, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.6736228466033936
Epoch: 11, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6133606433868408
Epoch: 12, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7042384147644043
Epoch: 13, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.056 Vali Acc: 0.400 Test Loss: 1.056 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6127655506134033
Epoch: 14, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6123855113983154
Epoch: 15, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.030 Vali Acc: 0.400 Test Loss: 1.030 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6607770919799805
Epoch: 16, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6208386421203613
Epoch: 17, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 18 cost time: 0.6656839847564697
Epoch: 18, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5973446369171143
Epoch: 19, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6147336959838867
Epoch: 20, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6414530277252197
Epoch: 21, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6707217693328857
Epoch: 22, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6845901012420654
Epoch: 23, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6680693626403809
Epoch: 24, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6257038116455078
Epoch: 25, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5996518135070801
Epoch: 26, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.641502857208252
Epoch: 27, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 307491
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
fourier enhanced block used!
modes=32, index=[27, 106, 134, 210, 220, 242, 250, 286, 291, 298, 300, 315, 384, 429, 438, 459, 633, 666, 684, 692, 773, 802, 837, 849, 864, 984, 1036, 1115, 1117, 1185, 1186, 1218]
fourier enhanced block used!
modes=32, index=[7, 71, 79, 109, 118, 136, 143, 163, 188, 189, 212, 250, 256, 260, 276, 287, 300, 308, 323, 359, 361, 375, 380, 397, 422, 448, 477, 508, 562, 601, 603, 613]
 fourier enhanced cross attention used!
modes_q=32, index_q=[40, 60, 66, 67, 81, 91, 92, 104, 128, 161, 189, 238, 263, 288, 289, 306, 352, 357, 366, 397, 406, 442, 490, 502, 535, 538, 545, 547, 551, 582, 596, 611]
modes_kv=32, index_kv=[20, 81, 87, 91, 109, 153, 154, 188, 193, 246, 309, 347, 379, 388, 435, 442, 548, 561, 586, 668, 681, 735, 748, 756, 780, 786, 801, 913, 918, 955, 1134, 1151]
>>>>>>>start training : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1719722747802734
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6942892074584961
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6129453182220459
Epoch: 3, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.608656644821167
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7884435653686523
Epoch: 5, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6617205142974854
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.750913143157959
Epoch: 7, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8338000774383545
Epoch: 8, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6242985725402832
Epoch: 9, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7296614646911621
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8188042640686035
Epoch: 11, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7607269287109375
Epoch: 12, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7641596794128418
Epoch: 13, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6725037097930908
Epoch: 14, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7404270172119141
Epoch: 15, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7221548557281494
Epoch: 16, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_FEDformer_UEA_ftM_sl2500_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 307491
model size : 2.42MB
