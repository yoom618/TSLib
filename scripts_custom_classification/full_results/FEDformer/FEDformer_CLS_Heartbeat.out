Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.27806282043457
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 7.273786544799805
Epoch: 2, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.6915199756622314
Epoch: 3, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.966 Vali Acc: 0.473 Test Loss: 0.966 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.160021543502808
Epoch: 4, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.595 Vali Acc: 0.732 Test Loss: 1.595 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.179259061813354
Epoch: 5, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.951 Vali Acc: 0.693 Test Loss: 0.951 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.171180963516235
Epoch: 6, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.079 Vali Acc: 0.732 Test Loss: 2.079 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.861441850662231
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.903 Vali Acc: 0.722 Test Loss: 1.903 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.898050785064697
Epoch: 8, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.636 Vali Acc: 0.629 Test Loss: 1.636 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.535250663757324
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 3.469 Vali Acc: 0.722 Test Loss: 3.469 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.159012794494629
Epoch: 10, Steps: 13 | Train Loss: 0.229 Vali Loss: 2.585 Vali Acc: 0.576 Test Loss: 2.585 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.500920057296753
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 2.664 Vali Acc: 0.571 Test Loss: 2.664 Test Acc: 0.571
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.666878461837769
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.604 Vali Acc: 0.741 Test Loss: 0.604 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 6.361392974853516
Epoch: 2, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.935813426971436
Epoch: 3, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.753 Vali Acc: 0.688 Test Loss: 0.753 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.036523580551147
Epoch: 4, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.929 Vali Acc: 0.722 Test Loss: 0.929 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.120969772338867
Epoch: 5, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.691 Vali Acc: 0.429 Test Loss: 1.691 Test Acc: 0.429
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.826840162277222
Epoch: 6, Steps: 13 | Train Loss: 0.234 Vali Loss: 2.233 Vali Acc: 0.727 Test Loss: 2.233 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.556302785873413
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.579 Vali Acc: 0.693 Test Loss: 1.579 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.71015214920044
Epoch: 8, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.591 Vali Acc: 0.659 Test Loss: 1.591 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.388341188430786
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.487 Vali Acc: 0.737 Test Loss: 2.487 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.18962049484253
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.365 Vali Acc: 0.405 Test Loss: 3.365 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.618772745132446
Epoch: 11, Steps: 13 | Train Loss: 0.059 Vali Loss: 3.965 Vali Acc: 0.717 Test Loss: 3.965 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.185037851333618
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 5.66534948348999
Epoch: 2, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.836 Vali Acc: 0.741 Test Loss: 0.836 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741455).  Saving model ...
Epoch: 3 cost time: 7.240089178085327
Epoch: 3, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.871 Vali Acc: 0.717 Test Loss: 0.871 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.592053174972534
Epoch: 4, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.977 Vali Acc: 0.732 Test Loss: 0.977 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.9237220287323
Epoch: 5, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.083 Vali Acc: 0.683 Test Loss: 1.083 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.967031478881836
Epoch: 6, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.260 Vali Acc: 0.683 Test Loss: 1.260 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.632038593292236
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.605 Vali Acc: 0.737 Test Loss: 1.605 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.527098655700684
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.240 Vali Acc: 0.483 Test Loss: 2.240 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.471638917922974
Epoch: 9, Steps: 13 | Train Loss: 0.094 Vali Loss: 2.164 Vali Acc: 0.717 Test Loss: 2.164 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.624058246612549
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.797 Vali Acc: 0.615 Test Loss: 1.797 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.449356555938721
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 3.880 Vali Acc: 0.420 Test Loss: 3.880 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.13224720954895
Epoch: 12, Steps: 13 | Train Loss: 0.178 Vali Loss: 2.556 Vali Acc: 0.741 Test Loss: 2.556 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.959879636764526
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 8.525084972381592
Epoch: 2, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.619 Vali Acc: 0.707 Test Loss: 0.619 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.026111602783203
Epoch: 3, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.847 Vali Acc: 0.717 Test Loss: 0.847 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717065).  Saving model ...
Epoch: 4 cost time: 8.045687675476074
Epoch: 4, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.899 Vali Acc: 0.600 Test Loss: 0.899 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.270601272583008
Epoch: 5, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.077 Vali Acc: 0.615 Test Loss: 1.077 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.633883714675903
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.264 Vali Acc: 0.717 Test Loss: 2.264 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.991796493530273
Epoch: 7, Steps: 13 | Train Loss: 0.054 Vali Loss: 2.024 Vali Acc: 0.727 Test Loss: 2.024 Test Acc: 0.727
Validation loss decreased (-0.717065 --> -0.726809).  Saving model ...
Epoch: 8 cost time: 6.57507586479187
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.818 Vali Acc: 0.493 Test Loss: 1.818 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.87634015083313
Epoch: 9, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.296 Vali Acc: 0.732 Test Loss: 2.296 Test Acc: 0.732
Validation loss decreased (-0.726809 --> -0.731684).  Saving model ...
Epoch: 10 cost time: 8.510428667068481
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.907 Vali Acc: 0.629 Test Loss: 1.907 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.265515804290771
Epoch: 11, Steps: 13 | Train Loss: 0.011 Vali Loss: 3.331 Vali Acc: 0.722 Test Loss: 3.331 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.413920402526855
Epoch: 12, Steps: 13 | Train Loss: 0.025 Vali Loss: 2.199 Vali Acc: 0.605 Test Loss: 2.199 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.186106443405151
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.735 Vali Acc: 0.707 Test Loss: 2.735 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.252108335494995
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 2.819 Vali Acc: 0.605 Test Loss: 2.819 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.936028003692627
Epoch: 15, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.979 Vali Acc: 0.688 Test Loss: 3.979 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.444815397262573
Epoch: 16, Steps: 13 | Train Loss: 0.051 Vali Loss: 5.399 Vali Acc: 0.717 Test Loss: 5.399 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.669552803039551
Epoch: 17, Steps: 13 | Train Loss: 0.172 Vali Loss: 5.818 Vali Acc: 0.717 Test Loss: 5.818 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.2284510135650635
Epoch: 18, Steps: 13 | Train Loss: 0.313 Vali Loss: 4.918 Vali Acc: 0.659 Test Loss: 4.918 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.215328931808472
Epoch: 19, Steps: 13 | Train Loss: 0.192 Vali Loss: 5.827 Vali Acc: 0.751 Test Loss: 5.827 Test Acc: 0.751
Validation loss decreased (-0.731684 --> -0.751161).  Saving model ...
Epoch: 20 cost time: 7.575896263122559
Epoch: 20, Steps: 13 | Train Loss: 0.318 Vali Loss: 6.971 Vali Acc: 0.737 Test Loss: 6.971 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.749852418899536
Epoch: 21, Steps: 13 | Train Loss: 0.170 Vali Loss: 6.431 Vali Acc: 0.659 Test Loss: 6.431 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.194823741912842
Epoch: 22, Steps: 13 | Train Loss: 0.261 Vali Loss: 8.093 Vali Acc: 0.717 Test Loss: 8.093 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.217549562454224
Epoch: 23, Steps: 13 | Train Loss: 0.377 Vali Loss: 8.062 Vali Acc: 0.463 Test Loss: 8.062 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.478275775909424
Epoch: 24, Steps: 13 | Train Loss: 0.154 Vali Loss: 9.984 Vali Acc: 0.732 Test Loss: 9.984 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 8.024971961975098
Epoch: 25, Steps: 13 | Train Loss: 0.281 Vali Loss: 11.484 Vali Acc: 0.722 Test Loss: 11.484 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.119611263275146
Epoch: 26, Steps: 13 | Train Loss: 0.207 Vali Loss: 7.368 Vali Acc: 0.663 Test Loss: 7.368 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.487405776977539
Epoch: 27, Steps: 13 | Train Loss: 0.722 Vali Loss: 6.464 Vali Acc: 0.639 Test Loss: 6.464 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.748790979385376
Epoch: 28, Steps: 13 | Train Loss: 0.434 Vali Loss: 7.422 Vali Acc: 0.576 Test Loss: 7.422 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.235677480697632
Epoch: 29, Steps: 13 | Train Loss: 0.487 Vali Loss: 9.927 Vali Acc: 0.722 Test Loss: 9.927 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.398357391357422
Epoch: 1, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.623 Vali Acc: 0.756 Test Loss: 0.623 Test Acc: 0.756
Validation loss decreased (inf --> -0.756091).  Saving model ...
Epoch: 2 cost time: 7.921285390853882
Epoch: 2, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.724 Vali Acc: 0.746 Test Loss: 0.724 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.766463041305542
Epoch: 3, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.795 Vali Acc: 0.756 Test Loss: 0.795 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.814748287200928
Epoch: 4, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.986 Vali Acc: 0.707 Test Loss: 0.986 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.870630741119385
Epoch: 5, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.076 Vali Acc: 0.659 Test Loss: 1.076 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.750151872634888
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.017 Vali Acc: 0.761 Test Loss: 2.017 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760955).  Saving model ...
Epoch: 7 cost time: 6.879963636398315
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.809 Vali Acc: 0.737 Test Loss: 1.809 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.9396491050720215
Epoch: 8, Steps: 13 | Train Loss: 0.260 Vali Loss: 2.595 Vali Acc: 0.746 Test Loss: 2.595 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.934996128082275
Epoch: 9, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.922 Vali Acc: 0.615 Test Loss: 1.922 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.593110799789429
Epoch: 10, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.993 Vali Acc: 0.737 Test Loss: 1.993 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.464198350906372
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.413 Vali Acc: 0.761 Test Loss: 3.413 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.888483285903931
Epoch: 12, Steps: 13 | Train Loss: 0.137 Vali Loss: 2.690 Vali Acc: 0.659 Test Loss: 2.690 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.1987998485565186
Epoch: 13, Steps: 13 | Train Loss: 0.011 Vali Loss: 3.218 Vali Acc: 0.737 Test Loss: 3.218 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.502844333648682
Epoch: 14, Steps: 13 | Train Loss: 0.154 Vali Loss: 3.306 Vali Acc: 0.634 Test Loss: 3.306 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.141786098480225
Epoch: 15, Steps: 13 | Train Loss: 0.065 Vali Loss: 4.052 Vali Acc: 0.717 Test Loss: 4.052 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.2162446975708
Epoch: 16, Steps: 13 | Train Loss: 0.032 Vali Loss: 4.256 Vali Acc: 0.737 Test Loss: 4.256 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.705458879470825
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.614 Vali Acc: 0.727 Test Loss: 0.614 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 6.508427381515503
Epoch: 2, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.025 Vali Acc: 0.717 Test Loss: 1.025 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.0396692752838135
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.762 Vali Acc: 0.702 Test Loss: 0.762 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.2776172161102295
Epoch: 4, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.058 Vali Acc: 0.620 Test Loss: 1.058 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.289044380187988
Epoch: 5, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.989 Vali Acc: 0.732 Test Loss: 1.989 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731687).  Saving model ...
Epoch: 6 cost time: 6.548184156417847
Epoch: 6, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.466 Vali Acc: 0.605 Test Loss: 1.466 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.793349981307983
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.040 Vali Acc: 0.722 Test Loss: 2.040 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.433302164077759
Epoch: 8, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.990 Vali Acc: 0.629 Test Loss: 1.990 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.005924940109253
Epoch: 9, Steps: 13 | Train Loss: 0.043 Vali Loss: 2.444 Vali Acc: 0.717 Test Loss: 2.444 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.321347713470459
Epoch: 10, Steps: 13 | Train Loss: 0.168 Vali Loss: 2.354 Vali Acc: 0.644 Test Loss: 2.354 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.409708261489868
Epoch: 11, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.185 Vali Acc: 0.737 Test Loss: 3.185 Test Acc: 0.737
Validation loss decreased (-0.731687 --> -0.736554).  Saving model ...
Epoch: 12 cost time: 6.705538988113403
Epoch: 12, Steps: 13 | Train Loss: 0.061 Vali Loss: 2.842 Vali Acc: 0.595 Test Loss: 2.842 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.571802854537964
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 3.386 Vali Acc: 0.741 Test Loss: 3.386 Test Acc: 0.741
Validation loss decreased (-0.736554 --> -0.741430).  Saving model ...
Epoch: 14 cost time: 6.950496196746826
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 3.024 Vali Acc: 0.663 Test Loss: 3.024 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.080366611480713
Epoch: 15, Steps: 13 | Train Loss: 0.009 Vali Loss: 4.368 Vali Acc: 0.751 Test Loss: 4.368 Test Acc: 0.751
Validation loss decreased (-0.741430 --> -0.751176).  Saving model ...
Epoch: 16 cost time: 7.554140329360962
Epoch: 16, Steps: 13 | Train Loss: 0.043 Vali Loss: 3.931 Vali Acc: 0.717 Test Loss: 3.931 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.959646224975586
Epoch: 17, Steps: 13 | Train Loss: 0.143 Vali Loss: 3.941 Vali Acc: 0.707 Test Loss: 3.941 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.8475587368011475
Epoch: 18, Steps: 13 | Train Loss: 0.137 Vali Loss: 4.108 Vali Acc: 0.722 Test Loss: 4.108 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.157737970352173
Epoch: 19, Steps: 13 | Train Loss: 0.003 Vali Loss: 4.501 Vali Acc: 0.746 Test Loss: 4.501 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.88865327835083
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 7.284 Vali Acc: 0.741 Test Loss: 7.284 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.965252876281738
Epoch: 21, Steps: 13 | Train Loss: 0.316 Vali Loss: 5.505 Vali Acc: 0.737 Test Loss: 5.505 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.333166837692261
Epoch: 22, Steps: 13 | Train Loss: 0.263 Vali Loss: 6.795 Vali Acc: 0.741 Test Loss: 6.795 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.73145318031311
Epoch: 23, Steps: 13 | Train Loss: 0.613 Vali Loss: 6.346 Vali Acc: 0.659 Test Loss: 6.346 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.343066930770874
Epoch: 24, Steps: 13 | Train Loss: 0.171 Vali Loss: 6.158 Vali Acc: 0.659 Test Loss: 6.158 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.755587577819824
Epoch: 25, Steps: 13 | Train Loss: 0.489 Vali Loss: 7.721 Vali Acc: 0.663 Test Loss: 7.721 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.59402871131897
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.588 Vali Acc: 0.732 Test Loss: 0.588 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 7.109904527664185
Epoch: 2, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.920 Vali Acc: 0.717 Test Loss: 0.920 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.516031503677368
Epoch: 3, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.323 Vali Acc: 0.424 Test Loss: 1.323 Test Acc: 0.424
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.033544540405273
Epoch: 4, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.152 Vali Acc: 0.707 Test Loss: 1.152 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.400318145751953
Epoch: 5, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.939 Vali Acc: 0.702 Test Loss: 1.939 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.898009777069092
Epoch: 6, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.367 Vali Acc: 0.732 Test Loss: 1.367 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.50861668586731
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.434 Vali Acc: 0.746 Test Loss: 1.434 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746327).  Saving model ...
Epoch: 8 cost time: 7.113497257232666
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.448 Vali Acc: 0.600 Test Loss: 1.448 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.226612567901611
Epoch: 9, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.224 Vali Acc: 0.722 Test Loss: 2.224 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.836427211761475
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.025 Vali Acc: 0.707 Test Loss: 2.025 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.422733545303345
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.078 Vali Acc: 0.702 Test Loss: 2.078 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.378984451293945
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.612 Vali Acc: 0.698 Test Loss: 2.612 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.890437841415405
Epoch: 13, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.217 Vali Acc: 0.702 Test Loss: 2.217 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.558043479919434
Epoch: 14, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.975 Vali Acc: 0.702 Test Loss: 1.975 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.0026750564575195
Epoch: 15, Steps: 13 | Train Loss: 0.032 Vali Loss: 4.529 Vali Acc: 0.717 Test Loss: 4.529 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.161797285079956
Epoch: 16, Steps: 13 | Train Loss: 0.059 Vali Loss: 3.173 Vali Acc: 0.590 Test Loss: 3.173 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.745827674865723
Epoch: 17, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.955 Vali Acc: 0.644 Test Loss: 2.955 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.209348678588867
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 5.78835129737854
Epoch: 2, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.336 Vali Acc: 0.717 Test Loss: 1.336 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.74687385559082
Epoch: 3, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.879 Vali Acc: 0.580 Test Loss: 0.879 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.297702074050903
Epoch: 4, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.840 Vali Acc: 0.688 Test Loss: 0.840 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.492526531219482
Epoch: 5, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.150 Vali Acc: 0.712 Test Loss: 2.150 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.230551719665527
Epoch: 6, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.185 Vali Acc: 0.712 Test Loss: 1.185 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.477442264556885
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.792 Vali Acc: 0.712 Test Loss: 1.792 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.577043771743774
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.416 Vali Acc: 0.605 Test Loss: 1.416 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.620950222015381
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.876 Vali Acc: 0.702 Test Loss: 1.876 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.089239835739136
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.791 Vali Acc: 0.634 Test Loss: 1.791 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.844762325286865
Epoch: 11, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.157 Vali Acc: 0.595 Test Loss: 2.157 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.865832090377808
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 1.298 Vali Acc: 0.278 Test Loss: 1.298 Test Acc: 0.278
Validation loss decreased (inf --> -0.278036).  Saving model ...
Epoch: 2 cost time: 7.38907790184021
Epoch: 2, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.712 Vali Acc: 0.702 Test Loss: 0.712 Test Acc: 0.702
Validation loss decreased (-0.278036 --> -0.702432).  Saving model ...
Epoch: 3 cost time: 7.424222946166992
Epoch: 3, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.309 Vali Acc: 0.395 Test Loss: 1.309 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.624200344085693
Epoch: 4, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.101 Vali Acc: 0.546 Test Loss: 1.101 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.836843967437744
Epoch: 5, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.209 Vali Acc: 0.624 Test Loss: 1.209 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.954275369644165
Epoch: 6, Steps: 13 | Train Loss: 0.101 Vali Loss: 3.718 Vali Acc: 0.327 Test Loss: 3.718 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.373511075973511
Epoch: 7, Steps: 13 | Train Loss: 0.079 Vali Loss: 2.797 Vali Acc: 0.395 Test Loss: 2.797 Test Acc: 0.395
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.978670597076416
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.759 Vali Acc: 0.454 Test Loss: 2.759 Test Acc: 0.454
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.124404430389404
Epoch: 9, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.840 Vali Acc: 0.449 Test Loss: 2.840 Test Acc: 0.449
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.936579704284668
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 3.403 Vali Acc: 0.390 Test Loss: 3.403 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.543787002563477
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.279 Vali Acc: 0.590 Test Loss: 2.279 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.319020509719849
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.240 Vali Acc: 0.605 Test Loss: 2.240 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.524508953094482
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 1.193 Vali Acc: 0.283 Test Loss: 1.193 Test Acc: 0.283
Validation loss decreased (inf --> -0.282915).  Saving model ...
Epoch: 2 cost time: 6.702867746353149
Epoch: 2, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.624 Vali Acc: 0.659 Test Loss: 0.624 Test Acc: 0.659
Validation loss decreased (-0.282915 --> -0.658530).  Saving model ...
Epoch: 3 cost time: 6.545490264892578
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.062 Vali Acc: 0.468 Test Loss: 1.062 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.80069375038147
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.504 Vali Acc: 0.420 Test Loss: 1.504 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.827853679656982
Epoch: 5, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.027 Vali Acc: 0.698 Test Loss: 1.027 Test Acc: 0.698
Validation loss decreased (-0.658530 --> -0.697551).  Saving model ...
Epoch: 6 cost time: 6.87841272354126
Epoch: 6, Steps: 13 | Train Loss: 0.329 Vali Loss: 2.738 Vali Acc: 0.376 Test Loss: 2.738 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.748188495635986
Epoch: 7, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.451 Vali Acc: 0.737 Test Loss: 1.451 Test Acc: 0.737
Validation loss decreased (-0.697551 --> -0.736571).  Saving model ...
Epoch: 8 cost time: 6.266247987747192
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 3.427 Vali Acc: 0.449 Test Loss: 3.427 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.312714338302612
Epoch: 9, Steps: 13 | Train Loss: 0.077 Vali Loss: 2.154 Vali Acc: 0.624 Test Loss: 2.154 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.435994625091553
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 7.438 Vali Acc: 0.390 Test Loss: 7.438 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.35433292388916
Epoch: 11, Steps: 13 | Train Loss: 0.364 Vali Loss: 4.166 Vali Acc: 0.595 Test Loss: 4.166 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.216143369674683
Epoch: 12, Steps: 13 | Train Loss: 0.073 Vali Loss: 6.501 Vali Acc: 0.385 Test Loss: 6.501 Test Acc: 0.385
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.292882204055786
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 4.204 Vali Acc: 0.605 Test Loss: 4.204 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.494701385498047
Epoch: 14, Steps: 13 | Train Loss: 0.089 Vali Loss: 4.725 Vali Acc: 0.566 Test Loss: 4.725 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.603189945220947
Epoch: 15, Steps: 13 | Train Loss: 0.101 Vali Loss: 4.325 Vali Acc: 0.654 Test Loss: 4.325 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.921781778335571
Epoch: 16, Steps: 13 | Train Loss: 0.201 Vali Loss: 4.827 Vali Acc: 0.727 Test Loss: 4.827 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.0994415283203125
Epoch: 17, Steps: 13 | Train Loss: 0.077 Vali Loss: 9.616 Vali Acc: 0.371 Test Loss: 9.616 Test Acc: 0.371
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 17310722
model size : 85.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.007121086120605
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.877 Vali Acc: 0.298 Test Loss: 0.877 Test Acc: 0.298
Validation loss decreased (inf --> -0.297552).  Saving model ...
Epoch: 2 cost time: 7.66901969909668
Epoch: 2, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.713 Vali Acc: 0.737 Test Loss: 0.713 Test Acc: 0.737
Validation loss decreased (-0.297552 --> -0.736578).  Saving model ...
Epoch: 3 cost time: 7.699770450592041
Epoch: 3, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.854 Vali Acc: 0.727 Test Loss: 0.854 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.219875574111938
Epoch: 4, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.814 Vali Acc: 0.707 Test Loss: 0.814 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.036642074584961
Epoch: 5, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.073 Vali Acc: 0.717 Test Loss: 1.073 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.515158891677856
Epoch: 6, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.048 Vali Acc: 0.663 Test Loss: 1.048 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.173145294189453
Epoch: 7, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.403 Vali Acc: 0.717 Test Loss: 1.403 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.188925981521606
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.447 Vali Acc: 0.649 Test Loss: 1.447 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.265323638916016
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.437 Vali Acc: 0.698 Test Loss: 1.437 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.096929550170898
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.546 Vali Acc: 0.693 Test Loss: 1.546 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.741700649261475
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.602 Vali Acc: 0.693 Test Loss: 1.602 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.145962715148926
Epoch: 12, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.234 Vali Acc: 0.741 Test Loss: 2.234 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741441).  Saving model ...
Epoch: 13 cost time: 6.219111204147339
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 2.037 Vali Acc: 0.639 Test Loss: 2.037 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.548837423324585
Epoch: 14, Steps: 13 | Train Loss: 0.050 Vali Loss: 2.599 Vali Acc: 0.595 Test Loss: 2.599 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.182708501815796
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 3.279 Vali Acc: 0.698 Test Loss: 3.279 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.051065921783447
Epoch: 16, Steps: 13 | Train Loss: 0.079 Vali Loss: 3.100 Vali Acc: 0.639 Test Loss: 3.100 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.226722478866577
Epoch: 17, Steps: 13 | Train Loss: 0.197 Vali Loss: 3.001 Vali Acc: 0.678 Test Loss: 3.001 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.009157419204712
Epoch: 18, Steps: 13 | Train Loss: 0.029 Vali Loss: 3.676 Vali Acc: 0.585 Test Loss: 3.676 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.424999952316284
Epoch: 19, Steps: 13 | Train Loss: 0.134 Vali Loss: 3.668 Vali Acc: 0.702 Test Loss: 3.668 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.683603763580322
Epoch: 20, Steps: 13 | Train Loss: 0.403 Vali Loss: 6.792 Vali Acc: 0.395 Test Loss: 6.792 Test Acc: 0.395
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 8.415708780288696
Epoch: 21, Steps: 13 | Train Loss: 0.687 Vali Loss: 4.450 Vali Acc: 0.590 Test Loss: 4.450 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.679178237915039
Epoch: 22, Steps: 13 | Train Loss: 0.109 Vali Loss: 5.406 Vali Acc: 0.610 Test Loss: 5.406 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.76449990272522
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.766 Vali Acc: 0.439 Test Loss: 0.766 Test Acc: 0.439
Validation loss decreased (inf --> -0.439017).  Saving model ...
Epoch: 2 cost time: 6.982798337936401
Epoch: 2, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.742 Vali Acc: 0.727 Test Loss: 0.742 Test Acc: 0.727
Validation loss decreased (-0.439017 --> -0.726822).  Saving model ...
Epoch: 3 cost time: 7.590260028839111
Epoch: 3, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
Validation loss decreased (-0.726822 --> -0.746334).  Saving model ...
Epoch: 4 cost time: 6.6192731857299805
Epoch: 4, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.204 Vali Acc: 0.741 Test Loss: 1.204 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.309659004211426
Epoch: 5, Steps: 13 | Train Loss: 0.064 Vali Loss: 2.355 Vali Acc: 0.732 Test Loss: 2.355 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.430691480636597
Epoch: 6, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.744 Vali Acc: 0.429 Test Loss: 1.744 Test Acc: 0.429
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.589965581893921
Epoch: 7, Steps: 13 | Train Loss: 0.596 Vali Loss: 3.094 Vali Acc: 0.366 Test Loss: 3.094 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.980010747909546
Epoch: 8, Steps: 13 | Train Loss: 0.590 Vali Loss: 1.891 Vali Acc: 0.702 Test Loss: 1.891 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.549555063247681
Epoch: 9, Steps: 13 | Train Loss: 0.227 Vali Loss: 3.278 Vali Acc: 0.727 Test Loss: 3.278 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.69663405418396
Epoch: 10, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.974 Vali Acc: 0.737 Test Loss: 2.974 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.283488512039185
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.378 Vali Acc: 0.580 Test Loss: 2.378 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.320342540740967
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 3.256 Vali Acc: 0.741 Test Loss: 3.256 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.718004465103149
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 2.417 Vali Acc: 0.698 Test Loss: 2.417 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.575108766555786
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.842 Vali Acc: 0.395 Test Loss: 0.842 Test Acc: 0.395
Validation loss decreased (inf --> -0.395114).  Saving model ...
Epoch: 2 cost time: 7.022348165512085
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 1.012 Vali Acc: 0.741 Test Loss: 1.012 Test Acc: 0.741
Validation loss decreased (-0.395114 --> -0.741453).  Saving model ...
Epoch: 3 cost time: 7.650778770446777
Epoch: 3, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.973 Vali Acc: 0.732 Test Loss: 0.973 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.718355655670166
Epoch: 4, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.863 Vali Acc: 0.688 Test Loss: 0.863 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.029554605484009
Epoch: 5, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.115 Vali Acc: 0.693 Test Loss: 1.115 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.223933219909668
Epoch: 6, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.260 Vali Acc: 0.644 Test Loss: 1.260 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.062914848327637
Epoch: 7, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.345 Vali Acc: 0.639 Test Loss: 1.345 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.299675464630127
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.547 Vali Acc: 0.620 Test Loss: 1.547 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.16872763633728
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.242 Vali Acc: 0.732 Test Loss: 2.242 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.7734925746917725
Epoch: 10, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.641 Vali Acc: 0.654 Test Loss: 1.641 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.7607810497283936
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 2.543 Vali Acc: 0.732 Test Loss: 2.543 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.976494312286377
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.852 Vali Acc: 0.737 Test Loss: 3.852 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.1854588985443115
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.866 Vali Acc: 0.341 Test Loss: 0.866 Test Acc: 0.341
Validation loss decreased (inf --> -0.341455).  Saving model ...
Epoch: 2 cost time: 6.75715446472168
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.865 Vali Acc: 0.737 Test Loss: 0.865 Test Acc: 0.737
Validation loss decreased (-0.341455 --> -0.736577).  Saving model ...
Epoch: 3 cost time: 6.181523323059082
Epoch: 3, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.967 Vali Acc: 0.702 Test Loss: 0.967 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.322834014892578
Epoch: 4, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.884 Vali Acc: 0.659 Test Loss: 0.884 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.369462013244629
Epoch: 5, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.246 Vali Acc: 0.717 Test Loss: 1.246 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.27532958984375
Epoch: 6, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.427 Vali Acc: 0.693 Test Loss: 1.427 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.124774217605591
Epoch: 7, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.541 Vali Acc: 0.615 Test Loss: 1.541 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.47082257270813
Epoch: 8, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.601 Vali Acc: 0.590 Test Loss: 1.601 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.103227615356445
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.259 Vali Acc: 0.732 Test Loss: 2.259 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.049933433532715
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.952 Vali Acc: 0.624 Test Loss: 1.952 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.510599136352539
Epoch: 11, Steps: 13 | Train Loss: 0.168 Vali Loss: 3.086 Vali Acc: 0.717 Test Loss: 3.086 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.481559753417969
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 2.228 Vali Acc: 0.620 Test Loss: 2.228 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.37106966972351
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 7.603226900100708
Epoch: 2, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.673 Vali Acc: 0.751 Test Loss: 0.673 Test Acc: 0.751
Validation loss decreased (-0.717068 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 6.5865490436553955
Epoch: 3, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.823 Vali Acc: 0.761 Test Loss: 0.823 Test Acc: 0.761
Validation loss decreased (-0.751213 --> -0.760967).  Saving model ...
Epoch: 4 cost time: 6.511078596115112
Epoch: 4, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.994 Vali Acc: 0.741 Test Loss: 0.994 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.15029501914978
Epoch: 5, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.260 Vali Acc: 0.741 Test Loss: 1.260 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.715806245803833
Epoch: 6, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.270 Vali Acc: 0.717 Test Loss: 1.270 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.142128229141235
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.464 Vali Acc: 0.702 Test Loss: 1.464 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.5442914962768555
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.466 Vali Acc: 0.683 Test Loss: 1.466 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.666704177856445
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.532 Vali Acc: 0.702 Test Loss: 1.532 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.10798454284668
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.589 Vali Acc: 0.639 Test Loss: 1.589 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.750790119171143
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.649 Vali Acc: 0.649 Test Loss: 1.649 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.783146381378174
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.876 Vali Acc: 0.717 Test Loss: 2.876 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.215615510940552
Epoch: 13, Steps: 13 | Train Loss: 0.278 Vali Loss: 2.916 Vali Acc: 0.585 Test Loss: 2.916 Test Acc: 0.585
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.44173288345337
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.572 Vali Acc: 0.702 Test Loss: 0.572 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 6.781444787979126
Epoch: 2, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.843 Vali Acc: 0.746 Test Loss: 0.843 Test Acc: 0.746
Validation loss decreased (-0.702433 --> -0.746333).  Saving model ...
Epoch: 3 cost time: 6.968104839324951
Epoch: 3, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.187 Vali Acc: 0.722 Test Loss: 1.187 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.419530153274536
Epoch: 4, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.936 Vali Acc: 0.698 Test Loss: 0.936 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.005135774612427
Epoch: 5, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.135 Vali Acc: 0.727 Test Loss: 1.135 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.177046775817871
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.339 Vali Acc: 0.693 Test Loss: 1.339 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.150796890258789
Epoch: 7, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.782 Vali Acc: 0.746 Test Loss: 1.782 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.045880317687988
Epoch: 8, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.699 Vali Acc: 0.737 Test Loss: 1.699 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.656082391738892
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.134 Vali Acc: 0.737 Test Loss: 2.134 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.159253358840942
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.121 Vali Acc: 0.707 Test Loss: 2.121 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.174235105514526
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.085 Vali Acc: 0.678 Test Loss: 2.085 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.518208742141724
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.683 Test Loss: 2.323 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.866863250732422
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.688 Vali Acc: 0.600 Test Loss: 0.688 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 6.233345031738281
Epoch: 2, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.822 Vali Acc: 0.712 Test Loss: 0.822 Test Acc: 0.712
Validation loss decreased (-0.599993 --> -0.712187).  Saving model ...
Epoch: 3 cost time: 5.583128452301025
Epoch: 3, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.398 Vali Acc: 0.717 Test Loss: 1.398 Test Acc: 0.717
Validation loss decreased (-0.712187 --> -0.717059).  Saving model ...
Epoch: 4 cost time: 6.90812873840332
Epoch: 4, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.845 Vali Acc: 0.663 Test Loss: 0.845 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.965001106262207
Epoch: 5, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.655 Vali Acc: 0.717 Test Loss: 1.655 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.27831244468689
Epoch: 6, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.779 Vali Acc: 0.717 Test Loss: 1.779 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.329406499862671
Epoch: 7, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.492 Vali Acc: 0.590 Test Loss: 1.492 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.5343406200408936
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.255 Vali Acc: 0.673 Test Loss: 1.255 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.634466171264648
Epoch: 9, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.773 Vali Acc: 0.712 Test Loss: 1.773 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.1643226146698
Epoch: 10, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.637 Vali Acc: 0.707 Test Loss: 1.637 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.542750597000122
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.962 Vali Acc: 0.727 Test Loss: 1.962 Test Acc: 0.727
Validation loss decreased (-0.717059 --> -0.726810).  Saving model ...
Epoch: 12 cost time: 5.3022637367248535
Epoch: 12, Steps: 13 | Train Loss: 0.030 Vali Loss: 3.002 Vali Acc: 0.732 Test Loss: 3.002 Test Acc: 0.732
Validation loss decreased (-0.726810 --> -0.731677).  Saving model ...
Epoch: 13 cost time: 6.2447285652160645
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 3.472 Vali Acc: 0.727 Test Loss: 3.472 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.002616882324219
Epoch: 14, Steps: 13 | Train Loss: 0.026 Vali Loss: 3.213 Vali Acc: 0.732 Test Loss: 3.213 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.68505072593689
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 4.340 Vali Acc: 0.727 Test Loss: 4.340 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.983109951019287
Epoch: 16, Steps: 13 | Train Loss: 0.084 Vali Loss: 4.897 Vali Acc: 0.463 Test Loss: 4.897 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.3658201694488525
Epoch: 17, Steps: 13 | Train Loss: 0.314 Vali Loss: 3.964 Vali Acc: 0.732 Test Loss: 3.964 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.071771144866943
Epoch: 18, Steps: 13 | Train Loss: 0.018 Vali Loss: 3.071 Vali Acc: 0.639 Test Loss: 3.071 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.248188495635986
Epoch: 19, Steps: 13 | Train Loss: 0.018 Vali Loss: 4.584 Vali Acc: 0.717 Test Loss: 4.584 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.725412845611572
Epoch: 20, Steps: 13 | Train Loss: 0.595 Vali Loss: 5.643 Vali Acc: 0.712 Test Loss: 5.643 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.143369674682617
Epoch: 21, Steps: 13 | Train Loss: 0.040 Vali Loss: 4.089 Vali Acc: 0.722 Test Loss: 4.089 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.890449285507202
Epoch: 22, Steps: 13 | Train Loss: 0.058 Vali Loss: 4.335 Vali Acc: 0.615 Test Loss: 4.335 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.507307291030884
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.762 Vali Acc: 0.478 Test Loss: 0.762 Test Acc: 0.478
Validation loss decreased (inf --> -0.478041).  Saving model ...
Epoch: 2 cost time: 6.731078386306763
Epoch: 2, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
Validation loss decreased (-0.478041 --> -0.717066).  Saving model ...
Epoch: 3 cost time: 5.26678466796875
Epoch: 3, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.923 Vali Acc: 0.712 Test Loss: 0.923 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.389376878738403
Epoch: 4, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.130 Vali Acc: 0.717 Test Loss: 1.130 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.705536127090454
Epoch: 5, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.156 Vali Acc: 0.698 Test Loss: 1.156 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.341040134429932
Epoch: 6, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.077 Vali Acc: 0.668 Test Loss: 1.077 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.5361597537994385
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.113 Vali Acc: 0.688 Test Loss: 1.113 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.716429948806763
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.522 Vali Acc: 0.698 Test Loss: 1.522 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.711678743362427
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.702 Test Loss: 1.702 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.171013355255127
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.678 Test Loss: 1.333 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.329779148101807
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.688 Test Loss: 1.323 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.965813398361206
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.698 Test Loss: 1.689 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.295689105987549
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 1.365 Vali Acc: 0.278 Test Loss: 1.365 Test Acc: 0.278
Validation loss decreased (inf --> -0.278035).  Saving model ...
Epoch: 2 cost time: 5.6041319370269775
Epoch: 2, Steps: 13 | Train Loss: 0.615 Vali Loss: 1.332 Vali Acc: 0.307 Test Loss: 1.332 Test Acc: 0.307
Validation loss decreased (-0.278035 --> -0.307304).  Saving model ...
Epoch: 3 cost time: 6.153059005737305
Epoch: 3, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.823 Vali Acc: 0.624 Test Loss: 0.823 Test Acc: 0.624
Validation loss decreased (-0.307304 --> -0.624382).  Saving model ...
Epoch: 4 cost time: 6.559694528579712
Epoch: 4, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.493 Vali Acc: 0.376 Test Loss: 1.493 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.200632333755493
Epoch: 5, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.179 Vali Acc: 0.595 Test Loss: 1.179 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.097534418106079
Epoch: 6, Steps: 13 | Train Loss: 0.044 Vali Loss: 2.592 Vali Acc: 0.390 Test Loss: 2.592 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.50337290763855
Epoch: 7, Steps: 13 | Train Loss: 0.047 Vali Loss: 2.187 Vali Acc: 0.459 Test Loss: 2.187 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.795918941497803
Epoch: 8, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.666 Vali Acc: 0.571 Test Loss: 1.666 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.880321502685547
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.026 Vali Acc: 0.707 Test Loss: 2.026 Test Acc: 0.707
Validation loss decreased (-0.624382 --> -0.707297).  Saving model ...
Epoch: 10 cost time: 6.170076608657837
Epoch: 10, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.056 Vali Acc: 0.605 Test Loss: 2.056 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.640852928161621
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.565 Vali Acc: 0.532 Test Loss: 2.565 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.523590087890625
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.074 Vali Acc: 0.620 Test Loss: 2.074 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.652821063995361
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.127 Vali Acc: 0.624 Test Loss: 2.127 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.577897310256958
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.589 Vali Acc: 0.551 Test Loss: 2.589 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.335481643676758
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.491 Vali Acc: 0.629 Test Loss: 2.491 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.728206396102905
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.161 Vali Acc: 0.712 Test Loss: 3.161 Test Acc: 0.712
Validation loss decreased (-0.707297 --> -0.712164).  Saving model ...
Epoch: 17 cost time: 6.892027378082275
Epoch: 17, Steps: 13 | Train Loss: 0.018 Vali Loss: 3.316 Vali Acc: 0.561 Test Loss: 3.316 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.559375047683716
Epoch: 18, Steps: 13 | Train Loss: 0.096 Vali Loss: 3.334 Vali Acc: 0.654 Test Loss: 3.334 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.933591604232788
Epoch: 19, Steps: 13 | Train Loss: 0.078 Vali Loss: 3.901 Vali Acc: 0.644 Test Loss: 3.901 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.654130220413208
Epoch: 20, Steps: 13 | Train Loss: 0.220 Vali Loss: 16.674 Vali Acc: 0.283 Test Loss: 16.674 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.466430902481079
Epoch: 21, Steps: 13 | Train Loss: 0.408 Vali Loss: 4.700 Vali Acc: 0.678 Test Loss: 4.700 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.353137969970703
Epoch: 22, Steps: 13 | Train Loss: 0.095 Vali Loss: 5.062 Vali Acc: 0.639 Test Loss: 5.062 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.859353065490723
Epoch: 23, Steps: 13 | Train Loss: 0.191 Vali Loss: 5.503 Vali Acc: 0.717 Test Loss: 5.503 Test Acc: 0.717
Validation loss decreased (-0.712164 --> -0.717018).  Saving model ...
Epoch: 24 cost time: 5.855619668960571
Epoch: 24, Steps: 13 | Train Loss: 0.577 Vali Loss: 5.381 Vali Acc: 0.537 Test Loss: 5.381 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.208612442016602
Epoch: 25, Steps: 13 | Train Loss: 0.094 Vali Loss: 9.099 Vali Acc: 0.420 Test Loss: 9.099 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.661649465560913
Epoch: 26, Steps: 13 | Train Loss: 0.054 Vali Loss: 6.537 Vali Acc: 0.663 Test Loss: 6.537 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.1504809856414795
Epoch: 27, Steps: 13 | Train Loss: 0.189 Vali Loss: 9.806 Vali Acc: 0.634 Test Loss: 9.806 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.5793845653533936
Epoch: 28, Steps: 13 | Train Loss: 0.247 Vali Loss: 24.762 Vali Acc: 0.380 Test Loss: 24.762 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.081738471984863
Epoch: 29, Steps: 13 | Train Loss: 0.540 Vali Loss: 10.016 Vali Acc: 0.561 Test Loss: 10.016 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.1952221393585205
Epoch: 30, Steps: 13 | Train Loss: 0.290 Vali Loss: 9.111 Vali Acc: 0.566 Test Loss: 9.111 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.0724287033081055
Epoch: 31, Steps: 13 | Train Loss: 0.109 Vali Loss: 8.764 Vali Acc: 0.698 Test Loss: 8.764 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.0569140911102295
Epoch: 32, Steps: 13 | Train Loss: 0.218 Vali Loss: 7.707 Vali Acc: 0.702 Test Loss: 7.707 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.542033910751343
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 7.479 Vali Acc: 0.659 Test Loss: 7.479 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.58299446105957
Epoch: 1, Steps: 13 | Train Loss: 0.802 Vali Loss: 0.863 Vali Acc: 0.376 Test Loss: 0.863 Test Acc: 0.376
Validation loss decreased (inf --> -0.375601).  Saving model ...
Epoch: 2 cost time: 5.723470687866211
Epoch: 2, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.993 Vali Acc: 0.390 Test Loss: 0.993 Test Acc: 0.390
Validation loss decreased (-0.375601 --> -0.390234).  Saving model ...
Epoch: 3 cost time: 6.281273365020752
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.702 Vali Acc: 0.634 Test Loss: 0.702 Test Acc: 0.634
Validation loss decreased (-0.390234 --> -0.634139).  Saving model ...
Epoch: 4 cost time: 6.137456655502319
Epoch: 4, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.398 Vali Acc: 0.429 Test Loss: 1.398 Test Acc: 0.429
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.3231589794158936
Epoch: 5, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.061 Vali Acc: 0.624 Test Loss: 1.061 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.503140926361084
Epoch: 6, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.511 Vali Acc: 0.420 Test Loss: 2.511 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.293292760848999
Epoch: 7, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.549 Vali Acc: 0.717 Test Loss: 1.549 Test Acc: 0.717
Validation loss decreased (-0.634139 --> -0.717058).  Saving model ...
Epoch: 8 cost time: 5.51021146774292
Epoch: 8, Steps: 13 | Train Loss: 0.117 Vali Loss: 2.551 Vali Acc: 0.556 Test Loss: 2.551 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.694791078567505
Epoch: 9, Steps: 13 | Train Loss: 0.066 Vali Loss: 2.376 Vali Acc: 0.668 Test Loss: 2.376 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.235723495483398
Epoch: 10, Steps: 13 | Train Loss: 0.142 Vali Loss: 3.097 Vali Acc: 0.634 Test Loss: 3.097 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.132302522659302
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 7.227 Vali Acc: 0.429 Test Loss: 7.227 Test Acc: 0.429
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.758168935775757
Epoch: 12, Steps: 13 | Train Loss: 0.166 Vali Loss: 5.684 Vali Acc: 0.478 Test Loss: 5.684 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.867547273635864
Epoch: 13, Steps: 13 | Train Loss: 0.164 Vali Loss: 6.574 Vali Acc: 0.478 Test Loss: 6.574 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.672902345657349
Epoch: 14, Steps: 13 | Train Loss: 0.052 Vali Loss: 4.802 Vali Acc: 0.576 Test Loss: 4.802 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.468632459640503
Epoch: 15, Steps: 13 | Train Loss: 0.174 Vali Loss: 7.280 Vali Acc: 0.727 Test Loss: 7.280 Test Acc: 0.727
Validation loss decreased (-0.717058 --> -0.726756).  Saving model ...
Epoch: 16 cost time: 6.0971479415893555
Epoch: 16, Steps: 13 | Train Loss: 0.408 Vali Loss: 5.020 Vali Acc: 0.649 Test Loss: 5.020 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.636342287063599
Epoch: 17, Steps: 13 | Train Loss: 0.044 Vali Loss: 8.125 Vali Acc: 0.522 Test Loss: 8.125 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.272152423858643
Epoch: 18, Steps: 13 | Train Loss: 0.108 Vali Loss: 8.683 Vali Acc: 0.561 Test Loss: 8.683 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.094672918319702
Epoch: 19, Steps: 13 | Train Loss: 0.026 Vali Loss: 8.010 Vali Acc: 0.678 Test Loss: 8.010 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.317258834838867
Epoch: 20, Steps: 13 | Train Loss: 0.200 Vali Loss: 7.882 Vali Acc: 0.659 Test Loss: 7.882 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.023332118988037
Epoch: 21, Steps: 13 | Train Loss: 0.068 Vali Loss: 7.893 Vali Acc: 0.605 Test Loss: 7.893 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.174931049346924
Epoch: 22, Steps: 13 | Train Loss: 0.095 Vali Loss: 8.072 Vali Acc: 0.620 Test Loss: 8.072 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.038619041442871
Epoch: 23, Steps: 13 | Train Loss: 0.056 Vali Loss: 9.355 Vali Acc: 0.517 Test Loss: 9.355 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.009306192398071
Epoch: 24, Steps: 13 | Train Loss: 0.129 Vali Loss: 9.142 Vali Acc: 0.522 Test Loss: 9.142 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.301071405410767
Epoch: 25, Steps: 13 | Train Loss: 0.038 Vali Loss: 9.677 Vali Acc: 0.556 Test Loss: 9.677 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 14164994
model size : 73.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.074811220169067
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.796 Vali Acc: 0.707 Test Loss: 0.796 Test Acc: 0.707
Validation loss decreased (inf --> -0.707309).  Saving model ...
Epoch: 2 cost time: 7.470967054367065
Epoch: 2, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.218 Vali Acc: 0.307 Test Loss: 1.218 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.321706533432007
Epoch: 3, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.791 Vali Acc: 0.737 Test Loss: 0.791 Test Acc: 0.737
Validation loss decreased (-0.707309 --> -0.736577).  Saving model ...
Epoch: 4 cost time: 5.792618274688721
Epoch: 4, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.903 Vali Acc: 0.600 Test Loss: 0.903 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.997681617736816
Epoch: 5, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.866 Vali Acc: 0.727 Test Loss: 1.866 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.404714107513428
Epoch: 6, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.608 Vali Acc: 0.732 Test Loss: 1.608 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.656946897506714
Epoch: 7, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.479 Vali Acc: 0.722 Test Loss: 1.479 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.796733379364014
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.187 Vali Acc: 0.673 Test Loss: 1.187 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.744489908218384
Epoch: 9, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.437 Vali Acc: 0.688 Test Loss: 1.437 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.223917007446289
Epoch: 10, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.932 Vali Acc: 0.615 Test Loss: 1.932 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.989349842071533
Epoch: 11, Steps: 13 | Train Loss: 0.177 Vali Loss: 3.099 Vali Acc: 0.722 Test Loss: 3.099 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.34110951423645
Epoch: 12, Steps: 13 | Train Loss: 0.059 Vali Loss: 3.041 Vali Acc: 0.702 Test Loss: 3.041 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.072357654571533
Epoch: 13, Steps: 13 | Train Loss: 0.021 Vali Loss: 2.072 Vali Acc: 0.663 Test Loss: 2.072 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.093493461608887
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.889 Vali Acc: 0.717 Test Loss: 0.889 Test Acc: 0.717
Validation loss decreased (inf --> -0.717064).  Saving model ...
Epoch: 2 cost time: 7.28895378112793
Epoch: 2, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.461 Vali Acc: 0.288 Test Loss: 1.461 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.808909893035889
Epoch: 3, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.752 Vali Acc: 0.712 Test Loss: 0.752 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.284175634384155
Epoch: 4, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.950 Vali Acc: 0.751 Test Loss: 0.950 Test Acc: 0.751
Validation loss decreased (-0.717064 --> -0.751210).  Saving model ...
Epoch: 5 cost time: 7.782770872116089
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.375 Vali Acc: 0.737 Test Loss: 1.375 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.309734106063843
Epoch: 6, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.277 Vali Acc: 0.756 Test Loss: 1.277 Test Acc: 0.756
Validation loss decreased (-0.751210 --> -0.756085).  Saving model ...
Epoch: 7 cost time: 7.974984645843506
Epoch: 7, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.294 Vali Acc: 0.727 Test Loss: 1.294 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.061084985733032
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.322 Vali Acc: 0.654 Test Loss: 1.322 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.126107692718506
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.539 Vali Acc: 0.698 Test Loss: 1.539 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.155299425125122
Epoch: 10, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.815 Vali Acc: 0.707 Test Loss: 1.815 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.06617784500122
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.838 Vali Acc: 0.707 Test Loss: 1.838 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.600625038146973
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.143 Vali Acc: 0.712 Test Loss: 2.143 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.326685190200806
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.966 Vali Acc: 0.673 Test Loss: 1.966 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.929256439208984
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.673 Test Loss: 1.934 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.520254611968994
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.320 Vali Acc: 0.712 Test Loss: 2.320 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.704247951507568
Epoch: 16, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.223 Vali Acc: 0.683 Test Loss: 2.223 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.161408185958862
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.872 Vali Acc: 0.727 Test Loss: 0.872 Test Acc: 0.727
Validation loss decreased (inf --> -0.726821).  Saving model ...
Epoch: 2 cost time: 6.461397647857666
Epoch: 2, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.884 Vali Acc: 0.278 Test Loss: 1.884 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.5530335903167725
Epoch: 3, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.751 Vali Acc: 0.654 Test Loss: 0.751 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.9803571701049805
Epoch: 4, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.430 Vali Acc: 0.727 Test Loss: 1.430 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.628547191619873
Epoch: 5, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.140 Vali Acc: 0.668 Test Loss: 1.140 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.502840280532837
Epoch: 6, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.338 Vali Acc: 0.702 Test Loss: 1.338 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.390420436859131
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.537 Vali Acc: 0.712 Test Loss: 1.537 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.242799520492554
Epoch: 8, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.650 Vali Acc: 0.688 Test Loss: 1.650 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.827792644500732
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.552 Vali Acc: 0.644 Test Loss: 1.552 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.504964590072632
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.957 Vali Acc: 0.610 Test Loss: 1.957 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.575189113616943
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 3.507 Vali Acc: 0.722 Test Loss: 3.507 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.393197298049927
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.851 Vali Acc: 0.707 Test Loss: 0.851 Test Acc: 0.707
Validation loss decreased (inf --> -0.707309).  Saving model ...
Epoch: 2 cost time: 7.008803367614746
Epoch: 2, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.741 Vali Acc: 0.288 Test Loss: 1.741 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.162869453430176
Epoch: 3, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.716 Vali Acc: 0.668 Test Loss: 0.716 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.430218935012817
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.481 Vali Acc: 0.727 Test Loss: 1.481 Test Acc: 0.727
Validation loss decreased (-0.707309 --> -0.726814).  Saving model ...
Epoch: 5 cost time: 6.632707357406616
Epoch: 5, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.978 Vali Acc: 0.702 Test Loss: 0.978 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.645571947097778
Epoch: 6, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.320 Vali Acc: 0.712 Test Loss: 1.320 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.767040014266968
Epoch: 7, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.776 Vali Acc: 0.732 Test Loss: 1.776 Test Acc: 0.732
Validation loss decreased (-0.726814 --> -0.731690).  Saving model ...
Epoch: 8 cost time: 6.807537317276001
Epoch: 8, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.419 Vali Acc: 0.620 Test Loss: 1.419 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.224937915802002
Epoch: 9, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.482 Vali Acc: 0.663 Test Loss: 1.482 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.5237836837768555
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.549 Vali Acc: 0.717 Test Loss: 2.549 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.493709325790405
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.786 Vali Acc: 0.678 Test Loss: 1.786 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.230956554412842
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.233 Vali Acc: 0.615 Test Loss: 2.233 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.273871421813965
Epoch: 13, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.755 Vali Acc: 0.717 Test Loss: 2.755 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.395273685455322
Epoch: 14, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.666 Vali Acc: 0.678 Test Loss: 2.666 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.067889213562012
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 3.035 Vali Acc: 0.605 Test Loss: 3.035 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.715453147888184
Epoch: 16, Steps: 13 | Train Loss: 0.126 Vali Loss: 3.433 Vali Acc: 0.668 Test Loss: 3.433 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.401076078414917
Epoch: 17, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.450 Vali Acc: 0.683 Test Loss: 3.450 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.483019590377808
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.791 Vali Acc: 0.732 Test Loss: 0.791 Test Acc: 0.732
Validation loss decreased (inf --> -0.731699).  Saving model ...
Epoch: 2 cost time: 6.504785060882568
Epoch: 2, Steps: 13 | Train Loss: 0.391 Vali Loss: 1.433 Vali Acc: 0.337 Test Loss: 1.433 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.747924327850342
Epoch: 3, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.761 Vali Acc: 0.702 Test Loss: 0.761 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.670267820358276
Epoch: 4, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.999 Vali Acc: 0.649 Test Loss: 0.999 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.85745644569397
Epoch: 5, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.103 Vali Acc: 0.722 Test Loss: 1.103 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.066967725753784
Epoch: 6, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.185 Vali Acc: 0.732 Test Loss: 1.185 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.042790412902832
Epoch: 7, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.439 Vali Acc: 0.732 Test Loss: 1.439 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.473923444747925
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.296 Vali Acc: 0.644 Test Loss: 1.296 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.748229265213013
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.766 Vali Acc: 0.634 Test Loss: 1.766 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.713354825973511
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.861 Vali Acc: 0.663 Test Loss: 1.861 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.645175933837891
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.949 Vali Acc: 0.688 Test Loss: 1.949 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.389326572418213
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
Validation loss decreased (inf --> -0.736578).  Saving model ...
Epoch: 2 cost time: 6.285592794418335
Epoch: 2, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.744 Vali Acc: 0.663 Test Loss: 0.744 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.648730516433716
Epoch: 3, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.877 Vali Acc: 0.605 Test Loss: 0.877 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.369822978973389
Epoch: 4, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.804 Vali Acc: 0.702 Test Loss: 0.804 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.566574335098267
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.235 Vali Acc: 0.746 Test Loss: 1.235 Test Acc: 0.746
Validation loss decreased (-0.736578 --> -0.746329).  Saving model ...
Epoch: 6 cost time: 6.2327916622161865
Epoch: 6, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.620 Vali Acc: 0.746 Test Loss: 1.620 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.742393255233765
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.504 Vali Acc: 0.727 Test Loss: 1.504 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.761126756668091
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.587 Vali Acc: 0.629 Test Loss: 1.587 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.558627367019653
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.656 Vali Acc: 0.732 Test Loss: 1.656 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.13738226890564
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.826 Vali Acc: 0.732 Test Loss: 1.826 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.724616765975952
Epoch: 11, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.862 Vali Acc: 0.702 Test Loss: 1.862 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.726196050643921
Epoch: 12, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.201 Vali Acc: 0.571 Test Loss: 2.201 Test Acc: 0.571
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.321197748184204
Epoch: 13, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.147 Vali Acc: 0.717 Test Loss: 2.147 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.396464109420776
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.636 Vali Acc: 0.751 Test Loss: 2.636 Test Acc: 0.751
Validation loss decreased (-0.746329 --> -0.751193).  Saving model ...
Epoch: 15 cost time: 6.352684736251831
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.204 Vali Acc: 0.702 Test Loss: 2.204 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.675256252288818
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.505 Vali Acc: 0.678 Test Loss: 2.505 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.0539021492004395
Epoch: 17, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.670 Vali Acc: 0.649 Test Loss: 2.670 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.641211271286011
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.667 Vali Acc: 0.698 Test Loss: 2.667 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.049930095672607
Epoch: 19, Steps: 13 | Train Loss: 0.009 Vali Loss: 3.548 Vali Acc: 0.712 Test Loss: 3.548 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.662525177001953
Epoch: 20, Steps: 13 | Train Loss: 0.058 Vali Loss: 2.998 Vali Acc: 0.702 Test Loss: 2.998 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.084443092346191
Epoch: 21, Steps: 13 | Train Loss: 0.046 Vali Loss: 4.382 Vali Acc: 0.546 Test Loss: 4.382 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.844017267227173
Epoch: 22, Steps: 13 | Train Loss: 0.171 Vali Loss: 4.747 Vali Acc: 0.741 Test Loss: 4.747 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.108688831329346
Epoch: 23, Steps: 13 | Train Loss: 0.378 Vali Loss: 7.222 Vali Acc: 0.761 Test Loss: 7.222 Test Acc: 0.761
Validation loss decreased (-0.751193 --> -0.760903).  Saving model ...
Epoch: 24 cost time: 6.623620986938477
Epoch: 24, Steps: 13 | Train Loss: 0.124 Vali Loss: 4.888 Vali Acc: 0.702 Test Loss: 4.888 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.005418300628662
Epoch: 25, Steps: 13 | Train Loss: 0.258 Vali Loss: 6.301 Vali Acc: 0.654 Test Loss: 6.301 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.4907732009887695
Epoch: 26, Steps: 13 | Train Loss: 0.438 Vali Loss: 6.783 Vali Acc: 0.707 Test Loss: 6.783 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.35676383972168
Epoch: 27, Steps: 13 | Train Loss: 1.128 Vali Loss: 7.133 Vali Acc: 0.590 Test Loss: 7.133 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.293318748474121
Epoch: 28, Steps: 13 | Train Loss: 0.159 Vali Loss: 5.745 Vali Acc: 0.688 Test Loss: 5.745 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.556164503097534
Epoch: 29, Steps: 13 | Train Loss: 0.025 Vali Loss: 6.588 Vali Acc: 0.693 Test Loss: 6.588 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.384820461273193
Epoch: 30, Steps: 13 | Train Loss: 0.166 Vali Loss: 6.567 Vali Acc: 0.702 Test Loss: 6.567 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.150559663772583
Epoch: 31, Steps: 13 | Train Loss: 0.040 Vali Loss: 6.485 Vali Acc: 0.707 Test Loss: 6.485 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.043937921524048
Epoch: 32, Steps: 13 | Train Loss: 0.141 Vali Loss: 7.319 Vali Acc: 0.605 Test Loss: 7.319 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.184519529342651
Epoch: 33, Steps: 13 | Train Loss: 0.039 Vali Loss: 7.417 Vali Acc: 0.654 Test Loss: 7.417 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.849849224090576
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 5.162573337554932
Epoch: 2, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.034 Vali Acc: 0.420 Test Loss: 1.034 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.169862270355225
Epoch: 3, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.540 Vali Acc: 0.346 Test Loss: 1.540 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.656377077102661
Epoch: 4, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.878 Vali Acc: 0.737 Test Loss: 0.878 Test Acc: 0.737
Validation loss decreased (-0.717066 --> -0.736577).  Saving model ...
Epoch: 5 cost time: 5.5786333084106445
Epoch: 5, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.877 Vali Acc: 0.712 Test Loss: 1.877 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.714691162109375
Epoch: 6, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.284 Vali Acc: 0.722 Test Loss: 1.284 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.578042030334473
Epoch: 7, Steps: 13 | Train Loss: 0.041 Vali Loss: 2.200 Vali Acc: 0.717 Test Loss: 2.200 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.782978773117065
Epoch: 8, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.432 Vali Acc: 0.702 Test Loss: 1.432 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.048233270645142
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.887 Vali Acc: 0.741 Test Loss: 1.887 Test Acc: 0.741
Validation loss decreased (-0.736577 --> -0.741445).  Saving model ...
Epoch: 10 cost time: 6.036759614944458
Epoch: 10, Steps: 13 | Train Loss: 0.034 Vali Loss: 2.099 Vali Acc: 0.741 Test Loss: 2.099 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.873582124710083
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.767 Vali Acc: 0.654 Test Loss: 1.767 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.099005460739136
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 2.810 Vali Acc: 0.473 Test Loss: 2.810 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.963456153869629
Epoch: 13, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.521 Vali Acc: 0.649 Test Loss: 2.521 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.146897792816162
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 3.793 Vali Acc: 0.717 Test Loss: 3.793 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.091136455535889
Epoch: 15, Steps: 13 | Train Loss: 0.117 Vali Loss: 2.415 Vali Acc: 0.688 Test Loss: 2.415 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.032074689865112
Epoch: 16, Steps: 13 | Train Loss: 0.021 Vali Loss: 2.889 Vali Acc: 0.702 Test Loss: 2.889 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.696139335632324
Epoch: 17, Steps: 13 | Train Loss: 0.016 Vali Loss: 3.318 Vali Acc: 0.580 Test Loss: 3.318 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.848678350448608
Epoch: 18, Steps: 13 | Train Loss: 0.071 Vali Loss: 3.311 Vali Acc: 0.624 Test Loss: 3.311 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.619988441467285
Epoch: 19, Steps: 13 | Train Loss: 0.034 Vali Loss: 3.872 Vali Acc: 0.722 Test Loss: 3.872 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.5765380859375
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 6.095901727676392
Epoch: 2, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.706 Vali Acc: 0.663 Test Loss: 0.706 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.317239761352539
Epoch: 3, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.707 Vali Acc: 0.688 Test Loss: 0.707 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.659032821655273
Epoch: 4, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.790 Vali Acc: 0.688 Test Loss: 0.790 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.232802152633667
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.964 Vali Acc: 0.693 Test Loss: 0.964 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.199051856994629
Epoch: 6, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.487 Vali Acc: 0.688 Test Loss: 1.487 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.904819011688232
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.761 Vali Acc: 0.717 Test Loss: 1.761 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.854521036148071
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.310 Vali Acc: 0.712 Test Loss: 1.310 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.202510595321655
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.712 Test Loss: 1.345 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.511475563049316
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.712 Test Loss: 1.489 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.390048027038574
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.722 Test Loss: 1.328 Test Acc: 0.722
Validation loss decreased (-0.717066 --> -0.721938).  Saving model ...
Epoch: 12 cost time: 6.357677936553955
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.216 Vali Acc: 0.693 Test Loss: 1.216 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.980882406234741
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.732 Test Loss: 1.450 Test Acc: 0.732
Validation loss decreased (-0.721938 --> -0.731693).  Saving model ...
Epoch: 14 cost time: 5.159863710403442
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.377 Vali Acc: 0.712 Test Loss: 1.377 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.507055282592773
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.727 Test Loss: 1.538 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.733389377593994
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.712 Test Loss: 1.433 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.852838516235352
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.722 Test Loss: 1.528 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.09165096282959
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.707 Test Loss: 1.484 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.111686944961548
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.707 Test Loss: 1.512 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.749367952346802
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.707 Test Loss: 1.528 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.356055021286011
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.712 Test Loss: 1.480 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.644084215164185
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.707 Test Loss: 1.523 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.285520553588867
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.707 Test Loss: 1.546 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.667766332626343
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.649 Vali Acc: 0.649 Test Loss: 0.649 Test Acc: 0.649
Validation loss decreased (inf --> -0.648774).  Saving model ...
Epoch: 2 cost time: 5.416528224945068
Epoch: 2, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.982 Vali Acc: 0.390 Test Loss: 0.982 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.839232444763184
Epoch: 3, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.949 Vali Acc: 0.302 Test Loss: 1.949 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.755082368850708
Epoch: 4, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.971 Vali Acc: 0.615 Test Loss: 0.971 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.230235815048218
Epoch: 5, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.161 Vali Acc: 0.566 Test Loss: 1.161 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.822105407714844
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.254 Vali Acc: 0.615 Test Loss: 1.254 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.798399925231934
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.519 Vali Acc: 0.561 Test Loss: 1.519 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.12515664100647
Epoch: 8, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.456 Vali Acc: 0.551 Test Loss: 1.456 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.826387166976929
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.238 Vali Acc: 0.493 Test Loss: 2.238 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.245442628860474
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.011 Vali Acc: 0.429 Test Loss: 3.011 Test Acc: 0.429
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.5106377601623535
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.443 Vali Acc: 0.615 Test Loss: 2.443 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6487804878048781
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.134660720825195
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.705 Vali Acc: 0.522 Test Loss: 0.705 Test Acc: 0.522
Validation loss decreased (inf --> -0.521944).  Saving model ...
Epoch: 2 cost time: 6.107769727706909
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.733 Vali Acc: 0.541 Test Loss: 0.733 Test Acc: 0.541
Validation loss decreased (-0.521944 --> -0.541456).  Saving model ...
Epoch: 3 cost time: 6.77257513999939
Epoch: 3, Steps: 13 | Train Loss: 0.426 Vali Loss: 2.314 Vali Acc: 0.283 Test Loss: 2.314 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.824873447418213
Epoch: 4, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.802 Vali Acc: 0.649 Test Loss: 0.802 Test Acc: 0.649
Validation loss decreased (-0.541456 --> -0.648772).  Saving model ...
Epoch: 5 cost time: 6.100225448608398
Epoch: 5, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.209 Vali Acc: 0.576 Test Loss: 1.209 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.457411050796509
Epoch: 6, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.164 Vali Acc: 0.712 Test Loss: 1.164 Test Acc: 0.712
Validation loss decreased (-0.648772 --> -0.712183).  Saving model ...
Epoch: 7 cost time: 6.503930330276489
Epoch: 7, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.516 Vali Acc: 0.668 Test Loss: 1.516 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.292277574539185
Epoch: 8, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.886 Vali Acc: 0.663 Test Loss: 1.886 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.146012544631958
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.776 Vali Acc: 0.620 Test Loss: 2.776 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.29456353187561
Epoch: 10, Steps: 13 | Train Loss: 0.031 Vali Loss: 2.574 Vali Acc: 0.629 Test Loss: 2.574 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.39450478553772
Epoch: 11, Steps: 13 | Train Loss: 0.050 Vali Loss: 4.406 Vali Acc: 0.722 Test Loss: 4.406 Test Acc: 0.722
Validation loss decreased (-0.712183 --> -0.721907).  Saving model ...
Epoch: 12 cost time: 5.2575132846832275
Epoch: 12, Steps: 13 | Train Loss: 0.247 Vali Loss: 3.814 Vali Acc: 0.698 Test Loss: 3.814 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.525659561157227
Epoch: 13, Steps: 13 | Train Loss: 0.069 Vali Loss: 3.475 Vali Acc: 0.688 Test Loss: 3.475 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.417654991149902
Epoch: 14, Steps: 13 | Train Loss: 0.016 Vali Loss: 4.526 Vali Acc: 0.639 Test Loss: 4.526 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.937516450881958
Epoch: 15, Steps: 13 | Train Loss: 0.025 Vali Loss: 7.322 Vali Acc: 0.498 Test Loss: 7.322 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.162007808685303
Epoch: 16, Steps: 13 | Train Loss: 0.221 Vali Loss: 5.050 Vali Acc: 0.561 Test Loss: 5.050 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.670356273651123
Epoch: 17, Steps: 13 | Train Loss: 0.239 Vali Loss: 5.712 Vali Acc: 0.605 Test Loss: 5.712 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.1849517822265625
Epoch: 18, Steps: 13 | Train Loss: 0.457 Vali Loss: 5.852 Vali Acc: 0.620 Test Loss: 5.852 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.630900144577026
Epoch: 19, Steps: 13 | Train Loss: 0.063 Vali Loss: 6.008 Vali Acc: 0.678 Test Loss: 6.008 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.931650876998901
Epoch: 20, Steps: 13 | Train Loss: 0.179 Vali Loss: 5.192 Vali Acc: 0.741 Test Loss: 5.192 Test Acc: 0.741
Validation loss decreased (-0.721907 --> -0.741411).  Saving model ...
Epoch: 21 cost time: 6.131317377090454
Epoch: 21, Steps: 13 | Train Loss: 0.077 Vali Loss: 5.428 Vali Acc: 0.663 Test Loss: 5.428 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.3341429233551025
Epoch: 22, Steps: 13 | Train Loss: 0.036 Vali Loss: 6.297 Vali Acc: 0.663 Test Loss: 6.297 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.647367715835571
Epoch: 23, Steps: 13 | Train Loss: 0.018 Vali Loss: 7.681 Vali Acc: 0.576 Test Loss: 7.681 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.994879245758057
Epoch: 24, Steps: 13 | Train Loss: 0.022 Vali Loss: 6.234 Vali Acc: 0.678 Test Loss: 6.234 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.8155903816223145
Epoch: 25, Steps: 13 | Train Loss: 0.013 Vali Loss: 8.170 Vali Acc: 0.556 Test Loss: 8.170 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.021604776382446
Epoch: 26, Steps: 13 | Train Loss: 0.018 Vali Loss: 7.749 Vali Acc: 0.620 Test Loss: 7.749 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.84093713760376
Epoch: 27, Steps: 13 | Train Loss: 0.049 Vali Loss: 8.682 Vali Acc: 0.605 Test Loss: 8.682 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.061015367507935
Epoch: 28, Steps: 13 | Train Loss: 0.018 Vali Loss: 9.066 Vali Acc: 0.707 Test Loss: 9.066 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.159251928329468
Epoch: 29, Steps: 13 | Train Loss: 0.071 Vali Loss: 8.795 Vali Acc: 0.615 Test Loss: 8.795 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.532526969909668
Epoch: 30, Steps: 13 | Train Loss: 0.183 Vali Loss: 11.367 Vali Acc: 0.712 Test Loss: 11.367 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 12592130
model size : 67.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 9.34200644493103
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.992 Vali Acc: 0.722 Test Loss: 0.992 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 7.064472436904907
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.656 Vali Acc: 0.702 Test Loss: 0.656 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.477282762527466
Epoch: 3, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.716 Vali Acc: 0.663 Test Loss: 0.716 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.827661752700806
Epoch: 4, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.504 Vali Acc: 0.390 Test Loss: 1.504 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.22139310836792
Epoch: 5, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.074 Vali Acc: 0.707 Test Loss: 1.074 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.866595268249512
Epoch: 6, Steps: 13 | Train Loss: 0.046 Vali Loss: 2.048 Vali Acc: 0.727 Test Loss: 2.048 Test Acc: 0.727
Validation loss decreased (-0.721941 --> -0.726809).  Saving model ...
Epoch: 7 cost time: 8.131603717803955
Epoch: 7, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.270 Vali Acc: 0.595 Test Loss: 1.270 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.349619388580322
Epoch: 8, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.312 Vali Acc: 0.683 Test Loss: 1.312 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.449671506881714
Epoch: 9, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.246 Vali Acc: 0.737 Test Loss: 2.246 Test Acc: 0.737
Validation loss decreased (-0.726809 --> -0.736563).  Saving model ...
Epoch: 10 cost time: 7.873834848403931
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.509 Vali Acc: 0.673 Test Loss: 1.509 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.434365510940552
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.781 Vali Acc: 0.693 Test Loss: 1.781 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.661389589309692
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.870 Vali Acc: 0.668 Test Loss: 1.870 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.956820726394653
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.043 Vali Acc: 0.712 Test Loss: 2.043 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.042637348175049
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.041 Vali Acc: 0.717 Test Loss: 2.041 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.643867015838623
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.693 Test Loss: 1.838 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.757598638534546
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.712 Test Loss: 2.111 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.520337820053101
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.698 Test Loss: 1.913 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.72770619392395
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.717 Test Loss: 2.029 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.131235599517822
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.712 Test Loss: 2.165 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.263855457305908
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.994 Vali Acc: 0.722 Test Loss: 0.994 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 6.789644718170166
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.754 Vali Acc: 0.600 Test Loss: 0.754 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.411354064941406
Epoch: 3, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.771 Vali Acc: 0.624 Test Loss: 0.771 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.61708664894104
Epoch: 4, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.968 Vali Acc: 0.507 Test Loss: 0.968 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.464800834655762
Epoch: 5, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.928 Vali Acc: 0.722 Test Loss: 1.928 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.089954137802124
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.201 Vali Acc: 0.629 Test Loss: 1.201 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.471008539199829
Epoch: 7, Steps: 13 | Train Loss: 0.177 Vali Loss: 2.703 Vali Acc: 0.741 Test Loss: 2.703 Test Acc: 0.741
Validation loss decreased (-0.721941 --> -0.741436).  Saving model ...
Epoch: 8 cost time: 6.954427719116211
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.738 Vali Acc: 0.673 Test Loss: 1.738 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.407953500747681
Epoch: 9, Steps: 13 | Train Loss: 0.065 Vali Loss: 3.145 Vali Acc: 0.722 Test Loss: 3.145 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.3445725440979
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.171 Vali Acc: 0.698 Test Loss: 2.171 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.117945671081543
Epoch: 11, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.899 Vali Acc: 0.717 Test Loss: 1.899 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.3381311893463135
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.046 Vali Acc: 0.610 Test Loss: 2.046 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.636129140853882
Epoch: 13, Steps: 13 | Train Loss: 0.043 Vali Loss: 3.133 Vali Acc: 0.717 Test Loss: 3.133 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.964456796646118
Epoch: 14, Steps: 13 | Train Loss: 0.009 Vali Loss: 3.448 Vali Acc: 0.727 Test Loss: 3.448 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.765735626220703
Epoch: 15, Steps: 13 | Train Loss: 0.015 Vali Loss: 3.599 Vali Acc: 0.732 Test Loss: 3.599 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.4225914478302
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 3.308 Vali Acc: 0.727 Test Loss: 3.308 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.800391674041748
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.066 Vali Acc: 0.649 Test Loss: 3.066 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.896611452102661
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
Validation loss decreased (inf --> -0.721940).  Saving model ...
Epoch: 2 cost time: 6.794562578201294
Epoch: 2, Steps: 13 | Train Loss: 0.817 Vali Loss: 1.185 Vali Acc: 0.727 Test Loss: 1.185 Test Acc: 0.727
Validation loss decreased (-0.721940 --> -0.726817).  Saving model ...
Epoch: 3 cost time: 6.605080604553223
Epoch: 3, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.859 Vali Acc: 0.620 Test Loss: 0.859 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.474013328552246
Epoch: 4, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.140 Vali Acc: 0.551 Test Loss: 1.140 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.398841857910156
Epoch: 5, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.776 Vali Acc: 0.732 Test Loss: 1.776 Test Acc: 0.732
Validation loss decreased (-0.726817 --> -0.731690).  Saving model ...
Epoch: 6 cost time: 7.218995809555054
Epoch: 6, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.162 Vali Acc: 0.668 Test Loss: 1.162 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.412304639816284
Epoch: 7, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.280 Vali Acc: 0.702 Test Loss: 1.280 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.9589316844940186
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.350 Vali Acc: 0.615 Test Loss: 1.350 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.304320812225342
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.444 Vali Acc: 0.644 Test Loss: 1.444 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.268049240112305
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 2.995 Vali Acc: 0.741 Test Loss: 2.995 Test Acc: 0.741
Validation loss decreased (-0.731690 --> -0.741433).  Saving model ...
Epoch: 11 cost time: 7.339196443557739
Epoch: 11, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.185 Vali Acc: 0.634 Test Loss: 2.185 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.522320508956909
Epoch: 12, Steps: 13 | Train Loss: 0.030 Vali Loss: 2.504 Vali Acc: 0.659 Test Loss: 2.504 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.969235181808472
Epoch: 13, Steps: 13 | Train Loss: 0.269 Vali Loss: 4.647 Vali Acc: 0.732 Test Loss: 4.647 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.542140483856201
Epoch: 14, Steps: 13 | Train Loss: 0.185 Vali Loss: 4.213 Vali Acc: 0.722 Test Loss: 4.213 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.333335638046265
Epoch: 15, Steps: 13 | Train Loss: 0.091 Vali Loss: 4.265 Vali Acc: 0.663 Test Loss: 4.265 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.375169038772583
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 3.914 Vali Acc: 0.668 Test Loss: 3.914 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.715715408325195
Epoch: 17, Steps: 13 | Train Loss: 0.068 Vali Loss: 3.916 Vali Acc: 0.702 Test Loss: 3.916 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.739169359207153
Epoch: 18, Steps: 13 | Train Loss: 0.029 Vali Loss: 3.480 Vali Acc: 0.659 Test Loss: 3.480 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.706280708312988
Epoch: 19, Steps: 13 | Train Loss: 0.051 Vali Loss: 5.279 Vali Acc: 0.727 Test Loss: 5.279 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.27552342414856
Epoch: 20, Steps: 13 | Train Loss: 0.130 Vali Loss: 7.811 Vali Acc: 0.727 Test Loss: 7.811 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.724594593048096
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 1.133 Vali Acc: 0.722 Test Loss: 1.133 Test Acc: 0.722
Validation loss decreased (inf --> -0.721940).  Saving model ...
Epoch: 2 cost time: 5.824460983276367
Epoch: 2, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.817 Vali Acc: 0.722 Test Loss: 0.817 Test Acc: 0.722
Validation loss decreased (-0.721940 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 6.117268323898315
Epoch: 3, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.999 Vali Acc: 0.712 Test Loss: 0.999 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.64997124671936
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.538 Vali Acc: 0.473 Test Loss: 1.538 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.184624195098877
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.312 Vali Acc: 0.722 Test Loss: 1.312 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.196685791015625
Epoch: 6, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.297 Vali Acc: 0.517 Test Loss: 1.297 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.427654981613159
Epoch: 7, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.611 Vali Acc: 0.722 Test Loss: 1.611 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.634894847869873
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.562 Vali Acc: 0.659 Test Loss: 1.562 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.391709566116333
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.109 Vali Acc: 0.727 Test Loss: 2.109 Test Acc: 0.727
Validation loss decreased (-0.721943 --> -0.726808).  Saving model ...
Epoch: 10 cost time: 6.177632570266724
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.773 Vali Acc: 0.605 Test Loss: 1.773 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.384143114089966
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.022 Vali Acc: 0.629 Test Loss: 2.022 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.168652296066284
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.377 Vali Acc: 0.693 Test Loss: 2.377 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.3859922885894775
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 3.501 Vali Acc: 0.707 Test Loss: 3.501 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.446702003479004
Epoch: 14, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.749 Vali Acc: 0.668 Test Loss: 2.749 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.306501865386963
Epoch: 15, Steps: 13 | Train Loss: 0.063 Vali Loss: 3.252 Vali Acc: 0.668 Test Loss: 3.252 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.410085916519165
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.914 Vali Acc: 0.585 Test Loss: 2.914 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.544806003570557
Epoch: 17, Steps: 13 | Train Loss: 0.031 Vali Loss: 3.852 Vali Acc: 0.717 Test Loss: 3.852 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.677047491073608
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.505 Vali Acc: 0.590 Test Loss: 3.505 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.701981782913208
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 3.452 Vali Acc: 0.673 Test Loss: 3.452 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.957145690917969
Epoch: 1, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.917 Vali Acc: 0.722 Test Loss: 0.917 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 6.612128257751465
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.909 Vali Acc: 0.737 Test Loss: 0.909 Test Acc: 0.737
Validation loss decreased (-0.721942 --> -0.736576).  Saving model ...
Epoch: 3 cost time: 5.977384567260742
Epoch: 3, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.896 Vali Acc: 0.751 Test Loss: 0.896 Test Acc: 0.751
Validation loss decreased (-0.736576 --> -0.751211).  Saving model ...
Epoch: 4 cost time: 6.248447895050049
Epoch: 4, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.545 Vali Acc: 0.498 Test Loss: 1.545 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.130707025527954
Epoch: 5, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.180 Vali Acc: 0.678 Test Loss: 1.180 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.199430704116821
Epoch: 6, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.792 Vali Acc: 0.746 Test Loss: 1.792 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.529556035995483
Epoch: 7, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.633 Vali Acc: 0.732 Test Loss: 1.633 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.717301845550537
Epoch: 8, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.939 Vali Acc: 0.741 Test Loss: 1.939 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.125934839248657
Epoch: 9, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.798 Vali Acc: 0.722 Test Loss: 1.798 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.423274278640747
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.862 Vali Acc: 0.649 Test Loss: 1.862 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.744974136352539
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.123 Vali Acc: 0.722 Test Loss: 2.123 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.528665065765381
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.288 Vali Acc: 0.722 Test Loss: 2.288 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.849573612213135
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.404 Vali Acc: 0.751 Test Loss: 2.404 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.5126283168792725
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.983 Vali Acc: 0.722 Test Loss: 0.983 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 5.309124708175659
Epoch: 2, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.901 Vali Acc: 0.727 Test Loss: 0.901 Test Acc: 0.727
Validation loss decreased (-0.721941 --> -0.726820).  Saving model ...
Epoch: 3 cost time: 5.246430397033691
Epoch: 3, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.973 Vali Acc: 0.741 Test Loss: 0.973 Test Acc: 0.741
Validation loss decreased (-0.726820 --> -0.741454).  Saving model ...
Epoch: 4 cost time: 5.507479667663574
Epoch: 4, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.318 Vali Acc: 0.488 Test Loss: 1.318 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.473108530044556
Epoch: 5, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.052 Vali Acc: 0.707 Test Loss: 1.052 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.537549257278442
Epoch: 6, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.572 Vali Acc: 0.732 Test Loss: 1.572 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.824998378753662
Epoch: 7, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.335 Vali Acc: 0.707 Test Loss: 1.335 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.436177492141724
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.572 Vali Acc: 0.722 Test Loss: 1.572 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.766469478607178
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.072 Vali Acc: 0.722 Test Loss: 2.072 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.970532417297363
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.865 Vali Acc: 0.595 Test Loss: 1.865 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.7289721965789795
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.053 Vali Acc: 0.751 Test Loss: 2.053 Test Acc: 0.751
Validation loss decreased (-0.741454 --> -0.751199).  Saving model ...
Epoch: 12 cost time: 6.400971412658691
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.864 Vali Acc: 0.712 Test Loss: 1.864 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.9234747886657715
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.180 Vali Acc: 0.727 Test Loss: 2.180 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.560334205627441
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.715 Vali Acc: 0.737 Test Loss: 2.715 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.1926493644714355
Epoch: 15, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.501 Vali Acc: 0.751 Test Loss: 2.501 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.373760223388672
Epoch: 16, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.406 Vali Acc: 0.737 Test Loss: 2.406 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.261140823364258
Epoch: 17, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.472 Vali Acc: 0.717 Test Loss: 2.472 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.886090517044067
Epoch: 18, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.751 Vali Acc: 0.717 Test Loss: 2.751 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.03210186958313
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 3.036 Vali Acc: 0.683 Test Loss: 3.036 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.144351482391357
Epoch: 20, Steps: 13 | Train Loss: 0.081 Vali Loss: 4.654 Vali Acc: 0.751 Test Loss: 4.654 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.2587385177612305
Epoch: 21, Steps: 13 | Train Loss: 0.112 Vali Loss: 3.429 Vali Acc: 0.668 Test Loss: 3.429 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.740004777908325
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.876 Vali Acc: 0.722 Test Loss: 0.876 Test Acc: 0.722
Validation loss decreased (inf --> -0.721942).  Saving model ...
Epoch: 2 cost time: 5.865083932876587
Epoch: 2, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.839 Vali Acc: 0.712 Test Loss: 0.839 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.766238212585449
Epoch: 3, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.858 Vali Acc: 0.683 Test Loss: 0.858 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.101012229919434
Epoch: 4, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.893 Vali Acc: 0.727 Test Loss: 0.893 Test Acc: 0.727
Validation loss decreased (-0.721942 --> -0.726820).  Saving model ...
Epoch: 5 cost time: 5.492514610290527
Epoch: 5, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.549 Vali Acc: 0.707 Test Loss: 1.549 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7640581130981445
Epoch: 6, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.133 Vali Acc: 0.727 Test Loss: 1.133 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.772762060165405
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.181 Vali Acc: 0.727 Test Loss: 1.181 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.764202117919922
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.187 Vali Acc: 0.693 Test Loss: 1.187 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.3161046504974365
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.517 Vali Acc: 0.712 Test Loss: 1.517 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.9495556354522705
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.722 Test Loss: 1.469 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.936699628829956
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.717 Test Loss: 1.515 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.909187078475952
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.717 Test Loss: 1.415 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.388635873794556
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.727 Test Loss: 1.627 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.555851459503174
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.717 Test Loss: 1.458 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.901547431945801
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.827 Vali Acc: 0.722 Test Loss: 0.827 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 5.098520994186401
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.209253311157227
Epoch: 3, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.789 Vali Acc: 0.654 Test Loss: 0.789 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.535904407501221
Epoch: 4, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.926 Vali Acc: 0.707 Test Loss: 0.926 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.136302947998047
Epoch: 5, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.150 Vali Acc: 0.712 Test Loss: 1.150 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.3861000537872314
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.819 Vali Acc: 0.717 Test Loss: 1.819 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.330947637557983
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.252 Vali Acc: 0.712 Test Loss: 1.252 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.785703182220459
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.175 Vali Acc: 0.673 Test Loss: 1.175 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.777230739593506
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.830 Vali Acc: 0.702 Test Loss: 1.830 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.788022994995117
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.354 Vali Acc: 0.698 Test Loss: 1.354 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.8015735149383545
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.707 Test Loss: 1.359 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.843606948852539
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.613 Vali Acc: 0.663 Test Loss: 0.613 Test Acc: 0.663
Validation loss decreased (inf --> -0.663409).  Saving model ...
Epoch: 2 cost time: 5.913099050521851
Epoch: 2, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.698 Vali Acc: 0.595 Test Loss: 0.698 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.717601776123047
Epoch: 3, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.783 Vali Acc: 0.659 Test Loss: 0.783 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.559738397598267
Epoch: 4, Steps: 13 | Train Loss: 0.130 Vali Loss: 2.790 Vali Acc: 0.288 Test Loss: 2.790 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.362766981124878
Epoch: 5, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.045 Vali Acc: 0.620 Test Loss: 1.045 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.516718864440918
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.322 Vali Acc: 0.580 Test Loss: 1.322 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.851757049560547
Epoch: 7, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.350 Vali Acc: 0.644 Test Loss: 1.350 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.502281188964844
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.604 Vali Acc: 0.507 Test Loss: 1.604 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.11020302772522
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.465 Vali Acc: 0.590 Test Loss: 1.465 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.2962706089019775
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.627 Vali Acc: 0.590 Test Loss: 1.627 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.8385467529296875
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.872 Vali Acc: 0.532 Test Loss: 1.872 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6634146341463415
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.050883293151855
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.642 Vali Acc: 0.620 Test Loss: 0.642 Test Acc: 0.620
Validation loss decreased (inf --> -0.619506).  Saving model ...
Epoch: 2 cost time: 5.765776872634888
Epoch: 2, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
Validation loss decreased (-0.619506 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.094555616378784
Epoch: 3, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.502 Vali Acc: 0.327 Test Loss: 1.502 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.768766641616821
Epoch: 4, Steps: 13 | Train Loss: 0.291 Vali Loss: 2.410 Vali Acc: 0.312 Test Loss: 2.410 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.909620046615601
Epoch: 5, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.989 Vali Acc: 0.629 Test Loss: 0.989 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.426784992218018
Epoch: 6, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.316 Vali Acc: 0.654 Test Loss: 1.316 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.98625636100769
Epoch: 7, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.524 Vali Acc: 0.634 Test Loss: 1.524 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.505508661270142
Epoch: 8, Steps: 13 | Train Loss: 0.106 Vali Loss: 3.618 Vali Acc: 0.468 Test Loss: 3.618 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.140930652618408
Epoch: 9, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.866 Vali Acc: 0.566 Test Loss: 2.866 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.916790723800659
Epoch: 10, Steps: 13 | Train Loss: 0.092 Vali Loss: 2.737 Vali Acc: 0.683 Test Loss: 2.737 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.3656005859375
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 3.685 Vali Acc: 0.629 Test Loss: 3.685 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.165889024734497
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 4.653 Vali Acc: 0.556 Test Loss: 4.653 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 11805698
model size : 64.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.59162163734436
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.622 Vali Acc: 0.698 Test Loss: 0.622 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 6.716067790985107
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.643 Vali Acc: 0.678 Test Loss: 0.643 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.780566453933716
Epoch: 3, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.758 Vali Acc: 0.712 Test Loss: 0.758 Test Acc: 0.712
Validation loss decreased (-0.697555 --> -0.712188).  Saving model ...
Epoch: 4 cost time: 6.588117361068726
Epoch: 4, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.952 Vali Acc: 0.741 Test Loss: 0.952 Test Acc: 0.741
Validation loss decreased (-0.712188 --> -0.741454).  Saving model ...
Epoch: 5 cost time: 6.40204381942749
Epoch: 5, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.837 Vali Acc: 0.366 Test Loss: 1.837 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.649242639541626
Epoch: 6, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.753 Vali Acc: 0.483 Test Loss: 1.753 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.773786544799805
Epoch: 7, Steps: 13 | Train Loss: 0.213 Vali Loss: 2.046 Vali Acc: 0.732 Test Loss: 2.046 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.243418216705322
Epoch: 8, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.785 Vali Acc: 0.488 Test Loss: 1.785 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.306135416030884
Epoch: 9, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.423 Vali Acc: 0.654 Test Loss: 1.423 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.65446925163269
Epoch: 10, Steps: 13 | Train Loss: 0.095 Vali Loss: 2.142 Vali Acc: 0.741 Test Loss: 2.142 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.267701625823975
Epoch: 11, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.417 Vali Acc: 0.693 Test Loss: 1.417 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.489352703094482
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.715 Vali Acc: 0.707 Test Loss: 1.715 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.98400092124939
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.948 Vali Acc: 0.707 Test Loss: 1.948 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.843853235244751
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.421 Vali Acc: 0.732 Test Loss: 2.421 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.360962390899658
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.647 Vali Acc: 0.649 Test Loss: 0.647 Test Acc: 0.649
Validation loss decreased (inf --> -0.648774).  Saving model ...
Epoch: 2 cost time: 6.447162628173828
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.677 Vali Acc: 0.688 Test Loss: 0.677 Test Acc: 0.688
Validation loss decreased (-0.648774 --> -0.687798).  Saving model ...
Epoch: 3 cost time: 7.1632914543151855
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 2.285 Vali Acc: 0.722 Test Loss: 2.285 Test Acc: 0.722
Validation loss decreased (-0.687798 --> -0.721928).  Saving model ...
Epoch: 4 cost time: 6.203125476837158
Epoch: 4, Steps: 13 | Train Loss: 0.753 Vali Loss: 1.504 Vali Acc: 0.732 Test Loss: 1.504 Test Acc: 0.732
Validation loss decreased (-0.721928 --> -0.731692).  Saving model ...
Epoch: 5 cost time: 6.665198087692261
Epoch: 5, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.256 Vali Acc: 0.561 Test Loss: 1.256 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.43726110458374
Epoch: 6, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.124 Vali Acc: 0.639 Test Loss: 1.124 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.003785848617554
Epoch: 7, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.496 Vali Acc: 0.727 Test Loss: 1.496 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.721465826034546
Epoch: 8, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.288 Vali Acc: 0.663 Test Loss: 1.288 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.184601068496704
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.567 Vali Acc: 0.717 Test Loss: 1.567 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.339616298675537
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.498 Vali Acc: 0.688 Test Loss: 1.498 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.067254066467285
Epoch: 11, Steps: 13 | Train Loss: 0.017 Vali Loss: 2.254 Vali Acc: 0.732 Test Loss: 2.254 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.543810606002808
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.815 Vali Acc: 0.683 Test Loss: 1.815 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.93811559677124
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.281 Vali Acc: 0.741 Test Loss: 2.281 Test Acc: 0.741
Validation loss decreased (-0.731692 --> -0.741441).  Saving model ...
Epoch: 14 cost time: 6.71138858795166
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.534 Vali Acc: 0.741 Test Loss: 2.534 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.894330024719238
Epoch: 15, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.371 Vali Acc: 0.727 Test Loss: 2.371 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.964360237121582
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.184 Vali Acc: 0.673 Test Loss: 2.184 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.212341547012329
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.551 Vali Acc: 0.585 Test Loss: 2.551 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.339883089065552
Epoch: 18, Steps: 13 | Train Loss: 0.097 Vali Loss: 3.484 Vali Acc: 0.722 Test Loss: 3.484 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.51202654838562
Epoch: 19, Steps: 13 | Train Loss: 0.434 Vali Loss: 5.541 Vali Acc: 0.712 Test Loss: 5.541 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.887120962142944
Epoch: 20, Steps: 13 | Train Loss: 0.088 Vali Loss: 3.035 Vali Acc: 0.712 Test Loss: 3.035 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.847721815109253
Epoch: 21, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.220 Vali Acc: 0.576 Test Loss: 3.220 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.3617658615112305
Epoch: 22, Steps: 13 | Train Loss: 0.075 Vali Loss: 4.846 Vali Acc: 0.478 Test Loss: 4.846 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.129745960235596
Epoch: 23, Steps: 13 | Train Loss: 0.146 Vali Loss: 5.616 Vali Acc: 0.727 Test Loss: 5.616 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.010116338729858
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.632 Vali Acc: 0.668 Test Loss: 0.632 Test Acc: 0.668
Validation loss decreased (inf --> -0.668286).  Saving model ...
Epoch: 2 cost time: 5.975220680236816
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.757 Vali Acc: 0.717 Test Loss: 0.757 Test Acc: 0.717
Validation loss decreased (-0.668286 --> -0.717066).  Saving model ...
Epoch: 3 cost time: 5.788163423538208
Epoch: 3, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.113 Vali Acc: 0.751 Test Loss: 1.113 Test Acc: 0.751
Validation loss decreased (-0.717066 --> -0.751208).  Saving model ...
Epoch: 4 cost time: 6.275281667709351
Epoch: 4, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.009 Vali Acc: 0.737 Test Loss: 1.009 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.162752866744995
Epoch: 5, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.995 Vali Acc: 0.702 Test Loss: 0.995 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.3757524490356445
Epoch: 6, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.086 Vali Acc: 0.702 Test Loss: 1.086 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.561795234680176
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.068 Vali Acc: 0.390 Test Loss: 2.068 Test Acc: 0.390
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.020841836929321
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.374 Vali Acc: 0.663 Test Loss: 1.374 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.784821271896362
Epoch: 9, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.603 Vali Acc: 0.727 Test Loss: 1.603 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.78072190284729
Epoch: 10, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.153 Vali Acc: 0.712 Test Loss: 2.153 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.561201572418213
Epoch: 11, Steps: 13 | Train Loss: 0.044 Vali Loss: 2.090 Vali Acc: 0.702 Test Loss: 2.090 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.588681936264038
Epoch: 12, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.456 Vali Acc: 0.698 Test Loss: 2.456 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.684192419052124
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.482 Vali Acc: 0.702 Test Loss: 2.482 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.721174955368042
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.682 Vali Acc: 0.644 Test Loss: 0.682 Test Acc: 0.644
Validation loss decreased (inf --> -0.643896).  Saving model ...
Epoch: 2 cost time: 5.746327877044678
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.740 Vali Acc: 0.707 Test Loss: 0.740 Test Acc: 0.707
Validation loss decreased (-0.643896 --> -0.707310).  Saving model ...
Epoch: 3 cost time: 5.848792314529419
Epoch: 3, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.837 Vali Acc: 0.707 Test Loss: 0.837 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.067638874053955
Epoch: 4, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.876 Vali Acc: 0.717 Test Loss: 1.876 Test Acc: 0.717
Validation loss decreased (-0.707310 --> -0.717054).  Saving model ...
Epoch: 5 cost time: 5.7811219692230225
Epoch: 5, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.113 Vali Acc: 0.576 Test Loss: 1.113 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.132101535797119
Epoch: 6, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.223 Vali Acc: 0.610 Test Loss: 1.223 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.9529664516448975
Epoch: 7, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.344 Vali Acc: 0.644 Test Loss: 1.344 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.58611798286438
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.289 Vali Acc: 0.654 Test Loss: 1.289 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.450397491455078
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.526 Vali Acc: 0.659 Test Loss: 1.526 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.921576738357544
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.630 Vali Acc: 0.634 Test Loss: 1.630 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.034025192260742
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.297 Vali Acc: 0.702 Test Loss: 2.297 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.008370876312256
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.014 Vali Acc: 0.659 Test Loss: 2.014 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.898181915283203
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.887 Vali Acc: 0.639 Test Loss: 1.887 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.275265693664551
Epoch: 14, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.040 Vali Acc: 0.649 Test Loss: 2.040 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.673560380935669
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 5.906144142150879
Epoch: 2, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.693 Vali Acc: 0.668 Test Loss: 0.693 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.258788347244263
Epoch: 3, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.963 Vali Acc: 0.732 Test Loss: 1.963 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.68225622177124
Epoch: 4, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.180 Vali Acc: 0.751 Test Loss: 1.180 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751208).  Saving model ...
Epoch: 5 cost time: 6.16456937789917
Epoch: 5, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.162 Vali Acc: 0.722 Test Loss: 1.162 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.658123016357422
Epoch: 6, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.349 Vali Acc: 0.634 Test Loss: 1.349 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.864959716796875
Epoch: 7, Steps: 13 | Train Loss: 0.174 Vali Loss: 2.061 Vali Acc: 0.615 Test Loss: 2.061 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.704596281051636
Epoch: 8, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.976 Vali Acc: 0.717 Test Loss: 1.976 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.011736154556274
Epoch: 9, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.882 Vali Acc: 0.620 Test Loss: 1.882 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.4824182987213135
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.911 Vali Acc: 0.673 Test Loss: 1.911 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.796936511993408
Epoch: 11, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.986 Vali Acc: 0.673 Test Loss: 1.986 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.9487035274505615
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.965 Vali Acc: 0.654 Test Loss: 1.965 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.997159481048584
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.121 Vali Acc: 0.712 Test Loss: 2.121 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.153856992721558
Epoch: 14, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.765 Vali Acc: 0.615 Test Loss: 2.765 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.00571346282959
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.668 Vali Acc: 0.605 Test Loss: 0.668 Test Acc: 0.605
Validation loss decreased (inf --> -0.604871).  Saving model ...
Epoch: 2 cost time: 5.445204734802246
Epoch: 2, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.676 Vali Acc: 0.722 Test Loss: 0.676 Test Acc: 0.722
Validation loss decreased (-0.604871 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 5.553776502609253
Epoch: 3, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.919 Vali Acc: 0.741 Test Loss: 0.919 Test Acc: 0.741
Validation loss decreased (-0.721944 --> -0.741454).  Saving model ...
Epoch: 4 cost time: 5.578787803649902
Epoch: 4, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.76252555847168
Epoch: 5, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.239 Vali Acc: 0.624 Test Loss: 1.239 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.46066951751709
Epoch: 6, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.344 Vali Acc: 0.683 Test Loss: 1.344 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.408898591995239
Epoch: 7, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.372 Vali Acc: 0.678 Test Loss: 1.372 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.368083953857422
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.922 Vali Acc: 0.727 Test Loss: 1.922 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.085542917251587
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.621 Vali Acc: 0.702 Test Loss: 1.621 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.780473709106445
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.871 Vali Acc: 0.717 Test Loss: 1.871 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.398327589035034
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.064 Vali Acc: 0.712 Test Loss: 2.064 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.902510404586792
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.712 Test Loss: 2.012 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.8353111743927
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.002 Vali Acc: 0.702 Test Loss: 2.002 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.11721658706665
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.679 Vali Acc: 0.654 Test Loss: 0.679 Test Acc: 0.654
Validation loss decreased (inf --> -0.653652).  Saving model ...
Epoch: 2 cost time: 6.244272708892822
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.676 Vali Acc: 0.702 Test Loss: 0.676 Test Acc: 0.702
Validation loss decreased (-0.653652 --> -0.702432).  Saving model ...
Epoch: 3 cost time: 5.952615737915039
Epoch: 3, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.369 Vali Acc: 0.722 Test Loss: 1.369 Test Acc: 0.722
Validation loss decreased (-0.702432 --> -0.721938).  Saving model ...
Epoch: 4 cost time: 5.510403871536255
Epoch: 4, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.948 Vali Acc: 0.722 Test Loss: 0.948 Test Acc: 0.722
Validation loss decreased (-0.721938 --> -0.721942).  Saving model ...
Epoch: 5 cost time: 6.087479114532471
Epoch: 5, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.998 Vali Acc: 0.702 Test Loss: 0.998 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.105975389480591
Epoch: 6, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.108 Vali Acc: 0.668 Test Loss: 1.108 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.3027191162109375
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.436 Vali Acc: 0.712 Test Loss: 1.436 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.549386262893677
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.280 Vali Acc: 0.693 Test Loss: 1.280 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.144389629364014
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.622 Vali Acc: 0.576 Test Loss: 1.622 Test Acc: 0.576
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.04937481880188
Epoch: 10, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.325 Vali Acc: 0.654 Test Loss: 1.325 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.455358028411865
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.660 Vali Acc: 0.717 Test Loss: 1.660 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.603293180465698
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.165 Vali Acc: 0.698 Test Loss: 2.165 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.424848556518555
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.411 Vali Acc: 0.712 Test Loss: 2.411 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.788758993148804
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.741 Vali Acc: 0.688 Test Loss: 1.741 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.607320070266724
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.619 Vali Acc: 0.712 Test Loss: 0.619 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 6.151238441467285
Epoch: 2, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.719 Vali Acc: 0.722 Test Loss: 0.719 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 5.673249244689941
Epoch: 3, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.147 Vali Acc: 0.717 Test Loss: 1.147 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.656095266342163
Epoch: 4, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.207 Vali Acc: 0.722 Test Loss: 1.207 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.581902980804443
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.974 Vali Acc: 0.702 Test Loss: 0.974 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.651024103164673
Epoch: 6, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.093 Vali Acc: 0.712 Test Loss: 1.093 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.800430774688721
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.440 Vali Acc: 0.688 Test Loss: 1.440 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.496989965438843
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.338 Vali Acc: 0.702 Test Loss: 1.338 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.483876943588257
Epoch: 9, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.487 Vali Acc: 0.620 Test Loss: 1.487 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.897753000259399
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.358 Vali Acc: 0.678 Test Loss: 1.358 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.036849737167358
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.541 Vali Acc: 0.717 Test Loss: 1.541 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.772059679031372
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.699 Vali Acc: 0.707 Test Loss: 1.699 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.873842477798462
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 1.530 Vali Acc: 0.278 Test Loss: 1.530 Test Acc: 0.278
Validation loss decreased (inf --> -0.278033).  Saving model ...
Epoch: 2 cost time: 5.96597695350647
Epoch: 2, Steps: 13 | Train Loss: 0.635 Vali Loss: 1.044 Vali Acc: 0.366 Test Loss: 1.044 Test Acc: 0.366
Validation loss decreased (-0.278033 --> -0.365843).  Saving model ...
Epoch: 3 cost time: 5.631692409515381
Epoch: 3, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.899 Vali Acc: 0.532 Test Loss: 0.899 Test Acc: 0.532
Validation loss decreased (-0.365843 --> -0.531698).  Saving model ...
Epoch: 4 cost time: 5.600014925003052
Epoch: 4, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.003 Vali Acc: 0.654 Test Loss: 1.003 Test Acc: 0.654
Validation loss decreased (-0.531698 --> -0.653649).  Saving model ...
Epoch: 5 cost time: 5.71019983291626
Epoch: 5, Steps: 13 | Train Loss: 0.120 Vali Loss: 3.286 Vali Acc: 0.293 Test Loss: 3.286 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.5070719718933105
Epoch: 6, Steps: 13 | Train Loss: 0.179 Vali Loss: 4.623 Vali Acc: 0.293 Test Loss: 4.623 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.9923553466796875
Epoch: 7, Steps: 13 | Train Loss: 0.111 Vali Loss: 3.461 Vali Acc: 0.351 Test Loss: 3.461 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.450013875961304
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.705 Vali Acc: 0.644 Test Loss: 1.705 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.684800863265991
Epoch: 9, Steps: 13 | Train Loss: 0.025 Vali Loss: 2.136 Vali Acc: 0.512 Test Loss: 2.136 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.321842432022095
Epoch: 10, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.122 Vali Acc: 0.663 Test Loss: 2.122 Test Acc: 0.663
Validation loss decreased (-0.653649 --> -0.663393).  Saving model ...
Epoch: 11 cost time: 5.785881996154785
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.339 Vali Acc: 0.649 Test Loss: 2.339 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.091013431549072
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.625 Vali Acc: 0.663 Test Loss: 2.625 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.550901174545288
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 3.808 Vali Acc: 0.449 Test Loss: 3.808 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.924075603485107
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 4.985 Vali Acc: 0.385 Test Loss: 4.985 Test Acc: 0.385
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.831423044204712
Epoch: 15, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.916 Vali Acc: 0.566 Test Loss: 2.916 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.110102653503418
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.564 Vali Acc: 0.483 Test Loss: 3.564 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.549914836883545
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 3.761 Vali Acc: 0.517 Test Loss: 3.761 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.752086877822876
Epoch: 18, Steps: 13 | Train Loss: 0.087 Vali Loss: 6.140 Vali Acc: 0.361 Test Loss: 6.140 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.503381729125977
Epoch: 19, Steps: 13 | Train Loss: 0.008 Vali Loss: 7.229 Vali Acc: 0.415 Test Loss: 7.229 Test Acc: 0.415
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.671860218048096
Epoch: 20, Steps: 13 | Train Loss: 0.051 Vali Loss: 7.816 Vali Acc: 0.439 Test Loss: 7.816 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6634146341463415
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.057327270507812
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 1.526 Vali Acc: 0.278 Test Loss: 1.526 Test Acc: 0.278
Validation loss decreased (inf --> -0.278034).  Saving model ...
Epoch: 2 cost time: 5.690054893493652
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 1.478 Vali Acc: 0.298 Test Loss: 1.478 Test Acc: 0.298
Validation loss decreased (-0.278034 --> -0.297546).  Saving model ...
Epoch: 3 cost time: 5.768038511276245
Epoch: 3, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.960 Vali Acc: 0.459 Test Loss: 0.960 Test Acc: 0.459
Validation loss decreased (-0.297546 --> -0.458527).  Saving model ...
Epoch: 4 cost time: 5.664772272109985
Epoch: 4, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.691 Vali Acc: 0.727 Test Loss: 0.691 Test Acc: 0.727
Validation loss decreased (-0.458527 --> -0.726822).  Saving model ...
Epoch: 5 cost time: 5.820715665817261
Epoch: 5, Steps: 13 | Train Loss: 0.366 Vali Loss: 3.231 Vali Acc: 0.312 Test Loss: 3.231 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.206362247467041
Epoch: 6, Steps: 13 | Train Loss: 0.422 Vali Loss: 4.637 Vali Acc: 0.307 Test Loss: 4.637 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.86113429069519
Epoch: 7, Steps: 13 | Train Loss: 0.186 Vali Loss: 2.572 Vali Acc: 0.459 Test Loss: 2.572 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.28817343711853
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 3.284 Vali Acc: 0.454 Test Loss: 3.284 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.74937629699707
Epoch: 9, Steps: 13 | Train Loss: 0.079 Vali Loss: 2.910 Vali Acc: 0.620 Test Loss: 2.910 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.958326101303101
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 2.532 Vali Acc: 0.649 Test Loss: 2.532 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.847997665405273
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 3.717 Vali Acc: 0.595 Test Loss: 3.717 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.72685694694519
Epoch: 12, Steps: 13 | Train Loss: 0.158 Vali Loss: 3.948 Vali Acc: 0.717 Test Loss: 3.948 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.882120847702026
Epoch: 13, Steps: 13 | Train Loss: 0.111 Vali Loss: 3.653 Vali Acc: 0.673 Test Loss: 3.653 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.970871686935425
Epoch: 14, Steps: 13 | Train Loss: 0.109 Vali Loss: 4.049 Vali Acc: 0.659 Test Loss: 4.049 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 11412482
model size : 63.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.533635377883911
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.697 Vali Acc: 0.722 Test Loss: 0.697 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.8460705280303955
Epoch: 2, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.807 Vali Acc: 0.717 Test Loss: 0.807 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0289146900177
Epoch: 3, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.728 Vali Acc: 0.722 Test Loss: 0.728 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.574185371398926
Epoch: 4, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.677 Vali Acc: 0.712 Test Loss: 0.677 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.592907905578613
Epoch: 5, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.717 Vali Acc: 0.712 Test Loss: 0.717 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.616431951522827
Epoch: 6, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.221 Vali Acc: 0.737 Test Loss: 1.221 Test Acc: 0.737
Validation loss decreased (-0.721944 --> -0.736573).  Saving model ...
Epoch: 7 cost time: 5.44075608253479
Epoch: 7, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.559 Vali Acc: 0.410 Test Loss: 1.559 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.601857423782349
Epoch: 8, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.750 Vali Acc: 0.737 Test Loss: 1.750 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.835993051528931
Epoch: 9, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.727 Vali Acc: 0.722 Test Loss: 1.727 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.42851448059082
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.351 Vali Acc: 0.673 Test Loss: 1.351 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.868947267532349
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.410 Vali Acc: 0.732 Test Loss: 2.410 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.979413270950317
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.724 Vali Acc: 0.717 Test Loss: 1.724 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.104958772659302
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.593 Vali Acc: 0.688 Test Loss: 1.593 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.220351219177246
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.963 Vali Acc: 0.732 Test Loss: 1.963 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.8104376792907715
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.943 Vali Acc: 0.737 Test Loss: 1.943 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.764166355133057
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.574 Vali Acc: 0.668 Test Loss: 1.574 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.108539581298828
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.807380437850952
Epoch: 2, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.833 Vali Acc: 0.732 Test Loss: 0.833 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731699).  Saving model ...
Epoch: 3 cost time: 5.377031326293945
Epoch: 3, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.784 Vali Acc: 0.732 Test Loss: 0.784 Test Acc: 0.732
Validation loss decreased (-0.731699 --> -0.731699).  Saving model ...
Epoch: 4 cost time: 5.695924282073975
Epoch: 4, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.728 Vali Acc: 0.688 Test Loss: 0.728 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.535991430282593
Epoch: 5, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.062 Vali Acc: 0.737 Test Loss: 1.062 Test Acc: 0.737
Validation loss decreased (-0.731699 --> -0.736575).  Saving model ...
Epoch: 6 cost time: 5.7820398807525635
Epoch: 6, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.898 Vali Acc: 0.678 Test Loss: 0.898 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.837529420852661
Epoch: 7, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.463 Vali Acc: 0.732 Test Loss: 1.463 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.718515634536743
Epoch: 8, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.134 Vali Acc: 0.644 Test Loss: 1.134 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.344636917114258
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.202 Vali Acc: 0.698 Test Loss: 1.202 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.493387699127197
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.553 Vali Acc: 0.737 Test Loss: 1.553 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.868126153945923
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.074 Vali Acc: 0.751 Test Loss: 2.074 Test Acc: 0.751
Validation loss decreased (-0.736575 --> -0.751199).  Saving model ...
Epoch: 12 cost time: 6.009535074234009
Epoch: 12, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.612 Vali Acc: 0.727 Test Loss: 1.612 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.7159342765808105
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.693 Vali Acc: 0.663 Test Loss: 1.693 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.712112903594971
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.253 Vali Acc: 0.751 Test Loss: 2.253 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.58725380897522
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.136 Vali Acc: 0.727 Test Loss: 2.136 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.542394638061523
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.542 Vali Acc: 0.751 Test Loss: 2.542 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.452024221420288
Epoch: 17, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.702 Vali Acc: 0.751 Test Loss: 2.702 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.502922296524048
Epoch: 18, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.089 Vali Acc: 0.727 Test Loss: 3.089 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.68747878074646
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.710 Vali Acc: 0.717 Test Loss: 2.710 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.897735595703125
Epoch: 20, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.527 Vali Acc: 0.722 Test Loss: 2.527 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.819090366363525
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 4.087 Vali Acc: 0.732 Test Loss: 4.087 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.132688999176025
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.689 Vali Acc: 0.727 Test Loss: 0.689 Test Acc: 0.727
Validation loss decreased (inf --> -0.726822).  Saving model ...
Epoch: 2 cost time: 5.560542821884155
Epoch: 2, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.821 Vali Acc: 0.732 Test Loss: 0.821 Test Acc: 0.732
Validation loss decreased (-0.726822 --> -0.731699).  Saving model ...
Epoch: 3 cost time: 5.603203296661377
Epoch: 3, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.789 Vali Acc: 0.737 Test Loss: 0.789 Test Acc: 0.737
Validation loss decreased (-0.731699 --> -0.736577).  Saving model ...
Epoch: 4 cost time: 5.561636209487915
Epoch: 4, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.709 Vali Acc: 0.712 Test Loss: 0.709 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.063908576965332
Epoch: 5, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.927 Vali Acc: 0.707 Test Loss: 0.927 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.494981050491333
Epoch: 6, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.342 Vali Acc: 0.732 Test Loss: 1.342 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.563081741333008
Epoch: 7, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.048 Vali Acc: 0.620 Test Loss: 1.048 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.380751848220825
Epoch: 8, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.471 Vali Acc: 0.737 Test Loss: 1.471 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.678980588912964
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.677 Vali Acc: 0.507 Test Loss: 1.677 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.064684152603149
Epoch: 10, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.554 Vali Acc: 0.737 Test Loss: 1.554 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.619434595108032
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.983 Vali Acc: 0.737 Test Loss: 1.983 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.649040937423706
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.767 Vali Acc: 0.707 Test Loss: 1.767 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.228967905044556
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.851 Vali Acc: 0.707 Test Loss: 1.851 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.177819013595581
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.620 Vali Acc: 0.717 Test Loss: 0.620 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.599684476852417
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.864 Vali Acc: 0.722 Test Loss: 0.864 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721943).  Saving model ...
Epoch: 3 cost time: 5.49156641960144
Epoch: 3, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.675 Vali Acc: 0.654 Test Loss: 0.675 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.217941999435425
Epoch: 4, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.862 Vali Acc: 0.707 Test Loss: 0.862 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.454089403152466
Epoch: 5, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.963 Vali Acc: 0.571 Test Loss: 0.963 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.63438081741333
Epoch: 6, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.103 Vali Acc: 0.698 Test Loss: 1.103 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.3995630741119385
Epoch: 7, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.066 Vali Acc: 0.654 Test Loss: 1.066 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.205100774765015
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.437 Vali Acc: 0.727 Test Loss: 1.437 Test Acc: 0.727
Validation loss decreased (-0.721943 --> -0.726815).  Saving model ...
Epoch: 9 cost time: 5.981806755065918
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.784 Vali Acc: 0.322 Test Loss: 2.784 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.804424524307251
Epoch: 10, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.926 Vali Acc: 0.522 Test Loss: 1.926 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.066115617752075
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.495 Vali Acc: 0.624 Test Loss: 1.495 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.130794048309326
Epoch: 12, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.850 Vali Acc: 0.620 Test Loss: 1.850 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.6702940464019775
Epoch: 13, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.764 Vali Acc: 0.659 Test Loss: 1.764 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.772189378738403
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.760 Vali Acc: 0.639 Test Loss: 1.760 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.595022916793823
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.688 Test Loss: 1.881 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.2654736042022705
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.683 Test Loss: 1.890 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.4909443855285645
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.678 Test Loss: 1.902 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.710862874984741
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.693 Test Loss: 1.936 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.719951629638672
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 5.379460096359253
Epoch: 2, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 5.740297317504883
Epoch: 3, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.459268808364868
Epoch: 4, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.761 Vali Acc: 0.663 Test Loss: 0.761 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.26751971244812
Epoch: 5, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.015 Vali Acc: 0.580 Test Loss: 1.015 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.307775259017944
Epoch: 6, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.618 Vali Acc: 0.454 Test Loss: 1.618 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.3805036544799805
Epoch: 7, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.260 Vali Acc: 0.732 Test Loss: 1.260 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.551974773406982
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.359 Vali Acc: 0.741 Test Loss: 1.359 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741450).  Saving model ...
Epoch: 9 cost time: 5.301329135894775
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.229 Vali Acc: 0.673 Test Loss: 1.229 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.430835008621216
Epoch: 10, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.380 Vali Acc: 0.722 Test Loss: 1.380 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.227496862411499
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.427 Vali Acc: 0.722 Test Loss: 1.427 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.3650548458099365
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.448 Vali Acc: 0.727 Test Loss: 1.448 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.330156326293945
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.727 Test Loss: 1.556 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.336597442626953
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.727 Test Loss: 1.476 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.910297393798828
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.737 Test Loss: 1.576 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.247528791427612
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.732 Test Loss: 1.512 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.438242673873901
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.737 Test Loss: 1.557 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.3807454109191895
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.499 Vali Acc: 0.732 Test Loss: 1.499 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.821552038192749
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.700436115264893
Epoch: 2, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.864 Vali Acc: 0.722 Test Loss: 0.864 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.399469614028931
Epoch: 3, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.581119775772095
Epoch: 4, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.756 Vali Acc: 0.751 Test Loss: 0.756 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751212).  Saving model ...
Epoch: 5 cost time: 5.415871858596802
Epoch: 5, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.873 Vali Acc: 0.741 Test Loss: 0.873 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.655493497848511
Epoch: 6, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.034 Vali Acc: 0.727 Test Loss: 1.034 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.473763704299927
Epoch: 7, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.102 Vali Acc: 0.688 Test Loss: 1.102 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.390287637710571
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.324 Vali Acc: 0.751 Test Loss: 1.324 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.40465521812439
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.324 Vali Acc: 0.659 Test Loss: 1.324 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.2470152378082275
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.602 Vali Acc: 0.722 Test Loss: 1.602 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.300652265548706
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.464 Vali Acc: 0.688 Test Loss: 1.464 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.28625226020813
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.479 Vali Acc: 0.698 Test Loss: 1.479 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.555055856704712
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.563 Vali Acc: 0.707 Test Loss: 1.563 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.865959644317627
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.707 Test Loss: 1.734 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.275144815444946
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.646 Vali Acc: 0.712 Test Loss: 0.646 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.36112380027771
Epoch: 2, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.767 Vali Acc: 0.712 Test Loss: 0.767 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.747684478759766
Epoch: 3, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.736 Vali Acc: 0.698 Test Loss: 0.736 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.066951036453247
Epoch: 4, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.786 Vali Acc: 0.698 Test Loss: 0.786 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.094631195068359
Epoch: 5, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721942).  Saving model ...
Epoch: 6 cost time: 5.251402378082275
Epoch: 6, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.252 Vali Acc: 0.717 Test Loss: 1.252 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.371631622314453
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.003 Vali Acc: 0.707 Test Loss: 1.003 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.312655925750732
Epoch: 8, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.252 Vali Acc: 0.732 Test Loss: 1.252 Test Acc: 0.732
Validation loss decreased (-0.721942 --> -0.731695).  Saving model ...
Epoch: 9 cost time: 5.578874826431274
Epoch: 9, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.259 Vali Acc: 0.698 Test Loss: 1.259 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.840810060501099
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.651 Vali Acc: 0.712 Test Loss: 1.651 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.103260517120361
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.555 Vali Acc: 0.737 Test Loss: 1.555 Test Acc: 0.737
Validation loss decreased (-0.731695 --> -0.736570).  Saving model ...
Epoch: 12 cost time: 5.950608491897583
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.554 Vali Acc: 0.732 Test Loss: 1.554 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.658880233764648
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.727 Test Loss: 1.427 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.561932563781738
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.727 Test Loss: 1.626 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.686232328414917
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.727 Test Loss: 1.624 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.309264659881592
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.732 Test Loss: 1.639 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.203348398208618
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.727 Test Loss: 1.715 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.2644829750061035
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.727 Test Loss: 1.642 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.4910900592803955
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.732 Test Loss: 1.734 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.334508657455444
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.732 Test Loss: 1.734 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.788459062576294
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.722 Test Loss: 1.619 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.793065071105957
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.697 Vali Acc: 0.712 Test Loss: 0.697 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 6.2080748081207275
Epoch: 2, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.825 Vali Acc: 0.712 Test Loss: 0.825 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.120118856430054
Epoch: 3, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.687 Vali Acc: 0.693 Test Loss: 0.687 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.585834741592407
Epoch: 4, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.891 Vali Acc: 0.727 Test Loss: 0.891 Test Acc: 0.727
Validation loss decreased (-0.712188 --> -0.726820).  Saving model ...
Epoch: 5 cost time: 5.4117372035980225
Epoch: 5, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.091 Vali Acc: 0.707 Test Loss: 1.091 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.215045213699341
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.079 Vali Acc: 0.707 Test Loss: 1.079 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.53749942779541
Epoch: 7, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.363 Vali Acc: 0.707 Test Loss: 1.363 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.052576780319214
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.135 Vali Acc: 0.693 Test Loss: 1.135 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.562622785568237
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.078 Vali Acc: 0.668 Test Loss: 1.078 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.469783306121826
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.445 Vali Acc: 0.698 Test Loss: 1.445 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.40048885345459
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.254 Vali Acc: 0.678 Test Loss: 1.254 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.773756980895996
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.432 Vali Acc: 0.693 Test Loss: 1.432 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.494503021240234
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.693 Test Loss: 1.445 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.762778043746948
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.442 Vali Acc: 0.702 Test Loss: 1.442 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.7763636112213135
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.263167858123779
Epoch: 2, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.652 Vali Acc: 0.620 Test Loss: 0.652 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.2939558029174805
Epoch: 3, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.876 Vali Acc: 0.439 Test Loss: 0.876 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.072420358657837
Epoch: 4, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.791 Vali Acc: 0.590 Test Loss: 0.791 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.317652702331543
Epoch: 5, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.297 Vali Acc: 0.424 Test Loss: 1.297 Test Acc: 0.424
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.6113057136535645
Epoch: 6, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.825 Vali Acc: 0.351 Test Loss: 1.825 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.436212778091431
Epoch: 7, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.061 Vali Acc: 0.615 Test Loss: 1.061 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.320697069168091
Epoch: 8, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.158 Vali Acc: 0.663 Test Loss: 1.158 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.347341299057007
Epoch: 9, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.215 Vali Acc: 0.605 Test Loss: 1.215 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.245061635971069
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.302 Vali Acc: 0.566 Test Loss: 1.302 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.407455205917358
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.294 Vali Acc: 0.688 Test Loss: 1.294 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.503495931625366
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.973222494125366
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.585 Vali Acc: 0.693 Test Loss: 0.585 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.093170881271362
Epoch: 3, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.018 Vali Acc: 0.410 Test Loss: 1.018 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.218983888626099
Epoch: 4, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.962 Vali Acc: 0.527 Test Loss: 0.962 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.3628387451171875
Epoch: 5, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.678 Vali Acc: 0.351 Test Loss: 1.678 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.432231664657593
Epoch: 6, Steps: 13 | Train Loss: 0.355 Vali Loss: 2.438 Vali Acc: 0.307 Test Loss: 2.438 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.14411473274231
Epoch: 7, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.4925384521484375
Epoch: 8, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.089 Vali Acc: 0.698 Test Loss: 1.089 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.450549840927124
Epoch: 9, Steps: 13 | Train Loss: 0.178 Vali Loss: 1.789 Vali Acc: 0.522 Test Loss: 1.789 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.797577619552612
Epoch: 10, Steps: 13 | Train Loss: 0.096 Vali Loss: 2.070 Vali Acc: 0.546 Test Loss: 2.070 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.790056228637695
Epoch: 11, Steps: 13 | Train Loss: 0.061 Vali Loss: 2.196 Vali Acc: 0.551 Test Loss: 2.196 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 6033922
model size : 32.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.394154787063599
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.570661306381226
Epoch: 2, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.433854579925537
Epoch: 3, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.630 Vali Acc: 0.712 Test Loss: 0.630 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.783552646636963
Epoch: 4, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.663 Vali Acc: 0.693 Test Loss: 0.663 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.88408637046814
Epoch: 5, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.748 Vali Acc: 0.673 Test Loss: 0.748 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.691072225570679
Epoch: 6, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.351 Vali Acc: 0.737 Test Loss: 1.351 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736572).  Saving model ...
Epoch: 7 cost time: 5.70362401008606
Epoch: 7, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.862 Vali Acc: 0.693 Test Loss: 0.862 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.209571838378906
Epoch: 8, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.952 Vali Acc: 0.707 Test Loss: 0.952 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.440123558044434
Epoch: 9, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.107 Vali Acc: 0.668 Test Loss: 1.107 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.484196186065674
Epoch: 10, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.239 Vali Acc: 0.693 Test Loss: 1.239 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.731377363204956
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.891 Vali Acc: 0.732 Test Loss: 1.891 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.97639536857605
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.921 Vali Acc: 0.712 Test Loss: 1.921 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.907632350921631
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.666 Vali Acc: 0.722 Test Loss: 1.666 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.673726558685303
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.707 Vali Acc: 0.727 Test Loss: 1.707 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.639129400253296
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.984 Vali Acc: 0.727 Test Loss: 1.984 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.259285926818848
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.530 Vali Acc: 0.707 Test Loss: 1.530 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.366375684738159
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.498908996582031
Epoch: 2, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.637 Vali Acc: 0.727 Test Loss: 0.637 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 5.7845728397369385
Epoch: 3, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.666 Vali Acc: 0.707 Test Loss: 0.666 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.007146120071411
Epoch: 4, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.729 Vali Acc: 0.654 Test Loss: 0.729 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.535995244979858
Epoch: 5, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.613728284835815
Epoch: 6, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.133 Vali Acc: 0.727 Test Loss: 1.133 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.540615081787109
Epoch: 7, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.985 Vali Acc: 0.654 Test Loss: 0.985 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.030133008956909
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.212 Vali Acc: 0.727 Test Loss: 1.212 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.103044033050537
Epoch: 9, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.255 Vali Acc: 0.707 Test Loss: 1.255 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.094568490982056
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.289 Vali Acc: 0.683 Test Loss: 1.289 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.119980335235596
Epoch: 11, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.468 Vali Acc: 0.717 Test Loss: 2.468 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.288424968719482
Epoch: 12, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.740 Vali Acc: 0.722 Test Loss: 1.740 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.5630879402160645
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 5.810986757278442
Epoch: 2, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.706 Vali Acc: 0.727 Test Loss: 0.706 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.705409288406372
Epoch: 3, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.682 Vali Acc: 0.678 Test Loss: 0.682 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.663691282272339
Epoch: 4, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.848 Vali Acc: 0.741 Test Loss: 0.848 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741455).  Saving model ...
Epoch: 5 cost time: 5.801057577133179
Epoch: 5, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.792 Vali Acc: 0.707 Test Loss: 0.792 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.65285062789917
Epoch: 6, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.498 Vali Acc: 0.746 Test Loss: 1.498 Test Acc: 0.746
Validation loss decreased (-0.741455 --> -0.746326).  Saving model ...
Epoch: 7 cost time: 5.6476054191589355
Epoch: 7, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.976 Vali Acc: 0.659 Test Loss: 0.976 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.347702980041504
Epoch: 8, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.150 Vali Acc: 0.624 Test Loss: 1.150 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.8668437004089355
Epoch: 9, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.201 Vali Acc: 0.683 Test Loss: 1.201 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.268083095550537
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.163 Vali Acc: 0.678 Test Loss: 1.163 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.524307012557983
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.070 Vali Acc: 0.746 Test Loss: 2.070 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.736289739608765
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.820 Vali Acc: 0.756 Test Loss: 1.820 Test Acc: 0.756
Validation loss decreased (-0.746326 --> -0.756079).  Saving model ...
Epoch: 13 cost time: 5.86802864074707
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.539 Vali Acc: 0.712 Test Loss: 1.539 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.862206935882568
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.449 Vali Acc: 0.722 Test Loss: 2.449 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.561370611190796
Epoch: 15, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.357 Vali Acc: 0.717 Test Loss: 2.357 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.602611303329468
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.335 Vali Acc: 0.722 Test Loss: 2.335 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.999369144439697
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.953 Vali Acc: 0.663 Test Loss: 1.953 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.91838812828064
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.865 Vali Acc: 0.727 Test Loss: 1.865 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.45873236656189
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.707 Test Loss: 1.870 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.640223264694214
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.925 Vali Acc: 0.722 Test Loss: 1.925 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.228867530822754
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.883 Vali Acc: 0.707 Test Loss: 1.883 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.106630802154541
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.712 Test Loss: 1.944 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.119974613189697
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.400434494018555
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.1683595180511475
Epoch: 3, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.649 Vali Acc: 0.683 Test Loss: 0.649 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.211758613586426
Epoch: 4, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.714 Vali Acc: 0.644 Test Loss: 0.714 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.339290618896484
Epoch: 5, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.831 Vali Acc: 0.605 Test Loss: 0.831 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.124323129653931
Epoch: 6, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.022 Vali Acc: 0.737 Test Loss: 1.022 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736575).  Saving model ...
Epoch: 7 cost time: 5.389501571655273
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.980 Vali Acc: 0.702 Test Loss: 0.980 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7917115688323975
Epoch: 8, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.182 Vali Acc: 0.702 Test Loss: 1.182 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.950463533401489
Epoch: 9, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.135 Vali Acc: 0.644 Test Loss: 1.135 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.924375772476196
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.360 Vali Acc: 0.688 Test Loss: 1.360 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.276252031326294
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.238 Vali Acc: 0.732 Test Loss: 2.238 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.872738361358643
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.538 Vali Acc: 0.732 Test Loss: 2.538 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.338044166564941
Epoch: 13, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.638 Vali Acc: 0.629 Test Loss: 1.638 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.2975757122039795
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.859 Vali Acc: 0.707 Test Loss: 1.859 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.428012132644653
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.848 Vali Acc: 0.712 Test Loss: 1.848 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.22749137878418
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.693 Test Loss: 1.781 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.271884202957153
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.540 Vali Acc: 0.732 Test Loss: 0.540 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 4.968499422073364
Epoch: 2, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 3 cost time: 5.431436777114868
Epoch: 3, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.638 Vali Acc: 0.746 Test Loss: 0.638 Test Acc: 0.746
Validation loss decreased (-0.736578 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 5.139894247055054
Epoch: 4, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.720 Vali Acc: 0.712 Test Loss: 0.720 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.285010814666748
Epoch: 5, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.954 Vali Acc: 0.741 Test Loss: 0.954 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.000494003295898
Epoch: 6, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.305 Vali Acc: 0.746 Test Loss: 1.305 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.450662851333618
Epoch: 7, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.960 Vali Acc: 0.702 Test Loss: 0.960 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.284148931503296
Epoch: 8, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.084 Vali Acc: 0.698 Test Loss: 1.084 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.5918662548065186
Epoch: 9, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.398 Vali Acc: 0.615 Test Loss: 1.398 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.194368124008179
Epoch: 10, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.400 Vali Acc: 0.678 Test Loss: 1.400 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.4388322830200195
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.615 Vali Acc: 0.712 Test Loss: 1.615 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.709507703781128
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.371 Vali Acc: 0.722 Test Loss: 2.371 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.4603049755096436
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.419 Vali Acc: 0.732 Test Loss: 2.419 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.043398857116699
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 5.0652711391448975
Epoch: 2, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.730 Vali Acc: 0.722 Test Loss: 0.730 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.4960408210754395
Epoch: 3, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.704 Vali Acc: 0.741 Test Loss: 0.704 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741456).  Saving model ...
Epoch: 4 cost time: 5.079466342926025
Epoch: 4, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.861 Vali Acc: 0.639 Test Loss: 0.861 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.892275094985962
Epoch: 5, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.972 Vali Acc: 0.615 Test Loss: 0.972 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.405632019042969
Epoch: 6, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.184 Vali Acc: 0.751 Test Loss: 1.184 Test Acc: 0.751
Validation loss decreased (-0.741456 --> -0.751208).  Saving model ...
Epoch: 7 cost time: 5.835533857345581
Epoch: 7, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.253 Vali Acc: 0.741 Test Loss: 1.253 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.705844402313232
Epoch: 8, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.128 Vali Acc: 0.707 Test Loss: 1.128 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.908089876174927
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.145 Vali Acc: 0.693 Test Loss: 1.145 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.606130361557007
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.255 Vali Acc: 0.673 Test Loss: 1.255 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.604708433151245
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.300 Vali Acc: 0.717 Test Loss: 1.300 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.061440467834473
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.741 Test Loss: 1.480 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.391726732254028
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.712 Test Loss: 1.334 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.491835594177246
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.732 Test Loss: 1.646 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.644373893737793
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.732 Test Loss: 1.464 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.341452360153198
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.732 Test Loss: 1.526 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.870851755142212
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 6.037778615951538
Epoch: 2, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.670 Vali Acc: 0.727 Test Loss: 0.670 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.671466588973999
Epoch: 3, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.933 Vali Acc: 0.712 Test Loss: 0.933 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.828519821166992
Epoch: 4, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.12205171585083
Epoch: 5, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.856 Vali Acc: 0.595 Test Loss: 0.856 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.530581712722778
Epoch: 6, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.803921699523926
Epoch: 7, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.118 Vali Acc: 0.717 Test Loss: 1.118 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.601643323898315
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.357 Vali Acc: 0.722 Test Loss: 1.357 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.193222284317017
Epoch: 9, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.033 Vali Acc: 0.717 Test Loss: 1.033 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.66092586517334
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.062 Vali Acc: 0.702 Test Loss: 1.062 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.221459627151489
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.433 Vali Acc: 0.717 Test Loss: 1.433 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.511994123458862
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.445600986480713
Epoch: 2, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.484417915344238
Epoch: 3, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.936 Vali Acc: 0.712 Test Loss: 0.936 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.4458982944488525
Epoch: 4, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.686 Vali Acc: 0.693 Test Loss: 0.686 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.6951987743377686
Epoch: 5, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.757 Vali Acc: 0.678 Test Loss: 0.757 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.804879188537598
Epoch: 6, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.195 Vali Acc: 0.702 Test Loss: 1.195 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.303478717803955
Epoch: 7, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.472 Vali Acc: 0.707 Test Loss: 1.472 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.544909954071045
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.132 Vali Acc: 0.712 Test Loss: 1.132 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.687305927276611
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.057 Vali Acc: 0.673 Test Loss: 1.057 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.647552728652954
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.046 Vali Acc: 0.678 Test Loss: 1.046 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.522765636444092
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.505 Vali Acc: 0.693 Test Loss: 1.505 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.162367105484009
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.611 Vali Acc: 0.712 Test Loss: 0.611 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.749934196472168
Epoch: 2, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.698 Vali Acc: 0.532 Test Loss: 0.698 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.094280004501343
Epoch: 3, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.703 Vali Acc: 0.620 Test Loss: 0.703 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.7818732261657715
Epoch: 4, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.473 Vali Acc: 0.322 Test Loss: 1.473 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.583759307861328
Epoch: 5, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.002 Vali Acc: 0.502 Test Loss: 1.002 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.430971622467041
Epoch: 6, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.959 Vali Acc: 0.620 Test Loss: 0.959 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.540909290313721
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.130 Vali Acc: 0.576 Test Loss: 1.130 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.59075140953064
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.218 Vali Acc: 0.532 Test Loss: 1.218 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.20283055305481
Epoch: 9, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.431 Vali Acc: 0.502 Test Loss: 1.431 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.163066864013672
Epoch: 10, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.413 Vali Acc: 0.551 Test Loss: 1.413 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.25961709022522
Epoch: 11, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.361 Vali Acc: 0.644 Test Loss: 1.361 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.509844779968262
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.6550514698028564
Epoch: 2, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.652 Vali Acc: 0.649 Test Loss: 0.652 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.454572439193726
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.633 Vali Acc: 0.659 Test Loss: 0.633 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.7092673778533936
Epoch: 4, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.330 Vali Acc: 0.317 Test Loss: 1.330 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.395755767822266
Epoch: 5, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.099 Vali Acc: 0.468 Test Loss: 1.099 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.647379636764526
Epoch: 6, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.794 Vali Acc: 0.693 Test Loss: 0.794 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.542476177215576
Epoch: 7, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.918 Vali Acc: 0.737 Test Loss: 0.918 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736576).  Saving model ...
Epoch: 8 cost time: 5.432127475738525
Epoch: 8, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.414 Vali Acc: 0.566 Test Loss: 1.414 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.078770160675049
Epoch: 9, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.231 Vali Acc: 0.624 Test Loss: 1.231 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.636563062667847
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 2.064 Vali Acc: 0.566 Test Loss: 2.064 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.368705749511719
Epoch: 11, Steps: 13 | Train Loss: 0.046 Vali Loss: 2.128 Vali Acc: 0.576 Test Loss: 2.128 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.416458368301392
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 2.027 Vali Acc: 0.732 Test Loss: 2.027 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.470412254333496
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 2.308 Vali Acc: 0.673 Test Loss: 2.308 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.111355304718018
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 3.112 Vali Acc: 0.537 Test Loss: 3.112 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.461643934249878
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 3.528 Vali Acc: 0.532 Test Loss: 3.528 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.4662926197052
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.812 Vali Acc: 0.649 Test Loss: 2.812 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.7069549560546875
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 3.457 Vali Acc: 0.600 Test Loss: 3.457 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 4461058
model size : 26.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.845414161682129
Epoch: 1, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.313753604888916
Epoch: 2, Steps: 13 | Train Loss: 0.833 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.258312940597534
Epoch: 3, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.008 Vali Acc: 0.722 Test Loss: 1.008 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.269473552703857
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.937 Vali Acc: 0.737 Test Loss: 0.937 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736576).  Saving model ...
Epoch: 5 cost time: 5.542579412460327
Epoch: 5, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.035 Vali Acc: 0.463 Test Loss: 1.035 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.617904186248779
Epoch: 6, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.816 Vali Acc: 0.737 Test Loss: 0.816 Test Acc: 0.737
Validation loss decreased (-0.736576 --> -0.736577).  Saving model ...
Epoch: 7 cost time: 5.456273794174194
Epoch: 7, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.141 Vali Acc: 0.512 Test Loss: 1.141 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.505080938339233
Epoch: 8, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.462 Vali Acc: 0.732 Test Loss: 1.462 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.600924730300903
Epoch: 9, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.949 Vali Acc: 0.673 Test Loss: 0.949 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.715616226196289
Epoch: 10, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.055 Vali Acc: 0.707 Test Loss: 1.055 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.361435651779175
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.082 Vali Acc: 0.668 Test Loss: 1.082 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.548192501068115
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.660 Vali Acc: 0.722 Test Loss: 1.660 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.26680850982666
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.857 Vali Acc: 0.717 Test Loss: 1.857 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.560480356216431
Epoch: 14, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.491 Vali Acc: 0.659 Test Loss: 1.491 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.609095096588135
Epoch: 15, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.667 Vali Acc: 0.722 Test Loss: 1.667 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.660655975341797
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.635 Vali Acc: 0.702 Test Loss: 1.635 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.802967071533203
Epoch: 1, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 5.249691486358643
Epoch: 2, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.609 Vali Acc: 0.707 Test Loss: 0.609 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.573122978210449
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.009 Vali Acc: 0.732 Test Loss: 1.009 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.428441762924194
Epoch: 4, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.028 Vali Acc: 0.737 Test Loss: 1.028 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.361016035079956
Epoch: 5, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.016 Vali Acc: 0.463 Test Loss: 1.016 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.863266468048096
Epoch: 6, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.158 Vali Acc: 0.717 Test Loss: 1.158 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.465505123138428
Epoch: 7, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.870 Vali Acc: 0.654 Test Loss: 0.870 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.958051681518555
Epoch: 8, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.611 Vali Acc: 0.737 Test Loss: 1.611 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.4294562339782715
Epoch: 9, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.243 Vali Acc: 0.595 Test Loss: 1.243 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.8519957065582275
Epoch: 10, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.271 Vali Acc: 0.698 Test Loss: 1.271 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.723741292953491
Epoch: 11, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.234 Vali Acc: 0.673 Test Loss: 1.234 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.751227617263794
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 5.776033878326416
Epoch: 2, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.609 Vali Acc: 0.702 Test Loss: 0.609 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.358707666397095
Epoch: 3, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.3356170654296875
Epoch: 4, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.924 Vali Acc: 0.727 Test Loss: 0.924 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.327406644821167
Epoch: 5, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.738 Vali Acc: 0.712 Test Loss: 0.738 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.726168394088745
Epoch: 6, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.834 Vali Acc: 0.707 Test Loss: 0.834 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.286080598831177
Epoch: 7, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.910 Vali Acc: 0.663 Test Loss: 0.910 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.736910820007324
Epoch: 8, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.504 Vali Acc: 0.741 Test Loss: 1.504 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.856597661972046
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.099 Vali Acc: 0.707 Test Loss: 1.099 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.776269912719727
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.129 Vali Acc: 0.707 Test Loss: 1.129 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.386085271835327
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.167 Vali Acc: 0.702 Test Loss: 1.167 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.804964303970337
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.540956258773804
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.604 Vali Acc: 0.678 Test Loss: 0.604 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.372112274169922
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.781 Vali Acc: 0.717 Test Loss: 0.781 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.678164482116699
Epoch: 4, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.827 Vali Acc: 0.712 Test Loss: 0.827 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.673052072525024
Epoch: 5, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.907 Vali Acc: 0.722 Test Loss: 0.907 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721942).  Saving model ...
Epoch: 6 cost time: 5.471932649612427
Epoch: 6, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.184 Vali Acc: 0.512 Test Loss: 1.184 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.457423686981201
Epoch: 7, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.062 Vali Acc: 0.678 Test Loss: 1.062 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.4465110301971436
Epoch: 8, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.619 Vali Acc: 0.717 Test Loss: 1.619 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.32257866859436
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.123 Vali Acc: 0.712 Test Loss: 1.123 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.334421634674072
Epoch: 10, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.458 Vali Acc: 0.751 Test Loss: 1.458 Test Acc: 0.751
Validation loss decreased (-0.721942 --> -0.751205).  Saving model ...
Epoch: 11 cost time: 6.145940780639648
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.410 Vali Acc: 0.727 Test Loss: 1.410 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.179329872131348
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.727 Test Loss: 1.542 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.991113662719727
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.717 Test Loss: 1.487 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.269417762756348
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.698 Test Loss: 1.384 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.946523904800415
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.693 Test Loss: 1.425 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.567861795425415
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.712 Test Loss: 1.543 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.736908912658691
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.702 Test Loss: 1.494 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.858067989349365
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.702 Test Loss: 1.524 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.987083435058594
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.702 Test Loss: 1.552 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.078657150268555
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.702 Test Loss: 1.550 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.31535530090332
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
Validation loss decreased (inf --> -0.746336).  Saving model ...
Epoch: 2 cost time: 5.266619920730591
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.619 Vali Acc: 0.751 Test Loss: 0.619 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 4.9785919189453125
Epoch: 3, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.682 Vali Acc: 0.741 Test Loss: 0.682 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.156046152114868
Epoch: 4, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.786 Vali Acc: 0.751 Test Loss: 0.786 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.7880518436431885
Epoch: 5, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.219811677932739
Epoch: 6, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.810 Vali Acc: 0.727 Test Loss: 0.810 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.309267044067383
Epoch: 7, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.100 Vali Acc: 0.605 Test Loss: 1.100 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.4875030517578125
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.189 Vali Acc: 0.746 Test Loss: 1.189 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.556278228759766
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.107 Vali Acc: 0.746 Test Loss: 1.107 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.674737930297852
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.144 Vali Acc: 0.727 Test Loss: 1.144 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.316315412521362
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.213 Vali Acc: 0.683 Test Loss: 1.213 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.583305835723877
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.355 Vali Acc: 0.678 Test Loss: 1.355 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.865801095962524
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.557 Vali Acc: 0.727 Test Loss: 0.557 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 5.727107524871826
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 5.172313690185547
Epoch: 3, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.383416175842285
Epoch: 4, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.877 Vali Acc: 0.732 Test Loss: 0.877 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.8012471199035645
Epoch: 5, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.827 Vali Acc: 0.629 Test Loss: 0.827 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.322894811630249
Epoch: 6, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.078 Vali Acc: 0.741 Test Loss: 1.078 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741453).  Saving model ...
Epoch: 7 cost time: 5.530658006668091
Epoch: 7, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.075 Vali Acc: 0.741 Test Loss: 1.075 Test Acc: 0.741
Validation loss decreased (-0.741453 --> -0.741453).  Saving model ...
Epoch: 8 cost time: 5.162122011184692
Epoch: 8, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.656 Vali Acc: 0.727 Test Loss: 1.656 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.548131227493286
Epoch: 9, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.221 Vali Acc: 0.707 Test Loss: 1.221 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.894789218902588
Epoch: 10, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.308 Vali Acc: 0.737 Test Loss: 1.308 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.85999870300293
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.281 Vali Acc: 0.678 Test Loss: 1.281 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.655379295349121
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.367 Vali Acc: 0.654 Test Loss: 1.367 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.885029315948486
Epoch: 13, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.440 Vali Acc: 0.746 Test Loss: 1.440 Test Acc: 0.746
Validation loss decreased (-0.741453 --> -0.746327).  Saving model ...
Epoch: 14 cost time: 5.386963129043579
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.477 Vali Acc: 0.683 Test Loss: 1.477 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.697803974151611
Epoch: 15, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.584 Vali Acc: 0.688 Test Loss: 1.584 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.399324417114258
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.958 Vali Acc: 0.727 Test Loss: 1.958 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.557351350784302
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.722 Test Loss: 1.640 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.257561445236206
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.746 Test Loss: 1.772 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.393017768859863
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.746 Test Loss: 1.784 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.661712169647217
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.746 Test Loss: 1.781 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.428344488143921
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.741 Test Loss: 1.697 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.061079740524292
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.741 Test Loss: 1.778 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.654557228088379
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.746 Test Loss: 1.791 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.332361459732056
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 5.044713973999023
Epoch: 2, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5987536907196045
Epoch: 3, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.747 Vali Acc: 0.698 Test Loss: 0.747 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.531210899353027
Epoch: 4, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.038 Vali Acc: 0.712 Test Loss: 1.038 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.054976463317871
Epoch: 5, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.743 Vali Acc: 0.698 Test Loss: 0.743 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.993187427520752
Epoch: 6, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.054 Vali Acc: 0.722 Test Loss: 1.054 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.336158752441406
Epoch: 7, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.911 Vali Acc: 0.698 Test Loss: 0.911 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.047531843185425
Epoch: 8, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.768 Vali Acc: 0.717 Test Loss: 1.768 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.182190895080566
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.207 Vali Acc: 0.717 Test Loss: 1.207 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.683311700820923
Epoch: 10, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.050 Vali Acc: 0.707 Test Loss: 1.050 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.9071056842803955
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.041 Vali Acc: 0.702 Test Loss: 1.041 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.401586055755615
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.537778854370117
Epoch: 2, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.642 Vali Acc: 0.712 Test Loss: 0.642 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.938397407531738
Epoch: 3, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.714 Vali Acc: 0.702 Test Loss: 0.714 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.720372438430786
Epoch: 4, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.175 Vali Acc: 0.727 Test Loss: 1.175 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726818).  Saving model ...
Epoch: 5 cost time: 6.301611423492432
Epoch: 5, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.168 Vali Acc: 0.717 Test Loss: 1.168 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.773170709609985
Epoch: 6, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.938 Vali Acc: 0.702 Test Loss: 0.938 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.497783422470093
Epoch: 7, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.913 Vali Acc: 0.693 Test Loss: 0.913 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.644266843795776
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.234 Vali Acc: 0.712 Test Loss: 1.234 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.561452865600586
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.097 Vali Acc: 0.707 Test Loss: 1.097 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.787611722946167
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 0.950 Vali Acc: 0.678 Test Loss: 0.950 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.491140365600586
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.012 Vali Acc: 0.698 Test Loss: 1.012 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.7777392864227295
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.517 Vali Acc: 0.702 Test Loss: 1.517 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.8560240268707275
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.613 Vali Acc: 0.702 Test Loss: 1.613 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.707463502883911
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.216 Vali Acc: 0.702 Test Loss: 1.216 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.542403221130371
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.770 Vali Acc: 0.429 Test Loss: 0.770 Test Acc: 0.429
Validation loss decreased (inf --> -0.429261).  Saving model ...
Epoch: 2 cost time: 5.057250499725342
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.779 Vali Acc: 0.488 Test Loss: 0.779 Test Acc: 0.488
Validation loss decreased (-0.429261 --> -0.487797).  Saving model ...
Epoch: 3 cost time: 5.195587396621704
Epoch: 3, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.031 Vali Acc: 0.366 Test Loss: 1.031 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.917551517486572
Epoch: 4, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.805 Vali Acc: 0.712 Test Loss: 0.805 Test Acc: 0.712
Validation loss decreased (-0.487797 --> -0.712187).  Saving model ...
Epoch: 5 cost time: 5.512047529220581
Epoch: 5, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.806 Vali Acc: 0.639 Test Loss: 0.806 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.058136224746704
Epoch: 6, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.961 Vali Acc: 0.551 Test Loss: 0.961 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.959813117980957
Epoch: 7, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.084 Vali Acc: 0.571 Test Loss: 1.084 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.407679080963135
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.121 Vali Acc: 0.571 Test Loss: 1.121 Test Acc: 0.571
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.564120054244995
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.142 Vali Acc: 0.605 Test Loss: 1.142 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.468532562255859
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.164 Vali Acc: 0.610 Test Loss: 1.164 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.5831990242004395
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.413 Vali Acc: 0.546 Test Loss: 1.413 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.326332330703735
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.260 Vali Acc: 0.688 Test Loss: 1.260 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.223616600036621
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.233 Vali Acc: 0.644 Test Loss: 1.233 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.921079158782959
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.466 Vali Acc: 0.580 Test Loss: 1.466 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.988590717315674
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.665 Vali Acc: 0.546 Test Loss: 0.665 Test Acc: 0.546
Validation loss decreased (inf --> -0.546335).  Saving model ...
Epoch: 2 cost time: 5.482073783874512
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.722 Vali Acc: 0.527 Test Loss: 0.722 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.486293792724609
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.876 Vali Acc: 0.420 Test Loss: 0.876 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.295163869857788
Epoch: 4, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.721 Vali Acc: 0.600 Test Loss: 0.721 Test Acc: 0.600
Validation loss decreased (-0.546335 --> -0.599993).  Saving model ...
Epoch: 5 cost time: 6.076156377792358
Epoch: 5, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.757 Vali Acc: 0.624 Test Loss: 0.757 Test Acc: 0.624
Validation loss decreased (-0.599993 --> -0.624383).  Saving model ...
Epoch: 6 cost time: 5.367234706878662
Epoch: 6, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.051 Vali Acc: 0.571 Test Loss: 1.051 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.211886405944824
Epoch: 7, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.936 Vali Acc: 0.380 Test Loss: 1.936 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.529812335968018
Epoch: 8, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.009 Vali Acc: 0.707 Test Loss: 1.009 Test Acc: 0.707
Validation loss decreased (-0.624383 --> -0.707307).  Saving model ...
Epoch: 9 cost time: 5.215771913528442
Epoch: 9, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.465 Vali Acc: 0.580 Test Loss: 1.465 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.12429404258728
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.531 Vali Acc: 0.620 Test Loss: 1.531 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.095808982849121
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.868 Vali Acc: 0.610 Test Loss: 1.868 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.748103141784668
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.980 Vali Acc: 0.595 Test Loss: 1.980 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.19608211517334
Epoch: 13, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.492 Vali Acc: 0.615 Test Loss: 2.492 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.228720664978027
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.524 Vali Acc: 0.683 Test Loss: 2.524 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.306291103363037
Epoch: 15, Steps: 13 | Train Loss: 0.034 Vali Loss: 2.647 Vali Acc: 0.717 Test Loss: 2.647 Test Acc: 0.717
Validation loss decreased (-0.707307 --> -0.717047).  Saving model ...
Epoch: 16 cost time: 5.337221145629883
Epoch: 16, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.761 Vali Acc: 0.732 Test Loss: 2.761 Test Acc: 0.732
Validation loss decreased (-0.717047 --> -0.731680).  Saving model ...
Epoch: 17 cost time: 5.2713658809661865
Epoch: 17, Steps: 13 | Train Loss: 0.043 Vali Loss: 3.044 Vali Acc: 0.629 Test Loss: 3.044 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.192115783691406
Epoch: 18, Steps: 13 | Train Loss: 0.039 Vali Loss: 3.056 Vali Acc: 0.634 Test Loss: 3.056 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.990293502807617
Epoch: 19, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.996 Vali Acc: 0.644 Test Loss: 2.996 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.301571846008301
Epoch: 20, Steps: 13 | Train Loss: 0.005 Vali Loss: 3.175 Vali Acc: 0.688 Test Loss: 3.175 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.95774245262146
Epoch: 21, Steps: 13 | Train Loss: 0.024 Vali Loss: 3.234 Vali Acc: 0.639 Test Loss: 3.234 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.790461301803589
Epoch: 22, Steps: 13 | Train Loss: 0.008 Vali Loss: 4.231 Vali Acc: 0.541 Test Loss: 4.231 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.046074628829956
Epoch: 23, Steps: 13 | Train Loss: 0.011 Vali Loss: 4.205 Vali Acc: 0.585 Test Loss: 4.205 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.314820051193237
Epoch: 24, Steps: 13 | Train Loss: 0.077 Vali Loss: 5.438 Vali Acc: 0.580 Test Loss: 5.438 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.975390911102295
Epoch: 25, Steps: 13 | Train Loss: 0.220 Vali Loss: 4.261 Vali Acc: 0.624 Test Loss: 4.261 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.184463024139404
Epoch: 26, Steps: 13 | Train Loss: 0.087 Vali Loss: 4.471 Vali Acc: 0.659 Test Loss: 4.471 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 3674626
model size : 23.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.34846544265747
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 1.045 Vali Acc: 0.278 Test Loss: 1.045 Test Acc: 0.278
Validation loss decreased (inf --> -0.278038).  Saving model ...
Epoch: 2 cost time: 6.328829050064087
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
Validation loss decreased (-0.278038 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 6.114023447036743
Epoch: 3, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.139 Vali Acc: 0.302 Test Loss: 1.139 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.906640529632568
Epoch: 4, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.669 Vali Acc: 0.698 Test Loss: 0.669 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.900384187698364
Epoch: 5, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.146 Vali Acc: 0.727 Test Loss: 1.146 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.86341404914856
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.743 Vali Acc: 0.707 Test Loss: 0.743 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.9287028312683105
Epoch: 7, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.333 Vali Acc: 0.732 Test Loss: 1.333 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731694).  Saving model ...
Epoch: 8 cost time: 5.290226221084595
Epoch: 8, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.250 Vali Acc: 0.493 Test Loss: 1.250 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.5236852169036865
Epoch: 9, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.969 Vali Acc: 0.668 Test Loss: 0.969 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.812487840652466
Epoch: 10, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.962 Vali Acc: 0.732 Test Loss: 1.962 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.048937082290649
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.114 Vali Acc: 0.702 Test Loss: 1.114 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.27860426902771
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.300 Vali Acc: 0.707 Test Loss: 1.300 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.233792781829834
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.470 Vali Acc: 0.722 Test Loss: 1.470 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.167571067810059
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.702 Test Loss: 1.404 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.787030220031738
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.488 Vali Acc: 0.707 Test Loss: 1.488 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.625168800354004
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.329 Vali Acc: 0.663 Test Loss: 1.329 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.9719977378845215
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.436 Vali Acc: 0.673 Test Loss: 1.436 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.446365833282471
Epoch: 1, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.891 Vali Acc: 0.263 Test Loss: 0.891 Test Acc: 0.263
Validation loss decreased (inf --> -0.263406).  Saving model ...
Epoch: 2 cost time: 5.453152418136597
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
Validation loss decreased (-0.263406 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 5.481783628463745
Epoch: 3, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.109707355499268
Epoch: 4, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.803 Vali Acc: 0.737 Test Loss: 0.803 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.562838077545166
Epoch: 5, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.797 Vali Acc: 0.717 Test Loss: 1.797 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.397128105163574
Epoch: 6, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.953 Vali Acc: 0.717 Test Loss: 1.953 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.470211744308472
Epoch: 7, Steps: 13 | Train Loss: 0.330 Vali Loss: 2.033 Vali Acc: 0.722 Test Loss: 2.033 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.551062345504761
Epoch: 8, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.981 Vali Acc: 0.673 Test Loss: 0.981 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.250229120254517
Epoch: 9, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.267 Vali Acc: 0.741 Test Loss: 1.267 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.6687421798706055
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.142 Vali Acc: 0.722 Test Loss: 1.142 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.38263201713562
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.163 Vali Acc: 0.702 Test Loss: 1.163 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.397730588912964
Epoch: 12, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.160 Vali Acc: 0.722 Test Loss: 2.160 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.876907825469971
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.790 Vali Acc: 0.380 Test Loss: 0.790 Test Acc: 0.380
Validation loss decreased (inf --> -0.380480).  Saving model ...
Epoch: 2 cost time: 5.596665859222412
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.639 Vali Acc: 0.732 Test Loss: 0.639 Test Acc: 0.732
Validation loss decreased (-0.380480 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 5.3013529777526855
Epoch: 3, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.651 Vali Acc: 0.663 Test Loss: 0.651 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.265886306762695
Epoch: 4, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.855 Vali Acc: 0.727 Test Loss: 0.855 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.709597826004028
Epoch: 5, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.765 Vali Acc: 0.663 Test Loss: 0.765 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.41192889213562
Epoch: 6, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.111 Vali Acc: 0.741 Test Loss: 1.111 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741452).  Saving model ...
Epoch: 7 cost time: 5.225722074508667
Epoch: 7, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.055 Vali Acc: 0.737 Test Loss: 1.055 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.540472745895386
Epoch: 8, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.151 Vali Acc: 0.737 Test Loss: 1.151 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.402503967285156
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.042 Vali Acc: 0.702 Test Loss: 1.042 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.227831125259399
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.225 Vali Acc: 0.722 Test Loss: 1.225 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.148409366607666
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.178 Vali Acc: 0.707 Test Loss: 1.178 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.324574947357178
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.282 Vali Acc: 0.693 Test Loss: 1.282 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.086810111999512
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.324 Vali Acc: 0.678 Test Loss: 1.324 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.108836889266968
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.683 Test Loss: 1.366 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.39864182472229
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.531 Vali Acc: 0.722 Test Loss: 1.531 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.477203130722046
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.707 Test Loss: 1.450 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.457913398742676
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.763 Vali Acc: 0.405 Test Loss: 0.763 Test Acc: 0.405
Validation loss decreased (inf --> -0.404870).  Saving model ...
Epoch: 2 cost time: 5.363522529602051
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.631 Vali Acc: 0.712 Test Loss: 0.631 Test Acc: 0.712
Validation loss decreased (-0.404870 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 5.22355318069458
Epoch: 3, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.828 Vali Acc: 0.498 Test Loss: 0.828 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.938965320587158
Epoch: 4, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.840 Vali Acc: 0.732 Test Loss: 0.840 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731699).  Saving model ...
Epoch: 5 cost time: 5.125455617904663
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.803 Vali Acc: 0.727 Test Loss: 1.803 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.217584848403931
Epoch: 6, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.711 Vali Acc: 0.722 Test Loss: 1.711 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.448216438293457
Epoch: 7, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.575 Vali Acc: 0.727 Test Loss: 1.575 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.86850905418396
Epoch: 8, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.541 Vali Acc: 0.727 Test Loss: 1.541 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.81343150138855
Epoch: 9, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.1216371059417725
Epoch: 10, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.294 Vali Acc: 0.707 Test Loss: 1.294 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.24623703956604
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.686 Vali Acc: 0.693 Test Loss: 1.686 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.979485034942627
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.607 Vali Acc: 0.707 Test Loss: 1.607 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.174318790435791
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.712 Test Loss: 1.683 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.179563045501709
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.701 Vali Acc: 0.702 Test Loss: 1.701 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.031962633132935
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.729 Vali Acc: 0.576 Test Loss: 0.729 Test Acc: 0.576
Validation loss decreased (inf --> -0.575602).  Saving model ...
Epoch: 2 cost time: 5.351166725158691
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
Validation loss decreased (-0.575602 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 5.444357872009277
Epoch: 3, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.745 Vali Acc: 0.571 Test Loss: 0.745 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.259564399719238
Epoch: 4, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.835 Vali Acc: 0.722 Test Loss: 0.835 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.282907485961914
Epoch: 5, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.365 Vali Acc: 0.741 Test Loss: 1.365 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.362852096557617
Epoch: 6, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.886 Vali Acc: 0.741 Test Loss: 0.886 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.630834579467773
Epoch: 7, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.022 Vali Acc: 0.732 Test Loss: 1.022 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.591332912445068
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.552 Vali Acc: 0.522 Test Loss: 1.552 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.41683292388916
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.064 Vali Acc: 0.712 Test Loss: 1.064 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.206018447875977
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.561 Vali Acc: 0.756 Test Loss: 1.561 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756082).  Saving model ...
Epoch: 11 cost time: 5.183577060699463
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.541 Vali Acc: 0.741 Test Loss: 1.541 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.461921691894531
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.550 Vali Acc: 0.727 Test Loss: 1.550 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.0282111167907715
Epoch: 13, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.740 Vali Acc: 0.727 Test Loss: 1.740 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.517290830612183
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.909 Vali Acc: 0.727 Test Loss: 1.909 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.425145864486694
Epoch: 15, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.452 Vali Acc: 0.741 Test Loss: 2.452 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.826383590698242
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.227 Vali Acc: 0.727 Test Loss: 2.227 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.76929235458374
Epoch: 17, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.586 Vali Acc: 0.751 Test Loss: 2.586 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.989223957061768
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.739 Vali Acc: 0.732 Test Loss: 2.739 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.265612840652466
Epoch: 19, Steps: 13 | Train Loss: 0.029 Vali Loss: 2.833 Vali Acc: 0.756 Test Loss: 2.833 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.900158882141113
Epoch: 20, Steps: 13 | Train Loss: 0.040 Vali Loss: 2.702 Vali Acc: 0.751 Test Loss: 2.702 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.386389493942261
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.795 Vali Acc: 0.498 Test Loss: 0.795 Test Acc: 0.498
Validation loss decreased (inf --> -0.497553).  Saving model ...
Epoch: 2 cost time: 5.611984729766846
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.626 Vali Acc: 0.698 Test Loss: 0.626 Test Acc: 0.698
Validation loss decreased (-0.497553 --> -0.697555).  Saving model ...
Epoch: 3 cost time: 5.7647058963775635
Epoch: 3, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.677 Vali Acc: 0.654 Test Loss: 0.677 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.746958494186401
Epoch: 4, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.181 Vali Acc: 0.737 Test Loss: 1.181 Test Acc: 0.737
Validation loss decreased (-0.697555 --> -0.736574).  Saving model ...
Epoch: 5 cost time: 5.614372968673706
Epoch: 5, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.053 Vali Acc: 0.737 Test Loss: 1.053 Test Acc: 0.737
Validation loss decreased (-0.736574 --> -0.736575).  Saving model ...
Epoch: 6 cost time: 6.1882710456848145
Epoch: 6, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.931 Vali Acc: 0.629 Test Loss: 0.931 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.2235682010650635
Epoch: 7, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.069 Vali Acc: 0.732 Test Loss: 1.069 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.820897340774536
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.990 Vali Acc: 0.688 Test Loss: 0.990 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.801574230194092
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.192 Vali Acc: 0.727 Test Loss: 1.192 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.711081504821777
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.390 Vali Acc: 0.727 Test Loss: 1.390 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.505374431610107
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.335 Vali Acc: 0.727 Test Loss: 1.335 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.551273345947266
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.643 Vali Acc: 0.717 Test Loss: 1.643 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.717798233032227
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.715 Vali Acc: 0.722 Test Loss: 1.715 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.274462699890137
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.438 Vali Acc: 0.727 Test Loss: 1.438 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.870813369750977
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.330 Vali Acc: 0.698 Test Loss: 1.330 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.277646064758301
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.637 Vali Acc: 0.698 Test Loss: 0.637 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 6.072485685348511
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.628 Vali Acc: 0.707 Test Loss: 0.628 Test Acc: 0.707
Validation loss decreased (-0.697555 --> -0.707311).  Saving model ...
Epoch: 3 cost time: 5.519897699356079
Epoch: 3, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.696 Vali Acc: 0.702 Test Loss: 0.696 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.124046564102173
Epoch: 4, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.932 Vali Acc: 0.717 Test Loss: 0.932 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717064).  Saving model ...
Epoch: 5 cost time: 6.042379856109619
Epoch: 5, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.623 Vali Acc: 0.712 Test Loss: 1.623 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.40532112121582
Epoch: 6, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.678 Vali Acc: 0.722 Test Loss: 1.678 Test Acc: 0.722
Validation loss decreased (-0.717064 --> -0.721934).  Saving model ...
Epoch: 7 cost time: 5.676919937133789
Epoch: 7, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.275 Vali Acc: 0.712 Test Loss: 1.275 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.655717611312866
Epoch: 8, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.914 Vali Acc: 0.698 Test Loss: 0.914 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.560134410858154
Epoch: 9, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.905 Vali Acc: 0.683 Test Loss: 0.905 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.4365150928497314
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.984 Vali Acc: 0.702 Test Loss: 0.984 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.764044284820557
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.094 Vali Acc: 0.702 Test Loss: 1.094 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.619051456451416
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.334 Vali Acc: 0.732 Test Loss: 1.334 Test Acc: 0.732
Validation loss decreased (-0.721934 --> -0.731694).  Saving model ...
Epoch: 13 cost time: 5.70007848739624
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.342 Vali Acc: 0.727 Test Loss: 1.342 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.685314893722534
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.113 Vali Acc: 0.717 Test Loss: 1.113 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.713648319244385
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.727 Test Loss: 1.308 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.970503568649292
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.732 Test Loss: 1.345 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.8293163776397705
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.284 Vali Acc: 0.737 Test Loss: 1.284 Test Acc: 0.737
Validation loss decreased (-0.731694 --> -0.736573).  Saving model ...
Epoch: 18 cost time: 5.481953382492065
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.737 Test Loss: 1.329 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.35120153427124
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.288 Vali Acc: 0.737 Test Loss: 1.288 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.909974813461304
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.732 Test Loss: 1.366 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.556991100311279
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.362 Vali Acc: 0.737 Test Loss: 1.362 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.636735439300537
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.737 Test Loss: 1.382 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.280771732330322
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.737 Test Loss: 1.426 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.8728578090667725
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.732 Test Loss: 1.341 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.246856451034546
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.737 Test Loss: 1.433 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.226138353347778
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.741 Test Loss: 1.423 Test Acc: 0.741
Validation loss decreased (-0.736573 --> -0.741449).  Saving model ...
Epoch: 27 cost time: 6.599805593490601
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.741 Test Loss: 1.432 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.19991660118103
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.737 Test Loss: 1.497 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.78203010559082
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.741 Test Loss: 1.446 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.806004762649536
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.737 Test Loss: 1.488 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.211301565170288
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.737 Test Loss: 1.517 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.17726993560791
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.732 Test Loss: 1.432 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.312154531478882
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.737 Test Loss: 1.509 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.525903940200806
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.737 Test Loss: 1.504 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.570937633514404
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.722 Test Loss: 1.468 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.539342641830444
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.737 Test Loss: 1.537 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.844770431518555
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.579 Vali Acc: 0.707 Test Loss: 0.579 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 5.318853139877319
Epoch: 2, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
Validation loss decreased (-0.707311 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.693100690841675
Epoch: 3, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.629 Vali Acc: 0.698 Test Loss: 0.629 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.472297191619873
Epoch: 4, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.923 Vali Acc: 0.717 Test Loss: 0.923 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.382134437561035
Epoch: 5, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.993 Vali Acc: 0.712 Test Loss: 0.993 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.496682643890381
Epoch: 6, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.074 Vali Acc: 0.717 Test Loss: 1.074 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.8159637451171875
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.110 Vali Acc: 0.693 Test Loss: 1.110 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.985097646713257
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.949 Vali Acc: 0.702 Test Loss: 0.949 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.834311008453369
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.953 Vali Acc: 0.693 Test Loss: 0.953 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.907552719116211
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.096 Vali Acc: 0.688 Test Loss: 1.096 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.017486572265625
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.205 Vali Acc: 0.693 Test Loss: 1.205 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.547084093093872
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.174 Vali Acc: 0.693 Test Loss: 1.174 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.803755521774292
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.639 Vali Acc: 0.702 Test Loss: 0.639 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 5.155311822891235
Epoch: 2, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.683 Vali Acc: 0.644 Test Loss: 0.683 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.789058685302734
Epoch: 3, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.110 Vali Acc: 0.317 Test Loss: 1.110 Test Acc: 0.317
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.157151699066162
Epoch: 4, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.777 Vali Acc: 0.649 Test Loss: 0.777 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.129920721054077
Epoch: 5, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.921 Vali Acc: 0.707 Test Loss: 0.921 Test Acc: 0.707
Validation loss decreased (-0.702433 --> -0.707308).  Saving model ...
Epoch: 6 cost time: 5.197483539581299
Epoch: 6, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.967 Vali Acc: 0.610 Test Loss: 0.967 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.052582740783691
Epoch: 7, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.036 Vali Acc: 0.615 Test Loss: 1.036 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.766363143920898
Epoch: 8, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.418 Vali Acc: 0.478 Test Loss: 1.418 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.304342746734619
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.211 Vali Acc: 0.576 Test Loss: 1.211 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.483832120895386
Epoch: 10, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.154 Vali Acc: 0.610 Test Loss: 1.154 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.531659364700317
Epoch: 11, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.190 Vali Acc: 0.629 Test Loss: 1.190 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.250637054443359
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.275 Vali Acc: 0.629 Test Loss: 1.275 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.229020118713379
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.366 Vali Acc: 0.683 Test Loss: 1.366 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.9915618896484375
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.440 Vali Acc: 0.615 Test Loss: 1.440 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.130789279937744
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.734 Vali Acc: 0.546 Test Loss: 1.734 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.2070136070251465
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.505875110626221
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.747 Vali Acc: 0.502 Test Loss: 0.747 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.40227746963501
Epoch: 3, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.657 Vali Acc: 0.278 Test Loss: 1.657 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.372625112533569
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.634 Vali Acc: 0.698 Test Loss: 0.634 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.784709215164185
Epoch: 5, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.717 Vali Acc: 0.732 Test Loss: 0.717 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731700).  Saving model ...
Epoch: 6 cost time: 5.559708118438721
Epoch: 6, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.808 Vali Acc: 0.654 Test Loss: 0.808 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.380767345428467
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.221080780029297
Epoch: 8, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.741 Vali Acc: 0.463 Test Loss: 1.741 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.370355129241943
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.082 Vali Acc: 0.693 Test Loss: 1.082 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.344771385192871
Epoch: 10, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.220 Vali Acc: 0.722 Test Loss: 1.220 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.472582817077637
Epoch: 11, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.871 Vali Acc: 0.634 Test Loss: 1.871 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.312004327774048
Epoch: 12, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.815 Vali Acc: 0.659 Test Loss: 1.815 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.527627468109131
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.594 Vali Acc: 0.459 Test Loss: 3.594 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.576038837432861
Epoch: 14, Steps: 13 | Train Loss: 0.067 Vali Loss: 2.725 Vali Acc: 0.644 Test Loss: 2.725 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.361783504486084
Epoch: 15, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.482 Vali Acc: 0.659 Test Loss: 2.482 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 3281410
model size : 22.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.411057949066162
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.663 Vali Acc: 0.722 Test Loss: 0.663 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.441195487976074
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.583 Vali Acc: 0.693 Test Loss: 0.583 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.524159669876099
Epoch: 3, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.777 Vali Acc: 0.727 Test Loss: 0.777 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726821).  Saving model ...
Epoch: 4 cost time: 5.021367788314819
Epoch: 4, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.656 Vali Acc: 0.673 Test Loss: 0.656 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.49151611328125
Epoch: 5, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.054 Vali Acc: 0.737 Test Loss: 1.054 Test Acc: 0.737
Validation loss decreased (-0.726821 --> -0.736575).  Saving model ...
Epoch: 6 cost time: 5.453559637069702
Epoch: 6, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.794 Vali Acc: 0.668 Test Loss: 0.794 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.376864194869995
Epoch: 7, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.395 Vali Acc: 0.737 Test Loss: 1.395 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.517912864685059
Epoch: 8, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.818 Vali Acc: 0.688 Test Loss: 0.818 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.257229328155518
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.821 Vali Acc: 0.732 Test Loss: 1.821 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.349636077880859
Epoch: 10, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.474 Vali Acc: 0.732 Test Loss: 1.474 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.692559242248535
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.148 Vali Acc: 0.668 Test Loss: 1.148 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.61796760559082
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.213 Vali Acc: 0.688 Test Loss: 1.213 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.4569313526153564
Epoch: 13, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.315 Vali Acc: 0.732 Test Loss: 2.315 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.620021343231201
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.823 Vali Acc: 0.741 Test Loss: 1.823 Test Acc: 0.741
Validation loss decreased (-0.736575 --> -0.741445).  Saving model ...
Epoch: 15 cost time: 5.472652196884155
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.511 Vali Acc: 0.668 Test Loss: 1.511 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.401126384735107
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.965 Vali Acc: 0.712 Test Loss: 1.965 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.0757365226745605
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.688 Test Loss: 1.601 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.399396181106567
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.707 Test Loss: 1.732 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.74002742767334
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.702 Test Loss: 1.629 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.766247987747192
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.712 Test Loss: 1.725 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.935721158981323
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.703 Vali Acc: 0.702 Test Loss: 1.703 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.69213342666626
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.712 Test Loss: 1.746 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.998537540435791
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.712 Test Loss: 1.758 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.38322377204895
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.707 Test Loss: 1.722 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.954454660415649
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.2217090129852295
Epoch: 2, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.987645149230957
Epoch: 3, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731700).  Saving model ...
Epoch: 4 cost time: 5.136244773864746
Epoch: 4, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.697 Vali Acc: 0.756 Test Loss: 0.697 Test Acc: 0.756
Validation loss decreased (-0.731700 --> -0.756091).  Saving model ...
Epoch: 5 cost time: 5.007861137390137
Epoch: 5, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.734 Vali Acc: 0.732 Test Loss: 0.734 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.336516857147217
Epoch: 6, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.504942893981934
Epoch: 7, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.964 Vali Acc: 0.732 Test Loss: 0.964 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.531396865844727
Epoch: 8, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.999 Vali Acc: 0.639 Test Loss: 0.999 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.142372369766235
Epoch: 9, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.376 Vali Acc: 0.741 Test Loss: 1.376 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.246190309524536
Epoch: 10, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.107 Vali Acc: 0.678 Test Loss: 1.107 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.4323365688323975
Epoch: 11, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.269 Vali Acc: 0.737 Test Loss: 1.269 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.342655658721924
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.192 Vali Acc: 0.707 Test Loss: 1.192 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.101606369018555
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.858 Vali Acc: 0.737 Test Loss: 1.858 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.9887449741363525
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.528 Vali Acc: 0.746 Test Loss: 1.528 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.401260614395142
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.644 Vali Acc: 0.727 Test Loss: 0.644 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 5.811397552490234
Epoch: 2, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.579 Vali Acc: 0.746 Test Loss: 0.579 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 5.98543119430542
Epoch: 3, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.782 Vali Acc: 0.741 Test Loss: 0.782 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.5678558349609375
Epoch: 4, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.702 Vali Acc: 0.654 Test Loss: 0.702 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.766339302062988
Epoch: 5, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.822 Vali Acc: 0.746 Test Loss: 0.822 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.697105407714844
Epoch: 6, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.036 Vali Acc: 0.741 Test Loss: 1.036 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.552399158477783
Epoch: 7, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.475 Vali Acc: 0.737 Test Loss: 1.475 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.87890625
Epoch: 8, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.946 Vali Acc: 0.673 Test Loss: 0.946 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.16408634185791
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.056 Vali Acc: 0.741 Test Loss: 2.056 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.352016925811768
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.297 Vali Acc: 0.737 Test Loss: 1.297 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.752861738204956
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.326 Vali Acc: 0.717 Test Loss: 1.326 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.122563123703003
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.101 Vali Acc: 0.712 Test Loss: 1.101 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.2948150634765625
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.700 Vali Acc: 0.712 Test Loss: 0.700 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 5.274918079376221
Epoch: 2, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.614 Vali Acc: 0.688 Test Loss: 0.614 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.267843008041382
Epoch: 3, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.830 Vali Acc: 0.722 Test Loss: 0.830 Test Acc: 0.722
Validation loss decreased (-0.712188 --> -0.721943).  Saving model ...
Epoch: 4 cost time: 5.450380563735962
Epoch: 4, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.810 Vali Acc: 0.707 Test Loss: 0.810 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.217654705047607
Epoch: 5, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.746 Vali Acc: 0.629 Test Loss: 0.746 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.3748040199279785
Epoch: 6, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.270 Vali Acc: 0.727 Test Loss: 1.270 Test Acc: 0.727
Validation loss decreased (-0.721943 --> -0.726817).  Saving model ...
Epoch: 7 cost time: 5.274540901184082
Epoch: 7, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.135 Vali Acc: 0.512 Test Loss: 1.135 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.349146604537964
Epoch: 8, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.988 Vali Acc: 0.380 Test Loss: 1.988 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.582839727401733
Epoch: 9, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.183 Vali Acc: 0.698 Test Loss: 1.183 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.169512033462524
Epoch: 10, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.139 Vali Acc: 0.663 Test Loss: 1.139 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.26566219329834
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.655 Vali Acc: 0.727 Test Loss: 1.655 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.292300701141357
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.421 Vali Acc: 0.727 Test Loss: 1.421 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.705636739730835
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.587 Vali Acc: 0.732 Test Loss: 1.587 Test Acc: 0.732
Validation loss decreased (-0.726817 --> -0.731691).  Saving model ...
Epoch: 14 cost time: 5.98196005821228
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.401 Vali Acc: 0.707 Test Loss: 1.401 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.069540023803711
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.717 Test Loss: 1.433 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.224142074584961
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.732 Test Loss: 1.589 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.25665283203125
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.688 Test Loss: 1.431 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.119712591171265
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.568 Vali Acc: 0.722 Test Loss: 1.568 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.906358957290649
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.688 Test Loss: 1.475 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.026681423187256
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.722 Test Loss: 1.588 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.575080156326294
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.712 Test Loss: 1.558 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.945696115493774
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.727 Test Loss: 1.617 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.301000356674194
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.698 Test Loss: 1.550 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.186321258544922
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.273957967758179
Epoch: 2, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.621 Vali Acc: 0.683 Test Loss: 0.621 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.382725715637207
Epoch: 3, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.691 Vali Acc: 0.756 Test Loss: 0.691 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 4.942579984664917
Epoch: 4, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.843 Vali Acc: 0.737 Test Loss: 0.843 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.814634323120117
Epoch: 5, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.855 Vali Acc: 0.654 Test Loss: 0.855 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.725757360458374
Epoch: 6, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.079 Vali Acc: 0.741 Test Loss: 1.079 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.434657096862793
Epoch: 7, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.791 Vali Acc: 0.732 Test Loss: 1.791 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.278913974761963
Epoch: 8, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.253 Vali Acc: 0.624 Test Loss: 1.253 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.322579383850098
Epoch: 9, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.296 Vali Acc: 0.746 Test Loss: 1.296 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.047898054122925
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.117 Vali Acc: 0.737 Test Loss: 1.117 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.557600498199463
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.351 Vali Acc: 0.746 Test Loss: 1.351 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.129904508590698
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.339 Vali Acc: 0.727 Test Loss: 1.339 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.015032052993774
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.416 Vali Acc: 0.741 Test Loss: 1.416 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.153914928436279
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.27124547958374
Epoch: 2, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 5.228517055511475
Epoch: 3, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.186863899230957
Epoch: 4, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.145 Vali Acc: 0.727 Test Loss: 1.145 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.359253883361816
Epoch: 5, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.798 Vali Acc: 0.737 Test Loss: 0.798 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.061422824859619
Epoch: 6, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.895 Vali Acc: 0.698 Test Loss: 0.895 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.116954326629639
Epoch: 7, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.386 Vali Acc: 0.741 Test Loss: 1.386 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741450).  Saving model ...
Epoch: 8 cost time: 5.002010345458984
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.966 Vali Acc: 0.668 Test Loss: 0.966 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.834626197814941
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.113 Vali Acc: 0.732 Test Loss: 1.113 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.905943155288696
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.145 Vali Acc: 0.727 Test Loss: 1.145 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.1400206089019775
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.332 Vali Acc: 0.717 Test Loss: 1.332 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.203254461288452
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.293 Vali Acc: 0.737 Test Loss: 1.293 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.221804141998291
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.392 Vali Acc: 0.737 Test Loss: 1.392 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.161358833312988
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.244 Vali Acc: 0.727 Test Loss: 1.244 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.899575710296631
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.257 Vali Acc: 0.707 Test Loss: 1.257 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.7317116260528564
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.391 Vali Acc: 0.712 Test Loss: 1.391 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.482913255691528
Epoch: 17, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.424 Vali Acc: 0.712 Test Loss: 1.424 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.157213449478149
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.640 Vali Acc: 0.712 Test Loss: 0.640 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.477315902709961
Epoch: 2, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.1460535526275635
Epoch: 3, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.655 Vali Acc: 0.722 Test Loss: 0.655 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.025308847427368
Epoch: 4, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.881 Vali Acc: 0.712 Test Loss: 0.881 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.265714645385742
Epoch: 5, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.990 Vali Acc: 0.707 Test Loss: 0.990 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.2574193477630615
Epoch: 6, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.852 Vali Acc: 0.693 Test Loss: 0.852 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.515108108520508
Epoch: 7, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.983 Vali Acc: 0.717 Test Loss: 0.983 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.287827968597412
Epoch: 8, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.887 Vali Acc: 0.668 Test Loss: 0.887 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.477684497833252
Epoch: 9, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.271 Vali Acc: 0.717 Test Loss: 1.271 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.472660779953003
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.285 Vali Acc: 0.717 Test Loss: 1.285 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.4062066078186035
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.596 Vali Acc: 0.712 Test Loss: 1.596 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.3249359130859375
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.053 Vali Acc: 0.698 Test Loss: 1.053 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.686373233795166
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.677 Vali Acc: 0.722 Test Loss: 0.677 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.252123117446899
Epoch: 2, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.345805406570435
Epoch: 3, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.741 Vali Acc: 0.712 Test Loss: 0.741 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.760469913482666
Epoch: 4, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.822 Vali Acc: 0.702 Test Loss: 0.822 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.583953142166138
Epoch: 5, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.830 Vali Acc: 0.707 Test Loss: 0.830 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.3204638957977295
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.141 Vali Acc: 0.712 Test Loss: 1.141 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.0360376834869385
Epoch: 7, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.145 Vali Acc: 0.698 Test Loss: 1.145 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.977121591567993
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.900 Vali Acc: 0.663 Test Loss: 0.900 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.727758884429932
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.065 Vali Acc: 0.683 Test Loss: 1.065 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.027815580368042
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.140 Vali Acc: 0.683 Test Loss: 1.140 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.230066537857056
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.184 Vali Acc: 0.693 Test Loss: 1.184 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.894981861114502
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.620 Vali Acc: 0.693 Test Loss: 0.620 Test Acc: 0.693
Validation loss decreased (inf --> -0.692677).  Saving model ...
Epoch: 2 cost time: 5.3202126026153564
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.961 Vali Acc: 0.366 Test Loss: 0.961 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.485998630523682
Epoch: 3, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.816 Vali Acc: 0.512 Test Loss: 0.816 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.910926818847656
Epoch: 4, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.795 Vali Acc: 0.576 Test Loss: 0.795 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.920789957046509
Epoch: 5, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.845 Vali Acc: 0.629 Test Loss: 0.845 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.699065685272217
Epoch: 6, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.070 Vali Acc: 0.517 Test Loss: 1.070 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.268613576889038
Epoch: 7, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.006 Vali Acc: 0.668 Test Loss: 1.006 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.467878580093384
Epoch: 8, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.187 Vali Acc: 0.585 Test Loss: 1.187 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.654091835021973
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.186 Vali Acc: 0.663 Test Loss: 1.186 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.233419179916382
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.258 Vali Acc: 0.624 Test Loss: 1.258 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.213199138641357
Epoch: 11, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.314 Vali Acc: 0.639 Test Loss: 1.314 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.865442276000977
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.596750259399414
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.851 Vali Acc: 0.385 Test Loss: 0.851 Test Acc: 0.385
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.868217706680298
Epoch: 3, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.732 Vali Acc: 0.522 Test Loss: 0.732 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.88230299949646
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.854 Vali Acc: 0.507 Test Loss: 0.854 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.861436128616333
Epoch: 5, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.710 Vali Acc: 0.644 Test Loss: 0.710 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.1169843673706055
Epoch: 6, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.469 Vali Acc: 0.424 Test Loss: 1.469 Test Acc: 0.424
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.434106349945068
Epoch: 7, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.180 Vali Acc: 0.576 Test Loss: 1.180 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.105746030807495
Epoch: 8, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.464 Vali Acc: 0.541 Test Loss: 1.464 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.257801294326782
Epoch: 9, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.397 Vali Acc: 0.737 Test Loss: 1.397 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736571).  Saving model ...
Epoch: 10 cost time: 5.3746442794799805
Epoch: 10, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.833 Vali Acc: 0.571 Test Loss: 1.833 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.1587934494018555
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.881 Vali Acc: 0.610 Test Loss: 1.881 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.286757230758667
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 2.176 Vali Acc: 0.634 Test Loss: 2.176 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.079406499862671
Epoch: 13, Steps: 13 | Train Loss: 0.126 Vali Loss: 2.591 Vali Acc: 0.732 Test Loss: 2.591 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.215601444244385
Epoch: 14, Steps: 13 | Train Loss: 0.110 Vali Loss: 2.313 Vali Acc: 0.673 Test Loss: 2.313 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.592439413070679
Epoch: 15, Steps: 13 | Train Loss: 0.049 Vali Loss: 2.895 Vali Acc: 0.610 Test Loss: 2.895 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.243636131286621
Epoch: 16, Steps: 13 | Train Loss: 0.017 Vali Loss: 3.163 Vali Acc: 0.639 Test Loss: 3.163 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.252783298492432
Epoch: 17, Steps: 13 | Train Loss: 0.041 Vali Loss: 3.787 Vali Acc: 0.576 Test Loss: 3.787 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.199922561645508
Epoch: 18, Steps: 13 | Train Loss: 0.019 Vali Loss: 3.489 Vali Acc: 0.678 Test Loss: 3.489 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.837718725204468
Epoch: 19, Steps: 13 | Train Loss: 0.064 Vali Loss: 3.096 Vali Acc: 0.717 Test Loss: 3.096 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 3084802
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.771714925765991
Epoch: 1, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.810 Vali Acc: 0.722 Test Loss: 0.810 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 5.2671520709991455
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.580 Vali Acc: 0.702 Test Loss: 0.580 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.209675073623657
Epoch: 3, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
Validation loss decreased (-0.721943 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 5.264033555984497
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.751 Vali Acc: 0.741 Test Loss: 0.751 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741456).  Saving model ...
Epoch: 5 cost time: 5.773880481719971
Epoch: 5, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.633 Vali Acc: 0.712 Test Loss: 0.633 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.520159006118774
Epoch: 6, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.645786285400391
Epoch: 7, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.780 Vali Acc: 0.634 Test Loss: 0.780 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.609509468078613
Epoch: 8, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.195 Vali Acc: 0.727 Test Loss: 1.195 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.331899404525757
Epoch: 9, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.869 Vali Acc: 0.668 Test Loss: 0.869 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.536828994750977
Epoch: 10, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.960 Vali Acc: 0.702 Test Loss: 0.960 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.246560096740723
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.975 Vali Acc: 0.683 Test Loss: 0.975 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.3153369426727295
Epoch: 12, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.294 Vali Acc: 0.727 Test Loss: 1.294 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.369213819503784
Epoch: 13, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.340 Vali Acc: 0.707 Test Loss: 1.340 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.4670538902282715
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.655 Vali Acc: 0.732 Test Loss: 1.655 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.90945029258728
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.832 Vali Acc: 0.722 Test Loss: 0.832 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 6.979953289031982
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (-0.721943 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 6.152235984802246
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 6.090117692947388
Epoch: 4, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.765 Vali Acc: 0.737 Test Loss: 0.765 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736578).  Saving model ...
Epoch: 5 cost time: 5.900340795516968
Epoch: 5, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.690 Vali Acc: 0.712 Test Loss: 0.690 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.781285524368286
Epoch: 6, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.818 Vali Acc: 0.722 Test Loss: 0.818 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.465743780136108
Epoch: 7, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.761 Vali Acc: 0.698 Test Loss: 0.761 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.99260950088501
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.297 Vali Acc: 0.727 Test Loss: 1.297 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.482342481613159
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.960 Vali Acc: 0.678 Test Loss: 0.960 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.637282609939575
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.038 Vali Acc: 0.707 Test Loss: 1.038 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.630581617355347
Epoch: 11, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.066 Vali Acc: 0.678 Test Loss: 1.066 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.891399621963501
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.128 Vali Acc: 0.678 Test Loss: 1.128 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.243535757064819
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.169 Vali Acc: 0.663 Test Loss: 1.169 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.202383279800415
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.295 Vali Acc: 0.702 Test Loss: 1.295 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.7137041091918945
Epoch: 1, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.777 Vali Acc: 0.722 Test Loss: 0.777 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 5.820478439331055
Epoch: 2, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
Validation loss decreased (-0.721943 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 6.425520658493042
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 6.325962066650391
Epoch: 4, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.777 Vali Acc: 0.746 Test Loss: 0.777 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 5 cost time: 6.523055553436279
Epoch: 5, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.716 Vali Acc: 0.732 Test Loss: 0.716 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.351558446884155
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.880 Vali Acc: 0.741 Test Loss: 0.880 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.2019362449646
Epoch: 7, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.801 Vali Acc: 0.688 Test Loss: 0.801 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.640838623046875
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.184 Vali Acc: 0.722 Test Loss: 1.184 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.082789659500122
Epoch: 9, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.986 Vali Acc: 0.634 Test Loss: 0.986 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.84552788734436
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.071 Vali Acc: 0.702 Test Loss: 1.071 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.261612892150879
Epoch: 11, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.100 Vali Acc: 0.717 Test Loss: 1.100 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.507050514221191
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.234 Vali Acc: 0.722 Test Loss: 1.234 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.564170837402344
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.206 Vali Acc: 0.688 Test Loss: 1.206 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.7946436405181885
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.476 Vali Acc: 0.712 Test Loss: 1.476 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.488151788711548
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.810 Vali Acc: 0.722 Test Loss: 0.810 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 5.745368957519531
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.721943 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 5.625750541687012
Epoch: 3, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.660 Vali Acc: 0.722 Test Loss: 0.660 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.011059761047363
Epoch: 4, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.614398241043091
Epoch: 5, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.693 Vali Acc: 0.639 Test Loss: 0.693 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.422165632247925
Epoch: 6, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.679 Vali Acc: 0.722 Test Loss: 0.679 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.559643268585205
Epoch: 7, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.752 Vali Acc: 0.673 Test Loss: 0.752 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.06036639213562
Epoch: 8, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.258 Vali Acc: 0.717 Test Loss: 1.258 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.700512886047363
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.947 Vali Acc: 0.610 Test Loss: 0.947 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.7959325313568115
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.114 Vali Acc: 0.722 Test Loss: 1.114 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.920663833618164
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.164 Vali Acc: 0.707 Test Loss: 1.164 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.848551273345947
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.221 Vali Acc: 0.707 Test Loss: 1.221 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.146509647369385
Epoch: 1, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.778 Vali Acc: 0.722 Test Loss: 0.778 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 5.919788122177124
Epoch: 2, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721943 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.79010009765625
Epoch: 3, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 5.5488080978393555
Epoch: 4, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.695 Vali Acc: 0.751 Test Loss: 0.695 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 5.425135850906372
Epoch: 5, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.634 Vali Acc: 0.741 Test Loss: 0.634 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.506953001022339
Epoch: 6, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.777 Vali Acc: 0.751 Test Loss: 0.777 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.707663297653198
Epoch: 7, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.068349838256836
Epoch: 8, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.007 Vali Acc: 0.766 Test Loss: 1.007 Test Acc: 0.766
Validation loss decreased (-0.751213 --> -0.765844).  Saving model ...
Epoch: 9 cost time: 5.796512603759766
Epoch: 9, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.933 Vali Acc: 0.678 Test Loss: 0.933 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.937920093536377
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.168717622756958
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.058 Vali Acc: 0.673 Test Loss: 1.058 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.399623394012451
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.105 Vali Acc: 0.702 Test Loss: 1.105 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.380390882492065
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.172 Vali Acc: 0.702 Test Loss: 1.172 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.250437498092651
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.556 Vali Acc: 0.751 Test Loss: 1.556 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.327763795852661
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.363 Vali Acc: 0.746 Test Loss: 1.363 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.088362693786621
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.556 Vali Acc: 0.746 Test Loss: 1.556 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.621778726577759
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.302 Vali Acc: 0.702 Test Loss: 1.302 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.92743992805481
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.437 Vali Acc: 0.741 Test Loss: 1.437 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.302263021469116
Epoch: 1, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.817 Vali Acc: 0.722 Test Loss: 0.817 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 5.401767253875732
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.552244663238525
Epoch: 3, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.233631134033203
Epoch: 4, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.721943 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.0982584953308105
Epoch: 5, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.658 Vali Acc: 0.678 Test Loss: 0.658 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.137993812561035
Epoch: 6, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.768 Vali Acc: 0.741 Test Loss: 0.768 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741456).  Saving model ...
Epoch: 7 cost time: 5.066647291183472
Epoch: 7, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.806 Vali Acc: 0.688 Test Loss: 0.806 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.248610258102417
Epoch: 8, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.066 Vali Acc: 0.737 Test Loss: 1.066 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.890217065811157
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.993 Vali Acc: 0.722 Test Loss: 0.993 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.6465277671813965
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.106 Vali Acc: 0.722 Test Loss: 1.106 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.359958171844482
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.111 Vali Acc: 0.722 Test Loss: 1.111 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.611632823944092
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.197 Vali Acc: 0.732 Test Loss: 1.197 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.544283390045166
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.272 Vali Acc: 0.737 Test Loss: 1.272 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.47765851020813
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.507 Vali Acc: 0.746 Test Loss: 1.507 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746326).  Saving model ...
Epoch: 15 cost time: 5.4888505935668945
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.293 Vali Acc: 0.727 Test Loss: 1.293 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.0956056118011475
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.341 Vali Acc: 0.732 Test Loss: 1.341 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.5611608028411865
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.737 Test Loss: 1.337 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.494821310043335
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.732 Test Loss: 1.353 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.594936370849609
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.741 Test Loss: 1.400 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.186254262924194
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.453 Vali Acc: 0.751 Test Loss: 1.453 Test Acc: 0.751
Validation loss decreased (-0.746326 --> -0.751205).  Saving model ...
Epoch: 21 cost time: 5.470715284347534
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.741 Test Loss: 1.388 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.692420959472656
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.746 Test Loss: 1.504 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.81933856010437
Epoch: 23, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.417 Vali Acc: 0.741 Test Loss: 1.417 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.358007907867432
Epoch: 24, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.741 Test Loss: 1.454 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.4661705493927
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.746 Test Loss: 1.520 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.516590118408203
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.746 Test Loss: 1.507 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.996508359909058
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.746 Test Loss: 1.501 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.357398271560669
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.746 Test Loss: 1.554 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.349062442779541
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.746 Test Loss: 1.531 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.432944059371948
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.741 Test Loss: 1.576 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.914721965789795
Epoch: 1, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 5.269339084625244
Epoch: 2, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.631430149078369
Epoch: 3, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.707 Vali Acc: 0.712 Test Loss: 0.707 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.859197616577148
Epoch: 4, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.863 Vali Acc: 0.717 Test Loss: 0.863 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.606468200683594
Epoch: 5, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.699 Vali Acc: 0.712 Test Loss: 0.699 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.701688289642334
Epoch: 6, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.774397611618042
Epoch: 7, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.782 Vali Acc: 0.727 Test Loss: 0.782 Test Acc: 0.727
Validation loss decreased (-0.717066 --> -0.726821).  Saving model ...
Epoch: 8 cost time: 5.7726452350616455
Epoch: 8, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.111 Vali Acc: 0.722 Test Loss: 1.111 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.405492067337036
Epoch: 9, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.190 Vali Acc: 0.712 Test Loss: 1.190 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.585708141326904
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.025 Vali Acc: 0.727 Test Loss: 1.025 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.361315965652466
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.455231189727783
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 0.968 Vali Acc: 0.678 Test Loss: 0.968 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.9816734790802
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.072 Vali Acc: 0.712 Test Loss: 1.072 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.1300694942474365
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.650 Vali Acc: 0.717 Test Loss: 1.650 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.677944898605347
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.332 Vali Acc: 0.717 Test Loss: 1.332 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.674027681350708
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.637 Vali Acc: 0.717 Test Loss: 1.637 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.81432032585144
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.702 Test Loss: 1.388 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.492625951766968
Epoch: 1, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.697 Vali Acc: 0.722 Test Loss: 0.697 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.604053258895874
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.957887887954712
Epoch: 3, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.666 Vali Acc: 0.712 Test Loss: 0.666 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.391618251800537
Epoch: 4, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.892 Vali Acc: 0.707 Test Loss: 0.892 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.648249387741089
Epoch: 5, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.685 Vali Acc: 0.702 Test Loss: 0.685 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.617138147354126
Epoch: 6, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.775 Vali Acc: 0.717 Test Loss: 0.775 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.996798276901245
Epoch: 7, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.769 Vali Acc: 0.712 Test Loss: 0.769 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.369941711425781
Epoch: 8, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.171 Vali Acc: 0.722 Test Loss: 1.171 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.561825275421143
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.965 Vali Acc: 0.698 Test Loss: 0.965 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.170566558837891
Epoch: 10, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.152 Vali Acc: 0.702 Test Loss: 1.152 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.705125570297241
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.094 Vali Acc: 0.698 Test Loss: 1.094 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.591117858886719
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.709 Vali Acc: 0.722 Test Loss: 0.709 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.499576091766357
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.784 Vali Acc: 0.449 Test Loss: 0.784 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.094684839248657
Epoch: 3, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.727 Vali Acc: 0.551 Test Loss: 0.727 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.110892057418823
Epoch: 4, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.877 Vali Acc: 0.444 Test Loss: 0.877 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.126321315765381
Epoch: 5, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.162 Vali Acc: 0.395 Test Loss: 1.162 Test Acc: 0.395
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.283024311065674
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.240 Vali Acc: 0.420 Test Loss: 1.240 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.422166109085083
Epoch: 7, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.094 Vali Acc: 0.468 Test Loss: 1.094 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.569699048995972
Epoch: 8, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.355 Vali Acc: 0.420 Test Loss: 1.355 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.2831878662109375
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.006 Vali Acc: 0.585 Test Loss: 1.006 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.361395835876465
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.340 Vali Acc: 0.483 Test Loss: 1.340 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.430022954940796
Epoch: 11, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.307 Vali Acc: 0.498 Test Loss: 1.307 Test Acc: 0.498
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.301269054412842
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.679 Vali Acc: 0.722 Test Loss: 0.679 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.038593769073486
Epoch: 2, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.895 Vali Acc: 0.341 Test Loss: 0.895 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.590192556381226
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.578442573547363
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.024 Vali Acc: 0.351 Test Loss: 1.024 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.7490527629852295
Epoch: 5, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.284 Vali Acc: 0.327 Test Loss: 1.284 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.5060200691223145
Epoch: 6, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.130 Vali Acc: 0.454 Test Loss: 1.130 Test Acc: 0.454
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.556978940963745
Epoch: 7, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.963 Vali Acc: 0.527 Test Loss: 0.963 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.593768119812012
Epoch: 8, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.929 Vali Acc: 0.610 Test Loss: 0.929 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.616946458816528
Epoch: 9, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.643407106399536
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.300 Vali Acc: 0.576 Test Loss: 1.300 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.142885684967041
Epoch: 11, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.541 Vali Acc: 0.556 Test Loss: 1.541 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 2361602
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.155422687530518
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.228138446807861
Epoch: 2, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 5.404083013534546
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.661 Vali Acc: 0.727 Test Loss: 0.661 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 5.425738573074341
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.600 Vali Acc: 0.698 Test Loss: 0.600 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.067626714706421
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.875 Vali Acc: 0.727 Test Loss: 0.875 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.139796018600464
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.684 Vali Acc: 0.741 Test Loss: 0.684 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 6.031578779220581
Epoch: 7, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.758 Vali Acc: 0.727 Test Loss: 0.758 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.515726089477539
Epoch: 8, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.774 Vali Acc: 0.693 Test Loss: 0.774 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.693127155303955
Epoch: 9, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.912 Vali Acc: 0.620 Test Loss: 0.912 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.401095628738403
Epoch: 10, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.879 Vali Acc: 0.678 Test Loss: 0.879 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.074671506881714
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.950 Vali Acc: 0.688 Test Loss: 0.950 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.233173608779907
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 0.986 Vali Acc: 0.668 Test Loss: 0.986 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.387060165405273
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.256 Vali Acc: 0.712 Test Loss: 1.256 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.0831379890441895
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.134 Vali Acc: 0.693 Test Loss: 1.134 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.74945068359375
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.265 Vali Acc: 0.702 Test Loss: 1.265 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.53996729850769
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.270 Vali Acc: 0.698 Test Loss: 1.270 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.7266151905059814
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.524793386459351
Epoch: 2, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 6.022233247756958
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736578).  Saving model ...
Epoch: 4 cost time: 5.563533544540405
Epoch: 4, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.31681489944458
Epoch: 5, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.037 Vali Acc: 0.727 Test Loss: 1.037 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.675279855728149
Epoch: 6, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.805 Vali Acc: 0.741 Test Loss: 0.805 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741455).  Saving model ...
Epoch: 7 cost time: 5.781062841415405
Epoch: 7, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.722 Vali Acc: 0.688 Test Loss: 0.722 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.888535022735596
Epoch: 8, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.149 Vali Acc: 0.741 Test Loss: 1.149 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.215818643569946
Epoch: 9, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.902 Vali Acc: 0.649 Test Loss: 0.902 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.14220404624939
Epoch: 10, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.123 Vali Acc: 0.732 Test Loss: 1.123 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.093169689178467
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.039 Vali Acc: 0.707 Test Loss: 1.039 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.264832973480225
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.080 Vali Acc: 0.678 Test Loss: 1.080 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.850682020187378
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.180 Vali Acc: 0.722 Test Loss: 1.180 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.916785717010498
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.187 Vali Acc: 0.702 Test Loss: 1.187 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.913082599639893
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.351 Vali Acc: 0.707 Test Loss: 1.351 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.429506540298462
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.385 Vali Acc: 0.712 Test Loss: 1.385 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.613542318344116
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.716701507568359
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 5.901322603225708
Epoch: 3, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 4 cost time: 5.740171909332275
Epoch: 4, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.0755455493927
Epoch: 5, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.653 Vali Acc: 0.688 Test Loss: 0.653 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.413666486740112
Epoch: 6, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.838 Vali Acc: 0.741 Test Loss: 0.838 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741455).  Saving model ...
Epoch: 7 cost time: 5.6914825439453125
Epoch: 7, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.903 Vali Acc: 0.727 Test Loss: 0.903 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.418179035186768
Epoch: 8, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.914 Vali Acc: 0.722 Test Loss: 0.914 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.699095249176025
Epoch: 9, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.034 Vali Acc: 0.693 Test Loss: 1.034 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.5814642906188965
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.067 Vali Acc: 0.615 Test Loss: 1.067 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.555952787399292
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.304 Vali Acc: 0.722 Test Loss: 1.304 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.242337465286255
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.109 Vali Acc: 0.698 Test Loss: 1.109 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.297238111495972
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.158 Vali Acc: 0.683 Test Loss: 1.158 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.623203992843628
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.210 Vali Acc: 0.673 Test Loss: 1.210 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.970611810684204
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.717 Test Loss: 1.387 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.2535035610198975
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.707 Test Loss: 1.349 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.96494722366333
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.375897407531738
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.582 Vali Acc: 0.707 Test Loss: 0.582 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.234895467758179
Epoch: 3, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.735 Vali Acc: 0.707 Test Loss: 0.735 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.2680957317352295
Epoch: 4, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.618 Vali Acc: 0.698 Test Loss: 0.618 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.245855331420898
Epoch: 5, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.561013221740723
Epoch: 6, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.4542906284332275
Epoch: 7, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.851 Vali Acc: 0.712 Test Loss: 0.851 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.276159763336182
Epoch: 8, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.879 Vali Acc: 0.717 Test Loss: 0.879 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.202667236328125
Epoch: 9, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.910 Vali Acc: 0.698 Test Loss: 0.910 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.80434775352478
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.960 Vali Acc: 0.678 Test Loss: 0.960 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.322099924087524
Epoch: 11, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.110 Vali Acc: 0.712 Test Loss: 1.110 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.767496109008789
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.34589695930481
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 5.3888208866119385
Epoch: 3, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.740 Vali Acc: 0.727 Test Loss: 0.740 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.217933654785156
Epoch: 4, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.262410879135132
Epoch: 5, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.783 Vali Acc: 0.732 Test Loss: 0.783 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.079014539718628
Epoch: 6, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.722 Vali Acc: 0.746 Test Loss: 0.722 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746334).  Saving model ...
Epoch: 7 cost time: 4.846155881881714
Epoch: 7, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.776 Vali Acc: 0.746 Test Loss: 0.776 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.390148162841797
Epoch: 8, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.808 Vali Acc: 0.702 Test Loss: 0.808 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.2837748527526855
Epoch: 9, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.870 Vali Acc: 0.707 Test Loss: 0.870 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.220859050750732
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.916 Vali Acc: 0.693 Test Loss: 0.916 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.150909662246704
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.058 Vali Acc: 0.741 Test Loss: 1.058 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.51136326789856
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.036 Vali Acc: 0.727 Test Loss: 1.036 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.238409996032715
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.137 Vali Acc: 0.737 Test Loss: 1.137 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.313704967498779
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.130 Vali Acc: 0.732 Test Loss: 1.130 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.137916803359985
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.232 Vali Acc: 0.741 Test Loss: 1.232 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.059247970581055
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.174 Vali Acc: 0.737 Test Loss: 1.174 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.063846826553345
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 6.041939973831177
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.715 Vali Acc: 0.722 Test Loss: 0.715 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0933613777160645
Epoch: 3, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.771 Vali Acc: 0.727 Test Loss: 0.771 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.578882217407227
Epoch: 4, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 6.157893419265747
Epoch: 5, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.965 Vali Acc: 0.722 Test Loss: 0.965 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.6952574253082275
Epoch: 6, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.060 Vali Acc: 0.727 Test Loss: 1.060 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.606902122497559
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.756 Vali Acc: 0.717 Test Loss: 0.756 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.59711766242981
Epoch: 8, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.856 Vali Acc: 0.741 Test Loss: 0.856 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741455).  Saving model ...
Epoch: 9 cost time: 5.788674831390381
Epoch: 9, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.879 Vali Acc: 0.678 Test Loss: 0.879 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.306188344955444
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.960 Vali Acc: 0.712 Test Loss: 0.960 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.52362322807312
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.163 Vali Acc: 0.727 Test Loss: 1.163 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.03977632522583
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.044 Vali Acc: 0.707 Test Loss: 1.044 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.783998727798462
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.149 Vali Acc: 0.722 Test Loss: 1.149 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.81413197517395
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.153 Vali Acc: 0.722 Test Loss: 1.153 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.686871290206909
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.365 Vali Acc: 0.737 Test Loss: 1.365 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.788687229156494
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.330 Vali Acc: 0.737 Test Loss: 1.330 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.807697534561157
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.273 Vali Acc: 0.712 Test Loss: 1.273 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.918798208236694
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.722 Test Loss: 1.377 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.051195383071899
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.099907159805298
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.761 Vali Acc: 0.717 Test Loss: 0.761 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.22171425819397
Epoch: 3, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.786 Vali Acc: 0.712 Test Loss: 0.786 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.064785957336426
Epoch: 4, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.309104919433594
Epoch: 5, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.929 Vali Acc: 0.722 Test Loss: 0.929 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721942).  Saving model ...
Epoch: 6 cost time: 5.588407754898071
Epoch: 6, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.085 Vali Acc: 0.712 Test Loss: 1.085 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.655068874359131
Epoch: 7, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.794 Vali Acc: 0.707 Test Loss: 0.794 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.447769403457642
Epoch: 8, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.020 Vali Acc: 0.722 Test Loss: 1.020 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.3325653076171875
Epoch: 9, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.927 Vali Acc: 0.712 Test Loss: 0.927 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.651479005813599
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.911 Vali Acc: 0.712 Test Loss: 0.911 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.1993935108184814
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.153 Vali Acc: 0.737 Test Loss: 1.153 Test Acc: 0.737
Validation loss decreased (-0.721942 --> -0.736574).  Saving model ...
Epoch: 12 cost time: 4.90556001663208
Epoch: 12, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.024 Vali Acc: 0.717 Test Loss: 1.024 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.3018410205841064
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.171 Vali Acc: 0.727 Test Loss: 1.171 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.247283458709717
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.004 Vali Acc: 0.707 Test Loss: 1.004 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.308710098266602
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.118 Vali Acc: 0.722 Test Loss: 1.118 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.1689534187316895
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.481 Vali Acc: 0.732 Test Loss: 1.481 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.254997491836548
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.280 Vali Acc: 0.717 Test Loss: 1.280 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.4175825119018555
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.285 Vali Acc: 0.727 Test Loss: 1.285 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.675771236419678
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.235 Vali Acc: 0.727 Test Loss: 1.235 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.4340128898620605
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.727 Test Loss: 1.363 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.493213415145874
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.324 Vali Acc: 0.727 Test Loss: 1.324 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.599195957183838
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.642 Vali Acc: 0.722 Test Loss: 0.642 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.942491769790649
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.700862646102905
Epoch: 3, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.737 Vali Acc: 0.722 Test Loss: 0.737 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.996225118637085
Epoch: 4, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 5.4573211669921875
Epoch: 5, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.9610915184021
Epoch: 6, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.040 Vali Acc: 0.712 Test Loss: 1.040 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.9992945194244385
Epoch: 7, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.717 Vali Acc: 0.693 Test Loss: 0.717 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.44851279258728
Epoch: 8, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.028 Vali Acc: 0.717 Test Loss: 1.028 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.4686119556427
Epoch: 9, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.945 Vali Acc: 0.712 Test Loss: 0.945 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.604352712631226
Epoch: 10, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.952 Vali Acc: 0.702 Test Loss: 0.952 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.350721120834351
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.111 Vali Acc: 0.712 Test Loss: 1.111 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.150668144226074
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.126 Vali Acc: 0.722 Test Loss: 1.126 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.162506103515625
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.278 Vali Acc: 0.722 Test Loss: 1.278 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.605736970901489
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.032 Vali Acc: 0.707 Test Loss: 1.032 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.856540203094482
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.690 Vali Acc: 0.722 Test Loss: 0.690 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 6.137970447540283
Epoch: 2, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.669 Vali Acc: 0.580 Test Loss: 0.669 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.0280091762542725
Epoch: 3, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.659 Vali Acc: 0.644 Test Loss: 0.659 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.284240007400513
Epoch: 4, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.860 Vali Acc: 0.410 Test Loss: 0.860 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.344746828079224
Epoch: 5, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.755 Vali Acc: 0.600 Test Loss: 0.755 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.929172992706299
Epoch: 6, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.796 Vali Acc: 0.644 Test Loss: 0.796 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.226622819900513
Epoch: 7, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.191 Vali Acc: 0.454 Test Loss: 1.191 Test Acc: 0.454
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.591142654418945
Epoch: 8, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.993 Vali Acc: 0.546 Test Loss: 0.993 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.5701305866241455
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.031 Vali Acc: 0.566 Test Loss: 1.031 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.689830541610718
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.075 Vali Acc: 0.649 Test Loss: 1.075 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.0415613651275635
Epoch: 11, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.110 Vali Acc: 0.659 Test Loss: 1.110 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.5951573848724365
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.5286126136779785
Epoch: 2, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.685 Vali Acc: 0.566 Test Loss: 0.685 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.456479072570801
Epoch: 3, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.598 Vali Acc: 0.707 Test Loss: 0.598 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.161363363265991
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.732 Vali Acc: 0.546 Test Loss: 0.732 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.197186231613159
Epoch: 5, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.703 Vali Acc: 0.600 Test Loss: 0.703 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.391369342803955
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.695 Vali Acc: 0.644 Test Loss: 0.695 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.485208749771118
Epoch: 7, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.522 Vali Acc: 0.332 Test Loss: 1.522 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.960221290588379
Epoch: 8, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.941 Vali Acc: 0.590 Test Loss: 0.941 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.72810435295105
Epoch: 9, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.071 Vali Acc: 0.624 Test Loss: 1.071 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.817729234695435
Epoch: 10, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.135 Vali Acc: 0.649 Test Loss: 1.135 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.758013725280762
Epoch: 11, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.561 Vali Acc: 0.590 Test Loss: 1.561 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1575170
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.964223861694336
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 5.043677568435669
Epoch: 2, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.0571088790893555
Epoch: 3, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.659 Vali Acc: 0.707 Test Loss: 0.659 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.278262376785278
Epoch: 4, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.619 Vali Acc: 0.693 Test Loss: 0.619 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.10747504234314
Epoch: 5, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.631 Vali Acc: 0.702 Test Loss: 0.631 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.58810567855835
Epoch: 6, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.668 Vali Acc: 0.683 Test Loss: 0.668 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.189537048339844
Epoch: 7, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.775 Vali Acc: 0.668 Test Loss: 0.775 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.17955207824707
Epoch: 8, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.849 Vali Acc: 0.620 Test Loss: 0.849 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.105713129043579
Epoch: 9, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.911 Vali Acc: 0.727 Test Loss: 0.911 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.3654625415802
Epoch: 10, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.891 Vali Acc: 0.707 Test Loss: 0.891 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.455547332763672
Epoch: 11, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.093 Vali Acc: 0.707 Test Loss: 1.093 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.906502962112427
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.036633729934692
Epoch: 2, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.153942584991455
Epoch: 3, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.654 Vali Acc: 0.732 Test Loss: 0.654 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 5.3731138706207275
Epoch: 4, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.428325176239014
Epoch: 5, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.680 Vali Acc: 0.683 Test Loss: 0.680 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.598989963531494
Epoch: 6, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.713 Vali Acc: 0.727 Test Loss: 0.713 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.36611008644104
Epoch: 7, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.780 Vali Acc: 0.654 Test Loss: 0.780 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.619751214981079
Epoch: 8, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.848 Vali Acc: 0.639 Test Loss: 0.848 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.339034795761108
Epoch: 9, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.058 Vali Acc: 0.737 Test Loss: 1.058 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.72852635383606
Epoch: 10, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.070 Vali Acc: 0.727 Test Loss: 1.070 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.798655271530151
Epoch: 11, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.194 Vali Acc: 0.722 Test Loss: 1.194 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.69655442237854
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.194 Vali Acc: 0.727 Test Loss: 1.194 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.457466125488281
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.195 Vali Acc: 0.717 Test Loss: 1.195 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.365540981292725
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.246 Vali Acc: 0.722 Test Loss: 1.246 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.211073160171509
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.921361207962036
Epoch: 2, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.671 Vali Acc: 0.727 Test Loss: 0.671 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 5.564352512359619
Epoch: 3, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 5.87094783782959
Epoch: 4, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.81602144241333
Epoch: 5, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.712 Vali Acc: 0.605 Test Loss: 0.712 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.798566818237305
Epoch: 6, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.746 Vali Acc: 0.722 Test Loss: 0.746 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.573727607727051
Epoch: 7, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.843 Vali Acc: 0.590 Test Loss: 0.843 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.062598943710327
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.930 Vali Acc: 0.580 Test Loss: 0.930 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.90984845161438
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.988 Vali Acc: 0.702 Test Loss: 0.988 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.187255620956421
Epoch: 10, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.088 Vali Acc: 0.717 Test Loss: 1.088 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.552330255508423
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.167 Vali Acc: 0.712 Test Loss: 1.167 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.188983917236328
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.186 Vali Acc: 0.702 Test Loss: 1.186 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.674585342407227
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.165 Vali Acc: 0.673 Test Loss: 1.165 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.583563804626465
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.585 Vali Acc: 0.707 Test Loss: 0.585 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 5.5449559688568115
Epoch: 2, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717066).  Saving model ...
Epoch: 3 cost time: 5.6097190380096436
Epoch: 3, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.652 Vali Acc: 0.707 Test Loss: 0.652 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.193769454956055
Epoch: 4, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.608 Vali Acc: 0.698 Test Loss: 0.608 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.164959669113159
Epoch: 5, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.907 Vali Acc: 0.498 Test Loss: 0.907 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.395382642745972
Epoch: 6, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.875 Vali Acc: 0.717 Test Loss: 0.875 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.263953447341919
Epoch: 7, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.746 Vali Acc: 0.668 Test Loss: 0.746 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.04520058631897
Epoch: 8, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.767 Vali Acc: 0.702 Test Loss: 0.767 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.765483856201172
Epoch: 9, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.058 Vali Acc: 0.712 Test Loss: 1.058 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.530585050582886
Epoch: 10, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.003 Vali Acc: 0.712 Test Loss: 1.003 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.538286924362183
Epoch: 11, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.181 Vali Acc: 0.727 Test Loss: 1.181 Test Acc: 0.727
Validation loss decreased (-0.717066 --> -0.726817).  Saving model ...
Epoch: 12 cost time: 5.436208486557007
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.264 Vali Acc: 0.727 Test Loss: 1.264 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.73639178276062
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.181 Vali Acc: 0.727 Test Loss: 1.181 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.26528000831604
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.301 Vali Acc: 0.727 Test Loss: 1.301 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.259429454803467
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.135 Vali Acc: 0.668 Test Loss: 1.135 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.530118465423584
Epoch: 16, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.172 Vali Acc: 0.644 Test Loss: 1.172 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.0655975341796875
Epoch: 17, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.279 Vali Acc: 0.693 Test Loss: 1.279 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.962999105453491
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.622 Vali Acc: 0.737 Test Loss: 1.622 Test Acc: 0.737
Validation loss decreased (-0.726817 --> -0.736569).  Saving model ...
Epoch: 19 cost time: 5.5290093421936035
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.698 Test Loss: 1.321 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.794079780578613
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.727 Test Loss: 1.519 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.753516912460327
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.426 Vali Acc: 0.698 Test Loss: 1.426 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.926895618438721
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.486 Vali Acc: 0.712 Test Loss: 1.486 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.621343612670898
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.453 Vali Acc: 0.707 Test Loss: 1.453 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.116786241531372
Epoch: 24, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.538 Vali Acc: 0.722 Test Loss: 1.538 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.502405881881714
Epoch: 25, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.702 Test Loss: 1.479 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.482909440994263
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.722 Test Loss: 1.574 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.415780067443848
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.712 Test Loss: 1.527 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.373716592788696
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.717 Test Loss: 1.563 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.241104602813721
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 5.670963764190674
Epoch: 2, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.644 Vali Acc: 0.741 Test Loss: 0.644 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 5.657685279846191
Epoch: 3, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.666 Vali Acc: 0.746 Test Loss: 0.666 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 5.451915740966797
Epoch: 4, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.13672399520874
Epoch: 5, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.994320392608643
Epoch: 6, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.881 Vali Acc: 0.751 Test Loss: 0.881 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751211).  Saving model ...
Epoch: 7 cost time: 5.270078897476196
Epoch: 7, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.245437383651733
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.887 Vali Acc: 0.644 Test Loss: 0.887 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.169806003570557
Epoch: 9, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.870 Vali Acc: 0.737 Test Loss: 0.870 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.804985761642456
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.998 Vali Acc: 0.741 Test Loss: 0.998 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.385674715042114
Epoch: 11, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.136 Vali Acc: 0.737 Test Loss: 1.136 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.379561185836792
Epoch: 12, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.397 Vali Acc: 0.761 Test Loss: 1.397 Test Acc: 0.761
Validation loss decreased (-0.751211 --> -0.760962).  Saving model ...
Epoch: 13 cost time: 5.339798927307129
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.344 Vali Acc: 0.746 Test Loss: 1.344 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.630971908569336
Epoch: 14, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.265 Vali Acc: 0.732 Test Loss: 1.265 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.207196235656738
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.239 Vali Acc: 0.678 Test Loss: 1.239 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.181982755661011
Epoch: 16, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.236 Vali Acc: 0.663 Test Loss: 1.236 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.079899549484253
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.382 Vali Acc: 0.741 Test Loss: 1.382 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.16072416305542
Epoch: 18, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.262 Vali Acc: 0.722 Test Loss: 1.262 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.203319311141968
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.346 Vali Acc: 0.741 Test Loss: 1.346 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.124059677124023
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.319 Vali Acc: 0.737 Test Loss: 1.319 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.030732870101929
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.347 Vali Acc: 0.737 Test Loss: 1.347 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.1733832359313965
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.319 Vali Acc: 0.727 Test Loss: 1.319 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.203563451766968
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 4.9486894607543945
Epoch: 2, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.23738169670105
Epoch: 3, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.768 Vali Acc: 0.732 Test Loss: 0.768 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.9854583740234375
Epoch: 4, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.729 Vali Acc: 0.737 Test Loss: 0.729 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.037176609039307
Epoch: 5, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.959126710891724
Epoch: 6, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.798 Vali Acc: 0.746 Test Loss: 0.798 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746333).  Saving model ...
Epoch: 7 cost time: 5.135689973831177
Epoch: 7, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.737 Vali Acc: 0.668 Test Loss: 0.737 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.4984130859375
Epoch: 8, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.796 Vali Acc: 0.654 Test Loss: 0.796 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.467760801315308
Epoch: 9, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.033 Vali Acc: 0.741 Test Loss: 1.033 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.555060625076294
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.949 Vali Acc: 0.732 Test Loss: 0.949 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.158325433731079
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.211 Vali Acc: 0.751 Test Loss: 1.211 Test Acc: 0.751
Validation loss decreased (-0.746333 --> -0.751207).  Saving model ...
Epoch: 12 cost time: 5.77304220199585
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.329 Vali Acc: 0.741 Test Loss: 1.329 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.32669472694397
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.189 Vali Acc: 0.737 Test Loss: 1.189 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.32771635055542
Epoch: 14, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.136 Vali Acc: 0.737 Test Loss: 1.136 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.043930768966675
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.221 Vali Acc: 0.722 Test Loss: 1.221 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.242408990859985
Epoch: 16, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.242 Vali Acc: 0.698 Test Loss: 1.242 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.402777910232544
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.443 Vali Acc: 0.737 Test Loss: 1.443 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.383768320083618
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.416 Vali Acc: 0.732 Test Loss: 1.416 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.257262706756592
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.727 Test Loss: 1.377 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.802495241165161
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.722 Test Loss: 1.438 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.699278116226196
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.717 Test Loss: 1.430 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.02799654006958
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.562 Vali Acc: 0.717 Test Loss: 0.562 Test Acc: 0.717
Validation loss decreased (inf --> -0.717068).  Saving model ...
Epoch: 2 cost time: 4.9742653369903564
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.175334215164185
Epoch: 3, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.838 Vali Acc: 0.727 Test Loss: 0.838 Test Acc: 0.727
Validation loss decreased (-0.717068 --> -0.726821).  Saving model ...
Epoch: 4 cost time: 5.297998666763306
Epoch: 4, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.802 Vali Acc: 0.722 Test Loss: 0.802 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.943664073944092
Epoch: 5, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.674 Vali Acc: 0.712 Test Loss: 0.674 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.034999370574951
Epoch: 6, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.932 Vali Acc: 0.712 Test Loss: 0.932 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.042952537536621
Epoch: 7, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.747 Vali Acc: 0.707 Test Loss: 0.747 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.5262274742126465
Epoch: 8, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.765 Vali Acc: 0.712 Test Loss: 0.765 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.508991956710815
Epoch: 9, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.735302209854126
Epoch: 10, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.711049318313599
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.193 Vali Acc: 0.712 Test Loss: 1.193 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.199391841888428
Epoch: 12, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.257 Vali Acc: 0.707 Test Loss: 1.257 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.178643465042114
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.940 Vali Acc: 0.732 Test Loss: 0.940 Test Acc: 0.732
Validation loss decreased (-0.726821 --> -0.731698).  Saving model ...
Epoch: 14 cost time: 5.253219366073608
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.976 Vali Acc: 0.722 Test Loss: 0.976 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.141902208328247
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.011 Vali Acc: 0.727 Test Loss: 1.011 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.087316036224365
Epoch: 16, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.167 Vali Acc: 0.717 Test Loss: 1.167 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.24770450592041
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.438 Vali Acc: 0.717 Test Loss: 1.438 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.104522705078125
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.248 Vali Acc: 0.737 Test Loss: 1.248 Test Acc: 0.737
Validation loss decreased (-0.731698 --> -0.736573).  Saving model ...
Epoch: 19 cost time: 5.66614031791687
Epoch: 19, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.732 Test Loss: 1.307 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.182495832443237
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.349 Vali Acc: 0.732 Test Loss: 1.349 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.197896957397461
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.737 Test Loss: 1.298 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.414099931716919
Epoch: 22, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.737 Test Loss: 1.423 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.954395771026611
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.353 Vali Acc: 0.737 Test Loss: 1.353 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.164671897888184
Epoch: 24, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.453 Vali Acc: 0.737 Test Loss: 1.453 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.234249830245972
Epoch: 25, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.737 Test Loss: 1.400 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.2218101024627686
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.741 Test Loss: 1.506 Test Acc: 0.741
Validation loss decreased (-0.736573 --> -0.741448).  Saving model ...
Epoch: 27 cost time: 5.053781509399414
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.741 Test Loss: 1.436 Test Acc: 0.741
Validation loss decreased (-0.741448 --> -0.741449).  Saving model ...
Epoch: 28 cost time: 4.935979843139648
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.741 Test Loss: 1.479 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.118018627166748
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.746 Test Loss: 1.469 Test Acc: 0.746
Validation loss decreased (-0.741449 --> -0.746327).  Saving model ...
Epoch: 30 cost time: 5.64252495765686
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.746 Test Loss: 1.491 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.056548357009888
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.741 Test Loss: 1.576 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.404207468032837
Epoch: 32, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.746 Test Loss: 1.492 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.525465726852417
Epoch: 33, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.746 Test Loss: 1.546 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.915555953979492
Epoch: 34, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.746 Test Loss: 1.538 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.5315515995025635
Epoch: 35, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.746 Test Loss: 1.555 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.0782365798950195
Epoch: 36, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.732 Test Loss: 1.449 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.156080722808838
Epoch: 37, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.741 Test Loss: 1.650 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.406771421432495
Epoch: 38, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.737 Test Loss: 1.526 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.321451902389526
Epoch: 39, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.751 Test Loss: 1.589 Test Acc: 0.751
Validation loss decreased (-0.746327 --> -0.751204).  Saving model ...
Epoch: 40 cost time: 5.222148656845093
Epoch: 40, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.751 Test Loss: 1.634 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.519489288330078
Epoch: 41, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.741 Test Loss: 1.571 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.941920042037964
Epoch: 42, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.746 Test Loss: 1.632 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.555521726608276
Epoch: 43, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.746 Test Loss: 1.619 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.309612274169922
Epoch: 44, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.746 Test Loss: 1.637 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.45150899887085
Epoch: 45, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.746 Test Loss: 1.658 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 5.879021644592285
Epoch: 46, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.741 Test Loss: 1.644 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 5.438264608383179
Epoch: 47, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.741 Test Loss: 1.654 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 5.254694938659668
Epoch: 48, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.746 Test Loss: 1.710 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 5.366043329238892
Epoch: 49, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.741 Test Loss: 1.645 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.385841608047485
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.484870195388794
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.817 Vali Acc: 0.722 Test Loss: 0.817 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.7389976978302
Epoch: 3, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.621843576431274
Epoch: 4, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.428561210632324
Epoch: 5, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.646 Vali Acc: 0.698 Test Loss: 0.646 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.255975961685181
Epoch: 6, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.825 Vali Acc: 0.722 Test Loss: 0.825 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.374927043914795
Epoch: 7, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.817 Vali Acc: 0.722 Test Loss: 0.817 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.407464504241943
Epoch: 8, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.763 Vali Acc: 0.712 Test Loss: 0.763 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.451618432998657
Epoch: 9, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.993 Vali Acc: 0.707 Test Loss: 0.993 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.020543575286865
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.937 Vali Acc: 0.698 Test Loss: 0.937 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.961134910583496
Epoch: 11, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.201 Vali Acc: 0.712 Test Loss: 1.201 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.777592658996582
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.511964559555054
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.657 Vali Acc: 0.722 Test Loss: 0.657 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.154092788696289
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.689 Vali Acc: 0.561 Test Loss: 0.689 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.908133506774902
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.867 Vali Acc: 0.434 Test Loss: 0.867 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.90451717376709
Epoch: 5, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.125 Vali Acc: 0.371 Test Loss: 1.125 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.745491981506348
Epoch: 6, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.747 Vali Acc: 0.639 Test Loss: 0.747 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.864879369735718
Epoch: 7, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.055 Vali Acc: 0.463 Test Loss: 1.055 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.167547225952148
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.272 Vali Acc: 0.424 Test Loss: 1.272 Test Acc: 0.424
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.293880939483643
Epoch: 9, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.180 Vali Acc: 0.483 Test Loss: 1.180 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.601892948150635
Epoch: 10, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.024 Vali Acc: 0.620 Test Loss: 1.024 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.250242233276367
Epoch: 11, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.075 Vali Acc: 0.649 Test Loss: 1.075 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.816090822219849
Epoch: 1, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.527930736541748
Epoch: 2, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 5.064545631408691
Epoch: 3, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.727 Vali Acc: 0.522 Test Loss: 0.727 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.779894113540649
Epoch: 4, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.0241241455078125
Epoch: 5, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.918 Vali Acc: 0.400 Test Loss: 0.918 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.216613292694092
Epoch: 6, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.592 Vali Acc: 0.741 Test Loss: 0.592 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 4.846772193908691
Epoch: 7, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.895 Vali Acc: 0.556 Test Loss: 0.895 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.486544609069824
Epoch: 8, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.598 Vali Acc: 0.332 Test Loss: 1.598 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.092425107955933
Epoch: 9, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.274 Vali Acc: 0.468 Test Loss: 1.274 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.281221866607666
Epoch: 10, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.615 Vali Acc: 0.434 Test Loss: 1.615 Test Acc: 0.434
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.511598348617554
Epoch: 11, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.263 Vali Acc: 0.580 Test Loss: 1.263 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.623265743255615
Epoch: 12, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.490 Vali Acc: 0.580 Test Loss: 1.490 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.134281635284424
Epoch: 13, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.580 Vali Acc: 0.580 Test Loss: 1.580 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.144659042358398
Epoch: 14, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.974 Vali Acc: 0.522 Test Loss: 1.974 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.0818915367126465
Epoch: 15, Steps: 13 | Train Loss: 0.032 Vali Loss: 3.416 Vali Acc: 0.385 Test Loss: 3.416 Test Acc: 0.385
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.079187870025635
Epoch: 16, Steps: 13 | Train Loss: 0.084 Vali Loss: 3.081 Vali Acc: 0.459 Test Loss: 3.081 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1181954
model size : 9.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.179063558578491
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 5.2086567878723145
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.718 Vali Acc: 0.512 Test Loss: 0.718 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.176129341125488
Epoch: 3, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.845 Vali Acc: 0.371 Test Loss: 0.845 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.1657726764678955
Epoch: 4, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.198054552078247
Epoch: 5, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.019 Vali Acc: 0.717 Test Loss: 1.019 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.992406606674194
Epoch: 6, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.776 Vali Acc: 0.732 Test Loss: 0.776 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.85483980178833
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.654 Vali Acc: 0.683 Test Loss: 0.654 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.669248819351196
Epoch: 8, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.703 Vali Acc: 0.668 Test Loss: 0.703 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.932861804962158
Epoch: 9, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.812 Vali Acc: 0.712 Test Loss: 0.812 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.0064897537231445
Epoch: 10, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.069 Vali Acc: 0.561 Test Loss: 1.069 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.288713693618774
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.935 Vali Acc: 0.693 Test Loss: 0.935 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.106363296508789
Epoch: 12, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.044 Vali Acc: 0.712 Test Loss: 1.044 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.168187856674194
Epoch: 13, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.134 Vali Acc: 0.702 Test Loss: 1.134 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.212148904800415
Epoch: 14, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.128 Vali Acc: 0.707 Test Loss: 1.128 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.6559131145477295
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 5.3040666580200195
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.709 Vali Acc: 0.566 Test Loss: 0.709 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.255063772201538
Epoch: 3, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.464034795761108
Epoch: 4, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.545369863510132
Epoch: 5, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.159 Vali Acc: 0.727 Test Loss: 1.159 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.749460697174072
Epoch: 6, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.813 Vali Acc: 0.732 Test Loss: 0.813 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.4064764976501465
Epoch: 7, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.697 Vali Acc: 0.693 Test Loss: 0.697 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.904006004333496
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.752 Vali Acc: 0.688 Test Loss: 0.752 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.149793386459351
Epoch: 9, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.827 Vali Acc: 0.702 Test Loss: 0.827 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.161736249923706
Epoch: 10, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.941 Vali Acc: 0.624 Test Loss: 0.941 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.9215123653411865
Epoch: 11, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.005014181137085
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.193 Vali Acc: 0.727 Test Loss: 1.193 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.595138072967529
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.148 Vali Acc: 0.722 Test Loss: 1.148 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.724688529968262
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.123 Vali Acc: 0.698 Test Loss: 1.123 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.444051027297974
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.189952373504639
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.660 Vali Acc: 0.620 Test Loss: 0.660 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.10210108757019
Epoch: 3, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.844 Vali Acc: 0.439 Test Loss: 0.844 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.396543264389038
Epoch: 4, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.815070629119873
Epoch: 5, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.104 Vali Acc: 0.732 Test Loss: 1.104 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731696).  Saving model ...
Epoch: 6 cost time: 4.820460319519043
Epoch: 6, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.860 Vali Acc: 0.737 Test Loss: 0.860 Test Acc: 0.737
Validation loss decreased (-0.731696 --> -0.736577).  Saving model ...
Epoch: 7 cost time: 5.067118883132935
Epoch: 7, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.782 Vali Acc: 0.732 Test Loss: 0.782 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.363642692565918
Epoch: 8, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.789 Vali Acc: 0.688 Test Loss: 0.789 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.418323755264282
Epoch: 9, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.949 Vali Acc: 0.712 Test Loss: 0.949 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.397287130355835
Epoch: 10, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.006 Vali Acc: 0.620 Test Loss: 1.006 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.339159727096558
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.033 Vali Acc: 0.732 Test Loss: 1.033 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.49028754234314
Epoch: 12, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.157 Vali Acc: 0.737 Test Loss: 1.157 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.299686908721924
Epoch: 13, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.321 Vali Acc: 0.737 Test Loss: 1.321 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.984398603439331
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.165 Vali Acc: 0.698 Test Loss: 1.165 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.293802738189697
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.185 Vali Acc: 0.698 Test Loss: 1.185 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.225792646408081
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.133 Vali Acc: 0.654 Test Loss: 1.133 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.330627918243408
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.569 Vali Acc: 0.722 Test Loss: 0.569 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 5.147155523300171
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.703 Vali Acc: 0.571 Test Loss: 0.703 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.396204471588135
Epoch: 3, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.642 Vali Acc: 0.673 Test Loss: 0.642 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.20609712600708
Epoch: 4, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.572885513305664
Epoch: 5, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.931 Vali Acc: 0.722 Test Loss: 0.931 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.91894268989563
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.763 Vali Acc: 0.717 Test Loss: 0.763 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.84419584274292
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.729 Vali Acc: 0.702 Test Loss: 0.729 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.102733850479126
Epoch: 8, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.765 Vali Acc: 0.673 Test Loss: 0.765 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.067434549331665
Epoch: 9, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.791 Vali Acc: 0.688 Test Loss: 0.791 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.643139600753784
Epoch: 10, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.953 Vali Acc: 0.590 Test Loss: 0.953 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.710863351821899
Epoch: 11, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.964202642440796
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.559 Vali Acc: 0.732 Test Loss: 0.559 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 5.413099527359009
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.636 Vali Acc: 0.673 Test Loss: 0.636 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.340999126434326
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.650 Vali Acc: 0.659 Test Loss: 0.650 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.201815843582153
Epoch: 4, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.665 Vali Acc: 0.751 Test Loss: 0.665 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 5.193515300750732
Epoch: 5, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.957 Vali Acc: 0.727 Test Loss: 0.957 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.259514808654785
Epoch: 6, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.798 Vali Acc: 0.732 Test Loss: 0.798 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.5300984382629395
Epoch: 7, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.939 Vali Acc: 0.737 Test Loss: 0.939 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.082563877105713
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.808 Vali Acc: 0.746 Test Loss: 0.808 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.6720781326293945
Epoch: 9, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.823 Vali Acc: 0.737 Test Loss: 0.823 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.754879713058472
Epoch: 10, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.896 Vali Acc: 0.678 Test Loss: 0.896 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.806908845901489
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.930 Vali Acc: 0.727 Test Loss: 0.930 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.852202653884888
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 0.980 Vali Acc: 0.727 Test Loss: 0.980 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.845170974731445
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.062 Vali Acc: 0.722 Test Loss: 1.062 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.569140195846558
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.090 Vali Acc: 0.722 Test Loss: 1.090 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.583692312240601
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 4.961341619491577
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.605 Vali Acc: 0.707 Test Loss: 0.605 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.764232873916626
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.602 Vali Acc: 0.702 Test Loss: 0.602 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.265958786010742
Epoch: 4, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.634 Vali Acc: 0.707 Test Loss: 0.634 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.399471044540405
Epoch: 5, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.827 Vali Acc: 0.732 Test Loss: 0.827 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.240169525146484
Epoch: 6, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.709 Vali Acc: 0.732 Test Loss: 0.709 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.18795108795166
Epoch: 7, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.725 Vali Acc: 0.722 Test Loss: 0.725 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.458683729171753
Epoch: 8, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.823 Vali Acc: 0.741 Test Loss: 0.823 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741455).  Saving model ...
Epoch: 9 cost time: 5.134885787963867
Epoch: 9, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.842 Vali Acc: 0.741 Test Loss: 0.842 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.839101314544678
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.872 Vali Acc: 0.702 Test Loss: 0.872 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.735148191452026
Epoch: 11, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.956 Vali Acc: 0.727 Test Loss: 0.956 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.5183868408203125
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.087 Vali Acc: 0.737 Test Loss: 1.087 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.842813014984131
Epoch: 13, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.222 Vali Acc: 0.732 Test Loss: 1.222 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.6850666999816895
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.182 Vali Acc: 0.737 Test Loss: 1.182 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.065509796142578
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.124 Vali Acc: 0.732 Test Loss: 1.124 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.205737352371216
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.135 Vali Acc: 0.727 Test Loss: 1.135 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.85948371887207
Epoch: 17, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.367 Vali Acc: 0.737 Test Loss: 1.367 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.931353807449341
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.397 Vali Acc: 0.737 Test Loss: 1.397 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.77882981300354
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.568 Vali Acc: 0.717 Test Loss: 0.568 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.750672340393066
Epoch: 2, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.8358495235443115
Epoch: 3, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.9553611278533936
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.960143804550171
Epoch: 5, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.164 Vali Acc: 0.717 Test Loss: 1.164 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.841391324996948
Epoch: 6, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.777 Vali Acc: 0.722 Test Loss: 0.777 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721943).  Saving model ...
Epoch: 7 cost time: 5.000272750854492
Epoch: 7, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.788 Vali Acc: 0.702 Test Loss: 0.788 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.292060136795044
Epoch: 8, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.947 Vali Acc: 0.722 Test Loss: 0.947 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.481699705123901
Epoch: 9, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.794 Vali Acc: 0.712 Test Loss: 0.794 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.056436538696289
Epoch: 10, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.831 Vali Acc: 0.688 Test Loss: 0.831 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.002909183502197
Epoch: 11, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.923 Vali Acc: 0.722 Test Loss: 0.923 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.23401665687561
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.960 Vali Acc: 0.722 Test Loss: 0.960 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.340188980102539
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.169 Vali Acc: 0.722 Test Loss: 1.169 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.07327127456665
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.257 Vali Acc: 0.717 Test Loss: 1.257 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.430954456329346
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.062 Vali Acc: 0.707 Test Loss: 1.062 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.2797932624816895
Epoch: 16, Steps: 13 | Train Loss: 0.006 Vali Loss: 0.968 Vali Acc: 0.693 Test Loss: 0.968 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.843764066696167
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.575 Vali Acc: 0.702 Test Loss: 0.575 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 5.939009189605713
Epoch: 2, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.596 Vali Acc: 0.698 Test Loss: 0.596 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.225416660308838
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.586 Vali Acc: 0.698 Test Loss: 0.586 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.927755355834961
Epoch: 4, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
Validation loss decreased (-0.702433 --> -0.717066).  Saving model ...
Epoch: 5 cost time: 5.983163833618164
Epoch: 5, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.142 Vali Acc: 0.722 Test Loss: 1.142 Test Acc: 0.722
Validation loss decreased (-0.717066 --> -0.721940).  Saving model ...
Epoch: 6 cost time: 5.68538761138916
Epoch: 6, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.491849184036255
Epoch: 7, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.789 Vali Acc: 0.688 Test Loss: 0.789 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.207724332809448
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.800 Vali Acc: 0.698 Test Loss: 0.800 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.167065620422363
Epoch: 9, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.876 Vali Acc: 0.683 Test Loss: 0.876 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.672358512878418
Epoch: 10, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.799 Vali Acc: 0.693 Test Loss: 0.799 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.652562141418457
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.000 Vali Acc: 0.673 Test Loss: 1.000 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.805801868438721
Epoch: 12, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.024 Vali Acc: 0.683 Test Loss: 1.024 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.008614540100098
Epoch: 13, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.069 Vali Acc: 0.688 Test Loss: 1.069 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.242793798446655
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.099 Vali Acc: 0.693 Test Loss: 1.099 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.268657207489014
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.039 Vali Acc: 0.693 Test Loss: 1.039 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.40388298034668
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.197544097900391
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.939 Vali Acc: 0.307 Test Loss: 0.939 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.161654472351074
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.875 Vali Acc: 0.380 Test Loss: 0.875 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.640367269515991
Epoch: 4, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.649 Vali Acc: 0.654 Test Loss: 0.649 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.995858430862427
Epoch: 5, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.807 Vali Acc: 0.727 Test Loss: 0.807 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726821).  Saving model ...
Epoch: 6 cost time: 5.193758249282837
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.751 Vali Acc: 0.615 Test Loss: 0.751 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.254459619522095
Epoch: 7, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.783 Vali Acc: 0.615 Test Loss: 0.783 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.736615419387817
Epoch: 8, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.833 Vali Acc: 0.610 Test Loss: 0.833 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.072446346282959
Epoch: 9, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.151 Vali Acc: 0.517 Test Loss: 1.151 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.024094581604004
Epoch: 10, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.531 Vali Acc: 0.380 Test Loss: 1.531 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.979156970977783
Epoch: 11, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.314 Vali Acc: 0.478 Test Loss: 1.314 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.308255910873413
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.470 Vali Acc: 0.454 Test Loss: 1.470 Test Acc: 0.454
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.8446760177612305
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.117 Vali Acc: 0.620 Test Loss: 1.117 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.167448043823242
Epoch: 14, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.118 Vali Acc: 0.620 Test Loss: 1.118 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.019775390625
Epoch: 15, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.199 Vali Acc: 0.576 Test Loss: 1.199 Test Acc: 0.576
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.373164892196655
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.619 Vali Acc: 0.722 Test Loss: 0.619 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.674555063247681
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.919 Vali Acc: 0.327 Test Loss: 0.919 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.61346960067749
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.729 Vali Acc: 0.517 Test Loss: 0.729 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.208277463912964
Epoch: 4, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.623 Vali Acc: 0.663 Test Loss: 0.623 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.262885093688965
Epoch: 5, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.197476148605347
Epoch: 6, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.764 Vali Acc: 0.571 Test Loss: 0.764 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.185189723968506
Epoch: 7, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.747 Vali Acc: 0.595 Test Loss: 0.747 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.276262998580933
Epoch: 8, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.03461480140686
Epoch: 9, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.822 Vali Acc: 0.639 Test Loss: 0.822 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.173738241195679
Epoch: 10, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.306775093078613
Epoch: 11, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.042 Vali Acc: 0.624 Test Loss: 1.042 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 985346
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.674673795700073
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.638 Vali Acc: 0.712 Test Loss: 0.638 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.187546014785767
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 5.070378065109253
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 5.286640167236328
Epoch: 4, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.31608772277832
Epoch: 5, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.266048431396484
Epoch: 6, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.17504096031189
Epoch: 7, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.521748304367065
Epoch: 8, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.228092193603516
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.961 Vali Acc: 0.717 Test Loss: 0.961 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.970597982406616
Epoch: 10, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.524 Vali Acc: 0.717 Test Loss: 1.524 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.943954944610596
Epoch: 11, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.011 Vali Acc: 0.712 Test Loss: 1.011 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.54416036605835
Epoch: 12, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.092 Vali Acc: 0.707 Test Loss: 1.092 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.875444650650024
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.970 Vali Acc: 0.678 Test Loss: 0.970 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.318393707275391
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.8890509605407715
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 5.184590101242065
Epoch: 3, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.583 Vali Acc: 0.712 Test Loss: 0.583 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.42132568359375
Epoch: 4, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.693 Vali Acc: 0.722 Test Loss: 0.693 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.127815008163452
Epoch: 5, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.673 Vali Acc: 0.741 Test Loss: 0.673 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 5.179493427276611
Epoch: 6, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.821 Vali Acc: 0.741 Test Loss: 0.821 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.967058897018433
Epoch: 7, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.869 Vali Acc: 0.746 Test Loss: 0.869 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746333).  Saving model ...
Epoch: 8 cost time: 4.864690542221069
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.808 Vali Acc: 0.722 Test Loss: 0.808 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.729978799819946
Epoch: 9, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.012 Vali Acc: 0.737 Test Loss: 1.012 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.19441556930542
Epoch: 10, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.496 Vali Acc: 0.717 Test Loss: 1.496 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.895556926727295
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.184 Vali Acc: 0.741 Test Loss: 1.184 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.826061487197876
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.170 Vali Acc: 0.737 Test Loss: 1.170 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.816523313522339
Epoch: 13, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.086 Vali Acc: 0.634 Test Loss: 1.086 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.80078649520874
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.122 Vali Acc: 0.712 Test Loss: 1.122 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.847726345062256
Epoch: 15, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.148 Vali Acc: 0.634 Test Loss: 1.148 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.103265285491943
Epoch: 16, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.201 Vali Acc: 0.707 Test Loss: 1.201 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.246264934539795
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.248 Vali Acc: 0.722 Test Loss: 1.248 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.699971914291382
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.372310638427734
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.606 Vali Acc: 0.698 Test Loss: 0.606 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.872330665588379
Epoch: 3, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.999135255813599
Epoch: 4, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.695 Vali Acc: 0.741 Test Loss: 0.695 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741456).  Saving model ...
Epoch: 5 cost time: 5.219332695007324
Epoch: 5, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.693 Vali Acc: 0.737 Test Loss: 0.693 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.221346855163574
Epoch: 6, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.794 Vali Acc: 0.722 Test Loss: 0.794 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.093745708465576
Epoch: 7, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.192 Vali Acc: 0.737 Test Loss: 1.192 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.277550458908081
Epoch: 8, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.921 Vali Acc: 0.727 Test Loss: 0.921 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.639589548110962
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.862 Vali Acc: 0.712 Test Loss: 0.862 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.221296072006226
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.264 Vali Acc: 0.737 Test Loss: 1.264 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.145799160003662
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.075 Vali Acc: 0.722 Test Loss: 1.075 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.3645806312561035
Epoch: 12, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.084 Vali Acc: 0.717 Test Loss: 1.084 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.1125571727752686
Epoch: 13, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.078 Vali Acc: 0.663 Test Loss: 1.078 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.5477025508880615
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.155 Vali Acc: 0.722 Test Loss: 1.155 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.928467273712158
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.419631004333496
Epoch: 2, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 5.339313983917236
Epoch: 3, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.113036394119263
Epoch: 4, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.1903510093688965
Epoch: 5, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 5.078993082046509
Epoch: 6, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.800 Vali Acc: 0.722 Test Loss: 0.800 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.997681617736816
Epoch: 7, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.051 Vali Acc: 0.717 Test Loss: 1.051 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.899905681610107
Epoch: 8, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.097223281860352
Epoch: 9, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.813 Vali Acc: 0.698 Test Loss: 0.813 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.187357664108276
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.330 Vali Acc: 0.732 Test Loss: 1.330 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.02545690536499
Epoch: 11, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.142 Vali Acc: 0.746 Test Loss: 1.142 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746330).  Saving model ...
Epoch: 12 cost time: 4.852224111557007
Epoch: 12, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.975 Vali Acc: 0.688 Test Loss: 0.975 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.248418092727661
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.023 Vali Acc: 0.688 Test Loss: 1.023 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.954514026641846
Epoch: 14, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.156 Vali Acc: 0.722 Test Loss: 1.156 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.910290002822876
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.065 Vali Acc: 0.654 Test Loss: 1.065 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.744866847991943
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.150 Vali Acc: 0.698 Test Loss: 1.150 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.233551263809204
Epoch: 17, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.171 Vali Acc: 0.707 Test Loss: 1.171 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.02047324180603
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.245 Vali Acc: 0.722 Test Loss: 1.245 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.620237112045288
Epoch: 19, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.264 Vali Acc: 0.717 Test Loss: 1.264 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.104280948638916
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.235 Vali Acc: 0.693 Test Loss: 1.235 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.227270603179932
Epoch: 21, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.245 Vali Acc: 0.683 Test Loss: 1.245 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.611765623092651
Epoch: 1, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.621 Vali Acc: 0.717 Test Loss: 0.621 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.9162819385528564
Epoch: 2, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.548 Vali Acc: 0.756 Test Loss: 0.548 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 5.328895330429077
Epoch: 3, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.582 Vali Acc: 0.746 Test Loss: 0.582 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.893808841705322
Epoch: 4, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.609 Vali Acc: 0.746 Test Loss: 0.609 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.47817063331604
Epoch: 5, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.439954996109009
Epoch: 6, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.870 Vali Acc: 0.737 Test Loss: 0.870 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.702801465988159
Epoch: 7, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.075 Vali Acc: 0.737 Test Loss: 1.075 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.17594051361084
Epoch: 8, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.880 Vali Acc: 0.732 Test Loss: 0.880 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.345982789993286
Epoch: 9, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.836 Vali Acc: 0.732 Test Loss: 0.836 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.873236417770386
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.296 Vali Acc: 0.741 Test Loss: 1.296 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.995754957199097
Epoch: 11, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.169 Vali Acc: 0.741 Test Loss: 1.169 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.944982290267944
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.201 Vali Acc: 0.737 Test Loss: 1.201 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.842836856842041
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.668 Vali Acc: 0.722 Test Loss: 0.668 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.878674030303955
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.886950492858887
Epoch: 3, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.757 Vali Acc: 0.727 Test Loss: 0.757 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8210835456848145
Epoch: 4, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.886 Vali Acc: 0.727 Test Loss: 0.886 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.069093704223633
Epoch: 5, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.626 Vali Acc: 0.702 Test Loss: 0.626 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.884649991989136
Epoch: 6, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.686 Vali Acc: 0.746 Test Loss: 0.686 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.848515033721924
Epoch: 7, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.059 Vali Acc: 0.741 Test Loss: 1.059 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.9027626514434814
Epoch: 8, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.852 Vali Acc: 0.746 Test Loss: 0.852 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.7995476722717285
Epoch: 9, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.815 Vali Acc: 0.693 Test Loss: 0.815 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.863385915756226
Epoch: 10, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.098 Vali Acc: 0.746 Test Loss: 1.098 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.63431191444397
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.980 Vali Acc: 0.737 Test Loss: 0.980 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.083162307739258
Epoch: 12, Steps: 13 | Train Loss: 0.013 Vali Loss: 0.998 Vali Acc: 0.727 Test Loss: 0.998 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.847305059432983
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.2376508712768555
Epoch: 2, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 5.131810665130615
Epoch: 3, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.709 Vali Acc: 0.722 Test Loss: 0.709 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.730512380599976
Epoch: 4, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.608848571777344
Epoch: 5, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.616 Vali Acc: 0.732 Test Loss: 0.616 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 4.844489812850952
Epoch: 6, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.789 Vali Acc: 0.707 Test Loss: 0.789 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.820149898529053
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.862 Vali Acc: 0.702 Test Loss: 0.862 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.835636615753174
Epoch: 8, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.884 Vali Acc: 0.732 Test Loss: 0.884 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.10943603515625
Epoch: 9, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.019 Vali Acc: 0.717 Test Loss: 1.019 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.148835182189941
Epoch: 10, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.292 Vali Acc: 0.717 Test Loss: 1.292 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.39616584777832
Epoch: 11, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.262 Vali Acc: 0.712 Test Loss: 1.262 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.0656962394714355
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.095 Vali Acc: 0.732 Test Loss: 1.095 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.071593999862671
Epoch: 13, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.356 Vali Acc: 0.712 Test Loss: 1.356 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.1082658767700195
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.297 Vali Acc: 0.722 Test Loss: 1.297 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.741203546524048
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 0.951 Vali Acc: 0.717 Test Loss: 0.951 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.230174541473389
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.983530044555664
Epoch: 2, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.4308390617370605
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.744 Vali Acc: 0.712 Test Loss: 0.744 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.158569574356079
Epoch: 4, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.850 Vali Acc: 0.712 Test Loss: 0.850 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.475443363189697
Epoch: 5, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.621 Vali Acc: 0.688 Test Loss: 0.621 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.3318772315979
Epoch: 6, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.798 Vali Acc: 0.712 Test Loss: 0.798 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.872757911682129
Epoch: 7, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.180 Vali Acc: 0.712 Test Loss: 1.180 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.047333240509033
Epoch: 8, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.799638032913208
Epoch: 9, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.885 Vali Acc: 0.688 Test Loss: 0.885 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.877238750457764
Epoch: 10, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.423 Vali Acc: 0.722 Test Loss: 1.423 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.328569650650024
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.196 Vali Acc: 0.702 Test Loss: 1.196 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.520309209823608
Epoch: 12, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.036 Vali Acc: 0.712 Test Loss: 1.036 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.833089113235474
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.736 Vali Acc: 0.722 Test Loss: 0.736 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 5.1013453006744385
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.706 Vali Acc: 0.522 Test Loss: 0.706 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.230894327163696
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.637 Vali Acc: 0.727 Test Loss: 0.637 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 5.065882921218872
Epoch: 4, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.714902400970459
Epoch: 5, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.922 Vali Acc: 0.424 Test Loss: 0.922 Test Acc: 0.424
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.624685525894165
Epoch: 6, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.783 Vali Acc: 0.576 Test Loss: 0.783 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.731790542602539
Epoch: 7, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.819 Vali Acc: 0.698 Test Loss: 0.819 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.639591217041016
Epoch: 8, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.869 Vali Acc: 0.644 Test Loss: 0.869 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.685821771621704
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.439 Vali Acc: 0.410 Test Loss: 1.439 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.9959588050842285
Epoch: 10, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.027 Vali Acc: 0.610 Test Loss: 1.027 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.988203763961792
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.077 Vali Acc: 0.610 Test Loss: 1.077 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.099801540374756
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.112 Vali Acc: 0.683 Test Loss: 1.112 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.008103132247925
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.134 Vali Acc: 0.688 Test Loss: 1.134 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.491159915924072
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 4.557190656661987
Epoch: 2, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.806 Vali Acc: 0.400 Test Loss: 0.806 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.737212181091309
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (-0.721943 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.81491231918335
Epoch: 4, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.856165170669556
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.595 Vali Acc: 0.273 Test Loss: 1.595 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.6560633182525635
Epoch: 6, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.162 Vali Acc: 0.332 Test Loss: 1.162 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.18700098991394
Epoch: 7, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.750 Vali Acc: 0.585 Test Loss: 0.750 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.024494409561157
Epoch: 8, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.928 Vali Acc: 0.502 Test Loss: 0.928 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.009594678878784
Epoch: 9, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.582 Vali Acc: 0.366 Test Loss: 1.582 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.8639843463897705
Epoch: 10, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.891 Vali Acc: 0.693 Test Loss: 0.891 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.9693968296051025
Epoch: 11, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.021177768707275
Epoch: 12, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.088 Vali Acc: 0.712 Test Loss: 1.088 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.589725971221924
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.428 Vali Acc: 0.707 Test Loss: 1.428 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 887042
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.516091585159302
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.919207334518433
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.652 Vali Acc: 0.659 Test Loss: 0.652 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.914000749588013
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.575 Vali Acc: 0.698 Test Loss: 0.575 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.2068939208984375
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.1287267208099365
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 4.86295485496521
Epoch: 6, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.0572545528411865
Epoch: 7, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.809 Vali Acc: 0.727 Test Loss: 0.809 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.1133646965026855
Epoch: 8, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.680 Vali Acc: 0.702 Test Loss: 0.680 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.177800416946411
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.735 Vali Acc: 0.702 Test Loss: 0.735 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.886040210723877
Epoch: 10, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.799 Vali Acc: 0.644 Test Loss: 0.799 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.694707155227661
Epoch: 11, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.837 Vali Acc: 0.683 Test Loss: 0.837 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.272242069244385
Epoch: 12, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.944 Vali Acc: 0.629 Test Loss: 0.944 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.842206954956055
Epoch: 13, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.981 Vali Acc: 0.683 Test Loss: 0.981 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.103312969207764
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.116 Vali Acc: 0.727 Test Loss: 1.116 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.214136123657227
Epoch: 15, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.206 Vali Acc: 0.712 Test Loss: 1.206 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.016725063323975
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.515025615692139
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.634 Vali Acc: 0.668 Test Loss: 0.634 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.278808116912842
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.579 Vali Acc: 0.702 Test Loss: 0.579 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.094852924346924
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.610 Vali Acc: 0.688 Test Loss: 0.610 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.836669921875
Epoch: 5, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.619 Vali Acc: 0.712 Test Loss: 0.619 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.685893774032593
Epoch: 6, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.895 Vali Acc: 0.741 Test Loss: 0.895 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741454).  Saving model ...
Epoch: 7 cost time: 4.882235527038574
Epoch: 7, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.687 Vali Acc: 0.678 Test Loss: 0.687 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.1015448570251465
Epoch: 8, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.844 Vali Acc: 0.590 Test Loss: 0.844 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.814926385879517
Epoch: 9, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.819 Vali Acc: 0.639 Test Loss: 0.819 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.188441514968872
Epoch: 10, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.873 Vali Acc: 0.644 Test Loss: 0.873 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.1954615116119385
Epoch: 11, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.924 Vali Acc: 0.659 Test Loss: 0.924 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.391946315765381
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.931 Vali Acc: 0.668 Test Loss: 0.931 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.367904186248779
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.027 Vali Acc: 0.693 Test Loss: 1.027 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.540348291397095
Epoch: 14, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.203 Vali Acc: 0.737 Test Loss: 1.203 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.291379928588867
Epoch: 15, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.199 Vali Acc: 0.707 Test Loss: 1.199 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.638355493545532
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.291 Vali Acc: 0.722 Test Loss: 1.291 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.279695510864258
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.381472110748291
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.624 Vali Acc: 0.659 Test Loss: 0.624 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5418901443481445
Epoch: 3, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 5.386716365814209
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.467886686325073
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.174187660217285
Epoch: 6, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.955 Vali Acc: 0.741 Test Loss: 0.955 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741454).  Saving model ...
Epoch: 7 cost time: 5.328201532363892
Epoch: 7, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.693 Vali Acc: 0.722 Test Loss: 0.693 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.9499733448028564
Epoch: 8, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.744 Vali Acc: 0.698 Test Loss: 0.744 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.9862380027771
Epoch: 9, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.830 Vali Acc: 0.678 Test Loss: 0.830 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.963379621505737
Epoch: 10, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.060 Vali Acc: 0.546 Test Loss: 1.060 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.559177398681641
Epoch: 11, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.979 Vali Acc: 0.610 Test Loss: 0.979 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.687270641326904
Epoch: 12, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.034 Vali Acc: 0.590 Test Loss: 1.034 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.294020414352417
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.006 Vali Acc: 0.663 Test Loss: 1.006 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.42955756187439
Epoch: 14, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.041 Vali Acc: 0.693 Test Loss: 1.041 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.26024317741394
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.084 Vali Acc: 0.688 Test Loss: 1.084 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.1056067943573
Epoch: 16, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.267 Vali Acc: 0.727 Test Loss: 1.267 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.253544092178345
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.464174032211304
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.637 Vali Acc: 0.659 Test Loss: 0.637 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.269101619720459
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.589 Vali Acc: 0.707 Test Loss: 0.589 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.586996793746948
Epoch: 4, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.608 Vali Acc: 0.683 Test Loss: 0.608 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.594591856002808
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.647 Vali Acc: 0.634 Test Loss: 0.647 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.442534923553467
Epoch: 6, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.782 Vali Acc: 0.698 Test Loss: 0.782 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.118199825286865
Epoch: 7, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.752 Vali Acc: 0.610 Test Loss: 0.752 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.4612367153167725
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.795 Vali Acc: 0.634 Test Loss: 0.795 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.25150465965271
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.828 Vali Acc: 0.678 Test Loss: 0.828 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.302072525024414
Epoch: 10, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.957 Vali Acc: 0.571 Test Loss: 0.957 Test Acc: 0.571
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.358132600784302
Epoch: 11, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.148914337158203
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.081273794174194
Epoch: 2, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.364370346069336
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 5.204404830932617
Epoch: 4, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.140881061553955
Epoch: 5, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.4331138134002686
Epoch: 6, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.883 Vali Acc: 0.737 Test Loss: 0.883 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.233468294143677
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.751 Vali Acc: 0.727 Test Loss: 0.751 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.117115020751953
Epoch: 8, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.759 Vali Acc: 0.698 Test Loss: 0.759 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.343073844909668
Epoch: 9, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.826 Vali Acc: 0.712 Test Loss: 0.826 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.998110771179199
Epoch: 10, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.850 Vali Acc: 0.698 Test Loss: 0.850 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.292443513870239
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.947 Vali Acc: 0.698 Test Loss: 0.947 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.033564567565918
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.942 Vali Acc: 0.698 Test Loss: 0.942 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.92887544631958
Epoch: 13, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.008 Vali Acc: 0.712 Test Loss: 1.008 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.551434755325317
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.602 Vali Acc: 0.712 Test Loss: 0.602 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.962693691253662
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.583 Vali Acc: 0.707 Test Loss: 0.583 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.221819639205933
Epoch: 3, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.588 Vali Acc: 0.707 Test Loss: 0.588 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.404019355773926
Epoch: 4, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.628 Vali Acc: 0.712 Test Loss: 0.628 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.567717790603638
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.710 Vali Acc: 0.722 Test Loss: 0.710 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721944).  Saving model ...
Epoch: 6 cost time: 5.3158464431762695
Epoch: 6, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.815 Vali Acc: 0.727 Test Loss: 0.815 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726821).  Saving model ...
Epoch: 7 cost time: 5.1550469398498535
Epoch: 7, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.719 Vali Acc: 0.727 Test Loss: 0.719 Test Acc: 0.727
Validation loss decreased (-0.726821 --> -0.726822).  Saving model ...
Epoch: 8 cost time: 5.525890111923218
Epoch: 8, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.766 Vali Acc: 0.707 Test Loss: 0.766 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.298134088516235
Epoch: 9, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.896 Vali Acc: 0.756 Test Loss: 0.896 Test Acc: 0.756
Validation loss decreased (-0.726822 --> -0.756089).  Saving model ...
Epoch: 10 cost time: 5.469562530517578
Epoch: 10, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.871 Vali Acc: 0.698 Test Loss: 0.871 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.5647242069244385
Epoch: 11, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.936 Vali Acc: 0.702 Test Loss: 0.936 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.221071481704712
Epoch: 12, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.990 Vali Acc: 0.659 Test Loss: 0.990 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.433283805847168
Epoch: 13, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.051 Vali Acc: 0.668 Test Loss: 1.051 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.972386121749878
Epoch: 14, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.163 Vali Acc: 0.678 Test Loss: 1.163 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.911023139953613
Epoch: 15, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.174 Vali Acc: 0.678 Test Loss: 1.174 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.9754486083984375
Epoch: 16, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.267 Vali Acc: 0.702 Test Loss: 1.267 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.36378288269043
Epoch: 17, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.346 Vali Acc: 0.732 Test Loss: 1.346 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.329131603240967
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.271 Vali Acc: 0.702 Test Loss: 1.271 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.3285229206085205
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.412 Vali Acc: 0.732 Test Loss: 1.412 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.0990376472473145
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.120423793792725
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.744854688644409
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.147963285446167
Epoch: 4, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.775 Vali Acc: 0.722 Test Loss: 0.775 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.933161497116089
Epoch: 5, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.765 Vali Acc: 0.707 Test Loss: 0.765 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.26864767074585
Epoch: 6, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.873 Vali Acc: 0.702 Test Loss: 0.873 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.368006944656372
Epoch: 7, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.783 Vali Acc: 0.693 Test Loss: 0.783 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.141661167144775
Epoch: 8, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.752 Vali Acc: 0.707 Test Loss: 0.752 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.154099225997925
Epoch: 9, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.949 Vali Acc: 0.698 Test Loss: 0.949 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.0257017612457275
Epoch: 10, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.841 Vali Acc: 0.712 Test Loss: 0.841 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.827052593231201
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.902 Vali Acc: 0.702 Test Loss: 0.902 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.689739227294922
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.925 Vali Acc: 0.698 Test Loss: 0.925 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.87586522102356
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.412465810775757
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.038558721542358
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.640 Vali Acc: 0.717 Test Loss: 0.640 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.466055393218994
Epoch: 4, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.694 Vali Acc: 0.722 Test Loss: 0.694 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.464284896850586
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.767 Vali Acc: 0.712 Test Loss: 0.767 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.128100156784058
Epoch: 6, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.249781370162964
Epoch: 7, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.674 Vali Acc: 0.732 Test Loss: 0.674 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 8 cost time: 5.0952348709106445
Epoch: 8, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.670 Vali Acc: 0.693 Test Loss: 0.670 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.033785104751587
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.824 Vali Acc: 0.727 Test Loss: 0.824 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.5015599727630615
Epoch: 10, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.836 Vali Acc: 0.741 Test Loss: 0.836 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741455).  Saving model ...
Epoch: 11 cost time: 5.591020584106445
Epoch: 11, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.214236259460449
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.922 Vali Acc: 0.717 Test Loss: 0.922 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.172925233840942
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.029 Vali Acc: 0.722 Test Loss: 1.029 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.239375591278076
Epoch: 14, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.016 Vali Acc: 0.707 Test Loss: 1.016 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.343544006347656
Epoch: 15, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.243 Vali Acc: 0.702 Test Loss: 1.243 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.911263704299927
Epoch: 16, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.174 Vali Acc: 0.712 Test Loss: 1.174 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.47211766242981
Epoch: 17, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.245 Vali Acc: 0.707 Test Loss: 1.245 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.04733943939209
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.120 Vali Acc: 0.712 Test Loss: 1.120 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.062706232070923
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.290 Vali Acc: 0.712 Test Loss: 1.290 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.140930652618408
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.307 Vali Acc: 0.702 Test Loss: 1.307 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.2837584018707275
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.351428747177124
Epoch: 2, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.763 Vali Acc: 0.405 Test Loss: 0.763 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.483754396438599
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.352651596069336
Epoch: 4, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.654 Vali Acc: 0.649 Test Loss: 0.654 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.131993532180786
Epoch: 5, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.904667139053345
Epoch: 6, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.652 Vali Acc: 0.698 Test Loss: 0.652 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.8462233543396
Epoch: 7, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.895 Vali Acc: 0.429 Test Loss: 0.895 Test Acc: 0.429
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.949913263320923
Epoch: 8, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.788 Vali Acc: 0.546 Test Loss: 0.788 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.2877843379974365
Epoch: 9, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.852 Vali Acc: 0.722 Test Loss: 0.852 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.578208923339844
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.912 Vali Acc: 0.512 Test Loss: 0.912 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.593662977218628
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.388 Vali Acc: 0.380 Test Loss: 1.388 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.92727518081665
Epoch: 1, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.649 Vali Acc: 0.722 Test Loss: 0.649 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.83963680267334
Epoch: 2, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.726 Vali Acc: 0.512 Test Loss: 0.726 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.721956729888916
Epoch: 3, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.616 Vali Acc: 0.702 Test Loss: 0.616 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.806339263916016
Epoch: 4, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.724 Vali Acc: 0.507 Test Loss: 0.724 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.7776899337768555
Epoch: 5, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 4.6875200271606445
Epoch: 6, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.790 Vali Acc: 0.473 Test Loss: 0.790 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.912760496139526
Epoch: 7, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.000 Vali Acc: 0.376 Test Loss: 1.000 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.047412633895874
Epoch: 8, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.722 Vali Acc: 0.590 Test Loss: 0.722 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.06238055229187
Epoch: 9, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.641 Vali Acc: 0.741 Test Loss: 0.641 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 10 cost time: 5.048543453216553
Epoch: 10, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.972 Vali Acc: 0.512 Test Loss: 0.972 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.747018098831177
Epoch: 11, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.301 Vali Acc: 0.439 Test Loss: 1.301 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.0120790004730225
Epoch: 12, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.777948617935181
Epoch: 13, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.931 Vali Acc: 0.673 Test Loss: 0.931 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.446108102798462
Epoch: 14, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.054 Vali Acc: 0.639 Test Loss: 1.054 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.582799196243286
Epoch: 15, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.948 Vali Acc: 0.678 Test Loss: 0.948 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.71357536315918
Epoch: 16, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.006 Vali Acc: 0.678 Test Loss: 1.006 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.820963621139526
Epoch: 17, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.060 Vali Acc: 0.702 Test Loss: 1.060 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.0461931228637695
Epoch: 18, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.165 Vali Acc: 0.659 Test Loss: 1.165 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.012786626815796
Epoch: 19, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.146 Vali Acc: 0.707 Test Loss: 1.146 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1016962
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.245180368423462
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.583742618560791
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.250865697860718
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.786 Vali Acc: 0.717 Test Loss: 0.786 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.306779384613037
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.683 Vali Acc: 0.732 Test Loss: 0.683 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731700).  Saving model ...
Epoch: 5 cost time: 5.333715200424194
Epoch: 5, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.626 Vali Acc: 0.727 Test Loss: 0.626 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.208368301391602
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.080051422119141
Epoch: 7, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.918696641921997
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.725 Vali Acc: 0.732 Test Loss: 0.725 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.48486852645874
Epoch: 9, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.880 Vali Acc: 0.732 Test Loss: 0.880 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.751152276992798
Epoch: 10, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.902 Vali Acc: 0.737 Test Loss: 0.902 Test Acc: 0.737
Validation loss decreased (-0.731700 --> -0.736576).  Saving model ...
Epoch: 11 cost time: 5.807358026504517
Epoch: 11, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.833 Vali Acc: 0.698 Test Loss: 0.833 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.6139976978302
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.943 Vali Acc: 0.732 Test Loss: 0.943 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.2149224281311035
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.047 Vali Acc: 0.737 Test Loss: 1.047 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.870853424072266
Epoch: 14, Steps: 13 | Train Loss: 0.023 Vali Loss: 0.973 Vali Acc: 0.683 Test Loss: 0.973 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.995465278625488
Epoch: 15, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.034 Vali Acc: 0.683 Test Loss: 1.034 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.204110860824585
Epoch: 16, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.159 Vali Acc: 0.712 Test Loss: 1.159 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.006412982940674
Epoch: 17, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.047 Vali Acc: 0.673 Test Loss: 1.047 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.018127202987671
Epoch: 18, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.210 Vali Acc: 0.702 Test Loss: 1.210 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.561716079711914
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.213 Vali Acc: 0.693 Test Loss: 1.213 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.352646350860596
Epoch: 20, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.139 Vali Acc: 0.683 Test Loss: 1.139 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.615171909332275
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.772610902786255
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.9300220012664795
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.778 Vali Acc: 0.722 Test Loss: 0.778 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.866605281829834
Epoch: 4, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.712 Vali Acc: 0.732 Test Loss: 0.712 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731700).  Saving model ...
Epoch: 5 cost time: 4.875473737716675
Epoch: 5, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.670 Vali Acc: 0.732 Test Loss: 0.670 Test Acc: 0.732
Validation loss decreased (-0.731700 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 4.7595765590667725
Epoch: 6, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.623 Vali Acc: 0.712 Test Loss: 0.623 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.644874572753906
Epoch: 7, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 5.250569820404053
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.734 Vali Acc: 0.737 Test Loss: 0.734 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.7076568603515625
Epoch: 9, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.847 Vali Acc: 0.741 Test Loss: 0.847 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741455).  Saving model ...
Epoch: 10 cost time: 5.3374669551849365
Epoch: 10, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.929 Vali Acc: 0.751 Test Loss: 0.929 Test Acc: 0.751
Validation loss decreased (-0.741455 --> -0.751210).  Saving model ...
Epoch: 11 cost time: 5.189958333969116
Epoch: 11, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.957 Vali Acc: 0.722 Test Loss: 0.957 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.46979022026062
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.087 Vali Acc: 0.727 Test Loss: 1.087 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.077704668045044
Epoch: 13, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.144 Vali Acc: 0.727 Test Loss: 1.144 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.160336017608643
Epoch: 14, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.060 Vali Acc: 0.707 Test Loss: 1.060 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.924056053161621
Epoch: 15, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.096 Vali Acc: 0.717 Test Loss: 1.096 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.078480958938599
Epoch: 16, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.257 Vali Acc: 0.722 Test Loss: 1.257 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.448957443237305
Epoch: 17, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.125 Vali Acc: 0.698 Test Loss: 1.125 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.349776029586792
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.323 Vali Acc: 0.727 Test Loss: 1.323 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.3536458015441895
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.276 Vali Acc: 0.722 Test Loss: 1.276 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.720114707946777
Epoch: 20, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.207 Vali Acc: 0.688 Test Loss: 1.207 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.462332725524902
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.985594034194946
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.663 Vali Acc: 0.722 Test Loss: 0.663 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.759962558746338
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.718 Vali Acc: 0.732 Test Loss: 0.718 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731700).  Saving model ...
Epoch: 4 cost time: 5.2813804149627686
Epoch: 4, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.702 Vali Acc: 0.732 Test Loss: 0.702 Test Acc: 0.732
Validation loss decreased (-0.731700 --> -0.731700).  Saving model ...
Epoch: 5 cost time: 4.720522880554199
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
Validation loss decreased (-0.731700 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 5.2276833057403564
Epoch: 6, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.657 Vali Acc: 0.722 Test Loss: 0.657 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.369939804077148
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.700 Vali Acc: 0.722 Test Loss: 0.700 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.361215829849243
Epoch: 8, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.790 Vali Acc: 0.741 Test Loss: 0.790 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741456).  Saving model ...
Epoch: 9 cost time: 5.465087652206421
Epoch: 9, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.914 Vali Acc: 0.732 Test Loss: 0.914 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.448867082595825
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.914 Vali Acc: 0.722 Test Loss: 0.914 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.7010486125946045
Epoch: 11, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.987 Vali Acc: 0.722 Test Loss: 0.987 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.297203540802002
Epoch: 12, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.023 Vali Acc: 0.722 Test Loss: 1.023 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.1925811767578125
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.131 Vali Acc: 0.722 Test Loss: 1.131 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.079124927520752
Epoch: 14, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.106 Vali Acc: 0.698 Test Loss: 1.106 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.977667570114136
Epoch: 15, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.152 Vali Acc: 0.712 Test Loss: 1.152 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.143913269042969
Epoch: 16, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.159 Vali Acc: 0.717 Test Loss: 1.159 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.352213144302368
Epoch: 17, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.097 Vali Acc: 0.663 Test Loss: 1.097 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.321136236190796
Epoch: 18, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.247 Vali Acc: 0.717 Test Loss: 1.247 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.122177600860596
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.4667768478393555
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.143184185028076
Epoch: 3, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.988007307052612
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.712 Vali Acc: 0.722 Test Loss: 0.712 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.866748094558716
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.764 Vali Acc: 0.717 Test Loss: 0.764 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.199850797653198
Epoch: 6, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.686 Vali Acc: 0.707 Test Loss: 0.686 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.196728467941284
Epoch: 7, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.732 Vali Acc: 0.702 Test Loss: 0.732 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.323742866516113
Epoch: 8, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.746 Vali Acc: 0.688 Test Loss: 0.746 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.087055921554565
Epoch: 9, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.886 Vali Acc: 0.702 Test Loss: 0.886 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.277270793914795
Epoch: 10, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.139 Vali Acc: 0.717 Test Loss: 1.139 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.237630844116211
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.173 Vali Acc: 0.717 Test Loss: 1.173 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.369506359100342
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.922076463699341
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.045532941818237
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.708 Vali Acc: 0.741 Test Loss: 0.708 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741456).  Saving model ...
Epoch: 4 cost time: 4.9598822593688965
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.678 Vali Acc: 0.751 Test Loss: 0.678 Test Acc: 0.751
Validation loss decreased (-0.741456 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 5.050488471984863
Epoch: 5, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.618 Vali Acc: 0.746 Test Loss: 0.618 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.51450514793396
Epoch: 6, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.637 Vali Acc: 0.727 Test Loss: 0.637 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.338415145874023
Epoch: 7, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.679 Vali Acc: 0.722 Test Loss: 0.679 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.615347623825073
Epoch: 8, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.618929624557495
Epoch: 9, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.817 Vali Acc: 0.727 Test Loss: 0.817 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.748916864395142
Epoch: 10, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.974 Vali Acc: 0.732 Test Loss: 0.974 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.427394151687622
Epoch: 11, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.069 Vali Acc: 0.727 Test Loss: 1.069 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.146255016326904
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.989 Vali Acc: 0.727 Test Loss: 0.989 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.600710391998291
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.092 Vali Acc: 0.727 Test Loss: 1.092 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.079926490783691
Epoch: 14, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.060 Vali Acc: 0.722 Test Loss: 1.060 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.005289554595947
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.709894180297852
Epoch: 2, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 5.421880722045898
Epoch: 3, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.664 Vali Acc: 0.722 Test Loss: 0.664 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 5.379112958908081
Epoch: 4, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.0328028202056885
Epoch: 5, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 5.093008279800415
Epoch: 6, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.612 Vali Acc: 0.732 Test Loss: 0.612 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.2830140590667725
Epoch: 7, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.0336408615112305
Epoch: 8, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.784 Vali Acc: 0.746 Test Loss: 0.784 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746334).  Saving model ...
Epoch: 9 cost time: 4.779216051101685
Epoch: 9, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.834 Vali Acc: 0.732 Test Loss: 0.834 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.401600122451782
Epoch: 10, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.904 Vali Acc: 0.746 Test Loss: 0.904 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.910806894302368
Epoch: 11, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.042 Vali Acc: 0.741 Test Loss: 1.042 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.153551816940308
Epoch: 12, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.052 Vali Acc: 0.741 Test Loss: 1.052 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.419727325439453
Epoch: 13, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.129 Vali Acc: 0.737 Test Loss: 1.129 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.170021295547485
Epoch: 14, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.191 Vali Acc: 0.737 Test Loss: 1.191 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.116149425506592
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.188 Vali Acc: 0.727 Test Loss: 1.188 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.227797031402588
Epoch: 16, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.195 Vali Acc: 0.732 Test Loss: 1.195 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.736883163452148
Epoch: 17, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.180 Vali Acc: 0.712 Test Loss: 1.180 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.980254173278809
Epoch: 18, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.377 Vali Acc: 0.737 Test Loss: 1.377 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.762120008468628
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.279714345932007
Epoch: 2, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.656018257141113
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.868324041366577
Epoch: 4, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.660 Vali Acc: 0.717 Test Loss: 0.660 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.646815061569214
Epoch: 5, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 5.75817608833313
Epoch: 6, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.638 Vali Acc: 0.722 Test Loss: 0.638 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.298420190811157
Epoch: 7, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736578).  Saving model ...
Epoch: 8 cost time: 5.504863500595093
Epoch: 8, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.715 Vali Acc: 0.727 Test Loss: 0.715 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.092739820480347
Epoch: 9, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.931 Vali Acc: 0.707 Test Loss: 0.931 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.025379419326782
Epoch: 10, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.112 Vali Acc: 0.717 Test Loss: 1.112 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.598164319992065
Epoch: 11, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.201 Vali Acc: 0.712 Test Loss: 1.201 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.9007203578948975
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.203 Vali Acc: 0.712 Test Loss: 1.203 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.7089149951934814
Epoch: 13, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.367 Vali Acc: 0.722 Test Loss: 1.367 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.88751220703125
Epoch: 14, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.068 Vali Acc: 0.712 Test Loss: 1.068 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.4047887325286865
Epoch: 15, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.345 Vali Acc: 0.722 Test Loss: 1.345 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.11277961730957
Epoch: 16, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.202 Vali Acc: 0.712 Test Loss: 1.202 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.692946910858154
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.121 Vali Acc: 0.717 Test Loss: 1.121 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.323420524597168
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.009914398193359
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.022622346878052
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.664 Vali Acc: 0.712 Test Loss: 0.664 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.735466003417969
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.642 Vali Acc: 0.712 Test Loss: 0.642 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.8394904136657715
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 4.970350980758667
Epoch: 6, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.99010968208313
Epoch: 7, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.677 Vali Acc: 0.727 Test Loss: 0.677 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.531619548797607
Epoch: 8, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.758 Vali Acc: 0.737 Test Loss: 0.758 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736578).  Saving model ...
Epoch: 9 cost time: 4.773651361465454
Epoch: 9, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.900 Vali Acc: 0.732 Test Loss: 0.900 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.833247423171997
Epoch: 10, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.064 Vali Acc: 0.732 Test Loss: 1.064 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.654664039611816
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.122 Vali Acc: 0.722 Test Loss: 1.122 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.620725393295288
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.134 Vali Acc: 0.727 Test Loss: 1.134 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.837468385696411
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.185 Vali Acc: 0.722 Test Loss: 1.185 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.704676389694214
Epoch: 14, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.157 Vali Acc: 0.707 Test Loss: 1.157 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.724775552749634
Epoch: 15, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.135 Vali Acc: 0.702 Test Loss: 1.135 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.570900917053223
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.181 Vali Acc: 0.707 Test Loss: 1.181 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.671800374984741
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.105 Vali Acc: 0.712 Test Loss: 1.105 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.947702169418335
Epoch: 18, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.530 Vali Acc: 0.712 Test Loss: 1.530 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.273883581161499
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.819353342056274
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.605 Vali Acc: 0.698 Test Loss: 0.605 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.7866833209991455
Epoch: 3, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 4.294102191925049
Epoch: 4, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.634 Vali Acc: 0.668 Test Loss: 0.634 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.239717245101929
Epoch: 5, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.669 Vali Acc: 0.624 Test Loss: 0.669 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.132505416870117
Epoch: 6, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.771443843841553
Epoch: 7, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.804 Vali Acc: 0.498 Test Loss: 0.804 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.620245456695557
Epoch: 8, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.726 Vali Acc: 0.624 Test Loss: 0.726 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.491384029388428
Epoch: 9, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.749 Vali Acc: 0.629 Test Loss: 0.749 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.887321949005127
Epoch: 10, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.771 Vali Acc: 0.663 Test Loss: 0.771 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.582711458206177
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.797 Vali Acc: 0.663 Test Loss: 0.797 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.757471323013306
Epoch: 12, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.823 Vali Acc: 0.668 Test Loss: 0.823 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.680028200149536
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.841 Vali Acc: 0.707 Test Loss: 0.841 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.111988544464111
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.596429824829102
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.562330722808838
Epoch: 3, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.546482801437378
Epoch: 4, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.618 Vali Acc: 0.688 Test Loss: 0.618 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.679857969284058
Epoch: 5, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.632 Vali Acc: 0.654 Test Loss: 0.632 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.983232736587524
Epoch: 6, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.720 Vali Acc: 0.566 Test Loss: 0.720 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.9418628215789795
Epoch: 7, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.719 Vali Acc: 0.566 Test Loss: 0.719 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.783596754074097
Epoch: 8, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.665 Vali Acc: 0.639 Test Loss: 0.665 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.096961498260498
Epoch: 9, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.695 Vali Acc: 0.610 Test Loss: 0.695 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.109555006027222
Epoch: 10, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.814 Vali Acc: 0.590 Test Loss: 0.814 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.798252820968628
Epoch: 11, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.806 Vali Acc: 0.624 Test Loss: 0.806 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 623746
model size : 4.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.397002220153809
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.744654655456543
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.716 Vali Acc: 0.717 Test Loss: 0.716 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.576396942138672
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.824535846710205
Epoch: 4, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.641 Vali Acc: 0.727 Test Loss: 0.641 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 5.106317758560181
Epoch: 5, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.737 Vali Acc: 0.732 Test Loss: 0.737 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731700).  Saving model ...
Epoch: 6 cost time: 4.900202989578247
Epoch: 6, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.670 Vali Acc: 0.722 Test Loss: 0.670 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.637074947357178
Epoch: 7, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.823758840560913
Epoch: 8, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.2160539627075195
Epoch: 9, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.795 Vali Acc: 0.722 Test Loss: 0.795 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.704436779022217
Epoch: 10, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.704 Vali Acc: 0.698 Test Loss: 0.704 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.482826232910156
Epoch: 11, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.766 Vali Acc: 0.698 Test Loss: 0.766 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.4556756019592285
Epoch: 12, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.843 Vali Acc: 0.702 Test Loss: 0.843 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.639201879501343
Epoch: 13, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.319 Vali Acc: 0.727 Test Loss: 1.319 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.6973817348480225
Epoch: 14, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.264 Vali Acc: 0.722 Test Loss: 1.264 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.867052316665649
Epoch: 15, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.166 Vali Acc: 0.722 Test Loss: 1.166 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.396255016326904
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.010117053985596
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.723 Vali Acc: 0.717 Test Loss: 0.723 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.724935293197632
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.671217918395996
Epoch: 4, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.442734956741333
Epoch: 5, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.333973407745361
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.674 Vali Acc: 0.732 Test Loss: 0.674 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.6550538539886475
Epoch: 7, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.712 Vali Acc: 0.727 Test Loss: 0.712 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.7070934772491455
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.784 Vali Acc: 0.722 Test Loss: 0.784 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.837115287780762
Epoch: 9, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.058 Vali Acc: 0.746 Test Loss: 1.058 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746331).  Saving model ...
Epoch: 10 cost time: 4.698249578475952
Epoch: 10, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.861 Vali Acc: 0.727 Test Loss: 0.861 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.859467029571533
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.826 Vali Acc: 0.732 Test Loss: 0.826 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.9886674880981445
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.866 Vali Acc: 0.732 Test Loss: 0.866 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.056098222732544
Epoch: 13, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.367 Vali Acc: 0.732 Test Loss: 1.367 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.754456520080566
Epoch: 14, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.331 Vali Acc: 0.746 Test Loss: 1.331 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.7982337474823
Epoch: 15, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.347 Vali Acc: 0.741 Test Loss: 1.347 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.673321008682251
Epoch: 16, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.144 Vali Acc: 0.722 Test Loss: 1.144 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.663393259048462
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.159 Vali Acc: 0.717 Test Loss: 1.159 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.378134489059448
Epoch: 18, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.169 Vali Acc: 0.722 Test Loss: 1.169 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.759727478027344
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.180 Vali Acc: 0.722 Test Loss: 1.180 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.348174810409546
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.759349346160889
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.703 Vali Acc: 0.722 Test Loss: 0.703 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.624690771102905
Epoch: 3, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.543449401855469
Epoch: 4, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 4.446805953979492
Epoch: 5, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.798 Vali Acc: 0.741 Test Loss: 0.798 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.587363958358765
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.615282773971558
Epoch: 7, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.712 Vali Acc: 0.741 Test Loss: 0.712 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.306340217590332
Epoch: 8, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.789 Vali Acc: 0.741 Test Loss: 0.789 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.80350399017334
Epoch: 9, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.030 Vali Acc: 0.746 Test Loss: 1.030 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.864543437957764
Epoch: 10, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.903 Vali Acc: 0.717 Test Loss: 0.903 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.5059497356414795
Epoch: 11, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.916 Vali Acc: 0.727 Test Loss: 0.916 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.945582151412964
Epoch: 12, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.829 Vali Acc: 0.688 Test Loss: 0.829 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.936865329742432
Epoch: 13, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.103 Vali Acc: 0.727 Test Loss: 1.103 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.576580047607422
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.215 Vali Acc: 0.722 Test Loss: 1.215 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.750757932662964
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.155400037765503
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.715 Vali Acc: 0.712 Test Loss: 0.715 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.13639760017395
Epoch: 3, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.5710742473602295
Epoch: 4, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.541875123977661
Epoch: 5, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.798 Vali Acc: 0.717 Test Loss: 0.798 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.633579969406128
Epoch: 6, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.714 Vali Acc: 0.712 Test Loss: 0.714 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.8300371170043945
Epoch: 7, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.777 Vali Acc: 0.707 Test Loss: 0.777 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.575441837310791
Epoch: 8, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.842 Vali Acc: 0.702 Test Loss: 0.842 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.7175679206848145
Epoch: 9, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.914 Vali Acc: 0.727 Test Loss: 0.914 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726820).  Saving model ...
Epoch: 10 cost time: 4.436723232269287
Epoch: 10, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.787 Vali Acc: 0.663 Test Loss: 0.787 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.6249635219573975
Epoch: 11, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.892 Vali Acc: 0.698 Test Loss: 0.892 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.424595832824707
Epoch: 12, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.034 Vali Acc: 0.702 Test Loss: 1.034 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.454871892929077
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.469 Vali Acc: 0.722 Test Loss: 1.469 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.265208721160889
Epoch: 14, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.352 Vali Acc: 0.717 Test Loss: 1.352 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.385470151901245
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.245 Vali Acc: 0.702 Test Loss: 1.245 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.094841241836548
Epoch: 16, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.155 Vali Acc: 0.663 Test Loss: 1.155 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.372658967971802
Epoch: 17, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.182 Vali Acc: 0.668 Test Loss: 1.182 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.302656650543213
Epoch: 18, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.202 Vali Acc: 0.673 Test Loss: 1.202 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.550004482269287
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.235 Vali Acc: 0.683 Test Loss: 1.235 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.878445625305176
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.4456775188446045
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.618 Vali Acc: 0.717 Test Loss: 0.618 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.383538722991943
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.61141300201416
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.94266939163208
Epoch: 5, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.764 Vali Acc: 0.732 Test Loss: 0.764 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.02239465713501
Epoch: 6, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 4.747511863708496
Epoch: 7, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.685 Vali Acc: 0.722 Test Loss: 0.685 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.9574294090271
Epoch: 8, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.693 Vali Acc: 0.722 Test Loss: 0.693 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.944546699523926
Epoch: 9, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.899 Vali Acc: 0.722 Test Loss: 0.899 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.658364295959473
Epoch: 10, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.807 Vali Acc: 0.717 Test Loss: 0.807 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.36377739906311
Epoch: 11, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.871 Vali Acc: 0.712 Test Loss: 0.871 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.2692646980285645
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.240122556686401
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.172 Vali Acc: 0.732 Test Loss: 1.172 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.262109994888306
Epoch: 14, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.232 Vali Acc: 0.722 Test Loss: 1.232 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.444457769393921
Epoch: 15, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.058 Vali Acc: 0.722 Test Loss: 1.058 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.482524394989014
Epoch: 16, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.026 Vali Acc: 0.712 Test Loss: 1.026 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.438490390777588
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.836796283721924
Epoch: 2, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.509516000747681
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.482950210571289
Epoch: 4, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.608 Vali Acc: 0.727 Test Loss: 0.608 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.454735040664673
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.758 Vali Acc: 0.727 Test Loss: 0.758 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.571512937545776
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.663 Vali Acc: 0.732 Test Loss: 0.663 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731701).  Saving model ...
Epoch: 7 cost time: 4.582635402679443
Epoch: 7, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.683 Vali Acc: 0.727 Test Loss: 0.683 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.9973390102386475
Epoch: 8, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.720 Vali Acc: 0.741 Test Loss: 0.720 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741456).  Saving model ...
Epoch: 9 cost time: 4.7894861698150635
Epoch: 9, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.990 Vali Acc: 0.741 Test Loss: 0.990 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.827445030212402
Epoch: 10, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.000378131866455
Epoch: 11, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.939 Vali Acc: 0.727 Test Loss: 0.939 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.976351737976074
Epoch: 12, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.891 Vali Acc: 0.717 Test Loss: 0.891 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.7676379680633545
Epoch: 13, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.144 Vali Acc: 0.717 Test Loss: 1.144 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.817732334136963
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.242 Vali Acc: 0.717 Test Loss: 1.242 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.902961730957031
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.107 Vali Acc: 0.727 Test Loss: 1.107 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.959569215774536
Epoch: 16, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.066 Vali Acc: 0.678 Test Loss: 1.066 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.835642576217651
Epoch: 17, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.278 Vali Acc: 0.737 Test Loss: 1.278 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.891247272491455
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.223 Vali Acc: 0.737 Test Loss: 1.223 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.929816961288452
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.273443698883057
Epoch: 2, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.607 Vali Acc: 0.707 Test Loss: 0.607 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.387496471405029
Epoch: 3, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.844213485717773
Epoch: 4, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.685 Vali Acc: 0.712 Test Loss: 0.685 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.939133167266846
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.777 Vali Acc: 0.712 Test Loss: 0.777 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.631553888320923
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.709 Vali Acc: 0.712 Test Loss: 0.709 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.866400480270386
Epoch: 7, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.180286884307861
Epoch: 8, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.731 Vali Acc: 0.727 Test Loss: 0.731 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726822).  Saving model ...
Epoch: 9 cost time: 5.3987977504730225
Epoch: 9, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.036 Vali Acc: 0.717 Test Loss: 1.036 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.046332597732544
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.832 Vali Acc: 0.702 Test Loss: 0.832 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.0687096118927
Epoch: 11, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.983 Vali Acc: 0.707 Test Loss: 0.983 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.011534214019775
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.885 Vali Acc: 0.712 Test Loss: 0.885 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.056553602218628
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.071 Vali Acc: 0.717 Test Loss: 1.071 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.731939077377319
Epoch: 14, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.192 Vali Acc: 0.717 Test Loss: 1.192 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.8202173709869385
Epoch: 15, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.988 Vali Acc: 0.702 Test Loss: 0.988 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.77372670173645
Epoch: 16, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.941 Vali Acc: 0.688 Test Loss: 0.941 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.961847305297852
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.099 Vali Acc: 0.712 Test Loss: 1.099 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.177929162979126
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.162 Vali Acc: 0.732 Test Loss: 1.162 Test Acc: 0.732
Validation loss decreased (-0.726822 --> -0.731696).  Saving model ...
Epoch: 19 cost time: 4.903019905090332
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.165 Vali Acc: 0.727 Test Loss: 1.165 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.756314992904663
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.173 Vali Acc: 0.727 Test Loss: 1.173 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.157181978225708
Epoch: 21, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.087 Vali Acc: 0.717 Test Loss: 1.087 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.972238540649414
Epoch: 22, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.389 Vali Acc: 0.722 Test Loss: 1.389 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.056760787963867
Epoch: 23, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.179 Vali Acc: 0.727 Test Loss: 1.179 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.845416069030762
Epoch: 24, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.371 Vali Acc: 0.732 Test Loss: 1.371 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.742872953414917
Epoch: 25, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.296 Vali Acc: 0.717 Test Loss: 1.296 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.873391628265381
Epoch: 26, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.331 Vali Acc: 0.722 Test Loss: 1.331 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.889077663421631
Epoch: 27, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.315 Vali Acc: 0.717 Test Loss: 1.315 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.9568190574646
Epoch: 28, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.465 Vali Acc: 0.727 Test Loss: 1.465 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.017327785491943
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.613 Vali Acc: 0.712 Test Loss: 0.613 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 5.321765661239624
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.600 Vali Acc: 0.707 Test Loss: 0.600 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.935935020446777
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 4.882450580596924
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.679 Vali Acc: 0.707 Test Loss: 0.679 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.901536703109741
Epoch: 5, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.737 Vali Acc: 0.707 Test Loss: 0.737 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.99592661857605
Epoch: 6, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.717 Vali Acc: 0.702 Test Loss: 0.717 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.84197735786438
Epoch: 7, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.702 Vali Acc: 0.707 Test Loss: 0.702 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.896306991577148
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.776 Vali Acc: 0.717 Test Loss: 0.776 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717065).  Saving model ...
Epoch: 9 cost time: 5.0925374031066895
Epoch: 9, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.963 Vali Acc: 0.712 Test Loss: 0.963 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.014244556427002
Epoch: 10, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.870 Vali Acc: 0.727 Test Loss: 0.870 Test Acc: 0.727
Validation loss decreased (-0.717065 --> -0.726821).  Saving model ...
Epoch: 11 cost time: 4.999936103820801
Epoch: 11, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.051 Vali Acc: 0.727 Test Loss: 1.051 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.836069822311401
Epoch: 12, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.954 Vali Acc: 0.717 Test Loss: 0.954 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.800009250640869
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.042 Vali Acc: 0.722 Test Loss: 1.042 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.251674175262451
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.137 Vali Acc: 0.722 Test Loss: 1.137 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.386093616485596
Epoch: 15, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.047 Vali Acc: 0.698 Test Loss: 1.047 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.171359062194824
Epoch: 16, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.060 Vali Acc: 0.702 Test Loss: 1.060 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.633405923843384
Epoch: 17, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.290 Vali Acc: 0.707 Test Loss: 1.290 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.38323974609375
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.349 Vali Acc: 0.702 Test Loss: 1.349 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.020539999008179
Epoch: 19, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.208 Vali Acc: 0.698 Test Loss: 1.208 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.270617723464966
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.269 Vali Acc: 0.698 Test Loss: 1.269 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.698935508728027
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.6288652420043945
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.628 Vali Acc: 0.688 Test Loss: 0.628 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.592467546463013
Epoch: 3, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.693 Vali Acc: 0.571 Test Loss: 0.693 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.6948041915893555
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.628 Vali Acc: 0.673 Test Loss: 0.628 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.571237564086914
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.633 Vali Acc: 0.683 Test Loss: 0.633 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.726064920425415
Epoch: 6, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.750 Vali Acc: 0.517 Test Loss: 0.750 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.6642351150512695
Epoch: 7, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.714 Vali Acc: 0.605 Test Loss: 0.714 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.105970859527588
Epoch: 8, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.759 Vali Acc: 0.556 Test Loss: 0.759 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.118251085281372
Epoch: 9, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.717 Vali Acc: 0.707 Test Loss: 0.717 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.981276035308838
Epoch: 10, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.936 Vali Acc: 0.507 Test Loss: 0.936 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.292384386062622
Epoch: 11, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.814 Vali Acc: 0.605 Test Loss: 0.814 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.560760736465454
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.97321891784668
Epoch: 2, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 5.277219295501709
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.622 Vali Acc: 0.673 Test Loss: 0.622 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.442526340484619
Epoch: 4, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.620 Vali Acc: 0.654 Test Loss: 0.620 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.139136075973511
Epoch: 5, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.610 Vali Acc: 0.678 Test Loss: 0.610 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.270671129226685
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.723 Vali Acc: 0.537 Test Loss: 0.723 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.031306982040405
Epoch: 7, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.662 Vali Acc: 0.629 Test Loss: 0.662 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.8893914222717285
Epoch: 8, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.794 Vali Acc: 0.522 Test Loss: 0.794 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.857784032821655
Epoch: 9, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.623 Vali Acc: 0.673 Test Loss: 0.623 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.109920501708984
Epoch: 10, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.216 Vali Acc: 0.395 Test Loss: 1.216 Test Acc: 0.395
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.9595043659210205
Epoch: 11, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.727 Vali Acc: 0.639 Test Loss: 0.727 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.844567775726318
Epoch: 12, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.824 Vali Acc: 0.595 Test Loss: 0.824 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 427138
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.489474296569824
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.8214170932769775
Epoch: 2, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.700 Vali Acc: 0.722 Test Loss: 0.700 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.042886972427368
Epoch: 3, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.621 Vali Acc: 0.683 Test Loss: 0.621 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.055445671081543
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.627 Vali Acc: 0.732 Test Loss: 0.627 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 5 cost time: 5.208411693572998
Epoch: 5, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.624 Vali Acc: 0.727 Test Loss: 0.624 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.142586708068848
Epoch: 6, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.677 Vali Acc: 0.727 Test Loss: 0.677 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.141418695449829
Epoch: 7, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.636 Vali Acc: 0.707 Test Loss: 0.636 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.16339635848999
Epoch: 8, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.808 Vali Acc: 0.727 Test Loss: 0.808 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.0017030239105225
Epoch: 9, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.714 Vali Acc: 0.722 Test Loss: 0.714 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.547945976257324
Epoch: 10, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.681 Vali Acc: 0.678 Test Loss: 0.681 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.560182571411133
Epoch: 11, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.783 Vali Acc: 0.693 Test Loss: 0.783 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.893151760101318
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.789 Vali Acc: 0.668 Test Loss: 0.789 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.947824239730835
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.865 Vali Acc: 0.693 Test Loss: 0.865 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.204453468322754
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.849 Vali Acc: 0.668 Test Loss: 0.849 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.409744024276733
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 4.65102219581604
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.692 Vali Acc: 0.727 Test Loss: 0.692 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.88146448135376
Epoch: 3, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.618 Vali Acc: 0.688 Test Loss: 0.618 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.75516414642334
Epoch: 4, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 4.794553518295288
Epoch: 5, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.639231443405151
Epoch: 6, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.749 Vali Acc: 0.737 Test Loss: 0.749 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.768307447433472
Epoch: 7, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.728 Vali Acc: 0.722 Test Loss: 0.728 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.469372272491455
Epoch: 8, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.852 Vali Acc: 0.737 Test Loss: 0.852 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.778407573699951
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.729 Vali Acc: 0.698 Test Loss: 0.729 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.139170169830322
Epoch: 10, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.757 Vali Acc: 0.620 Test Loss: 0.757 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.922572612762451
Epoch: 11, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.827 Vali Acc: 0.712 Test Loss: 0.827 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.832198143005371
Epoch: 12, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.849 Vali Acc: 0.693 Test Loss: 0.849 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.894653558731079
Epoch: 13, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.869 Vali Acc: 0.693 Test Loss: 0.869 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.2998340129852295
Epoch: 14, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.911 Vali Acc: 0.659 Test Loss: 0.911 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.91697883605957
Epoch: 1, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 4.638494253158569
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.680 Vali Acc: 0.727 Test Loss: 0.680 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.750094652175903
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.618 Vali Acc: 0.654 Test Loss: 0.618 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.8150715827941895
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 5.131646633148193
Epoch: 5, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.736185312271118
Epoch: 6, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.907188653945923
Epoch: 7, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.755 Vali Acc: 0.727 Test Loss: 0.755 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.748602867126465
Epoch: 8, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.872 Vali Acc: 0.727 Test Loss: 0.872 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.125938415527344
Epoch: 9, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.664191007614136
Epoch: 10, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.712 Vali Acc: 0.673 Test Loss: 0.712 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.158417463302612
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.831 Vali Acc: 0.712 Test Loss: 0.831 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.024355411529541
Epoch: 12, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.869 Vali Acc: 0.722 Test Loss: 0.869 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.857671737670898
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.893 Vali Acc: 0.707 Test Loss: 0.893 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.0550432205200195
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.899 Vali Acc: 0.707 Test Loss: 0.899 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.32512640953064
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.299678087234497
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.694 Vali Acc: 0.722 Test Loss: 0.694 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.993323087692261
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.595 Vali Acc: 0.698 Test Loss: 0.595 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.330922603607178
Epoch: 4, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.3268678188323975
Epoch: 5, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.669 Vali Acc: 0.702 Test Loss: 0.669 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.170057773590088
Epoch: 6, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.699 Vali Acc: 0.707 Test Loss: 0.699 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.329926252365112
Epoch: 7, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.666 Vali Acc: 0.678 Test Loss: 0.666 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.353949308395386
Epoch: 8, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.831 Vali Acc: 0.702 Test Loss: 0.831 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.637307405471802
Epoch: 9, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.761 Vali Acc: 0.678 Test Loss: 0.761 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.611090898513794
Epoch: 10, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.764 Vali Acc: 0.659 Test Loss: 0.764 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.675442218780518
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.882 Vali Acc: 0.688 Test Loss: 0.882 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.140173673629761
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.588446378707886
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 4.356701374053955
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.586 Vali Acc: 0.702 Test Loss: 0.586 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.430568695068359
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.617 Vali Acc: 0.741 Test Loss: 0.617 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 4.3235087394714355
Epoch: 5, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.619 Vali Acc: 0.732 Test Loss: 0.619 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.259249687194824
Epoch: 6, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.875372648239136
Epoch: 7, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.551666259765625
Epoch: 8, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.806 Vali Acc: 0.727 Test Loss: 0.806 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.968038082122803
Epoch: 9, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.717 Vali Acc: 0.712 Test Loss: 0.717 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.669332504272461
Epoch: 10, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.774 Vali Acc: 0.668 Test Loss: 0.774 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.6377458572387695
Epoch: 11, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.792 Vali Acc: 0.707 Test Loss: 0.792 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.5658159255981445
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.854 Vali Acc: 0.717 Test Loss: 0.854 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.149321794509888
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.18172287940979
Epoch: 14, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.903 Vali Acc: 0.702 Test Loss: 0.903 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.400772571563721
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.807787179946899
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.676 Vali Acc: 0.722 Test Loss: 0.676 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.512972593307495
Epoch: 3, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.581 Vali Acc: 0.707 Test Loss: 0.581 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.314459800720215
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.715 Vali Acc: 0.727 Test Loss: 0.715 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726822).  Saving model ...
Epoch: 5 cost time: 4.677904844284058
Epoch: 5, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.725 Vali Acc: 0.741 Test Loss: 0.725 Test Acc: 0.741
Validation loss decreased (-0.726822 --> -0.741456).  Saving model ...
Epoch: 6 cost time: 4.48218035697937
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.767 Vali Acc: 0.746 Test Loss: 0.767 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746334).  Saving model ...
Epoch: 7 cost time: 4.150516748428345
Epoch: 7, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.851 Vali Acc: 0.746 Test Loss: 0.851 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.055395841598511
Epoch: 8, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.768 Vali Acc: 0.737 Test Loss: 0.768 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.297843933105469
Epoch: 9, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.4405999183654785
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.740 Vali Acc: 0.683 Test Loss: 0.740 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.1000611782073975
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.855 Vali Acc: 0.732 Test Loss: 0.855 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.423532009124756
Epoch: 12, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.927 Vali Acc: 0.717 Test Loss: 0.927 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.547391414642334
Epoch: 13, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.984 Vali Acc: 0.727 Test Loss: 0.984 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.645678520202637
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.962 Vali Acc: 0.717 Test Loss: 0.962 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.43185830116272
Epoch: 15, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.058 Vali Acc: 0.722 Test Loss: 1.058 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.374335765838623
Epoch: 16, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.936990737915039
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.614 Vali Acc: 0.722 Test Loss: 0.614 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.327099800109863
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.670 Vali Acc: 0.717 Test Loss: 0.670 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.51449990272522
Epoch: 3, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.610 Vali Acc: 0.702 Test Loss: 0.610 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.442936658859253
Epoch: 4, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.464576244354248
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.738 Vali Acc: 0.722 Test Loss: 0.738 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.8532609939575195
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.747 Vali Acc: 0.722 Test Loss: 0.747 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.722843408584595
Epoch: 7, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.803 Vali Acc: 0.717 Test Loss: 0.803 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.708572626113892
Epoch: 8, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.804 Vali Acc: 0.717 Test Loss: 0.804 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.800490856170654
Epoch: 9, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.723 Vali Acc: 0.693 Test Loss: 0.723 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.274643898010254
Epoch: 10, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.722 Vali Acc: 0.693 Test Loss: 0.722 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.749441862106323
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.867 Vali Acc: 0.712 Test Loss: 0.867 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.974414587020874
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.594801187515259
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.460810899734497
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.594 Vali Acc: 0.702 Test Loss: 0.594 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.431411504745483
Epoch: 4, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.724 Vali Acc: 0.712 Test Loss: 0.724 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.633574485778809
Epoch: 5, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.734 Vali Acc: 0.712 Test Loss: 0.734 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.661379814147949
Epoch: 6, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.757 Vali Acc: 0.712 Test Loss: 0.757 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.260174036026001
Epoch: 7, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.857 Vali Acc: 0.712 Test Loss: 0.857 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.484168291091919
Epoch: 8, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.938 Vali Acc: 0.712 Test Loss: 0.938 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.333704948425293
Epoch: 9, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.751 Vali Acc: 0.702 Test Loss: 0.751 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.3629560470581055
Epoch: 10, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.268022298812866
Epoch: 11, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.851 Vali Acc: 0.698 Test Loss: 0.851 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.550806522369385
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.1390368938446045
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 4.7554895877838135
Epoch: 3, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.646 Vali Acc: 0.634 Test Loss: 0.646 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.2263970375061035
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.641 Vali Acc: 0.727 Test Loss: 0.641 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.558338165283203
Epoch: 5, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.647 Vali Acc: 0.683 Test Loss: 0.647 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.761582374572754
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.671 Vali Acc: 0.668 Test Loss: 0.671 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.66762113571167
Epoch: 7, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.704 Vali Acc: 0.634 Test Loss: 0.704 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.798336744308472
Epoch: 8, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.768 Vali Acc: 0.566 Test Loss: 0.768 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.6309449672698975
Epoch: 9, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.941 Vali Acc: 0.454 Test Loss: 0.941 Test Acc: 0.454
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.024407386779785
Epoch: 10, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.875 Vali Acc: 0.507 Test Loss: 0.875 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.715126991271973
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.817 Vali Acc: 0.634 Test Loss: 0.817 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.151440620422363
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.866 Vali Acc: 0.624 Test Loss: 0.866 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.095970630645752
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.635 Vali Acc: 0.722 Test Loss: 0.635 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.90684700012207
Epoch: 2, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.30439567565918
Epoch: 3, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.613 Vali Acc: 0.693 Test Loss: 0.613 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.575690746307373
Epoch: 4, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.588 Vali Acc: 0.707 Test Loss: 0.588 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.699237823486328
Epoch: 5, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.643 Vali Acc: 0.620 Test Loss: 0.643 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.20585560798645
Epoch: 6, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 7 cost time: 4.911281585693359
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.638 Vali Acc: 0.634 Test Loss: 0.638 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.774281024932861
Epoch: 8, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.838 Vali Acc: 0.512 Test Loss: 0.838 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.793569326400757
Epoch: 9, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.783 Vali Acc: 0.527 Test Loss: 0.783 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.472223281860352
Epoch: 10, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.891 Vali Acc: 0.498 Test Loss: 0.891 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.060772895812988
Epoch: 11, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.734 Vali Acc: 0.629 Test Loss: 0.734 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.747828960418701
Epoch: 12, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.818 Vali Acc: 0.600 Test Loss: 0.818 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.281755685806274
Epoch: 13, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.879 Vali Acc: 0.605 Test Loss: 0.879 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.432307243347168
Epoch: 14, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.622936725616455
Epoch: 15, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.131 Vali Acc: 0.561 Test Loss: 1.131 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.359048366546631
Epoch: 16, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.161 Vali Acc: 0.585 Test Loss: 1.161 Test Acc: 0.585
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 328834
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.665997266769409
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 5.040089130401611
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.6956446170806885
Epoch: 3, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.585 Vali Acc: 0.712 Test Loss: 0.585 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.608464956283569
Epoch: 4, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 5 cost time: 4.901627540588379
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 5.173934698104858
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.767378091812134
Epoch: 7, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.669512510299683
Epoch: 8, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.749 Vali Acc: 0.732 Test Loss: 0.749 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731700).  Saving model ...
Epoch: 9 cost time: 4.380115270614624
Epoch: 9, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.806 Vali Acc: 0.732 Test Loss: 0.806 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.0536088943481445
Epoch: 10, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.827 Vali Acc: 0.727 Test Loss: 0.827 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.734896898269653
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.715 Vali Acc: 0.688 Test Loss: 0.715 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.48909068107605
Epoch: 12, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.817 Vali Acc: 0.732 Test Loss: 0.817 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.8367390632629395
Epoch: 13, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.971 Vali Acc: 0.722 Test Loss: 0.971 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.584736347198486
Epoch: 14, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.973 Vali Acc: 0.727 Test Loss: 0.973 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.729120969772339
Epoch: 15, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.845 Vali Acc: 0.693 Test Loss: 0.845 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.720107078552246
Epoch: 16, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.941 Vali Acc: 0.702 Test Loss: 0.941 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.0088791847229
Epoch: 17, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.896 Vali Acc: 0.678 Test Loss: 0.896 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.748725652694702
Epoch: 18, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.937 Vali Acc: 0.668 Test Loss: 0.937 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.724533796310425
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.344202280044556
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.679 Vali Acc: 0.712 Test Loss: 0.679 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.563854217529297
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 4.587308168411255
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 4.646397829055786
Epoch: 5, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.635 Vali Acc: 0.727 Test Loss: 0.635 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.644796133041382
Epoch: 6, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.701 Vali Acc: 0.732 Test Loss: 0.701 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731700).  Saving model ...
Epoch: 7 cost time: 4.761368274688721
Epoch: 7, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.731 Vali Acc: 0.722 Test Loss: 0.731 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.374978065490723
Epoch: 8, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.963 Vali Acc: 0.732 Test Loss: 0.963 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.028554677963257
Epoch: 9, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.899 Vali Acc: 0.741 Test Loss: 0.899 Test Acc: 0.741
Validation loss decreased (-0.731700 --> -0.741454).  Saving model ...
Epoch: 10 cost time: 4.165717840194702
Epoch: 10, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.984 Vali Acc: 0.727 Test Loss: 0.984 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.226736783981323
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.255807161331177
Epoch: 12, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.855 Vali Acc: 0.737 Test Loss: 0.855 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.049015045166016
Epoch: 13, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.080 Vali Acc: 0.737 Test Loss: 1.080 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.8427557945251465
Epoch: 14, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.115 Vali Acc: 0.741 Test Loss: 1.115 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.480526447296143
Epoch: 15, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.939 Vali Acc: 0.727 Test Loss: 0.939 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.4536778926849365
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.007 Vali Acc: 0.727 Test Loss: 1.007 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.605747699737549
Epoch: 17, Steps: 13 | Train Loss: 0.016 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.6988136768341064
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.624773740768433
Epoch: 19, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.300 Vali Acc: 0.732 Test Loss: 1.300 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.335150957107544
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.794408559799194
Epoch: 2, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.661 Vali Acc: 0.722 Test Loss: 0.661 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 5.120373487472534
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.793103456497192
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.2357563972473145
Epoch: 5, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.601 Vali Acc: 0.732 Test Loss: 0.601 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.8670337200164795
Epoch: 6, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.741 Vali Acc: 0.727 Test Loss: 0.741 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.569226980209351
Epoch: 7, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.760 Vali Acc: 0.727 Test Loss: 0.760 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.815876245498657
Epoch: 8, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.874 Vali Acc: 0.737 Test Loss: 0.874 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736577).  Saving model ...
Epoch: 9 cost time: 4.580948352813721
Epoch: 9, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.942 Vali Acc: 0.737 Test Loss: 0.942 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.455122470855713
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.911 Vali Acc: 0.722 Test Loss: 0.911 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.3386499881744385
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.761 Vali Acc: 0.663 Test Loss: 0.761 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.403975486755371
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.808 Vali Acc: 0.707 Test Loss: 0.808 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.6914756298065186
Epoch: 13, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.859 Vali Acc: 0.678 Test Loss: 0.859 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.703380346298218
Epoch: 14, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.039 Vali Acc: 0.732 Test Loss: 1.039 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.684658527374268
Epoch: 15, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.919 Vali Acc: 0.717 Test Loss: 0.919 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.8985021114349365
Epoch: 16, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.955 Vali Acc: 0.717 Test Loss: 0.955 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.881739854812622
Epoch: 17, Steps: 13 | Train Loss: 0.017 Vali Loss: 0.973 Vali Acc: 0.693 Test Loss: 0.973 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.9565818309783936
Epoch: 18, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.055 Vali Acc: 0.717 Test Loss: 1.055 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.933081865310669
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.305204153060913
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.317249059677124
Epoch: 3, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.93554425239563
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.5321364402771
Epoch: 5, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.613 Vali Acc: 0.707 Test Loss: 0.613 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.6015472412109375
Epoch: 6, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.694 Vali Acc: 0.693 Test Loss: 0.694 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.6633172035217285
Epoch: 7, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.745 Vali Acc: 0.707 Test Loss: 0.745 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.626082897186279
Epoch: 8, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.909 Vali Acc: 0.712 Test Loss: 0.909 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.3605852127075195
Epoch: 9, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.029 Vali Acc: 0.712 Test Loss: 1.029 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.274885892868042
Epoch: 10, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.981 Vali Acc: 0.712 Test Loss: 0.981 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.350210666656494
Epoch: 11, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.794 Vali Acc: 0.668 Test Loss: 0.794 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.697701930999756
Epoch: 12, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.854 Vali Acc: 0.688 Test Loss: 0.854 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.608398914337158
Epoch: 13, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.131 Vali Acc: 0.712 Test Loss: 1.131 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.0470733642578125
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.801294326782227
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.590 Vali Acc: 0.707 Test Loss: 0.590 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.147781133651733
Epoch: 3, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.942579030990601
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.360924482345581
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.589 Vali Acc: 0.746 Test Loss: 0.589 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 4.887709617614746
Epoch: 6, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.395871162414551
Epoch: 7, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.760 Vali Acc: 0.737 Test Loss: 0.760 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5302159786224365
Epoch: 8, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.834 Vali Acc: 0.741 Test Loss: 0.834 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.748083114624023
Epoch: 9, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.839 Vali Acc: 0.732 Test Loss: 0.839 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.917076110839844
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.912 Vali Acc: 0.727 Test Loss: 0.912 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.018868684768677
Epoch: 11, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.772 Vali Acc: 0.717 Test Loss: 0.772 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.920222282409668
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.895781993865967
Epoch: 13, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.822 Vali Acc: 0.712 Test Loss: 0.822 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.164515018463135
Epoch: 14, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.863 Vali Acc: 0.702 Test Loss: 0.863 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.02501916885376
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.905 Vali Acc: 0.702 Test Loss: 0.905 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.727352619171143
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.71930456161499
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.713424921035767
Epoch: 3, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 4.412928104400635
Epoch: 4, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.384948968887329
Epoch: 5, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.890424013137817
Epoch: 6, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.719 Vali Acc: 0.741 Test Loss: 0.719 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741456).  Saving model ...
Epoch: 7 cost time: 4.340912818908691
Epoch: 7, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.802 Vali Acc: 0.746 Test Loss: 0.802 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746333).  Saving model ...
Epoch: 8 cost time: 4.356203079223633
Epoch: 8, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.880 Vali Acc: 0.741 Test Loss: 0.880 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.155858993530273
Epoch: 9, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.956 Vali Acc: 0.732 Test Loss: 0.956 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.2262609004974365
Epoch: 10, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.863 Vali Acc: 0.751 Test Loss: 0.863 Test Acc: 0.751
Validation loss decreased (-0.746333 --> -0.751211).  Saving model ...
Epoch: 11 cost time: 4.034603834152222
Epoch: 11, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.785 Vali Acc: 0.712 Test Loss: 0.785 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.210521936416626
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.849 Vali Acc: 0.707 Test Loss: 0.849 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.282221794128418
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.893 Vali Acc: 0.707 Test Loss: 0.893 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.491006374359131
Epoch: 14, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.438082456588745
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.964 Vali Acc: 0.668 Test Loss: 0.964 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.368229627609253
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.035 Vali Acc: 0.702 Test Loss: 1.035 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.513376235961914
Epoch: 17, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.052 Vali Acc: 0.702 Test Loss: 1.052 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.72320818901062
Epoch: 18, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.212 Vali Acc: 0.722 Test Loss: 1.212 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.508152008056641
Epoch: 19, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.254 Vali Acc: 0.722 Test Loss: 1.254 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.410672426223755
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.125 Vali Acc: 0.693 Test Loss: 1.125 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.5793468952178955
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.5169899463653564
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.583428144454956
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 4.47702169418335
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.589 Vali Acc: 0.702 Test Loss: 0.589 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.857425928115845
Epoch: 5, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.629 Vali Acc: 0.698 Test Loss: 0.629 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.841160774230957
Epoch: 6, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.758 Vali Acc: 0.722 Test Loss: 0.758 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721944).  Saving model ...
Epoch: 7 cost time: 4.767890214920044
Epoch: 7, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.857 Vali Acc: 0.717 Test Loss: 0.857 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.592358112335205
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.782271385192871
Epoch: 9, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.897 Vali Acc: 0.712 Test Loss: 0.897 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.758793830871582
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.881 Vali Acc: 0.707 Test Loss: 0.881 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.436541795730591
Epoch: 11, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.790 Vali Acc: 0.702 Test Loss: 0.790 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.659542560577393
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.785 Vali Acc: 0.698 Test Loss: 0.785 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.792353391647339
Epoch: 13, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.894 Vali Acc: 0.702 Test Loss: 0.894 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.810833930969238
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.867 Vali Acc: 0.683 Test Loss: 0.867 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.720744609832764
Epoch: 15, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.874 Vali Acc: 0.693 Test Loss: 0.874 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.869476318359375
Epoch: 16, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.128 Vali Acc: 0.707 Test Loss: 1.128 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.7632739543914795
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.640 Vali Acc: 0.717 Test Loss: 0.640 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.170979976654053
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.638 Vali Acc: 0.712 Test Loss: 0.638 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.7027692794799805
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.616 Vali Acc: 0.712 Test Loss: 0.616 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.50513768196106
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.611 Vali Acc: 0.707 Test Loss: 0.611 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.287164211273193
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.668 Vali Acc: 0.707 Test Loss: 0.668 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.606625318527222
Epoch: 6, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.607200384140015
Epoch: 7, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.929 Vali Acc: 0.717 Test Loss: 0.929 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.575341463088989
Epoch: 8, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.911 Vali Acc: 0.712 Test Loss: 0.911 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.837179183959961
Epoch: 9, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.758 Vali Acc: 0.698 Test Loss: 0.758 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.343656301498413
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.857 Vali Acc: 0.722 Test Loss: 0.857 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721943).  Saving model ...
Epoch: 11 cost time: 4.76247763633728
Epoch: 11, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.811 Vali Acc: 0.698 Test Loss: 0.811 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.499431371688843
Epoch: 12, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.870 Vali Acc: 0.702 Test Loss: 0.870 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.364877223968506
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.916 Vali Acc: 0.707 Test Loss: 0.916 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.549492597579956
Epoch: 14, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.944 Vali Acc: 0.688 Test Loss: 0.944 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.730725526809692
Epoch: 15, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.952 Vali Acc: 0.683 Test Loss: 0.952 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.927172899246216
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.309 Vali Acc: 0.717 Test Loss: 1.309 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.742488861083984
Epoch: 17, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.061 Vali Acc: 0.683 Test Loss: 1.061 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.8668413162231445
Epoch: 18, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.226 Vali Acc: 0.693 Test Loss: 1.226 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.497471332550049
Epoch: 19, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.256 Vali Acc: 0.698 Test Loss: 1.256 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.437262535095215
Epoch: 20, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.073 Vali Acc: 0.673 Test Loss: 1.073 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.751141786575317
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.520416498184204
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.634 Vali Acc: 0.688 Test Loss: 0.634 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.653454542160034
Epoch: 3, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.630 Vali Acc: 0.707 Test Loss: 0.630 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.568193197250366
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.650 Vali Acc: 0.678 Test Loss: 0.650 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.549369812011719
Epoch: 5, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.706 Vali Acc: 0.576 Test Loss: 0.706 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.69558048248291
Epoch: 6, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.665 Vali Acc: 0.707 Test Loss: 0.665 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.0117506980896
Epoch: 7, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.700 Vali Acc: 0.610 Test Loss: 0.700 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.4404168128967285
Epoch: 8, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.731 Vali Acc: 0.600 Test Loss: 0.731 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.566174507141113
Epoch: 9, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.752 Vali Acc: 0.600 Test Loss: 0.752 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.205869436264038
Epoch: 10, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.776 Vali Acc: 0.624 Test Loss: 0.776 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.499293804168701
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.843 Vali Acc: 0.585 Test Loss: 0.843 Test Acc: 0.585
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.328772306442261
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.001991033554077
Epoch: 2, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.4259397983551025
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.368495464324951
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.649 Vali Acc: 0.620 Test Loss: 0.649 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.4999964237213135
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.686 Vali Acc: 0.615 Test Loss: 0.686 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.559858798980713
Epoch: 6, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 7 cost time: 4.708286285400391
Epoch: 7, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.742 Vali Acc: 0.551 Test Loss: 0.742 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.424573183059692
Epoch: 8, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.651 Vali Acc: 0.620 Test Loss: 0.651 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.563329219818115
Epoch: 9, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.809 Vali Acc: 0.522 Test Loss: 0.809 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.312359809875488
Epoch: 10, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.709 Vali Acc: 0.634 Test Loss: 0.709 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.196328163146973
Epoch: 11, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.947 Vali Acc: 0.507 Test Loss: 0.947 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.51285982131958
Epoch: 12, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.322 Vali Acc: 0.415 Test Loss: 1.322 Test Acc: 0.415
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.615607976913452
Epoch: 13, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.895 Vali Acc: 0.595 Test Loss: 0.895 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.6292383670806885
Epoch: 14, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.999 Vali Acc: 0.366 Test Loss: 1.999 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.721937417984009
Epoch: 15, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.203 Vali Acc: 0.576 Test Loss: 1.203 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.80013108253479
Epoch: 16, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.983 Vali Acc: 0.663 Test Loss: 0.983 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 279682
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.219358444213867
Epoch: 1, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.287187814712524
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.559 Vali Acc: 0.722 Test Loss: 0.559 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.404066324234009
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.551 Vali Acc: 0.722 Test Loss: 0.551 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 4.704766035079956
Epoch: 4, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 4.183557510375977
Epoch: 5, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.799 Vali Acc: 0.712 Test Loss: 0.799 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.531260967254639
Epoch: 6, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.656 Vali Acc: 0.727 Test Loss: 0.656 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5951361656188965
Epoch: 7, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.603 Vali Acc: 0.741 Test Loss: 0.603 Test Acc: 0.741
Validation loss decreased (-0.726824 --> -0.741457).  Saving model ...
Epoch: 8 cost time: 4.609187602996826
Epoch: 8, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.654 Vali Acc: 0.741 Test Loss: 0.654 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.478781700134277
Epoch: 9, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.618 Vali Acc: 0.693 Test Loss: 0.618 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.517251968383789
Epoch: 10, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.769 Vali Acc: 0.717 Test Loss: 0.769 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.465535640716553
Epoch: 11, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.812 Vali Acc: 0.727 Test Loss: 0.812 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.294406175613403
Epoch: 12, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.896 Vali Acc: 0.727 Test Loss: 0.896 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.301767349243164
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.172 Vali Acc: 0.722 Test Loss: 1.172 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.172672271728516
Epoch: 14, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.021 Vali Acc: 0.732 Test Loss: 1.021 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.358715772628784
Epoch: 15, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.031 Vali Acc: 0.741 Test Loss: 1.031 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.528345346450806
Epoch: 16, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.045 Vali Acc: 0.737 Test Loss: 1.045 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.648784399032593
Epoch: 17, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.941 Vali Acc: 0.746 Test Loss: 0.941 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746332).  Saving model ...
Epoch: 18 cost time: 4.267628908157349
Epoch: 18, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.922 Vali Acc: 0.722 Test Loss: 0.922 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.6856749057769775
Epoch: 19, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.971 Vali Acc: 0.737 Test Loss: 0.971 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.4581298828125
Epoch: 20, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.945 Vali Acc: 0.746 Test Loss: 0.945 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.543460845947266
Epoch: 21, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.992 Vali Acc: 0.746 Test Loss: 0.992 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.417191743850708
Epoch: 22, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.010 Vali Acc: 0.737 Test Loss: 1.010 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.358241319656372
Epoch: 23, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.047 Vali Acc: 0.741 Test Loss: 1.047 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.2665855884552
Epoch: 24, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.173 Vali Acc: 0.741 Test Loss: 1.173 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.3306708335876465
Epoch: 25, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.071 Vali Acc: 0.737 Test Loss: 1.071 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.5258073806762695
Epoch: 26, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.210 Vali Acc: 0.732 Test Loss: 1.210 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.945739984512329
Epoch: 27, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.165 Vali Acc: 0.737 Test Loss: 1.165 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.499354839324951
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.76279354095459
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.868994951248169
Epoch: 3, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.694806814193726
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 4.787969350814819
Epoch: 5, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.808 Vali Acc: 0.722 Test Loss: 0.808 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.105091094970703
Epoch: 6, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.690 Vali Acc: 0.727 Test Loss: 0.690 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.481843948364258
Epoch: 7, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.621 Vali Acc: 0.751 Test Loss: 0.621 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751213).  Saving model ...
Epoch: 8 cost time: 4.4647440910339355
Epoch: 8, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.677 Vali Acc: 0.737 Test Loss: 0.677 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.854357481002808
Epoch: 9, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.666 Vali Acc: 0.727 Test Loss: 0.666 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.844480037689209
Epoch: 10, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.752 Vali Acc: 0.741 Test Loss: 0.752 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.605544805526733
Epoch: 11, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.827 Vali Acc: 0.732 Test Loss: 0.827 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.537914991378784
Epoch: 12, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.912 Vali Acc: 0.737 Test Loss: 0.912 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.3394012451171875
Epoch: 13, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.033 Vali Acc: 0.751 Test Loss: 1.033 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.660140752792358
Epoch: 14, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.110 Vali Acc: 0.737 Test Loss: 1.110 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.086742401123047
Epoch: 15, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.055 Vali Acc: 0.727 Test Loss: 1.055 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.566072702407837
Epoch: 16, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.999 Vali Acc: 0.741 Test Loss: 0.999 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.645882844924927
Epoch: 17, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.025 Vali Acc: 0.732 Test Loss: 1.025 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.982333660125732
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.647302627563477
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.523172378540039
Epoch: 3, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.59178900718689
Epoch: 4, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.504818916320801
Epoch: 5, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.737 Vali Acc: 0.737 Test Loss: 0.737 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 6 cost time: 4.892645597457886
Epoch: 6, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.666 Vali Acc: 0.741 Test Loss: 0.666 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 4.982074499130249
Epoch: 7, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.878655433654785
Epoch: 8, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.645 Vali Acc: 0.712 Test Loss: 0.645 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.735663652420044
Epoch: 9, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.667 Vali Acc: 0.707 Test Loss: 0.667 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.779802560806274
Epoch: 10, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.695 Vali Acc: 0.727 Test Loss: 0.695 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.286131381988525
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.762 Vali Acc: 0.732 Test Loss: 0.762 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.557973861694336
Epoch: 12, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.886 Vali Acc: 0.727 Test Loss: 0.886 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.624175786972046
Epoch: 13, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.957 Vali Acc: 0.741 Test Loss: 0.957 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.780882358551025
Epoch: 14, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.018 Vali Acc: 0.741 Test Loss: 1.018 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.753029108047485
Epoch: 15, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.136 Vali Acc: 0.751 Test Loss: 1.136 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751208).  Saving model ...
Epoch: 16 cost time: 5.209032297134399
Epoch: 16, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.089 Vali Acc: 0.727 Test Loss: 1.089 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.857109785079956
Epoch: 17, Steps: 13 | Train Loss: 0.022 Vali Loss: 0.974 Vali Acc: 0.698 Test Loss: 0.974 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.888494491577148
Epoch: 18, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.027 Vali Acc: 0.717 Test Loss: 1.027 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.997698545455933
Epoch: 19, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.106 Vali Acc: 0.737 Test Loss: 1.106 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.616353273391724
Epoch: 20, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.054 Vali Acc: 0.698 Test Loss: 1.054 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.554938077926636
Epoch: 21, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.084 Vali Acc: 0.698 Test Loss: 1.084 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.4874842166900635
Epoch: 22, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.138 Vali Acc: 0.702 Test Loss: 1.138 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.4957215785980225
Epoch: 23, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.147 Vali Acc: 0.698 Test Loss: 1.147 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.558548212051392
Epoch: 24, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.231 Vali Acc: 0.707 Test Loss: 1.231 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.48672342300415
Epoch: 25, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.215 Vali Acc: 0.707 Test Loss: 1.215 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.936866760253906
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.358030557632446
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.5168867111206055
Epoch: 3, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.565 Vali Acc: 0.712 Test Loss: 0.565 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.209712266921997
Epoch: 4, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.212575674057007
Epoch: 5, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.743 Vali Acc: 0.712 Test Loss: 0.743 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.418842077255249
Epoch: 6, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.668 Vali Acc: 0.727 Test Loss: 0.668 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.2065184116363525
Epoch: 7, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.625 Vali Acc: 0.712 Test Loss: 0.625 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.387881517410278
Epoch: 8, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.71901535987854
Epoch: 9, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.654 Vali Acc: 0.673 Test Loss: 0.654 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.0265889167785645
Epoch: 10, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.817 Vali Acc: 0.727 Test Loss: 0.817 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.785619258880615
Epoch: 11, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.882 Vali Acc: 0.712 Test Loss: 0.882 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.853636741638184
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.052 Vali Acc: 0.727 Test Loss: 1.052 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.043476343154907
Epoch: 1, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.41468071937561
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 4.777976751327515
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.544 Vali Acc: 0.756 Test Loss: 0.544 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 5.281627655029297
Epoch: 4, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.799562215805054
Epoch: 5, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.06895112991333
Epoch: 6, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.644 Vali Acc: 0.741 Test Loss: 0.644 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.042799234390259
Epoch: 7, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.616 Vali Acc: 0.751 Test Loss: 0.616 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.860326290130615
Epoch: 8, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.612 Vali Acc: 0.751 Test Loss: 0.612 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.274218559265137
Epoch: 9, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.636 Vali Acc: 0.688 Test Loss: 0.636 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.293276309967041
Epoch: 10, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.695 Vali Acc: 0.766 Test Loss: 0.695 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765847).  Saving model ...
Epoch: 11 cost time: 4.498546600341797
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.747 Vali Acc: 0.751 Test Loss: 0.747 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.41619873046875
Epoch: 12, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.790 Vali Acc: 0.766 Test Loss: 0.790 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.629142761230469
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.027 Vali Acc: 0.751 Test Loss: 1.027 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.9653520584106445
Epoch: 14, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.002 Vali Acc: 0.756 Test Loss: 1.002 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.94737696647644
Epoch: 15, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.986 Vali Acc: 0.761 Test Loss: 0.986 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.980506420135498
Epoch: 16, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.956 Vali Acc: 0.751 Test Loss: 0.956 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.821685791015625
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.900 Vali Acc: 0.712 Test Loss: 0.900 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.7033281326293945
Epoch: 18, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.962 Vali Acc: 0.722 Test Loss: 0.962 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.365502595901489
Epoch: 19, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.032 Vali Acc: 0.737 Test Loss: 1.032 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.751308441162109
Epoch: 20, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.005 Vali Acc: 0.722 Test Loss: 1.005 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.204005002975464
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.665342092514038
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.566870927810669
Epoch: 3, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.731379508972168
Epoch: 4, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.565253496170044
Epoch: 5, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.688 Vali Acc: 0.727 Test Loss: 0.688 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.464869976043701
Epoch: 6, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.688 Vali Acc: 0.737 Test Loss: 0.688 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.476040840148926
Epoch: 7, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.641 Vali Acc: 0.737 Test Loss: 0.641 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.344388008117676
Epoch: 8, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.235684871673584
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.426948308944702
Epoch: 10, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.832 Vali Acc: 0.746 Test Loss: 0.832 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746333).  Saving model ...
Epoch: 11 cost time: 4.3915300369262695
Epoch: 11, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.781 Vali Acc: 0.727 Test Loss: 0.781 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.609105348587036
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.977 Vali Acc: 0.751 Test Loss: 0.977 Test Acc: 0.751
Validation loss decreased (-0.746333 --> -0.751210).  Saving model ...
Epoch: 13 cost time: 4.552775621414185
Epoch: 13, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.171 Vali Acc: 0.741 Test Loss: 1.171 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.534042119979858
Epoch: 14, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.967 Vali Acc: 0.741 Test Loss: 0.967 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.158945798873901
Epoch: 15, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.010 Vali Acc: 0.727 Test Loss: 1.010 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.415511131286621
Epoch: 16, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.560700178146362
Epoch: 17, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.060 Vali Acc: 0.722 Test Loss: 1.060 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.408567428588867
Epoch: 18, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.041 Vali Acc: 0.712 Test Loss: 1.041 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.792963743209839
Epoch: 19, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.136 Vali Acc: 0.727 Test Loss: 1.136 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.895129680633545
Epoch: 20, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.144 Vali Acc: 0.717 Test Loss: 1.144 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.021766901016235
Epoch: 21, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.132 Vali Acc: 0.707 Test Loss: 1.132 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.810084819793701
Epoch: 22, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.111 Vali Acc: 0.659 Test Loss: 1.111 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.821301460266113
Epoch: 1, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.42191743850708
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.563 Vali Acc: 0.712 Test Loss: 0.563 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.587196111679077
Epoch: 3, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.439058780670166
Epoch: 4, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.211016416549683
Epoch: 5, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.758 Vali Acc: 0.712 Test Loss: 0.758 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.740393400192261
Epoch: 6, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.706 Vali Acc: 0.712 Test Loss: 0.706 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.09302544593811
Epoch: 7, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.666 Vali Acc: 0.712 Test Loss: 0.666 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.72748589515686
Epoch: 8, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.711 Vali Acc: 0.707 Test Loss: 0.711 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.903267860412598
Epoch: 9, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.687 Vali Acc: 0.702 Test Loss: 0.687 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.724278211593628
Epoch: 10, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.764 Vali Acc: 0.698 Test Loss: 0.764 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.605224847793579
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.790 Vali Acc: 0.673 Test Loss: 0.790 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.524948835372925
Epoch: 12, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.102 Vali Acc: 0.712 Test Loss: 1.102 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.687382936477661
Epoch: 13, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.161 Vali Acc: 0.702 Test Loss: 1.161 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.264360666275024
Epoch: 1, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.6752543449401855
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.3391828536987305
Epoch: 3, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.5288214683532715
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.454533100128174
Epoch: 5, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.777 Vali Acc: 0.712 Test Loss: 0.777 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.262618541717529
Epoch: 6, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.34771203994751
Epoch: 7, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.674 Vali Acc: 0.707 Test Loss: 0.674 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.360265254974365
Epoch: 8, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.680 Vali Acc: 0.712 Test Loss: 0.680 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.456619739532471
Epoch: 9, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.685 Vali Acc: 0.702 Test Loss: 0.685 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.854355812072754
Epoch: 10, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.748 Vali Acc: 0.707 Test Loss: 0.748 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.7156689167022705
Epoch: 11, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.740 Vali Acc: 0.707 Test Loss: 0.740 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.532485485076904
Epoch: 12, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.845 Vali Acc: 0.698 Test Loss: 0.845 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.536193132400513
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.925 Vali Acc: 0.707 Test Loss: 0.925 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.703584671020508
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.553617238998413
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2864415645599365
Epoch: 3, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.608 Vali Acc: 0.688 Test Loss: 0.608 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.307108640670776
Epoch: 4, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.589 Vali Acc: 0.702 Test Loss: 0.589 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.512735843658447
Epoch: 5, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.596 Vali Acc: 0.688 Test Loss: 0.596 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.454221487045288
Epoch: 6, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.610 Vali Acc: 0.678 Test Loss: 0.610 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.521380186080933
Epoch: 7, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.638 Vali Acc: 0.654 Test Loss: 0.638 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.423513650894165
Epoch: 8, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.759 Vali Acc: 0.571 Test Loss: 0.759 Test Acc: 0.571
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.77900505065918
Epoch: 9, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.664 Vali Acc: 0.663 Test Loss: 0.664 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.234288692474365
Epoch: 10, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.688 Vali Acc: 0.668 Test Loss: 0.688 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.106729507446289
Epoch: 11, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.757 Vali Acc: 0.649 Test Loss: 0.757 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.5569891929626465
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.285745620727539
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.586 Vali Acc: 0.712 Test Loss: 0.586 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 4.306710720062256
Epoch: 3, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.642 Vali Acc: 0.644 Test Loss: 0.642 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.290825366973877
Epoch: 4, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.584 Vali Acc: 0.702 Test Loss: 0.584 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.805877685546875
Epoch: 5, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.660 Vali Acc: 0.600 Test Loss: 0.660 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.625548362731934
Epoch: 6, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.664 Vali Acc: 0.590 Test Loss: 0.664 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.37460470199585
Epoch: 7, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.741 Vali Acc: 0.478 Test Loss: 0.741 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.245225429534912
Epoch: 8, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.954 Vali Acc: 0.376 Test Loss: 0.954 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.18917179107666
Epoch: 9, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.617 Vali Acc: 0.649 Test Loss: 0.617 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.497090101242065
Epoch: 10, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.806 Vali Acc: 0.527 Test Loss: 0.806 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.420947313308716
Epoch: 11, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.978 Vali Acc: 0.444 Test Loss: 0.978 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.48415732383728
Epoch: 12, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.746 Vali Acc: 0.600 Test Loss: 0.746 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 467522
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.207565546035767
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.561211824417114
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.545952081680298
Epoch: 3, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.290950775146484
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.641 Vali Acc: 0.727 Test Loss: 0.641 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.39898419380188
Epoch: 5, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 4.33224081993103
Epoch: 6, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.331224679946899
Epoch: 7, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.602494478225708
Epoch: 8, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.892 Vali Acc: 0.732 Test Loss: 0.892 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.4614951610565186
Epoch: 9, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.751 Vali Acc: 0.746 Test Loss: 0.751 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746334).  Saving model ...
Epoch: 10 cost time: 4.358048677444458
Epoch: 10, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.678 Vali Acc: 0.732 Test Loss: 0.678 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.617339849472046
Epoch: 11, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.666 Vali Acc: 0.727 Test Loss: 0.666 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.302618503570557
Epoch: 12, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.740 Vali Acc: 0.722 Test Loss: 0.740 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.32641077041626
Epoch: 13, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.316749095916748
Epoch: 14, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.784 Vali Acc: 0.707 Test Loss: 0.784 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.019681692123413
Epoch: 15, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.804 Vali Acc: 0.717 Test Loss: 0.804 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.258866310119629
Epoch: 16, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.932 Vali Acc: 0.712 Test Loss: 0.932 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.240387439727783
Epoch: 17, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.909 Vali Acc: 0.722 Test Loss: 0.909 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.544511079788208
Epoch: 18, Steps: 13 | Train Loss: 0.026 Vali Loss: 0.938 Vali Acc: 0.727 Test Loss: 0.938 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.772953987121582
Epoch: 19, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.005 Vali Acc: 0.732 Test Loss: 1.005 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.237403631210327
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.917562246322632
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 4.796452522277832
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.6883745193481445
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.678722620010376
Epoch: 5, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 4.7988152503967285
Epoch: 6, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.586 Vali Acc: 0.751 Test Loss: 0.586 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 5.044732093811035
Epoch: 7, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.2130515575408936
Epoch: 8, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.901 Vali Acc: 0.722 Test Loss: 0.901 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.784227609634399
Epoch: 9, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.662 Vali Acc: 0.780 Test Loss: 0.662 Test Acc: 0.780
Validation loss decreased (-0.751214 --> -0.780481).  Saving model ...
Epoch: 10 cost time: 5.11299467086792
Epoch: 10, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.068734407424927
Epoch: 11, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.710 Vali Acc: 0.702 Test Loss: 0.710 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.8142430782318115
Epoch: 12, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.767 Vali Acc: 0.737 Test Loss: 0.767 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.889072895050049
Epoch: 13, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.801 Vali Acc: 0.702 Test Loss: 0.801 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.346872568130493
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.873 Vali Acc: 0.712 Test Loss: 0.873 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.629643440246582
Epoch: 15, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.894 Vali Acc: 0.702 Test Loss: 0.894 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.731006860733032
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.959 Vali Acc: 0.707 Test Loss: 0.959 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.567606210708618
Epoch: 17, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.977 Vali Acc: 0.717 Test Loss: 0.977 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.441248178482056
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.027 Vali Acc: 0.712 Test Loss: 1.027 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.625820875167847
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.163 Vali Acc: 0.717 Test Loss: 1.163 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.328929662704468
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.5868470668792725
Epoch: 2, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.547771453857422
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.418422698974609
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.420775651931763
Epoch: 5, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.375227928161621
Epoch: 6, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.396090269088745
Epoch: 7, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.5063111782073975
Epoch: 8, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.905 Vali Acc: 0.746 Test Loss: 0.905 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.468224763870239
Epoch: 9, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.647 Vali Acc: 0.756 Test Loss: 0.647 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 10 cost time: 5.168657302856445
Epoch: 10, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.925096273422241
Epoch: 11, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.693 Vali Acc: 0.737 Test Loss: 0.693 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.7776899337768555
Epoch: 12, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.731 Vali Acc: 0.722 Test Loss: 0.731 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.661010026931763
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.776 Vali Acc: 0.668 Test Loss: 0.776 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.559670448303223
Epoch: 14, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.848 Vali Acc: 0.712 Test Loss: 0.848 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.068605661392212
Epoch: 15, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.880 Vali Acc: 0.707 Test Loss: 0.880 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.158304452896118
Epoch: 16, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.964 Vali Acc: 0.722 Test Loss: 0.964 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.2158050537109375
Epoch: 17, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.012 Vali Acc: 0.717 Test Loss: 1.012 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.269895553588867
Epoch: 18, Steps: 13 | Train Loss: 0.021 Vali Loss: 0.995 Vali Acc: 0.712 Test Loss: 0.995 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.275888681411743
Epoch: 19, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.106 Vali Acc: 0.727 Test Loss: 1.106 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.332361936569214
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.639 Vali Acc: 0.722 Test Loss: 0.639 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.0267109870910645
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.922800064086914
Epoch: 3, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.701235771179199
Epoch: 4, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.809005975723267
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.623230218887329
Epoch: 6, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 7 cost time: 4.71503472328186
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.618 Vali Acc: 0.717 Test Loss: 0.618 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.680297136306763
Epoch: 8, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.815 Vali Acc: 0.717 Test Loss: 0.815 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.31560206413269
Epoch: 9, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.700 Vali Acc: 0.712 Test Loss: 0.700 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.798663854598999
Epoch: 10, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.721 Vali Acc: 0.712 Test Loss: 0.721 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.609339714050293
Epoch: 11, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.728 Vali Acc: 0.693 Test Loss: 0.728 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.7625744342803955
Epoch: 12, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.757 Vali Acc: 0.702 Test Loss: 0.757 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.779022455215454
Epoch: 13, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.770 Vali Acc: 0.683 Test Loss: 0.770 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.806567668914795
Epoch: 14, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.875 Vali Acc: 0.702 Test Loss: 0.875 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.701816082000732
Epoch: 15, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.874 Vali Acc: 0.688 Test Loss: 0.874 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.492671489715576
Epoch: 16, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.933 Vali Acc: 0.698 Test Loss: 0.933 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.372671127319336
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.630 Vali Acc: 0.722 Test Loss: 0.630 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.633293628692627
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.5279459953308105
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 4.567491054534912
Epoch: 4, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.568 Vali Acc: 0.756 Test Loss: 0.568 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 4.270938396453857
Epoch: 5, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.561 Vali Acc: 0.756 Test Loss: 0.561 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.280370712280273
Epoch: 6, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.569 Vali Acc: 0.766 Test Loss: 0.569 Test Acc: 0.766
Validation loss decreased (-0.756092 --> -0.765848).  Saving model ...
Epoch: 7 cost time: 4.37208104133606
Epoch: 7, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.595 Vali Acc: 0.756 Test Loss: 0.595 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5130627155303955
Epoch: 8, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.748 Vali Acc: 0.741 Test Loss: 0.748 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.385279178619385
Epoch: 9, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.643 Vali Acc: 0.761 Test Loss: 0.643 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.379826068878174
Epoch: 10, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.670 Vali Acc: 0.766 Test Loss: 0.670 Test Acc: 0.766
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.8470635414123535
Epoch: 11, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.691 Vali Acc: 0.771 Test Loss: 0.691 Test Acc: 0.771
Validation loss decreased (-0.765848 --> -0.770725).  Saving model ...
Epoch: 12 cost time: 4.787318468093872
Epoch: 12, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.839 Vali Acc: 0.746 Test Loss: 0.839 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.648749113082886
Epoch: 13, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.762 Vali Acc: 0.707 Test Loss: 0.762 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.533977508544922
Epoch: 14, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.818 Vali Acc: 0.741 Test Loss: 0.818 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.23784065246582
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.818 Vali Acc: 0.712 Test Loss: 0.818 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.364309310913086
Epoch: 16, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.945 Vali Acc: 0.761 Test Loss: 0.945 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.336780071258545
Epoch: 17, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.944 Vali Acc: 0.746 Test Loss: 0.944 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.270399332046509
Epoch: 18, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.951 Vali Acc: 0.722 Test Loss: 0.951 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.407809495925903
Epoch: 19, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.957 Vali Acc: 0.727 Test Loss: 0.957 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.913904666900635
Epoch: 20, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.961 Vali Acc: 0.702 Test Loss: 0.961 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.893875598907471
Epoch: 21, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.966 Vali Acc: 0.712 Test Loss: 0.966 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.124293565750122
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.71857213973999
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.608953475952148
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.155348539352417
Epoch: 4, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.333809852600098
Epoch: 5, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.585 Vali Acc: 0.741 Test Loss: 0.585 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.442530632019043
Epoch: 6, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.568 Vali Acc: 0.746 Test Loss: 0.568 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 4.4709696769714355
Epoch: 7, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.610 Vali Acc: 0.761 Test Loss: 0.610 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 8 cost time: 4.729225158691406
Epoch: 8, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.745 Vali Acc: 0.732 Test Loss: 0.745 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.543890714645386
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.663 Vali Acc: 0.751 Test Loss: 0.663 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.874750852584839
Epoch: 10, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.59299898147583
Epoch: 11, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.311931133270264
Epoch: 12, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.819 Vali Acc: 0.737 Test Loss: 0.819 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.03218936920166
Epoch: 13, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.780 Vali Acc: 0.741 Test Loss: 0.780 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.24507212638855
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.891 Vali Acc: 0.727 Test Loss: 0.891 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.45840859413147
Epoch: 15, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.877 Vali Acc: 0.737 Test Loss: 0.877 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.24568247795105
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.912 Vali Acc: 0.727 Test Loss: 0.912 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.837367057800293
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.015 Vali Acc: 0.717 Test Loss: 1.015 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.255731821060181
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.076874732971191
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.639593601226807
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.630 Vali Acc: 0.712 Test Loss: 0.630 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.734119415283203
Epoch: 4, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.60667872428894
Epoch: 5, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.614 Vali Acc: 0.717 Test Loss: 0.614 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.0964508056640625
Epoch: 6, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.601 Vali Acc: 0.741 Test Loss: 0.601 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 4.5037782192230225
Epoch: 7, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.656 Vali Acc: 0.727 Test Loss: 0.656 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.768371105194092
Epoch: 8, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.841 Vali Acc: 0.712 Test Loss: 0.841 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.0059814453125
Epoch: 9, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.680 Vali Acc: 0.707 Test Loss: 0.680 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.253526449203491
Epoch: 10, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.692 Vali Acc: 0.707 Test Loss: 0.692 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.7861058712005615
Epoch: 11, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.722 Vali Acc: 0.698 Test Loss: 0.722 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.773169040679932
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.819 Vali Acc: 0.712 Test Loss: 0.819 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.497799873352051
Epoch: 13, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.809 Vali Acc: 0.678 Test Loss: 0.809 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.442840814590454
Epoch: 14, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.898 Vali Acc: 0.707 Test Loss: 0.898 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.359090328216553
Epoch: 15, Steps: 13 | Train Loss: 0.063 Vali Loss: 0.874 Vali Acc: 0.659 Test Loss: 0.874 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.284083366394043
Epoch: 16, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.078 Vali Acc: 0.712 Test Loss: 1.078 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.973302364349365
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.610 Vali Acc: 0.722 Test Loss: 0.610 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.526151657104492
Epoch: 2, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.654562950134277
Epoch: 3, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.380037069320679
Epoch: 4, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.112905979156494
Epoch: 5, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.492328405380249
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.610 Vali Acc: 0.702 Test Loss: 0.610 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.477167367935181
Epoch: 7, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.658 Vali Acc: 0.707 Test Loss: 0.658 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.654973983764648
Epoch: 8, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.861 Vali Acc: 0.712 Test Loss: 0.861 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.801450729370117
Epoch: 9, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.821 Vali Acc: 0.712 Test Loss: 0.821 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.013119697570801
Epoch: 10, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.65714955329895
Epoch: 11, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.706650972366333
Epoch: 12, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.854 Vali Acc: 0.712 Test Loss: 0.854 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.717344045639038
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.138421297073364
Epoch: 2, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.617 Vali Acc: 0.717 Test Loss: 0.617 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.102143287658691
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.617 Vali Acc: 0.702 Test Loss: 0.617 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.204404354095459
Epoch: 4, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.614 Vali Acc: 0.707 Test Loss: 0.614 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.275807857513428
Epoch: 5, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.621 Vali Acc: 0.702 Test Loss: 0.621 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.546865224838257
Epoch: 6, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.665 Vali Acc: 0.620 Test Loss: 0.665 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.671335458755493
Epoch: 7, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.639 Vali Acc: 0.688 Test Loss: 0.639 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.631115913391113
Epoch: 8, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.656 Vali Acc: 0.712 Test Loss: 0.656 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.6217124462127686
Epoch: 9, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.752 Vali Acc: 0.551 Test Loss: 0.752 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.61949610710144
Epoch: 10, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.708 Vali Acc: 0.634 Test Loss: 0.708 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.3272624015808105
Epoch: 11, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.716 Vali Acc: 0.678 Test Loss: 0.716 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.486157178878784
Epoch: 12, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.742 Vali Acc: 0.634 Test Loss: 0.742 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.645413160324097
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.3847432136535645
Epoch: 2, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.4578516483306885
Epoch: 3, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.617 Vali Acc: 0.683 Test Loss: 0.617 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.282885551452637
Epoch: 4, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 4.532645225524902
Epoch: 5, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.630 Vali Acc: 0.634 Test Loss: 0.630 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.127493858337402
Epoch: 6, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.724 Vali Acc: 0.541 Test Loss: 0.724 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.161356449127197
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.661 Vali Acc: 0.576 Test Loss: 0.661 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.110215187072754
Epoch: 8, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.666 Vali Acc: 0.600 Test Loss: 0.666 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.250044107437134
Epoch: 9, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.898 Vali Acc: 0.415 Test Loss: 0.898 Test Acc: 0.415
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.13030481338501
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.797 Vali Acc: 0.522 Test Loss: 0.797 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.3261237144470215
Epoch: 11, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.948 Vali Acc: 0.420 Test Loss: 0.948 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.517812967300415
Epoch: 12, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.998 Vali Acc: 0.444 Test Loss: 0.998 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.474250555038452
Epoch: 13, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.585772275924683
Epoch: 14, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.711 Vali Acc: 0.634 Test Loss: 0.711 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 270914
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.93329644203186
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.443763732910156
Epoch: 2, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.39725661277771
Epoch: 3, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.3158464431762695
Epoch: 4, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.391790390014648
Epoch: 5, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.614414691925049
Epoch: 6, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.564 Vali Acc: 0.717 Test Loss: 0.564 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.691086053848267
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 4.575956583023071
Epoch: 8, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.662 Vali Acc: 0.741 Test Loss: 0.662 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 9 cost time: 4.547973871231079
Epoch: 9, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.707 Vali Acc: 0.741 Test Loss: 0.707 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.167424440383911
Epoch: 10, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.358348608016968
Epoch: 11, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.641 Vali Acc: 0.693 Test Loss: 0.641 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.062258243560791
Epoch: 12, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.672 Vali Acc: 0.702 Test Loss: 0.672 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.305291175842285
Epoch: 13, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.735 Vali Acc: 0.712 Test Loss: 0.735 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.106846570968628
Epoch: 14, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.753 Vali Acc: 0.693 Test Loss: 0.753 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.33421516418457
Epoch: 15, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.816 Vali Acc: 0.712 Test Loss: 0.816 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.569622039794922
Epoch: 16, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.788 Vali Acc: 0.702 Test Loss: 0.788 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.518622398376465
Epoch: 17, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.822 Vali Acc: 0.698 Test Loss: 0.822 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.7974700927734375
Epoch: 18, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.885 Vali Acc: 0.712 Test Loss: 0.885 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.74809718132019
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.671981573104858
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717068).  Saving model ...
Epoch: 3 cost time: 5.0190253257751465
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
Validation loss decreased (-0.717068 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.859532594680786
Epoch: 4, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.226702690124512
Epoch: 5, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.930139064788818
Epoch: 6, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.48083758354187
Epoch: 7, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.638 Vali Acc: 0.737 Test Loss: 0.638 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.679407596588135
Epoch: 8, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.75910496711731
Epoch: 9, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.737 Vali Acc: 0.741 Test Loss: 0.737 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741456).  Saving model ...
Epoch: 10 cost time: 5.022345781326294
Epoch: 10, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.713 Vali Acc: 0.741 Test Loss: 0.713 Test Acc: 0.741
Validation loss decreased (-0.741456 --> -0.741456).  Saving model ...
Epoch: 11 cost time: 5.141472339630127
Epoch: 11, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.701 Vali Acc: 0.707 Test Loss: 0.701 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.239297866821289
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.747 Vali Acc: 0.712 Test Loss: 0.747 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.847957372665405
Epoch: 13, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.836 Vali Acc: 0.722 Test Loss: 0.836 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.8328399658203125
Epoch: 14, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.823 Vali Acc: 0.737 Test Loss: 0.823 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.590497016906738
Epoch: 15, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.898 Vali Acc: 0.732 Test Loss: 0.898 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.686718463897705
Epoch: 16, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.864 Vali Acc: 0.673 Test Loss: 0.864 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.734201908111572
Epoch: 17, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.916 Vali Acc: 0.683 Test Loss: 0.916 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.3665382862091064
Epoch: 18, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.037 Vali Acc: 0.737 Test Loss: 1.037 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.602229118347168
Epoch: 19, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.046 Vali Acc: 0.722 Test Loss: 1.046 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.753730058670044
Epoch: 20, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.105 Vali Acc: 0.727 Test Loss: 1.105 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.166753053665161
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.533293724060059
Epoch: 2, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.441829442977905
Epoch: 3, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.553 Vali Acc: 0.751 Test Loss: 0.553 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.384010076522827
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.399571657180786
Epoch: 5, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.498546361923218
Epoch: 6, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.295217037200928
Epoch: 7, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.631 Vali Acc: 0.741 Test Loss: 0.631 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.636625051498413
Epoch: 8, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.666 Vali Acc: 0.746 Test Loss: 0.666 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.650252819061279
Epoch: 9, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.730 Vali Acc: 0.741 Test Loss: 0.730 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.5211827754974365
Epoch: 10, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.839796543121338
Epoch: 11, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.669 Vali Acc: 0.712 Test Loss: 0.669 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.385671377182007
Epoch: 12, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.702 Vali Acc: 0.722 Test Loss: 0.702 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.687780141830444
Epoch: 13, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.773 Vali Acc: 0.722 Test Loss: 0.773 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.468586683273315
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.105405330657959
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.572 Vali Acc: 0.707 Test Loss: 0.572 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.695018529891968
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.6059629917144775
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.712287425994873
Epoch: 5, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 4.599143981933594
Epoch: 6, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.88012957572937
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.513891696929932
Epoch: 8, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.712 Vali Acc: 0.727 Test Loss: 0.712 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.1879565715789795
Epoch: 9, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.698 Vali Acc: 0.707 Test Loss: 0.698 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.380738735198975
Epoch: 10, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.653 Vali Acc: 0.693 Test Loss: 0.653 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.522282600402832
Epoch: 11, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.683 Vali Acc: 0.693 Test Loss: 0.683 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.257556438446045
Epoch: 12, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.721 Vali Acc: 0.688 Test Loss: 0.721 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.894444227218628
Epoch: 13, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.865 Vali Acc: 0.707 Test Loss: 0.865 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.785560607910156
Epoch: 14, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.810 Vali Acc: 0.688 Test Loss: 0.810 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.5690016746521
Epoch: 15, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.810 Vali Acc: 0.678 Test Loss: 0.810 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.750285387039185
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.4913129806518555
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.307497978210449
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.533 Vali Acc: 0.756 Test Loss: 0.533 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 4.577548265457153
Epoch: 4, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.864914894104004
Epoch: 5, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.030837774276733
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.560 Vali Acc: 0.756 Test Loss: 0.560 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.481401205062866
Epoch: 7, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.623 Vali Acc: 0.756 Test Loss: 0.623 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.789799690246582
Epoch: 8, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.938229560852051
Epoch: 9, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.683 Vali Acc: 0.732 Test Loss: 0.683 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.625513315200806
Epoch: 10, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.639 Vali Acc: 0.756 Test Loss: 0.639 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.252742528915405
Epoch: 11, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.2205212116241455
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.684 Vali Acc: 0.727 Test Loss: 0.684 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.138226509094238
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.811 Vali Acc: 0.737 Test Loss: 0.811 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.802670240402222
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.804344415664673
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.929194688796997
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.503978490829468
Epoch: 4, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.124594449996948
Epoch: 5, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 4.330803871154785
Epoch: 6, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.524848937988281
Epoch: 7, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746335).  Saving model ...
Epoch: 8 cost time: 4.45825457572937
Epoch: 8, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.769567251205444
Epoch: 9, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.724 Vali Acc: 0.751 Test Loss: 0.724 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751212).  Saving model ...
Epoch: 10 cost time: 5.126110315322876
Epoch: 10, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.001474142074585
Epoch: 11, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.667 Vali Acc: 0.693 Test Loss: 0.667 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.715564250946045
Epoch: 12, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.724 Vali Acc: 0.722 Test Loss: 0.724 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.214395761489868
Epoch: 13, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.869 Vali Acc: 0.746 Test Loss: 0.869 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.8999364376068115
Epoch: 14, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.798 Vali Acc: 0.712 Test Loss: 0.798 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.87784743309021
Epoch: 15, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.811 Vali Acc: 0.712 Test Loss: 0.811 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.763902902603149
Epoch: 16, Steps: 13 | Train Loss: 0.043 Vali Loss: 0.845 Vali Acc: 0.688 Test Loss: 0.845 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.633817672729492
Epoch: 17, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.891 Vali Acc: 0.702 Test Loss: 0.891 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.171676158905029
Epoch: 18, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.017 Vali Acc: 0.707 Test Loss: 1.017 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.8951404094696045
Epoch: 19, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.006 Vali Acc: 0.693 Test Loss: 1.006 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.33335542678833
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.482061862945557
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.988662242889404
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.94624400138855
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.4141340255737305
Epoch: 5, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.716484308242798
Epoch: 6, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.595 Vali Acc: 0.698 Test Loss: 0.595 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.032289028167725
Epoch: 7, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.364593982696533
Epoch: 8, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.945501804351807
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.732 Vali Acc: 0.707 Test Loss: 0.732 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.961092233657837
Epoch: 10, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.675 Vali Acc: 0.707 Test Loss: 0.675 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.399971961975098
Epoch: 11, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.706 Vali Acc: 0.683 Test Loss: 0.706 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.5547261238098145
Epoch: 12, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.763 Vali Acc: 0.693 Test Loss: 0.763 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.684107780456543
Epoch: 13, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.979 Vali Acc: 0.707 Test Loss: 0.979 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.438615798950195
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.786609411239624
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.585 Vali Acc: 0.707 Test Loss: 0.585 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.640254735946655
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 4 cost time: 4.609176397323608
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 5 cost time: 4.447587490081787
Epoch: 5, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.630 Vali Acc: 0.707 Test Loss: 0.630 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.33988881111145
Epoch: 6, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 7 cost time: 4.182368040084839
Epoch: 7, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.694 Vali Acc: 0.712 Test Loss: 0.694 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.213462591171265
Epoch: 8, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.688 Vali Acc: 0.712 Test Loss: 0.688 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.5042030811309814
Epoch: 9, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.754 Vali Acc: 0.717 Test Loss: 0.754 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.818873167037964
Epoch: 10, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.682 Vali Acc: 0.712 Test Loss: 0.682 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.023254871368408
Epoch: 11, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.683 Vali Acc: 0.702 Test Loss: 0.683 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.550480604171753
Epoch: 12, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.715 Vali Acc: 0.702 Test Loss: 0.715 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.697061061859131
Epoch: 13, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.842 Vali Acc: 0.707 Test Loss: 0.842 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.880116701126099
Epoch: 14, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.882 Vali Acc: 0.688 Test Loss: 0.882 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.579700469970703
Epoch: 15, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.832 Vali Acc: 0.702 Test Loss: 0.832 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.652883768081665
Epoch: 16, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.828 Vali Acc: 0.698 Test Loss: 0.828 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.926839113235474
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.6111156940460205
Epoch: 2, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.716339349746704
Epoch: 3, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.605 Vali Acc: 0.654 Test Loss: 0.605 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.686651706695557
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.637624263763428
Epoch: 5, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.603 Vali Acc: 0.693 Test Loss: 0.603 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.554035186767578
Epoch: 6, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.626 Vali Acc: 0.668 Test Loss: 0.626 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.242983102798462
Epoch: 7, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.616 Vali Acc: 0.702 Test Loss: 0.616 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.450067520141602
Epoch: 8, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.626 Vali Acc: 0.693 Test Loss: 0.626 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.370034456253052
Epoch: 9, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.650 Vali Acc: 0.668 Test Loss: 0.650 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.55383825302124
Epoch: 10, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.744 Vali Acc: 0.610 Test Loss: 0.744 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.3900158405303955
Epoch: 11, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.729 Vali Acc: 0.644 Test Loss: 0.729 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.818519115447998
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.624 Vali Acc: 0.712 Test Loss: 0.624 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.454946279525757
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.76741099357605
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.660 Vali Acc: 0.620 Test Loss: 0.660 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.4676384925842285
Epoch: 4, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.645 Vali Acc: 0.649 Test Loss: 0.645 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.4669413566589355
Epoch: 5, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.657 Vali Acc: 0.620 Test Loss: 0.657 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.213914155960083
Epoch: 6, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.744 Vali Acc: 0.527 Test Loss: 0.744 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.383939743041992
Epoch: 7, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.688 Vali Acc: 0.615 Test Loss: 0.688 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.688702821731567
Epoch: 8, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.872 Vali Acc: 0.410 Test Loss: 0.872 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.553454637527466
Epoch: 9, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.763 Vali Acc: 0.537 Test Loss: 0.763 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.989751815795898
Epoch: 10, Steps: 13 | Train Loss: 0.419 Vali Loss: 1.109 Vali Acc: 0.332 Test Loss: 1.109 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.959059000015259
Epoch: 11, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.920 Vali Acc: 0.473 Test Loss: 0.920 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.858071804046631
Epoch: 12, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.924 Vali Acc: 0.463 Test Loss: 0.924 Test Acc: 0.463
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 172610
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.06247615814209
Epoch: 1, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.596 Vali Acc: 0.722 Test Loss: 0.596 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.400169372558594
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.766275405883789
Epoch: 3, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.007302761077881
Epoch: 4, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.560 Vali Acc: 0.722 Test Loss: 0.560 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 4.811183929443359
Epoch: 5, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.655 Vali Acc: 0.722 Test Loss: 0.655 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.931163311004639
Epoch: 6, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 7 cost time: 4.9529688358306885
Epoch: 7, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.638 Vali Acc: 0.663 Test Loss: 0.638 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.802944183349609
Epoch: 8, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 9 cost time: 4.411200523376465
Epoch: 9, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.816 Vali Acc: 0.741 Test Loss: 0.816 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741455).  Saving model ...
Epoch: 10 cost time: 4.596227407455444
Epoch: 10, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.627 Vali Acc: 0.693 Test Loss: 0.627 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.475705146789551
Epoch: 11, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.626 Vali Acc: 0.717 Test Loss: 0.626 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.571074724197388
Epoch: 12, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.642 Vali Acc: 0.688 Test Loss: 0.642 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.069997310638428
Epoch: 13, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.659 Vali Acc: 0.683 Test Loss: 0.659 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.276994705200195
Epoch: 14, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.664 Vali Acc: 0.727 Test Loss: 0.664 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.61769962310791
Epoch: 15, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.701 Vali Acc: 0.683 Test Loss: 0.701 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.935396194458008
Epoch: 16, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.756 Vali Acc: 0.722 Test Loss: 0.756 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.7071332931518555
Epoch: 17, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.7186689376831055
Epoch: 18, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.749 Vali Acc: 0.702 Test Loss: 0.749 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.780926942825317
Epoch: 19, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.452256202697754
Epoch: 1, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.0019330978393555
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.581 Vali Acc: 0.712 Test Loss: 0.581 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.5520501136779785
Epoch: 3, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.569 Vali Acc: 0.712 Test Loss: 0.569 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.2186360359191895
Epoch: 4, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 4.624017000198364
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.028326511383057
Epoch: 6, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.598 Vali Acc: 0.741 Test Loss: 0.598 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 4.945251703262329
Epoch: 7, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.626 Vali Acc: 0.673 Test Loss: 0.626 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.696443796157837
Epoch: 8, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.715 Vali Acc: 0.746 Test Loss: 0.715 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 9 cost time: 4.818417310714722
Epoch: 9, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.878 Vali Acc: 0.727 Test Loss: 0.878 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.4355480670928955
Epoch: 10, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.651 Vali Acc: 0.702 Test Loss: 0.651 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.506390333175659
Epoch: 11, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.671 Vali Acc: 0.712 Test Loss: 0.671 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.8253772258758545
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.688 Vali Acc: 0.698 Test Loss: 0.688 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.533222675323486
Epoch: 13, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.700 Vali Acc: 0.698 Test Loss: 0.700 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.767931938171387
Epoch: 14, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.721 Vali Acc: 0.727 Test Loss: 0.721 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.446774005889893
Epoch: 15, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.748 Vali Acc: 0.663 Test Loss: 0.748 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.464766025543213
Epoch: 16, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.792 Vali Acc: 0.741 Test Loss: 0.792 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.539090156555176
Epoch: 17, Steps: 13 | Train Loss: 0.051 Vali Loss: 0.870 Vali Acc: 0.746 Test Loss: 0.870 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.751709938049316
Epoch: 18, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.847 Vali Acc: 0.732 Test Loss: 0.847 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.25697135925293
Epoch: 1, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.348020315170288
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 4.232858180999756
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.716038465499878
Epoch: 4, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 4.5206263065338135
Epoch: 5, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.665 Vali Acc: 0.737 Test Loss: 0.665 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.647948980331421
Epoch: 6, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.604 Vali Acc: 0.741 Test Loss: 0.604 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.006171464920044
Epoch: 7, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.631 Vali Acc: 0.649 Test Loss: 0.631 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.989771366119385
Epoch: 8, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.660 Vali Acc: 0.741 Test Loss: 0.660 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.662870407104492
Epoch: 9, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.880 Vali Acc: 0.732 Test Loss: 0.880 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.0996315479278564
Epoch: 10, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.667 Vali Acc: 0.654 Test Loss: 0.667 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.5604894161224365
Epoch: 11, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.679 Vali Acc: 0.683 Test Loss: 0.679 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.343223333358765
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.686 Vali Acc: 0.698 Test Loss: 0.686 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.538189649581909
Epoch: 13, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.684 Vali Acc: 0.683 Test Loss: 0.684 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.01650595664978
Epoch: 14, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.714 Vali Acc: 0.683 Test Loss: 0.714 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.6494667530059814
Epoch: 1, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.98834490776062
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.492767095565796
Epoch: 3, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.5048768520355225
Epoch: 4, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 4.31000542640686
Epoch: 5, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.645 Vali Acc: 0.712 Test Loss: 0.645 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.573574542999268
Epoch: 6, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.6515679359436035
Epoch: 7, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.613 Vali Acc: 0.702 Test Loss: 0.613 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.837084054946899
Epoch: 8, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.724 Vali Acc: 0.727 Test Loss: 0.724 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.933548927307129
Epoch: 9, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.780 Vali Acc: 0.717 Test Loss: 0.780 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.536619186401367
Epoch: 10, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.622 Vali Acc: 0.702 Test Loss: 0.622 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.419676303863525
Epoch: 11, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.687837839126587
Epoch: 12, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.656 Vali Acc: 0.707 Test Loss: 0.656 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.673169136047363
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.669 Vali Acc: 0.702 Test Loss: 0.669 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.771146297454834
Epoch: 14, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.696 Vali Acc: 0.693 Test Loss: 0.696 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.48813271522522
Epoch: 1, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 5.359833478927612
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.556 Vali Acc: 0.722 Test Loss: 0.556 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.763031721115112
Epoch: 3, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.608855962753296
Epoch: 4, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.542 Vali Acc: 0.756 Test Loss: 0.542 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 4.665408372879028
Epoch: 5, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.475566148757935
Epoch: 6, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.677727460861206
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.606 Vali Acc: 0.702 Test Loss: 0.606 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.525141716003418
Epoch: 8, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.639 Vali Acc: 0.751 Test Loss: 0.639 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.48326563835144
Epoch: 9, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.711 Vali Acc: 0.732 Test Loss: 0.711 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.868092775344849
Epoch: 10, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.611 Vali Acc: 0.741 Test Loss: 0.611 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.6959381103515625
Epoch: 11, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.631 Vali Acc: 0.756 Test Loss: 0.631 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.6008524894714355
Epoch: 12, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.645 Vali Acc: 0.761 Test Loss: 0.645 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760969).  Saving model ...
Epoch: 13 cost time: 5.332898378372192
Epoch: 13, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.661 Vali Acc: 0.741 Test Loss: 0.661 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.499402046203613
Epoch: 14, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.685 Vali Acc: 0.732 Test Loss: 0.685 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.061407089233398
Epoch: 15, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.716 Vali Acc: 0.732 Test Loss: 0.716 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.30108118057251
Epoch: 16, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.580624103546143
Epoch: 17, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.810 Vali Acc: 0.741 Test Loss: 0.810 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.131170749664307
Epoch: 18, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.805 Vali Acc: 0.727 Test Loss: 0.805 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.337368011474609
Epoch: 19, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.852 Vali Acc: 0.737 Test Loss: 0.852 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.795313119888306
Epoch: 20, Steps: 13 | Train Loss: 0.027 Vali Loss: 0.991 Vali Acc: 0.761 Test Loss: 0.991 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.655596017837524
Epoch: 21, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.883 Vali Acc: 0.727 Test Loss: 0.883 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.833715915679932
Epoch: 22, Steps: 13 | Train Loss: 0.019 Vali Loss: 0.898 Vali Acc: 0.722 Test Loss: 0.898 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.744980812072754
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 4.269148588180542
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 4.504928112030029
Epoch: 3, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 4.913956642150879
Epoch: 4, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 4.941645622253418
Epoch: 5, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.901187896728516
Epoch: 6, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.116879940032959
Epoch: 7, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.014050483703613
Epoch: 8, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756091).  Saving model ...
Epoch: 9 cost time: 4.834112167358398
Epoch: 9, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.728 Vali Acc: 0.751 Test Loss: 0.728 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.58098030090332
Epoch: 10, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.39753270149231
Epoch: 11, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.3361546993255615
Epoch: 12, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.664 Vali Acc: 0.737 Test Loss: 0.664 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.72942042350769
Epoch: 13, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.717 Vali Acc: 0.741 Test Loss: 0.717 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.635818958282471
Epoch: 14, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.760 Vali Acc: 0.732 Test Loss: 0.760 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.139542818069458
Epoch: 15, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.766 Vali Acc: 0.693 Test Loss: 0.766 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.373511075973511
Epoch: 16, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.810 Vali Acc: 0.707 Test Loss: 0.810 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.495575666427612
Epoch: 17, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.929 Vali Acc: 0.746 Test Loss: 0.929 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.552026987075806
Epoch: 18, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.863 Vali Acc: 0.698 Test Loss: 0.863 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.357110977172852
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.533572673797607
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.596 Vali Acc: 0.722 Test Loss: 0.596 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 4.261718034744263
Epoch: 3, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 4.549103736877441
Epoch: 4, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 4.587153196334839
Epoch: 5, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.675 Vali Acc: 0.717 Test Loss: 0.675 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.819491386413574
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.871677398681641
Epoch: 7, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.8964643478393555
Epoch: 8, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.701 Vali Acc: 0.702 Test Loss: 0.701 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.3600921630859375
Epoch: 9, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.821 Vali Acc: 0.722 Test Loss: 0.821 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.334343194961548
Epoch: 10, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.539580583572388
Epoch: 11, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.693 Vali Acc: 0.722 Test Loss: 0.693 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.558715343475342
Epoch: 12, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.705 Vali Acc: 0.707 Test Loss: 0.705 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.853954792022705
Epoch: 13, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.779 Vali Acc: 0.722 Test Loss: 0.779 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.836464881896973
Epoch: 14, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.793 Vali Acc: 0.717 Test Loss: 0.793 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.181321382522583
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.438544988632202
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.299971580505371
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 4.362191200256348
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 4.247984170913696
Epoch: 5, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.660 Vali Acc: 0.717 Test Loss: 0.660 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.137890815734863
Epoch: 6, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.430352687835693
Epoch: 7, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.713657379150391
Epoch: 8, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.779827833175659
Epoch: 9, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.830 Vali Acc: 0.717 Test Loss: 0.830 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.383066892623901
Epoch: 10, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.642 Vali Acc: 0.707 Test Loss: 0.642 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.6087486743927
Epoch: 11, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.690 Vali Acc: 0.702 Test Loss: 0.690 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.245201587677002
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.704 Vali Acc: 0.707 Test Loss: 0.704 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.387590408325195
Epoch: 13, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.731 Vali Acc: 0.707 Test Loss: 0.731 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.344757080078125
Epoch: 14, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.796 Vali Acc: 0.712 Test Loss: 0.796 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.256765365600586
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.6562111377716064
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.612 Vali Acc: 0.722 Test Loss: 0.612 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.856446027755737
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.971366882324219
Epoch: 4, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.589163541793823
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.611 Vali Acc: 0.707 Test Loss: 0.611 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.4774415493011475
Epoch: 6, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.681 Vali Acc: 0.610 Test Loss: 0.681 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.759925127029419
Epoch: 7, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.649 Vali Acc: 0.693 Test Loss: 0.649 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.007014513015747
Epoch: 8, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.655 Vali Acc: 0.678 Test Loss: 0.655 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.55717396736145
Epoch: 9, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.670 Vali Acc: 0.693 Test Loss: 0.670 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.685910940170288
Epoch: 10, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.822 Vali Acc: 0.517 Test Loss: 0.822 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.8706278800964355
Epoch: 11, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.776 Vali Acc: 0.566 Test Loss: 0.776 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.0566020011901855
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.594 Vali Acc: 0.712 Test Loss: 0.594 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 4.2265074253082275
Epoch: 2, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.677912473678589
Epoch: 3, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.609 Vali Acc: 0.702 Test Loss: 0.609 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.559677362442017
Epoch: 4, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.605 Vali Acc: 0.707 Test Loss: 0.605 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.526150226593018
Epoch: 5, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.810260057449341
Epoch: 6, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.693 Vali Acc: 0.585 Test Loss: 0.693 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.606441497802734
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.686 Vali Acc: 0.585 Test Loss: 0.686 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.7708940505981445
Epoch: 8, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.731 Vali Acc: 0.537 Test Loss: 0.731 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.5528037548065186
Epoch: 9, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.631 Vali Acc: 0.663 Test Loss: 0.631 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.386496543884277
Epoch: 10, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.062 Vali Acc: 0.356 Test Loss: 1.062 Test Acc: 0.356
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.480057716369629
Epoch: 11, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.786 Vali Acc: 0.527 Test Loss: 0.786 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.27918553352356
Epoch: 12, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.954 Vali Acc: 0.463 Test Loss: 0.954 Test Acc: 0.463
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 123458
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         203                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma203_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.408675909042358
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 4.6562418937683105
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.936216831207275
Epoch: 3, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.304534673690796
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.986873388290405
Epoch: 5, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.771528959274292
Epoch: 6, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.633567571640015
Epoch: 7, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.915361404418945
Epoch: 8, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.738490343093872
Epoch: 9, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.944140672683716
Epoch: 10, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.571662664413452
Epoch: 11, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.072577953338623
Epoch: 12, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.662 Vali Acc: 0.707 Test Loss: 0.662 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma203_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         162                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma162_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.620964050292969
Epoch: 1, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.281417608261108
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 4.789989471435547
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 4.766637802124023
Epoch: 4, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.603 Vali Acc: 0.741 Test Loss: 0.603 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 4.278553485870361
Epoch: 5, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 4.164996147155762
Epoch: 6, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.673388957977295
Epoch: 7, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.239715576171875
Epoch: 8, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.758 Vali Acc: 0.741 Test Loss: 0.758 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.0767128467559814
Epoch: 9, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.23545503616333
Epoch: 10, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.289705276489258
Epoch: 11, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.519032716751099
Epoch: 12, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.729 Vali Acc: 0.741 Test Loss: 0.729 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.643766164779663
Epoch: 13, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.757 Vali Acc: 0.737 Test Loss: 0.757 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.583141088485718
Epoch: 14, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.759 Vali Acc: 0.722 Test Loss: 0.759 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.774297475814819
Epoch: 15, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.801 Vali Acc: 0.737 Test Loss: 0.801 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma162_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         122                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma122_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.218599796295166
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.295953989028931
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.359764099121094
Epoch: 3, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.500044584274292
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.625 Vali Acc: 0.746 Test Loss: 0.625 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.374962091445923
Epoch: 5, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.499582290649414
Epoch: 6, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.174999237060547
Epoch: 7, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.006604194641113
Epoch: 8, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.746 Vali Acc: 0.737 Test Loss: 0.746 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.1436767578125
Epoch: 9, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.632 Vali Acc: 0.727 Test Loss: 0.632 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.7858428955078125
Epoch: 10, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.637 Vali Acc: 0.693 Test Loss: 0.637 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.746124982833862
Epoch: 11, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.655 Vali Acc: 0.683 Test Loss: 0.655 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.547073841094971
Epoch: 12, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.707 Vali Acc: 0.732 Test Loss: 0.707 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.5708091259002686
Epoch: 13, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.725 Vali Acc: 0.712 Test Loss: 0.725 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma122_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         81                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma81_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.753484725952148
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.605 Vali Acc: 0.727 Test Loss: 0.605 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 4.71953272819519
Epoch: 2, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.5931236743927
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.894525527954102
Epoch: 4, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.816386938095093
Epoch: 5, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.5052330493927
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.573 Vali Acc: 0.741 Test Loss: 0.573 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 4.188410520553589
Epoch: 7, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.498066186904907
Epoch: 8, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.767 Vali Acc: 0.722 Test Loss: 0.767 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.397276878356934
Epoch: 9, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.639 Vali Acc: 0.649 Test Loss: 0.639 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.636569499969482
Epoch: 10, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.634 Vali Acc: 0.712 Test Loss: 0.634 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.836496591567993
Epoch: 11, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.690 Vali Acc: 0.702 Test Loss: 0.690 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.651488780975342
Epoch: 12, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.679 Vali Acc: 0.722 Test Loss: 0.679 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.9085001945495605
Epoch: 13, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.989485263824463
Epoch: 14, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.702 Vali Acc: 0.702 Test Loss: 0.702 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.905224800109863
Epoch: 15, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.768 Vali Acc: 0.727 Test Loss: 0.768 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.25159478187561
Epoch: 16, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.755 Vali Acc: 0.712 Test Loss: 0.755 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma81_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         41                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.587299823760986
Epoch: 1, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 4.107118844985962
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 4.561084508895874
Epoch: 3, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 4.621753931045532
Epoch: 4, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.086866855621338
Epoch: 5, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.584 Vali Acc: 0.756 Test Loss: 0.584 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 4.827555894851685
Epoch: 6, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.929828643798828
Epoch: 7, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.574 Vali Acc: 0.741 Test Loss: 0.574 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5517966747283936
Epoch: 8, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.572205305099487
Epoch: 9, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.618 Vali Acc: 0.707 Test Loss: 0.618 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.4003989696502686
Epoch: 10, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.630 Vali Acc: 0.741 Test Loss: 0.630 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.3379433155059814
Epoch: 11, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.044355154037476
Epoch: 12, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.663 Vali Acc: 0.746 Test Loss: 0.663 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.729435205459595
Epoch: 13, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.762847185134888
Epoch: 14, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.710 Vali Acc: 0.727 Test Loss: 0.710 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.812430381774902
Epoch: 15, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.767 Vali Acc: 0.746 Test Loss: 0.767 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.998554468154907
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.564419269561768
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.573498010635376
Epoch: 3, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.571054697036743
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.633741617202759
Epoch: 5, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.560322046279907
Epoch: 6, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.422400951385498
Epoch: 7, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.654431343078613
Epoch: 8, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.766 Vali Acc: 0.732 Test Loss: 0.766 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.352545738220215
Epoch: 9, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.653 Vali Acc: 0.668 Test Loss: 0.653 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.388302326202393
Epoch: 10, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.660 Vali Acc: 0.741 Test Loss: 0.660 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 11 cost time: 4.4287919998168945
Epoch: 11, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.130935192108154
Epoch: 12, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.692 Vali Acc: 0.727 Test Loss: 0.692 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.259965658187866
Epoch: 13, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.730 Vali Acc: 0.732 Test Loss: 0.730 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.491967678070068
Epoch: 14, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.720 Vali Acc: 0.727 Test Loss: 0.720 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.567544460296631
Epoch: 15, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.797 Vali Acc: 0.717 Test Loss: 0.797 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.697306871414185
Epoch: 16, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.969173908233643
Epoch: 17, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.913 Vali Acc: 0.722 Test Loss: 0.913 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.8920371532440186
Epoch: 18, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.874 Vali Acc: 0.722 Test Loss: 0.874 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.64001727104187
Epoch: 19, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.906 Vali Acc: 0.712 Test Loss: 0.906 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.479918003082275
Epoch: 20, Steps: 13 | Train Loss: 0.030 Vali Loss: 0.932 Vali Acc: 0.712 Test Loss: 0.932 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.3056275844573975
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.835806608200073
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 4.984013557434082
Epoch: 3, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.579862117767334
Epoch: 4, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.498015880584717
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.6681602001190186
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.619 Vali Acc: 0.712 Test Loss: 0.619 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.615671634674072
Epoch: 7, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.455500364303589
Epoch: 8, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.827 Vali Acc: 0.717 Test Loss: 0.827 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.510998249053955
Epoch: 9, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.636 Vali Acc: 0.673 Test Loss: 0.636 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.570624351501465
Epoch: 10, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.697 Vali Acc: 0.702 Test Loss: 0.697 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.528637409210205
Epoch: 11, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.696 Vali Acc: 0.727 Test Loss: 0.696 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.771631956100464
Epoch: 12, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.700 Vali Acc: 0.722 Test Loss: 0.700 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.7366862297058105
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.9221274852752686
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.656483888626099
Epoch: 3, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.130804777145386
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 4.650631427764893
Epoch: 5, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.069999933242798
Epoch: 6, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.7597129344940186
Epoch: 7, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.685038328170776
Epoch: 8, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.614125967025757
Epoch: 9, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.611 Vali Acc: 0.693 Test Loss: 0.611 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.723176717758179
Epoch: 10, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.702 Vali Acc: 0.712 Test Loss: 0.702 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.72450590133667
Epoch: 11, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.663 Vali Acc: 0.717 Test Loss: 0.663 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.485698223114014
Epoch: 12, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.705 Vali Acc: 0.722 Test Loss: 0.705 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.339328050613403
Epoch: 13, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.683 Vali Acc: 0.698 Test Loss: 0.683 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.706904411315918
Epoch: 14, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.742 Vali Acc: 0.702 Test Loss: 0.742 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.127701997756958
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 4.846176624298096
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.606 Vali Acc: 0.712 Test Loss: 0.606 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.068270921707153
Epoch: 3, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.611 Vali Acc: 0.702 Test Loss: 0.611 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.522528171539307
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.609 Vali Acc: 0.702 Test Loss: 0.609 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.961984157562256
Epoch: 5, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.623 Vali Acc: 0.698 Test Loss: 0.623 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.12108039855957
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.623 Vali Acc: 0.707 Test Loss: 0.623 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.095929861068726
Epoch: 7, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.665 Vali Acc: 0.620 Test Loss: 0.665 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.843717336654663
Epoch: 8, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.658 Vali Acc: 0.717 Test Loss: 0.658 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.786301612854004
Epoch: 9, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.854 Vali Acc: 0.463 Test Loss: 0.854 Test Acc: 0.463
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.755579710006714
Epoch: 10, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.662 Vali Acc: 0.693 Test Loss: 0.662 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.598038673400879
Epoch: 11, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.704 Vali Acc: 0.634 Test Loss: 0.704 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 98882
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
fourier enhanced block used!
modes=32, index=[0, 8, 13, 18, 23, 24, 35, 42, 51, 52, 56, 59, 64, 72, 74, 77, 86, 97, 118, 125, 130, 139, 145, 150, 155, 156, 164, 174, 181, 182, 183, 193]
fourier enhanced block used!
modes=32, index=[5, 9, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 45, 51, 52, 56, 58, 60, 63, 65, 66, 67, 68, 69, 72, 78, 80, 81, 82, 85, 86, 89]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 2, 3, 4, 13, 21, 27, 33, 34, 35, 37, 40, 41, 45, 46, 52, 56, 59, 60, 62, 63, 68, 69, 70, 72, 74, 79, 80, 87, 89, 91, 97]
modes_kv=32, index_kv=[3, 20, 26, 28, 32, 43, 46, 52, 59, 62, 73, 79, 80, 81, 90, 91, 106, 107, 115, 123, 125, 137, 147, 158, 162, 164, 167, 169, 170, 171, 184, 193]
>>>>>>>start training : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.084424018859863
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 4.884649991989136
Epoch: 2, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 5.011551856994629
Epoch: 3, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.626 Vali Acc: 0.649 Test Loss: 0.626 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.840489864349365
Epoch: 4, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.598 Vali Acc: 0.663 Test Loss: 0.598 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.942171573638916
Epoch: 5, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.644 Vali Acc: 0.639 Test Loss: 0.644 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.8088059425354
Epoch: 6, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.606 Vali Acc: 0.683 Test Loss: 0.606 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.633009910583496
Epoch: 7, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.693 Vali Acc: 0.541 Test Loss: 0.693 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.96281099319458
Epoch: 8, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.604 Vali Acc: 0.693 Test Loss: 0.604 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.012009859085083
Epoch: 9, Steps: 13 | Train Loss: 0.519 Vali Loss: 1.019 Vali Acc: 0.337 Test Loss: 1.019 Test Acc: 0.337
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.697706937789917
Epoch: 10, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.663 Vali Acc: 0.600 Test Loss: 0.663 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.339685916900635
Epoch: 11, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.126 Vali Acc: 0.351 Test Loss: 1.126 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.547516107559204
Epoch: 12, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.984 Vali Acc: 0.429 Test Loss: 0.984 Test Acc: 0.429
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_FEDformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 98882
model size : 1.62MB
